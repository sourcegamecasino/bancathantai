var cc=cc||{},_p=(cc._tmp=cc._tmp||{},cc._LogInfos={},window),_p=Object.prototype,_p=null,imagePool=(cc._drawingUtil=null,cc._renderContext=null,cc._supportRender=!1,cc._canvas=null,cc.container=null,cc._gameDiv=null,window.ENABLE_IMAEG_POOL=!0,cc.each=function(t,e,i){if(t)if(t instanceof Array)for(var n=0,s=t.length;n<s&&!1!==e.call(i,t[n],n);n++);else for(n in t)if(!1===e.call(i,t[n],n))break},cc.extend=function(i){var t=2<=arguments.length?Array.prototype.slice.call(arguments,1):[];return cc.each(t,function(t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])}),i},cc.inherits=function(t,e){function i(){}i.prototype=e.prototype,t.superClass_=e.prototype,t.prototype=new i,t.prototype.constructor=t},cc.isFunction=function(t){return"function"==typeof t},cc.isNumber=function(t){return"number"==typeof t||"[object Number]"===Object.prototype.toString.call(t)},cc.isString=function(t){return"string"==typeof t||"[object String]"===Object.prototype.toString.call(t)},cc.isArray=function(t){return Array.isArray(t)||"object"==typeof t&&"[object Array]"===Object.prototype.toString.call(t)},cc.isUndefined=function(t){return void 0===t},cc.isObject=function(t){return"object"==typeof t&&"[object Object]"===Object.prototype.toString.call(t)},cc.isCrossOrigin=function(t){var e;return t?-1!==(e=t.indexOf("://"))&&(-1===(e=t.indexOf("/",e+3))?t:t.substring(0,e))!==location.origin:(cc.log("invalid URL"),!1)},cc.AsyncPool=function(t,e,i,n,s){var r=this;r._finished=!1,r._srcObj=t,r._limit=e,r._pool=[],r._iterator=i,r._iteratorTarget=s,r._onEnd=n,r._onEndTarget=s,r._results=t instanceof Array?[]:{},r._errors=t instanceof Array?[]:{},cc.each(t,function(t,e){r._pool.push({index:e,value:t})}),r.size=r._pool.length,r.finishedSize=0,r._workingSize=0,r._limit=r._limit||r.size,r.onIterator=function(t,e){r._iterator=t,r._iteratorTarget=e},r.onEnd=function(t,e){r._onEnd=t,r._onEndTarget=e},r._handleItem=function(){var t,e,i,n=this;0===n._pool.length||n._workingSize>=n._limit||(e=(t=n._pool.shift()).value,i=t.index,n._workingSize++,n._iterator.call(n._iteratorTarget,e,i,function(t,e){n._finished||(t?n._errors[this.index]=t:n._results[this.index]=e,n.finishedSize++,n._workingSize--,n.finishedSize===n.size?n.onEnd(0===n._errors.length?null:n._errors,n._results):n._handleItem())}.bind(t),n))},r.flow=function(){if(0===this._pool.length)this._onEnd&&this._onEnd.call(this._onEndTarget,null,[]);else for(var t=0;t<this._limit;t++)this._handleItem()},r.onEnd=function(t,e){var i,n;r._finished=!0,r._onEnd&&(i=r._onEnd,n=r._onEndTarget,r._onEnd=null,r._onEndTarget=null,i.call(n,t,e))}},cc.async={series:function(t,e,n){return(t=new cc.AsyncPool(t,1,function(t,e,i){t.call(n,i)},e,n)).flow(),t},parallel:function(t,e,n){return(t=new cc.AsyncPool(t,0,function(t,e,i){t.call(n,i)},e,n)).flow(),t},waterfall:function(n,e,s){var r=[],o=[null],t=new cc.AsyncPool(n,1,function(t,e,i){r.push(function(t){r=Array.prototype.slice.call(arguments,1),n.length-1===e&&(o=o.concat(r)),i.apply(null,arguments)}),t.apply(s,r)},function(t){if(e){if(t)return e.call(s,t);e.apply(s,o)}});return t.flow(),t},map:function(t,e,i,n){var s=e;return"object"==typeof e&&(i=e.cb,n=e.iteratorTarget,s=e.iterator),(t=new cc.AsyncPool(t,0,s,i,n)).flow(),t},mapLimit:function(t,e,i,n,s){return(t=new cc.AsyncPool(t,e,i,n,s)).flow(),t}},cc.path={normalizeRE:/[^\.\/]+\/\.\.\//,join:function(){for(var t=arguments.length,e="",i=0;i<t;i++)e=(e+(""===e?"":"/")+arguments[i]).replace(/(\/|\\\\)$/,"");return e},extname:function(t){return(t=/(\.[^\.\/\?\\]*)(\?.*)?$/.exec(t))?t[1]:null},mainFileName:function(t){if(t){var e=t.lastIndexOf(".");if(-1!==e)return t.substring(0,e)}return t},basename:function(t,e){var i=t.indexOf("?");return 0<i&&(t=t.substring(0,i)),(i=/(\/|\\\\)([^(\/|\\\\)]+)$/g.exec(t.replace(/(\/|\\\\)$/,"")))?(i=i[2],e&&t.substring(t.length-e.length).toLowerCase()===e.toLowerCase()?i.substring(0,i.length-e.length):i):null},dirname:function(t){return t.replace(/((.*)(\/|\\|\\\\))?(.*?\..*$)?/,"$2")},changeExtname:function(t,e){e=e||"";var i=t.indexOf("?"),n="";return 0<i&&(n=t.substring(i),t=t.substring(0,i)),(i=t.lastIndexOf("."))<0?t+e+n:t.substring(0,i)+e+n},changeBasename:function(t,e,i){var n,s;return 0===e.indexOf(".")?this.changeExtname(t,e):(n=t.indexOf("?"),s="",i=i?this.extname(t):"",0<n&&(s=t.substring(n),t=t.substring(0,n)),n=t.lastIndexOf("/"),t.substring(0,n<=0?0:n+1)+e+i+s)},_normalize:function(t){var e;for(t=String(t);t=(e=t).replace(this.normalizeRE,""),e.length!==t.length;);return t}},{_pool:Array(10),_MAX:10,_smallImg:"data:image/gif;base64,R0lGODlhAQABAAAAACwAAAAAAQABAAA=",count:0,get:function(){var t;return 0<this.count?(this.count--,t=this._pool[this.count],this._pool[this.count]=null,t):new Image},put:function(t){var e=this._pool;t instanceof HTMLImageElement&&this.count<this._MAX&&(t.src=this._smallImg,e[this.count]=t,this.count++)}}),IEBinaryToArray_ByteStr_Script,myVBScript,ClassManager=(cc.loader=function(){var a={},o={},s={},r={},u={},c=/^(?:https?|ftp):\/\/\S*$/i;return{resPath:"",audioPath:"",cache:{},getXMLHttpRequest:function(){var t=window.XMLHttpRequest?new window.XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP");return t.timeout=1e4,void 0===t.ontimeout&&(t._timeoutId=-1),t},_getArgs4Js:function(t){var e=t[0],i=t[1],n=t[2],s=["",null,null];if(1===t.length)s[1]=e instanceof Array?e:[e];else if(2===t.length)"function"==typeof i?(s[1]=e instanceof Array?e:[e],s[2]=i):(s[0]=e||"",s[1]=i instanceof Array?i:[i]);else{if(3!==t.length)throw Error("arguments error to load js!");s[0]=e||"",s[1]=i instanceof Array?i:[i],s[2]=n}return s},isLoading:function(t){return void 0!==u[t]},loadJs:function(t,e,i){var n=this,s=(o=n._getArgs4Js(arguments))[0],r=o[1],o=o[2];-1<navigator.userAgent.indexOf("Trident/5")?n._loadJs4Dependency(s,r,0,o):cc.async.map(r,function(t,e,i){if(t=cc.path.join(s,t),a[t])return i(null);n._createScript(t,!1,i)},o)},loadJsWithImg:function(t,e,i){var n=this._loadJsImg(),s=this._getArgs4Js(arguments);this.loadJs(s[0],s[1],function(t){if(t)throw Error(t);n.parentNode.removeChild(n),s[2]&&s[2]()})},_createScript:function(t,e,i){var n=document,s=document.createElement("script");s.async=e,a[t]=!0,cc.game.config.noCache&&"string"==typeof t?this._noCacheRex.test(t)?s.src=t+"&_t="+ +new Date:s.src=t+"?_t="+ +new Date:s.src=t,s.addEventListener("load",function(){s.parentNode.removeChild(s),this.removeEventListener("load",arguments.callee,!1),i()},!1),s.addEventListener("error",function(){s.parentNode.removeChild(s),i("Load "+t+" failed!")},!1),n.body.appendChild(s)},_loadJs4Dependency:function(e,i,n,s){var r;n>=i.length?s&&s():(r=this)._createScript(cc.path.join(e,i[n]),!1,function(t){if(t)return s(t);r._loadJs4Dependency(e,i,n+1,s)})},_loadJsImg:function(){var t,e=document,i=e.getElementById("cocos2d_loadJsImg");return i||(i=document.createElement("img"),cc._loadingImage&&(i.src=cc._loadingImage),(e=e.getElementById(cc.game.config.id)).style.backgroundColor="transparent",e.parentNode.appendChild(i),t=(t=getComputedStyle?getComputedStyle(e):e.currentStyle)||{width:e.width,height:e.height},i.style.left=e.offsetLeft+(parseFloat(t.width)-i.width)/2+"px",i.style.top=e.offsetTop+(parseFloat(t.height)-i.height)/2+"px",i.style.position="absolute"),i},loadTxt:function(t,i){var e,n,s,r,o;cc._isNodeJs?require("fs").readFile(t,function(t,e){t?i(t):i(null,e.toString())}):(e=this.getXMLHttpRequest(),n="load "+t+" failed!",e.open("GET",t,!0),/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)?(e.setRequestHeader("Accept-Charset","utf-8"),e.onreadystatechange=function(){4===e.readyState&&(200===e.status||0===e.status?i(null,e.responseText):i({status:e.status,errorMessage:n},null))}):(e.overrideMimeType&&e.overrideMimeType("text/plain; charset=utf-8"),s=function(){e.removeEventListener("load",s),e.removeEventListener("error",r),0<=e._timeoutId?clearTimeout(e._timeoutId):e.removeEventListener("timeout",o),4===e.readyState&&(200===e.status||0===e.status?i(null,e.responseText):i({status:e.status,errorMessage:n},null))},r=function(){e.removeEventListener("load",s),e.removeEventListener("error",r),0<=e._timeoutId?clearTimeout(e._timeoutId):e.removeEventListener("timeout",o),i({status:e.status,errorMessage:n},null)},o=function(){e.removeEventListener("load",s),e.removeEventListener("error",r),0<=e._timeoutId?clearTimeout(e._timeoutId):e.removeEventListener("timeout",o),i({status:e.status,errorMessage:"Request timeout: "+n},null)},e.addEventListener("load",s),e.addEventListener("error",r),void 0===e.ontimeout?e._timeoutId=setTimeout(function(){o()},e.timeout):e.addEventListener("timeout",o)),e.send(null))},loadCsb:function(t,e){var i=cc.loader.getXMLHttpRequest(),n="load "+t+" failed!",s=(i.open("GET",t,!0),i.responseType="arraybuffer",function(){i.removeEventListener("load",s),i.removeEventListener("error",r),0<=i._timeoutId?clearTimeout(i._timeoutId):i.removeEventListener("timeout",o);var t=i.response;t&&(window.msg=t),4===i.readyState&&(200===i.status||0===i.status?e(null,i.response):e({status:i.status,errorMessage:n},null))}),r=function(){i.removeEventListener("load",s),i.removeEventListener("error",r),0<=i._timeoutId?clearTimeout(i._timeoutId):i.removeEventListener("timeout",o),e({status:i.status,errorMessage:n},null)},o=function(){i.removeEventListener("load",s),i.removeEventListener("error",r),0<=i._timeoutId?clearTimeout(i._timeoutId):i.removeEventListener("timeout",o),e({status:i.status,errorMessage:"Request timeout: "+n},null)};i.addEventListener("load",s),i.addEventListener("error",r),void 0===i.ontimeout?i._timeoutId=setTimeout(function(){o()},i.timeout):i.addEventListener("timeout",o),i.send(null)},loadJson:function(n,s){this.loadTxt(n,function(t,e){if(t)s(t);else{try{var i=JSON.parse(e)}catch(t){throw Error("parse json ["+n+"] failed : "+t)}s(null,i)}})},_checkIsImageURL:function(t){return null!=/(\.png)|(\.jpg)|(\.bmp)|(\.jpeg)|(\.gif)/.exec(t)},loadImg:function(s,t,r,o){var a={isCrossOrigin:!0};if(void 0!==r?a.isCrossOrigin=(void 0===t.isCrossOrigin?a:t).isCrossOrigin:void 0!==t&&(r=t),t=this.getRes(s))return r&&r(null,t),null;if(t=u[s])return t.callbacks.push(r),t.img;(o=o||imagePool.get()).crossOrigin=a.isCrossOrigin&&"file://"!==location.origin?"Anonymous":null;var c=function(){this.removeEventListener("load",c,!1),this.removeEventListener("error",l,!1);var t=u[s];if(t){for(var e=t.callbacks,i=0;i<e.length;++i){var n=e[i];n&&n(null,o)}t.img=null,delete u[s]}window.ENABLE_IMAEG_POOL&&cc._renderType===cc.game.RENDER_TYPE_WEBGL&&imagePool.put(o)},h=this,l=function(){if(this.removeEventListener("load",c,!1),this.removeEventListener("error",l,!1),"https:"!==window.location.protocol&&o.crossOrigin&&"anonymous"===o.crossOrigin.toLowerCase())a.isCrossOrigin=!1,h.release(s),cc.loader.loadImg(s,a,r,o);else{var t=u[s];if(t){for(var e=t.callbacks,i=0;i<e.length;++i){var n=e[i];n&&n("load image failed")}t.img=null,delete u[s]}cc._renderType===cc.game.RENDER_TYPE_WEBGL&&imagePool.put(o)}};return u[s]={img:o,callbacks:r?[r]:[]},o.addEventListener("load",c),o.addEventListener("error",l),o.src=s,o},_loadResIterator:function(t,e,i){var n=this,s=null,r=t.type;return r?(r="."+r.toLowerCase(),s=t.src||t.name+r):(s=t,r=cc.path.extname(s)),(e=n.getRes(s))?i(null,e):(e=null,(e=r?o[r.toLowerCase()]:e)?(r=s,c.test(s)||(r=e.getBasePath?e.getBasePath():n.resPath,r=n.getUrl(r,s)),cc.game.config.noCache&&"string"==typeof r&&(r=n._noCacheRex.test(r)?r+("&_t="+ +new Date):r+("?_t="+ +new Date)),void e.load(r,s,t,function(t,e){t?(cc.log(t),n.cache[s]=null,delete n.cache[s],i({status:520,errorMessage:t},null)):(n.cache[s]=e,i(null,e))})):(cc.error("loader for ["+r+"] doesn't exist!"),i()))},_noCacheRex:/\?/,getUrl:function(t,e){var i,n=cc.path;if(void 0!==t&&void 0===e&&(e=t,i=(i=n.extname(e))?i.toLowerCase():"",t=(i=o[i])&&i.getBasePath?i.getBasePath():this.resPath),(e=cc.path.join(t||"",e)).match(/[\/(\\\\)]lang[\/(\\\\)]/i)){if(s[e])return s[e];n=n.extname(e)||"",e=s[e]=e.substring(0,e.length-n.length)+"_"+cc.sys.language+n}return e},load:function(t,s,e){var r=this,i=arguments.length;if(0===i)throw Error("arguments error!");return 3===i?"function"==typeof s&&(s="function"==typeof e?{trigger:s,cb:e}:{cb:s,cbTarget:e}):2===i?"function"==typeof s&&(s={cb:s}):1===i&&(s={}),t instanceof Array||(t=[t]),(i=new cc.AsyncPool(t,cc.CONCURRENCY_HTTP_REQUEST_COUNT,function(t,e,i,n){r._loadResIterator(t,e,function(t){var e=Array.prototype.slice.call(arguments,1);s.trigger&&s.trigger.call(s.triggerTarget,e[0],n.size,n.finishedSize),i(t,e[0])})},s.cb,s.cbTarget)).flow(),i},_handleAliases:function(t,e){var i,n=[];for(i in t){var s=t[i];n.push(r[i]=s)}this.load(n,e)},loadAliases:function(t,i){var n=this,e=n.getRes(t);e?n._handleAliases(e.filenames,i):n.load(t,function(t,e){n._handleAliases(e[0].filenames,i)})},register:function(t,e){if(t&&e){if("string"==typeof t)return o[t.trim().toLowerCase()]=e;for(var i=0,n=t.length;i<n;i++)o["."+t[i].trim().toLowerCase()]=e}},getRes:function(t){return this.cache[t]||this.cache[r[t]]},_getAliase:function(t){return r[t]},release:function(t){var e=this.cache,i=u[t];i&&(i.img=null,delete u[t]),delete e[t],delete e[r[t]],delete r[t]},releaseAll:function(){var t,e=this.cache;for(t in e)delete e[t];for(t in r)delete r[t]}}}(),cc.formatStr=function(){var t=arguments,e=t.length;if(e<1)return"";var i=t[0],n=!0;"object"==typeof i&&(n=!1);for(var s=1;s<e;++s){var r=t[s];if(n)for(;;){if("number"==typeof r&&i.match(/(%d)|(%s)/)){i=i.replace(/(%d)|(%s)/,r);break}i=i.match(/%s/)?i.replace(/%s/,r):i+"    "+r;break}else i+="    "+r}return i},!function(){function l(t){cc._initDebugSetting&&cc._initDebugSetting(t[cc.game.CONFIG_KEY.debugMode]),cc._engineLoaded=!0,console.log(cc.ENGINE_VERSION),S&&S()}function o(c){var t,h=c[cc.game.CONFIG_KEY.engineDir],e=cc.loader;cc.Class?l(c):(t=cc.path.join(h,"moduleConfig.json"),e.loadJson(t,function(t,e){if(t)throw Error(t);var i=c.modules||[],n=e.module,s=[];cc.sys.capabilities.opengl&&i.indexOf("base4webgl")<0?i.splice(0,0,"base4webgl"):i.indexOf("core")<0&&i.splice(0,0,"core");for(var r=0,o=i.length;r<o;r++){var a=function t(e,i,n){if(y[i])return null;n=n||"";var s=[],r=e[i];if(!r)throw Error("can not find module ["+i+"]");i=cc.path;for(var o=0,a=r.length;o<a;o++){var c,h=r[o];y[h]||((c=i.extname(h))?".js"===c.toLowerCase()&&s.push(i.join(n,h)):(c=t(e,h,n))&&(s=s.concat(c)),y[h]=1)}return s}(n,i[r],h);a&&(s=s.concat(a))}cc.loader.loadJsWithImg(s,function(t){if(t)throw t;l(c)})}))}function a(){this.removeEventListener("load",a,!1),o(cc.game.config)}var t=document.createElement("canvas"),e=document.createElement("canvas"),i=(cc.create3DContext=function(t,e){for(var i=["webgl","experimental-webgl","webkit-3d","moz-webgl"],n=null,s=0;s<i.length;++s){try{n=t.getContext(i[s],e)}catch(t){}if(n)break}return n},cc.sys={},cc.sys),n=(i.LANGUAGE_ENGLISH="en",i.LANGUAGE_CHINESE="zh",i.LANGUAGE_FRENCH="fr",i.LANGUAGE_ITALIAN="it",i.LANGUAGE_GERMAN="de",i.LANGUAGE_SPANISH="es",i.LANGUAGE_DUTCH="du",i.LANGUAGE_RUSSIAN="ru",i.LANGUAGE_KOREAN="ko",i.LANGUAGE_JAPANESE="ja",i.LANGUAGE_HUNGARIAN="hu",i.LANGUAGE_PORTUGUESE="pt",i.LANGUAGE_ARABIC="ar",i.LANGUAGE_NORWEGIAN="no",i.LANGUAGE_POLISH="pl",i.LANGUAGE_UNKNOWN="unkonwn",i.OS_IOS="iOS",i.OS_ANDROID="Android",i.OS_WINDOWS="Windows",i.OS_MARMALADE="Marmalade",i.OS_LINUX="Linux",i.OS_BADA="Bada",i.OS_BLACKBERRY="Blackberry",i.OS_OSX="OS X",i.OS_WP8="WP8",i.OS_WINRT="WINRT",i.OS_UNKNOWN="Unknown",i.UNKNOWN=-1,i.WIN32=0,i.LINUX=1,i.MACOS=2,i.ANDROID=3,i.IPHONE=4,i.IPAD=5,i.BLACKBERRY=6,i.NACL=7,i.EMSCRIPTEN=8,i.TIZEN=9,i.WINRT=10,i.WP8=11,i.MOBILE_BROWSER=100,i.DESKTOP_BROWSER=101,i.BROWSER_TYPE_WECHAT="wechat",i.BROWSER_TYPE_ANDROID="androidbrowser",i.BROWSER_TYPE_IE="ie",i.BROWSER_TYPE_QQ_APP="qq",i.BROWSER_TYPE_QQ="qqbrowser",i.BROWSER_TYPE_MOBILE_QQ="mqqbrowser",i.BROWSER_TYPE_UC="ucbrowser",i.BROWSER_TYPE_360="360browser",i.BROWSER_TYPE_BAIDU_APP="baiduboxapp",i.BROWSER_TYPE_BAIDU="baidubrowser",i.BROWSER_TYPE_MAXTHON="maxthon",i.BROWSER_TYPE_OPERA="opera",i.BROWSER_TYPE_OUPENG="oupeng",i.BROWSER_TYPE_MIUI="miuibrowser",i.BROWSER_TYPE_FIREFOX="firefox",i.BROWSER_TYPE_SAFARI="safari",i.BROWSER_TYPE_CHROME="chrome",i.BROWSER_TYPE_LIEBAO="liebao",i.BROWSER_TYPE_QZONE="qzone",i.BROWSER_TYPE_SOUGOU="sogou",i.BROWSER_TYPE_UNKNOWN="unknown",i.isNative=!1,window),s=n.navigator,r=document,c=r.documentElement,h=s.userAgent.toLowerCase(),u=(i.isMobile=/mobile|android|iphone|ipad/.test(h),i.platform=i.isMobile?i.MOBILE_BROWSER:i.DESKTOP_BROWSER,(u=(u=s.language)||s.browserLanguage)?u.split("-")[0]:i.LANGUAGE_ENGLISH),d=(i.language=u,!1),u=!1,_="",p=0,f=/android (\d+(?:\.\d+)+)/i.exec(h)||/android (\d+(?:\.\d+)+)/i.exec(s.platform);f&&(d=!0,_=f[1]||"",p=parseInt(_)||0),(f=/(iPad|iPhone|iPod).*OS ((\d+_?){2,3})/i.exec(h))?(u=!0,_=f[2]||"",p=parseInt(_)||0):/(iPhone|iPad|iPod)/.exec(s.platform)&&(u=!0,_="",p=0),f=i.OS_UNKNOWN,-1!==s.appVersion.indexOf("Win")?f=i.OS_WINDOWS:u?f=i.OS_IOS:-1!==s.appVersion.indexOf("Mac")?f=i.OS_OSX:-1!==s.appVersion.indexOf("X11")&&-1===s.appVersion.indexOf("Linux")?f=i.OS_UNIX:d?f=i.OS_ANDROID:-1!==s.appVersion.indexOf("Linux")&&(f=i.OS_LINUX),i.os=f,i.osVersion=_,i.osMainVersion=p,i.browserType=i.BROWSER_TYPE_UNKNOWN,f=/qqbrowser|qq|chrome|safari|firefox|opr|oupeng|opera/i,p=/micromessenger|mqqbrowser|sogou|qzone|liebao|ucbrowser|360 aphone|360browser|baiduboxapp|baidubrowser|maxthon|mxbrowser|trident|miuibrowser/i.exec(h),"micromessenger"===(f=(p=p||f.exec(h))?p[0]:i.BROWSER_TYPE_UNKNOWN)?f=i.BROWSER_TYPE_WECHAT:"safari"===f&&d?f=i.BROWSER_TYPE_ANDROID:"trident"===f?f=i.BROWSER_TYPE_IE:"360 aphone"===f?f=i.BROWSER_TYPE_360:"mxbrowser"===f?f=i.BROWSER_TYPE_MAXTHON:"opr"===f&&(f=i.BROWSER_TYPE_OPERA),i.browserType=f,i.browserVersion="",p=(p=h.match(/(mqqbrowser|micromessenger|sogou|qzone|liebao|maxthon|mxbrowser|baidu)(mobile)?(browser)?\/?([\d.]+)/i))||h.match(/(msie |rv:|firefox|chrome|ucbrowser|qq|oupeng|opera|opr|safari|miui)(mobile)?(browser)?\/?([\d.]+)/i),i.browserVersion=p?p[4]:"",u=window.devicePixelRatio||1,i.windowPixelResolution={width:u*(window.innerWidth||document.documentElement.clientWidth),height:u*(window.innerHeight||document.documentElement.clientHeight)},i._checkWebGLRenderMode=function(){if(cc._renderType!==cc.game.RENDER_TYPE_WEBGL)throw Error("This feature supports WebGL render mode only.")},i._supportCanvasNewBlendModes=((d=t).width=1,d.height=1,(d=d.getContext("2d")).fillStyle="#000",d.fillRect(0,0,1,1),d.globalCompositeOperation="multiply",(f=e).width=1,f.height=1,(h=f.getContext("2d")).fillStyle="#fff",h.fillRect(0,0,1,1),d.drawImage(f,0,0,1,1),0===d.getImageData(0,0,1,1).data[0]),cc.sys.isMobile&&((u=document.createElement("style")).type="text/css",document.body.appendChild(u),u.textContent="body,canvas,div{ -moz-user-select: none;-webkit-user-select: none;-ms-user-select: none;-khtml-user-select: none;-webkit-tap-highlight-color:rgba(0,0,0,0);}");try{var g=i.localStorage=n.localStorage;g.setItem("storage",""),g.removeItem("storage"),g=null}catch(t){i.localStorage={getItem:g=function(){cc.warn("Warning: localStorage isn't enabled. Please confirm browser cookie or privacy option")},setItem:g,removeItem:g,clear:g}}if(g=!!t.getContext("2d"),u=!1,n.WebGLRenderingContext){_=document.createElement("CANVAS");try{if((u=!(u=cc.create3DContext(_)?!0:u)||i.os!==i.OS_IOS||9!==i.osMainVersion||window.indexedDB?u:!1)&&i.os===i.OS_ANDROID){var m=parseFloat(i.browserVersion);switch(i.browserType){case i.BROWSER_TYPE_MOBILE_QQ:case i.BROWSER_TYPE_BAIDU:case i.BROWSER_TYPE_BAIDU_APP:u=6.2<=m;break;case i.BROWSER_TYPE_CHROME:u=30<=m;break;case i.BROWSER_TYPE_ANDROID:i.osMainVersion&&5<=i.osMainVersion&&(u=!0);break;case i.BROWSER_TYPE_UNKNOWN:case i.BROWSER_TYPE_360:case i.BROWSER_TYPE_MIUI:case i.BROWSER_TYPE_UC:u=!1}}}catch(t){}_=null}m=i.capabilities={canvas:g,opengl:u},void 0===c.ontouchstart&&void 0===r.ontouchstart&&!s.msPointerEnabled||(m.touches=!0),void 0!==c.onmouseup&&(m.mouse=!0),void 0!==c.onkeyup&&(m.keyboard=!0),(n.DeviceMotionEvent||n.DeviceOrientationEvent)&&(m.accelerometer=!0),i.garbageCollect=function(){},i.dumpRoot=function(){},i.restartVM=function(){},i.cleanScript=function(t){},i.isObjectValid=function(t){return!!t},i.dump=function(){var t="isMobile : "+this.isMobile+"\r\n";t=(t=(t=(t=(t=(t=(t=(t+="language : "+this.language+"\r\n")+"browserType : "+this.browserType+"\r\n")+"browserVersion : "+this.browserVersion+"\r\n")+"capabilities : "+JSON.stringify(this.capabilities)+"\r\n")+"os : "+this.os+"\r\n")+"osVersion : "+this.osVersion+"\r\n")+"platform : "+this.platform+"\r\n")+"Using "+(cc._renderType===cc.game.RENDER_TYPE_WEBGL?"WEBGL":"CANVAS")+" renderer.\r\n",cc.log(t)},i.openURL=function(t){window.open(t)},i.now=function(){return Date.now?Date.now():+new Date},t=null,cc.log=cc.warn=cc.error=cc.assert=function(){};var y={},T=!1,S=null;cc._engineLoaded=!1,cc.initEngine=function(t,e){var i,n,s,r;T?(i=S,S=function(){i&&i(),e&&e()}):(S=e,!cc.game.config&&t?cc.game.config=t:cc.game.config||cc.game._loadConfig(),t=cc.game.config,n=t,s=cc.game.CONFIG_KEY,r=parseInt(n[s.renderMode])||0,(isNaN(r)||2<r||r<0)&&(n[s.renderMode]=0),cc._renderType=cc.game.RENDER_TYPE_CANVAS,cc._supportRender=!1,0===r?cc.sys.capabilities.opengl?(cc._renderType=cc.game.RENDER_TYPE_WEBGL,cc._supportRender=!0):cc.sys.capabilities.canvas&&(cc._renderType=cc.game.RENDER_TYPE_CANVAS,cc._supportRender=!0):1===r&&cc.sys.capabilities.canvas?(cc._renderType=cc.game.RENDER_TYPE_CANVAS,cc._supportRender=!0):2===r&&cc.sys.capabilities.opengl&&(cc._renderType=cc.game.RENDER_TYPE_WEBGL,cc._supportRender=!0),document.body?o(t):cc._addEventListener(window,"load",a,!1),T=!0)}}(),cc.game={DEBUG_MODE_NONE:0,DEBUG_MODE_INFO:1,DEBUG_MODE_WARN:2,DEBUG_MODE_ERROR:3,DEBUG_MODE_INFO_FOR_WEB_PAGE:4,DEBUG_MODE_WARN_FOR_WEB_PAGE:5,DEBUG_MODE_ERROR_FOR_WEB_PAGE:6,EVENT_HIDE:"game_on_hide",EVENT_SHOW:"game_on_show",EVENT_RESIZE:"game_on_resize",EVENT_RENDERER_INITED:"renderer_inited",RENDER_TYPE_CANVAS:0,RENDER_TYPE_WEBGL:1,RENDER_TYPE_OPENGL:2,_eventHide:null,_eventShow:null,CONFIG_KEY:{width:"width",height:"height",engineDir:"engineDir",modules:"modules",debugMode:"debugMode",exposeClassName:"exposeClassName",showFPS:"showFPS",frameRate:"frameRate",id:"id",renderMode:"renderMode",jsList:"jsList"},_paused:!0,_configLoaded:!1,_prepareCalled:!1,_prepared:!1,_rendererInitialized:!1,_renderContext:null,_intervalId:null,_lastTime:null,_frameTime:null,frame:null,container:null,canvas:null,config:null,onStart:null,onStop:null,setFrameRate:function(t){this.config[this.CONFIG_KEY.frameRate]=t,this._intervalId&&window.cancelAnimationFrame(this._intervalId),this._intervalId=0,this._paused=!0,this._setAnimFrame(),this._runMainLoop()},step:function(){cc.director.mainLoop()},pause:function(){this._paused||(this._paused=!0,cc.audioEngine&&cc.audioEngine._pausePlaying(),this._intervalId&&window.cancelAnimationFrame(this._intervalId),this._intervalId=0)},resume:function(){this._paused&&(this._paused=!1,cc.audioEngine&&cc.audioEngine._resumePlaying(),this._runMainLoop())},isPaused:function(){return this._paused},restart:function(){cc.director.popToSceneStackLevel(0),cc.audioEngine&&cc.audioEngine.end(),cc.game.onStart()},end:function(){close()},prepare:function(e){var i=this,t=i.config,n=i.CONFIG_KEY;this._configLoaded?this._prepared?e&&e():this._prepareCalled||(cc._engineLoaded?(this._prepareCalled=!0,this._initRenderer(t[n.width],t[n.height]),cc.view=cc.EGLView._getInstance(),cc.director=cc.Director._getInstance(),cc.director.setOpenGLView&&cc.director.setOpenGLView(cc.view),cc.winSize=cc.director.getWinSize(),this._initEvents(),this._setAnimFrame(),this._runMainLoop(),(t=t[n.jsList])?cc.loader.loadJsWithImg(t,function(t){if(t)throw Error(t);i._prepared=!0,e&&e()}):e&&e()):cc.initEngine(this.config,function(){i.prepare(e)})):this._loadConfig(function(){i.prepare(e)})},run:function(t,e){"function"==typeof t?cc.game.onStart=t:(t&&("string"==typeof t?(cc.game.config||this._loadConfig(),cc.game.config[cc.game.CONFIG_KEY.id]=t):cc.game.config=t),"function"==typeof e&&(cc.game.onStart=e)),this.prepare(cc.game.onStart&&cc.game.onStart.bind(cc.game))},_setAnimFrame:function(){this._lastTime=new Date;var t=cc.game.config[cc.game.CONFIG_KEY.frameRate];this._frameTime=1e3/t,60!==t&&30!==t?(window.requestAnimFrame=this._stTime,window.cancelAnimationFrame=this._ctTime):(window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||this._stTime,window.cancelAnimationFrame=window.cancelAnimationFrame||window.cancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.webkitCancelRequestAnimationFrame||window.msCancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.oCancelAnimationFrame||this._ctTime)},_stTime:function(t){var e=(new Date).getTime(),i=Math.max(0,cc.game._frameTime-(e-cc.game._lastTime)),n=window.setTimeout(function(){t()},i);return cc.game._lastTime=e+i,n},_ctTime:function(t){window.clearTimeout(t)},_runMainLoop:function(){var t,e=this,i=e.config,n=e.CONFIG_KEY,s=cc.director,r=!0,o=i[n.frameRate];s.setDisplayStats(i[n.showFPS]),t=function(){e._paused||(30===o&&(r=!r)||s.mainLoop(),e._intervalId=window.requestAnimFrame(t))},e._intervalId=window.requestAnimFrame(t),e._paused=!1},_loadConfig:function(i){if(s=this.config||document.ccConfig)this._initConfig(s),i&&i();else{for(var t=document.getElementsByTagName("script"),e=0;e<t.length&&""!==(s=t[e].getAttribute("cocos"))&&!s;e++);var n=this,s=function(t,e){e=JSON.parse(e);n._initConfig(e),i&&i()};e<t.length&&((t=t[e].src)&&(t=/(.*)\//.exec(t)[0],cc.loader.resPath=t,t=cc.path.join(t,"project.json")),cc.loader.loadTxt(t,s)),cc.loader.loadTxt("project.json",s)}},_initConfig:function(t){var e=this.CONFIG_KEY,i=t[e.modules];t[e.showFPS]=void 0===t[e.showFPS]||t[e.showFPS],t[e.engineDir]=t[e.engineDir]||"frameworks/cocos2d-html5",null==t[e.debugMode]&&(t[e.debugMode]=0),t[e.exposeClassName]=!!t[e.exposeClassName],t[e.frameRate]=t[e.frameRate]||60,null==t[e.renderMode]&&(t[e.renderMode]=0),null==t[e.registerSystemEvent]&&(t[e.registerSystemEvent]=!0),i&&i.indexOf("core")<0&&i.splice(0,0,"core"),i&&(t[e.modules]=i),this.config=t,this._configLoaded=!0},_initRenderer:function(t,e){if(!this._rendererInitialized){if(!cc._supportRender)throw Error("The renderer doesn't support the renderMode "+this.config[this.CONFIG_KEY.renderMode]);var i,n,s=this.config[cc.game.CONFIG_KEY.id],r=window;"CANVAS"===(s=cc.$(s)||cc.$("#"+s)).tagName?(t=t||s.width,e=e||s.height,this.canvas=cc._canvas=i=s,this.container=cc.container=n=document.createElement("DIV"),i.parentNode&&i.parentNode.insertBefore(n,i)):("DIV"!==s.tagName&&cc.log("Warning: target element is not a DIV or CANVAS"),t=t||s.clientWidth,e=e||s.clientHeight,this.canvas=cc._canvas=i=cc.$(document.createElement("CANVAS")),this.container=cc.container=n=document.createElement("DIV"),s.appendChild(n)),n.setAttribute("id","Cocos2dGameContainer"),n.appendChild(i),this.frame=n.parentNode===document.body?document.documentElement:n.parentNode,i.addClass("gameCanvas"),i.setAttribute("width",t||480),i.setAttribute("height",e||320),i.setAttribute("tabindex",99),cc._renderType===cc.game.RENDER_TYPE_WEBGL&&(this._renderContext=cc._renderContext=cc.webglContext=cc.create3DContext(i,{stencil:!0,alpha:!1})),this._renderContext?(cc.renderer=cc.rendererWebGL,r.gl=this._renderContext,cc.renderer.init(),cc._drawingUtil=new cc.DrawingPrimitiveWebGL(this._renderContext),cc.textureCache._initializingRenderer(),cc.glExt={},cc.glExt.instanced_arrays=r.gl.getExtension("ANGLE_instanced_arrays"),cc.glExt.element_uint=r.gl.getExtension("OES_element_index_uint")):(cc._renderType=cc.game.RENDER_TYPE_CANVAS,cc.renderer=cc.rendererCanvas,this._renderContext=cc._renderContext=new cc.CanvasContextWrapper(i.getContext("2d")),cc._drawingUtil=cc.DrawingPrimitiveCanvas?new cc.DrawingPrimitiveCanvas(this._renderContext):null),cc._gameDiv=n,cc.game.canvas.oncontextmenu=function(){if(!cc._isContextMenuEnable)return!1},this.dispatchEvent(this.EVENT_RENDERER_INITED,!0),this._rendererInitialized=!0}},_initEvents:function(){function e(){cc.eventManager&&cc.game._eventHide&&cc.eventManager.dispatchEvent(cc.game._eventHide)}function i(){cc.eventManager&&cc.game._eventShow&&cc.eventManager.dispatchEvent(cc.game._eventShow)}var n,t=window,s=(this._eventHide=this._eventHide||new cc.EventCustom(this.EVENT_HIDE),this._eventHide.setUserData(this),this._eventShow=this._eventShow||new cc.EventCustom(this.EVENT_SHOW),this._eventShow.setUserData(this),this.config[this.CONFIG_KEY.registerSystemEvent]&&cc.inputManager.registerSystemEvent(this.canvas),cc.isUndefined(document.hidden)?cc.isUndefined(document.mozHidden)?cc.isUndefined(document.msHidden)?cc.isUndefined(document.webkitHidden)||(n="webkitHidden"):n="msHidden":n="mozHidden":n="hidden",["visibilitychange","mozvisibilitychange","msvisibilitychange","webkitvisibilitychange","qbrowserVisibilityChange"]);if(n)for(var r=0;r<s.length;r++)document.addEventListener(s[r],function(t){(document[n]||t.hidden?e:i)()},!1);else t.addEventListener("blur",e,!1),t.addEventListener("focus",i,!1);-1<navigator.userAgent.indexOf("MicroMessenger")&&(t.onfocus=function(){i()}),"onpageshow"in window&&"onpagehide"in window&&(t.addEventListener("pagehide",e,!1),t.addEventListener("pageshow",i,!1)),cc.eventManager.addCustomListener(cc.game.EVENT_HIDE,function(){cc.game.pause()}),cc.eventManager.addCustomListener(cc.game.EVENT_SHOW,function(){cc.game.resume()})}},Function.prototype.bind=Function.prototype.bind||function(t){var e,i,n,s;if(cc.isFunction(this))return e=Array.prototype.slice.call(arguments,1),i=this,s=function(){return i.apply(this instanceof n&&t?this:t,e.concat(Array.prototype.slice.call(arguments)))},(n=function(){}).prototype=this.prototype,s.prototype=new n,s;throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable")},cc.EventHelper=function(){},cc.EventHelper.prototype={constructor:cc.EventHelper,apply:function(t){t.addEventListener=cc.EventHelper.prototype.addEventListener,t.hasEventListener=cc.EventHelper.prototype.hasEventListener,t.removeEventListener=cc.EventHelper.prototype.removeEventListener,t.dispatchEvent=cc.EventHelper.prototype.dispatchEvent},addEventListener:function(t,e,i){var n;"load"===t&&this._textureLoaded?setTimeout(function(){e.call(i)},0):(void 0===this._listeners&&(this._listeners={}),void 0===(n=this._listeners)[t]&&(n[t]=[]),this.hasEventListener(t,e,i)||n[t].push({callback:e,eventTarget:i}))},hasEventListener:function(t,e,i){if(void 0!==this._listeners){var n=this._listeners;if(void 0!==n[t]){t=0;for(var s=n.length;t<s;t++){var r=n[t];if(r.callback===e&&r.eventTarget===i)return!0}}}return!1},removeEventListener:function(t,e,i){if(void 0!==this._listeners&&void 0!==(t=this._listeners[t]))for(var n=0;n<t.length;){var s=t[n];s.eventTarget===i&&s.callback===e?t.splice(n,1):n++}},removeEventTarget:function(t,e,i){if(void 0!==this._listeners&&void 0!==(t=this._listeners[t]))for(e=0;e<t.length;)t[e].eventTarget===i?t.splice(e,1):e++},dispatchEvent:function(t,e){if(void 0!==this._listeners){null==e&&(e=!0);var i=this._listeners[t];if(void 0!==i){for(var n=[],s=i.length,r=0;r<s;r++)n[r]=i[r];for(r=0;r<s;r++)n[r].callback.call(n[r].eventTarget,this);e&&(i.length=0)}}}},cc.EventHelper.prototype.apply(cc.game),cc._LogInfos={ActionManager_addAction:"cc.ActionManager.addAction(): action must be non-null",ActionManager_removeAction:"cocos2d: removeAction: Target not found",ActionManager_removeActionByTag:"cc.ActionManager.removeActionByTag(): an invalid tag",ActionManager_removeActionByTag_2:"cc.ActionManager.removeActionByTag(): target must be non-null",ActionManager_getActionByTag:"cc.ActionManager.getActionByTag(): an invalid tag",ActionManager_getActionByTag_2:"cocos2d : getActionByTag(tag = %s): Action not found",configuration_dumpInfo:"cocos2d: **** WARNING **** CC_ENABLE_PROFILERS is defined. Disable it when you finish profiling (from ccConfig.js)",configuration_loadConfigFile:"Expected 'data' dict, but not found. Config file: %s",configuration_loadConfigFile_2:"Please load the resource first : %s",Director_resume:"cocos2d: Director: Error in gettimeofday",Director_setProjection:"cocos2d: Director: unrecognized projection",Director_popToSceneStackLevel:"cocos2d: Director: unrecognized projection",Director_popToSceneStackLevel_2:"cocos2d: Director: Error in gettimeofday",Director_popScene:"running scene should not null",Director_pushScene:"the scene should not null",arrayVerifyType:"element type is wrong!",Scheduler_scheduleCallbackForTarget:"CCSheduler#scheduleCallback. Callback already scheduled. Updating interval from:%s to %s",Scheduler_scheduleCallbackForTarget_2:"cc.scheduler.scheduleCallbackForTarget(): callback_fn should be non-null.",Scheduler_scheduleCallbackForTarget_3:"cc.scheduler.scheduleCallbackForTarget(): target should be non-null.",Scheduler_pauseTarget:"cc.Scheduler.pauseTarget():target should be non-null",Scheduler_resumeTarget:"cc.Scheduler.resumeTarget():target should be non-null",Scheduler_isTargetPaused:"cc.Scheduler.isTargetPaused():target should be non-null",Node_getZOrder:"getZOrder is deprecated. Please use getLocalZOrder instead.",Node_setZOrder:"setZOrder is deprecated. Please use setLocalZOrder instead.",Node_getRotation:"RotationX != RotationY. Don't know which one to return",Node_getScale:"ScaleX != ScaleY. Don't know which one to return",Node_addChild:"An Node can't be added as a child of itself.",Node_addChild_2:"child already added. It can't be added again",Node_addChild_3:"child must be non-null",Node_removeFromParentAndCleanup:"removeFromParentAndCleanup is deprecated. Use removeFromParent instead",Node_boundingBox:"boundingBox is deprecated. Use getBoundingBox instead",Node_removeChildByTag:"argument tag is an invalid tag",Node_removeChildByTag_2:"cocos2d: removeChildByTag(tag = %s): child not found!",Node_removeAllChildrenWithCleanup:"removeAllChildrenWithCleanup is deprecated. Use removeAllChildren instead",Node_stopActionByTag:"cc.Node.stopActionBy(): argument tag an invalid tag",Node_getActionByTag:"cc.Node.getActionByTag(): argument tag is an invalid tag",Node_resumeSchedulerAndActions:"resumeSchedulerAndActions is deprecated, please use resume instead.",Node_pauseSchedulerAndActions:"pauseSchedulerAndActions is deprecated, please use pause instead.",Node__arrayMakeObjectsPerformSelector:"Unknown callback function",Node_reorderChild:"cc.Node.reorderChild(): child must be non-null",Node_reorderChild_2:"cc.Node.reorderChild(): this child is not in children list",Node_runAction:"cc.Node.runAction(): action must be non-null",Node_schedule:"callback function must be non-null",Node_schedule_2:"interval must be positive",Node_initWithTexture:"cocos2d: Could not initialize cc.AtlasNode. Invalid Texture.",AtlasNode_updateAtlasValues:"cc.AtlasNode.updateAtlasValues(): Shall be overridden in subclasses",AtlasNode_initWithTileFile:"",AtlasNode__initWithTexture:"cocos2d: Could not initialize cc.AtlasNode. Invalid Texture.",_EventListenerKeyboard_checkAvailable:"cc._EventListenerKeyboard.checkAvailable(): Invalid EventListenerKeyboard!",_EventListenerTouchOneByOne_checkAvailable:"cc._EventListenerTouchOneByOne.checkAvailable(): Invalid EventListenerTouchOneByOne!",_EventListenerTouchAllAtOnce_checkAvailable:"cc._EventListenerTouchAllAtOnce.checkAvailable(): Invalid EventListenerTouchAllAtOnce!",_EventListenerAcceleration_checkAvailable:"cc._EventListenerAcceleration.checkAvailable(): _onAccelerationEvent must be non-nil",EventListener_create:"Invalid parameter.",__getListenerID:"Don't call this method if the event is for touch.",eventManager__forceAddEventListener:"Invalid scene graph priority!",eventManager_addListener:"0 priority is forbidden for fixed priority since it's used for scene graph based priority.",eventManager_removeListeners:"Invalid listener type!",eventManager_setPriority:"Can't set fixed priority with scene graph based listener.",eventManager_addListener_2:"Invalid parameters.",eventManager_addListener_3:"listener must be a cc.EventListener object when adding a fixed priority listener",eventManager_addListener_4:"The listener has been registered, please don't register it again.",LayerMultiplex_initWithLayers:"parameters should not be ending with null in Javascript",LayerMultiplex_switchTo:"Invalid index in MultiplexLayer switchTo message",LayerMultiplex_switchToAndReleaseMe:"Invalid index in MultiplexLayer switchTo message",LayerMultiplex_addLayer:"cc.Layer.addLayer(): layer should be non-null",EGLView_setDesignResolutionSize:"Resolution not valid",EGLView_setDesignResolutionSize_2:"should set resolutionPolicy",inputManager_handleTouchesBegin:"The touches is more than MAX_TOUCHES, nUnusedIndex = %s",swap:"cc.swap is being modified from original macro, please check usage",checkGLErrorDebug:"WebGL error %s",animationCache__addAnimationsWithDictionary:"cocos2d: cc.AnimationCache: No animations were found in provided dictionary.",animationCache__addAnimationsWithDictionary_2:"cc.AnimationCache. Invalid animation format",animationCache_addAnimations:"cc.AnimationCache.addAnimations(): File could not be found",animationCache__parseVersion1:"cocos2d: cc.AnimationCache: Animation '%s' found in dictionary without any frames - cannot add to animation cache.",animationCache__parseVersion1_2:"cocos2d: cc.AnimationCache: Animation '%s' refers to frame '%s' which is not currently in the cc.SpriteFrameCache. This frame will not be added to the animation.",animationCache__parseVersion1_3:"cocos2d: cc.AnimationCache: None of the frames for animation '%s' were found in the cc.SpriteFrameCache. Animation is not being added to the Animation Cache.",animationCache__parseVersion1_4:"cocos2d: cc.AnimationCache: An animation in your dictionary refers to a frame which is not in the cc.SpriteFrameCache. Some or all of the frames for the animation '%s' may be missing.",animationCache__parseVersion2:"cocos2d: CCAnimationCache: Animation '%s' found in dictionary without any frames - cannot add to animation cache.",animationCache__parseVersion2_2:"cocos2d: cc.AnimationCache: Animation '%s' refers to frame '%s' which is not currently in the cc.SpriteFrameCache. This frame will not be added to the animation.",animationCache_addAnimations_2:"cc.AnimationCache.addAnimations(): Invalid texture file name",Sprite_ignoreAnchorPointForPosition:"cc.Sprite.ignoreAnchorPointForPosition(): it is invalid in cc.Sprite when using SpriteBatchNode",Sprite_setDisplayFrameWithAnimationName:"cc.Sprite.setDisplayFrameWithAnimationName(): Frame not found",Sprite_setDisplayFrameWithAnimationName_2:"cc.Sprite.setDisplayFrameWithAnimationName(): Invalid frame index",Sprite_setDisplayFrame:"setDisplayFrame is deprecated, please use setSpriteFrame instead.",Sprite__updateBlendFunc:"cc.Sprite._updateBlendFunc(): _updateBlendFunc doesn't work when the sprite is rendered using a cc.CCSpriteBatchNode",Sprite_initWithSpriteFrame:"cc.Sprite.initWithSpriteFrame(): spriteFrame should be non-null",Sprite_initWithSpriteFrameName:"cc.Sprite.initWithSpriteFrameName(): spriteFrameName should be non-null",Sprite_initWithSpriteFrameName1:" is null, please check.",Sprite_initWithFile:"cc.Sprite.initWithFile(): filename should be non-null",Sprite_setDisplayFrameWithAnimationName_3:"cc.Sprite.setDisplayFrameWithAnimationName(): animationName must be non-null",Sprite_addChild:"cc.Sprite.addChild(): cc.Sprite only supports cc.Sprites as children when using cc.SpriteBatchNode",Sprite_addChild_2:"cc.Sprite.addChild(): cc.Sprite only supports a sprite using same texture as children when using cc.SpriteBatchNode",Sprite_addChild_3:"cc.Sprite.addChild(): child should be non-null",Sprite_setTexture:"cc.Sprite.texture setter: Batched sprites should use the same texture as the batchnode",Sprite_updateQuadFromSprite:"cc.SpriteBatchNode.updateQuadFromSprite(): cc.SpriteBatchNode only supports cc.Sprites as children",Sprite_insertQuadFromSprite:"cc.SpriteBatchNode.insertQuadFromSprite(): cc.SpriteBatchNode only supports cc.Sprites as children",Sprite_addChild_4:"cc.SpriteBatchNode.addChild(): cc.SpriteBatchNode only supports cc.Sprites as children",Sprite_addChild_5:"cc.SpriteBatchNode.addChild(): cc.Sprite is not using the same texture",Sprite_initWithTexture:"Sprite.initWithTexture(): Argument must be non-nil ",Sprite_setSpriteFrame:"Invalid spriteFrameName",Sprite_setTexture_2:"Invalid argument: cc.Sprite.texture setter expects a CCTexture2D.",Sprite_updateQuadFromSprite_2:"cc.SpriteBatchNode.updateQuadFromSprite(): sprite should be non-null",Sprite_insertQuadFromSprite_2:"cc.SpriteBatchNode.insertQuadFromSprite(): sprite should be non-null",SpriteBatchNode_addSpriteWithoutQuad:"cc.SpriteBatchNode.addQuadFromSprite(): SpriteBatchNode only supports cc.Sprites as children",SpriteBatchNode_increaseAtlasCapacity:"cocos2d: CCSpriteBatchNode: resizing TextureAtlas capacity from %s to %s.",SpriteBatchNode_increaseAtlasCapacity_2:"cocos2d: WARNING: Not enough memory to resize the atlas",SpriteBatchNode_reorderChild:"cc.SpriteBatchNode.addChild(): Child doesn't belong to Sprite",SpriteBatchNode_removeChild:"cc.SpriteBatchNode.addChild(): sprite batch node should contain the child",SpriteBatchNode_addSpriteWithoutQuad_2:"cc.SpriteBatchNode.addQuadFromSprite(): child should be non-null",SpriteBatchNode_reorderChild_2:"cc.SpriteBatchNode.addChild(): child should be non-null",spriteFrameCache__getFrameConfig:"cocos2d: WARNING: originalWidth/Height not found on the cc.SpriteFrame. AnchorPoint won't work as expected. Regenrate the .plist",spriteFrameCache_addSpriteFrames:"cocos2d: WARNING: an alias with name %s already exists",spriteFrameCache__checkConflict:"cocos2d: WARNING: Sprite frame: %s has already been added by another source, please fix name conflit",spriteFrameCache_getSpriteFrame:"cocos2d: cc.SpriteFrameCahce: Frame %s not found",spriteFrameCache__getFrameConfig_2:"Please load the resource first : %s",spriteFrameCache_addSpriteFrames_2:"cc.SpriteFrameCache.addSpriteFrames(): plist should be non-null",spriteFrameCache_addSpriteFrames_3:"Argument must be non-nil",CCSpriteBatchNode_updateQuadFromSprite:"cc.SpriteBatchNode.updateQuadFromSprite(): cc.SpriteBatchNode only supports cc.Sprites as children",CCSpriteBatchNode_insertQuadFromSprite:"cc.SpriteBatchNode.insertQuadFromSprite(): cc.SpriteBatchNode only supports cc.Sprites as children",CCSpriteBatchNode_addChild:"cc.SpriteBatchNode.addChild(): cc.SpriteBatchNode only supports cc.Sprites as children",CCSpriteBatchNode_initWithTexture:"Sprite.initWithTexture(): Argument must be non-nil ",CCSpriteBatchNode_addChild_2:"cc.Sprite.addChild(): child should be non-null",CCSpriteBatchNode_setSpriteFrame:"Invalid spriteFrameName",CCSpriteBatchNode_setTexture:"Invalid argument: cc.Sprite texture setter expects a CCTexture2D.",CCSpriteBatchNode_updateQuadFromSprite_2:"cc.SpriteBatchNode.updateQuadFromSprite(): sprite should be non-null",CCSpriteBatchNode_insertQuadFromSprite_2:"cc.SpriteBatchNode.insertQuadFromSprite(): sprite should be non-null",CCSpriteBatchNode_addChild_3:"cc.SpriteBatchNode.addChild(): child should be non-null",TextureAtlas_initWithFile:"cocos2d: Could not open file: %s",TextureAtlas_insertQuad:"cc.TextureAtlas.insertQuad(): invalid totalQuads",TextureAtlas_initWithTexture:"cc.TextureAtlas.initWithTexture():texture should be non-null",TextureAtlas_updateQuad:"cc.TextureAtlas.updateQuad(): quad should be non-null",TextureAtlas_updateQuad_2:"cc.TextureAtlas.updateQuad(): Invalid index",TextureAtlas_insertQuad_2:"cc.TextureAtlas.insertQuad(): Invalid index",TextureAtlas_insertQuads:"cc.TextureAtlas.insertQuad(): Invalid index + amount",TextureAtlas_insertQuadFromIndex:"cc.TextureAtlas.insertQuadFromIndex(): Invalid newIndex",TextureAtlas_insertQuadFromIndex_2:"cc.TextureAtlas.insertQuadFromIndex(): Invalid fromIndex",TextureAtlas_removeQuadAtIndex:"cc.TextureAtlas.removeQuadAtIndex(): Invalid index",TextureAtlas_removeQuadsAtIndex:"cc.TextureAtlas.removeQuadsAtIndex(): index + amount out of bounds",TextureAtlas_moveQuadsFromIndex:"cc.TextureAtlas.moveQuadsFromIndex(): move is out of bounds",TextureAtlas_moveQuadsFromIndex_2:"cc.TextureAtlas.moveQuadsFromIndex(): Invalid newIndex",TextureAtlas_moveQuadsFromIndex_3:"cc.TextureAtlas.moveQuadsFromIndex(): Invalid oldIndex",textureCache_addPVRTCImage:"TextureCache:addPVRTCImage does not support on HTML5",textureCache_addETCImage:"TextureCache:addPVRTCImage does not support on HTML5",textureCache_textureForKey:"textureForKey is deprecated. Please use getTextureForKey instead.",textureCache_addPVRImage:"addPVRImage does not support on HTML5",textureCache_addUIImage:"cocos2d: Couldn't add UIImage in TextureCache",textureCache_dumpCachedTextureInfo:"cocos2d: '%s' id=%s %s x %s",textureCache_dumpCachedTextureInfo_2:"cocos2d: '%s' id= HTMLCanvasElement %s x %s",textureCache_dumpCachedTextureInfo_3:"cocos2d: TextureCache dumpDebugInfo: %s textures, HTMLCanvasElement for %s KB (%s MB)",textureCache_addUIImage_2:"cc.Texture.addUIImage(): image should be non-null",Texture2D_initWithETCFile:"initWithETCFile does not support on HTML5",Texture2D_initWithPVRFile:"initWithPVRFile does not support on HTML5",Texture2D_initWithPVRTCData:"initWithPVRTCData does not support on HTML5",Texture2D_addImage:"cc.Texture.addImage(): path should be non-null",Texture2D_initWithImage:"cocos2d: cc.Texture2D. Can't create Texture. UIImage is nil",Texture2D_initWithImage_2:"cocos2d: WARNING: Image (%s x %s) is bigger than the supported %s x %s",Texture2D_initWithString:"initWithString isn't supported on cocos2d-html5",Texture2D_initWithETCFile_2:"initWithETCFile does not support on HTML5",Texture2D_initWithPVRFile_2:"initWithPVRFile does not support on HTML5",Texture2D_initWithPVRTCData_2:"initWithPVRTCData does not support on HTML5",Texture2D_bitsPerPixelForFormat:"bitsPerPixelForFormat: %s, cannot give useful result, it's a illegal pixel format",Texture2D__initPremultipliedATextureWithImage:"cocos2d: cc.Texture2D: Using RGB565 texture since image has no alpha",Texture2D_addImage_2:"cc.Texture.addImage(): path should be non-null",Texture2D_initWithData:"NSInternalInconsistencyException",MissingFile:"Missing file: %s",radiansToDegress:"cc.radiansToDegress() should be called cc.radiansToDegrees()",RectWidth:"Rect width exceeds maximum margin: %s",RectHeight:"Rect height exceeds maximum margin: %s",EventManager__updateListeners:"If program goes here, there should be event in dispatch.",EventManager__updateListeners_2:"_inDispatch should be 1 here."},cc._logToWebPage=function(t){var e,i,n;cc._canvas&&(n=cc._logList,e=document,n||(n=(i=e.createElement("Div")).style,i.setAttribute("id","logInfoDiv"),cc._canvas.parentNode.appendChild(i),i.setAttribute("width","200"),i.setAttribute("height",cc._canvas.height),n.zIndex="99999",n.position="absolute",n.top="0",n.left="0",e=(n=cc._logList=e.createElement("textarea")).style,n.setAttribute("rows","20"),n.setAttribute("cols","30"),n.setAttribute("disabled",!0),i.appendChild(n),e.backgroundColor="transparent",e.borderBottom="1px solid #cccccc",e.borderRightWidth="0px",e.borderLeftWidth="0px",e.borderTopWidth="0px",e.borderTopStyle="none",e.borderRightStyle="none",e.borderLeftStyle="none",e.padding="0px",e.margin=0),n.value=n.value+t+"\r\n",n.scrollTop=n.scrollHeight)},cc._formatString=function(t){if(!cc.isObject(t))return t;try{return JSON.stringify(t)}catch(t){return""}},cc._initDebugSetting=function(t){var n,e=cc.game;t!==e.DEBUG_MODE_NONE&&(t>e.DEBUG_MODE_ERROR?(n=cc._logToWebPage.bind(cc),cc.error=function(){n("ERROR :  "+cc.formatStr.apply(cc,arguments))},cc.assert=function(t,e){if(!t&&e){for(var i=2;i<arguments.length;i++)e=e.replace(/(%s)|(%d)/,cc._formatString(arguments[i]));n("Assert: "+e)}},t!==e.DEBUG_MODE_ERROR_FOR_WEB_PAGE&&(cc.warn=function(){n("WARN :  "+cc.formatStr.apply(cc,arguments))}),t===e.DEBUG_MODE_INFO_FOR_WEB_PAGE&&(cc.log=function(){n(cc.formatStr.apply(cc,arguments))})):console&&console.log.apply&&(cc.error=Function.prototype.bind.call(console.error,console),cc.assert=console.assert?Function.prototype.bind.call(console.assert,console):function(t,e){if(!t&&e){for(var i=2;i<arguments.length;i++)e=e.replace(/(%s)|(%d)/,cc._formatString(arguments[i]));throw Error(e)}},t!==e.DEBUG_MODE_ERROR&&(cc.warn=Function.prototype.bind.call(console.warn,console)),t===e.DEBUG_MODE_INFO)&&(cc.log=Function.prototype.bind.call(console.log,console)))},cc.loader.loadBinary=function(t,e){var i=this,n=this.getXMLHttpRequest(),s="load "+t+" failed!";n.open("GET",t,!0),n.responseType="arraybuffer",cc.loader.loadBinary._IEFilter?(n.setRequestHeader("Accept-Charset","x-user-defined"),n.onreadystatechange=function(){var t;4===n.readyState&&200===n.status?(t=cc._convertResponseBodyToText(n.responseBody),e(null,i._str2Uint8Array(t))):e(s)}):(n.overrideMimeType&&n.overrideMimeType("text/plain; charset=x-user-defined"),n.onload=function(){4===n.readyState&&200===n.status?e(null,new Uint8Array(n.response)):e(s)}),n.send(null)},cc.loader.loadBinary._IEFilter=/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)&&window.IEBinaryToArray_ByteStr&&window.IEBinaryToArray_ByteStr_Last,cc.loader._str2Uint8Array=function(t){if(!t)return null;for(var e=new Uint8Array(t.length),i=0;i<t.length;i++)e[i]=255&t.charCodeAt(i);return e},cc.loader.loadBinarySync=function(t){var e=this.getXMLHttpRequest(),i=(e.timeout=0,"load "+t+" failed!");if(e.open("GET",t,!1),t=null,cc.loader.loadBinary._IEFilter){if(e.setRequestHeader("Accept-Charset","x-user-defined"),e.send(null),200!==e.status)return cc.log(i),null;(e=cc._convertResponseBodyToText(e.responseBody))&&(t=this._str2Uint8Array(e))}else{if(e.overrideMimeType&&e.overrideMimeType("text/plain; charset=x-user-defined"),e.send(null),200!==e.status)return cc.log(i),null;t=this._str2Uint8Array(e.responseText)}return t},window.Uint8Array=window.Uint8Array||window.Array,cc.loader.loadBinary._IEFilter&&(IEBinaryToArray_ByteStr_Script='\x3c!-- IEBinaryToArray_ByteStr --\x3e\r\nFunction IEBinaryToArray_ByteStr(Binary)\r\n   IEBinaryToArray_ByteStr = CStr(Binary)\r\nEnd Function\r\nFunction IEBinaryToArray_ByteStr_Last(Binary)\r\n   Dim lastIndex\r\n   lastIndex = LenB(Binary)\r\n   if lastIndex mod 2 Then\r\n       IEBinaryToArray_ByteStr_Last = Chr( AscB( MidB( Binary, lastIndex, 1 ) ) )\r\n   Else\r\n       IEBinaryToArray_ByteStr_Last = ""\r\n   End If\r\nEnd Function\r\n',myVBScript=document.createElement("script"),myVBScript.type="text/vbscript",myVBScript.textContent=IEBinaryToArray_ByteStr_Script,document.body.appendChild(myVBScript),cc._convertResponseBodyToText=function(t){for(var e={},i=0;i<256;i++)for(var n=0;n<256;n++)e[String.fromCharCode(i+256*n)]=String.fromCharCode(i)+String.fromCharCode(n);return i=IEBinaryToArray_ByteStr(t),t=IEBinaryToArray_ByteStr_Last(t),i.replace(/[\s\S]/g,function(t){return e[t]})+t}),cc=cc||{},cc._loadingImage="data:image/gif;base64,R0lGODlhEAAQALMNAD8/P7+/vyoqKlVVVX9/fxUVFUBAQGBgYMDAwC8vL5CQkP///wAAAP///wAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQFAAANACwAAAAAEAAQAAAEO5DJSau9OOvNex0IMnDIsiCkiW6g6BmKYlBFkhSUEgQKlQCARG6nEBwOgl+QApMdCIRD7YZ5RjlGpCUCACH5BAUAAA0ALAAAAgAOAA4AAAQ6kLGB0JA4M7QW0hrngRllkYyhKAYqKUGguAws0ypLS8JxCLQDgXAIDg+FRKIA6v0SAECCBpXSkstMBAAh+QQFAAANACwAAAAACgAQAAAEOJDJORAac6K1kDSKYmydpASBUl0mqmRfaGTCcQgwcxDEke+9XO2WkxQSiUIuAQAkls0n7JgsWq8RACH5BAUAAA0ALAAAAAAOAA4AAAQ6kMlplDIzTxWC0oxwHALnDQgySAdBHNWFLAvCukc215JIZihVIZEogDIJACBxnCSXTcmwGK1ar1hrBAAh+QQFAAANACwAAAAAEAAKAAAEN5DJKc4RM+tDyNFTkSQF5xmKYmQJACTVpQSBwrpJNteZSGYoFWjIGCAQA2IGsVgglBOmEyoxIiMAIfkEBQAADQAsAgAAAA4ADgAABDmQSVZSKjPPBEDSGucJxyGA1XUQxAFma/tOpDlnhqIYN6MEAUXvF+zldrMBAjHoIRYLhBMqvSmZkggAIfkEBQAADQAsBgAAAAoAEAAABDeQyUmrnSWlYhMASfeFVbZdjHAcgnUQxOHCcqWylKEohqUEAYVkgEAMfkEJYrFA6HhKJsJCNFoiACH5BAUAAA0ALAIAAgAOAA4AAAQ3kMlJq704611SKloCAEk4lln3DQgyUMJxCBKyLAh1EMRR3wiDQmHY9SQslyIQUMRmlmVTIyRaIgA7",cc._fpsImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAAgCAYAAAD9qabkAAAKQ2lDQ1BJQ0MgcHJvZmlsZQAAeNqdU3dYk/cWPt/3ZQ9WQtjwsZdsgQAiI6wIyBBZohCSAGGEEBJAxYWIClYUFRGcSFXEgtUKSJ2I4qAouGdBiohai1VcOO4f3Ke1fXrv7e371/u855zn/M55zw+AERImkeaiagA5UoU8Otgfj09IxMm9gAIVSOAEIBDmy8JnBcUAAPADeXh+dLA//AGvbwACAHDVLiQSx+H/g7pQJlcAIJEA4CIS5wsBkFIAyC5UyBQAyBgAsFOzZAoAlAAAbHl8QiIAqg0A7PRJPgUA2KmT3BcA2KIcqQgAjQEAmShHJAJAuwBgVYFSLALAwgCgrEAiLgTArgGAWbYyRwKAvQUAdo5YkA9AYACAmUIszAAgOAIAQx4TzQMgTAOgMNK/4KlfcIW4SAEAwMuVzZdL0jMUuJXQGnfy8ODiIeLCbLFCYRcpEGYJ5CKcl5sjE0jnA0zODAAAGvnRwf44P5Dn5uTh5mbnbO/0xaL+a/BvIj4h8d/+vIwCBAAQTs/v2l/l5dYDcMcBsHW/a6lbANpWAGjf+V0z2wmgWgrQevmLeTj8QB6eoVDIPB0cCgsL7SViob0w44s+/zPhb+CLfvb8QB7+23rwAHGaQJmtwKOD/XFhbnauUo7nywRCMW735yP+x4V//Y4p0eI0sVwsFYrxWIm4UCJNx3m5UpFEIcmV4hLpfzLxH5b9CZN3DQCshk/ATrYHtctswH7uAQKLDljSdgBAfvMtjBoLkQAQZzQyefcAAJO/+Y9AKwEAzZek4wAAvOgYXKiUF0zGCAAARKCBKrBBBwzBFKzADpzBHbzAFwJhBkRADCTAPBBCBuSAHAqhGJZBGVTAOtgEtbADGqARmuEQtMExOA3n4BJcgetwFwZgGJ7CGLyGCQRByAgTYSE6iBFijtgizggXmY4EImFINJKApCDpiBRRIsXIcqQCqUJqkV1II/ItchQ5jVxA+pDbyCAyivyKvEcxlIGyUQPUAnVAuagfGorGoHPRdDQPXYCWomvRGrQePYC2oqfRS+h1dAB9io5jgNExDmaM2WFcjIdFYIlYGibHFmPlWDVWjzVjHVg3dhUbwJ5h7wgkAouAE+wIXoQQwmyCkJBHWExYQ6gl7CO0EroIVwmDhDHCJyKTqE+0JXoS+cR4YjqxkFhGrCbuIR4hniVeJw4TX5NIJA7JkuROCiElkDJJC0lrSNtILaRTpD7SEGmcTCbrkG3J3uQIsoCsIJeRt5APkE+S+8nD5LcUOsWI4kwJoiRSpJQSSjVlP+UEpZ8yQpmgqlHNqZ7UCKqIOp9aSW2gdlAvU4epEzR1miXNmxZDy6Qto9XQmmlnafdoL+l0ugndgx5Fl9CX0mvoB+nn6YP0dwwNhg2Dx0hiKBlrGXsZpxi3GS+ZTKYF05eZyFQw1zIbmWeYD5hvVVgq9ip8FZHKEpU6lVaVfpXnqlRVc1U/1XmqC1SrVQ+rXlZ9pkZVs1DjqQnUFqvVqR1Vu6k2rs5Sd1KPUM9RX6O+X/2C+mMNsoaFRqCGSKNUY7fGGY0hFsYyZfFYQtZyVgPrLGuYTWJbsvnsTHYF+xt2L3tMU0NzqmasZpFmneZxzQEOxrHg8DnZnErOIc4NznstAy0/LbHWaq1mrX6tN9p62r7aYu1y7Rbt69rvdXCdQJ0snfU6bTr3dQm6NrpRuoW623XP6j7TY+t56Qn1yvUO6d3RR/Vt9KP1F+rv1u/RHzcwNAg2kBlsMThj8MyQY+hrmGm40fCE4agRy2i6kcRoo9FJoye4Ju6HZ+M1eBc+ZqxvHGKsNN5l3Gs8YWJpMtukxKTF5L4pzZRrmma60bTTdMzMyCzcrNisyeyOOdWca55hvtm82/yNhaVFnMVKizaLx5balnzLBZZNlvesmFY+VnlW9VbXrEnWXOss623WV2xQG1ebDJs6m8u2qK2brcR2m23fFOIUjynSKfVTbtox7PzsCuya7AbtOfZh9iX2bfbPHcwcEh3WO3Q7fHJ0dcx2bHC866ThNMOpxKnD6VdnG2ehc53zNRemS5DLEpd2lxdTbaeKp26fesuV5RruutK10/Wjm7ub3K3ZbdTdzD3Ffav7TS6bG8ldwz3vQfTw91jicczjnaebp8LzkOcvXnZeWV77vR5Ps5wmntYwbcjbxFvgvct7YDo+PWX6zukDPsY+Ap96n4e+pr4i3z2+I37Wfpl+B/ye+zv6y/2P+L/hefIW8U4FYAHBAeUBvYEagbMDawMfBJkEpQc1BY0FuwYvDD4VQgwJDVkfcpNvwBfyG/ljM9xnLJrRFcoInRVaG/owzCZMHtYRjobPCN8Qfm+m+UzpzLYIiOBHbIi4H2kZmRf5fRQpKjKqLupRtFN0cXT3LNas5Fn7Z72O8Y+pjLk722q2cnZnrGpsUmxj7Ju4gLiquIF4h/hF8ZcSdBMkCe2J5MTYxD2J43MC52yaM5zkmlSWdGOu5dyiuRfm6c7Lnnc8WTVZkHw4hZgSl7I/5YMgQlAvGE/lp25NHRPyhJuFT0W+oo2iUbG3uEo8kuadVpX2ON07fUP6aIZPRnXGMwlPUit5kRmSuSPzTVZE1t6sz9lx2S05lJyUnKNSDWmWtCvXMLcot09mKyuTDeR55m3KG5OHyvfkI/lz89sVbIVM0aO0Uq5QDhZML6greFsYW3i4SL1IWtQz32b+6vkjC4IWfL2QsFC4sLPYuHhZ8eAiv0W7FiOLUxd3LjFdUrpkeGnw0n3LaMuylv1Q4lhSVfJqedzyjlKD0qWlQyuCVzSVqZTJy26u9Fq5YxVhlWRV72qX1VtWfyoXlV+scKyorviwRrjm4ldOX9V89Xlt2treSrfK7etI66Trbqz3Wb+vSr1qQdXQhvANrRvxjeUbX21K3nShemr1js20zcrNAzVhNe1bzLas2/KhNqP2ep1/XctW/a2rt77ZJtrWv913e/MOgx0VO97vlOy8tSt4V2u9RX31btLugt2PGmIbur/mft24R3dPxZ6Pe6V7B/ZF7+tqdG9s3K+/v7IJbVI2jR5IOnDlm4Bv2pvtmne1cFoqDsJB5cEn36Z8e+NQ6KHOw9zDzd+Zf7f1COtIeSvSOr91rC2jbaA9ob3v6IyjnR1eHUe+t/9+7zHjY3XHNY9XnqCdKD3x+eSCk+OnZKeenU4/PdSZ3Hn3TPyZa11RXb1nQ8+ePxd07ky3X/fJ897nj13wvHD0Ivdi2yW3S609rj1HfnD94UivW2/rZffL7Vc8rnT0Tes70e/Tf/pqwNVz1/jXLl2feb3vxuwbt24m3Ry4Jbr1+Hb27Rd3Cu5M3F16j3iv/L7a/eoH+g/qf7T+sWXAbeD4YMBgz8NZD+8OCYee/pT/04fh0kfMR9UjRiONj50fHxsNGr3yZM6T4aeypxPPyn5W/3nrc6vn3/3i+0vPWPzY8Av5i8+/rnmp83Lvq6mvOscjxx+8znk98ab8rc7bfe+477rfx70fmSj8QP5Q89H6Y8en0E/3Pud8/vwv94Tz+4A5JREAAAAGYktHRAD/AP8A/6C9p5MAAAAJcEhZcwAACxMAAAsTAQCanBgAAAAHdElNRQfcAgcQLxxUBNp/AAAQZ0lEQVR42u2be3QVVZbGv1N17829eRLyIKAEOiISEtPhJTJAYuyBDmhWjAEx4iAGBhxA4wABbVAMWUAeykMCM+HRTcBRWkNH2l5moS0LCCrQTkYeQWBQSCAIgYRXEpKbW/XNH5zS4noR7faPEeu31l0h4dSpvc+t/Z199jkFWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhY/H9D/MR9qfKnLj/00U71aqfJn9+HCkCR/Wk36ddsgyJ/1wF4fkDfqqm9/gPsUeTnVr6a2xlQfnxdI7zs0W7irzD17Ytb2WT7EeNv/r4ox1O3Quf2QP2pgt9utwfout4FQE8AVBSlnaRmfvAURQkg2RlAbwB9AThlW5L0GaiKojhJhgOIBqDa7XaPrusdPtr5kQwF0BVAAoBIABRCKDd5aFUhRDAAw57eAOwAhKIoupft3zoqhB1AqLwuHIBut9uFt02qqvqRDJR2dAEQJj/BAOjn56dqmma+xiaECAEQAWAggLsB6A6HQ2iaZggBhBAqgEAAnQB0kzaEmT4hAITT6VQ8Ho/HJAKKECJQtr8LwD1y/A1/vcdfEUIEyfZ9AcQbYvZ942Px88L2UwlJR0dH0EMPPbRj5syZPUeNGrXR7Xb/641xIwJ1XY9NSUlZm52dfW+XLl1w8uRJzJ8//+OGhoYJqqqe1TSt1Wsm9NN1PSIqKmr12rVrR5WUlHy1bdu2AQCumWc3IYRD1/UwVVXnFRQUTIuNjUVzczN2797dWFJSkq8oymZd15sAGAEnFEUJ1nX9nzIzM1dnZmZGh4SE4OTJk5g5c+Zf29vbp9pstrMej6fVOyhIhgAYU1hY+B+hoaGoqKg4XVlZea+XTULTNFdCQsLGiRMnPuR2u3UhBOV9eeDAAWXTpk095DUe6WsoyRE5OTlr0tLSAux2O/bs2cO5c+e+pijKUpIXSHaQVAGkvPLKK++6XK4OksJLCFlXV2cvKSlJBFAjhU+x2WwhHo9nUHp6+urMzMy7wsLCUF9fjxdffPHjxsbGiTab7WuPx9NiEutOuq4PyMjI+M+srKyYqKgoHD58GDNmzNjq8XhyVFU9b/q+LH7hBAEYu3PnTlZVVRFAGgCX6f/tAHoOHDjwa0p27txp/JO9e/f+QM7cipw9nfL3kQBKt2zZQpJ87rnn6mQmoHilw2EACs+cOUOSrK+vZ1NTE0nyo48+IoBpxswoBcMJ4Ndjx471kOTFixe5d+9ekqTH42H//v13A4jyzpAURfEH0H/OnDnthu1z5sw558MmFUCPWbNmnaMP3nrrLZoyDmP8Hl68eDFJ8siRI9/Yc+zYMQKYKdtAztrTrl27xptRXV1NAKMAOAyBBBA/Y8aMdpLs6Ojgxx9//E37+++//29yvFXppwvAwMcee8xjtDHsuXLlCqOjo//ia3wsfpkoALqFhoZuIckJEyackimm3dQmEMDUmpoakmRISMhhAHOHDx/eQJIbN24kgKEyMAHAFRMTs2XXrl1saWkhSZ0kp0+ffhrAr3wEW/S8efOukORLL72kA1gKYMPWrVtJkk899dRJAHeYrgsEsIQkjx8/TgDvAPjd448/3kaSb7zxBmUa7vC6z53BwcFbSHL9+vU6Sc6aNes8gF5ewWAH0PfVV18lSQL4DMBGIcQ6AKtcLleBFC2jXtFt8ODBe0iyoqKCAJYByC8qKmJDQwOzsrK+MAmqo1OnTveHhoa+GRkZ+XZkZOSWiIiIvzgcjk9mzpypkWRmZuZpmbYbGV4AgPnNzc1sa2sjgN0A5iQmJtaSZHl5OQHcb/K3s81mW0uSTU1NBFAFYFbfvn1Pk+Tbb79NAA8IIVzW42/hByA+Pz/fLR/2ZXIda05NI/z9/TeR5J49ewhgqlxTrtI0jY2NjQQw3zTLuWJiYjaUlJToS5Ys6fjkk080kwDEeAmADcA9GzZsIElGRUW9CyAWwLApU6Y0kOSKFSsog9QICGdERMTGsrIyZmVlEcC9AB4IDw/fTpLbtm0jgN94CUAnAJmVlZVcs2aNZ/LkyRdJcvbs2b4EwAkgZfPmzTxw4AABFAN4BkC6vFeUSewcAO5duXIlSTIhIaEawGMAxgKYAmAGgCS73e5vrKVk/yGythANYEhCQsIhkly+fDkBpKqqGmL6DgIALDKN/3yZpVWQZGVlJQE8aPI3KiMjo5okV61aRQAjAPQBMPfIkSN0u90EUCBtsPiFEwpgbn19PdetW2fM5N4zQ9ekpKQqkty0aRMBpMjiWM6JEydIkoqirJUFJ6iq6pAPVy8A6cZMehMBUACEuVyuFwG8HBwcPEIWx367ZMkSjSQXLVrUJouTRorrkAHdA8BdQogsAOsKCwtJkmPGjDkvMw2bDDo/ADEjRoz4XylyFbm5uY0mAbjLyyZ/AOOrq6tZVlbWsWDBgo69e/eyoqKCgwcPPg4gSQaoIRbp27dvN7KF+tLSUr28vJwFBQXtMpvpYRIM7+wrAkDeqVOnePbsWQIoNKfzpiXPg8uXLydJJicnNwF4f+nSpW6STEtLq5fjYwhk1wkTJtSQ5Ouvv04AqTKj+N2xY8dIkgEBAW/Ie1v8wncRegwZMmQvSfbr12+3Ua33WqPfOWbMmP0kWVpaSgCDZAqcfejQIWNZsEGKgvnh9gfQb9myZd8nAEJVVZtMkUNk8CcNHTq0liR1XWdYWNhmH1mJIme80OnTp18x1rp5eXkEsNJms92Fb7e/IgEsvHz5Mp999tkmAI/l5uZeMC0B7vEqqAYAyL106RJJsra2lpWVld+sucePH38ZQG+5NncBeOrgwYMkqbe3t/Po0aOsra011wAWyl0H7x0JJ4DE+fPnu0kyPT29DsDdUrBuyNKEEAkAdpw/f/6GeoEM8GUmfwEgPCIiopwkGxsbabPZPgOw6L777vvm4p49e26VGYjFLxUhhD+ApLKyMp44ccIoVnXybgbgzkcfffRzklyzZg0BDJYCMMmoCwQFBXkLgLGWvvcWAgBToSsKwNPTp09vMR7UuLi4rwH0lgU8c/Db5ezbeeTIkRWzZ8++aMxu+fn5BPCADBwHgP4LFy701NXVEUAJgAnPP/98kyxMNgHo53A4zH77BQQETMvPz7+Um5vbBuAlAFMSExPPmdbVL0qh8Acw8fDhw5SCchVAEYAVb775JknyhRdeaJYztHfxMwLAaqNwCGC2FArv8x0hAHKNLGPKlCme5OTk/Zs3bzb7O0wKiiG8KXl5ed8IxenTp0mSR48e1UmyW7duWywBuD2xyQcgFECgoih+8H1gyJgZV5Lkyy+/3CbTRIePtl2HDBmyw1QBHyGDdXZdXR1JUghRKkXBjOMHCoBdpr0L3nvvPZLkF198wejo6O0A4lVVDTb74HQ6AwD8Wq7Jh8rgGgDgQ13XjVR8qaxJuADMbmlpYXl5uV5UVNRWUFDgfv/993Vj/ZydnU1c37eHXML4S3viAcQqitJD2l104cIFY8lTKsXSBWBMVVWVcd9yed2A1NTUQ6Zl00CvLMMOoHdubm6zFIlWOf5+PsY/Kj09vdrU11QAwwGsv3jxIk21m2DZr10I0RXAuAcffPBgaWkpV69eTYfDcdiwUxY0w6xw+flX8L1xApjevXv3lREREaW6rofB93aPDUDQpEmTMgHgtddeqwBwEd/utZvpqK6uPgEAcXFxkA94NwB9unfvjrNnz4LklwDcf08iIqv66Zs2bXrl4YcfxooVKxAbG7uqrq5uAYA2TdOEqqpGYIi2tjbl6aeffu/YsWPv5uTk7JaC1wHg4Pnz542MwoVvTx+21dbWYvjw4WLixIl+2dnZ9lGjRgmSTE1NRUpKCkwFTGiaxtTU1OXTpk3707Bhw/6g67pDipnT4biuj7qut+Lbk3Vf1tTUXI9qu91Pjq1QFEUBgJaWFgBo8yGOQ8eNGxcAAOvXr/8QwBUfYygAKL169eoCABcuXACAWtn2hOGv0+kMNO1KiPDw8F4A4rZv3/7R1KlTR0+bNu1ht9u9r1+/fqitrQXJgwDarRC6/QjPzs4+QJIffPCB9/aQmSAA43ft2mW0e1QGoi8CAPyLsZccExNTC2BlRkbGRdOyYJCP2csBIN6UAZzCd7cBbQCijYp/dXU1ExMTz6SmptaMHj36f9LS0vYlJCRsl6mxIWSdu3fv/g5J7t+/nwC2AShMTk6+SJKff/45AWRLYbD7+fndAeDf5BJnLoCCyZMnt5JkdnZ2C4B/F0KEm1Pu+Pj4rST55ZdfEsBWAK+mpaVdMo3raDn7KwDuSEpK+m+S3LBhAwG8DuCtHTt2UBbpjgC408vvcFVV15HkuXPnjMp+p5uMf0RcXNyHJNnQ0EBVVfcCWBQXF3fG+Jv0yxABPwB5LS0tRmFxN4BlTzzxxGWSXLx4sS5F3GGFy+1Hp5SUlJq6ujoWFxdTpsZ2H+0iIyMj/0iSWVlZX5mr5jfJFroPGzasxlhTnjp1iiTZ3NxMl8tlrCd9pfa9SkpKSJI5OTmnZOageLUZZqxvfVFWVkZcPwdgNwnSCKPqb17jkmR8fPzfZMDZ5CRsFBmNI7h95s2b1yhT7/MAYmStwCx4vy0uLqa3v5qmEcCfvSr1QQAeXb16NY3Cm3HQ55133iGAp+SxZTNhKSkpfzUddkrFjYevzAQCeGjp0qXfsYckY2NjTwD4leGDLCL2HTdunNtoY+zWSHFcIHdsFCtcfuZ1vO9Eqs3m7/F47sb1k2qX/f3997W2tl7BjWfpBYDOzzzzzIVJkyZh0KBBCwEsB3AJvl9AETabLcDj8dwRFRW1ctasWb8JCgpSzp07d62wsPC/Wltb8xRFadR1/ZqPXYbgAQMGbI2Pjw/+6quv9ldVVT0r01ezuPRJSUn5Y9euXXVd11WzDaqq6kePHm3+7LPPRgO4KlNuxWazhXo8nuTk5OSXMjIyEl0uFxoaGtqKior+dPXq1VdUVT0jj7r68ieoT58+vx8yZMjdx48fP1JVVTVF9m20VW02WyfZf97YsWPjXS4X6urqWvPy8jYCWCyEuEDS8FdVFKWzruv//OSTTy5OTk7uqWkaPv3007qysrJ8RVH+LI8ym8/rB3Tu3HnRI488knLo0KG2ffv2ZQI4C98vP6mqqoZqmpaclpa2cOTIkX39/f3R0NDQUVxc/G5TU9PLqqrWa5rWLH1QVFUN0TStX1JSUvH48eP7BwYG4uDBg1cKCgpeBbBe2u+2Qug2EwD5N5sMPuNtMe8XP4TT6Qxoa2sbIGeXvUKIK7d4IISiKC5d1wPljOfA9bPwzYqiXNV13dd6Uqiq6qdpml2mpe02m63d4/G4vcTF5fF47LJf71nJA6BZVVW3pmntuPHlmAD5wk6Q9NnbHp9vHaqq6tA0zU/64PZhk1FfCZB9G/23ALiqKEqzD39tpvbGUqoFwFUhRLP3yzpCCDtJpxyXDulfG27+pqRR3DXsUWVd4Yq0x/taVQjhIhksC8L+ABpM9ljBf5sKwI8pIBr75L5E4vvu+UNeG/a+hv+AL7yFH8qPtOfHjtOP6V/Bja8D6z/B2Nys/1u9Xv33tLf4GfF/LC4GCJwByWIAAAAASUVORK5CYII=",cc._loaderImage="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAAAlAAD/4QMpaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjAtYzA2MCA2MS4xMzQ3NzcsIDIwMTAvMDIvMTItMTc6MzI6MDAgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjM4MDBEMDY2QTU1MjExRTFBQTAzQjEzMUNFNzMxRkQwIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjM4MDBEMDY1QTU1MjExRTFBQTAzQjEzMUNFNzMxRkQwIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDUzUgV2luZG93cyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkU2RTk0OEM4OERCNDExRTE5NEUyRkE3M0M3QkE1NTlEIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkU2RTk0OEM5OERCNDExRTE5NEUyRkE3M0M3QkE1NTlEIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+/+4ADkFkb2JlAGTAAAAAAf/bAIQADQkJCQoJDQoKDRMMCwwTFhENDREWGhUVFhUVGhkUFhUVFhQZGR0fIB8dGScnKionJzk4ODg5QEBAQEBAQEBAQAEODAwOEA4RDw8RFA4RDhQVERISERUfFRUXFRUfKB0ZGRkZHSgjJiAgICYjLCwoKCwsNzc1NzdAQEBAQEBAQEBA/8AAEQgAyACgAwEiAAIRAQMRAf/EALAAAAEFAQEAAAAAAAAAAAAAAAQAAgMFBgcBAQEAAwEBAAAAAAAAAAAAAAAAAQMEAgUQAAIBAgIEBwoLBgQGAwAAAAECAwAEEQUhMRIGQVFxsTITFGGBwdEiQlKSMzWRoeFicqKyI1NzFYJjJDQWB9KjVCbxwkNkJWXik3QRAAIBAgMFBQcDBQEAAAAAAAABAhEDIRIEMUFRcTJhwVIUBZGhsSJyEzOB0ULhYpIjUxX/2gAMAwEAAhEDEQA/AMJSpUqAVKlXuFAeUq9wpUB5XuFe4V6ooDzZHDox0CnGMinzwl7Z8NajaHeoO3vmTBZBtp9YUIqTEV5ROxHKnWRnaU8VRMhFBUjpV7hSoSeUq9pUB5Sr2lhQHlKvcK8oBV7hSFSRrtaKAZs07YNPM1pG2xJIAw1jSeandry/8X4m8VCKkWwaWwam7Xl/4v1W8VLtmX/i/VbxUoKkWwakSM407tmX/i/VbxUmzGwjQsjdY41IARie/U0IbZO0kNtCXnOCkEBeFu4KI3Bs7DNb27ya+jDx3kJeEnpJJEcQVbWDsk17u5urd591ucZkWhym2Vnd9RkCDEpFxDRpbw0bunu5mlp2De2FMLYXOD2wB2xbOeraUcYGJ72mlSUiqzzdzMd3Z3mixltA2yzcK/NlHM1DQyRXce1HocdNOEfJXZ88y9ZojOqhiBszIRiHQ8Y4cK5TvHuzLljHNMqxNoDjLFraHHnjPxcNCGVbxEUzYNTx5jZSxhpW6qTzlwJ+DCvO2Zf+L9VvFSgqyHYNLYNTdssPxfibxUu15f8Ai/VPiqCakOwa82DU/a8v/F+JvFTDdWPBL8R8VKCvYRYV5UzoMAy6QdIIqI0B4KJtxiRQwou16QoGUkntH5Tz0RbZbmF2hktraSVBo2lUkY8tDye0flPPXTslVUyiyVRsjqUOA4yMT8dW2ram2m6UVTNq9S7EIyUVJydMTn/6DnP+im9Wl+g5z/opvVrpteEhQWY4AaSTwAVf5WPiZh/9S5/zj7zltzlmYWkfWXNvJDGTgGcYDHirR7i7mSbwXParsFMrgb7w6jKw/wCmnc9I14kF3vpvCljbMyWMOJL4aEiB8qU/ObUK7HYWVrl1pFZWiCOCBQqKOLjPGTrNZZqKbUXVHq2nNwTuJRk1VpbgXN8s7Rk5ym0UQQzhIG2NAjhxHWbI+gCBVjBBFbwxwQqEiiUJGg1BVGAFe7dV28WYLYZFmF2Th1UD7JGjymGyn1iK5OyzIBGB1HgrLZhamzumQAGJwSqnSCh1q3GOCodxt4cxurdcpzuN4cyhiWaF5Bg09udUmnWw1H/jV9nFuJ7Quo+8h8peThFA+047vduyMtk7fYqTl07YFdfUufMPzT5p71UdtlmYXaGS2t3mQHAsgxANdadYJopLe4QS2867EsZ4QfCNYrCFbjdDPmgkYyWFxgVf04ifJf6ScNdRUW1XBb6FU5TjF5EpSSrGu/s5lN+g5z/opvVpfoOc/wCim9WtdHnatvObJXDW7xLGhB8nrPaY9/HCr+tEdPCVaSeDoYLnqF63lzW4/PFSW3ecxbI84VSzWUwUaSdg0DXXK5nvAipnd6qgKvWnQO7pri9ZUEmm3Vl2j1kr8pRlFRyquBNZjGxQ/S56Y1S2fu9OVueon11Szahoou06QoQUXadIVCD2FJJ7R+U89dMydv8Axdn+TH9muZye0flPPXQstlK5Tbka1gUjlC1q0vVLkeb6r+O3Tx9xcY1nt8c0NrZCyiOE1108NYjGv1joo7Js1jzKyScYLIvkzL6LDwHXVJksH9Sb49dKNq0tj1jA6uriOCL+02FWX7iVtZX1/AzaHTyeoauKn2MX9W79zebiZCuR5MjSrhfXuEtwTrUeZH+yNfdrRNcxI6IzhXlJEak6WIGJ2Rw4ChWnChndtlVBLMdQA0k1gbXNMzzDfDLs6mjaPKppJbWwJ1bOwwxw43OnHh71YT3DpfWUJmFlb5jHHDdeXBHIsrRea5TSqvxqG04cNN62vetoCS4tre5mgnkGE9q+3DKOkuI2WX6LDQRRHWDh1UCtwj7QRg2wdl8Djgw1qe7XvW0BQ3kfZ7mSLgU+T9E6RVbnuVrnWVSWqj+Lt8ZbRuHEdKPkYVcZ2MJY5fSGyeVar45+rkWQHAqccalPE5km1htWK5nK4Wnt5FuUBUwOMG4nGkA/BXUrW4S6torlOjMgcd/xVn7rLo7zKs0uEjCNeSvdwoBhgsZxX1l2j36k3Lu+uyprdj5Vs5A+i/lD48a0aaVJOPi7jB6lbzWozpjB48pf1NDXNN4vfl7+Z4BXS65pvF78vfzPAK71XTHmZ/S/yT+jvJ7L3fHytz1E+upbL+Qj5W56jfXWRnsIYKLtekKEFGWvSFQgyjk9o/Keet3YthlMP/5x9msJJ7R+U89biyb/AMXEv7gD6tadL1T+kwepRrC39ZkLDMbiwMvUHRPG0bjlGg8ore/23sxBldxfMPLupNhT8yL/AORNZbdzJ484scytxgLqJY5LZj6Q2sV5G1Vud1mjjyG0ij0NEGSZToKyhjtqw4waztuiXA3qKTbSxltfGhbZlE95ZtZqxVbgiOZhrER9ph3Svk9+pJILZ4Y4DGBFCUMKjRsGPobPFhUfW0NJmljE2xJcIrcI2vFUEln1lRXd6lrazXT9GCNpD+yNqoI7mOVduNw6nzlOIoPOUa6yye1XXcbMR5GdQ3xY0BSbj31/FcTQZirJ+q431q7anbHCTZ72Bw7lbPrKBMcBWNNgbMBBh+bsjBdni0VJ1lARZs6yWiupxCuMDy6KpS2IwOo6DTr3Mre3e5tZZVUM4ZBjqOOJoWO4jkXajcOOMHGgDISvWIrdAkKR80+TzVl908bPPL3LzxOuHdifxVfiTAg92qI/w+/8gGgSyN/mR7XPVlp0lF/3L3mbVKtu5Hjbk/8AHE2Fc03i9+Xv5ngFdKNc13i9+Xv5ngFaNV0x5nn+l/kn9HeEWXu+PlbnqJ9dS2Xu9OVueon11kZ7CGCjLXpCgxRlr0hUIPYUcntH5Tz1s8vb+Bt1/dqPirGSe0flPPWusG/g4Py15q06XqlyMWvVYQ+ruI9xJOqzO9hOto/sP8tbGOFIrmWeM7IuMDMnAXXQJOUjQeOsJk0nY96ip0CYunrjaHx1t+srPJUbXBm2LrFPikwTOb+T+VhbZxGMrDXp83x1QSy2tucJpUjPETp+Cn5/ftaRvKvtp3Kx48HG3erHMzOxZiWZtLMdJNQSbbL71Vk6yynViOkqnEEfOWtPbXi3EQkGg6mXiNckjeSJxJGxR10qw0GtxuxmvbImD4CZMFlA4fRfv0BqesqqzTMZNMEDbIHtHH2QeCiZJSqMQdOGiue53mz3czQwsRbIcNHnkec3c4qAMuriz68gTIToxwOOnlp0MjxMJYW741Gs3RVldtbygE/dMcHX/moDaxTiWNZB53B3arb8/wC+4SOF4sf/AKxU9kcBsfOGHfoUHtG/RbzY5Die5HHhXdvavqiZ9Q8Jdlq4/gbKua7xe/L38zwCuhpf2Uk/Zo50kmwJKIdogDjw1VzzeL35e/meAVp1LTgqY4nn+mRauzqmqwrjzCLL3fHytz1E+upLL+Qj5W56jfXWRnroYKLtekKEFF2vSFQg9hSSe0flPPWosm/hIfoLzVl5PaPynnrRWb/w0X0F5q06XqlyM2sVYx5gmbFre/t71NY2T+0h8VbSO5SWNJUOKSAMp7jDGspmMPaLRlXS6eWve1/FRO7WYdbZm1Y/eW/R7qHxHRXGojlm3ulid6aVbaW+OALvgCLq2Hm9WxHKWqjhj6xsK1e8dm15l4niG1LZkswGsxtrPeOmsvayBJA1VItlWjptLuTdPMo7LtjRDq9naK4+WF9IrUW7BaHOljGqVHB7w2hzVoZt87d8vaNYSLl02CcRsDEbJbj71Uu7UBkvJ7/D7q2QoDxySaAO8MTXdxRVMpRp5XZOWdF/ms7R5XdyKfKWJsO/5PhrG5XlNxmEywW6bTnTxAAcJNbGSMXkM1pjgbiNo1PziPJ+Os7u7m/6ReM00ZOgxSpqYYHT3wRXMKN4ll9zUG4bQfNshu8sZVuEA2hirA4qe/VOwwrVbzbww5mI44UKRRYkbWG0S3JWctbd7u5WFfOOLHiUdJqmaipfLsIsObhWe001lMkMVvJNjhghIALMcBxCs7fxXQmkupx1bXDswGPlaTidVaEyKNXkoo4eBV+Sq7L7Vs9zcBgeyQ4GQ/MB1crmoim2orezqcowTuSeEY48jQ7oZX2PLzdyLhNd6RjrEY6I7+uspvH78vfzPAK6UAAAFGAGgAcArmu8Xvy9/M8ArTfio24RW5nnaG67uou3H/KPuqT2X8hHytz1G+upLL3enK3PUb66ys9RDBRdr0hQgou06QqEGUkntH5Tz1e238vF9BeaqKT2j8p56vbb+Xi+gvNWjTdUuRn1XTHmTh8KrJTJlt8t1CPIY44cGnpJVjTJYkmjaN9Ib4u7V923njTethRauZJV3PaW1rfLIiXEDYg6R4VYc9CXW7thfOZbKdbGZtLW8uPVY/u3GrkNUkM9zlcxUjbhfWOA90cRq4gv4LhdqN+VToNYWmnRm9NNVWNTyHc6VWBv8wt4YeHqm6xyPmroq1Z7WGFLSxTq7WLSuPSdjrkfumq5yHXDUeA92oO2SKpVumNAaoJLMXH3myp0rpJ4uKhc3tbDM5BMri1zAj79j7KTiY8TcdBpcsith0286o+sPCagEX9Pzg4zXUCp6QYse8oouCG3tk6m1BYv05W6T+IdyolxbHDAAa2OgDlNCz3ryN2WxBd5PJMg1t81eId2ukqnLlTBbfcuY+9uJLiRcvtPvHdsHK+cfRHcHDWsyawjyy0WBcDI3lTP6TeIcFV+S5OmXx9bJg1048o8Cj0V8Jq2DVu09nL80up7OxHi+oal3P8AXB/IsZS8T/YOV65zvCcc7vfzPAK3ivWCz445zeH954BXOr6I8yfSfyz+jvCLP3fHytz1G+upLP3fHytz1E+usbPaQ0UXadIUIKLtekKhB7Ckk9o/Keer22/l4/oLzVRSe0flPPV7b/y8X0F5q0abqlyM+q6Y8yQsBTDMor1o8aiaE1pbluMqS3sbLLHIhSRQyngqukhaJ9uBjo+H5aOa3ao2t34qouRlLajTalGP8v0IY8ylXQ+PKPFU/bYXOLPge6CKia0LaxTOxHu1Q7cuBd9yPEJ7TbjXKO8CajbMIF6CNIeNvJHjqIWJ7tSpYkalqVblwIdyG+RGXur0hXYJFxal+Dhq5y3slkv3Y2pD0pTr+QUClpJRUdo9XW4OLrTHtM16cZLLWkeC7y4jvlNEpcRtw1Ux27Ci448NZrTFy3nn3IQWxlgGrDZ3pza7/M8ArZo+ArF5171uvp+CqdV0R5l/psUrs2vB3hdl7vTlbnqJ9dS2Xu+PlbnqJ9dY2eshooq16QoQUXa9IVCD2FLJ7RuU89WNtmUSQqkgYMgw0accKrpPaPynnrZWG4Vi+VWmY5tnMWXG+XrIYnA0rhj0mdcTgdNdwnKDqjmduM1SRR/qlr8/4KX6pa8T/BVzDuLZXudRZblmbxXcPUNPc3KqCIwrbOzgrHEnHjoyD+3eSXkht7DeKG4umDGOJVUklfouThXfmbnZ7Cvy1vt9pmv1W1+d8FL9VteJvgq5yrcOGfLmzHN80iyyETPbptAEFo2ZG8pmUa1OFNn3Ky6W/sbDKM5hv5bx2WTZA+7RF2y52WOPJTzE+z2Dy1vt9pT/AKpacTerS/U7Tib1a04/t7kDXPY03jhN0W6sQ7K7W3q2dnrMccaDy/8At80kuZfqWYxWNtlcvUPPhiGYhWDeUy7IwYU8xPs9g8tb7faUn6pacTerTxm9oOBvVq3v9z927aynuId44LiWKNnjhAXF2UYhRg516qpsryjLr21665zFLSTaK9U2GOA87SwqY37knRU+BzOzags0s1Oyr+BKM6sxwP6tSDPLMen6vy0rvdm3Sxlu7K/S7WDDrFUDUTxgnTU826eXW7KlxmqQuwDBXUKcD+1Xee/wXuKX5XDGWLapSVcOyhEM/seJ/V+WnjeGx4pPV+Wkm6kKZlFay3Jlt7iFpYZY8ASVK6DjtDDA0f8A0Tl340/1f8Ndx8xJVWXB0KbktFFpNzdVXAC/qOwA0CQni2flrO3Vwbm5lnI2TKxbDirX/wBE5d+NcfV/wVR7xZPa5U9utvI8nWhmbbw0YEAYYAVxfhfy5rlKR4Fulu6X7mW1mzT8S4Yis/5CPlbnqJ9dSWfu9OVueon11mZvQ2i7XpChKKtekKhBlNJ7R+U89bDfGTb3a3ZX0Lcj6kdY+T2j8p560288m1kWQr6MJ+ylSAr+2cnV5renjs3H1loX+3j9XvbbtxLN9lqW4UnV5jdnjtXHxihtyZNjeSBu5J9k1BJe7xy7W5CJ/wCzuD/mTVTf2+fq97LJuLrPsNRueS7W6aJ/38x+vLVXuY+xvHaNxbf2GoCezf8A36j/APsSf8w1sLnqczTefJluYoLm5uo5F61sBshItP1cNFYe1f8A3ir/APfE/wCZUe9bB94r5jwuPsrQFhmG4l/Z2M17HdW90tuu3IkTHaCjWdIw0VVZdks9/C06yJFEp2dp+E1bbqybGTZ8vpQD7L1XRv8A7blT96Oda7tpNuuNE37Cq9KSisjyuUoxrStKllHbLlWTXsMs8chuSuwEPDqwoLe5y+YRE/gLzmqRekvKKtd4327yM/ulHxmrHJStySWVRyrjxKI2XC/CTlnlPPKTpTdFbP0L1bgrf5Lp0G3dPhQHwV0S1lzBsns3sESR8Crh9WAJGjSOKuU3E+zdZQ3oJh8IArdZXFDmOTpHa3i2+YrI2KtKy4ricBsBuHHgFXSo440+Wa2qqxjvM9uMoy+WvzWpLCWWWE28HxL6e43ojgkeSCBY1Ri5BGIUDT51cl3vm276BBqSEH4WbxV0tlkyXJcxTMb+OW6uY9mGHrCzDQwwAbTp2uKuTZ9N1uYsfRRR8WPhrm419mSSjRyiqxVK7y23B/ftuTm2oSdJyzNVw3BFn7vTlbnqF9dS2fu9OVueon11lZuQ2iLdsGFD05H2dNQGV0ntG5Tz1dWm9N1b2kVq8EVwsI2UaQaQOKhmitZGLOmk68DhSFvY+gfWNSAg7z3Qvo7yKCKIohiaNR5LKxx8qpxvjcqS0VpbxvwOAcRQPZ7D0G9Y0uz2HoH1jUCpLY7zXlpbm3eKO5QuzjrBqZji3x17PvNcyT288VvDBJbMWUovS2hslW7mFQ9nsPQPrGl2ew9A+saCod/WNxtbYsrfb17WBxx5ddD2281xC88klvDcSXEnWuzrqOGGC9zRUPZ7D0G9Y0uzWHoH1jQVCLreq6ntZbaO3it1mGy7RjTs1X2mYy20ZiCq8ZOODcdEdmsPQb1jS7PYegfWNdJuLqnQiSUlRqpFLmryxtH1Ma7Qw2gNNPOdSt0oI27p007s9h6B9Y0uz2HoH1jXX3Z+I4+1b8IJdX89xLHKQFMXQUahpxoiPN5P+onfU+A0/s9h6DesaXZ7D0D6xpG7OLbUtu0StW5JJx2bBsmbtiSiEk+cxoCWWSaVpZOk2vDVo0VYdnsPQb1jSNvZcCH1jSd2c+p1XAmFqEOmOPEfaH+BQd1ueo211IzrgFUYKNAAqI1WztCpUqVCRUqVKgFSpUqAVKlSoBUqVKgFSpUqAVKlSoBUqVKgFSpUqAVKlSoD/9k=",cc=cc||{},cc.defineGetterSetter=function(t,e,i,n,s,r){if(t.__defineGetter__)i&&t.__defineGetter__(e,i),n&&t.__defineSetter__(e,n);else{if(!Object.defineProperty)throw Error("browser does not support getters");var o={enumerable:!1,configurable:!0};i&&(o.get=i),n&&(o.set=n),Object.defineProperty(t,e,o)}if(!s&&!r)for(var o=null!=i,a=null!=n,c=Object.getOwnPropertyNames(t),h=0;h<c.length;h++){var l=c[h];if((t.__lookupGetter__?!t.__lookupGetter__(l):!Object.getOwnPropertyDescriptor(t,l))&&"function"==typeof t[l]){var u=t[l];if(o&&u===i&&(s=l,!a||r))break;if(a&&u===n&&(r=l,!o||s))break}}t=t.constructor,s&&(t.__getters__||(t.__getters__={}),t.__getters__[s]=e),r&&(t.__setters__||(t.__setters__={}),t.__setters__[r]=e)},cc.clone=function(t){var e,i=t.constructor?new t.constructor:{};for(e in t){var n=t[e];i[e]="object"!=typeof n||!n||n instanceof cc.Node||n instanceof HTMLElement?n:cc.clone(n)}return i},cc.inject=function(t,e){for(var i in t)e[i]=t[i]},function(){var t=0|998*Math.random(),e=0|998*Math.random();this.getNewID=function(){return t++},this.getNewInstanceId=function(){return e++}}),classManager=new ClassManager;switch(!function(){var a=/\b_super\b/;cc.Class=function(){},cc.Class.extend=function(b){var c=this.prototype,d=Object.create(c),e={writable:!0,enumerable:!1,configurable:!0},f,f=cc.game.config&&cc.game.config[cc.game.CONFIG_KEY.exposeClassName]?(f="(function "+(b._className||"Class")+" (arg0, arg1, arg2, arg3, arg4, arg5) {\n",f+="    this.__instanceId = classManager.getNewInstanceId();\n    if (this.ctor) {\n",f+="        switch (arguments.length) {\n",f+="        case 0: this.ctor(); break;\n",f+="        case 1: this.ctor(arg0); break;\n",f+="        case 3: this.ctor(arg0, arg1, arg2); break;\n",f+="        case 4: this.ctor(arg0, arg1, arg2, arg3); break;\n",f+="        case 5: this.ctor(arg0, arg1, arg2, arg3, arg4); break;\n",f+="        default: this.ctor.apply(this, arguments);\n",f+="        }\n",f+="    }\n",f+="})",eval(f)):function(t,e,i,n,s){if(this.__instanceId=classManager.getNewInstanceId(),this.ctor)switch(arguments.length){case 0:this.ctor();break;case 1:this.ctor(t);break;case 2:this.ctor(t,e);break;case 3:this.ctor(t,e,i);break;case 4:this.ctor(t,e,i,n);break;case 5:this.ctor(t,e,i,n,s);break;default:this.ctor.apply(this,arguments)}};e.value=classManager.getNewID(),Object.defineProperty(d,"__pid",e),f.prototype=d,e.value=f,Object.defineProperty(d,"constructor",e),this.__getters__&&(f.__getters__=cc.clone(this.__getters__)),this.__setters__&&(f.__setters__=cc.clone(this.__setters__));for(var g=0,h=arguments.length;g<h;++g){var k=arguments[g],m;for(m in k){var n="function"==typeof k[m],p="function"==typeof c[m],r=a.test(k[m]),t,v;if(n&&p&&r?(e.value=function(i,n){return function(){var t=this._super,e=(this._super=c[i],n.apply(this,arguments));return this._super=t,e}}(m,k[m]),Object.defineProperty(d,m,e)):n?(e.value=k[m],Object.defineProperty(d,m,e)):d[m]=k[m],n){if(this.__getters__&&this.__getters__[m]){var n=this.__getters__[m],s;for(s in this.__setters__)if(this.__setters__[s]===n){v=s;break}cc.defineGetterSetter(d,n,k[m],k[v]||d[v],m,v)}if(this.__setters__&&this.__setters__[m]){for(s in n=this.__setters__[m],this.__getters__)if(this.__getters__[s]===n){t=s;break}cc.defineGetterSetter(d,n,k[t]||d[t],k[m],t,m)}}}}return f.extend=cc.Class.extend,f.implement=function(t){for(var e in t)d[e]=t[e]},f}}(),cc=cc||{},cc._tmp=cc._tmp||{},cc.associateWithNative=function(t,e){},cc.KEY={none:0,back:6,menu:18,backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pause:19,capslock:20,escape:27,space:32,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,select:41,insert:45,Delete:46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,num0:96,num1:97,num2:98,num3:99,num4:100,num5:101,num6:102,num7:103,num8:104,num9:105,"*":106,"+":107,"-":109,numdel:110,"/":111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,numlock:144,scrolllock:145,";":186,semicolon:186,equal:187,"=":187,",":188,comma:188,dash:189,".":190,period:190,forwardslash:191,grave:192,"[":219,openbracket:219,backslash:220,"]":221,closebracket:221,quote:222,dpadLeft:1e3,dpadRight:1001,dpadUp:1003,dpadDown:1004,dpadCenter:1005},cc.FMT_JPG=0,cc.FMT_PNG=1,cc.FMT_TIFF=2,cc.FMT_RAWDATA=3,cc.FMT_WEBP=4,cc.FMT_UNKNOWN=5,cc.getImageFormatByData=function(t){return 8<t.length&&137===t[0]&&80===t[1]&&78===t[2]&&71===t[3]&&13===t[4]&&10===t[5]&&26===t[6]&&10===t[7]?cc.FMT_PNG:2<t.length&&(73===t[0]&&73===t[1]||77===t[0]&&77===t[1]||255===t[0]&&216===t[1])?cc.FMT_TIFF:cc.FMT_UNKNOWN},cc.Point=function(t,e){this.x=t||0,this.y=e||0},cc.p=function(t,e){return void 0===t?{x:0,y:0}:void 0===e?{x:t.x,y:t.y}:{x:t,y:e}},cc.pointEqualToPoint=function(t,e){return t&&e&&t.x===e.x&&t.y===e.y},cc.Size=function(t,e){this.width=t||0,this.height=e||0},cc.size=function(t,e){return void 0===t?{width:0,height:0}:void 0===e?{width:t.width,height:t.height}:{width:t,height:e}},cc.sizeEqualToSize=function(t,e){return t&&e&&t.width===e.width&&t.height===e.height},cc.Rect=function(t,e,i,n){this.x=t||0,this.y=e||0,this.width=i||0,this.height=n||0},cc.rect=function(t,e,i,n){return void 0===t?{x:0,y:0,width:0,height:0}:void 0===e?{x:t.x,y:t.y,width:t.width,height:t.height}:{x:t,y:e,width:i,height:n}},cc.rectEqualToRect=function(t,e){return t&&e&&t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height},cc._rectEqualToZero=function(t){return t&&0===t.x&&0===t.y&&0===t.width&&0===t.height},cc.rectContainsRect=function(t,e){return!(!t||!e||t.x>=e.x||t.y>=e.y||t.x+t.width<=e.x+e.width||t.y+t.height<=e.y+e.height)},cc.rectGetMaxX=function(t){return t.x+t.width},cc.rectGetMidX=function(t){return t.x+t.width/2},cc.rectGetMinX=function(t){return t.x},cc.rectGetMaxY=function(t){return t.y+t.height},cc.rectGetMidY=function(t){return t.y+t.height/2},cc.rectGetMinY=function(t){return t.y},cc.rectContainsPoint=function(t,e){return e.x>=cc.rectGetMinX(t)&&e.x<=cc.rectGetMaxX(t)&&e.y>=cc.rectGetMinY(t)&&e.y<=cc.rectGetMaxY(t)},cc.rectIntersectsRect=function(t,e){var i=t.y+t.height,n=e.x+e.width,s=e.y+e.height;return!(t.x+t.width<e.x||n<t.x||i<e.y||s<t.y)},cc.rectOverlapsRect=function(t,e){return!(t.x+t.width<e.x||e.x+e.width<t.x||t.y+t.height<e.y||e.y+e.height<t.y)},cc.rectUnion=function(t,e){var i=cc.rect(0,0,0,0);return i.x=Math.min(t.x,e.x),i.y=Math.min(t.y,e.y),i.width=Math.max(t.x+t.width,e.x+e.width)-i.x,i.height=Math.max(t.y+t.height,e.y+e.height)-i.y,i},cc.rectIntersection=function(t,e){var i=cc.rect(Math.max(cc.rectGetMinX(t),cc.rectGetMinX(e)),Math.max(cc.rectGetMinY(t),cc.rectGetMinY(e)),0,0);return i.width=Math.min(cc.rectGetMaxX(t),cc.rectGetMaxX(e))-cc.rectGetMinX(i),i.height=Math.min(cc.rectGetMaxY(t),cc.rectGetMaxY(e))-cc.rectGetMinY(i),i},cc.SAXParser=cc.Class.extend({_parser:null,_isSupportDOMParser:null,ctor:function(){window.DOMParser?(this._isSupportDOMParser=!0,this._parser=new DOMParser):this._isSupportDOMParser=!1},parse:function(t){return this._parseXML(t)},_parseXML:function(t){var e;return this._isSupportDOMParser?e=this._parser.parseFromString(t,"text/xml"):((e=new ActiveXObject("Microsoft.XMLDOM")).async="false",e.loadXML(t)),e}}),cc.PlistParser=cc.SAXParser.extend({parse:function(t){if("plist"!==(t=this._parseXML(t).documentElement).tagName)return cc.warn("Not a plist file!"),{};for(var e=null,i=0,n=t.childNodes.length;i<n&&1!==(e=t.childNodes[i]).nodeType;i++);return this._parseNode(e)},_parseNode:function(t){var e=null,i=t.tagName;if("dict"===i)e=this._parseDict(t);else if("array"===i)e=this._parseArray(t);else if("string"===i)if(1===t.childNodes.length)e=t.firstChild.nodeValue;else for(e="",i=0;i<t.childNodes.length;i++)e+=t.childNodes[i].nodeValue;else"false"===i?e=!1:"true"===i?e=!0:"real"===i?e=parseFloat(t.firstChild.nodeValue):"integer"===i&&(e=parseInt(t.firstChild.nodeValue,10));return e},_parseArray:function(t){for(var e=[],i=0,n=t.childNodes.length;i<n;i++){var s=t.childNodes[i];1===s.nodeType&&e.push(this._parseNode(s))}return e},_parseDict:function(t){for(var e={},i=null,n=0,s=t.childNodes.length;n<s;n++){var r=t.childNodes[n];1===r.nodeType&&("key"===r.tagName?i=r.firstChild.nodeValue:e[i]=this._parseNode(r))}return e}}),cc.saxParser=new cc.SAXParser,cc.plistParser=new cc.PlistParser,cc._txtLoader={load:function(t,e,i,n){cc.loader.loadTxt(t,n)}},cc.loader.register(["txt","xml","vsh","fsh","atlas"],cc._txtLoader),cc._jsonLoader={load:function(t,e,i,n){cc.loader.loadJson(t,n)}},cc.loader.register(["json","ExportJson"],cc._jsonLoader),cc._jsLoader={load:function(t,e,i,n){cc.loader.loadJs(t,n)}},cc.loader.register(["js"],cc._jsLoader),cc._imgLoader={load:function(t,i,e,n){e=cc.loader.isLoading(t)?function(t,e){if(t)return n(t);t=cc.textureCache.getTextureForKey(i)||cc.textureCache.handleLoadedTexture(i,e);n(null,t)}:function(t,e){if(t)return n(t);t=cc.textureCache.handleLoadedTexture(i,e);n(null,t)},cc.loader.loadImg(t,e)}},cc.loader.register("png jpg bmp jpeg gif ico tiff webp".split(" "),cc._imgLoader),cc._serverImgLoader={load:function(t,e,i,n){cc._imgLoader.load(i.src,e,i,n)}},cc.loader.register(["serverImg"],cc._serverImgLoader),cc._plistLoader={load:function(t,e,i,n){cc.loader.loadTxt(t,function(t,e){if(t)return n(t);n(null,cc.plistParser.parse(e))})}},cc.loader.register(["plist"],cc._plistLoader),cc._fontLoader={TYPE:{".eot":"embedded-opentype",".ttf":"truetype",".ttc":"truetype",".woff":"woff",".svg":"svg"},_loadFont:function(t,e,i){var n=document,s=cc.path,r=this.TYPE,o=document.createElement("style"),a=(o.type="text/css",n.body.appendChild(o),""),a=isNaN(+t)?a+"@font-face { font-family:"+t+"; src:":a+"@font-face { font-family:'"+t+"'; src:";if(e instanceof Array)for(var c=0,h=e.length;c<h;c++)i=s.extname(e[c]).toLowerCase(),a=a+("url('"+e[c]+"') format('"+r[i]+"')")+(c===h-1?";":",");else a+="url('"+e+"') format('"+r[i=i.toLowerCase()]+"');";o.textContent+=a+"}",(i=(e=document.createElement("div")).style).fontFamily=t,e.innerHTML=".",i.position="absolute",i.left="-100px",i.top="-100px",n.body.appendChild(e)},load:function(t,e,i,n){e=i.type,t=i.name,e=i.srcs,cc.isString(i)?(e=cc.path.extname(i),t=cc.path.basename(i,e),this._loadFont(t,i,e)):this._loadFont(t,e),document.fonts?document.fonts.load("1em "+t).then(function(){n(null,!0)},function(t){n(t)}):n(null,!0)}},cc.loader.register("font eot ttf woff svg ttc".split(" "),cc._fontLoader),cc._binaryLoader={load:function(t,e,i,n){cc.loader.loadBinary(t,n)}},cc._csbLoader={load:function(t,e,i,n){cc.loader.loadCsb(t,n)}},cc.loader.register(["csb"],cc._csbLoader),window.CocosEngine=cc.ENGINE_VERSION="Cocos2d-JS v3.17",cc.FIX_ARTIFACTS_BY_STRECHING_TEXEL=0,cc.DIRECTOR_STATS_POSITION=cc.p(0,0),cc.DIRECTOR_FPS_INTERVAL=.5,cc.COCOSNODE_RENDER_SUBPIXEL=1,cc.SPRITEBATCHNODE_RENDER_SUBPIXEL=1,cc.OPTIMIZE_BLEND_FUNC_FOR_PREMULTIPLIED_ALPHA=1,cc.TEXTURE_ATLAS_USE_TRIANGLE_STRIP=0,cc.TEXTURE_ATLAS_USE_VAO=0,cc.TEXTURE_NPOT_SUPPORT=0,cc.RETINA_DISPLAY_FILENAME_SUFFIX="-hd",cc.USE_LA88_LABELS=1,cc.SPRITE_DEBUG_DRAW=0,cc.SPRITEBATCHNODE_DEBUG_DRAW=0,cc.LABELBMFONT_DEBUG_DRAW=0,cc.LABELATLAS_DEBUG_DRAW=0,cc.DRAWNODE_TOTAL_VERTICES=2e4,cc.DEFAULT_ENGINE=cc.ENGINE_VERSION+"-canvas",cc.ENABLE_STACKABLE_ACTIONS=1,cc.ENABLE_GL_STATE_CACHE=1,cc.$=function(t){var e=this===cc?document:this;return(t=t instanceof HTMLElement?t:e.querySelector(t))&&(t.find=t.find||cc.$,t.hasClass=t.hasClass||function(t){return this.className.match(RegExp("(\\s|^)"+t+"(\\s|$)"))},t.addClass=t.addClass||function(t){return this.hasClass(t)||(this.className&&(this.className+=" "),this.className+=t),this},t.removeClass=t.removeClass||function(t){return this.hasClass(t)&&(this.className=this.className.replace(t,"")),this},t.remove=t.remove||function(){return this.parentNode&&this.parentNode.removeChild(this),this},t.appendTo=t.appendTo||function(t){return t.appendChild(this),this},t.prependTo=t.prependTo||function(t){return t.childNodes[0]?t.insertBefore(this,t.childNodes[0]):t.appendChild(this),this},t.transforms=t.transforms||function(){return this.style[cc.$.trans]=cc.$.translate(this.position)+cc.$.rotate(this.rotation)+cc.$.scale(this.scale)+cc.$.skew(this.skew),this},t.position=t.position||{x:0,y:0},t.rotation=t.rotation||0,t.scale=t.scale||{x:1,y:1},t.skew=t.skew||{x:0,y:0},t.translates=function(t,e){return this.position.x=t,this.position.y=e,this.transforms(),this},t.rotate=function(t){return this.rotation=t,this.transforms(),this},t.resize=function(t,e){return this.scale.x=t,this.scale.y=e,this.transforms(),this},t.setSkew=function(t,e){return this.skew.x=t,this.skew.y=e,this.transforms(),this}),t},cc.sys.browserType){case cc.sys.BROWSER_TYPE_FIREFOX:cc.$.pfx="Moz",cc.$.hd=!0;break;case cc.sys.BROWSER_TYPE_CHROME:case cc.sys.BROWSER_TYPE_SAFARI:cc.$.pfx="webkit",cc.$.hd=!0;break;case cc.sys.BROWSER_TYPE_OPERA:cc.$.pfx="O",cc.$.hd=!1;break;case cc.sys.BROWSER_TYPE_IE:cc.$.pfx="ms",cc.$.hd=!1;break;default:cc.$.pfx="webkit",cc.$.hd=!0}cc.$.trans=cc.$.pfx+"Transform",cc.$.translate=cc.$.hd?function(t){return"translate3d("+t.x+"px, "+t.y+"px, 0) "}:function(t){return"translate("+t.x+"px, "+t.y+"px) "},cc.$.rotate=cc.$.hd?function(t){return"rotateZ("+t+"deg) "}:function(t){return"rotate("+t+"deg) "},cc.$.scale=function(t){return"scale("+t.x+", "+t.y+") "},cc.$.skew=function(t){return"skewX("+-t.x+"deg) skewY("+t.y+"deg)"},cc.$new=function(t){return cc.$(document.createElement(t))},cc.$.findpos=function(t){for(var e=0,i=0;e+=t.offsetLeft,i+=t.offsetTop,t=t.offsetParent;);return{x:e,y:i}},cc.INVALID_INDEX=-1,cc.PI=Math.PI,cc.FLT_MAX=parseFloat("3.402823466e+38F"),cc.FLT_MIN=parseFloat("1.175494351e-38F"),cc.RAD=cc.PI/180,cc.DEG=180/cc.PI,cc.UINT_MAX=4294967295,cc.swap=function(t,e,i){var n;!cc.isObject(i)||cc.isUndefined(i.x)||cc.isUndefined(i.y)?cc.log(cc._LogInfos.swap):(n=i[t],i[t]=i[e],i[e]=n)},cc.lerp=function(t,e,i){return t+(e-t)*i},cc.rand=function(){return 16777215*Math.random()},cc.randomMinus1To1=function(){return 2*(Math.random()-.5)},cc.random0To1=Math.random,cc.degreesToRadians=function(t){return t*cc.RAD},cc.radiansToDegrees=function(t){return t*cc.DEG},cc.radiansToDegress=function(t){return cc.log(cc._LogInfos.radiansToDegress),t*cc.DEG},cc.REPEAT_FOREVER=Number.MAX_VALUE-1,cc.nodeDrawSetup=function(t){t._shaderProgram&&(t._glProgramState.apply(),t._shaderProgram.setUniformForModelViewAndProjectionMatrixWithMat4())},cc.enableDefaultGLStates=function(){},cc.disableDefaultGLStates=function(){},cc.incrementGLDraws=function(t){cc.g_NumberOfDraws+=t},cc.FLT_EPSILON=1.192092896e-7,cc.contentScaleFactor=function(){return cc.director._contentScaleFactor},cc.pointPointsToPixels=function(t){var e=cc.contentScaleFactor();return cc.p(t.x*e,t.y*e)},cc.pointPixelsToPoints=function(t){var e=cc.contentScaleFactor();return cc.p(t.x/e,t.y/e)},cc._pointPixelsToPointsOut=function(t,e){var i=cc.contentScaleFactor();e.x=t.x/i,e.y=t.y/i},cc.sizePointsToPixels=function(t){var e=cc.contentScaleFactor();return cc.size(t.width*e,t.height*e)},cc.sizePixelsToPoints=function(t){var e=cc.contentScaleFactor();return cc.size(t.width/e,t.height/e)},cc._sizePixelsToPointsOut=function(t,e){var i=cc.contentScaleFactor();e.width=t.width/i,e.height=t.height/i},cc.rectPixelsToPoints=function(t){var e=cc.contentScaleFactor();return cc.rect(t.x/e,t.y/e,t.width/e,t.height/e)},cc.rectPointsToPixels=function(t){var e=cc.contentScaleFactor();return cc.rect(t.x*e,t.y*e,t.width*e,t.height*e)},cc.ONE=1,cc.ZERO=0,cc.SRC_ALPHA=770,cc.SRC_ALPHA_SATURATE=776,cc.SRC_COLOR=768,cc.DST_ALPHA=772,cc.DST_COLOR=774,cc.ONE_MINUS_SRC_ALPHA=771,cc.ONE_MINUS_SRC_COLOR=769,cc.ONE_MINUS_DST_ALPHA=773,cc.ONE_MINUS_DST_COLOR=775,cc.ONE_MINUS_CONSTANT_ALPHA=32772,cc.ONE_MINUS_CONSTANT_COLOR=32770,cc.LINEAR=9729,cc.REPEAT=10497,cc.CLAMP_TO_EDGE=33071,cc.MIRRORED_REPEAT=33648,cc.BLEND_SRC=cc.SRC_ALPHA,cc.game.addEventListener(cc.game.EVENT_RENDERER_INITED,function(){cc._renderType===cc.game.RENDER_TYPE_WEBGL&&cc.OPTIMIZE_BLEND_FUNC_FOR_PREMULTIPLIED_ALPHA&&(cc.BLEND_SRC=cc.ONE)}),cc.BLEND_DST=cc.ONE_MINUS_SRC_ALPHA,cc.checkGLErrorDebug=function(){var t;cc.renderMode===cc.game.RENDER_TYPE_WEBGL&&(t=cc._renderContext.getError())&&cc.log(cc._LogInfos.checkGLErrorDebug,t)},cc.ORIENTATION_PORTRAIT=1,cc.ORIENTATION_LANDSCAPE=2,cc.ORIENTATION_AUTO=3,cc.CONCURRENCY_HTTP_REQUEST_COUNT=cc.sys.isMobile?20:0,cc.BATCH_VERTEX_COUNT=2e3,cc.VERTEX_ATTRIB_FLAG_NONE=0,cc.VERTEX_ATTRIB_FLAG_POSITION=1,cc.VERTEX_ATTRIB_FLAG_COLOR=2,cc.VERTEX_ATTRIB_FLAG_TEX_COORDS=4,cc.VERTEX_ATTRIB_FLAG_POS_COLOR_TEX=cc.VERTEX_ATTRIB_FLAG_POSITION|cc.VERTEX_ATTRIB_FLAG_COLOR|cc.VERTEX_ATTRIB_FLAG_TEX_COORDS,cc.GL_ALL=0,cc.VERTEX_ATTRIB_POSITION=0,cc.VERTEX_ATTRIB_COLOR=1,cc.VERTEX_ATTRIB_TEX_COORDS=2,cc.VERTEX_ATTRIB_MAX=7,cc.UNIFORM_PMATRIX=0,cc.UNIFORM_MVMATRIX=1,cc.UNIFORM_MVPMATRIX=2,cc.UNIFORM_TIME=3,cc.UNIFORM_SINTIME=4,cc.UNIFORM_COSTIME=5,cc.UNIFORM_RANDOM01=6,cc.UNIFORM_SAMPLER=7,cc.UNIFORM_MAX=8,cc.SHADER_POSITION_TEXTURECOLOR="ShaderPositionTextureColor",cc.SHADER_SPRITE_POSITION_TEXTURECOLOR="ShaderSpritePositionTextureColor",cc.SHADER_SPRITE_POSITION_TEXTURECOLOR_GRAY="ShaderSpritePositionTextureColorGray",cc.SHADER_POSITION_TEXTURECOLORALPHATEST="ShaderPositionTextureColorAlphaTest",cc.SHADER_SPRITE_POSITION_TEXTURECOLORALPHATEST="ShaderSpritePositionTextureColorAlphaTest",cc.SHADER_POSITION_COLOR="ShaderPositionColor",cc.SHADER_SPRITE_POSITION_COLOR="ShaderSpritePositionColor",cc.SHADER_POSITION_TEXTURE="ShaderPositionTexture",cc.SHADER_POSITION_TEXTURE_UCOLOR="ShaderPositionTextureUColor",cc.SHADER_POSITION_TEXTUREA8COLOR="ShaderPositionTextureA8Color",cc.SHADER_POSITION_UCOLOR="ShaderPositionUColor",cc.SHADER_POSITION_LENGTHTEXTURECOLOR="ShaderPositionLengthTextureColor",cc.UNIFORM_PMATRIX_S="CC_PMatrix",cc.UNIFORM_MVMATRIX_S="CC_MVMatrix",cc.UNIFORM_MVPMATRIX_S="CC_MVPMatrix",cc.UNIFORM_TIME_S="CC_Time",cc.UNIFORM_SINTIME_S="CC_SinTime",cc.UNIFORM_COSTIME_S="CC_CosTime",cc.UNIFORM_RANDOM01_S="CC_Random01",cc.UNIFORM_SAMPLER_S="CC_Texture0",cc.UNIFORM_ALPHA_TEST_VALUE_S="CC_alpha_value",cc.ATTRIBUTE_NAME_COLOR="a_color",cc.ATTRIBUTE_NAME_POSITION="a_position",cc.ATTRIBUTE_NAME_TEX_COORD="a_texCoord",cc.ATTRIBUTE_NAME_MVMAT="a_mvMatrix",cc.ITEM_SIZE=32,cc.CURRENT_ITEM=3233828865,cc.ZOOM_ACTION_TAG=3233828866,cc.NORMAL_TAG=8801,cc.SELECTED_TAG=8802,cc.DISABLE_TAG=8803,cc.arrayVerifyType=function(t,e){if(t&&0<t.length)for(var i=0;i<t.length;i++)if(!(t[i]instanceof e))return cc.log("element type is wrong!"),!1;return!0},cc.arrayRemoveObject=function(t,e){for(var i=0,n=t.length;i<n;i++)if(t[i]===e){t.splice(i,1);break}},cc.arrayRemoveArray=function(t,e){for(var i=0,n=e.length;i<n;i++)cc.arrayRemoveObject(t,e[i])},cc.arrayAppendObjectsToIndex=function(t,e,i){return t.splice.apply(t,[i,0].concat(e)),t},cc.copyArray=function(t){for(var e=t.length,i=Array(e),n=0;n<e;n+=1)i[n]=t[n];return i},cc.Color=function(t,e,i,n){this._val=((t||0)<<24>>>0)+((e||0)<<16)+((i||0)<<8)+("number"==typeof n?n:255)},_p=cc.Color.prototype,_p._getR=function(){return(4278190080&this._val)>>>24},_p._setR=function(t){this._val=16777215&this._val|t<<24>>>0},_p._getG=function(){return(16711680&this._val)>>16},_p._setG=function(t){this._val=4278255615&this._val|t<<16},_p._getB=function(){return(65280&this._val)>>8},_p._setB=function(t){this._val=4294902015&this._val|t<<8},_p._getA=function(){return 255&this._val},_p._setA=function(t){this._val=4294967040&this._val|t},cc.defineGetterSetter(_p,"r",_p._getR,_p._setR),cc.defineGetterSetter(_p,"g",_p._getG,_p._setG),cc.defineGetterSetter(_p,"b",_p._getB,_p._setB),cc.defineGetterSetter(_p,"a",_p._getA,_p._setA),cc.color=function(t,e,i,n){return void 0===t?new cc.Color(0,0,0,255):"object"==typeof t?new cc.Color(t.r,t.g,t.b,null==t.a?255:t.a):"string"==typeof t?cc.hexToColor(t):new cc.Color(t,e,i,null==n?255:n)},cc.colorEqual=function(t,e){return t.r===e.r&&t.g===e.g&&t.b===e.b},cc.Acceleration=function(t,e,i,n){this.x=t||0,this.y=e||0,this.z=i||0,this.timestamp=n||0},cc.Vertex2F=function(t,e,i,n){this._arrayBuffer=i||new ArrayBuffer(cc.Vertex2F.BYTES_PER_ELEMENT),this._offset=n||0,this._view=new Float32Array(this._arrayBuffer,this._offset,2),this._view[0]=t||0,this._view[1]=e||0},cc.Vertex2F.BYTES_PER_ELEMENT=8,_p=cc.Vertex2F.prototype,_p._getX=function(){return this._view[0]},_p._setX=function(t){this._view[0]=t},_p._getY=function(){return this._view[1]},_p._setY=function(t){this._view[1]=t},cc.defineGetterSetter(_p,"x",_p._getX,_p._setX),cc.defineGetterSetter(_p,"y",_p._getY,_p._setY),cc.Vertex3F=function(t,e,i,n,s){this._arrayBuffer=n||new ArrayBuffer(cc.Vertex3F.BYTES_PER_ELEMENT),this._offset=s||0,this._view=new Float32Array(this._arrayBuffer,this._offset,3),this._view[0]=t||0,this._view[1]=e||0,this._view[2]=i||0},cc.Vertex3F.BYTES_PER_ELEMENT=12,_p=cc.Vertex3F.prototype,_p._getX=function(){return this._view[0]},_p._setX=function(t){this._view[0]=t},_p._getY=function(){return this._view[1]},_p._setY=function(t){this._view[1]=t},_p._getZ=function(){return this._view[2]},_p._setZ=function(t){this._view[2]=t},cc.defineGetterSetter(_p,"x",_p._getX,_p._setX),cc.defineGetterSetter(_p,"y",_p._getY,_p._setY),cc.defineGetterSetter(_p,"z",_p._getZ,_p._setZ),cc.Tex2F=function(t,e,i,n){this._arrayBuffer=i||new ArrayBuffer(cc.Tex2F.BYTES_PER_ELEMENT),this._offset=n||0,this._view=new Float32Array(this._arrayBuffer,this._offset,2),this._view[0]=t||0,this._view[1]=e||0},cc.Tex2F.BYTES_PER_ELEMENT=8,_p=cc.Tex2F.prototype,_p._getU=function(){return this._view[0]},_p._setU=function(t){this._view[0]=t},_p._getV=function(){return this._view[1]},_p._setV=function(t){this._view[1]=t},cc.defineGetterSetter(_p,"u",_p._getU,_p._setU),cc.defineGetterSetter(_p,"v",_p._getV,_p._setV),cc.Quad2=function(t,e,i,n,s,r){this._arrayBuffer=s||new ArrayBuffer(cc.Quad2.BYTES_PER_ELEMENT),this._offset=r||0,s=this._arrayBuffer,r=this._offset;var o=cc.Vertex2F.BYTES_PER_ELEMENT;this._tl=t?new cc.Vertex2F(t.x,t.y,s,r):new cc.Vertex2F(0,0,s,r),r+=o,this._tr=e?new cc.Vertex2F(e.x,e.y,s,r):new cc.Vertex2F(0,0,s,r),r+=o,this._bl=i?new cc.Vertex2F(i.x,i.y,s,r):new cc.Vertex2F(0,0,s,r),r+=o,this._br=n?new cc.Vertex2F(n.x,n.y,s,r):new cc.Vertex2F(0,0,s,r)},cc.Quad2.BYTES_PER_ELEMENT=32,_p=cc.Quad2.prototype,_p._getTL=function(){return this._tl},_p._setTL=function(t){this._tl._view[0]=t.x,this._tl._view[1]=t.y},_p._getTR=function(){return this._tr},_p._setTR=function(t){this._tr._view[0]=t.x,this._tr._view[1]=t.y},_p._getBL=function(){return this._bl},_p._setBL=function(t){this._bl._view[0]=t.x,this._bl._view[1]=t.y},_p._getBR=function(){return this._br},_p._setBR=function(t){this._br._view[0]=t.x,this._br._view[1]=t.y},cc.defineGetterSetter(_p,"tl",_p._getTL,_p._setTL),cc.defineGetterSetter(_p,"tr",_p._getTR,_p._setTR),cc.defineGetterSetter(_p,"bl",_p._getBL,_p._setBL),cc.defineGetterSetter(_p,"br",_p._getBR,_p._setBR),cc.Quad3=function(t,e,i,n,s,r){this._arrayBuffer=s||new ArrayBuffer(cc.Quad3.BYTES_PER_ELEMENT),this._offset=r||0,s=this._arrayBuffer,r=this._offset;var o=cc.Vertex3F.BYTES_PER_ELEMENT;this.bl=t?new cc.Vertex3F(t.x,t.y,t.z,s,r):new cc.Vertex3F(0,0,0,s,r),r+=o,this.br=e?new cc.Vertex3F(e.x,e.y,e.z,s,r):new cc.Vertex3F(0,0,0,s,r),r+=o,this.tl=i?new cc.Vertex3F(i.x,i.y,i.z,s,r):new cc.Vertex3F(0,0,0,s,r),r+=o,this.tr=n?new cc.Vertex3F(n.x,n.y,n.z,s,r):new cc.Vertex3F(0,0,0,s,r)},cc.Quad3.BYTES_PER_ELEMENT=48,cc.V3F_C4B_T2F=function(t,e,i,n,s){this._arrayBuffer=n||new ArrayBuffer(cc.V3F_C4B_T2F.BYTES_PER_ELEMENT),this._offset=s||0,n=this._arrayBuffer,s=this._offset,this._vertices=t?new cc.Vertex3F(t.x,t.y,t.z,n,s):new cc.Vertex3F(0,0,0,n,s),s+=cc.Vertex3F.BYTES_PER_ELEMENT,this._colors=e?new cc._WebGLColor(e.r,e.g,e.b,e.a,n,s):new cc._WebGLColor(0,0,0,0,n,s),s+=cc._WebGLColor.BYTES_PER_ELEMENT,this._texCoords=i?new cc.Tex2F(i.u,i.v,n,s):new cc.Tex2F(0,0,n,s)},cc.V3F_C4B_T2F.BYTES_PER_ELEMENT=24,_p=cc.V3F_C4B_T2F.prototype,_p._getVertices=function(){return this._vertices},_p._setVertices=function(t){var e=this._vertices;e._view[0]=t.x,e._view[1]=t.y,e._view[2]=t.z},_p._getColor=function(){return this._colors},_p._setColor=function(t){var e=this._colors;e._view[0]=t.r,e._view[1]=t.g,e._view[2]=t.b,e._view[3]=t.a},_p._getTexCoords=function(){return this._texCoords},_p._setTexCoords=function(t){this._texCoords._view[0]=t.u,this._texCoords._view[1]=t.v},cc.defineGetterSetter(_p,"vertices",_p._getVertices,_p._setVertices),cc.defineGetterSetter(_p,"colors",_p._getColor,_p._setColor),cc.defineGetterSetter(_p,"texCoords",_p._getTexCoords,_p._setTexCoords),cc.V3F_C4B_T2F_Quad=function(t,e,i,n,s,r){this._arrayBuffer=s||new ArrayBuffer(cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT),this._offset=r||0,s=this._arrayBuffer,r=this._offset;var o=cc.V3F_C4B_T2F.BYTES_PER_ELEMENT;this._tl=t?new cc.V3F_C4B_T2F(t.vertices,t.colors,t.texCoords,s,r):new cc.V3F_C4B_T2F(null,null,null,s,r),r+=o,this._bl=e?new cc.V3F_C4B_T2F(e.vertices,e.colors,e.texCoords,s,r):new cc.V3F_C4B_T2F(null,null,null,s,r),r+=o,this._tr=i?new cc.V3F_C4B_T2F(i.vertices,i.colors,i.texCoords,s,r):new cc.V3F_C4B_T2F(null,null,null,s,r),r+=o,this._br=n?new cc.V3F_C4B_T2F(n.vertices,n.colors,n.texCoords,s,r):new cc.V3F_C4B_T2F(null,null,null,s,r)},cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT=96,_p=cc.V3F_C4B_T2F_Quad.prototype,_p._getTL=function(){return this._tl},_p._setTL=function(t){var e=this._tl;e.vertices=t.vertices,e.colors=t.colors,e.texCoords=t.texCoords},_p._getBL=function(){return this._bl},_p._setBL=function(t){var e=this._bl;e.vertices=t.vertices,e.colors=t.colors,e.texCoords=t.texCoords},_p._getTR=function(){return this._tr},_p._setTR=function(t){var e=this._tr;e.vertices=t.vertices,e.colors=t.colors,e.texCoords=t.texCoords},_p._getBR=function(){return this._br},_p._setBR=function(t){var e=this._br;e.vertices=t.vertices,e.colors=t.colors,e.texCoords=t.texCoords},_p._getArrayBuffer=function(){return this._arrayBuffer},cc.defineGetterSetter(_p,"tl",_p._getTL,_p._setTL),cc.defineGetterSetter(_p,"tr",_p._getTR,_p._setTR),cc.defineGetterSetter(_p,"bl",_p._getBL,_p._setBL),cc.defineGetterSetter(_p,"br",_p._getBR,_p._setBR),cc.defineGetterSetter(_p,"arrayBuffer",_p._getArrayBuffer,null),cc.V3F_C4B_T2F_QuadZero=function(){return new cc.V3F_C4B_T2F_Quad},cc.V3F_C4B_T2F_QuadCopy=function(t){var e,i,n;return t?(e=t.tl,i=t.bl,n=t.tr,t=t.br,{tl:{vertices:{x:e.vertices.x,y:e.vertices.y,z:e.vertices.z},colors:{r:e.colors.r,g:e.colors.g,b:e.colors.b,a:e.colors.a},texCoords:{u:e.texCoords.u,v:e.texCoords.v}},bl:{vertices:{x:i.vertices.x,y:i.vertices.y,z:i.vertices.z},colors:{r:i.colors.r,g:i.colors.g,b:i.colors.b,a:i.colors.a},texCoords:{u:i.texCoords.u,v:i.texCoords.v}},tr:{vertices:{x:n.vertices.x,y:n.vertices.y,z:n.vertices.z},colors:{r:n.colors.r,g:n.colors.g,b:n.colors.b,a:n.colors.a},texCoords:{u:n.texCoords.u,v:n.texCoords.v}},br:{vertices:{x:t.vertices.x,y:t.vertices.y,z:t.vertices.z},colors:{r:t.colors.r,g:t.colors.g,b:t.colors.b,a:t.colors.a},texCoords:{u:t.texCoords.u,v:t.texCoords.v}}}):cc.V3F_C4B_T2F_QuadZero()},cc.V3F_C4B_T2F_QuadsCopy=function(t){if(!t)return[];for(var e=[],i=0;i<t.length;i++)e.push(cc.V3F_C4B_T2F_QuadCopy(t[i]));return e},cc.V2F_C4B_T2F=function(t,e,i,n,s){this._arrayBuffer=n||new ArrayBuffer(cc.V2F_C4B_T2F.BYTES_PER_ELEMENT),this._offset=s||0,n=this._arrayBuffer,s=this._offset,this._vertices=t?new cc.Vertex2F(t.x,t.y,n,s):new cc.Vertex2F(0,0,n,s),s+=cc.Vertex2F.BYTES_PER_ELEMENT,this._colors=e?new cc._WebGLColor(e.r,e.g,e.b,e.a,n,s):new cc._WebGLColor(0,0,0,0,n,s),s+=cc._WebGLColor.BYTES_PER_ELEMENT,this._texCoords=i?new cc.Tex2F(i.u,i.v,n,s):new cc.Tex2F(0,0,n,s)},cc.V2F_C4B_T2F.BYTES_PER_ELEMENT=20,_p=cc.V2F_C4B_T2F.prototype,_p._getVertices=function(){return this._vertices},_p._setVertices=function(t){this._vertices._view[0]=t.x,this._vertices._view[1]=t.y},_p._getColor=function(){return this._colors},_p._setColor=function(t){var e=this._colors;e._view[0]=t.r,e._view[1]=t.g,e._view[2]=t.b,e._view[3]=t.a},_p._getTexCoords=function(){return this._texCoords},_p._setTexCoords=function(t){this._texCoords._view[0]=t.u,this._texCoords._view[1]=t.v},cc.defineGetterSetter(_p,"vertices",_p._getVertices,_p._setVertices),cc.defineGetterSetter(_p,"colors",_p._getColor,_p._setColor),cc.defineGetterSetter(_p,"texCoords",_p._getTexCoords,_p._setTexCoords),cc.V2F_C4B_T2F_Triangle=function(t,e,i,n,s){this._arrayBuffer=n||new ArrayBuffer(cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT),this._offset=s||0,n=this._arrayBuffer,s=this._offset;var r=cc.V2F_C4B_T2F.BYTES_PER_ELEMENT;this._a=t?new cc.V2F_C4B_T2F(t.vertices,t.colors,t.texCoords,n,s):new cc.V2F_C4B_T2F(null,null,null,n,s),s+=r,this._b=e?new cc.V2F_C4B_T2F(e.vertices,e.colors,e.texCoords,n,s):new cc.V2F_C4B_T2F(null,null,null,n,s),s+=r,this._c=i?new cc.V2F_C4B_T2F(i.vertices,i.colors,i.texCoords,n,s):new cc.V2F_C4B_T2F(null,null,null,n,s)},cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT=60,_p=cc.V2F_C4B_T2F_Triangle.prototype,_p._getA=function(){return this._a},_p._setA=function(t){var e=this._a;e.vertices=t.vertices,e.colors=t.colors,e.texCoords=t.texCoords},_p._getB=function(){return this._b},_p._setB=function(t){var e=this._b;e.vertices=t.vertices,e.colors=t.colors,e.texCoords=t.texCoords},_p._getC=function(){return this._c},_p._setC=function(t){var e=this._c;e.vertices=t.vertices,e.colors=t.colors,e.texCoords=t.texCoords},cc.defineGetterSetter(_p,"a",_p._getA,_p._setA),cc.defineGetterSetter(_p,"b",_p._getB,_p._setB),cc.defineGetterSetter(_p,"c",_p._getC,_p._setC),cc.vertex2=function(t,e){return new cc.Vertex2F(t,e)},cc.vertex3=function(t,e,i){return new cc.Vertex3F(t,e,i)},cc.tex2=function(t,e){return new cc.Tex2F(t,e)},cc.BlendFunc=function(t,e){this.src=t,this.dst=e},cc.blendFuncDisable=function(){return new cc.BlendFunc(cc.ONE,cc.ZERO)},cc.hexToColor=function(t){return t=t.replace(/^#?/,"0x"),t=parseInt(t),new cc.Color(t>>16,(t>>8)%256,t%256)},cc.colorToHex=function(t){var e=t.r.toString(16),i=t.g.toString(16),n=t.b.toString(16);return"#"+(t.r<16?"0"+e:e)+(t.g<16?"0"+i:i)+(t.b<16?"0"+n:n)},cc.TEXT_ALIGNMENT_LEFT=0,cc.TEXT_ALIGNMENT_CENTER=1,cc.TEXT_ALIGNMENT_RIGHT=2,cc.VERTICAL_TEXT_ALIGNMENT_TOP=0,cc.VERTICAL_TEXT_ALIGNMENT_CENTER=1,cc.VERTICAL_TEXT_ALIGNMENT_BOTTOM=2,cc._Dictionary=cc.Class.extend({_keyMapTb:null,_valueMapTb:null,__currId:0,ctor:function(){this._keyMapTb={},this._valueMapTb={},this.__currId=2<<(0|10*Math.random())},__getKey:function(){return this.__currId++,"key_"+this.__currId},setObject:function(t,e){var i;null!=e&&(i=this.__getKey(),this._keyMapTb[i]=e,this._valueMapTb[i]=t)},objectForKey:function(t){if(null!=t){var e,i=this._keyMapTb;for(e in i)if(i[e]===t)return this._valueMapTb[e]}return null},valueForKey:function(t){return this.objectForKey(t)},removeObjectForKey:function(t){if(null!=t){var e,i=this._keyMapTb;for(e in i)if(i[e]===t){delete this._valueMapTb[e],delete i[e];break}}},removeObjectsForKeys:function(t){if(null!=t)for(var e=0;e<t.length;e++)this.removeObjectForKey(t[e])},allKeys:function(){var t,e=[],i=this._keyMapTb;for(t in i)e.push(i[t]);return e},removeAllObjects:function(){this._keyMapTb={},this._valueMapTb={}},count:function(){return this.allKeys().length}}),cc.FontDefinition=function(t){if(this.fontName="Arial",this.fontSize=12,this.textAlign=cc.TEXT_ALIGNMENT_CENTER,this.verticalAlign=cc.VERTICAL_TEXT_ALIGNMENT_TOP,this.fillStyle=cc.color(255,255,255,255),this.boundingHeight=this.boundingWidth=0,this.strokeEnabled=!1,this.strokeStyle=cc.color(255,255,255,255),this.lineWidth=1,this.fontWeight=this.fontStyle=this.lineHeight="normal",this.shadowEnabled=!1,this.shadowBlur=this.shadowOffsetY=this.shadowOffsetX=0,this.shadowOpacity=1,t&&t instanceof Object)for(var e in t)this[e]=t[e]},cc.FontDefinition.prototype._getCanvasFontStr=function(){return this.fontStyle+" "+this.fontWeight+" "+this.fontSize+"px/"+(this.lineHeight.charAt?this.lineHeight:this.lineHeight+"px")+" '"+this.fontName+"'"},cc.game.addEventListener(cc.game.EVENT_RENDERER_INITED,function(){cc._renderType===cc.game.RENDER_TYPE_WEBGL&&(cc._WebGLColor=function(t,e,i,n,s,r){this._arrayBuffer=s||new ArrayBuffer(cc._WebGLColor.BYTES_PER_ELEMENT),this._offset=r||0,this._view=new Uint8Array(this._arrayBuffer,this._offset,4),this._view[0]=t||0,this._view[1]=e||0,this._view[2]=i||0,this._view[3]=null==n?255:n,void 0===n&&(this.a_undefined=!0)},cc._WebGLColor.BYTES_PER_ELEMENT=4,(_p=cc._WebGLColor.prototype)._getR=function(){return this._view[0]},_p._setR=function(t){this._view[0]=t<0?0:t},_p._getG=function(){return this._view[1]},_p._setG=function(t){this._view[1]=t<0?0:t},_p._getB=function(){return this._view[2]},_p._setB=function(t){this._view[2]=t<0?0:t},_p._getA=function(){return this._view[3]},_p._setA=function(t){this._view[3]=t<0?0:t},cc.defineGetterSetter(_p,"r",_p._getR,_p._setR),cc.defineGetterSetter(_p,"g",_p._getG,_p._setG),cc.defineGetterSetter(_p,"b",_p._getB,_p._setB),cc.defineGetterSetter(_p,"a",_p._getA,_p._setA))}),_p=cc.color,_p._getWhite=function(){return cc.color(255,255,255)},_p._getYellow=function(){return cc.color(255,255,0)},_p._getBlue=function(){return cc.color(0,0,255)},_p._getGreen=function(){return cc.color(0,255,0)},_p._getRed=function(){return cc.color(255,0,0)},_p._getMagenta=function(){return cc.color(255,0,255)},_p._getBlack=function(){return cc.color(0,0,0)},_p._getOrange=function(){return cc.color(255,127,0)},_p._getGray=function(){return cc.color(166,166,166)},cc.defineGetterSetter(_p,"WHITE",_p._getWhite),cc.defineGetterSetter(_p,"YELLOW",_p._getYellow),cc.defineGetterSetter(_p,"BLUE",_p._getBlue),cc.defineGetterSetter(_p,"GREEN",_p._getGreen),cc.defineGetterSetter(_p,"RED",_p._getRed),cc.defineGetterSetter(_p,"MAGENTA",_p._getMagenta),cc.defineGetterSetter(_p,"BLACK",_p._getBlack),cc.defineGetterSetter(_p,"ORANGE",_p._getOrange),cc.defineGetterSetter(_p,"GRAY",_p._getGray),cc.BlendFunc._disable=function(){return new cc.BlendFunc(cc.ONE,cc.ZERO)},cc.BlendFunc._alphaPremultiplied=function(){return new cc.BlendFunc(cc.ONE,cc.ONE_MINUS_SRC_ALPHA)},cc.BlendFunc._alphaNonPremultiplied=function(){return new cc.BlendFunc(cc.SRC_ALPHA,cc.ONE_MINUS_SRC_ALPHA)},cc.BlendFunc._additive=function(){return new cc.BlendFunc(cc.SRC_ALPHA,cc.ONE)},cc.defineGetterSetter(cc.BlendFunc,"DISABLE",cc.BlendFunc._disable),cc.defineGetterSetter(cc.BlendFunc,"ALPHA_PREMULTIPLIED",cc.BlendFunc._alphaPremultiplied),cc.defineGetterSetter(cc.BlendFunc,"ALPHA_NON_PREMULTIPLIED",cc.BlendFunc._alphaNonPremultiplied),cc.defineGetterSetter(cc.BlendFunc,"ADDITIVE",cc.BlendFunc._additive),cc.Touches=[],cc.TouchesIntergerDict={},cc.DENSITYDPI_DEVICE="device-dpi",cc.DENSITYDPI_HIGH="high-dpi",cc.DENSITYDPI_MEDIUM="medium-dpi",cc.DENSITYDPI_LOW="low-dpi";var __BrowserGetter={init:function(){this.html=document.documentElement},availWidth:function(t){return t&&t!==this.html?t.clientWidth:window.innerWidth},availHeight:function(t){return t&&t!==this.html?t.clientHeight:window.innerHeight},meta:{width:"device-width"},adaptationType:cc.sys.browserType};switch(-1<window.navigator.userAgent.indexOf("OS 8_1_")&&(__BrowserGetter.adaptationType=cc.sys.BROWSER_TYPE_MIUI),cc.sys.os===cc.sys.OS_IOS&&(__BrowserGetter.adaptationType=cc.sys.BROWSER_TYPE_SAFARI),__BrowserGetter.adaptationType){case cc.sys.BROWSER_TYPE_SAFARI:__BrowserGetter.meta["minimal-ui"]="true";break;case cc.sys.BROWSER_TYPE_CHROME:__BrowserGetter.__defineGetter__("target-densitydpi",function(){return cc.view._targetDensityDPI});break;case cc.sys.BROWSER_TYPE_MIUI:__BrowserGetter.init=function(t){var e;t.__resizeWithBrowserSize||(e=function(){t.setDesignResolutionSize(t._designResolutionSize.width,t._designResolutionSize.height,t._resolutionPolicy),window.removeEventListener("resize",e,!1)},window.addEventListener("resize",e,!1))}}var _scissorRect=null,GlobalVertexBuffer=(cc.EGLView=cc.Class.extend({_delegate:null,_frameSize:null,_designResolutionSize:null,_originalDesignResolutionSize:null,_viewPortRect:null,_visibleRect:null,_retinaEnabled:!1,_autoFullScreen:!1,_devicePixelRatio:1,_viewName:"",_resizeCallback:null,_orientationChanging:!0,_resizing:!1,_scaleX:1,_originalScaleX:1,_scaleY:1,_originalScaleY:1,_isRotated:!1,_orientation:3,_resolutionPolicy:null,_rpExactFit:null,_rpShowAll:null,_rpNoBorder:null,_rpFixedHeight:null,_rpFixedWidth:null,_initialized:!1,_contentTranslateLeftTop:null,_frame:null,_frameZoomFactor:1,__resizeWithBrowserSize:!1,_isAdjustViewPort:!0,_targetDensityDPI:null,ctor:function(){var t=document,e=cc.ContainerStrategy,i=cc.ContentStrategy,t=(__BrowserGetter.init(this),this._frame=cc.container.parentNode===t.body?t.documentElement:cc.container.parentNode,this._frameSize=cc.size(0,0),this._initFrameSize(),cc._canvas.width),n=cc._canvas.height;this._designResolutionSize=cc.size(t,n),this._originalDesignResolutionSize=cc.size(t,n),this._viewPortRect=cc.rect(0,0,t,n),this._visibleRect=cc.rect(0,0,t,n),this._contentTranslateLeftTop={left:0,top:0},this._viewName="Cocos2dHTML5",t=cc.sys,cc.visibleRect&&cc.visibleRect.init(this._visibleRect),this._rpExactFit=new cc.ResolutionPolicy(e.EQUAL_TO_FRAME,i.EXACT_FIT),this._rpShowAll=new cc.ResolutionPolicy(e.PROPORTION_TO_FRAME,i.SHOW_ALL),this._rpNoBorder=new cc.ResolutionPolicy(e.EQUAL_TO_FRAME,i.NO_BORDER),this._rpFixedHeight=new cc.ResolutionPolicy(e.EQUAL_TO_FRAME,i.FIXED_HEIGHT),this._rpFixedWidth=new cc.ResolutionPolicy(e.EQUAL_TO_FRAME,i.FIXED_WIDTH),this._targetDensityDPI=cc.DENSITYDPI_HIGH,t.isMobile?window.addEventListener("orientationchange",this._orientationChange):this._orientationChanging=!1},_resizeEvent:function(){var t,e,i,n,s,r=this.setDesignResolutionSize?this:cc.view;r._orientationChanging||(t=r._frameSize.width,e=r._frameSize.height,i=r._isRotated,cc.sys.isMobile?(s=(n=cc.game.container.style).margin,n.margin="0",n.display="none",r._initFrameSize(),n.margin=s,n.display="block"):r._initFrameSize(),r._isRotated===i&&r._frameSize.width===t&&r._frameSize.height===e)||(t=r._originalDesignResolutionSize.width,e=r._originalDesignResolutionSize.height,r._resizing=!0,0<t&&r.setDesignResolutionSize(t,e,r._resolutionPolicy),r._resizing=!1,cc.eventManager.dispatchCustomEvent("canvas-resize"),r._resizeCallback&&r._resizeCallback.call())},_orientationChange:function(){cc.view._orientationChanging=!0,cc.sys.isMobile&&(cc.game.container.style.display="none"),setTimeout(function(){cc.view._orientationChanging=!1,cc.view._resizeEvent()},300)},setTargetDensityDPI:function(t){this._targetDensityDPI=t,this._adjustViewportMeta()},getTargetDensityDPI:function(){return this._targetDensityDPI},resizeWithBrowserSize:function(t){t?this.__resizeWithBrowserSize||(this.__resizeWithBrowserSize=!0,window.addEventListener("resize",this._resizeEvent)):this.__resizeWithBrowserSize&&(this.__resizeWithBrowserSize=!1,window.removeEventListener("resize",this._resizeEvent))},setResizeCallback:function(t){"function"!=typeof t&&null!=t||(this._resizeCallback=t)},setOrientation:function(t){(t&=cc.ORIENTATION_AUTO)&&this._orientation!==t&&(this._orientation=t,this._resolutionPolicy)&&this.setDesignResolutionSize(this._originalDesignResolutionSize.width,this._originalDesignResolutionSize.height,this._resolutionPolicy)},setDocumentPixelWidth:function(t){this._setViewportMeta({width:t},!0),document.documentElement.style.width=t+"px",document.body.style.width="100%",this.setDesignResolutionSize(this._designResolutionSize.width,this._designResolutionSize.height,this._resolutionPolicy)},_initFrameSize:function(){var t=this._frameSize,e=__BrowserGetter.availWidth(this._frame),i=__BrowserGetter.availHeight(this._frame),n=i<=e;!cc.sys.isMobile||n&&this._orientation&cc.ORIENTATION_LANDSCAPE||!n&&this._orientation&cc.ORIENTATION_PORTRAIT?(t.width=e,t.height=i,cc.container.style["-webkit-transform"]="rotate(0deg)",cc.container.style.transform="rotate(0deg)",this._isRotated=!1):(t.width=i,t.height=e,cc.container.style["-webkit-transform"]="rotate(90deg)",cc.container.style.transform="rotate(90deg)",cc.container.style["-webkit-transform-origin"]="0px 0px 0px",cc.container.style.transformOrigin="0px 0px 0px",this._isRotated=!0)},_adjustSizeKeepCanvasSize:function(){var t=this._originalDesignResolutionSize.width,e=this._originalDesignResolutionSize.height;0<t&&this.setDesignResolutionSize(t,e,this._resolutionPolicy)},_setViewportMeta:function(t,e){var i,n,s=document.getElementById("cocosMetaElement"),r=(s&&e&&document.head.removeChild(s),document.getElementsByName("viewport")),o=(r=r?r[0]:null)?r.content:"";for(i in(s=s||document.createElement("meta")).id="cocosMetaElement",s.name="viewport",s.content="",t)-1==o.indexOf(i)?o+=","+i+"="+t[i]:e&&(n=RegExp(i+"s*=s*[^,]+"),o.replace(n,i+"="+t[i]));/^,/.test(o)&&(o=o.substr(1)),s.content=o,r&&(r.content=o),document.head.appendChild(s)},_adjustViewportMeta:function(){this._isAdjustViewPort&&(this._setViewportMeta(__BrowserGetter.meta,!1),this._isAdjustViewPort=!1)},_setScaleXYForRenderTexture:function(){var t=cc.contentScaleFactor();this._scaleY=this._scaleX=t},_resetScale:function(){this._scaleX=this._originalScaleX,this._scaleY=this._originalScaleY},_adjustSizeToBrowser:function(){},initialize:function(){this._initialized=!0},adjustViewPort:function(t){this._isAdjustViewPort=t},enableRetina:function(t){this._retinaEnabled=!!t},isRetinaEnabled:function(){return this._retinaEnabled},enableAutoFullScreen:function(t){t&&t!==this._autoFullScreen&&cc.sys.isMobile&&this._frame===document.documentElement?(this._autoFullScreen=!0,cc.screen.autoFullScreen(this._frame)):this._autoFullScreen=!1},isAutoFullScreenEnabled:function(){return this._autoFullScreen},isOpenGLReady:function(){return cc.game.canvas&&cc._renderContext},setFrameZoomFactor:function(t){this._frameZoomFactor=t,this.centerWindow(),cc.director.setProjection(cc.director.getProjection())},swapBuffers:function(){},setIMEKeyboardState:function(t){},setContentTranslateLeftTop:function(t,e){this._contentTranslateLeftTop={left:t,top:e}},getContentTranslateLeftTop:function(){return this._contentTranslateLeftTop},getCanvasSize:function(){return cc.size(cc._canvas.width,cc._canvas.height)},getFrameSize:function(){return cc.size(this._frameSize.width,this._frameSize.height)},setFrameSize:function(t,e){this._frameSize.width=t,this._frameSize.height=e,this._frame.style.width=t+"px",this._frame.style.height=e+"px",this._resizeEvent(),cc.director.setProjection(cc.director.getProjection())},getVisibleSize:function(){return cc.size(this._visibleRect.width,this._visibleRect.height)},getVisibleSizeInPixel:function(){return cc.size(this._visibleRect.width*this._scaleX,this._visibleRect.height*this._scaleY)},getVisibleOrigin:function(){return cc.p(this._visibleRect.x,this._visibleRect.y)},getVisibleOriginInPixel:function(){return cc.p(this._visibleRect.x*this._scaleX,this._visibleRect.y*this._scaleY)},canSetContentScaleFactor:function(){return!0},getResolutionPolicy:function(){return this._resolutionPolicy},setResolutionPolicy:function(t){var e;t instanceof cc.ResolutionPolicy?this._resolutionPolicy=t:(t===(e=cc.ResolutionPolicy).EXACT_FIT&&(this._resolutionPolicy=this._rpExactFit),t===e.SHOW_ALL&&(this._resolutionPolicy=this._rpShowAll),t===e.NO_BORDER&&(this._resolutionPolicy=this._rpNoBorder),t===e.FIXED_HEIGHT&&(this._resolutionPolicy=this._rpFixedHeight),t===e.FIXED_WIDTH&&(this._resolutionPolicy=this._rpFixedWidth))},setDesignResolutionSize:function(t,e,i){var n;0<t||0<e?(this.setResolutionPolicy(i),(i=this._resolutionPolicy)&&i.preApply(this),cc.sys.isMobile&&this._adjustViewportMeta(),this._resizing||this._initFrameSize(),i?(this._originalDesignResolutionSize.width=this._designResolutionSize.width=t,this._originalDesignResolutionSize.height=this._designResolutionSize.height=e,(n=i.apply(this,this._designResolutionSize)).scale&&2===n.scale.length&&(this._scaleX=n.scale[0],this._scaleY=n.scale[1]),n.viewport&&(t=this._viewPortRect,e=this._visibleRect,n=n.viewport,t.x=n.x,t.y=n.y,t.width=n.width,t.height=n.height,e.x=-t.x/this._scaleX,e.y=-t.y/this._scaleY,e.width=cc._canvas.width/this._scaleX,e.height=cc._canvas.height/this._scaleY,cc._renderContext.setOffset)&&cc._renderContext.setOffset(t.x,-t.y),(t=cc.director)._winSizeInPoints.width=this._designResolutionSize.width,t._winSizeInPoints.height=this._designResolutionSize.height,i.postApply(this),cc.winSize.width=t._winSizeInPoints.width,cc.winSize.height=t._winSizeInPoints.height,cc._renderType===cc.game.RENDER_TYPE_WEBGL?t.setGLDefaultValues():cc._renderType===cc.game.RENDER_TYPE_CANVAS&&(cc.renderer._allNeedDraw=!0),this._originalScaleX=this._scaleX,this._originalScaleY=this._scaleY,cc.visibleRect&&cc.visibleRect.init(this._visibleRect)):cc.log(cc._LogInfos.EGLView_setDesignResolutionSize_2)):cc.log(cc._LogInfos.EGLView_setDesignResolutionSize)},getDesignResolutionSize:function(){return cc.size(this._designResolutionSize.width,this._designResolutionSize.height)},setRealPixelResolution:function(t,e,i){this._setViewportMeta({width:t},!0),document.documentElement.style.width=t+"px",document.body.style.width=t+"px",document.body.style.left="0px",document.body.style.top="0px",this.setDesignResolutionSize(t,e,i)},setViewPortInPoints:function(t,e,i,n){var s=this._frameZoomFactor,r=this._scaleX,o=this._scaleY;cc._renderContext.viewport(t*r*s+this._viewPortRect.x*s,e*o*s+this._viewPortRect.y*s,i*r*s,n*o*s)},setScissorInPoints:function(t,e,i,n){var s=this._frameZoomFactor,r=this._scaleX,o=this._scaleY;t=Math.ceil(t*r*s+this._viewPortRect.x*s),e=Math.ceil(e*o*s+this._viewPortRect.y*s),i=Math.ceil(i*r*s),n=Math.ceil(n*o*s),_scissorRect||(s=gl.getParameter(gl.SCISSOR_BOX),_scissorRect=cc.rect(s[0],s[1],s[2],s[3])),_scissorRect.x==t&&_scissorRect.y==e&&_scissorRect.width==i&&_scissorRect.height==n||(_scissorRect.x=t,_scissorRect.y=e,_scissorRect.width=i,_scissorRect.height=n,cc._renderContext.scissor(t,e,i,n))},isScissorEnabled:function(){return cc._renderContext.isEnabled(gl.SCISSOR_TEST)},getScissorRect:function(){_scissorRect||(t=gl.getParameter(gl.SCISSOR_BOX),_scissorRect=cc.rect(t[0],t[1],t[2],t[3]));var t=1/this._scaleX,e=1/this._scaleY;return cc.rect((_scissorRect.x-this._viewPortRect.x)*t,(_scissorRect.y-this._viewPortRect.y)*e,_scissorRect.width*t,_scissorRect.height*e)},setViewName:function(t){null!=t&&0<t.length&&(this._viewName=t)},getViewName:function(){return this._viewName},getViewPortRect:function(){return this._viewPortRect},getScaleX:function(){return this._scaleX},getScaleY:function(){return this._scaleY},getDevicePixelRatio:function(){return this._devicePixelRatio},convertToLocationInView:function(t,e,i){return t=this._devicePixelRatio*(t-i.left),e=this._devicePixelRatio*(i.top+i.height-e),this._isRotated?{x:this._viewPortRect.width-e,y:t}:{x:t,y:e}},_convertMouseToLocationInView:function(t,e){var i=this._viewPortRect;t.x=(this._devicePixelRatio*(t.x-e.left)-i.x)/this._scaleX,t.y=(this._devicePixelRatio*(e.top+e.height-t.y)-i.y)/this._scaleY},_convertPointWithScale:function(t){var e=this._viewPortRect;t.x=(t.x-e.x)/this._scaleX,t.y=(t.y-e.y)/this._scaleY},_convertTouchesWithScale:function(t){for(var e,i,n=this._viewPortRect,s=this._scaleX,r=this._scaleY,o=0;o<t.length;o++)i=(e=t[o])._point,e=e._prevPoint,i.x=(i.x-n.x)/s,i.y=(i.y-n.y)/r,e.x=(e.x-n.x)/s,e.y=(e.y-n.y)/r}}),cc.EGLView._getInstance=function(){return this._instance||(this._instance=this._instance||new cc.EGLView,this._instance.initialize()),this._instance},cc.ContainerStrategy=cc.Class.extend({preApply:function(t){},apply:function(t,e){},postApply:function(t){},_setupContainer:function(t,e,i){var n=cc.game.canvas,s=cc.game.container;cc.sys.os===cc.sys.OS_ANDROID&&(document.body.style.width=(t._isRotated?i:e)+"px",document.body.style.height=(t._isRotated?e:i)+"px"),s.style.width=n.style.width=e+"px",s.style.height=n.style.height=i+"px",s=t._devicePixelRatio=1,t.isRetinaEnabled()&&(s=t._devicePixelRatio=Math.min(2,window.devicePixelRatio||1)),n.width=e*s,n.height=i*s,cc._renderContext.resetCache&&cc._renderContext.resetCache()},_fixContainer:function(){document.body.insertBefore(cc.container,document.body.firstChild);var t=document.body.style;t.width=window.innerWidth+"px",t.height=window.innerHeight+"px",t.overflow="hidden",(t=cc.container.style).position="fixed",t.left=t.top="0px",document.body.scrollTop=0}}),cc.ContentStrategy=cc.Class.extend({_result:{scale:[1,1],viewport:null},_buildResult:function(t,e,i,n,s,r){return Math.abs(t-i)<2&&(i=t),Math.abs(e-n)<2&&(n=e),t=cc.rect(Math.round((t-i)/2),Math.round((e-n)/2),i,n),this._result.scale=[s,r],this._result.viewport=t,this._result},preApply:function(t){},apply:function(t,e){return{scale:[1,1]}},postApply:function(t){}}),!function(){var t=cc.ContainerStrategy.extend({apply:function(t){var e=t._frameSize.height,i=cc.container.style;this._setupContainer(t,t._frameSize.width,t._frameSize.height),i.margin=t._isRotated?"0 0 0 "+e+"px":"0px"}}),e=cc.ContainerStrategy.extend({apply:function(t,e){var i,n=t._frameSize.width,s=t._frameSize.height,r=cc.container.style,o=e.width,e=e.height,a=n/o,c=s/e,e=a<c?(i=n,e*a):(i=o*c,s),o=Math.round((n-i)/2);e=Math.round((s-e)/2),this._setupContainer(t,n-2*o,s-2*e),r.margin=t._isRotated?"0 0 0 "+s+"px":"0px",r.paddingLeft=o+"px",r.paddingRight=o+"px",r.paddingTop=e+"px",r.paddingBottom=e+"px"}}),i=(t.extend({preApply:function(t){this._super(t),t._frame=document.documentElement},apply:function(t){this._super(t),this._fixContainer()}}),e.extend({preApply:function(t){this._super(t),t._frame=document.documentElement},apply:function(t,e){this._super(t,e),this._fixContainer()}}),cc.ContainerStrategy.extend({apply:function(t){this._setupContainer(t,cc._canvas.width,cc._canvas.height)}})),t=(cc.ContainerStrategy.EQUAL_TO_FRAME=new t,cc.ContainerStrategy.PROPORTION_TO_FRAME=new e,cc.ContainerStrategy.ORIGINAL_CONTAINER=new i,cc.ContentStrategy.extend({apply:function(t,e){var i=cc._canvas.width,n=cc._canvas.height;return this._buildResult(i,n,i,n,i/e.width,n/e.height)}})),e=cc.ContentStrategy.extend({apply:function(t,e){var i,n=cc._canvas.width,s=cc._canvas.height,r=e.width,e=e.height,o=n/r,a=s/e,c=0,e=o<a?(i=n,e*(c=o)):(i=r*(c=a),s);return this._buildResult(n,s,i,e,c,c)}}),i=cc.ContentStrategy.extend({apply:function(t,e){var i,n,s=cc._canvas.width,r=cc._canvas.height,o=e.width,e=e.height,a=s/o,c=r/e,o=a<c?(n=o*(i=c),r):(n=s,e*(i=a));return this._buildResult(s,r,n,o,i,i)}}),n=cc.ContentStrategy.extend({apply:function(t,e){var i=cc._canvas.width,n=cc._canvas.height,e=n/e.height;return this._buildResult(i,n,i,n,e,e)},postApply:function(t){cc.director._winSizeInPoints=t.getVisibleSize()}}),s=cc.ContentStrategy.extend({apply:function(t,e){var i=cc._canvas.width,n=cc._canvas.height,e=i/e.width;return this._buildResult(i,n,i,n,e,e)},postApply:function(t){cc.director._winSizeInPoints=t.getVisibleSize()}});cc.ContentStrategy.EXACT_FIT=new t,cc.ContentStrategy.SHOW_ALL=new e,cc.ContentStrategy.NO_BORDER=new i,cc.ContentStrategy.FIXED_HEIGHT=new n,cc.ContentStrategy.FIXED_WIDTH=new s}(),cc.ResolutionPolicy=cc.Class.extend({_containerStrategy:null,_contentStrategy:null,ctor:function(t,e){this.setContainerStrategy(t),this.setContentStrategy(e)},preApply:function(t){this._containerStrategy.preApply(t),this._contentStrategy.preApply(t)},apply:function(t,e){return this._containerStrategy.apply(t,e),this._contentStrategy.apply(t,e)},postApply:function(t){this._containerStrategy.postApply(t),this._contentStrategy.postApply(t)},setContainerStrategy:function(t){t instanceof cc.ContainerStrategy&&(this._containerStrategy=t)},setContentStrategy:function(t){t instanceof cc.ContentStrategy&&(this._contentStrategy=t)}}),cc.ResolutionPolicy.EXACT_FIT=0,cc.ResolutionPolicy.NO_BORDER=1,cc.ResolutionPolicy.SHOW_ALL=2,cc.ResolutionPolicy.FIXED_HEIGHT=3,cc.ResolutionPolicy.FIXED_WIDTH=4,cc.ResolutionPolicy.UNKNOWN=5,cc.screen={_supportsFullScreen:!1,_preOnFullScreenChange:null,_touchEvent:"",_fn:null,_fnMap:[["requestFullscreen","exitFullscreen","fullscreenchange","fullscreenEnabled","fullscreenElement"],["requestFullScreen","exitFullScreen","fullScreenchange","fullScreenEnabled","fullScreenElement"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitfullscreenchange","webkitIsFullScreen","webkitCurrentFullScreenElement"],["mozRequestFullScreen","mozCancelFullScreen","mozfullscreenchange","mozFullScreen","mozFullScreenElement"],["msRequestFullscreen","msExitFullscreen","MSFullscreenChange","msFullscreenEnabled","msFullscreenElement"]],init:function(){this._fn={};var t,e,i=this._fnMap,n=0;for(l=i.length;n<l;n++)if((t=i[n])&&t[1]in document){for(n=0,e=t.length;n<e;n++)this._fn[i[0][n]]=t[n];break}this._supportsFullScreen=void 0!==this._fn.requestFullscreen,this._touchEvent="ontouchstart"in window?"touchstart":"mousedown"},fullScreen:function(){return!!this._supportsFullScreen&&void 0!==document[this._fn.fullscreenElement]&&null!==document[this._fn.fullscreenElement]},requestFullScreen:function(t,e){var i;if(this._supportsFullScreen)return t=t||document.documentElement,e&&(i=this._fn.fullscreenchange,this._preOnFullScreenChange&&document.removeEventListener(i,this._preOnFullScreenChange),this._preOnFullScreenChange=e,document.addEventListener(i,e,!1)),t[this._fn.requestFullscreen]()},exitFullScreen:function(){return!this._supportsFullScreen||document[this._fn.exitFullscreen]()},autoFullScreen:function(e,i){e=e||document.body;var n=cc.game.canvas||e,s=this;this.requestFullScreen(e,i),n.addEventListener(this._touchEvent,function t(){n.removeEventListener(s._touchEvent,t),s.requestFullScreen(e,i)})}},cc.screen.init(),cc.visibleRect={topLeft:cc.p(0,0),topRight:cc.p(0,0),top:cc.p(0,0),bottomLeft:cc.p(0,0),bottomRight:cc.p(0,0),bottom:cc.p(0,0),center:cc.p(0,0),left:cc.p(0,0),right:cc.p(0,0),width:0,height:0,init:function(t){var e=this.width=t.width,i=this.height=t.height,n=t.x,s=(t=t.y)+i,r=n+e;this.topLeft.x=n,this.topLeft.y=s,this.topRight.x=r,this.topRight.y=s,this.top.x=n+e/2,this.top.y=s,this.bottomLeft.x=n,this.bottomLeft.y=t,this.bottomRight.x=r,this.bottomRight.y=t,this.bottom.x=n+e/2,this.bottom.y=t,this.center.x=n+e/2,this.center.y=t+i/2,this.left.x=n,this.left.y=t+i/2,this.right.x=r,this.right.y=t+i/2}},cc.UIInterfaceOrientationLandscapeLeft=-90,cc.UIInterfaceOrientationLandscapeRight=90,cc.UIInterfaceOrientationPortraitUpsideDown=180,cc.UIInterfaceOrientationPortrait=0,cc.inputManager={TOUCH_TIMEOUT:5e3,_mousePressed:!1,_isRegisterEvent:!1,_preTouchPoint:cc.p(0,0),_prevMousePoint:cc.p(0,0),_preTouchPool:[],_preTouchPoolPointer:0,_touches:[],_touchesIntegerDict:{},_indexBitsUsed:0,_maxTouches:5,_accelEnabled:!1,_accelInterval:1/30,_accelMinus:1,_accelCurTime:0,_acceleration:null,_accelDeviceEvent:null,_getUnUsedIndex:function(){for(var t=this._indexBitsUsed,e=cc.sys.now(),i=0;i<this._maxTouches;i++){if(!(1&t))return this._indexBitsUsed|=1<<i,i;var n=this._touches[i];if(e-n._lastModified>this.TOUCH_TIMEOUT)return this._removeUsedIndexBit(i),delete this._touchesIntegerDict[n.getID()],i;t>>=1}return-1},_removeUsedIndexBit:function(t){t<0||t>=this._maxTouches||(this._indexBitsUsed&=t=~(1<<t))},_glView:null,handleTouchesBegin:function(t){for(var e,i,n,s,r=[],o=this._touchesIntegerDict,a=cc.sys.now(),c=0,h=t.length;c<h;c++)null==(s=o[n=(i=t[c]).getID()])&&(-1===(e=this._getUnUsedIndex())?cc.log(cc._LogInfos.inputManager_handleTouchesBegin,e):((s=this._touches[e]=new cc.Touch(i._point.x,i._point.y,i.getID()))._lastModified=a,s._setPrevPoint(i._prevPoint),o[n]=e,r.push(s)));0<r.length&&(this._glView._convertTouchesWithScale(r),(t=new cc.EventTouch(r))._eventCode=cc.EventTouch.EventCode.BEGAN,cc.eventManager.dispatchEvent(t))},handleTouchesMove:function(t){for(var e,i,n=[],s=this._touches,r=cc.sys.now(),o=0,a=t.length;o<a;o++)i=(e=t[o]).getID(),null!=(i=this._touchesIntegerDict[i])&&s[i]&&(s[i]._setPoint(e._point),s[i]._setPrevPoint(e._prevPoint),s[i]._lastModified=r,n.push(s[i]));0<n.length&&(this._glView._convertTouchesWithScale(n),(t=new cc.EventTouch(n))._eventCode=cc.EventTouch.EventCode.MOVED,cc.eventManager.dispatchEvent(t))},handleTouchesEnd:function(t){0<(t=this.getSetOfTouchesEndOrCancel(t)).length&&(this._glView._convertTouchesWithScale(t),(t=new cc.EventTouch(t))._eventCode=cc.EventTouch.EventCode.ENDED,cc.eventManager.dispatchEvent(t))},handleTouchesCancel:function(t){0<(t=this.getSetOfTouchesEndOrCancel(t)).length&&(this._glView._convertTouchesWithScale(t),(t=new cc.EventTouch(t))._eventCode=cc.EventTouch.EventCode.CANCELLED,cc.eventManager.dispatchEvent(t))},getSetOfTouchesEndOrCancel:function(t){for(var e,i,n,s=[],r=this._touches,o=this._touchesIntegerDict,a=0,c=t.length;a<c;a++)null!=(i=o[n=(e=t[a]).getID()])&&r[i]&&(r[i]._setPoint(e._point),r[i]._setPrevPoint(e._prevPoint),s.push(r[i]),this._removeUsedIndexBit(i),delete o[n]);return s},getHTMLElementPosition:function(t){var e=document.documentElement,i=window;return{left:(t=cc.isFunction(t.getBoundingClientRect)?t.getBoundingClientRect():{left:0,top:0,width:parseInt(t.style.width),height:parseInt(t.style.height)}).left+i.pageXOffset-e.clientLeft,top:t.top+i.pageYOffset-e.clientTop,width:t.width,height:t.height}},getPreTouch:function(t){for(var e=null,i=this._preTouchPool,n=t.getID(),s=i.length-1;0<=s;s--)if(i[s].getID()===n){e=i[s];break}return e=e||t},setPreTouch:function(t){for(var e=!1,i=this._preTouchPool,n=t.getID(),s=i.length-1;0<=s;s--)if(i[s].getID()===n){i[s]=t,e=!0;break}e||(i.length<=50?i.push(t):(i[this._preTouchPoolPointer]=t,this._preTouchPoolPointer=(this._preTouchPoolPointer+1)%50))},getTouchByXY:function(t,e,i){var n=this._preTouchPoint;return t=this._glView.convertToLocationInView(t,e,i),(e=new cc.Touch(t.x,t.y))._setPrevPoint(n.x,n.y),n.x=t.x,n.y=t.y,e},getMouseEvent:function(t,e,i){var n=this._prevMousePoint;return this._glView._convertMouseToLocationInView(t,e),(e=new cc.EventMouse(i)).setLocation(t.x,t.y),e._setPrevCursor(n.x,n.y),n.x=t.x,n.y=t.y,e},getPointByEvent:function(t,e){return null!=t.pageX?{x:t.pageX,y:t.pageY}:(e.left-=document.body.scrollLeft,e.top-=document.body.scrollTop,{x:t.clientX,y:t.clientY})},getTouchesByEvent:function(t,e){for(var i,n,s,r=[],o=this._glView,a=this._preTouchPoint,c=t.changedTouches.length,h=0;h<c;h++)(i=t.changedTouches[h])&&(s=cc.sys.BROWSER_TYPE_FIREFOX===cc.sys.browserType?o.convertToLocationInView(i.pageX,i.pageY,e):o.convertToLocationInView(i.clientX,i.clientY,e),null!=i.identifier?(i=new cc.Touch(s.x,s.y,i.identifier),n=this.getPreTouch(i).getLocation(),i._setPrevPoint(n.x,n.y),this.setPreTouch(i)):(i=new cc.Touch(s.x,s.y))._setPrevPoint(a.x,a.y),a.x=s.x,a.y=s.y,r.push(i));return r},registerSystemEvent:function(n){if(!this._isRegisterEvent){this._glView=cc.view;var t,s=this,e="mouse"in cc.sys.capabilities,i="touches"in cc.sys.capabilities,r=!1;if(cc.sys.isMobile&&(r=!0),e&&(window.addEventListener("mousedown",function(){s._mousePressed=!0},!1),window.addEventListener("mouseup",function(t){var e,i;r||(e=s._mousePressed,s._mousePressed=!1,e&&(e=s.getHTMLElementPosition(n),i=s.getPointByEvent(t,e),cc.rectContainsPoint(new cc.Rect(e.left,e.top,e.width,e.height),i)||(s.handleTouchesEnd([s.getTouchByXY(i.x,i.y,e)]),(e=s.getMouseEvent(i,e,cc.EventMouse.UP)).setButton(t.button),cc.eventManager.dispatchEvent(e))))},!1),n.addEventListener("mousedown",function(t){var e,i;r||(s._mousePressed=!0,e=s.getHTMLElementPosition(n),i=s.getPointByEvent(t,e),s.handleTouchesBegin([s.getTouchByXY(i.x,i.y,e)]),(e=s.getMouseEvent(i,e,cc.EventMouse.DOWN)).setButton(t.button),cc.eventManager.dispatchEvent(e),t.stopPropagation(),t.preventDefault(),n.focus())},!1),n.addEventListener("mouseup",function(t){var e,i;r||(s._mousePressed=!1,e=s.getHTMLElementPosition(n),i=s.getPointByEvent(t,e),s.handleTouchesEnd([s.getTouchByXY(i.x,i.y,e)]),(e=s.getMouseEvent(i,e,cc.EventMouse.UP)).setButton(t.button),cc.eventManager.dispatchEvent(e),t.stopPropagation(),t.preventDefault())},!1),n.addEventListener("mousemove",function(t){var e,i;r||(e=s.getHTMLElementPosition(n),i=s.getPointByEvent(t,e),s.handleTouchesMove([s.getTouchByXY(i.x,i.y,e)]),e=s.getMouseEvent(i,e,cc.EventMouse.MOVE),s._mousePressed?e.setButton(t.button):e.setButton(null),cc.eventManager.dispatchEvent(e),t.stopPropagation(),t.preventDefault())},!1),n.addEventListener("mousewheel",function(t){var e=s.getHTMLElementPosition(n),i=s.getPointByEvent(t,e);(e=s.getMouseEvent(i,e,cc.EventMouse.SCROLL)).setButton(t.button),e.setScrollData(0,t.wheelDelta),cc.eventManager.dispatchEvent(e),t.stopPropagation(),t.preventDefault()},!1),n.addEventListener("DOMMouseScroll",function(t){var e=s.getHTMLElementPosition(n),i=s.getPointByEvent(t,e);(e=s.getMouseEvent(i,e,cc.EventMouse.SCROLL)).setButton(t.button),e.setScrollData(0,-120*t.detail),cc.eventManager.dispatchEvent(e),t.stopPropagation(),t.preventDefault()},!1)),window.navigator.msPointerEnabled)for(t in e={MSPointerDown:s.handleTouchesBegin,MSPointerMove:s.handleTouchesMove,MSPointerUp:s.handleTouchesEnd,MSPointerCancel:s.handleTouchesCancel})!function(t,i){n.addEventListener(t,function(t){var e=s.getHTMLElementPosition(n);e.left-=document.documentElement.scrollLeft,e.top-=document.documentElement.scrollTop,i.call(s,[s.getTouchByXY(t.clientX,t.clientY,e)]),t.stopPropagation()},!1)}(t,e[t]);i&&(n.addEventListener("touchstart",function(t){var e;t.changedTouches&&((e=s.getHTMLElementPosition(n)).left-=document.body.scrollLeft,e.top-=document.body.scrollTop,s.handleTouchesBegin(s.getTouchesByEvent(t,e)),t.stopPropagation(),t.preventDefault(),n.focus())},!1),n.addEventListener("touchmove",function(t){var e;t.changedTouches&&((e=s.getHTMLElementPosition(n)).left-=document.body.scrollLeft,e.top-=document.body.scrollTop,s.handleTouchesMove(s.getTouchesByEvent(t,e)),t.stopPropagation(),t.preventDefault())},!1),n.addEventListener("touchend",function(t){var e;t.changedTouches&&((e=s.getHTMLElementPosition(n)).left-=document.body.scrollLeft,e.top-=document.body.scrollTop,s.handleTouchesEnd(s.getTouchesByEvent(t,e)),t.stopPropagation(),t.preventDefault())},!1),n.addEventListener("touchcancel",function(t){var e;t.changedTouches&&((e=s.getHTMLElementPosition(n)).left-=document.body.scrollLeft,e.top-=document.body.scrollTop,s.handleTouchesCancel(s.getTouchesByEvent(t,e)),t.stopPropagation(),t.preventDefault())},!1)),this._registerKeyboardEvent(),this._isRegisterEvent=!0}},_registerKeyboardEvent:function(){},_registerAccelerometerEvent:function(){},update:function(t){this._accelCurTime>this._accelInterval&&(this._accelCurTime-=this._accelInterval,cc.eventManager.dispatchEvent(new cc.EventAcceleration(this._acceleration))),this._accelCurTime+=t}},_p=cc.inputManager,_p.setAccelerometerEnabled=function(t){this._accelEnabled!==t&&(this._accelEnabled=t,t=cc.director.getScheduler(),this._accelEnabled?(this._accelCurTime=0,this._registerAccelerometerEvent(),t.scheduleUpdate(this)):(this._accelCurTime=0,this._unregisterAccelerometerEvent(),t.unscheduleUpdate(this)))},_p.setAccelerometerInterval=function(t){this._accelInterval!==t&&(this._accelInterval=t)},_p._registerKeyboardEvent=function(){cc._canvas.addEventListener("keydown",function(t){cc.eventManager.dispatchEvent(new cc.EventKeyboard(t.keyCode,!0)),t.stopPropagation(),t.preventDefault()},!1),cc._canvas.addEventListener("keyup",function(t){cc.eventManager.dispatchEvent(new cc.EventKeyboard(t.keyCode,!1)),t.stopPropagation(),t.preventDefault()},!1)},_p._registerAccelerometerEvent=function(){var t=window,e=(this._acceleration=new cc.Acceleration,this._accelDeviceEvent=t.DeviceMotionEvent||t.DeviceOrientationEvent,cc.sys.browserType===cc.sys.BROWSER_TYPE_MOBILE_QQ&&(this._accelDeviceEvent=window.DeviceOrientationEvent),this._accelDeviceEvent===t.DeviceMotionEvent?"devicemotion":"deviceorientation"),i=navigator.userAgent;(/Android/.test(i)||/Adr/.test(i)&&cc.sys.browserType===cc.BROWSER_TYPE_UC)&&(this._minus=-1),this.didAccelerateCallback=this.didAccelerate.bind(this),t.addEventListener(e,this.didAccelerateCallback,!1)},_p._unregisterAccelerometerEvent=function(){this._acceleration=null,window.removeEventListener(this._accelDeviceEvent===window.DeviceMotionEvent?"devicemotion":"deviceorientation",this.didAccelerateCallback,!1)},_p.didAccelerate=function(t){var e,i,n,s,r=window;this._accelEnabled&&(e=this._acceleration,s=this._accelDeviceEvent===window.DeviceMotionEvent?(s=t.accelerationIncludingGravity,i=this._accelMinus*s.x*.1,n=this._accelMinus*s.y*.1,.1*s.z):(i=t.gamma/90*.981,n=-t.beta/90*.981,t.alpha/90*.981),e.x=i,e.y=n,e.z=s,e.timestamp=t.timeStamp||Date.now(),t=e.x,r.orientation===cc.UIInterfaceOrientationLandscapeRight?(e.x=-e.y,e.y=t):r.orientation===cc.UIInterfaceOrientationLandscapeLeft?(e.x=e.y,e.y=-t):r.orientation===cc.UIInterfaceOrientationPortraitUpsideDown&&(e.x=-e.x,e.y=-e.y))},delete _p,cc.AffineTransform=function(t,e,i,n,s,r){this.a=t,this.b=e,this.c=i,this.d=n,this.tx=s,this.ty=r},cc.affineTransformMake=function(t,e,i,n,s,r){return{a:t,b:e,c:i,d:n,tx:s,ty:r}},cc.pointApplyAffineTransform=function(t,e,i){var n;return t=void 0===i?(i=e,n=t.x,t.y):(n=t,e),{x:i.a*n+i.c*t+i.tx,y:i.b*n+i.d*t+i.ty}},cc._pointApplyAffineTransform=function(t,e,i){return cc.pointApplyAffineTransform(t,e,i)},cc.sizeApplyAffineTransform=function(t,e){return{width:e.a*t.width+e.c*t.height,height:e.b*t.width+e.d*t.height}},cc.affineTransformMakeIdentity=function(){return{a:1,b:0,c:0,d:1,tx:0,ty:0}},cc.affineTransformIdentity=function(){return{a:1,b:0,c:0,d:1,tx:0,ty:0}},cc.rectApplyAffineTransform=function(t,e){var i=cc.rectGetMinY(t),n=cc.rectGetMinX(t),s=cc.rectGetMaxX(t),t=cc.rectGetMaxY(t),r=cc.pointApplyAffineTransform(n,i,e),i=cc.pointApplyAffineTransform(s,i,e),n=cc.pointApplyAffineTransform(n,t,e),e=cc.pointApplyAffineTransform(s,t,e),s=Math.min(r.x,i.x,n.x,e.x),t=Math.max(r.x,i.x,n.x,e.x),o=Math.min(r.y,i.y,n.y,e.y),r=Math.max(r.y,i.y,n.y,e.y);return cc.rect(s,o,t-s,r-o)},cc._rectApplyAffineTransformIn=function(t,e){var i=cc.rectGetMinY(t),n=cc.rectGetMinX(t),s=cc.rectGetMaxX(t),r=cc.rectGetMaxY(t),o=cc.pointApplyAffineTransform(n,i,e),i=cc.pointApplyAffineTransform(s,i,e),n=cc.pointApplyAffineTransform(n,r,e),e=cc.pointApplyAffineTransform(s,r,e),s=Math.min(o.x,i.x,n.x,e.x),r=Math.max(o.x,i.x,n.x,e.x),a=Math.min(o.y,i.y,n.y,e.y),o=Math.max(o.y,i.y,n.y,e.y);return t.x=s,t.y=a,t.width=r-s,t.height=o-a,t},cc.affineTransformTranslate=function(t,e,i){return{a:t.a,b:t.b,c:t.c,d:t.d,tx:t.tx+t.a*e+t.c*i,ty:t.ty+t.b*e+t.d*i}},cc.affineTransformScale=function(t,e,i){return{a:t.a*e,b:t.b*e,c:t.c*i,d:t.d*i,tx:t.tx,ty:t.ty}},cc.affineTransformRotate=function(t,e){var i=Math.sin(e),e=Math.cos(e);return{a:t.a*e+t.c*i,b:t.b*e+t.d*i,c:t.c*e-t.a*i,d:t.d*e-t.b*i,tx:t.tx,ty:t.ty}},cc.affineTransformConcat=function(t,e){return{a:t.a*e.a+t.b*e.c,b:t.a*e.b+t.b*e.d,c:t.c*e.a+t.d*e.c,d:t.c*e.b+t.d*e.d,tx:t.tx*e.a+t.ty*e.c+e.tx,ty:t.tx*e.b+t.ty*e.d+e.ty}},cc.affineTransformConcatIn=function(t,e){var i=t.a,n=t.b,s=t.c,r=t.d,o=t.tx,a=t.ty;return t.a=i*e.a+n*e.c,t.b=i*e.b+n*e.d,t.c=s*e.a+r*e.c,t.d=s*e.b+r*e.d,t.tx=o*e.a+a*e.c+e.tx,t.ty=o*e.b+a*e.d+e.ty,t},cc.affineTransformEqualToTransform=function(t,e){return t.a===e.a&&t.b===e.b&&t.c===e.c&&t.d===e.d&&t.tx===e.tx&&t.ty===e.ty},cc.affineTransformInvert=function(t){var e=1/(t.a*t.d-t.b*t.c);return{a:e*t.d,b:-e*t.b,c:-e*t.c,d:e*t.a,tx:e*(t.c*t.ty-t.d*t.tx),ty:e*(t.b*t.tx-t.a*t.ty)}},cc.affineTransformInvertOut=function(t,e){var i=t.a,n=t.b,s=t.c,r=t.d,o=1/(i*r-n*s);e.a=o*r,e.b=-o*n,e.c=-o*s,e.d=o*i,e.tx=o*(s*t.ty-r*t.tx),e.ty=o*(n*t.tx-i*t.ty)},cc.POINT_EPSILON=parseFloat("1.192092896e-07F"),cc.pNeg=function(t){return cc.p(-t.x,-t.y)},cc.pAdd=function(t,e){return cc.p(t.x+e.x,t.y+e.y)},cc.pSub=function(t,e){return cc.p(t.x-e.x,t.y-e.y)},cc.pMult=function(t,e){return cc.p(t.x*e,t.y*e)},cc.pMidpoint=function(t,e){return cc.pMult(cc.pAdd(t,e),.5)},cc.pDot=function(t,e){return t.x*e.x+t.y*e.y},cc.pCross=function(t,e){return t.x*e.y-t.y*e.x},cc.pPerp=function(t){return cc.p(-t.y,t.x)},cc.pRPerp=function(t){return cc.p(t.y,-t.x)},cc.pProject=function(t,e){return cc.pMult(e,cc.pDot(t,e)/cc.pDot(e,e))},cc.pRotate=function(t,e){return cc.p(t.x*e.x-t.y*e.y,t.x*e.y+t.y*e.x)},cc.pUnrotate=function(t,e){return cc.p(t.x*e.x+t.y*e.y,t.y*e.x-t.x*e.y)},cc.pLengthSQ=function(t){return cc.pDot(t,t)},cc.pDistanceSQ=function(t,e){return cc.pLengthSQ(cc.pSub(t,e))},cc.pLength=function(t){return Math.sqrt(cc.pLengthSQ(t))},cc.pDistance=function(t,e){return cc.pLength(cc.pSub(t,e))},cc.pNormalize=function(t){var e=cc.pLength(t);return 0===e?cc.p(t):cc.pMult(t,1/e)},cc.pForAngle=function(t){return cc.p(Math.cos(t),Math.sin(t))},cc.pToAngle=function(t){return Math.atan2(t.y,t.x)},cc.clampf=function(t,e,i){var n;return i<e&&(n=e,e=i,i=n),t<e?e:t<i?t:i},cc.pClamp=function(t,e,i){return cc.p(cc.clampf(t.x,e.x,i.x),cc.clampf(t.y,e.y,i.y))},cc.pFromSize=function(t){return cc.p(t.width,t.height)},cc.pCompOp=function(t,e){return cc.p(e(t.x),e(t.y))},cc.pLerp=function(t,e,i){return cc.pAdd(cc.pMult(t,1-i),cc.pMult(e,i))},cc.pFuzzyEqual=function(t,e,i){return t.x-i<=e.x&&e.x<=t.x+i&&t.y-i<=e.y&&e.y<=t.y+i},cc.pCompMult=function(t,e){return cc.p(t.x*e.x,t.y*e.y)},cc.pAngleSigned=function(t,e){t=cc.pNormalize(t),e=cc.pNormalize(e),t=Math.atan2(t.x*e.y-t.y*e.x,cc.pDot(t,e));return Math.abs(t)<cc.POINT_EPSILON?0:t},cc.pAngle=function(t,e){t=Math.acos(cc.pDot(cc.pNormalize(t),cc.pNormalize(e)));return Math.abs(t)<cc.POINT_EPSILON?0:t},cc.pRotateByAngle=function(t,e,i){t=cc.pSub(t,e);var n=Math.cos(i),s=(i=Math.sin(i),t.x);return t.x=s*n-t.y*i+e.x,t.y=s*i+t.y*n+e.y,t},cc.pLineIntersect=function(t,e,i,n,s){var r,o,a;return!(t.x===e.x&&t.y===e.y||i.x===n.x&&i.y===n.y||(r=e.x-t.x,e=e.y-t.y,o=n.x-i.x,n=n.y-i.y,a=t.x-i.x,t=t.y-i.y,i=n*r-o*e,s.x=o*t-n*a,s.y=r*t-e*a,0===i?0!==s.x&&0!==s.y:(s.x/=i,s.y/=i,0)))},cc.pSegmentIntersect=function(t,e,i,n){var s=cc.p(0,0);return!!(cc.pLineIntersect(t,e,i,n,s)&&0<=s.x&&s.x<=1&&0<=s.y&&s.y<=1)},cc.pIntersectPoint=function(t,e,i,n){var s=cc.p(0,0);return cc.pLineIntersect(t,e,i,n,s)?((i=cc.p(0,0)).x=t.x+s.x*(e.x-t.x),i.y=t.y+s.x*(e.y-t.y),i):cc.p(0,0)},cc.pSameAs=function(t,e){return null!=t&&null!=e&&t.x===e.x&&t.y===e.y},cc.pZeroIn=function(t){t.x=0,t.y=0},cc.pIn=function(t,e){t.x=e.x,t.y=e.y},cc.pMultIn=function(t,e){t.x*=e,t.y*=e},cc.pSubIn=function(t,e){t.x-=e.x,t.y-=e.y},cc.pAddIn=function(t,e){t.x+=e.x,t.y+=e.y},cc.pNormalizeIn=function(t){var e=Math.sqrt(t.x*t.x+t.y*t.y);0!==e&&cc.pMultIn(t,1/e)},cc.vertexLineToPolygon=function(t,e,i,n,s){if(!((s+=n)<=1)){e*=.5;for(var r=s-1,o=n;o<s;o++){var a,c,h,l,u,d=2*o,_=cc.p(t[2*o],t[2*o+1]);a=0===o?cc.pPerp(cc.pNormalize(cc.pSub(_,cc.p(t[2*(o+1)],t[2*(o+1)+1])))):o===r?cc.pPerp(cc.pNormalize(cc.pSub(cc.p(t[2*(o-1)],t[2*(o-1)+1]),_))):(a=cc.p(t[2*(o-1)],t[2*(o-1)+1]),c=cc.p(t[2*(o+1)],t[2*(o+1)+1]),h=cc.pNormalize(cc.pSub(c,_)),l=cc.pNormalize(cc.pSub(a,_)),(u=Math.acos(cc.pDot(h,l)))<cc.degreesToRadians(70)?cc.pPerp(cc.pNormalize(cc.pMidpoint(h,l))):u<cc.degreesToRadians(170)?cc.pNormalize(cc.pMidpoint(h,l)):cc.pPerp(cc.pNormalize(cc.pSub(c,a)))),a=cc.pMult(a,e),i[2*d]=_.x+a.x,i[2*d+1]=_.y+a.y,i[2*(d+1)]=_.x-a.x,i[2*(d+1)+1]=_.y-a.y}for(o=0===n?0:n-1;o<r;o++)t=(d=2*o)+2,e=cc.vertex2(i[2*d],i[2*d+1]),s=cc.vertex2(i[2*(d+1)],i[2*(d+1)+1]),d=cc.vertex2(i[2*t],i[2*t]),n=cc.vertex2(i[2*(t+1)],i[2*(t+1)+1]),!(e=!cc.vertexLineIntersect(e.x,e.y,n.x,n.y,s.x,s.y,d.x,d.y)).isSuccess&&(e.value<0||1<e.value)&&(e.isSuccess=!0),e.isSuccess&&(i[2*t]=n.x,i[2*t+1]=n.y,i[2*(t+1)]=d.x,i[2*(t+1)+1]=d.y)}},cc.vertexLineIntersect=function(t,e,i,n,s,r,o,a){return t===i&&e===n||s===o&&r===a||(n-=e,r-=e,o-=t,a-=e,e=(s-=t)*(i=(i-=t)/(t=Math.sqrt(i*i+n*n)))+r*(n/=t),r=r*i-s*n,s=e,e=o*i+a*n,a=a*i-o*n,o=e,r===a)?{isSuccess:!1,value:0}:{isSuccess:!0,value:(o+(s-o)*a/(a-r))/t}},cc.vertexListIsClockwise=function(t){for(var e=0,i=t.length;e<i;e++){var n=t[(e+1)%i],s=t[(e+2)%i];if(0<cc.pCross(cc.pSub(n,t[e]),cc.pSub(s,n)))return!1}return!0},cc.CGAffineToGL=function(t,e){e[2]=e[3]=e[6]=e[7]=e[8]=e[9]=e[11]=e[14]=0,e[10]=e[15]=1,e[0]=t.a,e[4]=t.c,e[12]=t.tx,e[1]=t.b,e[5]=t.d,e[13]=t.ty},cc.GLToCGAffine=function(t,e){e.a=t[0],e.c=t[4],e.tx=t[12],e.b=t[1],e.d=t[5],e.ty=t[13]},cc.Touch=cc.Class.extend({_lastModified:0,_point:null,_prevPoint:null,_id:0,_startPointCaptured:!1,_startPoint:null,ctor:function(t,e,i){this.setTouchInfo(i,t,e)},getLocation:function(){return{x:this._point.x,y:this._point.y}},getLocationX:function(){return this._point.x},getLocationY:function(){return this._point.y},getPreviousLocation:function(){return{x:this._prevPoint.x,y:this._prevPoint.y}},getStartLocation:function(){return{x:this._startPoint.x,y:this._startPoint.y}},getDelta:function(){return cc.pSub(this._point,this._prevPoint)},getLocationInView:function(){return{x:this._point.x,y:this._point.y}},getPreviousLocationInView:function(){return{x:this._prevPoint.x,y:this._prevPoint.y}},getStartLocationInView:function(){return{x:this._startPoint.x,y:this._startPoint.y}},getID:function(){return this._id},getId:function(){return cc.log("getId is deprecated. Please use getID instead."),this._id},setTouchInfo:function(t,e,i){this._prevPoint=this._point,this._point=cc.p(e||0,i||0),this._id=t,this._startPointCaptured||(this._startPoint=cc.p(this._point),cc.view._convertPointWithScale(this._startPoint),this._startPointCaptured=!0)},_setPoint:function(t,e){void 0===e?(this._point.x=t.x,this._point.y=t.y):(this._point.x=t,this._point.y=e)},_setPrevPoint:function(t,e){this._prevPoint=void 0===e?cc.p(t.x,t.y):cc.p(t||0,e||0)}}),cc.Event=cc.Class.extend({_type:0,_isStopped:!1,_currentTarget:null,_setCurrentTarget:function(t){this._currentTarget=t},ctor:function(t){this._type=t},getType:function(){return this._type},stopPropagation:function(){this._isStopped=!0},isStopped:function(){return this._isStopped},getCurrentTarget:function(){return this._currentTarget}}),cc.Event.TOUCH=0,cc.Event.KEYBOARD=1,cc.Event.ACCELERATION=2,cc.Event.MOUSE=3,cc.Event.FOCUS=4,cc.Event.CUSTOM=6,cc.EventCustom=cc.Event.extend({_eventName:null,_userData:null,ctor:function(t){cc.Event.prototype.ctor.call(this,cc.Event.CUSTOM),this._eventName=t},setUserData:function(t){this._userData=t},getUserData:function(){return this._userData},getEventName:function(){return this._eventName}}),cc.EventMouse=cc.Event.extend({_eventType:0,_button:0,_x:0,_y:0,_prevX:0,_prevY:0,_scrollX:0,_scrollY:0,ctor:function(t){cc.Event.prototype.ctor.call(this,cc.Event.MOUSE),this._eventType=t},setScrollData:function(t,e){this._scrollX=t,this._scrollY=e},getScrollX:function(){return this._scrollX},getScrollY:function(){return this._scrollY},setLocation:function(t,e){this._x=t,this._y=e},getLocation:function(){return{x:this._x,y:this._y}},getLocationInView:function(){return{x:this._x,y:cc.view._designResolutionSize.height-this._y}},_setPrevCursor:function(t,e){this._prevX=t,this._prevY=e},getDelta:function(){return{x:this._x-this._prevX,y:this._y-this._prevY}},getDeltaX:function(){return this._x-this._prevX},getDeltaY:function(){return this._y-this._prevY},setButton:function(t){this._button=t},getButton:function(){return this._button},getLocationX:function(){return this._x},getLocationY:function(){return this._y}}),cc.EventMouse.NONE=0,cc.EventMouse.DOWN=1,cc.EventMouse.UP=2,cc.EventMouse.MOVE=3,cc.EventMouse.SCROLL=4,cc.EventMouse.BUTTON_LEFT=0,cc.EventMouse.BUTTON_RIGHT=2,cc.EventMouse.BUTTON_MIDDLE=1,cc.EventMouse.BUTTON_4=3,cc.EventMouse.BUTTON_5=4,cc.EventMouse.BUTTON_6=5,cc.EventMouse.BUTTON_7=6,cc.EventMouse.BUTTON_8=7,cc.EventTouch=cc.Event.extend({_eventCode:0,_touches:null,ctor:function(t){cc.Event.prototype.ctor.call(this,cc.Event.TOUCH),this._touches=t||[]},getEventCode:function(){return this._eventCode},getTouches:function(){return this._touches},_setEventCode:function(t){this._eventCode=t},_setTouches:function(t){this._touches=t}}),cc.EventTouch.MAX_TOUCHES=5,cc.EventTouch.EventCode={BEGAN:0,MOVED:1,ENDED:2,CANCELLED:3},cc.EventFocus=cc.Event.extend({_widgetGetFocus:null,_widgetLoseFocus:null,ctor:function(t,e){cc.Event.prototype.ctor.call(this,cc.Event.FOCUS),this._widgetGetFocus=e,this._widgetLoseFocus=t}}),cc.EventListener=cc.Class.extend({_onEvent:null,_type:0,_listenerID:null,_registered:!1,_fixedPriority:0,_node:null,_paused:!0,_isEnabled:!0,ctor:function(t,e,i){this._onEvent=i,this._type=t||0,this._listenerID=e||""},_setPaused:function(t){this._paused=t},_isPaused:function(){return this._paused},_setRegistered:function(t){this._registered=t},_isRegistered:function(){return this._registered},_getType:function(){return this._type},_getListenerID:function(){return this._listenerID},_setFixedPriority:function(t){this._fixedPriority=t},_getFixedPriority:function(){return this._fixedPriority},_setSceneGraphPriority:function(t){this._node=t},_getSceneGraphPriority:function(){return this._node},checkAvailable:function(){return null!==this._onEvent},clone:function(){return null},setEnabled:function(t){this._isEnabled=t},isEnabled:function(){return this._isEnabled},retain:function(){},release:function(){}}),cc.EventListener.UNKNOWN=0,cc.EventListener.TOUCH_ONE_BY_ONE=1,cc.EventListener.TOUCH_ALL_AT_ONCE=2,cc.EventListener.KEYBOARD=3,cc.EventListener.MOUSE=4,cc.EventListener.ACCELERATION=6,cc.EventListener.FOCUS=7,cc.EventListener.CUSTOM=8,cc._EventListenerCustom=cc.EventListener.extend({_onCustomEvent:null,ctor:function(t,e,i){this._onCustomEvent=e,this._target=i,cc.EventListener.prototype.ctor.call(this,cc.EventListener.CUSTOM,t,this._callback)},_callback:function(t){null!==this._onCustomEvent&&this._onCustomEvent.call(this._target,t)},checkAvailable:function(){return cc.EventListener.prototype.checkAvailable.call(this)&&null!==this._onCustomEvent},clone:function(){return new cc._EventListenerCustom(this._listenerID,this._onCustomEvent)}}),cc._EventListenerCustom.create=function(t,e){return new cc._EventListenerCustom(t,e)},cc._EventListenerMouse=cc.EventListener.extend({onMouseDown:null,onMouseUp:null,onMouseMove:null,onMouseScroll:null,ctor:function(){cc.EventListener.prototype.ctor.call(this,cc.EventListener.MOUSE,cc._EventListenerMouse.LISTENER_ID,this._callback)},_callback:function(t){var e=cc.EventMouse;switch(t._eventType){case e.DOWN:this.onMouseDown&&this.onMouseDown(t);break;case e.UP:this.onMouseUp&&this.onMouseUp(t);break;case e.MOVE:this.onMouseMove&&this.onMouseMove(t);break;case e.SCROLL:this.onMouseScroll&&this.onMouseScroll(t)}},clone:function(){var t=new cc._EventListenerMouse;return t.onMouseDown=this.onMouseDown,t.onMouseUp=this.onMouseUp,t.onMouseMove=this.onMouseMove,t.onMouseScroll=this.onMouseScroll,t},checkAvailable:function(){return!0}}),cc._EventListenerMouse.LISTENER_ID="__cc_mouse",cc._EventListenerMouse.create=function(){return new cc._EventListenerMouse},cc._EventListenerTouchOneByOne=cc.EventListener.extend({_claimedTouches:null,swallowTouches:!1,onTouchBegan:null,onTouchMoved:null,onTouchEnded:null,onTouchCancelled:null,ctor:function(){cc.EventListener.prototype.ctor.call(this,cc.EventListener.TOUCH_ONE_BY_ONE,cc._EventListenerTouchOneByOne.LISTENER_ID,null),this._claimedTouches=[]},setSwallowTouches:function(t){this.swallowTouches=t},isSwallowTouches:function(){return this.swallowTouches},clone:function(){var t=new cc._EventListenerTouchOneByOne;return t.onTouchBegan=this.onTouchBegan,t.onTouchMoved=this.onTouchMoved,t.onTouchEnded=this.onTouchEnded,t.onTouchCancelled=this.onTouchCancelled,t.swallowTouches=this.swallowTouches,t},checkAvailable:function(){return!!this.onTouchBegan||(cc.log(cc._LogInfos._EventListenerTouchOneByOne_checkAvailable),!1)}}),cc._EventListenerTouchOneByOne.LISTENER_ID="__cc_touch_one_by_one",cc._EventListenerTouchOneByOne.create=function(){return new cc._EventListenerTouchOneByOne},cc._EventListenerTouchAllAtOnce=cc.EventListener.extend({onTouchesBegan:null,onTouchesMoved:null,onTouchesEnded:null,onTouchesCancelled:null,ctor:function(){cc.EventListener.prototype.ctor.call(this,cc.EventListener.TOUCH_ALL_AT_ONCE,cc._EventListenerTouchAllAtOnce.LISTENER_ID,null)},clone:function(){var t=new cc._EventListenerTouchAllAtOnce;return t.onTouchesBegan=this.onTouchesBegan,t.onTouchesMoved=this.onTouchesMoved,t.onTouchesEnded=this.onTouchesEnded,t.onTouchesCancelled=this.onTouchesCancelled,t},checkAvailable:function(){return null!==this.onTouchesBegan||null!==this.onTouchesMoved||null!==this.onTouchesEnded||null!==this.onTouchesCancelled||(cc.log(cc._LogInfos._EventListenerTouchAllAtOnce_checkAvailable),!1)}}),cc._EventListenerTouchAllAtOnce.LISTENER_ID="__cc_touch_all_at_once",cc._EventListenerTouchAllAtOnce.create=function(){return new cc._EventListenerTouchAllAtOnce},cc.EventListener.create=function(t){cc.assert(t&&t.event,cc._LogInfos.EventListener_create);var e,i=t.event,n=(delete t.event,null);for(e in i===cc.EventListener.TOUCH_ONE_BY_ONE?n=new cc._EventListenerTouchOneByOne:i===cc.EventListener.TOUCH_ALL_AT_ONCE?n=new cc._EventListenerTouchAllAtOnce:i===cc.EventListener.MOUSE?n=new cc._EventListenerMouse:i===cc.EventListener.CUSTOM?(n=new cc._EventListenerCustom(t.eventName,t.callback),delete t.eventName,delete t.callback):i===cc.EventListener.KEYBOARD?n=new cc._EventListenerKeyboard:i===cc.EventListener.ACCELERATION?(n=new cc._EventListenerAcceleration(t.callback),delete t.callback):i===cc.EventListener.FOCUS&&(n=new cc._EventListenerFocus),t)n[e]=t[e];return n},cc._EventListenerFocus=cc.EventListener.extend({clone:function(){var t=new cc._EventListenerFocus;return t.onFocusChanged=this.onFocusChanged,t},checkAvailable:function(){return!!this.onFocusChanged||(cc.log("Invalid EventListenerFocus!"),!1)},onFocusChanged:null,ctor:function(){cc.EventListener.prototype.ctor.call(this,cc.EventListener.FOCUS,cc._EventListenerFocus.LISTENER_ID,this._callback)},_callback:function(t){this.onFocusChanged&&this.onFocusChanged(t._widgetLoseFocus,t._widgetGetFocus)}}),cc._EventListenerFocus.LISTENER_ID="__cc_focus_event",cc._EventListenerVector=cc.Class.extend({_fixedListeners:null,_sceneGraphListeners:null,gt0Index:0,ctor:function(){this._fixedListeners=[],this._sceneGraphListeners=[]},size:function(){return this._fixedListeners.length+this._sceneGraphListeners.length},empty:function(){return 0===this._fixedListeners.length&&0===this._sceneGraphListeners.length},push:function(t){(0===t._getFixedPriority()?this._sceneGraphListeners:this._fixedListeners).push(t)},clearSceneGraphListeners:function(){this._sceneGraphListeners.length=0},clearFixedListeners:function(){this._fixedListeners.length=0},clear:function(){this._sceneGraphListeners.length=0,this._fixedListeners.length=0},getFixedPriorityListeners:function(){return this._fixedListeners},getSceneGraphPriorityListeners:function(){return this._sceneGraphListeners}}),cc.eventManager={DIRTY_NONE:0,DIRTY_FIXED_PRIORITY:1,DIRTY_SCENE_GRAPH_PRIORITY:2,DIRTY_ALL:3,_listenersMap:{},_priorityDirtyFlagMap:{},_nodeListenersMap:{},_nodePriorityMap:{},_globalZOrderNodeMap:{},_toAddedListeners:[],_toRemovedListeners:[],_dirtyNodes:[],_inDispatch:0,_isEnabled:!1,_nodePriorityIndex:0,_internalCustomListenerIDs:[cc.game.EVENT_HIDE,cc.game.EVENT_SHOW],_setDirtyForNode:function(t){null!=this._nodeListenersMap[t.__instanceId]&&this._dirtyNodes.push(t);for(var e=0,i=(t=t.getChildren()).length;e<i;e++)this._setDirtyForNode(t[e])},pauseTarget:function(t,e){var i,n,s=this._nodeListenersMap[t.__instanceId];if(s)for(i=0,n=s.length;i<n;i++)s[i]._setPaused(!0);if(!0===e)for(i=0,n=(s=t.getChildren()).length;i<n;i++)this.pauseTarget(s[i],!0)},resumeTarget:function(t,e){var i,n,s=this._nodeListenersMap[t.__instanceId];if(s)for(i=0,n=s.length;i<n;i++)s[i]._setPaused(!1);if(this._setDirtyForNode(t),!0===e)for(i=0,n=(s=t.getChildren()).length;i<n;i++)this.resumeTarget(s[i],!0)},_addListener:function(t){0===this._inDispatch?this._forceAddEventListener(t):this._toAddedListeners.push(t)},_forceAddEventListener:function(t){var e=t._getListenerID(),i=this._listenersMap[e];i||(i=new cc._EventListenerVector,this._listenersMap[e]=i),i.push(t),0===t._getFixedPriority()?(this._setDirty(e,this.DIRTY_SCENE_GRAPH_PRIORITY),null===(e=t._getSceneGraphPriority())&&cc.log(cc._LogInfos.eventManager__forceAddEventListener),this._associateNodeAndEventListener(e,t),e.isRunning()&&this.resumeTarget(e)):this._setDirty(e,this.DIRTY_FIXED_PRIORITY)},_getListeners:function(t){return this._listenersMap[t]},_updateDirtyFlagForSceneGraph:function(){if(0!==this._dirtyNodes.length){for(var t,e,i=this._dirtyNodes,n=this._nodeListenersMap,s=0,r=i.length;s<r;s++)if(t=n[i[s].__instanceId])for(var o=0,a=t.length;o<a;o++)(e=t[o])&&this._setDirty(e._getListenerID(),this.DIRTY_SCENE_GRAPH_PRIORITY);this._dirtyNodes.length=0}},_removeAllListenersInVector:function(t){if(t)for(var e,i=0;i<t.length;)(e=t[i])._setRegistered(!1),null!=e._getSceneGraphPriority()&&(this._dissociateNodeAndEventListener(e._getSceneGraphPriority(),e),e._setSceneGraphPriority(null)),0===this._inDispatch?cc.arrayRemoveObject(t,e):++i},_removeListenersForListenerID:function(t){var e,i,n=this._listenersMap[t];for(n&&(e=n.getFixedPriorityListeners(),i=n.getSceneGraphPriorityListeners(),this._removeAllListenersInVector(i),this._removeAllListenersInVector(e),delete this._priorityDirtyFlagMap[t],this._inDispatch||n.clear(),delete this._listenersMap[t]),e=this._toAddedListeners,n=0;n<e.length;)(i=e[n])&&i._getListenerID()===t?cc.arrayRemoveObject(e,i):++n},_sortEventListeners:function(t){var e=this.DIRTY_NONE,i=this._priorityDirtyFlagMap;(e=i[t]?i[t]:e)!==this.DIRTY_NONE&&(i[t]=this.DIRTY_NONE,e&this.DIRTY_FIXED_PRIORITY&&this._sortListenersOfFixedPriority(t),e&this.DIRTY_SCENE_GRAPH_PRIORITY)&&((e=cc.director.getRunningScene())?this._sortListenersOfSceneGraphPriority(t,e):i[t]=this.DIRTY_SCENE_GRAPH_PRIORITY)},_sortListenersOfSceneGraphPriority:function(t,e){var i,t=this._getListeners(t);t&&(i=t.getSceneGraphPriorityListeners())&&0!==i.length&&(this._nodePriorityIndex=0,this._nodePriorityMap={},this._visitTarget(e,!0),t.getSceneGraphPriorityListeners().sort(this._sortEventListenersOfSceneGraphPriorityDes))},_sortEventListenersOfSceneGraphPriorityDes:function(t,e){var i=cc.eventManager._nodePriorityMap,n=t._getSceneGraphPriority(),s=e._getSceneGraphPriority();return e&&s&&i[s.__instanceId]?t&&n&&i[n.__instanceId]?i[e._getSceneGraphPriority().__instanceId]-i[t._getSceneGraphPriority().__instanceId]:1:-1},_sortListenersOfFixedPriority:function(t){if(t=this._listenersMap[t]){var e=t.getFixedPriorityListeners();if(e&&0!==e.length){e.sort(this._sortListenersOfFixedPriorityAsc);for(var i=0,n=e.length;i<n&&!(0<=e[i]._getFixedPriority());)++i;t.gt0Index=i}}},_sortListenersOfFixedPriorityAsc:function(t,e){return t._getFixedPriority()-e._getFixedPriority()},_onUpdateListeners:function(t){var e,i,n=t.getFixedPriorityListeners(),s=t.getSceneGraphPriorityListeners(),r=this._toRemovedListeners;if(s)for(e=0;e<s.length;)(i=s[e])._isRegistered()?++e:(cc.arrayRemoveObject(s,i),-1!==(i=r.indexOf(i))&&r.splice(i,1));if(n)for(e=0;e<n.length;)(i=n[e])._isRegistered()?++e:(cc.arrayRemoveObject(n,i),-1!==(i=r.indexOf(i))&&r.splice(i,1));s&&0===s.length&&t.clearSceneGraphListeners(),n&&0===n.length&&t.clearFixedListeners()},frameUpdateListeners:function(){var t,e=this._listenersMap,i=this._priorityDirtyFlagMap;for(t in e)e[t].empty()&&(delete i[t],delete e[t]);if(0!==(e=this._toAddedListeners).length){for(i=0,t=e.length;i<t;i++)this._forceAddEventListener(e[i]);e.length=0}0!==this._toRemovedListeners.length&&this._cleanToRemovedListeners()},_updateTouchListeners:function(t){if(t=this._inDispatch,cc.assert(0<t,cc._LogInfos.EventManager__updateListeners),!(1<t)){if((e=this._listenersMap[cc._EventListenerTouchOneByOne.LISTENER_ID])&&this._onUpdateListeners(e),(e=this._listenersMap[cc._EventListenerTouchAllAtOnce.LISTENER_ID])&&this._onUpdateListeners(e),cc.assert(1===t,cc._LogInfos.EventManager__updateListeners_2),0!==(t=this._toAddedListeners).length){for(var e=0,i=t.length;e<i;e++)this._forceAddEventListener(t[e]);t.length=0}0!==this._toRemovedListeners.length&&this._cleanToRemovedListeners()}},_cleanToRemovedListeners:function(){for(var t=this._toRemovedListeners,e=0;e<t.length;e++){var i,n,s=t[e],r=this._listenersMap[s._getListenerID()];r&&(i=r.getFixedPriorityListeners(),(n=r.getSceneGraphPriorityListeners())&&-1!==(r=n.indexOf(s))&&n.splice(r,1),i)&&-1!==(r=i.indexOf(s))&&i.splice(r,1)}t.length=0},_onTouchEventCallback:function(t,e){var i,n,s,r,o,a;return!(!t._isRegistered||(i=e.event,n=e.selTouch,i._setCurrentTarget(t._node),s=!1,(o=i.getEventCode())===(a=cc.EventTouch.EventCode).BEGAN?t.onTouchBegan&&(s=t.onTouchBegan(n,i))&&t._registered&&t._claimedTouches.push(n):0<t._claimedTouches.length&&-1!==(r=t._claimedTouches.indexOf(n))&&(s=!0,o===a.MOVED&&t.onTouchMoved?t.onTouchMoved(n,i):o===a.ENDED?(t.onTouchEnded&&t.onTouchEnded(n,i),t._registered&&t._claimedTouches.splice(r,1)):o===a.CANCELLED&&(t.onTouchCancelled&&t.onTouchCancelled(n,i),t._registered)&&t._claimedTouches.splice(r,1)),i.isStopped()?(cc.eventManager._updateTouchListeners(i),0):!(s&&t._registered&&t.swallowTouches)||(e.needsMutableSet&&e.touches.splice(n,1),0)))},_dispatchTouchEvent:function(t){this._sortEventListeners(cc._EventListenerTouchOneByOne.LISTENER_ID),this._sortEventListeners(cc._EventListenerTouchAllAtOnce.LISTENER_ID);var e=this._getListeners(cc._EventListenerTouchOneByOne.LISTENER_ID),i=this._getListeners(cc._EventListenerTouchAllAtOnce.LISTENER_ID);if(null!==e||null!==i){var n=t.getTouches(),s=cc.copyArray(n),r={event:t,needsMutableSet:e&&i,touches:s,selTouch:null};if(e)for(var o=0;o<n.length;o++)if(r.selTouch=n[o],this._dispatchEventToListeners(e,this._onTouchEventCallback,r),t.isStopped())return;i&&0<s.length&&(this._dispatchEventToListeners(i,this._onTouchesEventCallback,{event:t,touches:s}),t.isStopped())||this._updateTouchListeners(t)}},_onTouchesEventCallback:function(t,e){var i,n,s;return!!t._registered&&(i=cc.EventTouch.EventCode,n=e.event,e=e.touches,s=n.getEventCode(),n._setCurrentTarget(t._node),s===i.BEGAN&&t.onTouchesBegan?t.onTouchesBegan(e,n):s===i.MOVED&&t.onTouchesMoved?t.onTouchesMoved(e,n):s===i.ENDED&&t.onTouchesEnded?t.onTouchesEnded(e,n):s===i.CANCELLED&&t.onTouchesCancelled&&t.onTouchesCancelled(e,n),!!n.isStopped())&&(cc.eventManager._updateTouchListeners(n),!0)},_associateNodeAndEventListener:function(t,e){var i=this._nodeListenersMap[t.__instanceId];i||(this._nodeListenersMap[t.__instanceId]=i=[]),i.push(e)},_dissociateNodeAndEventListener:function(t,e){var i=this._nodeListenersMap[t.__instanceId];i&&(cc.arrayRemoveObject(i,e),0===i.length)&&delete this._nodeListenersMap[t.__instanceId]},_dispatchEventToListeners:function(t,e,i){var n,s=!1,r=t.getFixedPriorityListeners(),o=t.getSceneGraphPriorityListeners(),a=0;if(r&&0!==r.length)for(;a<t.gt0Index;++a)if((n=r[a]).isEnabled()&&!n._isPaused()&&n._isRegistered()&&e(n,i)){s=!0;break}if(o&&!s)for(t=0;t<o.length;t++)if((n=o[t]).isEnabled()&&!n._isPaused()&&n._isRegistered()&&e(n,i)){s=!0;break}if(r&&!s)for(;a<r.length&&(!(n=r[a]).isEnabled()||n._isPaused()||!n._isRegistered()||!e(n,i));++a);},_setDirty:function(t,e){var i=this._priorityDirtyFlagMap;i[t]=null==i[t]?e:e|i[t]},_visitTarget:function(t,e){var i,n=0,s=(c=t.getChildren()).length,r=this._globalZOrderNodeMap,o=this._nodeListenersMap;if(0<s){for(;n<s&&((i=c[n])&&i.getLocalZOrder()<0);n++)this._visitTarget(i,!1);for(null!=o[t.__instanceId]&&(r[t.getGlobalZOrder()]||(r[t.getGlobalZOrder()]=[]),r[t.getGlobalZOrder()].push(t.__instanceId));n<s;n++)(i=c[n])&&this._visitTarget(i,!1)}else null!=o[t.__instanceId]&&(r[t.getGlobalZOrder()]||(r[t.getGlobalZOrder()]=[]),r[t.getGlobalZOrder()].push(t.__instanceId));if(e){var a,c=[];for(a in r)c.push(a);for(c.sort(this._sortNumberAsc),a=c.length,i=this._nodePriorityMap,n=0;n<a;n++)for(s=r[c[n]],o=0;o<s.length;o++)i[s[o]]=++this._nodePriorityIndex;this._globalZOrderNodeMap={}}},_sortNumberAsc:function(t,e){return t-e},addListener:function(t,e){if(cc.assert(t&&e,cc._LogInfos.eventManager_addListener_2),t instanceof cc.EventListener){if(t._isRegistered())return void cc.log(cc._LogInfos.eventManager_addListener_4)}else cc.assert(!cc.isNumber(e),cc._LogInfos.eventManager_addListener_3),t=cc.EventListener.create(t);if(t.checkAvailable()){if(cc.isNumber(e)){if(0===e)return void cc.log(cc._LogInfos.eventManager_addListener);t._setSceneGraphPriority(null),t._setFixedPriority(e),t._setRegistered(!0),t._setPaused(!1)}else t._setSceneGraphPriority(e),t._setFixedPriority(0),t._setRegistered(!0);return this._addListener(t),t}},addCustomListener:function(t,e,i){return t=new cc._EventListenerCustom(t,e,i),this.addListener(t,1),t},removeListener:function(t){if(null!=t){var e,i=this._listenersMap;for(e in i){var n=i[e],s=n.getFixedPriorityListeners(),r=n.getSceneGraphPriorityListeners();if((r=this._removeListenerInVector(r,t))?this._setDirty(t._getListenerID(),this.DIRTY_SCENE_GRAPH_PRIORITY):(r=this._removeListenerInVector(s,t))&&this._setDirty(t._getListenerID(),this.DIRTY_FIXED_PRIORITY),n.empty()&&(delete this._priorityDirtyFlagMap[t._getListenerID()],delete i[e]),r)break}if(!r)for(e=0,n=(i=this._toAddedListeners).length;e<n;e++)if((s=i[e])===t){cc.arrayRemoveObject(i,s),s._setRegistered(!1);break}}},_removeListenerInCallback:function(t,e){if(null!=t)for(var i=0,n=t.length;i<n;i++){var s=t[i];if(s._onCustomEvent===e||s._onEvent===e)return s._setRegistered(!1),null!=s._getSceneGraphPriority()&&(this._dissociateNodeAndEventListener(s._getSceneGraphPriority(),s),s._setSceneGraphPriority(null)),0===this._inDispatch&&cc.arrayRemoveObject(t,s),!0}return!1},_removeListenerInVector:function(t,e){if(null!=t)for(var i=0,n=t.length;i<n;i++){var s=t[i];if(s===e)return s._setRegistered(!1),null!=s._getSceneGraphPriority()&&(this._dissociateNodeAndEventListener(s._getSceneGraphPriority(),s),s._setSceneGraphPriority(null)),0===this._inDispatch?cc.arrayRemoveObject(t,s):this._toRemovedListeners.push(s),!0}return!1},removeListeners:function(t,e){if(t instanceof cc.Node){if(delete this._nodePriorityMap[t.__instanceId],cc.arrayRemoveObject(this._dirtyNodes,t),n=this._nodeListenersMap[t.__instanceId]){for(var i=cc.copyArray(n),n=0;n<i.length;n++)this.removeListener(i[n]);i.length=0}for(i=this._toAddedListeners,n=0;n<i.length;){var s=i[n];s._getSceneGraphPriority()===t?(s._setSceneGraphPriority(null),s._setRegistered(!1),i.splice(n,1)):++n}if(!0===e)for(n=0,s=(i=t.getChildren()).length;n<s;n++)this.removeListeners(i[n],!0)}else t===cc.EventListener.TOUCH_ONE_BY_ONE?this._removeListenersForListenerID(cc._EventListenerTouchOneByOne.LISTENER_ID):t===cc.EventListener.TOUCH_ALL_AT_ONCE?this._removeListenersForListenerID(cc._EventListenerTouchAllAtOnce.LISTENER_ID):t===cc.EventListener.MOUSE?this._removeListenersForListenerID(cc._EventListenerMouse.LISTENER_ID):t===cc.EventListener.ACCELERATION?this._removeListenersForListenerID(cc._EventListenerAcceleration.LISTENER_ID):t===cc.EventListener.KEYBOARD?this._removeListenersForListenerID(cc._EventListenerKeyboard.LISTENER_ID):cc.log(cc._LogInfos.eventManager_removeListeners)},removeCustomListeners:function(t){this._removeListenersForListenerID(t)},removeAllListeners:function(){var t,e=this._listenersMap,i=this._internalCustomListenerIDs;for(t in e)-1===i.indexOf(t)&&this._removeListenersForListenerID(t)},setPriority:function(t,e){if(null!=t){var i,n=this._listenersMap;for(i in n){var s=n[i].getFixedPriorityListeners();if(s&&-1!==s.indexOf(t)){null!=t._getSceneGraphPriority()&&cc.log(cc._LogInfos.eventManager_setPriority),t._getFixedPriority()!==e&&(t._setFixedPriority(e),this._setDirty(t._getListenerID(),this.DIRTY_FIXED_PRIORITY));break}}}},setEnabled:function(t){this._isEnabled=t},isEnabled:function(){return this._isEnabled},dispatchEvent:function(t){if(this._isEnabled){if(this._updateDirtyFlagForSceneGraph(),this._inDispatch++,!t||!t.getType)throw Error("event is undefined");t._type===cc.Event.TOUCH?this._dispatchTouchEvent(t):(e=t,i=cc.Event,e=(n=e._type)===i.ACCELERATION?cc._EventListenerAcceleration.LISTENER_ID:n===i.CUSTOM?e._eventName:n===i.KEYBOARD?cc._EventListenerKeyboard.LISTENER_ID:n===i.MOUSE?cc._EventListenerMouse.LISTENER_ID:n===i.FOCUS?cc._EventListenerFocus.LISTENER_ID:(n===i.TOUCH&&cc.log(cc._LogInfos.__getListenerID),""),this._sortEventListeners(e),(e=this._listenersMap[e])&&(this._dispatchEventToListeners(e,this._onListenerCallback,t),this._onUpdateListeners(e))),this._inDispatch--}var e,i,n},_onListenerCallback:function(t,e){return e._setCurrentTarget(t._getSceneGraphPriority()),t._onEvent(e),e.isStopped()},dispatchCustomEvent:function(t,e){t=new cc.EventCustom(t);t.setUserData(e),this.dispatchEvent(t)}},cc.EventAcceleration=cc.Event.extend({_acc:null,ctor:function(t){cc.Event.prototype.ctor.call(this,cc.Event.ACCELERATION),this._acc=t}}),cc.EventKeyboard=cc.Event.extend({_keyCode:0,_isPressed:!1,ctor:function(t,e){cc.Event.prototype.ctor.call(this,cc.Event.KEYBOARD),this._keyCode=t,this._isPressed=e}}),cc._EventListenerAcceleration=cc.EventListener.extend({_onAccelerationEvent:null,ctor:function(t){this._onAccelerationEvent=t;var e=this;cc.EventListener.prototype.ctor.call(this,cc.EventListener.ACCELERATION,cc._EventListenerAcceleration.LISTENER_ID,function(t){e._onAccelerationEvent(t._acc,t)})},checkAvailable:function(){return cc.assert(this._onAccelerationEvent,cc._LogInfos._EventListenerAcceleration_checkAvailable),!0},clone:function(){return new cc._EventListenerAcceleration(this._onAccelerationEvent)}}),cc._EventListenerAcceleration.LISTENER_ID="__cc_acceleration",cc._EventListenerAcceleration.create=function(t){return new cc._EventListenerAcceleration(t)},cc._EventListenerKeyboard=cc.EventListener.extend({onKeyPressed:null,onKeyReleased:null,ctor:function(){var e=this;cc.EventListener.prototype.ctor.call(this,cc.EventListener.KEYBOARD,cc._EventListenerKeyboard.LISTENER_ID,function(t){t._isPressed?e.onKeyPressed&&e.onKeyPressed(t._keyCode,t):e.onKeyReleased&&e.onKeyReleased(t._keyCode,t)})},clone:function(){var t=new cc._EventListenerKeyboard;return t.onKeyPressed=this.onKeyPressed,t.onKeyReleased=this.onKeyReleased,t},checkAvailable:function(){return null!==this.onKeyPressed||null!==this.onKeyReleased||(cc.log(cc._LogInfos._EventListenerKeyboard_checkAvailable),!1)}}),cc._EventListenerKeyboard.LISTENER_ID="__cc_keyboard",cc._EventListenerKeyboard.create=function(){return new cc._EventListenerKeyboard},function(){function t(t,e){this.gl=t,this.vertexBuffer=t.createBuffer(),this.size=888,this.byteLength=e||3552*cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,this.data=new ArrayBuffer(this.byteLength),this.dataArray=new Float32Array(this.data),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,this.dataArray,t.DYNAMIC_DRAW),this._dirty=!1,this._spaces={0:this.byteLength}}return t.prototype={constructor:t,allocBuffer:function(t,e){var i=this._spaces[t];return!!(i&&e<=i)&&(delete this._spaces[t],e<i&&(this._spaces[t+e]=i-e),!0)},requestBuffer:function(t){var e,i,n;for(e in this._spaces)if(i=parseInt(e),n=this._spaces[e],t<=n&&this.allocBuffer(i,t))return i;return-1},freeBuffer:function(t,e){var i,n,s=this._spaces;for(n in s){if(t<(i=parseInt(n)))break;if(i+s[n]>=t){e=e+t-i,t=i;break}}this._spaces[s=t+e]&&(e+=this._spaces[s],delete this._spaces[s]),this._spaces[t]=e},setDirty:function(){this._dirty=!0},update:function(){this._dirty&&(this.gl.bindBuffer(gl.ARRAY_BUFFER,this.vertexBuffer),this.gl.bufferSubData(gl.ARRAY_BUFFER,0,this.dataArray),this._dirty=!1)},updateSubData:function(t,e){this.gl.bindBuffer(gl.ARRAY_BUFFER,this.vertexBuffer),this.gl.bufferSubData(gl.ARRAY_BUFFER,t,e)},destroy:function(){this.gl.deleteBuffer(this.vertexBuffer),this.vertexBuffer=this.texCoords=this.colors=this.positions=this.data=null}},t}()),Region=(cc.rendererCanvas={childrenOrderDirty:!0,assignedZ:0,assignedZStep:1e-4,_transformNodePool:[],_renderCmds:[],_isCacheToCanvasOn:!1,_cacheToCanvasCmds:{},_cacheInstanceIds:[],_currentID:0,_clearColor:cc.color(),_clearFillStyle:"rgb(0, 0, 0)",_dirtyRegion:null,_allNeedDraw:!0,_enableDirtyRegion:!1,_debugDirtyRegion:!1,_canUseDirtyRegion:!1,_dirtyRegionCountThreshold:10,getRenderCmd:function(t){return t._createRenderCmd()},enableDirtyRegion:function(t){this._enableDirtyRegion=t},isDirtyRegionEnabled:function(){return this._enableDirtyRegion},setDirtyRegionCountThreshold:function(t){this._dirtyRegionCountThreshold=t},_collectDirtyRegion:function(){for(var t=this._renderCmds,e=this._dirtyRegion,i=0,n=!0,s=cc.Node.CanvasRenderCmd.RegionStatus,r=0,o=t.length;r<o;r++){var a=t[r],c=a._oldRegion,h=a._currentRegion;a._regionFlag>s.NotDirty&&((n=++i>this._dirtyRegionCountThreshold?!1:n)&&(h.isEmpty()||e.addRegion(h),a._regionFlag>s.Dirty)&&!c.isEmpty()&&e.addRegion(c),a._regionFlag=s.NotDirty)}return n},_beginDrawDirtyRegion:function(t){var e=t.getContext(),i=this._dirtyRegion.getDirtyRegions();e.save(),t.setTransform({a:1,b:0,c:0,d:1,tx:0,ty:0},t._scaleX,t._scaleY),e.beginPath(),t=0;for(var n=i.length;t<n;++t){var s=i[t];e.rect(s._minX,-s._maxY,s._width,s._height)}e.clip()},_endDrawDirtyRegion:function(t){t.restore()},_debugDrawDirtyRegion:function(t){if(this._debugDirtyRegion){var e=t.getContext(),i=this._dirtyRegion.getDirtyRegions();t.setTransform({a:1,b:0,c:0,d:1,tx:0,ty:0},t._scaleX,t._scaleY),e.beginPath(),t=0;for(var n=i.length;t<n;++t){var s=i[t];e.rect(s._minX,-s._maxY,s._width,s._height)}i=e.fillStyle,e.fillStyle="green",e.fill(),e.fillStyle=i}},rendering:function(t){var e=this._dirtyRegion=this._dirtyRegion||new cc.DirtyRegion,i=cc._canvas,n=(t=t||cc._renderContext).getContext(),s=cc.view.getScaleX(),r=cc.view.getScaleY(),o=(t.setViewScale(s,r),t.computeRealOffsetY(),this._dirtyRegion.getDirtyRegions()),a=this._renderCmds,c=this._allNeedDraw||!this._enableDirtyRegion||!this._canUseDirtyRegion,h=!0;for(c||(h=this._collectDirtyRegion()),(c=c||!h)||this._beginDrawDirtyRegion(t),n.setTransform(1,0,0,1,0,0),n.clearRect(0,0,i.width,i.height),255===this._clearColor.r&&255===this._clearColor.g&&255===this._clearColor.b||(t.setFillStyle(this._clearFillStyle),t.setGlobalAlpha(this._clearColor.a),n.fillRect(0,0,i.width,i.height)),i=0,h=a.length;i<h;i++){var l=a[i],u=!1,d=l._currentRegion;if(!d||c)u=!0;else for(var _=0,p=o.length;_<p;++_)if(o[_].intersects(d)){u=!0;break}u&&l.rendering(t,s,r)}c||(this._debugDrawDirtyRegion(t),this._endDrawDirtyRegion(n)),e.clear(),this._allNeedDraw=!1},_renderingToCacheCanvas:function(t,e,i,n){t||cc.log("The context of RenderTexture is invalid."),i=cc.isUndefined(i)?1:i,n=cc.isUndefined(n)?1:n,e=e||this._currentID;var s,r,o=this._cacheToCanvasCmds[e];for(t.computeRealOffsetY(),s=0,r=o.length;s<r;s++)o[s].rendering(t,i,n);this._removeCache(e),0===(t=this._cacheInstanceIds).length?this._isCacheToCanvasOn=!1:this._currentID=t[t.length-1]},_turnToCacheMode:function(t){this._isCacheToCanvasOn=!0,this._cacheToCanvasCmds[t=t||0]=[],-1===this._cacheInstanceIds.indexOf(t)&&this._cacheInstanceIds.push(t),this._currentID=t},_turnToNormalMode:function(){this._isCacheToCanvasOn=!1},_removeCache:function(t){t=t||this._currentID;var e=this._cacheToCanvasCmds[t];e&&(e.length=0,delete this._cacheToCanvasCmds[t]),cc.arrayRemoveObject(this._cacheInstanceIds,t)},resetFlag:function(){this.childrenOrderDirty=!1,this._transformNodePool.length=0},transform:function(){var t=this._transformNodePool;t.sort(this._sortNodeByLevelAsc);for(var e=0,i=t.length;e<i;e++)0!==t[e]._dirtyFlag&&t[e].updateStatus();t.length=0},transformDirty:function(){return 0<this._transformNodePool.length},_sortNodeByLevelAsc:function(t,e){return t._curLevel-e._curLevel},pushDirtyNode:function(t){this._transformNodePool.push(t)},clear:function(){},clearRenderCommands:function(){this._renderCmds.length=0,this._cacheInstanceIds.length=0,this._isCacheToCanvasOn=!1,this._canUseDirtyRegion=this._allNeedDraw=!0},pushRenderCommand:function(t){var e;t.needDraw()&&(t._canUseDirtyRegion||(this._canUseDirtyRegion=!1),this._isCacheToCanvasOn?-1===(e=this._cacheToCanvasCmds[this._currentID]).indexOf(t)&&e.push(t):-1===this._renderCmds.indexOf(t)&&this._renderCmds.push(t))}},!function(){cc.CanvasContextWrapper=function(t){this._context=t,this._saveCount=0,this._currentAlpha=t.globalAlpha,this._currentCompositeOperation=t.globalCompositeOperation,this._currentFillStyle=t.fillStyle,this._currentStrokeStyle=t.strokeStyle,this._offsetY=this._offsetX=0,this._realOffsetY=this.height,this._armatureMode=0};var t=cc.CanvasContextWrapper.prototype;t.resetCache=function(){var t=this._context;this._currentAlpha=t.globalAlpha,this._currentCompositeOperation=t.globalCompositeOperation,this._currentFillStyle=t.fillStyle,this._currentStrokeStyle=t.strokeStyle,this._realOffsetY=this._context.canvas.height+this._offsetY},t.setOffset=function(t,e){this._offsetX=t,this._offsetY=e,this._realOffsetY=this._context.canvas.height+this._offsetY},t.computeRealOffsetY=function(){this._realOffsetY=this._context.canvas.height+this._offsetY},t.setViewScale=function(t,e){this._scaleX=t,this._scaleY=e},t.getContext=function(){return this._context},t.save=function(){this._context.save(),this._saveCount++},t.restore=function(){this._context.restore(),this._saveCount--},t.setGlobalAlpha=function(t){0<this._saveCount?this._context.globalAlpha=t:this._currentAlpha!==t&&(this._currentAlpha=t,this._context.globalAlpha=t)},t.setCompositeOperation=function(t){0<this._saveCount?this._context.globalCompositeOperation=t:this._currentCompositeOperation!==t&&(this._currentCompositeOperation=t,this._context.globalCompositeOperation=t)},t.setFillStyle=function(t){0<this._saveCount?this._context.fillStyle=t:this._currentFillStyle!==t&&(this._currentFillStyle=t,this._context.fillStyle=t)},t.setStrokeStyle=function(t){0<this._saveCount?this._context.strokeStyle=t:this._currentStrokeStyle!==t&&(this._currentStrokeStyle=t,this._context.strokeStyle=t)},t.setTransform=function(t,e,i){0<this._armatureMode?(this.restore(),this.save(),this._context.transform(t.a*e,-t.b*i,-t.c*e,t.d*i,t.tx*e,-t.ty*i)):this._context.setTransform(t.a*e,-t.b*i,-t.c*e,t.d*i,this._offsetX+t.tx*e,this._realOffsetY-t.ty*i)},t._switchToArmatureMode=function(t,e,i,n){t?(this._armatureMode++,this._context.setTransform(e.a,e.c,e.b,e.d,this._offsetX+e.tx*i,this._realOffsetY-e.ty*n),this.save()):(this._armatureMode--,this.restore())}}(),cc.rendererWebGL=function(){var r,a={texture:null,blendSrc:null,blendDst:null,glProgramState:null},o=!1,c=null,h=null,l=0,u=0,s=0,d=null,_=null,p=null,f=0,g=!0,m={QUAD:0,TRIANGLE:1,CUSTOM:2};return{mat4Identity:null,childrenOrderDirty:!0,assignedZ:0,assignedZStep:.01,VertexType:m,_transformNodePool:[],_renderCmds:[],_isCacheToBufferOn:!1,_cacheToBufferCmds:{},_cacheInstanceIds:[],_currentID:0,_clearColor:cc.color(0,0,0,255),init:function(){(t=cc._renderContext).disable(t.CULL_FACE),t.disable(t.DEPTH_TEST),this.mat4Identity=new cc.math.Matrix4,this.mat4Identity.identity();var t=cc.BATCH_VERTEX_COUNT,e=cc._renderContext;if(null===c&&(h=e.createBuffer(),c=e.createBuffer()),e=cc._renderContext,c){var i=6*Math.ceil(t/4);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,c),p=new Uint16Array(i);for(var n=0,s=0;s<i;s+=6)p[s]=n+0,p[s+1]=n+1,p[s+2]=n+2,p[s+3]=n+1,p[s+4]=n+2,p[s+5]=n+3,n+=4;e.bufferData(e.ELEMENT_ARRAY_BUFFER,p,e.DYNAMIC_DRAW)}h&&(r=new ArrayBuffer(4*(6*t)),d=new Float32Array(r),_=new Uint32Array(r),e.bindBuffer(e.ARRAY_BUFFER,h),e.bufferData(e.ARRAY_BUFFER,d,e.DYNAMIC_DRAW)),l=t-200},getVertexSize:function(){return l},getRenderCmd:function(t){return t._createRenderCmd()},_turnToCacheMode:function(t){this._isCacheToBufferOn=!0,this._cacheToBufferCmds[t=t||0]?this._cacheToBufferCmds[t].length=0:this._cacheToBufferCmds[t]=[],-1===this._cacheInstanceIds.indexOf(t)&&this._cacheInstanceIds.push(t),this._currentID=t},_turnToNormalMode:function(){this._isCacheToBufferOn=!1},_removeCache:function(t){t=t||this._currentID;var e=this._cacheToBufferCmds[t];e&&(e.length=0,delete this._cacheToBufferCmds[t]),cc.arrayRemoveObject(this._cacheInstanceIds,t)},_renderingToBuffer:function(t){t=t||this._currentID,this.rendering(cc._renderContext,this._cacheToBufferCmds[t]),this._removeCache(t),0===(t=this._cacheInstanceIds).length?this._isCacheToBufferOn=!1:this._currentID=t[t.length-1]},resetFlag:function(){this.childrenOrderDirty&&(this.childrenOrderDirty=!1),this._transformNodePool.length=0},transform:function(){var t,e,i=this._transformNodePool;for(i.sort(this._sortNodeByLevelAsc),t=0,e=i.length;t<e;t++)i[t].updateStatus();i.length=0},transformDirty:function(){return 0<this._transformNodePool.length},_sortNodeByLevelAsc:function(t,e){return t._curLevel-e._curLevel},pushDirtyNode:function(t){this._transformNodePool.push(t)},clearRenderCommands:function(){this._renderCmds.length=0},clear:function(){var t=cc._renderContext;t.clearColor(this._clearColor.r/255,this._clearColor.g/255,this._clearColor.b/255,this._clearColor.a/255),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT)},setDepthTest:function(t){var e=cc._renderContext;t?(e.clearDepth(1),e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL)):e.disable(e.DEPTH_TEST)},pushRenderCommand:function(t){var e;(t.rendering||t.uploadData)&&(this._isCacheToBufferOn?-1===(e=this._cacheToBufferCmds[this._currentID]).indexOf(t)&&e.push(t):-1===this._renderCmds.indexOf(t)&&this._renderCmds.push(t))},_increaseBatchingSize:function(t,e,i){switch(e=e||m.QUAD){case m.QUAD:for(e=0;e<t;e+=4)i=u+e,p[s++]=i+0,p[s++]=i+1,p[s++]=i+2,p[s++]=i+1,p[s++]=i+2,p[s++]=i+3;break;case m.TRIANGLE:for(g=!1,e=0;e<t;e+=3)i=u+e,p[s++]=i+0,p[s++]=i+1,p[s++]=i+2;break;case m.CUSTOM:g=!1;var n=i.length;for(e=0;e<n;e++)p[s++]=u+i[e];break;default:return}u+=t},_updateBatchedInfo:function(t,e,i){return(t!==a.texture||e.src!==a.blendSrc||e.dst!==a.blendDst||i!==a.glProgramState)&&(this._batchRendering(),a.texture=t,a.blendSrc=e.src,a.blendDst=e.dst,a.glProgramState=i,!0)},_breakBatch:function(){o=!0},_uploadBufferData:function(t){l<=u&&this._batchRendering();var e=(n=t._node)._texture||n._spriteFrame&&n._spriteFrame._texture,i=n._blendFunc.src,n=n._blendFunc.dst,s=t._glProgramState;!o&&a.texture===e&&a.blendSrc===i&&a.blendDst===n&&a.glProgramState===s||(this._batchRendering(),a.texture=e,a.blendSrc=i,a.blendDst=n,a.glProgramState=s,o=!1),0<(e=t.uploadData(d,_,6*u))&&this._increaseBatchingSize(e,t.vertexType)},_batchRendering:function(){var t,e,i,n;0!==u&&a.texture&&(t=cc._renderContext,e=a.texture,n=.5*l<u,(i=a.glProgramState)&&(i.apply(),i.getGLProgram()._updateProjectionUniform()),cc.glBlendFunc(a.blendSrc,a.blendDst),cc.glBindTexture2DN(0,e),t.bindBuffer(t.ARRAY_BUFFER,h),n?t.bufferData(t.ARRAY_BUFFER,d,t.DYNAMIC_DRAW):(e=d.subarray(0,6*u),t.bufferData(t.ARRAY_BUFFER,e,t.DYNAMIC_DRAW)),t.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),t.enableVertexAttribArray(cc.VERTEX_ATTRIB_COLOR),t.enableVertexAttribArray(cc.VERTEX_ATTRIB_TEX_COORDS),t.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,3,t.FLOAT,!1,24,0),t.vertexAttribPointer(cc.VERTEX_ATTRIB_COLOR,4,t.UNSIGNED_BYTE,!0,24,12),t.vertexAttribPointer(cc.VERTEX_ATTRIB_TEX_COORDS,2,t.FLOAT,!1,24,16),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,c),f&&g&&!(f<s)||(n?t.bufferData(t.ELEMENT_ARRAY_BUFFER,p,t.DYNAMIC_DRAW):t.bufferData(t.ELEMENT_ARRAY_BUFFER,p.subarray(0,s),t.DYNAMIC_DRAW)),t.drawElements(t.TRIANGLES,s,t.UNSIGNED_SHORT,0),cc.g_NumberOfDraws++,g?f=s:g=!(f=0),s=u=0)},rendering:function(t,e){var i,n,s,r=e||this._renderCmds,o=t||cc._renderContext;for(o.bindBuffer(gl.ARRAY_BUFFER,null),i=0,n=r.length;i<n;++i)(s=r[i]).needDraw()&&(s.uploadData?this._uploadBufferData(s):(0<u&&this._batchRendering(),s.rendering(o)));this._batchRendering(),a.texture=null}}}(),function(){this._area=this._height=this._width=this._maxY=this._maxX=this._minY=this._minX=0}),regionProto=Region.prototype,regionPool=[];function regionCreate(){return regionPool.pop()||new Region}function regionRelease(t){regionPool.push(t)}function unionArea(t,e){return((t._maxX>e._maxX?t:e)._maxX-(t._minX<e._minX?t:e)._minX)*((t._maxY>e._maxY?t:e)._maxY-(t._minY<e._minY?t:e)._minY)}regionProto.setTo=function(t,e,i,n){return this._minX=t,this._minY=e,this._maxX=i,this._maxY=n,this.updateArea(),this},regionProto.intValues=function(){this._minX=Math.floor(this._minX),this._minY=Math.floor(this._minY),this._maxX=Math.ceil(this._maxX),this._maxY=Math.ceil(this._maxY),this.updateArea()},regionProto.updateArea=function(){this._width=this._maxX-this._minX,this._height=this._maxY-this._minY,this._area=this._width*this._height},regionProto.union=function(t){this._width<=0||this._height<=0?this.setTo(t._minX,t._minY,t._maxX,t._maxY):(this._minX>t._minX&&(this._minX=t._minX),this._minY>t._minY&&(this._minY=t._minY),this._maxX<t._maxX&&(this._maxX=t._maxX),this._maxY<t._maxY&&(this._maxY=t._maxY),this.updateArea())},regionProto.setEmpty=function(){this._area=this._height=this._width=this._maxY=this._maxX=this._minY=this._minX=0},regionProto.isEmpty=function(){return this._width<=0||this._height<=0},regionProto.intersects=function(t){var e;return!(this._width<=0||this._height<=0||t._width<=0||t._height<=0||(e=(this._minX>t._minX?this:t)._minX,(this._maxX<t._maxX?this:t)._maxX<e))&&(e=(this._minY>t._minY?this:t)._minY)<=(this._maxY<t._maxY?this:t)._maxY},regionProto.updateRegion=function(t,e){var i,n,s,r,o,a,c,h,l,u,d,_;0==t.width||0==t.height?this.setEmpty():(i=e.a,n=e.b,s=e.c,r=e.d,_=e.tx,e=e.ty,o=t.x,l=t.y,d=o+t.width,t=l+t.height,l=1==i&&0==n&&0==s&&1==r?(a=o+_-1,c=l+e-1,h=d+_+1,t+e+1):(a=i*o+s*l+_,c=n*o+r*l+e,h=i*d+s*l+_,l=n*d+r*l+e,u=i*d+s*t+_,d=n*d+r*t+e,_=i*o+s*t+_,e=n*o+r*t+e,t=0,h<a&&(t=a,a=h,h=t),_<u&&(t=u,u=_,_=t),a=(a<u?a:u)-1,h=(_<h?h:_)+1,l<c&&(t=c,c=l,l=t),e<d&&(t=d,d=e,e=t),c=(c<d?c:d)-1,(e<l?l:e)+1),this._minX=a,this._minY=c,this._maxX=h,this._maxY=l,this._width=h-a,this._height=l-c,this._area=this._width*this._height)};var DirtyRegion=function(){this.dirtyList=[],this.hasClipRect=!1,this.clipArea=this.clipHeight=this.clipWidth=0,this.clipRectChanged=!1},dirtyRegionProto=DirtyRegion.prototype,dirtyFlags=(dirtyRegionProto.setClipRect=function(t,e){this.clipRectChanged=this.hasClipRect=!0,this.clipWidth=Math.ceil(t),this.clipHeight=Math.ceil(e),this.clipArea=this.clipWidth*this.clipHeight},dirtyRegionProto.addRegion=function(t){var e,i,n=t._minX,s=t._minY,r=t._maxX;return t=t._maxY,this.hasClipRect&&(n<0&&(n=0),s<0&&(s=0),r>this.clipWidth&&(r=this.clipWidth),t>this.clipHeight)&&(t=this.clipHeight),!(r<=n||t<=s||(this.clipRectChanged||(e=this.dirtyList,i=regionCreate(),e.push(i.setTo(n,s,r,t)),this.mergeDirtyList(e)),0))},dirtyRegionProto.clear=function(){for(var t=this.dirtyList,e=t.length,i=0;i<e;i++)regionRelease(t[i]);t.length=0},dirtyRegionProto.getDirtyRegions=function(){var t=this.dirtyList;if(this.clipRectChanged){this.clipRectChanged=!1,this.clear();var e=regionCreate();t.push(e.setTo(0,0,this.clipWidth,this.clipHeight))}else for(;this.mergeDirtyList(t););if(0<(t=this.dirtyList.length))for(e=0;e<t;e++)this.dirtyList[e].intValues();return this.dirtyList},dirtyRegionProto.mergeDirtyList=function(t){var e=t.length;if(e<2)return!1;for(var i=this.hasClipRect,n=3<e?Number.POSITIVE_INFINITY:0,s=0,r=0,o=0,a=0;a<e-1;a++){var c=t[a];i&&(o+=c.area);for(var h=a+1;h<e;h++){var l=t[h];(l=unionArea(c,l)-c.area-l.area)<n&&(s=a,r=h,n=l)}}return i&&.95<o/this.clipArea&&(this.clipRectChanged=!0),s!=r&&(e=t[r],t[s].union(e),regionRelease(e),t.splice(r,1),!0)},cc.Region=Region,cc.DirtyRegion=DirtyRegion,cc._tmp.PrototypeCCNode=function(){var t=cc.Node.prototype;cc.defineGetterSetter(t,"x",t.getPositionX,t.setPositionX),cc.defineGetterSetter(t,"y",t.getPositionY,t.setPositionY),cc.defineGetterSetter(t,"width",t._getWidth,t._setWidth),cc.defineGetterSetter(t,"height",t._getHeight,t._setHeight),cc.defineGetterSetter(t,"anchorX",t._getAnchorX,t._setAnchorX),cc.defineGetterSetter(t,"anchorY",t._getAnchorY,t._setAnchorY),cc.defineGetterSetter(t,"skewX",t.getSkewX,t.setSkewX),cc.defineGetterSetter(t,"skewY",t.getSkewY,t.setSkewY),cc.defineGetterSetter(t,"zIndex",t.getLocalZOrder,t.setLocalZOrder),cc.defineGetterSetter(t,"vertexZ",t.getVertexZ,t.setVertexZ),cc.defineGetterSetter(t,"rotation",t.getRotation,t.setRotation),cc.defineGetterSetter(t,"rotationX",t.getRotationX,t.setRotationX),cc.defineGetterSetter(t,"rotationY",t.getRotationY,t.setRotationY),cc.defineGetterSetter(t,"scale",t.getScale,t.setScale),cc.defineGetterSetter(t,"scaleX",t.getScaleX,t.setScaleX),cc.defineGetterSetter(t,"scaleY",t.getScaleY,t.setScaleY),cc.defineGetterSetter(t,"children",t.getChildren),cc.defineGetterSetter(t,"childrenCount",t.getChildrenCount),cc.defineGetterSetter(t,"parent",t.getParent,t.setParent),cc.defineGetterSetter(t,"visible",t.isVisible,t.setVisible),cc.defineGetterSetter(t,"running",t.isRunning),cc.defineGetterSetter(t,"ignoreAnchor",t.isIgnoreAnchorPointForPosition,t.ignoreAnchorPointForPosition),cc.defineGetterSetter(t,"actionManager",t.getActionManager,t.setActionManager),cc.defineGetterSetter(t,"scheduler",t.getScheduler,t.setScheduler),cc.defineGetterSetter(t,"shaderProgram",t.getShaderProgram,t.setShaderProgram),cc.defineGetterSetter(t,"opacity",t.getOpacity,t.setOpacity),cc.defineGetterSetter(t,"opacityModifyRGB",t.isOpacityModifyRGB),cc.defineGetterSetter(t,"cascadeOpacity",t.isCascadeOpacityEnabled,t.setCascadeOpacityEnabled),cc.defineGetterSetter(t,"color",t.getColor,t.setColor),cc.defineGetterSetter(t,"cascadeColor",t.isCascadeColorEnabled,t.setCascadeColorEnabled)},cc.NODE_TAG_INVALID=-1,cc.s_globalOrderOfArrival=1,cc.Node=cc.Class.extend({_localZOrder:0,_globalZOrder:0,_vertexZ:0,_customZ:NaN,_rotationX:0,_rotationY:0,_scaleX:1,_scaleY:1,_position:null,_normalizedPosition:null,_usingNormalizedPosition:!1,_normalizedPositionDirty:!1,_skewX:0,_skewY:0,_children:null,_visible:!0,_anchorPoint:null,_contentSize:null,_running:!1,_parent:null,_ignoreAnchorPointForPosition:!1,tag:cc.NODE_TAG_INVALID,userData:null,userObject:null,_reorderChildDirty:!1,arrivalOrder:0,_actionManager:null,_scheduler:null,_additionalTransformDirty:!1,_additionalTransform:null,_componentContainer:null,_isTransitionFinished:!1,_className:"Node",_showNode:!1,_name:"",_realOpacity:255,_realColor:null,_cascadeColorEnabled:!1,_cascadeOpacityEnabled:!1,_renderCmd:null,ctor:function(){this._anchorPoint=cc.p(0,0),this._contentSize=cc.size(0,0),this._position=cc.p(0,0),this._normalizedPosition=cc.p(0,0),this._children=[],this._additionalTransform=cc.affineTransformMakeIdentity(),cc.ComponentContainer&&(this._componentContainer=new cc.ComponentContainer(this)),this._realColor=cc.color(255,255,255,255),this._renderCmd=this._createRenderCmd()},init:function(){return!0},attr:function(t){for(var e in t)this[e]=t[e]},getSkewX:function(){return this._skewX},setSkewX:function(t){this._skewX=t,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getSkewY:function(){return this._skewY},setSkewY:function(t){this._skewY=t,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},setLocalZOrder:function(t){t!==this._localZOrder&&(this._parent?this._parent.reorderChild(this,t):this._localZOrder=t,cc.eventManager._setDirtyForNode(this))},_setLocalZOrder:function(t){this._localZOrder=t},getLocalZOrder:function(){return this._localZOrder},getZOrder:function(){return cc.log(cc._LogInfos.Node_getZOrder),this.getLocalZOrder()},setZOrder:function(t){cc.log(cc._LogInfos.Node_setZOrder),this.setLocalZOrder(t)},setGlobalZOrder:function(t){this._globalZOrder!==t&&(this._globalZOrder=t,cc.eventManager._setDirtyForNode(this))},getGlobalZOrder:function(){return this._globalZOrder},getVertexZ:function(){return this._vertexZ},setVertexZ:function(t){this._customZ=this._vertexZ=t},getRotation:function(){return this._rotationX!==this._rotationY&&cc.log(cc._LogInfos.Node_getRotation),this._rotationX},setRotation:function(t){this._rotationX=this._rotationY=t,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getRotationX:function(){return this._rotationX},setRotationX:function(t){this._rotationX=t,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getRotationY:function(){return this._rotationY},setRotationY:function(t){this._rotationY=t,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getScale:function(){return this._scaleX!==this._scaleY&&cc.log(cc._LogInfos.Node_getScale),this._scaleX},setScale:function(t,e){this._scaleX=t,this._scaleY=e||0===e?e:t,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getScaleX:function(){return this._scaleX},setScaleX:function(t){this._scaleX=t,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getScaleY:function(){return this._scaleY},setScaleY:function(t){this._scaleY=t,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},setPosition:function(t,e){var i=this._position;if(void 0===e){if(i.x===t.x&&i.y===t.y)return;i.x=t.x,i.y=t.y}else{if(i.x===t&&i.y===e)return;i.x=t,i.y=e}this._usingNormalizedPosition=!1,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},setNormalizedPosition:function(t,e){var i=this._normalizedPosition;void 0===e?(i.x=t.x,i.y=t.y):(i.x=t,i.y=e),this._normalizedPositionDirty=this._usingNormalizedPosition=!0,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getPosition:function(){return cc.p(this._position)},getNormalizedPosition:function(){return cc.p(this._normalizedPosition)},getPositionX:function(){return this._position.x},setPositionX:function(t){this._position.x=t,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getPositionY:function(){return this._position.y},setPositionY:function(t){this._position.y=t,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getChildrenCount:function(){return this._children.length},getChildren:function(){return this._children},isVisible:function(){return this._visible},setVisible:function(t){this._visible!==t&&(this._visible=t,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty),cc.renderer.childrenOrderDirty=!0)},getAnchorPoint:function(){return cc.p(this._anchorPoint)},setAnchorPoint:function(t,e){var i=this._anchorPoint;if(void 0===e){if(t.x===i.x&&t.y===i.y)return;i.x=t.x,i.y=t.y}else{if(t===i.x&&e===i.y)return;i.x=t,i.y=e}this._renderCmd._updateAnchorPointInPoint()},_getAnchorX:function(){return this._anchorPoint.x},_setAnchorX:function(t){this._anchorPoint.x!==t&&(this._anchorPoint.x=t,this._renderCmd._updateAnchorPointInPoint())},_getAnchorY:function(){return this._anchorPoint.y},_setAnchorY:function(t){this._anchorPoint.y!==t&&(this._anchorPoint.y=t,this._renderCmd._updateAnchorPointInPoint())},getAnchorPointInPoints:function(){return this._renderCmd.getAnchorPointInPoints()},_getWidth:function(){return this._contentSize.width},_setWidth:function(t){this._contentSize.width=t,this._renderCmd._updateAnchorPointInPoint()},_getHeight:function(){return this._contentSize.height},_setHeight:function(t){this._contentSize.height=t,this._renderCmd._updateAnchorPointInPoint()},getContentSize:function(){return cc.size(this._contentSize)},setContentSize:function(t,e){var i=this._contentSize;if(void 0===e){if(t.width===i.width&&t.height===i.height)return;i.width=t.width,i.height=t.height}else{if(t===i.width&&e===i.height)return;i.width=t,i.height=e}this._renderCmd._updateAnchorPointInPoint()},isRunning:function(){return this._running},getParent:function(){return this._parent},setParent:function(t){this._parent=t,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},isIgnoreAnchorPointForPosition:function(){return this._ignoreAnchorPointForPosition},ignoreAnchorPointForPosition:function(t){t!==this._ignoreAnchorPointForPosition&&(this._ignoreAnchorPointForPosition=t,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty))},getTag:function(){return this.tag},setTag:function(t){this.tag=t},setName:function(t){this._name=t},getName:function(){return this._name},getUserData:function(){return this.userData},setUserData:function(t){this.userData=t},getUserObject:function(){return this.userObject},setUserObject:function(t){this.userObject!==t&&(this.userObject=t)},getOrderOfArrival:function(){return this.arrivalOrder},setOrderOfArrival:function(t){this.arrivalOrder=t},getActionManager:function(){return this._actionManager||cc.director.getActionManager()},setActionManager:function(t){this._actionManager!==t&&(this.stopAllActions(),this._actionManager=t)},getScheduler:function(){return this._scheduler||cc.director.getScheduler()},setScheduler:function(t){this._scheduler!==t&&(this.unscheduleAllCallbacks(),this._scheduler=t)},boundingBox:function(){return cc.log(cc._LogInfos.Node_boundingBox),this.getBoundingBox()},getBoundingBox:function(){var t=cc.rect(0,0,this._contentSize.width,this._contentSize.height);return cc._rectApplyAffineTransformIn(t,this.getNodeToParentTransform())},cleanup:function(){this.stopAllActions(),this.unscheduleAllCallbacks(),cc.eventManager.removeListeners(this)},getChildByTag:function(t){var e=this._children;if(null!==e)for(var i=0;i<e.length;i++){var n=e[i];if(n&&n.tag===t)return n}return null},getChildByName:function(t){if(t){for(var e=this._children,i=0,n=e.length;i<n;i++)if(e[i]._name===t)return e[i]}else cc.log("Invalid name");return null},addChild:function(t,e,i){e=void 0===e?t._localZOrder:e;var n,s=!1;void 0===i?n=t._name:"string"==typeof i?(n=i,i=void 0):"number"==typeof i&&(s=!0,n=""),cc.assert(t,cc._LogInfos.Node_addChild_3),cc.assert(null===t._parent,"child already added. It can't be added again"),this._addChildHelper(t,e,i,n,s)},_addChildHelper:function(t,e,i,n,s){this._children||(this._children=[]),this._insertChild(t,e),s?t.setTag(i):t.setName(n),t.setParent(this),t.setOrderOfArrival(cc.s_globalOrderOfArrival++),this._running&&(t._performRecursive(cc.Node._stateCallbackType.onEnter),this._isTransitionFinished)&&t._performRecursive(cc.Node._stateCallbackType.onEnterTransitionDidFinish),t._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty),this._cascadeColorEnabled&&t._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty),this._cascadeOpacityEnabled&&t._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.opacityDirty)},removeFromParent:function(t){this._parent&&this._parent.removeChild(this,t=void 0===t?!0:t)},removeFromParentAndCleanup:function(t){cc.log(cc._LogInfos.Node_removeFromParentAndCleanup),this.removeFromParent(t)},removeChild:function(t,e){0!==this._children.length&&(void 0===e&&(e=!0),-1<this._children.indexOf(t)&&this._detachChild(t,e),cc.renderer.childrenOrderDirty=!0)},removeChildByTag:function(t,e){t===cc.NODE_TAG_INVALID&&cc.log(cc._LogInfos.Node_removeChildByTag);var i=this.getChildByTag(t);i?this.removeChild(i,e):cc.log(cc._LogInfos.Node_removeChildByTag_2,t)},removeAllChildrenWithCleanup:function(t){this.removeAllChildren(t)},removeAllChildren:function(t){var e=this._children;if(null!==e){void 0===t&&(t=!0);for(var i=0;i<e.length;i++){var n=e[i];n&&(this._running&&(n._performRecursive(cc.Node._stateCallbackType.onExitTransitionDidStart),n._performRecursive(cc.Node._stateCallbackType.onExit)),t&&n._performRecursive(cc.Node._stateCallbackType.cleanup),n.parent=null,n._renderCmd.detachFromParent())}this._children.length=0,cc.renderer.childrenOrderDirty=!0}},_detachChild:function(t,e){this._running&&(t._performRecursive(cc.Node._stateCallbackType.onExitTransitionDidStart),t._performRecursive(cc.Node._stateCallbackType.onExit)),e&&t._performRecursive(cc.Node._stateCallbackType.cleanup),t.parent=null,t._renderCmd.detachFromParent(),cc.arrayRemoveObject(this._children,t)},_insertChild:function(t,e){cc.renderer.childrenOrderDirty=this._reorderChildDirty=!0,this._children.push(t),t._setLocalZOrder(e)},setNodeDirty:function(){this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},reorderChild:function(t,e){cc.assert(t,cc._LogInfos.Node_reorderChild),-1===this._children.indexOf(t)?cc.log(cc._LogInfos.Node_reorderChild_2):(cc.renderer.childrenOrderDirty=this._reorderChildDirty=!0,t.arrivalOrder=cc.s_globalOrderOfArrival,cc.s_globalOrderOfArrival++,t._setLocalZOrder(e),this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.orderDirty))},sortAllChildren:function(){if(this._reorderChildDirty){for(var t,e,i=this._children,n=i.length,s=1;s<n;s++){for(e=i[s],t=s-1;0<=t&&(e._localZOrder<i[t]._localZOrder||e._localZOrder===i[t]._localZOrder&&e.arrivalOrder<i[t].arrivalOrder);)i[t+1]=i[t],t--;i[t+1]=e}this._reorderChildDirty=!1}},draw:function(t){},transformAncestors:function(){null!==this._parent&&(this._parent.transformAncestors(),this._parent.transform())},onEnter:function(){this._isTransitionFinished=!1,this._running=!0,this.resume()},_performRecursive:function(t){var e=cc.Node._stateCallbackType;if(!(t>=e.max)){var i,n,s,r,o,a=0,c=cc.Node._performStacks[cc.Node._performing];for(c||cc.Node._performStacks.push(c=[]),c.length=0,cc.Node._performing++,s=c[0]=this;s;){if((i=s._children)&&0<i.length)for(r=0,o=i.length;r<o;++r)n=i[r],c.push(n);if((i=s._protectedChildren)&&0<i.length)for(r=0,o=i.length;r<o;++r)n=i[r],c.push(n);s=c[++a]}for(r=c.length-1;0<=r;--r)if(s=c[r],c[r]=null,s)switch(t){case e.onEnter:s.onEnter();break;case e.onExit:s.onExit();break;case e.onEnterTransitionDidFinish:s.onEnterTransitionDidFinish();break;case e.cleanup:s.cleanup();break;case e.onExitTransitionDidStart:s.onExitTransitionDidStart()}cc.Node._performing--}},onEnterTransitionDidFinish:function(){this._isTransitionFinished=!0},onExitTransitionDidStart:function(){},onExit:function(){this._running=!1,this.pause(),this.removeAllComponents()},runAction:function(t){return cc.assert(t,cc._LogInfos.Node_runAction),this.actionManager.addAction(t,this,!this._running),t},stopAllActions:function(){this.actionManager&&this.actionManager.removeAllActionsFromTarget(this)},stopAction:function(t){this.actionManager.removeAction(t)},stopActionByTag:function(t){t===cc.ACTION_TAG_INVALID?cc.log(cc._LogInfos.Node_stopActionByTag):this.actionManager.removeActionByTag(t,this)},getActionByTag:function(t){return t===cc.ACTION_TAG_INVALID?(cc.log(cc._LogInfos.Node_getActionByTag),null):this.actionManager.getActionByTag(t,this)},getNumberOfRunningActions:function(){return this.actionManager.numberOfRunningActionsInTarget(this)},scheduleUpdate:function(){this.scheduleUpdateWithPriority(0)},scheduleUpdateWithPriority:function(t){this.scheduler.scheduleUpdate(this,t,!this._running)},unscheduleUpdate:function(){this.scheduler.unscheduleUpdate(this)},schedule:function(t,e,i,n,s){var r=arguments.length;"function"==typeof t?1===r?(i=cc.REPEAT_FOREVER,n=e=0,s=this.__instanceId):2===r?"number"==typeof e?(i=cc.REPEAT_FOREVER,n=0,s=this.__instanceId):(s=e,i=cc.REPEAT_FOREVER,n=e=0):3===r?("string"==typeof i?(s=i,i=cc.REPEAT_FOREVER):s=this.__instanceId,n=0):4===r&&(s=this.__instanceId):1===r?(i=cc.REPEAT_FOREVER,n=e=0):2===r&&(i=cc.REPEAT_FOREVER,n=0),cc.assert(t,cc._LogInfos.Node_schedule),cc.assert(0<=e,cc._LogInfos.Node_schedule_2),e=e||0,i=isNaN(i)?cc.REPEAT_FOREVER:i,this.scheduler.schedule(t,this,e,i,n||0,!this._running,s)},scheduleOnce:function(t,e,i){void 0===i&&(i=this.__instanceId),this.schedule(t,0,0,e,i)},unschedule:function(t){t&&this.scheduler.unschedule(t,this)},unscheduleAllCallbacks:function(){this.scheduler.unscheduleAllForTarget(this)},resumeSchedulerAndActions:function(){cc.log(cc._LogInfos.Node_resumeSchedulerAndActions),this.resume()},resume:function(){this.scheduler.resumeTarget(this),this.actionManager&&this.actionManager.resumeTarget(this),cc.eventManager.resumeTarget(this)},pauseSchedulerAndActions:function(){cc.log(cc._LogInfos.Node_pauseSchedulerAndActions),this.pause()},pause:function(){this.scheduler.pauseTarget(this),this.actionManager&&this.actionManager.pauseTarget(this),cc.eventManager.pauseTarget(this)},setAdditionalTransform:function(t){if(void 0===t)return this._additionalTransformDirty=!1;this._additionalTransform=t,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty),this._additionalTransformDirty=!0},getParentToNodeTransform:function(){return this._renderCmd.getParentToNodeTransform()},parentToNodeTransform:function(){return this.getParentToNodeTransform()},getNodeToWorldTransform:function(){for(var t=this.getNodeToParentTransform(),e=this._parent;null!==e;e=e.parent)t=cc.affineTransformConcat(t,e.getNodeToParentTransform());return t},nodeToWorldTransform:function(){return this.getNodeToWorldTransform()},getWorldToNodeTransform:function(){return cc.affineTransformInvert(this.getNodeToWorldTransform())},worldToNodeTransform:function(){return this.getWorldToNodeTransform()},convertToNodeSpace:function(t){return cc.pointApplyAffineTransform(t,this.getWorldToNodeTransform())},convertToWorldSpace:function(t){return t=t||cc.p(0,0),cc.pointApplyAffineTransform(t,this.getNodeToWorldTransform())},convertToNodeSpaceAR:function(t){return cc.pSub(this.convertToNodeSpace(t),this._renderCmd.getAnchorPointInPoints())},convertToWorldSpaceAR:function(t){return t=t||cc.p(0,0),t=cc.pAdd(t,this._renderCmd.getAnchorPointInPoints()),this.convertToWorldSpace(t)},_convertToWindowSpace:function(t){return t=this.convertToWorldSpace(t),cc.director.convertToUI(t)},convertTouchToNodeSpace:function(t){return t=t.getLocation(),this.convertToNodeSpace(t)},convertTouchToNodeSpaceAR:function(t){return t=cc.director.convertToGL(t.getLocation()),this.convertToNodeSpaceAR(t)},update:function(t){this._componentContainer&&!this._componentContainer.isEmpty()&&this._componentContainer.visit(t)},updateTransform:function(){for(var t,e=this._children,i=0;i<e.length;i++)(t=e[i])&&t.updateTransform()},retain:function(){},release:function(){},getComponent:function(t){return this._componentContainer?this._componentContainer.getComponent(t):null},addComponent:function(t){this._componentContainer&&this._componentContainer.add(t)},removeComponent:function(t){return!!this._componentContainer&&this._componentContainer.remove(t)},removeAllComponents:function(){this._componentContainer&&this._componentContainer.removeAll()},grid:null,visit:function(t){var e=this._renderCmd,i=t?t._renderCmd:null;if(this._visible){t=cc.renderer,e.visit(i);var n,s=this._children,r=s.length;if(0<r){for(this._reorderChildDirty&&this.sortAllChildren(),i=0;i<r&&(n=s[i])._localZOrder<0;i++)n.visit(this);for(t.pushRenderCommand(e);i<r;i++)s[i].visit(this)}else t.pushRenderCommand(e);e._dirtyFlag=0}else e._propagateFlagsDown(i)},transform:function(t,e){this._renderCmd.transform(t,e)},nodeToParentTransform:function(){return this.getNodeToParentTransform()},getNodeToParentTransform:function(t){var e=this._renderCmd.getNodeToParentTransform();if(t)for(var e={a:e.a,b:e.b,c:e.c,d:e.d,tx:e.tx,ty:e.ty},i=this._parent;null!=i&&i!=t;i=i.getParent())cc.affineTransformConcatIn(e,i.getNodeToParentTransform());return e},getNodeToParentAffineTransform:function(t){return this.getNodeToParentTransform(t)},getCamera:function(){return null},getGrid:function(){return this.grid},setGrid:function(t){this.grid=t},getShaderProgram:function(){return this._renderCmd.getShaderProgram()},setShaderProgram:function(t){this._renderCmd.setShaderProgram(t)},setGLProgramState:function(t){this._renderCmd.setGLProgramState(t)},getGLProgramState:function(){return this._renderCmd.getGLProgramState()},getGLServerState:function(){return 0},setGLServerState:function(t){},getBoundingBoxToWorld:function(){var t=cc.rect(0,0,this._contentSize.width,this._contentSize.height),e=this.getNodeToWorldTransform(),t=cc.rectApplyAffineTransform(t,e);if(this._children)for(var i=this._children,n=0;n<i.length;n++){var s=i[n];s&&s._visible&&(s=s._getBoundingBoxToCurrentNode(e))&&(t=cc.rectUnion(t,s))}return t},_getBoundingBoxToCurrentNode:function(t){var e=cc.rect(0,0,this._contentSize.width,this._contentSize.height);if(t=void 0===t?this.getNodeToParentTransform():cc.affineTransformConcat(this.getNodeToParentTransform(),t),e=cc.rectApplyAffineTransform(e,t),this._children)for(var i=this._children,n=0;n<i.length;n++){var s=i[n];s&&s._visible&&(s=s._getBoundingBoxToCurrentNode(t))&&(e=cc.rectUnion(e,s))}return e},getOpacity:function(){return this._realOpacity},getDisplayedOpacity:function(){return this._renderCmd.getDisplayedOpacity()},setOpacity:function(t){this._realOpacity=t,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.opacityDirty)},updateDisplayedOpacity:function(t){this._renderCmd._updateDisplayOpacity(t)},isCascadeOpacityEnabled:function(){return this._cascadeOpacityEnabled},setCascadeOpacityEnabled:function(t){this._cascadeOpacityEnabled!==t&&(this._cascadeOpacityEnabled=t,this._renderCmd.setCascadeOpacityEnabledDirty())},getColor:function(){var t=this._realColor;return cc.color(t.r,t.g,t.b,t.a)},getDisplayedColor:function(){return this._renderCmd.getDisplayedColor()},setColor:function(t){var e=this._realColor;e.r=t.r,e.g=t.g,e.b=t.b,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty)},updateDisplayedColor:function(t){this._renderCmd._updateDisplayColor(t)},isCascadeColorEnabled:function(){return this._cascadeColorEnabled},setCascadeColorEnabled:function(t){this._cascadeColorEnabled!==t&&(this._cascadeColorEnabled=t,this._renderCmd.setCascadeColorEnabledDirty())},setOpacityModifyRGB:function(t){},isOpacityModifyRGB:function(){return!1},_createRenderCmd:function(){return new(cc._renderType===cc.game.RENDER_TYPE_CANVAS?cc.Node.CanvasRenderCmd:cc.Node.WebGLRenderCmd)(this)},enumerateChildren:function(t,e){cc.assert(t&&0!=t.length,"Invalid name"),cc.assert(null!=e,"Invalid callback function");var i=t.length,n=0,s=i,r=!1,o=(2<i&&"/"===t[0]&&"/"===t[1]&&(r=!0,s-=n=2),!1);3<i&&"/"===t[i-3]&&"."===t[i-2]&&"."===t[i-1]&&(o=!0,s-=3),i=t.substr(n,s),o&&(i="[[:alnum:]]+/"+i),r?this.doEnumerateRecursive(this,i,e):this.doEnumerate(i,e)},doEnumerateRecursive:function(t,e,i){var n=!1;if(t.doEnumerate(e,i))n=!0;else for(var s=t.getChildren(),r=s.length,o=0;o<r;o++)if(t=s[o],this.doEnumerateRecursive(t,e,i)){n=!0;break}return n},doEnumerate:function(t,e){var i=t.indexOf("/"),n=t,s=!1;-1!==i&&(n=t.substr(0,i),s=!0);for(var r,i=!1,o=this._children,a=o.length,c=0;c<a;c++)if(-1!==(r=o[c])._name.indexOf(n))if(s){if(i=r.doEnumerate(t,e))break}else if(e(r)){i=!0;break}return i}}),cc.Node.create=function(){return new cc.Node},cc.Node._stateCallbackType={onEnter:1,onExit:2,cleanup:3,onEnterTransitionDidFinish:4,onExitTransitionDidStart:5,max:6},cc.Node._performStacks=[[]],cc.Node._performing=0,cc.assert(cc.isFunction(cc._tmp.PrototypeCCNode),cc._LogInfos.MissingFile,"BaseNodesPropertyDefine.js"),cc._tmp.PrototypeCCNode(),delete cc._tmp.PrototypeCCNode,cc.CustomRenderCmd=function(t,e){this._needDraw=!0,this._target=t,this._callback=e},cc.CustomRenderCmd.prototype.rendering=function(t,e,i){this._callback&&this._callback.call(this._target,t,e,i)},cc.CustomRenderCmd.prototype.needDraw=function(){return this._needDraw},cc.Node._dirtyFlags={transformDirty:1,visibleDirty:2,colorDirty:4,opacityDirty:8,cacheDirty:16,orderDirty:32,textDirty:64,gradientDirty:128,textureDirty:256,contentDirty:512,COUNT:10,all:1023}),ONE_DEGREE=Math.PI/180;function transformChildTree(t){var e,i,n,s,r,o=1,a=cc.Node._performStacks[cc.Node._performing];for(a||cc.Node._performStacks.push(a=[]),a.length=0,cc.Node._performing++,a[0]=t;o;)if(i=a[--o],a[o]=null,i){if((e=i._children)&&0<e.length)for(n=i._renderCmd,s=0,r=e.length;s<r;++s)t=e[s],a[o]=t,o++,t._renderCmd.transform(n);if((e=i._protectedChildren)&&0<e.length)for(n=i._renderCmd,s=0,r=e.length;s<r;++s)t=e[s],a[o]=t,o++,t._renderCmd.transform(n)}cc.Node._performing--}cc.Node.RenderCmd=function(t){this._node=t,this._anchorPointInPoints={x:0,y:0},this._displayedColor=cc.color(255,255,255,255)},cc.Node.RenderCmd.prototype={constructor:cc.Node.RenderCmd,_needDraw:!1,_dirtyFlag:1,_curLevel:-1,_displayedOpacity:255,_cascadeColorEnabledDirty:!1,_cascadeOpacityEnabledDirty:!1,_transform:null,_worldTransform:null,_inverse:null,needDraw:function(){return this._needDraw},getAnchorPointInPoints:function(){return cc.p(this._anchorPointInPoints)},getDisplayedColor:function(){var t=this._displayedColor;return cc.color(t.r,t.g,t.b,t.a)},getDisplayedOpacity:function(){return this._displayedOpacity},setCascadeColorEnabledDirty:function(){this._cascadeColorEnabledDirty=!0,this.setDirtyFlag(cc.Node._dirtyFlags.colorDirty)},setCascadeOpacityEnabledDirty:function(){this._cascadeOpacityEnabledDirty=!0,this.setDirtyFlag(cc.Node._dirtyFlags.opacityDirty)},getParentToNodeTransform:function(){return this._inverse||(this._inverse={a:1,b:0,c:0,d:1,tx:0,ty:0}),this._dirtyFlag&cc.Node._dirtyFlags.transformDirty&&cc.affineTransformInvertOut(this.getNodeToParentTransform(),this._inverse),this._inverse},detachFromParent:function(){},_updateAnchorPointInPoint:function(){var t=this._anchorPointInPoints,e=this._node._contentSize,i=this._node._anchorPoint;t.x=e.width*i.x,t.y=e.height*i.y,this.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},setDirtyFlag:function(t){0===this._dirtyFlag&&0!==t&&cc.renderer.pushDirtyNode(this),this._dirtyFlag|=t},getParentRenderCmd:function(){return this._node&&this._node._parent&&this._node._parent._renderCmd?this._node._parent._renderCmd:null},transform:function(t,e){this._transform||(this._transform={a:1,b:0,c:0,d:1,tx:0,ty:0},this._worldTransform={a:1,b:0,c:0,d:1,tx:0,ty:0});var i=this._node,t=t?t._worldTransform:null,n=this._transform,s=this._worldTransform,r=(i._usingNormalizedPosition&&i._parent&&(h=i._parent._contentSize,i._position.x=i._normalizedPosition.x*h.width,i._position.y=i._normalizedPosition.y*h.height,i._normalizedPositionDirty=!1),i._rotationX||i._rotationY),o=i._skewX||i._skewY,a=i._scaleX,c=i._scaleY,h=this._anchorPointInPoints.x,l=this._anchorPointInPoints.y,u=1,d=0,_=0,p=1;r||o?(n.tx=i._position.x,n.ty=i._position.y,r&&(u=i._rotationX*ONE_DEGREE,_=Math.sin(u),p=Math.cos(u),d=i._rotationY===i._rotationX?(u=p,-_):(d=i._rotationY*ONE_DEGREE,u=Math.cos(d),-Math.sin(d))),n.a=u*=a,n.b=d*=a,n.c=_*=c,n.d=p*=c,o&&(o=Math.tan(i._skewX*ONE_DEGREE),a=Math.tan(i._skewY*ONE_DEGREE),1/0===o&&(o=99999999),n.a=u+_*(a=1/0===a?99999999:a),n.b=d+p*a,n.c=_+u*o,n.d=p+d*o),(h||l)&&(n.tx-=n.a*h+n.c*l,n.ty-=n.b*h+n.d*l,i._ignoreAnchorPointForPosition)&&(n.tx+=h,n.ty+=l),i._additionalTransformDirty&&cc.affineTransformConcatIn(n,i._additionalTransform),t?(s.a=n.a*t.a+n.b*t.c,s.b=n.a*t.b+n.b*t.d,s.c=n.c*t.a+n.d*t.c,s.d=n.c*t.b+n.d*t.d,s.tx=t.a*n.tx+t.c*n.ty+t.tx,s.ty=t.d*n.ty+t.ty+t.b*n.tx):(s.a=n.a,s.b=n.b,s.c=n.c,s.d=n.d,s.tx=n.tx,s.ty=n.ty)):(n.a=a,n.b=0,n.c=0,n.d=c,n.tx=i._position.x,n.ty=i._position.y,(h||l)&&(n.tx-=n.a*h,n.ty-=n.d*l,i._ignoreAnchorPointForPosition)&&(n.tx+=h,n.ty+=l),i._additionalTransformDirty&&cc.affineTransformConcatIn(n,i._additionalTransform),t?(s.a=n.a*t.a+n.b*t.c,s.b=n.a*t.b+n.b*t.d,s.c=n.c*t.a+n.d*t.c,s.d=n.c*t.b+n.d*t.d,s.tx=n.tx*t.a+n.ty*t.c+t.tx,s.ty=n.tx*t.b+n.ty*t.d+t.ty):(s.a=n.a,s.b=n.b,s.c=n.c,s.d=n.d,s.tx=n.tx,s.ty=n.ty)),this._updateCurrentRegions&&(this._updateCurrentRegions(),this._notifyRegionStatus)&&this._notifyRegionStatus(cc.Node.CanvasRenderCmd.RegionStatus.DirtyDouble),e&&transformChildTree(i),this._cacheDirty=!0},getNodeToParentTransform:function(){return(!this._transform||this._dirtyFlag&cc.Node._dirtyFlags.transformDirty)&&this.transform(),this._transform},visit:function(t){var e=this._node,i=cc.renderer;(t=t||this.getParentRenderCmd())&&(this._curLevel=t._curLevel+1),isNaN(e._customZ)&&(e._vertexZ=i.assignedZ,i.assignedZ+=i.assignedZStep),this._syncStatus(t)},_updateDisplayColor:function(t){var e,i=this._node,n=this._displayedColor,s=i._realColor;if(this._notifyRegionStatus&&this._notifyRegionStatus(cc.Node.CanvasRenderCmd.RegionStatus.Dirty),this._cascadeColorEnabledDirty&&!i._cascadeColorEnabled){for(n.r=s.r,n.g=s.g,n.b=s.b,n=new cc.Color(255,255,255,255),t=i._children,i=0,s=t.length;i<s;i++)(e=t[i])&&e._renderCmd&&e._renderCmd._updateDisplayColor(n);this._cascadeColorEnabledDirty=!1}else if(void 0===t&&(t=(t=i._parent)&&t._cascadeColorEnabled?t.getDisplayedColor():cc.color.WHITE),n.r=0|s.r*t.r/255,n.g=0|s.g*t.g/255,n.b=0|s.b*t.b/255,i._cascadeColorEnabled)for(t=i._children,i=0,s=t.length;i<s;i++)(e=t[i])&&e._renderCmd&&(e._renderCmd._updateDisplayColor(n),e._renderCmd._updateColor());this._dirtyFlag&=~dirtyFlags.colorDirty},_updateDisplayOpacity:function(t){var e,i,n=this._node;if(this._notifyRegionStatus&&this._notifyRegionStatus(cc.Node.CanvasRenderCmd.RegionStatus.Dirty),this._cascadeOpacityEnabledDirty&&!n._cascadeOpacityEnabled){for(this._displayedOpacity=n._realOpacity,t=0,n=(e=n._children).length;t<n;t++)(i=e[t])&&i._renderCmd&&i._renderCmd._updateDisplayOpacity(255);this._cascadeOpacityEnabledDirty=!1}else if(void 0===t&&(t=255,e=n._parent)&&e._cascadeOpacityEnabled&&(t=e.getDisplayedOpacity()),this._displayedOpacity=n._realOpacity*t/255,n._cascadeOpacityEnabled)for(t=0,n=(e=n._children).length;t<n;t++)(i=e[t])&&i._renderCmd&&(i._renderCmd._updateDisplayOpacity(this._displayedOpacity),i._renderCmd._updateColor());this._dirtyFlag&=~dirtyFlags.opacityDirty},_syncDisplayColor:function(t){var e=this._node,i=this._displayedColor,n=e._realColor;void 0===t&&(t=(t=e._parent)&&t._cascadeColorEnabled?t.getDisplayedColor():cc.color.WHITE),i.r=0|n.r*t.r/255,i.g=0|n.g*t.g/255,i.b=0|n.b*t.b/255},_syncDisplayOpacity:function(t){var e,i=this._node;void 0===t&&(t=255,e=i._parent)&&e._cascadeOpacityEnabled&&(t=e.getDisplayedOpacity()),this._displayedOpacity=i._realOpacity*t/255},_updateColor:function(){},_propagateFlagsDown:function(t){var e=this._dirtyFlag,i=t?t._node:null;i&&i._cascadeColorEnabled&&t._dirtyFlag&dirtyFlags.colorDirty&&(e|=dirtyFlags.colorDirty),i&&i._cascadeOpacityEnabled&&t._dirtyFlag&dirtyFlags.opacityDirty&&(e|=dirtyFlags.opacityDirty),t&&t._dirtyFlag&dirtyFlags.transformDirty&&(e|=dirtyFlags.transformDirty),this._dirtyFlag=e},updateStatus:function(){var t=this._dirtyFlag,e=t&dirtyFlags.colorDirty,i=t&dirtyFlags.opacityDirty;t&dirtyFlags.contentDirty&&(this._notifyRegionStatus&&this._notifyRegionStatus(cc.Node.CanvasRenderCmd.RegionStatus.Dirty),this._dirtyFlag&=~dirtyFlags.contentDirty),e&&this._updateDisplayColor(),i&&this._updateDisplayOpacity(),(e||i)&&this._updateColor(),t&dirtyFlags.transformDirty&&(this.transform(this.getParentRenderCmd(),!0),this._dirtyFlag&=~dirtyFlags.transformDirty),t&dirtyFlags.orderDirty&&(this._dirtyFlag&=~dirtyFlags.orderDirty)},_syncStatus:function(t){var e=this._dirtyFlag,i=((i=t?t._node:null)&&i._cascadeColorEnabled&&t._dirtyFlag&dirtyFlags.colorDirty&&(e|=dirtyFlags.colorDirty),i&&i._cascadeOpacityEnabled&&t._dirtyFlag&dirtyFlags.opacityDirty&&(e|=dirtyFlags.opacityDirty),t&&t._dirtyFlag&dirtyFlags.transformDirty&&(e|=dirtyFlags.transformDirty),(this._dirtyFlag=e)&dirtyFlags.colorDirty),n=e&dirtyFlags.opacityDirty;i&&this._syncDisplayColor(),n&&this._syncDisplayOpacity(),(i||n)&&this._updateColor(),e&dirtyFlags.transformDirty&&this.transform(t),e&dirtyFlags.orderDirty&&(this._dirtyFlag&=~dirtyFlags.orderDirty)},setShaderProgram:function(t){},getShaderProgram:function(){return null},getGLProgramState:function(){return null},setGLProgramState:function(t){}},cc.Node.RenderCmd.prototype.originTransform=cc.Node.RenderCmd.prototype.transform,cc.Node.RenderCmd.prototype.originUpdateStatus=cc.Node.RenderCmd.prototype.updateStatus,cc.Node.RenderCmd.prototype._originSyncStatus=cc.Node.RenderCmd.prototype._syncStatus,!function(){cc.Node.CanvasRenderCmd=function(t){this._node=t,this._anchorPointInPoints={x:0,y:0},this._displayedColor=cc.color(255,255,255,255),this._cachedParent=null,this._cacheDirty=!1,this._currentRegion=new cc.Region,this._oldRegion=new cc.Region,this._regionFlag=0,this._canUseDirtyRegion=!1},cc.Node.CanvasRenderCmd.RegionStatus={NotDirty:0,Dirty:1,DirtyDouble:2};var t=cc.Node.CanvasRenderCmd.prototype=Object.create(cc.Node.RenderCmd.prototype),e=(t.constructor=cc.Node.CanvasRenderCmd,t._rootCtor=cc.Node.CanvasRenderCmd,t._notifyRegionStatus=function(t){this._needDraw&&this._regionFlag<t&&(this._regionFlag=t)},new cc.Rect);t.getLocalBB=function(){var t=this._node;return e.x=e.y=0,e.width=t._contentSize.width,e.height=t._contentSize.height,e},t._updateCurrentRegions=function(){var t=this._currentRegion;this._currentRegion=this._oldRegion,this._oldRegion=t,cc.Node.CanvasRenderCmd.RegionStatus.DirtyDouble!==this._regionFlag||this._currentRegion.isEmpty()||this._oldRegion.union(this._currentRegion),this._currentRegion.updateRegion(this.getLocalBB(),this._worldTransform)},t.setDirtyFlag=function(t,e){cc.Node.RenderCmd.prototype.setDirtyFlag.call(this,t,e),this._setCacheDirty(e),this._cachedParent&&this._cachedParent.setDirtyFlag(t,!0)},t._setCacheDirty=function(){var t;!1===this._cacheDirty&&(this._cacheDirty=!0,t=this._cachedParent)&&t!==this&&t._setNodeDirtyForCache&&t._setNodeDirtyForCache()},t._setCachedParent=function(t){if(this._cachedParent!==t){this._cachedParent=t;for(var e=this._node._children,i=0,n=e.length;i<n;i++)e[i]._renderCmd._setCachedParent(t)}},t.detachFromParent=function(){this._cachedParent=null;for(var t,e=this._node._children,i=0,n=e.length;i<n;i++)(t=e[i])&&t._renderCmd&&t._renderCmd.detachFromParent()},cc.Node.CanvasRenderCmd._getCompositeOperationByBlendFunc=function(t){return t?t.src===cc.SRC_ALPHA&&t.dst===cc.ONE||t.src===cc.ONE&&t.dst===cc.ONE?"lighter":t.src===cc.ZERO&&t.dst===cc.SRC_ALPHA?"destination-in":t.src===cc.ZERO&&t.dst===cc.ONE_MINUS_SRC_ALPHA?"destination-out":"source-over":"source-over"}}(),!function(){cc.Node.WebGLRenderCmd=function(t){this._node=t,this._anchorPointInPoints={x:0,y:0},this._displayedColor=cc.color(255,255,255,255),this._glProgramState=null};var t=cc.Node.WebGLRenderCmd.prototype=Object.create(cc.Node.RenderCmd.prototype);t.constructor=cc.Node.WebGLRenderCmd,t._rootCtor=cc.Node.WebGLRenderCmd,t._updateColor=function(){},t.setShaderProgram=function(t){this._glProgramState=cc.GLProgramState.getOrCreateWithGLProgram(t)},t.getShaderProgram=function(){return this._glProgramState?this._glProgramState.getGLProgram():null},t.getGLProgramState=function(){return this._glProgramState},t.setGLProgramState=function(t){this._glProgramState=t},Object.defineProperty(t,"_shaderProgram",{set:function(t){this.setShaderProgram(t)},get:function(){return this.getShaderProgram()}})}(),cc.AtlasNode=cc.Node.extend({textureAtlas:null,quadsToDraw:0,_itemsPerRow:0,_itemsPerColumn:0,_itemWidth:0,_itemHeight:0,_opacityModifyRGB:!1,_blendFunc:null,_ignoreContentScaleFactor:!1,_className:"AtlasNode",_texture:null,_textureForCanvas:null,ctor:function(t,e,i,n){cc.Node.prototype.ctor.call(this),this._blendFunc={src:cc.BLEND_SRC,dst:cc.BLEND_DST},this._ignoreContentScaleFactor=!1,void 0!==n&&this.initWithTileFile(t,e,i,n)},_createRenderCmd:function(){this._renderCmd=new(cc._renderType===cc.game.RENDER_TYPE_CANVAS?cc.AtlasNode.CanvasRenderCmd:cc.AtlasNode.WebGLRenderCmd)(this)},updateAtlasValues:function(){cc.log(cc._LogInfos.AtlasNode_updateAtlasValues)},getColor:function(){return this._opacityModifyRGB?this._renderCmd._colorUnmodified:cc.Node.prototype.getColor.call(this)},setOpacityModifyRGB:function(t){var e=this.color;this._opacityModifyRGB=t,this.setColor(e)},isOpacityModifyRGB:function(){return this._opacityModifyRGB},getBlendFunc:function(){return this._blendFunc},setBlendFunc:function(t,e){this._blendFunc=void 0===e?t:{src:t,dst:e}},setTextureAtlas:function(t){this.textureAtlas=t},getTextureAtlas:function(){return this.textureAtlas},getQuadsToDraw:function(){return this.quadsToDraw},setQuadsToDraw:function(t){this.quadsToDraw=t},initWithTileFile:function(t,e,i,n){if(t)return t=cc.textureCache.addImage(t),this.initWithTexture(t,e,i,n);throw Error("cc.AtlasNode.initWithTileFile(): title should not be null")},initWithTexture:function(t,e,i,n){return this._renderCmd.initWithTexture(t,e,i,n)},setColor:function(t){this._renderCmd.setColor(t)},setOpacity:function(t){this._renderCmd.setOpacity(t)},getTexture:function(){return this._texture},setTexture:function(t){this._texture=t},_setIgnoreContentScaleFactor:function(t){this._ignoreContentScaleFactor=t}}),_p=cc.AtlasNode.prototype,cc.defineGetterSetter(_p,"opacity",_p.getOpacity,_p.setOpacity),cc.defineGetterSetter(_p,"color",_p.getColor,_p.setColor),cc.defineGetterSetter(_p,"texture",_p.getTexture,_p.setTexture),cc.EventHelper.prototype.apply(_p),cc.AtlasNode.create=function(t,e,i,n){return new cc.AtlasNode(t,e,i,n)},!function(){cc.AtlasNode.CanvasRenderCmd=function(t){this._rootCtor(t),this._needDraw=!1,this._colorUnmodified=cc.color.WHITE,this._textureToRender=null};var t=cc.AtlasNode.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);t.constructor=cc.AtlasNode.CanvasRenderCmd,t.initWithTexture=function(t,e,i,n){var s=this._node;return s._itemWidth=e,s._itemHeight=i,s._opacityModifyRGB=!0,s._texture=t,s._texture?(this._textureToRender=t,this._calculateMaxItems(),s.quadsToDraw=n,!0):(cc.log(cc._LogInfos.AtlasNode__initWithTexture),!1)},t.setColor=function(t){var e=this._node._realColor;e.r===t.r&&e.g===t.g&&e.b===t.b||(this._colorUnmodified=t,this._changeTextureColor())},t._changeTextureColor=function(){var t=this._node._texture,e=this._colorUnmodified,i=t.getHtmlElementObj(),i=cc.rect(0,0,i.width,i.height);t===this._textureToRender?this._textureToRender=t._generateColorTexture(e.r,e.g,e.b,i):t._generateColorTexture(e.r,e.g,e.b,i,this._textureToRender.getHtmlElementObj())},t.setOpacity=function(t){cc.Node.prototype.setOpacity.call(this._node,t)},t._calculateMaxItems=function(){var t=this._node,e=t._texture.getContentSize();t._itemsPerColumn=0|e.height/t._itemHeight,t._itemsPerRow=0|e.width/t._itemWidth}}(),!function(){cc.AtlasNode.WebGLRenderCmd=function(t){this._rootCtor(t),this._needDraw=!0,this._textureAtlas=null,this._colorUnmodified=cc.color.WHITE,this._uniformColor=this._colorF32Array=null,this._matrix=new cc.math.Matrix4,this._matrix.identity(),this._shaderProgram=cc.shaderCache.programForKey(cc.SHADER_POSITION_TEXTURE_UCOLOR),this._uniformColor=cc._renderContext.getUniformLocation(this._shaderProgram.getProgram(),"u_color")};var t=cc.AtlasNode.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype);t.constructor=cc.AtlasNode.WebGLRenderCmd,t._updateBlendFunc=function(){var t=this._node;this._textureAtlas.texture.hasPremultipliedAlpha()||(t._blendFunc.src=cc.SRC_ALPHA,t._blendFunc.dst=cc.ONE_MINUS_SRC_ALPHA)},t._updateOpacityModifyRGB=function(){this._node._opacityModifyRGB=this._textureAtlas.texture.hasPremultipliedAlpha()},t.rendering=function(t){t=t||cc._renderContext;var e=this._node,i=this._worldTransform;this._matrix.mat[0]=i.a,this._matrix.mat[4]=i.c,this._matrix.mat[12]=i.tx,this._matrix.mat[1]=i.b,this._matrix.mat[5]=i.d,this._matrix.mat[13]=i.ty,this._glProgramState.apply(this._matrix),cc.glBlendFunc(e._blendFunc.src,e._blendFunc.dst),this._uniformColor&&this._colorF32Array&&(t.uniform4fv(this._uniformColor,this._colorF32Array),this._textureAtlas.drawNumberOfQuads(e.quadsToDraw,0))},t.initWithTexture=function(t,e,i,n){var s=this._node;return s._itemWidth=e,s._itemHeight=i,this._colorUnmodified=cc.color.WHITE,s._opacityModifyRGB=!0,s._blendFunc.src=cc.BLEND_SRC,s._blendFunc.dst=cc.BLEND_DST,e=s._realColor,this._colorF32Array=new Float32Array([e.r/255,e.g/255,e.b/255,s._realOpacity/255]),this._textureAtlas=new cc.TextureAtlas,this._textureAtlas.initWithTexture(t,n),this._textureAtlas?(this._updateBlendFunc(),this._updateOpacityModifyRGB(),this._calculateMaxItems(),s.quadsToDraw=n,!0):(cc.log(cc._LogInfos.AtlasNode__initWithTexture),!1)},t.setColor=function(t){var e=cc.color(t.r,t.g,t.b),i=this._node;this._colorUnmodified=t,t=this._displayedOpacity,i._opacityModifyRGB&&(e.r=e.r*t/255,e.g=e.g*t/255,e.b=e.b*t/255),cc.Node.prototype.setColor.call(i,e)},t.setOpacity=function(t){var e=this._node;cc.Node.prototype.setOpacity.call(e,t),e._opacityModifyRGB&&(e.color=this._colorUnmodified)},t._updateColor=function(){var t;this._colorF32Array&&(t=this._displayedColor,this._colorF32Array[0]=t.r/255,this._colorF32Array[1]=t.g/255,this._colorF32Array[2]=t.b/255,this._colorF32Array[3]=this._displayedOpacity/255)},t.getTexture=function(){return this._textureAtlas.texture},t.setTexture=function(t){this._textureAtlas.texture=t,this._updateBlendFunc(),this._updateOpacityModifyRGB()},t._calculateMaxItems=function(){var t=this._node,e=this._textureAtlas.texture,i=e.getContentSize();t._ignoreContentScaleFactor&&(i=e.getContentSizeInPixels()),t._itemsPerColumn=0|i.height/t._itemHeight,t._itemsPerRow=0|i.width/t._itemWidth}}(),cc._tmp.WebGLTexture2D=function(){cc.Texture2D=cc.Class.extend({_pVRHaveAlphaPremultiplied:!0,_pixelFormat:null,_pixelsWide:0,_pixelsHigh:0,_name:"",_contentSize:null,maxS:0,maxT:0,_hasPremultipliedAlpha:!1,_hasMipmaps:!1,shaderProgram:null,_textureLoaded:!1,_htmlElementObj:null,_webTextureObj:null,url:null,ctor:function(){this._contentSize=cc.size(0,0),this._pixelFormat=cc.Texture2D.defaultPixelFormat},releaseTexture:function(){this._webTextureObj&&cc._renderContext.deleteTexture(this._webTextureObj),this._htmlElementObj=null,cc.loader.release(this.url)},getPixelFormat:function(){return this._pixelFormat},getPixelsWide:function(){return this._pixelsWide},getPixelsHigh:function(){return this._pixelsHigh},getName:function(){return this._webTextureObj},getContentSize:function(){return cc.size(this._contentSize.width/cc.contentScaleFactor(),this._contentSize.height/cc.contentScaleFactor())},_getWidth:function(){return this._contentSize.width/cc.contentScaleFactor()},_getHeight:function(){return this._contentSize.height/cc.contentScaleFactor()},getContentSizeInPixels:function(){return this._contentSize},getMaxS:function(){return this.maxS},setMaxS:function(t){this.maxS=t},getMaxT:function(){return this.maxT},setMaxT:function(t){this.maxT=t},getShaderProgram:function(){return this.shaderProgram},setShaderProgram:function(t){this.shaderProgram=t},hasPremultipliedAlpha:function(){return this._hasPremultipliedAlpha},hasMipmaps:function(){return this._hasMipmaps},description:function(){return"<cc.Texture2D | Name = "+this._name+" | Dimensions = "+this._pixelsWide+" x "+this._pixelsHigh+" | Coordinates = ("+this.maxS+", "+this.maxT+")>"},releaseData:function(t){},keepData:function(t,e){return t},initWithData:function(t,e,i,n,s){var r=cc.Texture2D,o=cc._renderContext,a=o.RGBA,c=o.UNSIGNED_BYTE,h=i*cc.Texture2D._B[e]/8;switch(0==h%8?o.pixelStorei(o.UNPACK_ALIGNMENT,8):0==h%4?o.pixelStorei(o.UNPACK_ALIGNMENT,4):0==h%2?o.pixelStorei(o.UNPACK_ALIGNMENT,2):o.pixelStorei(o.UNPACK_ALIGNMENT,1),this._webTextureObj=o.createTexture(),cc.glBindTexture2D(this),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),e){case r.PIXEL_FORMAT_RGBA8888:a=o.RGBA;break;case r.PIXEL_FORMAT_RGB888:a=o.RGB;break;case r.PIXEL_FORMAT_RGBA4444:c=o.UNSIGNED_SHORT_4_4_4_4;break;case r.PIXEL_FORMAT_RGB5A1:c=o.UNSIGNED_SHORT_5_5_5_1;break;case r.PIXEL_FORMAT_RGB565:c=o.UNSIGNED_SHORT_5_6_5;break;case r.PIXEL_FORMAT_AI88:a=o.LUMINANCE_ALPHA;break;case r.PIXEL_FORMAT_A8:a=o.ALPHA;break;case r.PIXEL_FORMAT_I8:a=o.LUMINANCE;break;default:cc.assert(0,cc._LogInfos.Texture2D_initWithData)}return o.texImage2D(o.TEXTURE_2D,0,a,i,n,0,a,c,t),this._contentSize.width=s.width,this._contentSize.height=s.height,this._pixelsWide=i,this._pixelsHigh=n,this._pixelFormat=e,this.maxS=s.width/i,this.maxT=s.height/n,this._hasMipmaps=this._hasPremultipliedAlpha=!1,this.shaderProgram=cc.shaderCache.programForKey(cc.SHADER_POSITION_TEXTURE),this._textureLoaded=!0},drawAtPoint:function(t){var e=[0,this.maxT,this.maxS,this.maxT,0,0,this.maxS,0],i=cc._renderContext,n=this._pixelsWide*this.maxS,s=this._pixelsHigh*this.maxT;t=[t.x,t.y,0,n+t.x,t.y,0,t.x,s+t.y,0,n+t.x,s+t.y,0],this._glProgramState.apply(),this._glProgramState._glprogram.setUniformsForBuiltins(),cc.glBindTexture2D(this),i.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),i.enableVertexAttribArray(cc.VERTEX_ATTRIB_TEX_COORDS),i.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,i.FLOAT,!1,0,t),i.vertexAttribPointer(cc.VERTEX_ATTRIB_TEX_COORDS,2,i.FLOAT,!1,0,e),i.drawArrays(i.TRIANGLE_STRIP,0,4)},drawInRect:function(t){var e=[0,this.maxT,this.maxS,this.maxT,0,0,this.maxS,0],i=(t=[t.x,t.y,t.x+t.width,t.y,t.x,t.y+t.height,t.x+t.width,t.y+t.height],this._glProgramState.apply(),this._glProgramState._glprogram.setUniformsForBuiltins(),cc.glBindTexture2D(this),cc._renderContext);i.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),i.enableVertexAttribArray(cc.VERTEX_ATTRIB_TEX_COORDS),i.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,i.FLOAT,!1,0,t),i.vertexAttribPointer(cc.VERTEX_ATTRIB_TEX_COORDS,2,i.FLOAT,!1,0,e),i.drawArrays(i.TRIANGLE_STRIP,0,4)},initWithImage:function(t){var e,i,n;return null==t?(cc.log(cc._LogInfos.Texture2D_initWithImage),!1):(e=t.getWidth(),i=t.getHeight(),(n=cc.configuration.getMaxTextureSize())<e||n<i?(cc.log(cc._LogInfos.Texture2D_initWithImage_2,e,i,n,n),!1):(this._textureLoaded=!0,this._initPremultipliedATextureWithImage(t,e,i)))},initWithElement:function(t){t&&(this._webTextureObj=cc._renderContext.createTexture(),this._htmlElementObj=t,this._hasPremultipliedAlpha=this._textureLoaded=!0)},getHtmlElementObj:function(){return this._htmlElementObj},isLoaded:function(){return this._textureLoaded},handleLoadedTexture:function(t){var e;t=void 0!==t?t:this._hasPremultipliedAlpha,cc.game._rendererInitialized&&this._htmlElementObj&&this._htmlElementObj.width&&this._htmlElementObj.height&&(e=cc._renderContext,cc.glBindTexture2D(this),e.pixelStorei(e.UNPACK_ALIGNMENT,4),t&&e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this._htmlElementObj),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),this.shaderProgram=cc.shaderCache.programForKey(cc.SHADER_POSITION_TEXTURE),cc.glBindTexture2D(null),t&&e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,0),e=this._htmlElementObj.height,this._pixelsWide=this._contentSize.width=this._htmlElementObj.width,this._pixelsHigh=this._contentSize.height=e,this._pixelFormat=cc.Texture2D.PIXEL_FORMAT_RGBA8888,this.maxT=this.maxS=1,this._hasPremultipliedAlpha=t,this._hasMipmaps=!1,window.ENABLE_IMAEG_POOL&&(this._htmlElementObj=null),this.dispatchEvent("load"))},initWithString:function(t,e,i,n,s,r){return cc.log(cc._LogInfos.Texture2D_initWithString),null},initWithETCFile:function(t){return cc.log(cc._LogInfos.Texture2D_initWithETCFile_2),!1},initWithPVRFile:function(t){return cc.log(cc._LogInfos.Texture2D_initWithPVRFile_2),!1},initWithPVRTCData:function(t,e,i,n,s,r){return cc.log(cc._LogInfos.Texture2D_initWithPVRTCData_2),!1},setTexParameters:function(t,e,i,n){var s=cc._renderContext;void 0!==e&&(t={minFilter:t,magFilter:e,wrapS:i,wrapT:n}),cc.assert(this._pixelsWide===cc.NextPOT(this._pixelsWide)&&this._pixelsHigh===cc.NextPOT(this._pixelsHigh)||t.wrapS===s.CLAMP_TO_EDGE&&t.wrapT===s.CLAMP_TO_EDGE,"WebGLRenderingContext.CLAMP_TO_EDGE should be used in NPOT textures"),cc.glBindTexture2D(this),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,t.minFilter),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,t.magFilter),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,t.wrapS),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,t.wrapT)},setAntiAliasTexParameters:function(){var t=cc._renderContext;cc.glBindTexture2D(this),this._hasMipmaps?t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR_MIPMAP_NEAREST):t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR)},setAliasTexParameters:function(){var t=cc._renderContext;cc.glBindTexture2D(this),this._hasMipmaps?t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST_MIPMAP_NEAREST):t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST)},generateMipmap:function(){cc.assert(this._pixelsWide===cc.NextPOT(this._pixelsWide)&&this._pixelsHigh===cc.NextPOT(this._pixelsHigh),"Mimpap texture only works in POT textures"),cc.glBindTexture2D(this),cc._renderContext.generateMipmap(cc._renderContext.TEXTURE_2D),this._hasMipmaps=!0},stringForFormat:function(){return cc.Texture2D._M[this._pixelFormat]},bitsPerPixelForFormat:function(t){t=t||this._pixelFormat;var e=cc.Texture2D._B[t];return null!=e?e:(cc.log(cc._LogInfos.Texture2D_bitsPerPixelForFormat,t),-1)},_initPremultipliedATextureWithImage:function(t,e,i){var n=cc.Texture2D,s=t.getData(),r=null,r=null,o=t.hasAlpha(),a=cc.size(t.getWidth(),t.getHeight()),c=n.defaultPixelFormat,h=t.getBitsPerComponent(),l=e*i;if((c=o?c:8<=h?n.PIXEL_FORMAT_RGB888:(cc.log(cc._LogInfos.Texture2D__initPremultipliedATextureWithImage),n.PIXEL_FORMAT_RGB565))===n.PIXEL_FORMAT_RGB565)if(o)for(s=new Uint16Array(e*i),r=t.getData(),h=0;h<l;++h)s[h]=(r[h]>>0&255)>>3<<11|(r[h]>>8&255)>>2<<5|(r[h]>>16&255)>>3<<0;else for(s=new Uint16Array(e*i),r=t.getData(),h=0;h<l;++h)s[h]=(255&r[h])>>3<<11|(255&r[h])>>2<<5|(255&r[h])>>3<<0;else if(c===n.PIXEL_FORMAT_RGBA4444)for(s=new Uint16Array(e*i),r=t.getData(),h=0;h<l;++h)s[h]=(r[h]>>0&255)>>4<<12|(r[h]>>8&255)>>4<<8|(r[h]>>16&255)>>4<<4|(r[h]>>24&255)>>4<<0;else if(c===n.PIXEL_FORMAT_RGB5A1)for(s=new Uint16Array(e*i),r=t.getData(),h=0;h<l;++h)s[h]=(r[h]>>0&255)>>3<<11|(r[h]>>8&255)>>3<<6|(r[h]>>16&255)>>3<<1|(r[h]>>24&255)>>7<<0;else if(c===n.PIXEL_FORMAT_A8)for(s=new Uint8Array(e*i),r=t.getData(),h=0;h<l;++h)s[h]=r>>24&255;if(o&&c===n.PIXEL_FORMAT_RGB888)for(r=t.getData(),s=new Uint8Array(e*i*3),h=0;h<l;++h)s[3*h]=r>>0&255,s[3*h+1]=r>>8&255,s[3*h+2]=r>>16&255;return this.initWithData(s,c,e,i,a),t.getData(),this._hasPremultipliedAlpha=t.isPremultipliedAlpha(),!0},addLoadedEventListener:function(t,e){this.addEventListener("load",t,e)},removeLoadedEventListener:function(t){this.removeEventTarget("load",t)}})},cc._tmp.WebGLTextureAtlas=function(){var t=cc.TextureAtlas.prototype;t._setupVBO=function(){var t=cc._renderContext;this._buffersVBO[0]=t.createBuffer(),this._buffersVBO[1]=t.createBuffer(),this._quadsWebBuffer=t.createBuffer(),this._mapBuffers()},t._mapBuffers=function(){var t=cc._renderContext;t.bindBuffer(t.ARRAY_BUFFER,this._quadsWebBuffer),t.bufferData(t.ARRAY_BUFFER,this._quadsArrayBuffer,t.DYNAMIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this._buffersVBO[1]),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this._indices,t.STATIC_DRAW)},t.drawNumberOfQuads=function(t,e){var i;e=e||0,0!==t&&this.texture&&this.texture.isLoaded()&&(i=cc._renderContext,cc.glBindTexture2D(this.texture),i.bindBuffer(i.ARRAY_BUFFER,this._quadsWebBuffer),this.dirty&&(i.bufferData(i.ARRAY_BUFFER,this._quadsArrayBuffer,i.DYNAMIC_DRAW),this.dirty=!1),i.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),i.enableVertexAttribArray(cc.VERTEX_ATTRIB_COLOR),i.enableVertexAttribArray(cc.VERTEX_ATTRIB_TEX_COORDS),i.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,3,i.FLOAT,!1,24,0),i.vertexAttribPointer(cc.VERTEX_ATTRIB_COLOR,4,i.UNSIGNED_BYTE,!0,24,12),i.vertexAttribPointer(cc.VERTEX_ATTRIB_TEX_COORDS,2,i.FLOAT,!1,24,16),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,this._buffersVBO[1]),cc.TEXTURE_ATLAS_USE_TRIANGLE_STRIP?i.drawElements(i.TRIANGLE_STRIP,6*t,i.UNSIGNED_SHORT,6*e*this._indices.BYTES_PER_ELEMENT):i.drawElements(i.TRIANGLES,6*t,i.UNSIGNED_SHORT,6*e*this._indices.BYTES_PER_ELEMENT),cc.g_NumberOfDraws++)}},cc._tmp.WebGLTextureCache=function(){var t=cc.textureCache;t.handleLoadedTexture=function(t,e){var i,n=this._textures;return(i=(n=cc.game._rendererInitialized?n:this._loadedTexturesBefore)[t])||((i=n[t]=new cc.Texture2D).url=t),i.initWithElement(e),".png"===cc.path.extname(t)?i.handleLoadedTexture(!0):i.handleLoadedTexture(),i},t.addImage=function(i,n,s){cc.assert(i,cc._LogInfos.Texture2D_addImage_2);var t=this._textures,e=(t=cc.game._rendererInitialized?t:this._loadedTexturesBefore)[i]||t[cc.loader._getAliase(i)];return e?e.isLoaded()?n&&n.call(s,e):e.addEventListener("load",function(){n&&n.call(s,e)},s):((e=t[i]=new cc.Texture2D).url=i,t=cc.loader.getBasePath?cc.loader.getBasePath():cc.loader.resPath,cc.loader.loadImg(cc.path.join(t||"",i),function(t,e){if(t)return n&&n.call(s,t);t=cc.textureCache.handleLoadedTexture(i,e);n&&n.call(s,t)})),e},t.addImageAsync=t.addImage},cc._tmp.PrototypeTexture2D=function(){var t=cc.Texture2D,e=(t.PVRImagesHavePremultipliedAlpha=function(t){cc.PVRHaveAlphaPremultiplied_=t},t.PIXEL_FORMAT_RGBA8888=2,t.PIXEL_FORMAT_RGB888=3,t.PIXEL_FORMAT_RGB565=4,t.PIXEL_FORMAT_A8=5,t.PIXEL_FORMAT_I8=6,t.PIXEL_FORMAT_AI88=7,t.PIXEL_FORMAT_RGBA4444=8,t.PIXEL_FORMAT_RGB5A1=7,t.PIXEL_FORMAT_PVRTC4=9,t.PIXEL_FORMAT_PVRTC2=10,t.PIXEL_FORMAT_DEFAULT=t.PIXEL_FORMAT_RGBA8888,t.defaultPixelFormat=t.PIXEL_FORMAT_DEFAULT,cc.Texture2D._M={});e[t.PIXEL_FORMAT_RGBA8888]="RGBA8888",e[t.PIXEL_FORMAT_RGB888]="RGB888",e[t.PIXEL_FORMAT_RGB565]="RGB565",e[t.PIXEL_FORMAT_A8]="A8",e[t.PIXEL_FORMAT_I8]="I8",e[t.PIXEL_FORMAT_AI88]="AI88",e[t.PIXEL_FORMAT_RGBA4444]="RGBA4444",e[t.PIXEL_FORMAT_RGB5A1]="RGB5A1",e[t.PIXEL_FORMAT_PVRTC4]="PVRTC4",e[t.PIXEL_FORMAT_PVRTC2]="PVRTC2",(e=cc.Texture2D._B={})[t.PIXEL_FORMAT_RGBA8888]=32,e[t.PIXEL_FORMAT_RGB888]=24,e[t.PIXEL_FORMAT_RGB565]=16,e[t.PIXEL_FORMAT_A8]=8,e[t.PIXEL_FORMAT_I8]=8,e[t.PIXEL_FORMAT_AI88]=16,e[t.PIXEL_FORMAT_RGBA4444]=16,e[t.PIXEL_FORMAT_RGB5A1]=16,e[t.PIXEL_FORMAT_PVRTC4]=4,e[t.PIXEL_FORMAT_PVRTC2]=3,t=cc.Texture2D.prototype,cc.defineGetterSetter(t,"name",t.getName),cc.defineGetterSetter(t,"pixelFormat",t.getPixelFormat),cc.defineGetterSetter(t,"pixelsWidth",t.getPixelsWide),cc.defineGetterSetter(t,"pixelsHeight",t.getPixelsHigh),cc.defineGetterSetter(t,"width",t._getWidth),cc.defineGetterSetter(t,"height",t._getHeight)},cc._tmp.PrototypeTextureAtlas=function(){var t=cc.TextureAtlas.prototype;cc.defineGetterSetter(t,"totalQuads",t.getTotalQuads),cc.defineGetterSetter(t,"capacity",t.getCapacity),cc.defineGetterSetter(t,"quads",t.getQuads,t.setQuads)},cc.ALIGN_CENTER=51,cc.ALIGN_TOP=19,cc.ALIGN_TOP_RIGHT=18,cc.ALIGN_RIGHT=50,cc.ALIGN_BOTTOM_RIGHT=34,cc.ALIGN_BOTTOM=35,cc.ALIGN_BOTTOM_LEFT=33,cc.ALIGN_LEFT=49,cc.ALIGN_TOP_LEFT=17,cc.PVRHaveAlphaPremultiplied_=!1,cc.game.addEventListener(cc.game.EVENT_RENDERER_INITED,function(){var t;cc._renderType===cc.game.RENDER_TYPE_CANVAS?((t={_contentSize:null,_textureLoaded:!1,_htmlElementObj:null,url:null,_pattern:null,ctor:function(){this._contentSize=cc.size(0,0),this._textureLoaded=!1,this._htmlElementObj=null,this._pattern="",this._pixelsHigh=this._pixelsWide=0},getPixelsWide:function(){return this._pixelsWide},getPixelsHigh:function(){return this._pixelsHigh},getContentSize:function(){var t=cc.contentScaleFactor();return cc.size(this._contentSize.width/t,this._contentSize.height/t)},_getWidth:function(){return this._contentSize.width/cc.contentScaleFactor()},_getHeight:function(){return this._contentSize.height/cc.contentScaleFactor()},getContentSizeInPixels:function(){return this._contentSize},initWithElement:function(t){t&&(this._htmlElementObj=t,this._pixelsWide=this._contentSize.width=t.width,this._pixelsHigh=this._contentSize.height=t.height,this._textureLoaded=!0)},getHtmlElementObj:function(){return this._htmlElementObj},isLoaded:function(){return this._textureLoaded},handleLoadedTexture:function(){var t;this._htmlElementObj&&(t=this._htmlElementObj,this._pixelsWide=this._contentSize.width=t.width,this._pixelsHigh=this._contentSize.height=t.height,this.dispatchEvent("load"))},description:function(){return"<cc.Texture2D | width = "+this._contentSize.width+" height "+this._contentSize.height+">"},initWithData:function(t,e,i,n,s){return!1},initWithImage:function(t){return!1},initWithString:function(t,e,i,n,s,r){return!1},releaseTexture:function(){this._htmlElementObj=null,cc.loader.release(this.url)},getName:function(){return null},getMaxS:function(){return 1},setMaxS:function(t){},getMaxT:function(){return 1},setMaxT:function(t){},getPixelFormat:function(){return null},getShaderProgram:function(){return null},setShaderProgram:function(t){},hasPremultipliedAlpha:function(){return!1},hasMipmaps:function(){return!1},releaseData:function(t){},keepData:function(t,e){return t},drawAtPoint:function(t){},drawInRect:function(t){},initWithETCFile:function(t){return cc.log(cc._LogInfos.Texture2D_initWithETCFile),!1},initWithPVRFile:function(t){return cc.log(cc._LogInfos.Texture2D_initWithPVRFile),!1},initWithPVRTCData:function(t,e,i,n,s,r){return cc.log(cc._LogInfos.Texture2D_initWithPVRTCData),!1},setTexParameters:function(t,e,i,n){this._pattern=(t=void 0!==e?{minFilter:t,magFilter:e,wrapS:i,wrapT:n}:t).wrapS===cc.REPEAT&&t.wrapT===cc.REPEAT?"repeat":t.wrapS===cc.REPEAT?"repeat-x":t.wrapT===cc.REPEAT?"repeat-y":""},setAntiAliasTexParameters:function(){},setAliasTexParameters:function(){},generateMipmap:function(){},stringForFormat:function(){return""},bitsPerPixelForFormat:function(t){return-1},addLoadedEventListener:function(t,e){this.addEventListener("load",t,e)},removeLoadedEventListener:function(t){this.removeEventTarget("load",t)},_generateColorTexture:function(){},_generateTextureCacheForColor:function(){if(this.channelCache)return this.channelCache;var t=[document.createElement("canvas"),document.createElement("canvas"),document.createElement("canvas"),document.createElement("canvas")],e=this._htmlElementObj,i=e.width,n=e.height;t[0].width=i,t[0].height=n,t[1].width=i,t[1].height=n,t[2].width=i,t[2].height=n,t[3].width=i,t[3].height=n,(s=t[3].getContext("2d")).drawImage(e,0,0);for(var s=s.getImageData(0,0,i,n).data,r=0;r<4;r++){for(var o,a=(o=t[r].getContext("2d")).getImageData(0,0,i,n),c=a.data,h=0;h<s.length;h+=4)c[h]=0===r?s[h]:0,c[h+1]=1===r?s[h+1]:0,c[h+2]=2===r?s[h+2]:0,c[h+3]=s[h+3];o.putImageData(a,0,0)}return e.onload=null,this.channelCache=t},_grayElementObj:null,_backupElement:null,_isGray:!1,_switchToGray:function(t){this._textureLoaded&&this._isGray!==t&&((this._isGray=t)?(this._backupElement=this._htmlElementObj,this._grayElementObj||(this._grayElementObj=cc.Texture2D._generateGrayTexture(this._htmlElementObj)),this._htmlElementObj=this._grayElementObj):null!==this._backupElement&&(this._htmlElementObj=this._backupElement))},_generateGrayTexture:function(){var t,e;return this._textureLoaded?(t=cc.Texture2D._generateGrayTexture(this._htmlElementObj),(e=new cc.Texture2D).initWithElement(t),e.handleLoadedTexture(),e):null}})._generateColorTexture=cc.sys._supportCanvasNewBlendModes?function(t,e,i,n,s){var r=!1,o=(s?r=!0:s=document.createElement("canvas"),this._htmlElementObj),a=(n=n||cc.rect(0,0,o.width,o.height),s.width=n.width,s.height=n.height,s.getContext("2d"));return a.globalCompositeOperation="source-over",a.fillStyle="rgb("+(0|t)+","+(0|e)+","+(0|i)+")",a.fillRect(0,0,n.width,n.height),a.globalCompositeOperation="multiply",a.drawImage(o,n.x,n.y,n.width,n.height,0,0,n.width,n.height),a.globalCompositeOperation="destination-atop",a.drawImage(o,n.x,n.y,n.width,n.height,0,0,n.width,n.height),r?s:((t=new cc.Texture2D).initWithElement(s),t.handleLoadedTexture(),t)}:function(t,e,i,n,s){var r,o,a=!1,c=(s?a=!0:s=document.createElement("canvas"),this._htmlElementObj),c=(n=n||cc.rect(0,0,c.width,c.height)).x,h=n.y,l=n.width;if(n=n.height,l&&n)return s.width=l,s.height=n,r=s.getContext("2d"),o=cc.textureCache.getTextureColors(this),r.globalCompositeOperation="lighter",r.drawImage(o[3],c,h,l,n,0,0,l,n),0<t&&(r.globalAlpha=t/255,r.drawImage(o[0],c,h,l,n,0,0,l,n)),0<e&&(r.globalAlpha=e/255,r.drawImage(o[1],c,h,l,n,0,0,l,n)),0<i&&(r.globalAlpha=i/255,r.drawImage(o[2],c,h,l,n,0,0,l,n)),a?s:((t=new cc.Texture2D).initWithElement(s),t.handleLoadedTexture(),t)},cc.Texture2D=cc.Class.extend(t),cc.Texture2D._generateGrayTexture=function(t,e,i){if(null===t)return null;i=i||document.createElement("canvas"),e=e||cc.rect(0,0,t.width,t.height),i.width=e.width,i.height=e.height;var n=i.getContext("2d");n.drawImage(t,e.x,e.y,e.width,e.height,0,0,e.width,e.height);for(var s=0,r=(e=(t=n.getImageData(0,0,e.width,e.height)).data).length;s<r;s+=4)e[s]=e[s+1]=e[s+2]=.34*e[s]+.5*e[s+1]+.16*e[s+2];return n.putImageData(t,0,0),i}):cc._renderType===cc.game.RENDER_TYPE_WEBGL&&(cc.assert(cc.isFunction(cc._tmp.WebGLTexture2D),cc._LogInfos.MissingFile,"TexturesWebGL.js"),cc._tmp.WebGLTexture2D(),delete cc._tmp.WebGLTexture2D),cc.EventHelper.prototype.apply(cc.Texture2D.prototype),cc.assert(cc.isFunction(cc._tmp.PrototypeTexture2D),cc._LogInfos.MissingFile,"TexturesPropertyDefine.js"),cc._tmp.PrototypeTexture2D(),delete cc._tmp.PrototypeTexture2D}),cc.textureCache={_textures:{},_textureColorsCache:{},_textureKeySeq:0|1e3*Math.random(),_loadedTexturesBefore:{},_initializingRenderer:function(){var t,e=this._loadedTexturesBefore,i=this._textures;for(t in e){var n=e[t];n.handleLoadedTexture(),i[t]=n}this._loadedTexturesBefore={}},addPVRTCImage:function(t){cc.log(cc._LogInfos.textureCache_addPVRTCImage)},addETCImage:function(t){cc.log(cc._LogInfos.textureCache_addETCImage)},description:function(){return"<TextureCache | Number of textures = "+this._textures.length+">"},textureForKey:function(t){return cc.log(cc._LogInfos.textureCache_textureForKey),this.getTextureForKey(t)},getTextureForKey:function(t){return this._textures[t]||this._textures[cc.loader._getAliase(t)]},getKeyByTexture:function(t){for(var e in this._textures)if(this._textures[e]===t)return e;return null},_generalTextureKey:function(t){return"_textureKey_"+t},getTextureColors:function(t){var e=t._htmlElementObj,i=(i=this.getKeyByTexture(e))||(e instanceof HTMLImageElement?e.src:this._generalTextureKey(t.__instanceId));return this._textureColorsCache[i]||(this._textureColorsCache[i]=t._generateTextureCacheForColor()),this._textureColorsCache[i]},addPVRImage:function(t){cc.log(cc._LogInfos.textureCache_addPVRImage)},removeAllTextures:function(){var t,e=this._textures;for(t in e)e[t]&&e[t].releaseTexture();this._textures={}},removeTexture:function(t){if(t){var e,i=this._textures;for(e in i)i[e]===t&&(i[e].releaseTexture(),delete i[e])}},removeTextureForKey:function(t){var e;null!=t&&(e=this._textures[t])&&(e.releaseTexture(),delete this._textures[t])},cacheImage:function(t,e){var i;e instanceof cc.Texture2D?this._textures[t]=e:((i=new cc.Texture2D).initWithElement(e),i.handleLoadedTexture(),this._textures[t]=i)},addUIImage:function(t,e){var i;return cc.assert(t,cc._LogInfos.textureCache_addUIImage_2),e&&this._textures[e]?this._textures[e]:((i=new cc.Texture2D).initWithImage(t),null!=e?this._textures[e]=i:cc.log(cc._LogInfos.textureCache_addUIImage),i)},dumpCachedTextureInfo:function(){var t,e,i,n=0,s=0,r=this._textures;for(t in r)n++,(e=r[t]).getHtmlElementObj()instanceof HTMLImageElement?cc.log(cc._LogInfos.textureCache_dumpCachedTextureInfo,t,e.getHtmlElementObj().src,e.getPixelsWide(),e.getPixelsHigh()):cc.log(cc._LogInfos.textureCache_dumpCachedTextureInfo_2,t,e.getPixelsWide(),e.getPixelsHigh()),s+=e.getPixelsWide()*e.getPixelsHigh()*4;for(t in r=this._textureColorsCache)for(i in e=r[t]){var o=e[i];n++,cc.log(cc._LogInfos.textureCache_dumpCachedTextureInfo_2,t,o.width,o.height),s+=o.width*o.height*4}cc.log(cc._LogInfos.textureCache_dumpCachedTextureInfo_3,n,s/1024,(s/1048576).toFixed(2))},_clear:function(){this._textures={},this._textureColorsCache={},this._textureKeySeq=0|1e3*Math.random(),this._loadedTexturesBefore={}}},cc.game.addEventListener(cc.game.EVENT_RENDERER_INITED,function(){var t;cc._renderType===cc.game.RENDER_TYPE_CANVAS?((t=cc.textureCache).handleLoadedTexture=function(t,e){var i=this._textures,n=i[t];return n||((n=i[t]=new cc.Texture2D).url=t),n.initWithElement(e),n.handleLoadedTexture(),n},t.addImage=function(i,n,s){cc.assert(i,cc._LogInfos.Texture2D_addImage);var t=this._textures,e=t[i]||t[cc.loader._getAliase(i)];return e?e.isLoaded()?n&&n.call(s,e):e.addEventListener("load",function(){n&&n.call(s,e)},s):((e=t[i]=new cc.Texture2D).url=i,t=cc.loader.getBasePath?cc.loader.getBasePath():cc.loader.resPath,cc.loader.loadImg(cc.path.join(t||"",i),function(t,e){if(t)return n&&n.call(s,t);t=cc.textureCache.handleLoadedTexture(i,e);n&&n.call(s,t)})),e},t.addImageAsync=t.addImage):cc._renderType===cc.game.RENDER_TYPE_WEBGL&&(cc.assert(cc.isFunction(cc._tmp.WebGLTextureCache),cc._LogInfos.MissingFile,"TexturesWebGL.js"),cc._tmp.WebGLTextureCache(),delete cc._tmp.WebGLTextureCache)}),cc.TextureAtlas=cc.Class.extend({dirty:!1,texture:null,_indices:null,_buffersVBO:null,_capacity:0,_quads:null,_quadsArrayBuffer:null,_quadsWebBuffer:null,_quadsReader:null,ctor:function(t,e){this._buffersVBO=[],cc.isString(t)?this.initWithFile(t,e):t instanceof cc.Texture2D&&this.initWithTexture(t,e)},getTotalQuads:function(){return this._totalQuads},getCapacity:function(){return this._capacity},getTexture:function(){return this.texture},setTexture:function(t){this.texture=t},setDirty:function(t){this.dirty=t},isDirty:function(){return this.dirty},getQuads:function(){return this._quads},setQuads:function(t){this._quads=t},_copyQuadsToTextureAtlas:function(t,e){if(t)for(var i=0;i<t.length;i++)this._setQuadToArray(t[i],e+i)},_setQuadToArray:function(t,e){var i=this._quads;i[e]?(i[e].bl=t.bl,i[e].br=t.br,i[e].tl=t.tl,i[e].tr=t.tr):i[e]=new cc.V3F_C4B_T2F_Quad(t.tl,t.bl,t.tr,t.br,this._quadsArrayBuffer,e*cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT)},description:function(){return"<cc.TextureAtlas | totalQuads ="+this._totalQuads+">"},_setupIndices:function(){if(0!==this._capacity)for(var t=this._indices,e=this._capacity,i=0;i<e;i++)cc.TEXTURE_ATLAS_USE_TRIANGLE_STRIP?(t[6*i+0]=4*i+0,t[6*i+1]=4*i+0,t[6*i+2]=4*i+2,t[6*i+3]=4*i+1,t[6*i+4]=4*i+3,t[6*i+5]=4*i+3):(t[6*i+0]=4*i+0,t[6*i+1]=4*i+1,t[6*i+2]=4*i+2,t[6*i+3]=4*i+3,t[6*i+4]=4*i+2,t[6*i+5]=4*i+1)},_setupVBO:function(){var t=cc._renderContext;this._buffersVBO[0]=t.createBuffer(),this._buffersVBO[1]=t.createBuffer(),this._quadsWebBuffer=t.createBuffer(),this._mapBuffers()},_mapBuffers:function(){var t=cc._renderContext;t.bindBuffer(t.ARRAY_BUFFER,this._quadsWebBuffer),t.bufferData(t.ARRAY_BUFFER,this._quadsArrayBuffer,t.DYNAMIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this._buffersVBO[1]),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this._indices,t.STATIC_DRAW)},initWithFile:function(t,e){var i=cc.textureCache.addImage(t);return i?this.initWithTexture(i,e):(cc.log(cc._LogInfos.TextureAtlas_initWithFile,t),!1)},initWithTexture:function(t,e){cc.assert(t,cc._LogInfos.TextureAtlas_initWithTexture),this._capacity=e|=0,this._totalQuads=0,this.texture=t,this._quads=[],this._indices=new Uint16Array(6*e);var i=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT;if(this._quadsArrayBuffer=new ArrayBuffer(i*e),this._quadsReader=new Uint8Array(this._quadsArrayBuffer),(!this._quads||!this._indices)&&0<e)return!1;for(var n=this._quads,s=0;s<e;s++)n[s]=new cc.V3F_C4B_T2F_Quad(null,null,null,null,this._quadsArrayBuffer,s*i);return this._setupIndices(),this._setupVBO(),this.dirty=!0},updateQuad:function(t,e){cc.assert(t,cc._LogInfos.TextureAtlas_updateQuad),cc.assert(0<=e&&e<this._capacity,cc._LogInfos.TextureAtlas_updateQuad_2),this._totalQuads=Math.max(e+1,this._totalQuads),this._setQuadToArray(t,e),this.dirty=!0},insertQuad:function(t,e){var i,n,s;cc.assert(e<this._capacity,cc._LogInfos.TextureAtlas_insertQuad_2),this._totalQuads++,this._totalQuads>this._capacity?cc.log(cc._LogInfos.TextureAtlas_insertQuad):(n=e*(i=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT),s=(this._totalQuads-1-e)*i,this._quads[this._totalQuads-1]=new cc.V3F_C4B_T2F_Quad(null,null,null,null,this._quadsArrayBuffer,(this._totalQuads-1)*i),this._quadsReader.set(this._quadsReader.subarray(n,n+s),n+i),this._setQuadToArray(t,e),this.dirty=!0)},insertQuads:function(t,e,i){i=i||t.length,cc.assert(e+i<=this._capacity,cc._LogInfos.TextureAtlas_insertQuads);var n=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT;if(this._totalQuads+=i,this._totalQuads>this._capacity)cc.log(cc._LogInfos.TextureAtlas_insertQuad);else{for(var s=e*n,r=(this._totalQuads-1-e-i)*n,o=this._totalQuads-1-i,a=0;a<i;a++)this._quads[o+a]=new cc.V3F_C4B_T2F_Quad(null,null,null,null,this._quadsArrayBuffer,(this._totalQuads-1)*n);for(this._quadsReader.set(this._quadsReader.subarray(s,s+r),s+n*i),a=0;a<i;a++)this._setQuadToArray(t[a],e+a);this.dirty=!0}},insertQuadFromIndex:function(t,e){var i,n,s,r;t!==e&&(cc.assert(0<=e||e<this._totalQuads,cc._LogInfos.TextureAtlas_insertQuadFromIndex),cc.assert(0<=t||t<this._totalQuads,cc._LogInfos.TextureAtlas_insertQuadFromIndex_2),i=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,s=(n=this._quadsReader).subarray(t*i,i),e<t?(n.set(n.subarray(r=e*i,r+(t-e)*i),r+i),n.set(s,r)):(n.set(n.subarray(r=(t+1)*i,r+(e-t)*i),r-i),n.set(s,e*i)),this.dirty=!0)},removeQuadAtIndex:function(t){cc.assert(t<this._totalQuads,cc._LogInfos.TextureAtlas_removeQuadAtIndex);var e,i=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT;this._totalQuads--,this._quads.length=this._totalQuads,t!==this._totalQuads&&this._quadsReader.set(this._quadsReader.subarray(e=(t+1)*i,e+(this._totalQuads-t)*i),e-i),this.dirty=!0},removeQuadsAtIndex:function(t,e){var i,n;cc.assert(t+e<=this._totalQuads,cc._LogInfos.TextureAtlas_removeQuadsAtIndex),this._totalQuads-=e,t!==this._totalQuads&&(n=t*(i=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT),this._quadsReader.set(this._quadsReader.subarray(e=(t+e)*i,e+(this._totalQuads-t)*i),n)),this.dirty=!0},removeAllQuads:function(){this._totalQuads=this._quads.length=0},_setDirty:function(t){this.dirty=t},resizeCapacity:function(t){if(t===this._capacity)return!0;var e=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,i=this._capacity,n=(this._totalQuads=Math.min(this._totalQuads,t),this._capacity=0|t),s=this._totalQuads;if(null===this._quads)for(this._quads=[],this._quadsArrayBuffer=new ArrayBuffer(e*n),this._quadsReader=new Uint8Array(this._quadsArrayBuffer),t=0;t<n;t++)this._quads=new cc.V3F_C4B_T2F_Quad(null,null,null,null,this._quadsArrayBuffer,t*e);else{var r,o,a=this._quads;if(i<n){for(r=[],o=new ArrayBuffer(e*n),t=0;t<s;t++)r[t]=new cc.V3F_C4B_T2F_Quad(a[t].tl,a[t].bl,a[t].tr,a[t].br,o,t*e);for(;t<n;t++)r[t]=new cc.V3F_C4B_T2F_Quad(null,null,null,null,o,t*e)}else for(s=Math.max(s,n),r=[],o=new ArrayBuffer(e*n),t=0;t<s;t++)r[t]=new cc.V3F_C4B_T2F_Quad(a[t].tl,a[t].bl,a[t].tr,a[t].br,o,t*e);this._quadsReader=new Uint8Array(o),this._quads=r,this._quadsArrayBuffer=o}return null===this._indices?this._indices=new Uint16Array(6*n):i<n?((e=new Uint16Array(6*n)).set(this._indices,0),this._indices=e):this._indices=this._indices.subarray(0,6*n),this._setupIndices(),this._mapBuffers(),this.dirty=!0},increaseTotalQuadsWith:function(t){this._totalQuads+=t},moveQuadsFromIndex:function(t,e,i){if(void 0===i){if(i=e,e=this._totalQuads-t,cc.assert(i+(this._totalQuads-t)<=this._capacity,cc._LogInfos.TextureAtlas_moveQuadsFromIndex),0===e)return}else if(cc.assert(i+e<=this._totalQuads,cc._LogInfos.TextureAtlas_moveQuadsFromIndex_2),cc.assert(t<this._totalQuads,cc._LogInfos.TextureAtlas_moveQuadsFromIndex_3),t===i)return;var n=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,s=t*n,r=e*n,o=this._quadsReader,a=o.subarray(s,s+r),c=i*n;i<t?o.set(o.subarray(e=i*n,e+(t-i)*n),e+r):o.set(o.subarray(e=(t+e)*n,e+(i-t)*n),s),o.set(a,c),this.dirty=!0},fillWithEmptyQuadsFromIndex:function(t,e){for(var i=e*cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,n=new Uint8Array(this._quadsArrayBuffer,t*cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,i),s=0;s<i;s++)n[s]=0},drawQuads:function(){this.drawNumberOfQuads(this._totalQuads,0)},_releaseBuffer:function(){var t=cc._renderContext;this._buffersVBO&&(this._buffersVBO[0]&&t.deleteBuffer(this._buffersVBO[0]),this._buffersVBO[1])&&t.deleteBuffer(this._buffersVBO[1]),this._quadsWebBuffer&&t.deleteBuffer(this._quadsWebBuffer)}}),_p=cc.TextureAtlas.prototype,cc.defineGetterSetter(_p,"totalQuads",_p.getTotalQuads),cc.defineGetterSetter(_p,"capacity",_p.getCapacity),cc.defineGetterSetter(_p,"quads",_p.getQuads,_p.setQuads),cc.TextureAtlas.create=function(t,e){return new cc.TextureAtlas(t,e)},cc.TextureAtlas.createWithTexture=cc.TextureAtlas.create,cc.game.addEventListener(cc.game.EVENT_RENDERER_INITED,function(){cc._renderType===cc.game.RENDER_TYPE_WEBGL&&(cc.assert(cc.isFunction(cc._tmp.WebGLTextureAtlas),cc._LogInfos.MissingFile,"TexturesWebGL.js"),cc._tmp.WebGLTextureAtlas(),delete cc._tmp.WebGLTextureAtlas)}),cc.assert(cc.isFunction(cc._tmp.PrototypeTextureAtlas),cc._LogInfos.MissingFile,"TexturesPropertyDefine.js"),cc._tmp.PrototypeTextureAtlas(),delete cc._tmp.PrototypeTextureAtlas,cc.Scene=cc.Node.extend({_className:"Scene",ctor:function(){cc.Node.prototype.ctor.call(this),this._ignoreAnchorPointForPosition=!0,this.setAnchorPoint(.5,.5),this.setContentSize(cc.director.getWinSize())}}),cc.Scene.create=function(){return new cc.Scene},cc.LoaderScene=cc.Scene.extend({_interval:null,_label:null,_logo:null,_className:"LoaderScene",cb:null,target:null,init:function(){var i=this,n=200,t=i._bgLayer=new cc.LayerColor(cc.color(32,32,32,255)),e=(i.addChild(t,0),24),s=-n/2+100;return cc._loaderImage&&(cc.loader.loadImg(cc._loaderImage,{isCrossOrigin:!1},function(t,e){n=e.height,i._initStage(e,cc.visibleRect.center)}),e=14,s=-n/2-10),(e=i._label=new cc.LabelTTF("Loading... 0%","Arial",e)).setPosition(cc.pAdd(cc.visibleRect.center,cc.p(0,s))),e.setColor(cc.color(180,180,180)),t.addChild(this._label,10),!0},_initStage:function(t,e){var i=this._texture2d=new cc.Texture2D;i.initWithElement(t),i.handleLoadedTexture(),(i=this._logo=new cc.Sprite(i)).setScale(cc.contentScaleFactor()),i.x=e.x,i.y=e.y,this._bgLayer.addChild(i,10)},onEnter:function(){cc.Node.prototype.onEnter.call(this),this.schedule(this._startLoading,.3)},onExit:function(){cc.Node.prototype.onExit.call(this),this._label.setString("Loading... 0%")},initWithResources:function(t,e,i){cc.isString(t)&&(t=[t]),this.resources=t||[],this.cb=e,this.target=i},_startLoading:function(){var n=this;n.unschedule(n._startLoading),cc.loader.load(n.resources,function(t,e,i){t=Math.min(i/e*100|0,100),n._label.setString("Loading... "+t+"%")},function(){n.cb&&n.cb.call(n.target)})},_updateTransform:function(){this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty),this._bgLayer._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty),this._label._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty),this._logo&&this._logo._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)}}),cc.LoaderScene.preload=function(t,e,i){var n=cc;return n.loaderScene||(n.loaderScene=new cc.LoaderScene,n.loaderScene.init(),cc.eventManager.addCustomListener(cc.Director.EVENT_PROJECTION_CHANGED,function(){n.loaderScene._updateTransform()})),n.loaderScene.initWithResources(t,e,i),cc.director.runScene(n.loaderScene),n.loaderScene},cc.Layer=cc.Node.extend({_className:"Layer",ctor:function(){cc.Node.prototype.ctor.call(this),this._ignoreAnchorPointForPosition=!0,this.setAnchorPoint(.5,.5),this.setContentSize(cc.winSize),this._cascadeOpacityEnabled=this._cascadeColorEnabled=!1},bake:function(){this._renderCmd.bake()},unbake:function(){this._renderCmd.unbake()},isBaked:function(){return this._renderCmd._isBaked},visit:function(t){var e=this._renderCmd,i=t?t._renderCmd:null;if(this._visible){if(t=cc.renderer,e.visit(i),e._isBaked)t.pushRenderCommand(e),e._bakeSprite.visit(this);else{var n,s=this._children,r=s.length;if(0<r){for(this._reorderChildDirty&&this.sortAllChildren(),i=0;i<r&&(n=s[i])._localZOrder<0;i++)n.visit(this);for(t.pushRenderCommand(e);i<r;i++)s[i].visit(this)}else t.pushRenderCommand(e)}e._dirtyFlag=0}else e._propagateFlagsDown(i)},addChild:function(t,e,i){cc.Node.prototype.addChild.call(this,t,e,i),this._renderCmd._bakeForAddChild(t)},_createRenderCmd:function(){return new(cc._renderType===cc.game.RENDER_TYPE_CANVAS?cc.Layer.CanvasRenderCmd:cc.Layer.WebGLRenderCmd)(this)}}),cc.Layer.create=function(){return new cc.Layer},cc.LayerColor=cc.Layer.extend({_blendFunc:null,_className:"LayerColor",getBlendFunc:function(){return this._blendFunc},changeWidthAndHeight:function(t,e){this.width=t,this.height=e},changeWidth:function(t){this.width=t},changeHeight:function(t){this.height=t},setOpacityModifyRGB:function(t){},isOpacityModifyRGB:function(){return!1},ctor:function(t,e,i){cc.Layer.prototype.ctor.call(this),this._blendFunc=cc.BlendFunc._alphaNonPremultiplied(),cc.LayerColor.prototype.init.call(this,t,e,i)},init:function(t,e,i){var n=cc.director.getWinSize();return t=t||cc.color(0,0,0,255),e=void 0===e?n.width:e,i=void 0===i?n.height:i,(n=this._realColor).r=t.r,n.g=t.g,n.b=t.b,this._realOpacity=t.a,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty|cc.Node._dirtyFlags.opacityDirty),cc.LayerColor.prototype.setContentSize.call(this,e,i),!0},visit:function(t){var e=this._renderCmd,i=t?t._renderCmd:null;if(this._visible){if(t=cc.renderer,e.visit(i),e._isBaked)t.pushRenderCommand(e._bakeRenderCmd),e._bakeSprite._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty),e._bakeSprite.visit(this);else{var n=this._children,s=n.length;if(0<s){for(this._reorderChildDirty&&this.sortAllChildren(),i=0;i<s&&(child=n[i])._localZOrder<0;i++)child.visit(this);for(t.pushRenderCommand(e);i<s;i++)n[i].visit(this)}else t.pushRenderCommand(e)}e._dirtyFlag=0}else e._propagateFlagsDown(i)},setBlendFunc:function(t,e){var i=this._blendFunc;void 0===e?(i.src=t.src,i.dst=t.dst):(i.src=t,i.dst=e),this._renderCmd.updateBlendFunc(i)},_createRenderCmd:function(){return new(cc._renderType===cc.game.RENDER_TYPE_CANVAS?cc.LayerColor.CanvasRenderCmd:cc.LayerColor.WebGLRenderCmd)(this)}}),cc.LayerColor.create=function(t,e,i){return new cc.LayerColor(t,e,i)},!function(){var t=cc.LayerColor.prototype;cc.defineGetterSetter(t,"width",t._getWidth,t._setWidth),cc.defineGetterSetter(t,"height",t._getHeight,t._setHeight)}(),cc.LayerGradient=cc.LayerColor.extend({_endColor:null,_startOpacity:255,_endOpacity:255,_alongVector:null,_compressedInterpolation:!1,_className:"LayerGradient",_colorStops:[],ctor:function(t,e,i,n){cc.LayerColor.prototype.ctor.call(this),this._endColor=cc.color(0,0,0,255),this._alongVector=cc.p(0,-1),this._endOpacity=this._startOpacity=255,n&&n instanceof Array?((this._colorStops=n).splice(0,0,{p:0,color:t||cc.color.BLACK}),n.push({p:1,color:e||cc.color.BLACK})):this._colorStops=[{p:0,color:t||cc.color.BLACK},{p:1,color:e||cc.color.BLACK}],cc.LayerGradient.prototype.init.call(this,t,e,i,n)},init:function(t,e,i,n){return t=t||cc.color(0,0,0,255),e=e||cc.color(0,0,0,255),i=i||cc.p(0,-1),n=this._endColor,this._startOpacity=t.a,n.r=e.r,n.g=e.g,n.b=e.b,this._endOpacity=e.a,this._alongVector=i,this._compressedInterpolation=!0,cc.LayerColor.prototype.init.call(this,cc.color(t.r,t.g,t.b,255)),this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty|cc.Node._dirtyFlags.opacityDirty|cc.Node._dirtyFlags.gradientDirty),!0},setContentSize:function(t,e){cc.LayerColor.prototype.setContentSize.call(this,t,e),this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.gradientDirty)},_setWidth:function(t){cc.LayerColor.prototype._setWidth.call(this,t),this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.gradientDirty)},_setHeight:function(t){cc.LayerColor.prototype._setHeight.call(this,t),this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.gradientDirty)},getStartColor:function(){return cc.color(this._realColor)},setStartColor:function(t){this.color=t;var e=this._colorStops;e&&0<e.length&&((e=e[0].color).r=t.r,e.g=t.g,e.b=t.b)},setEndColor:function(t){var e=this._endColor;e.r=t.r,e.g=t.g,e.b=t.b,(e=this._colorStops)&&0<e.length&&((e=e[e.length-1].color).r=t.r,e.g=t.g,e.b=t.b),this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty)},getEndColor:function(){return cc.color(this._endColor)},setStartOpacity:function(t){this._startOpacity=t;var e=this._colorStops;e&&0<e.length&&(e[0].color.a=t),this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.opacityDirty)},getStartOpacity:function(){return this._startOpacity},setEndOpacity:function(t){this._endOpacity=t;var e=this._colorStops;e&&0<e.length&&(e[e.length-1].color.a=t),this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.opacityDirty)},getEndOpacity:function(){return this._endOpacity},setVector:function(t){this._alongVector.x=t.x,this._alongVector.y=t.y,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.gradientDirty)},getVector:function(){return cc.p(this._alongVector.x,this._alongVector.y)},isCompressedInterpolation:function(){return this._compressedInterpolation},setCompressedInterpolation:function(t){this._compressedInterpolation=t,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.gradientDirty)},getColorStops:function(){return this._colorStops},setColorStops:function(t){this._colorStops=t,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty|cc.Node._dirtyFlags.opacityDirty|cc.Node._dirtyFlags.gradientDirty)},_createRenderCmd:function(){return new(cc._renderType===cc.game.RENDER_TYPE_CANVAS?cc.LayerGradient.CanvasRenderCmd:cc.LayerGradient.WebGLRenderCmd)(this)}}),cc.LayerGradient.create=function(t,e,i,n){return new cc.LayerGradient(t,e,i,n)},!function(){var t=cc.LayerGradient.prototype;cc.defineGetterSetter(t,"startColor",t.getStartColor,t.setStartColor),cc.defineGetterSetter(t,"endColor",t.getEndColor,t.setEndColor),cc.defineGetterSetter(t,"startOpacity",t.getStartOpacity,t.setStartOpacity),cc.defineGetterSetter(t,"endOpacity",t.getEndOpacity,t.setEndOpacity),cc.defineGetterSetter(t,"vector",t.getVector,t.setVector),cc.defineGetterSetter(t,"colorStops",t.getColorStops,t.setColorStops)}(),cc.LayerMultiplex=cc.Layer.extend({_enabledLayer:0,_layers:null,_className:"LayerMultiplex",ctor:function(t){cc.Layer.prototype.ctor.call(this),t instanceof Array?cc.LayerMultiplex.prototype.initWithLayers.call(this,t):cc.LayerMultiplex.prototype.initWithLayers.call(this,Array.prototype.slice.call(arguments))},initWithLayers:function(t){return 0<t.length&&null==t[t.length-1]&&cc.log(cc._LogInfos.LayerMultiplex_initWithLayers),this._layers=t,this._enabledLayer=0,this.addChild(this._layers[this._enabledLayer]),!0},switchTo:function(t){t>=this._layers.length?cc.log(cc._LogInfos.LayerMultiplex_switchTo):(this.removeChild(this._layers[this._enabledLayer],!0),this._enabledLayer=t,this.addChild(this._layers[t]))},switchToAndReleaseMe:function(t){t>=this._layers.length?cc.log(cc._LogInfos.LayerMultiplex_switchToAndReleaseMe):(this.removeChild(this._layers[this._enabledLayer],!0),this._layers[this._enabledLayer]=null,this._enabledLayer=t,this.addChild(this._layers[t]))},addLayer:function(t){t?this._layers.push(t):cc.log(cc._LogInfos.LayerMultiplex_addLayer)}}),cc.LayerMultiplex.create=function(){return new cc.LayerMultiplex(Array.prototype.slice.call(arguments))},!function(){cc.Layer.CanvasRenderCmd=function(t){this._rootCtor(t),this._isBaked=!1,this._bakeSprite=null,this._canUseDirtyRegion=!0,this._updateCache=2};var t=cc.Layer.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);t.constructor=cc.Layer.CanvasRenderCmd,t._layerCmdCtor=cc.Layer.CanvasRenderCmd,t._setCacheDirty=function(t){t&&0===this._updateCache&&(this._updateCache=2),!1===this._cacheDirty&&(this._cacheDirty=!0,t=this._cachedParent)&&t!==this&&t._setNodeDirtyForCache&&t._setNodeDirtyForCache()},t.updateStatus=function(){var t=cc.Node._dirtyFlags;this._dirtyFlag&t.orderDirty&&(this._cacheDirty=!0,0===this._updateCache&&(this._updateCache=2),this._dirtyFlag&=~t.orderDirty),this.originUpdateStatus()},t._syncStatus=function(t){var e=cc.Node._dirtyFlags,i=this._dirtyFlag;(this._isBaked||i&e.orderDirty)&&(this._cacheDirty=!0,0===this._updateCache&&(this._updateCache=2),this._dirtyFlag&=~e.orderDirty),this._originSyncStatus(t)},t.transform=function(t,e){this._worldTransform||(this._worldTransform={a:1,b:0,c:0,d:1,tx:0,ty:0});var i=this._worldTransform,n=i.a,s=i.b,r=i.c,o=i.d;this.originTransform(t,e),i.a===n&&i.b===s&&i.c===r&&i.d===o||0!==this._updateCache||(this._updateCache=2)},t.bake=function(){if(!this._isBaked){this._needDraw=!0,this._isBaked=this._cacheDirty=cc.renderer.childrenOrderDirty=!0,0===this._updateCache&&(this._updateCache=2);for(var t=this._node._children,e=0,i=t.length;e<i;e++)t[e]._renderCmd._setCachedParent(this);this._bakeSprite||(this._bakeSprite=new cc.BakeSprite,this._bakeSprite.setAnchorPoint(0,0))}},t.unbake=function(){if(this._isBaked){cc.renderer.childrenOrderDirty=!0,this._isBaked=this._needDraw=!1,this._cacheDirty=!0,0===this._updateCache&&(this._updateCache=2);for(var t=this._node._children,e=0,i=t.length;e<i;e++)t[e]._renderCmd._setCachedParent(null)}},t.isBaked=function(){return this._isBaked},t.rendering=function(){if(this._cacheDirty){var t=this._node,e=t._children,i=this._bakeSprite,n=(this.transform(this.getParentRenderCmd(),!0),this._getBoundingBoxForBake()),s=(n.width=0|n.width+.5,n.height=0|n.height+.5,i.getCacheContext()),r=s.getContext();if(i.setPosition(n.x,n.y),0<this._updateCache){for(i.resetCanvasSize(n.width,n.height),s.setOffset(0-n.x,r.canvas.height-n.height+n.y),t.sortAllChildren(),cc.renderer._turnToCacheMode(this.__instanceId),t=0,n=e.length;t<n;t++)e[t].visit(this);cc.renderer._renderingToCacheCanvas(s,this.__instanceId),i.transform(),this._updateCache--}this._cacheDirty=!1}},t._bakeForAddChild=function(t){t._parent===this._node&&this._isBaked&&t._renderCmd._setCachedParent(this)},t._getBoundingBoxForBake=function(){var t=null,e=this._node;if(!e._children||0===e._children.length)return cc.rect(0,0,10,10);for(var i=e.getNodeToWorldTransform(),n=0,s=(e=e._children).length;n<s;n++){var r=e[n];r&&r._visible&&(t?(r=r._getBoundingBoxToCurrentNode(i))&&(t=cc.rectUnion(t,r)):t=r._getBoundingBoxToCurrentNode(i))}return t}}(),!function(){cc.LayerColor.CanvasRenderCmd=function(t){this._layerCmdCtor(t),this._needDraw=!0,this._blendFuncStr="source-over",this._bakeRenderCmd=new cc.CustomRenderCmd(this,this._bakeRendering)};var t=cc.LayerColor.CanvasRenderCmd.prototype=Object.create(cc.Layer.CanvasRenderCmd.prototype);t.constructor=cc.LayerColor.CanvasRenderCmd,t.unbake=function(){cc.Layer.CanvasRenderCmd.prototype.unbake.call(this),this._needDraw=!0},t.rendering=function(t,e,i){var n=(t=t||cc._renderContext).getContext(),s=this._node,r=this._displayedColor,o=this._displayedOpacity/255,a=s._contentSize.width,s=s._contentSize.height;0!=o&&(t.setCompositeOperation(this._blendFuncStr),t.setGlobalAlpha(o),t.setFillStyle("rgba("+(0|r.r)+","+(0|r.g)+","+(0|r.b)+", 1)"),t.setTransform(this._worldTransform,e,i),n.fillRect(0,0,a,-s),cc.g_NumberOfDraws++)},t.updateBlendFunc=function(t){this._blendFuncStr=cc.Node.CanvasRenderCmd._getCompositeOperationByBlendFunc(t)},t._updateSquareVertices=t._updateSquareVerticesWidth=t._updateSquareVerticesHeight=function(){},t._bakeRendering=function(){if(this._cacheDirty){var t,e=this._node,i=this._bakeSprite,n=e._children,s=n.length,r=(this.transform(this.getParentRenderCmd(),!0),(t=this._getBoundingBoxForBake()).width=0|t.width+.5,t.height=0|t.height+.5,i.getCacheContext()),o=r.getContext();if(i.setPosition(t.x,t.y),0<this._updateCache){if(o.fillStyle=r._currentFillStyle,i.resetCanvasSize(t.width,t.height),r.setOffset(0-t.x,o.canvas.height-t.height+t.y),cc.renderer._turnToCacheMode(this.__instanceId),0<s){for(e.sortAllChildren(),t=0;t<s&&(o=n[t])._localZOrder<0;t++)o.visit(e);for(cc.renderer.pushRenderCommand(this);t<s;t++)n[t].visit(e)}else cc.renderer.pushRenderCommand(this);cc.renderer._renderingToCacheCanvas(r,this.__instanceId),i.transform(),this._updateCache--}this._cacheDirty=!1}},t._getBoundingBoxForBake=function(){var t=this._node,e=cc.rect(0,0,t._contentSize.width,t._contentSize.height),i=t.getNodeToWorldTransform(),e=cc.rectApplyAffineTransform(e,t.getNodeToWorldTransform());if(t._children&&0!==t._children.length)for(var t=t._children,n=0;n<t.length;n++){var s=t[n];s&&s._visible&&(s=s._getBoundingBoxToCurrentNode(i),e=cc.rectUnion(e,s))}return e}}(),!function(){cc.LayerGradient.CanvasRenderCmd=function(t){cc.LayerColor.CanvasRenderCmd.call(this,t),this._needDraw=!0,this._startPoint=cc.p(0,0),this._endPoint=cc.p(0,0),this._endStopStr=this._startStopStr=null};var t=cc.LayerGradient.CanvasRenderCmd.prototype=Object.create(cc.LayerColor.CanvasRenderCmd.prototype);t.constructor=cc.LayerGradient.CanvasRenderCmd,t.rendering=function(t,e,i){var n=(t=t||cc._renderContext).getContext(),s=this._node,r=this._displayedOpacity/255;if(0!==r){var o=s._contentSize.width,a=s._contentSize.height;if(t.setCompositeOperation(this._blendFuncStr),t.setGlobalAlpha(r),r=n.createLinearGradient(this._startPoint.x,this._startPoint.y,this._endPoint.x,this._endPoint.y),s._colorStops)for(var c=0;c<s._colorStops.length;c++)r.addColorStop(s._colorStops[c].p,this._colorStopsStr[c]);else r.addColorStop(0,this._startStopStr),r.addColorStop(1,this._endStopStr);t.setFillStyle(r),t.setTransform(this._worldTransform,e,i),n.fillRect(0,0,o,-a),cc.g_NumberOfDraws++}},t.updateStatus=function(){var t=cc.Node._dirtyFlags;this._dirtyFlag&t.gradientDirty&&(this._dirtyFlag|=t.colorDirty,this._dirtyFlag&=~t.gradientDirty),this.originUpdateStatus()},t._syncStatus=function(t){var e=cc.Node._dirtyFlags;this._dirtyFlag&e.gradientDirty&&(this._dirtyFlag|=e.colorDirty,this._dirtyFlag&=~e.gradientDirty),this._originSyncStatus(t)},t._updateColor=function(){var t=this._node,e=.5*(i=t._contentSize).width,i=.5*i.height,n=cc.pAngleSigned(cc.p(0,-1),t._alongVector),n=cc.pRotateByAngle(cc.p(0,-1),cc.p(0,0),n),s=Math.min(Math.abs(1/n.x),Math.abs(1/n.y));if(this._startPoint.x=e*-n.x*s+e,this._startPoint.y=i*n.y*s-i,this._endPoint.x=e*n.x*s+e,this._endPoint.y=i*-n.y*s-i,e=this._displayedColor,i=t._endColor,n=t._startOpacity/255,s=t._endOpacity/255,this._startStopStr="rgba("+Math.round(e.r)+","+Math.round(e.g)+","+Math.round(e.b)+","+n.toFixed(4)+")",this._endStopStr="rgba("+Math.round(i.r)+","+Math.round(i.g)+","+Math.round(i.b)+","+s.toFixed(4)+")",t._colorStops)for(this._endOpacity=this._startOpacity=0,this._colorStopsStr=[],e=0;e<t._colorStops.length;e++)n=null==(i=t._colorStops[e].color).a?1:i.a/255,this._colorStopsStr.push("rgba("+Math.round(i.r)+","+Math.round(i.g)+","+Math.round(i.b)+","+n.toFixed(4)+")")}}(),!function(){cc.Layer.WebGLRenderCmd=function(t){this._rootCtor(t),this._isBaked=!1};var t=cc.Layer.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype);t.constructor=cc.Layer.WebGLRenderCmd,t._layerCmdCtor=cc.Layer.WebGLRenderCmd,t.bake=function(){},t.unbake=function(){},t._bakeForAddChild=function(){}}(),!function(){cc.LayerColor.WebGLRenderCmd=function(t){this._layerCmdCtor(t),this._needDraw=!0,this._matrix=null,this.initData(4),this._color=new Uint32Array(1),this._vertexBuffer=null,this._shaderProgram=cc.shaderCache.programForKey(cc.SHADER_POSITION_COLOR)};var t=cc.LayerColor.WebGLRenderCmd.prototype=Object.create(cc.Layer.WebGLRenderCmd.prototype);t.constructor=cc.LayerColor.WebGLRenderCmd,t.initData=function(t){this._data=new ArrayBuffer(16*t),this._positionView=new Float32Array(this._data),this._colorView=new Uint32Array(this._data),this._dataDirty=!0},t.transform=function(t,e){this.originTransform(t,e);var t=this._node,e=t._contentSize.width,i=t._contentSize.height,n=this._positionView;n[4]=e,n[9]=i,n[12]=e,n[13]=i,n[2].z=n[6]=n[10]=n[14]=t._vertexZ,this._dataDirty=!0},t._updateColor=function(){var t=this._displayedColor;this._color[0]=this._displayedOpacity<<24|t.b<<16|t.g<<8|t.r;for(var t=this._colorView,e=0;e<4;e++)t[4*e+3]=this._color[0];this._dataDirty=!0},t.rendering=function(t){t=t||cc._renderContext;var e=this._node,i=(this._matrix||(this._matrix=new cc.math.Matrix4,this._matrix.identity()),this._worldTransform);this._matrix.mat[0]=i.a,this._matrix.mat[4]=i.c,this._matrix.mat[12]=i.tx,this._matrix.mat[1]=i.b,this._matrix.mat[5]=i.d,this._matrix.mat[13]=i.ty,this._dataDirty&&(this._vertexBuffer||(this._vertexBuffer=t.createBuffer()),t.bindBuffer(t.ARRAY_BUFFER,this._vertexBuffer),t.bufferData(t.ARRAY_BUFFER,this._data,t.DYNAMIC_DRAW),this._dataDirty=!1),this._glProgramState.apply(this._matrix),cc.glBlendFunc(e._blendFunc.src,e._blendFunc.dst),t.bindBuffer(t.ARRAY_BUFFER,this._vertexBuffer),t.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),t.enableVertexAttribArray(cc.VERTEX_ATTRIB_COLOR),t.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,3,t.FLOAT,!1,16,0),t.vertexAttribPointer(cc.VERTEX_ATTRIB_COLOR,4,t.UNSIGNED_BYTE,!0,16,12),t.drawArrays(t.TRIANGLE_STRIP,0,4)},t.updateBlendFunc=function(t){}}(),!function(){cc.LayerGradient.WebGLRenderCmd=function(t){cc.LayerColor.WebGLRenderCmd.call(this,t),this._needDraw=!0,this._clipRect=new cc.Rect,this._clippingRectDirty=!1};var t=cc.LayerGradient.WebGLRenderCmd.prototype=Object.create(cc.LayerColor.WebGLRenderCmd.prototype);t.constructor=cc.LayerGradient.WebGLRenderCmd,t.updateStatus=function(){var t=cc.Node._dirtyFlags;this._dirtyFlag&t.gradientDirty&&(this._dirtyFlag|=t.colorDirty,this._updateVertex(),this._dirtyFlag&=~t.gradientDirty),this.originUpdateStatus()},t._syncStatus=function(t){var e=cc.Node._dirtyFlags;this._dirtyFlag&e.gradientDirty&&(this._dirtyFlag|=e.colorDirty,this._updateVertex(),this._dirtyFlag&=~e.gradientDirty),this._originSyncStatus(t)},t.transform=function(t,e){this.originTransform(t,e),this._updateVertex()},t._updateVertex=function(){var t=this._node,e=t._colorStops;if(e&&!(e.length<2)){this._clippingRectDirty=!0;var i=e.length,n=t._contentSize,s=(this._positionView.length/4<(r=2*i)&&this.initData(r),Math.PI+cc.pAngleSigned(cc.p(0,-1),t._alongVector)),r=cc.p(n.width/2,n.height/2),o=Math.round(cc.radiansToDegrees(s)),a=cc.affineTransformMake(1,0,0,1,r.x,r.y),a=cc.affineTransformRotate(a,s),c=(o=o<90?(h=cc.p(-r.x,r.y),cc.p(r.x,r.y)):o<180?(h=cc.p(r.x,r.y),cc.p(r.x,-r.y)):o<270?(h=cc.p(r.x,-r.y),cc.p(-r.x,-r.y)):(h=cc.p(-r.x,-r.y),cc.p(-r.x,r.y)),Math.sin(s)),s=Math.cos(s);for(h=Math.abs((h.x*s-h.y*c)/r.x),o=Math.abs((o.x*c+o.y*s)/r.y),a=cc.affineTransformScale(a,h,o),c=this._positionView,o=0;o<i;o++){var h=e[o].p*n.height,l=cc.pointApplyAffineTransform(-r.x,h-r.y,a);c[s=8*o]=l.x,c[1+s]=l.y,c[2+s]=t._vertexZ,h=cc.pointApplyAffineTransform(n.width-r.x,h-r.y,a),c[s+=4]=h.x,c[1+s]=h.y,c[2+s]=t._vertexZ}this._dataDirty=!0}},t._updateColor=function(){var t=this._node._colorStops;if(t&&!(t.length<2)){var e,n=t.length,s=this._colorView,r=this._displayedOpacity/255;for(i=0;i<n;i++)e=t[i].color,this._color[0]=e.a*r<<24|e.b<<16|e.g<<8|e.r,s[3+(e=8*i)]=this._color[0],s[3+(e+=4)]=this._color[0];this._dataDirty=!0}},t.rendering=function(t){t=t||cc._renderContext;var e=this._node,i=(this._matrix||(this._matrix=new cc.math.Matrix4,this._matrix.identity()),this._getClippingRect());t.enable(t.SCISSOR_TEST),cc.view.setScissorInPoints(i.x,i.y,i.width,i.height),i=this._worldTransform,this._matrix.mat[0]=i.a,this._matrix.mat[4]=i.c,this._matrix.mat[12]=i.tx,this._matrix.mat[1]=i.b,this._matrix.mat[5]=i.d,this._matrix.mat[13]=i.ty,this._dataDirty&&(this._vertexBuffer||(this._vertexBuffer=gl.createBuffer()),gl.bindBuffer(gl.ARRAY_BUFFER,this._vertexBuffer),gl.bufferData(gl.ARRAY_BUFFER,this._data,gl.DYNAMIC_DRAW),this._dataDirty=!1),this._glProgramState.apply(this._matrix),cc.glBlendFunc(e._blendFunc.src,e._blendFunc.dst),gl.bindBuffer(gl.ARRAY_BUFFER,this._vertexBuffer),gl.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),gl.enableVertexAttribArray(cc.VERTEX_ATTRIB_COLOR),gl.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,3,gl.FLOAT,!1,16,0),gl.vertexAttribPointer(cc.VERTEX_ATTRIB_COLOR,4,gl.UNSIGNED_BYTE,!0,16,12),gl.drawArrays(gl.TRIANGLE_STRIP,0,4),t.disable(t.SCISSOR_TEST)},t._getClippingRect=function(){var t,e;return this._clippingRectDirty&&(e=this._node,t=cc.rect(0,0,e._contentSize.width,e._contentSize.height),e=e.getNodeToWorldTransform(),this._clipRect=cc._rectApplyAffineTransformIn(t,e)),this._clipRect}}(),cc._tmp.PrototypeSprite=function(){var t=cc.Sprite.prototype;cc.defineGetterSetter(t,"opacityModifyRGB",t.isOpacityModifyRGB,t.setOpacityModifyRGB),cc.defineGetterSetter(t,"opacity",t.getOpacity,t.setOpacity),cc.defineGetterSetter(t,"color",t.getColor,t.setColor),cc.defineGetterSetter(t,"flippedX",t.isFlippedX,t.setFlippedX),cc.defineGetterSetter(t,"flippedY",t.isFlippedY,t.setFlippedY),cc.defineGetterSetter(t,"offsetX",t._getOffsetX),cc.defineGetterSetter(t,"offsetY",t._getOffsetY),cc.defineGetterSetter(t,"texture",t.getTexture,t.setTexture),cc.defineGetterSetter(t,"textureRectRotated",t.isTextureRectRotated),cc.defineGetterSetter(t,"batchNode",t.getBatchNode,t.setBatchNode),cc.defineGetterSetter(t,"quad",t.getQuad)},cc.Sprite=cc.Node.extend({dirty:!1,atlasIndex:0,textureAtlas:null,_batchNode:null,_recursiveDirty:null,_hasChildren:null,_shouldBeHidden:!1,_transformToBatch:null,_blendFunc:null,_texture:null,_rect:null,_rectRotated:!1,_offsetPosition:null,_unflippedOffsetPositionFromCenter:null,_opacityModifyRGB:!1,_flippedX:!1,_flippedY:!1,_textureLoaded:!1,_className:"Sprite",ctor:function(t,e,i){cc.Node.prototype.ctor.call(this),this.setAnchorPoint(.5,.5),this._loader=new cc.Sprite.LoadManager,this._shouldBeHidden=!1,this._offsetPosition=cc.p(0,0),this._unflippedOffsetPositionFromCenter=cc.p(0,0),this._blendFunc={src:cc.BLEND_SRC,dst:cc.BLEND_DST},this._rect=cc.rect(0,0,0,0),this._softInit(t,e,i)},textureLoaded:function(){return this._textureLoaded},addLoadedEventListener:function(t,e){this.addEventListener("load",t,e)},isDirty:function(){return this.dirty},setDirty:function(t){this.dirty=t},isTextureRectRotated:function(){return this._rectRotated},getAtlasIndex:function(){return this.atlasIndex},setAtlasIndex:function(t){this.atlasIndex=t},getTextureRect:function(){return cc.rect(this._rect)},getTextureAtlas:function(){return this.textureAtlas},setTextureAtlas:function(t){this.textureAtlas=t},getOffsetPosition:function(){return cc.p(this._offsetPosition)},_getOffsetX:function(){return this._offsetPosition.x},_getOffsetY:function(){return this._offsetPosition.y},getBlendFunc:function(){return this._blendFunc},initWithSpriteFrame:function(t){return cc.assert(t,cc._LogInfos.Sprite_initWithSpriteFrame),this.setSpriteFrame(t)},initWithSpriteFrameName:function(t){cc.assert(t,cc._LogInfos.Sprite_initWithSpriteFrameName);var e=cc.spriteFrameCache.getSpriteFrame(t);return cc.assert(e,t+cc._LogInfos.Sprite_initWithSpriteFrameName1),this.initWithSpriteFrame(e)},useBatchNode:function(t){},setVertexRect:function(t){var e=this._rect;e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},setFlippedX:function(t){this._flippedX!==t&&(this._flippedX=t,this.setTextureRect(this._rect,this._rectRotated,this._contentSize),this.setNodeDirty(!0))},setFlippedY:function(t){this._flippedY!==t&&(this._flippedY=t,this.setTextureRect(this._rect,this._rectRotated,this._contentSize),this.setNodeDirty(!0))},isFlippedX:function(){return this._flippedX},isFlippedY:function(){return this._flippedY},setOpacityModifyRGB:function(t){this._opacityModifyRGB!==t&&(this._opacityModifyRGB=t,this._renderCmd._setColorDirty())},isOpacityModifyRGB:function(){return this._opacityModifyRGB},setDisplayFrameWithAnimationName:function(t,e){cc.assert(t,cc._LogInfos.Sprite_setDisplayFrameWithAnimationName_3);t=cc.animationCache.getAnimation(t);t?(t=t.getFrames()[e])?this.setSpriteFrame(t.getSpriteFrame()):cc.log(cc._LogInfos.Sprite_setDisplayFrameWithAnimationName_2):cc.log(cc._LogInfos.Sprite_setDisplayFrameWithAnimationName)},getBatchNode:function(){return this._batchNode},getTexture:function(){return this._texture},_softInit:function(t,e,i){void 0===t?cc.Sprite.prototype.init.call(this):"string"==typeof t?"#"===t[0]?(e=t.substr(1,t.length-1),(e=cc.spriteFrameCache.getSpriteFrame(e))?this.initWithSpriteFrame(e):cc.log("%s does not exist",t)):cc.Sprite.prototype.init.call(this,t,e):"object"==typeof t&&(t instanceof cc.Texture2D?this.initWithTexture(t,e,i):t instanceof cc.SpriteFrame?this.initWithSpriteFrame(t):(t instanceof HTMLImageElement||t instanceof HTMLCanvasElement)&&((e=new cc.Texture2D).initWithElement(t),e.handleLoadedTexture(),this.initWithTexture(e)))},getQuad:function(){return null},setBlendFunc:function(t,e){var i=this._blendFunc;void 0===e?(i.src=t.src,i.dst=t.dst):(i.src=t,i.dst=e),this._renderCmd.updateBlendFunc(i)},init:function(){return 0<arguments.length?this.initWithFile(arguments[0],arguments[1]):(cc.Node.prototype.init.call(this),this.dirty=this._recursiveDirty=!1,this._blendFunc.src=cc.BLEND_SRC,this._blendFunc.dst=cc.BLEND_DST,this.texture=null,this._flippedX=this._flippedY=!1,this.anchorY=this.anchorX=.5,this._offsetPosition.x=0,this._offsetPosition.y=0,this._hasChildren=!1,this.setTextureRect(cc.rect(0,0,0,0),!1,cc.size(0,0)),!0)},initWithFile:function(t,e){cc.assert(t,cc._LogInfos.Sprite_initWithFile);var i,n=cc.textureCache.getTextureForKey(t);return(n=n||cc.textureCache.addImage(t)).isLoaded()?(e||(i=n.getContentSize(),e=cc.rect(0,0,i.width,i.height)),this.initWithTexture(n,e)):(this._loader.clear(),this._loader.once(n,function(){this.initWithFile(t,e),this.dispatchEvent("load")},this),!1)},initWithTexture:function(t,e,i,n){return cc.assert(0!==arguments.length,cc._LogInfos.CCSpriteBatchNode_initWithTexture),this._loader.clear(),this._textureLoaded=t.isLoaded(),this._textureLoaded?(i=i||!1,t=this._renderCmd._handleTextureForRotatedTexture(t,e,i,n),!!cc.Node.prototype.init.call(this)&&(this._batchNode=null,this.dirty=this._recursiveDirty=!1,this._opacityModifyRGB=!0,this._blendFunc.src=cc.BLEND_SRC,this._blendFunc.dst=cc.BLEND_DST,this._flippedX=this._flippedY=!1,this._offsetPosition.x=0,this._offsetPosition.y=0,this._hasChildren=!1,this._rectRotated=i,e&&(this._rect.x=e.x,this._rect.y=e.y,this._rect.width=e.width,this._rect.height=e.height),e=e||cc.rect(0,0,t.width,t.height),this._renderCmd._checkTextureBoundary(t,e,i),this.setTexture(t),this.setTextureRect(e,i),this.setBatchNode(null),!0)):(this._loader.once(t,function(){this.initWithTexture(t,e,i,n),this.dispatchEvent("load")},this),!1)},setTextureRect:function(t,e,i,n){this._rectRotated=e||!1,this.setContentSize(i||t),this.setVertexRect(t),this._renderCmd._setTextureCoords(t,n),t=this._unflippedOffsetPositionFromCenter.x,e=this._unflippedOffsetPositionFromCenter.y,this._flippedX&&(t=-t),this._flippedY&&(e=-e),i=this._rect,this._offsetPosition.x=t+(this._contentSize.width-i.width)/2,this._offsetPosition.y=e+(this._contentSize.height-i.height)/2},addChild:function(t,e,i){cc.assert(t,cc._LogInfos.CCSpriteBatchNode_addChild_2),null==e&&(e=t._localZOrder),null==i&&(i=t.tag),this._renderCmd._setBatchNodeForAddChild(t)&&(cc.Node.prototype.addChild.call(this,t,e,i),this._hasChildren=!0)},setSpriteFrame:function(t){"string"==typeof t&&(t=cc.spriteFrameCache.getSpriteFrame(t),cc.assert(t,cc._LogInfos.Sprite_setSpriteFrame)),this._loader.clear(),this.setNodeDirty(!0);var e=t.getTexture();if(this._textureLoaded=t.textureLoaded(),this._loader.clear(),!this._textureLoaded)return this._loader.once(e,function(){this.setSpriteFrame(t),this.dispatchEvent("load")},this),!1;var i=t.getOffset();this._unflippedOffsetPositionFromCenter.x=i.x,this._unflippedOffsetPositionFromCenter.y=i.y,e!==this._texture&&(this._renderCmd._setTexture(e),this.setColor(this._realColor)),this.setTextureRect(t.getRect(),t.isRotated(),t.getOriginalSize())},setDisplayFrame:function(t){cc.log(cc._LogInfos.Sprite_setDisplayFrame),this.setSpriteFrame(t)},isFrameDisplayed:function(t){return this._renderCmd.isFrameDisplayed(t)},displayFrame:function(){return this.getSpriteFrame()},getSpriteFrame:function(){return new cc.SpriteFrame(this._texture,cc.rectPointsToPixels(this._rect),this._rectRotated,cc.pointPointsToPixels(this._unflippedOffsetPositionFromCenter),cc.sizePointsToPixels(this._contentSize))},setBatchNode:function(t){},setTexture:function(t){var e;return t?((e="string"==typeof t)&&(t=cc.textureCache.addImage(t)),this._loader.clear(),t._textureLoaded?(this._renderCmd._setTexture(t),e&&this._changeRectWithTexture(t),this.setColor(this._realColor),void(this._textureLoaded=!0)):(this._loader.once(t,function(){this.setTexture(t),this.dispatchEvent("load")},this),!1)):this._renderCmd._setTexture(null)},_changeRectWithTexture:function(t){t=t._contentSize,t=cc.rect(0,0,t.width,t.height),this.setTextureRect(t)},_createRenderCmd:function(){return new(cc._renderType===cc.game.RENDER_TYPE_CANVAS?cc.Sprite.CanvasRenderCmd:cc.Sprite.WebGLRenderCmd)(this)}}),cc.Sprite.create=function(t,e,i){return new cc.Sprite(t,e,i)},cc.Sprite.createWithTexture=cc.Sprite.create,cc.Sprite.createWithSpriteFrameName=cc.Sprite.create,cc.Sprite.createWithSpriteFrame=cc.Sprite.create,cc.Sprite.INDEX_NOT_INITIALIZED=-1,cc.EventHelper.prototype.apply(cc.Sprite.prototype),cc.assert(cc.isFunction(cc._tmp.PrototypeSprite),cc._LogInfos.MissingFile,"SpritesPropertyDefine.js"),cc._tmp.PrototypeSprite(),delete cc._tmp.PrototypeSprite,!function(){var t=cc.Sprite.LoadManager=function(){this.list=[]};t.prototype.add=function(t,e,i){t&&t.addEventListener&&(t.addEventListener("load",e,i),this.list.push({source:t,listener:e,target:i}))},t.prototype.once=function(e,i,n){var s;e&&e.addEventListener&&(e.addEventListener("load",s=function(t){e.removeEventListener("load",s,n),i.call(n,t)},n),this.list.push({source:e,listener:s,target:n}))},t.prototype.clear=function(){for(;0<this.list.length;){var t=this.list.pop();t.source.removeEventListener("load",t.listener,t.target)}}}(),!function(){cc.Sprite.CanvasRenderCmd=function(t){this._rootCtor(t),this._needDraw=!0,this._textureCoord={renderX:0,renderY:0,x:0,y:0,width:0,height:0,validRect:!1},this._blendFuncStr="source-over",this._colorized=!1,this._canUseDirtyRegion=!0,this._textureToRender=null};var t=cc.Sprite.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);t.constructor=cc.Sprite.CanvasRenderCmd,t._spriteCmdCtor=cc.Sprite.CanvasRenderCmd,t.setDirtyRecursively=function(t){},t._setTexture=function(t){var e=this._node;e._texture!==t&&(e._textureLoaded=!!t&&t._textureLoaded,t=(e._texture=t)._contentSize,t=cc.rect(0,0,t.width,t.height),e.setTextureRect(t),this._updateColor())},t._setColorDirty=function(){this.setDirtyFlag(cc.Node._dirtyFlags.colorDirty|cc.Node._dirtyFlags.opacityDirty)},t.isFrameDisplayed=function(t){var e=this._node;return t.getTexture()===e._texture&&cc.rectEqualToRect(t.getRect(),e._rect)},t.updateBlendFunc=function(t){this._blendFuncStr=cc.Node.CanvasRenderCmd._getCompositeOperationByBlendFunc(t)},t._setBatchNodeForAddChild=function(t){return!0},t._handleTextureForRotatedTexture=function(t,e,i,n){return i&&t.isLoaded()&&(t=t.getHtmlElementObj(),t=cc.Sprite.CanvasRenderCmd._cutRotateImageToCanvas(t,e,n),(n=new cc.Texture2D).initWithElement(t),n.handleLoadedTexture(),t=n,e.x=e.y=0,this._node._rect=cc.rect(0,0,e.width,e.height)),t},t._checkTextureBoundary=function(t,e,i){t&&t.url&&(i=e.y+e.height,e.x+e.width>t.width&&cc.error(cc._LogInfos.RectWidth,t.url),i>t.height)&&cc.error(cc._LogInfos.RectHeight,t.url)},t.rendering=function(t,e,i){var n,s,r,o,a,c,h,l,u=this._node,d=this._textureCoord,_=this._displayedOpacity/255,p=this._textureToRender||u._texture;(!p||0!==d.width&&0!==d.height&&p._textureLoaded)&&0!==_&&(n=(t=t||cc._renderContext).getContext(),s=u._offsetPosition.x,r=u._rect.height,o=u._rect.width,a=-u._offsetPosition.y-r,t.setTransform(this._worldTransform,e,i),t.setCompositeOperation(this._blendFuncStr),t.setGlobalAlpha(_),(u._flippedX||u._flippedY)&&t.save(),u._flippedX&&(s=-s-o,n.scale(-1,1)),u._flippedY&&(a=u._offsetPosition.y,n.scale(1,-1)),c=this._colorized?_=0:(_=d.renderX,d.renderY),h=d.width,l=d.height,p&&p._htmlElementObj?(e=p._htmlElementObj,""!==p._pattern?(t.setFillStyle(n.createPattern(e,p._pattern)),n.fillRect(s,a,o,r)):n.drawImage(e,_,c,h,l,s,a,o,r)):(p=u._contentSize,d.validRect&&(d=this._displayedColor,t.setFillStyle("rgba("+d.r+","+d.g+","+d.b+",1)"),n.fillRect(s,a,p.width*e,p.height*i))),(u._flippedX||u._flippedY)&&t.restore(),cc.g_NumberOfDraws++)},t._updateColor=function(){var t=this._node._texture,e=this._textureCoord,i=this._displayedColor;t&&(255!==i.r||255!==i.g||255!==i.b?(this._textureToRender=t._generateColorTexture(i.r,i.g,i.b,e),this._colorized=!0):t&&(this._textureToRender=t,this._colorized=!1))},t._textureLoadedCallback=function(t){var e,i;this._textureLoaded||(this._textureLoaded=!0,e=this._rect,i=this._renderCmd,e?cc._rectEqualToZero(e)&&(e.width=t.width,e.height=t.height):e=cc.rect(0,0,t.width,t.height),this.texture=t,this.setTextureRect(e,this._rectRotated),255===(t=i._displayedColor).r&&255===t.g&&255===t.b||i._updateColor(),this.setBatchNode(this._batchNode),this.dispatchEvent("load"))},t._setTextureCoords=function(t,e){var i=this._textureCoord,e=(e=void 0===e?!0:e)?cc.contentScaleFactor():1;i.renderX=i.x=0|t.x*e,i.renderY=i.y=0|t.y*e,i.width=0|t.width*e,i.height=0|t.height*e,i.validRect=!(0===i.width||0===i.height||i.x<0||i.y<0)},cc.Sprite.CanvasRenderCmd._cutRotateImageToCanvas=function(t,e,i){if(!t)return null;if(!e)return t;i=null==i||i;var n=document.createElement("canvas"),s=(n.width=e.width,n.height=e.height,n.getContext("2d"));return s.translate(n.width/2,n.height/2),i?s.rotate(-1.5707963267948966):s.rotate(1.5707963267948966),s.drawImage(t,e.x,e.y,e.height,e.width,-e.height/2,-e.width/2,e.height,e.width),n}}(),!function(){cc.Sprite.WebGLRenderCmd=function(t){this._rootCtor(t),this._needDraw=!0,this._vertices=[{x:0,y:0,u:0,v:0},{x:0,y:0,u:0,v:0},{x:0,y:0,u:0,v:0},{x:0,y:0,u:0,v:0}],this._color=new Uint32Array(1),this._recursiveDirty=this._dirty=!1,this._shaderProgram=cc.shaderCache.programForKey(cc.SHADER_SPRITE_POSITION_TEXTURECOLOR)};var t=cc.Sprite.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype);t.constructor=cc.Sprite.WebGLRenderCmd,t._spriteCmdCtor=cc.Sprite.WebGLRenderCmd,t.updateBlendFunc=function(t){},t.setDirtyFlag=function(t){cc.Node.WebGLRenderCmd.prototype.setDirtyFlag.call(this,t),this._dirty=!0},t.setDirtyRecursively=function(t){this._dirty=this._recursiveDirty=t;for(var e,i=this._node._children,n=i?i.length:0,s=0;s<n;s++)(e=i[s])instanceof cc.Sprite&&e._renderCmd.setDirtyRecursively(t)},t._setBatchNodeForAddChild=function(t){var e=this._node;if(e._batchNode){if(!(t instanceof cc.Sprite))return cc.log(cc._LogInfos.Sprite_addChild),!1;t.texture._webTextureObj!==e.textureAtlas.texture._webTextureObj&&cc.log(cc._LogInfos.Sprite_addChild_2),e._batchNode.appendChild(t),e._reorderChildDirty||e._setReorderChildDirtyRecursively()}return!0},t._handleTextureForRotatedTexture=function(t){return t},t.isFrameDisplayed=function(t){var e=this._node;return cc.rectEqualToRect(t.getRect(),e._rect)&&t.getTexture().getName()===e._texture.getName()&&cc.pointEqualToPoint(t.getOffset(),e._unflippedOffsetPositionFromCenter)},t._textureLoadedCallback=function(t){var e;this._textureLoaded||(this._textureLoaded=!0,(e=this._rect)?cc._rectEqualToZero(e)&&(e.width=t.width,e.height=t.height):e=cc.rect(0,0,t.width,t.height),this.texture=t,this.setTextureRect(e,this._rectRotated),this.setBatchNode(this._batchNode),this.dispatchEvent("load"),cc.renderer.childrenOrderDirty=!0)},t._setTextureCoords=function(t,e){(e=void 0===e?!0:e)&&(t=cc.rectPointsToPixels(t));var i,n,s,r,e=this._node,o=e._batchNode?e.textureAtlas.texture:e._texture,a=this._vertices;o&&(i=o.pixelsWidth,n=o.pixelsHeight,e._rectRotated?(n=cc.FIX_ARTIFACTS_BY_STRECHING_TEXEL?(i=(o=(2*t.x+1)/(2*i))+(2*t.height-2)/(2*i),(s=(2*t.y+1)/(2*n))+(2*t.width-2)/(2*n)):(o=t.x/i,i=(t.x+t.height)/i,s=t.y/n,(t.y+t.width)/n),e._flippedX&&(r=s,s=n,n=r),e._flippedY&&(r=o,o=i,i=r),a[0].u=i,a[0].v=s,a[1].u=o,a[1].v=s,a[2].u=i,a[2].v=n,a[3].u=o):(n=cc.FIX_ARTIFACTS_BY_STRECHING_TEXEL?(i=(o=(2*t.x+1)/(2*i))+(2*t.width-2)/(2*i),(s=(2*t.y+1)/(2*n))+(2*t.height-2)/(2*n)):(o=t.x/i,i=(t.x+t.width)/i,s=t.y/n,(t.y+t.height)/n),e._flippedX&&(r=o,o=i,i=r),e._flippedY&&(r=s,s=n,n=r),a[0].u=o,a[0].v=s,a[1].u=o,a[1].v=n,a[2].u=i,a[2].v=s,a[3].u=i),a[3].v=n)},t._setColorDirty=function(){},t._updateBlendFunc=function(){var t,e;this._batchNode?cc.log(cc._LogInfos.Sprite__updateBlendFunc):(e=(t=this._node)._blendFunc,t._texture&&t._texture.hasPremultipliedAlpha()?(e.src===cc.SRC_ALPHA&&e.dst===cc.BLEND_DST&&(e.src=cc.ONE),t.opacityModifyRGB=!0):(e.src===cc.ONE&&e.dst===cc.BLEND_DST&&(e.src=cc.SRC_ALPHA),t.opacityModifyRGB=!1))},t._setTexture=function(t){var e=this._node;e._texture!==t&&(e._textureLoaded=!!t&&t._textureLoaded,(e._texture=t)&&(t=t._contentSize,t=cc.rect(0,0,t.width,t.height),e.setTextureRect(t),this._updateBlendFunc()),e._textureLoaded)&&(cc.renderer.childrenOrderDirty=!0)},t._checkTextureBoundary=function(t,e,i){t&&t.url&&(e=i?(i=e.x+e.height,e.y+e.width):(i=e.x+e.width,e.y+e.height),i>t.width&&cc.error(cc._LogInfos.RectWidth,t.url),e>t.height)&&cc.error(cc._LogInfos.RectHeight,t.url)},t.transform=function(t,e){this.originTransform(t,e);var i=(e=(t=this._node)._offsetPosition.x)+t._rect.width,n=(l=t._offsetPosition.y)+t._rect.height,s=this._worldTransform,t=s.tx,r=s.ty,o=e*s.a,e=e*s.b,a=i*s.a,i=i*s.b,c=n*s.c,n=n*s.d,h=l*s.c,l=l*s.d;(s=this._vertices)[0].x=o+c+t,s[0].y=e+n+r,s[1].x=o+h+t,s[1].y=e+l+r,s[2].x=a+c+t,s[2].y=i+n+r,s[3].x=a+h+t,s[3].y=i+l+r},t.needDraw=function(){var t=this._node._texture;return this._needDraw&&t},t.uploadData=function(t,e,i){var n=this._node;if(!((r=n._texture)&&r._textureLoaded&&n._rect.width&&n._rect.height&&this._displayedOpacity))return 0;var s,r=this._displayedOpacity,o=this._displayedColor.r,a=this._displayedColor.g,c=this._displayedColor.b;for(n._opacityModifyRGB&&(o*=s=r/255,a*=s,c*=s),this._color[0]=r<<24|c<<16|a<<8|o,n=n._vertexZ,o=(r=this._vertices).length,c=i,i=0;i<o;++i)a=r[i],t[c]=a.x,t[c+1]=a.y,t[c+2]=n,e[c+3]=this._color[0],t[c+4]=a.u,t[c+5]=a.v,c+=6;return o}}(),cc.SpriteBatchNode=cc.Node.extend({_blendFunc:null,_texture:null,_className:"SpriteBatchNode",ctor:function(t){var e;cc.Node.prototype.ctor.call(this),this._blendFunc=new cc.BlendFunc(cc.BLEND_SRC,cc.BLEND_DST),cc.isString(t)?e=(e=cc.textureCache.getTextureForKey(t))||cc.textureCache.addImage(t):t instanceof cc.Texture2D&&(e=t),e&&this.initWithTexture(e)},addSpriteWithoutQuad:function(t,e,i){return this.addChild(t,e,i),this},getTextureAtlas:function(){return null},setTextureAtlas:function(t){},getDescendants:function(){return this._children},initWithFile:function(t,e){var i=(i=cc.textureCache.getTextureForKey(t))||cc.textureCache.addImage(t);return this.initWithTexture(i,e)},init:function(t,e){var i=(i=cc.textureCache.getTextureForKey(t))||cc.textureCache.addImage(t);return this.initWithTexture(i,e)},increaseAtlasCapacity:function(){},removeChildAtIndex:function(t,e){this.removeChild(this._children[t],e)},rebuildIndexInOrder:function(t,e){return e},highestAtlasIndexInChild:function(t){var e=t.children;return e&&0!==e.length?this.highestAtlasIndexInChild(e[e.length-1]):t.zIndex},lowestAtlasIndexInChild:function(t){var e=t.children;return e&&0!==e.length?this.lowestAtlasIndexInChild(e[e.length-1]):t.zIndex},atlasIndexForChild:function(t){return t.zIndex},reorderBatch:function(t){this._reorderChildDirty=t},setBlendFunc:function(t,e){this._blendFunc=void 0===e?t:{src:t,dst:e}},getBlendFunc:function(){return new cc.BlendFunc(this._blendFunc.src,this._blendFunc.dst)},updateQuadFromSprite:function(t,e){cc.assert(t,cc._LogInfos.CCSpriteBatchNode_updateQuadFromSprite_2),t instanceof cc.Sprite?(t.dirty=!0,t._renderCmd.transform(this._renderCmd,!0)):cc.log(cc._LogInfos.CCSpriteBatchNode_updateQuadFromSprite)},insertQuadFromSprite:function(t,e){this.addChild(t,e)},insertChild:function(t,e){this.addChild(t,e)},appendChild:function(t){this.sortAllChildren(),this.addChild(t.lastLocalZOrder+1)},removeSpriteFromAtlas:function(t,e){this.removeChild(t,e)},initWithTexture:function(t){return this.setTexture(t),!0},getTexture:function(){return this._texture},setTexture:function(n){if((this._texture=n)._textureLoaded)for(var t=this._children,e=t.length,i=0;i<e;++i)t[i].setTexture(n);else n.addEventListener("load",function(){for(var t=this._children,e=t.length,i=0;i<e;++i)t[i].setTexture(n)},this)},setShaderProgram:function(t){this._renderCmd.setShaderProgram(t);for(var e=this._children,i=e.length,n=0;n<i;++n)e[n].setShaderProgram(t)},addChild:function(t,e,i){cc.assert(void 0!==t,cc._LogInfos.CCSpriteBatchNode_addChild_3),this._isValidChild(t)&&(e=void 0===e?t.zIndex:e,i=void 0===i?t.tag:i,cc.Node.prototype.addChild.call(this,t,e,i),this._renderCmd._shaderProgram)&&(t.shaderProgram=this._renderCmd._shaderProgram)},_isValidChild:function(t){return t instanceof cc.Sprite?t.texture===this._texture||(cc.log(cc._LogInfos.Sprite_addChild_5),!1):(cc.log(cc._LogInfos.Sprite_addChild_4),!1)}}),_p=cc.SpriteBatchNode.prototype,cc.defineGetterSetter(_p,"texture",_p.getTexture,_p.setTexture),cc.defineGetterSetter(_p,"shaderProgram",_p.getShaderProgram,_p.setShaderProgram),cc.SpriteBatchNode.create=function(t){return new cc.SpriteBatchNode(t)},cc.SpriteBatchNode.createWithTexture=cc.SpriteBatchNode.create,cc.BakeSprite=cc.Sprite.extend({_cacheCanvas:null,_cacheContext:null,ctor:function(){cc.Sprite.prototype.ctor.call(this);var t=document.createElement("canvas"),e=(t.width=t.height=10,this._cacheCanvas=t,this._cacheContext=new cc.CanvasContextWrapper(t.getContext("2d")),new cc.Texture2D);e.initWithElement(t),e.handleLoadedTexture(),this.setTexture(e)},getCacheContext:function(){return this._cacheContext},getCacheCanvas:function(){return this._cacheCanvas},resetCanvasSize:function(t,e){var i=this._cacheCanvas,n=this._cacheContext,s=n._context.strokeStyle,r=n._context.fillStyle;void 0===e&&(e=t.height,t=t.width),i.width=t,i.height=e,s!==n._context.strokeStyle&&(n._context.strokeStyle=s),r!==n._context.fillStyle&&(n._context.fillStyle=r),this.getTexture().handleLoadedTexture(),this.setTextureRect(cc.rect(0,0,t,e),!1,null,!1)}}),cc.AnimationFrame=cc.Class.extend({_spriteFrame:null,_delayPerUnit:0,_userInfo:null,ctor:function(t,e,i){this._spriteFrame=t||null,this._delayPerUnit=e||0,this._userInfo=i||null},clone:function(){var t=new cc.AnimationFrame;return t.initWithSpriteFrame(this._spriteFrame.clone(),this._delayPerUnit,this._userInfo),t},copyWithZone:function(t){return cc.clone(this)},copy:function(t){return(t=new cc.AnimationFrame).initWithSpriteFrame(this._spriteFrame.clone(),this._delayPerUnit,this._userInfo),t},initWithSpriteFrame:function(t,e,i){return this._spriteFrame=t,this._delayPerUnit=e,this._userInfo=i,!0},getSpriteFrame:function(){return this._spriteFrame},setSpriteFrame:function(t){this._spriteFrame=t},getDelayUnits:function(){return this._delayPerUnit},setDelayUnits:function(t){this._delayPerUnit=t},getUserInfo:function(){return this._userInfo},setUserInfo:function(t){this._userInfo=t}}),cc.AnimationFrame.create=function(t,e,i){return new cc.AnimationFrame(t,e,i)},cc.Animation=cc.Class.extend({_frames:null,_loops:0,_restoreOriginalFrame:!1,_duration:0,_delayPerUnit:0,_totalDelayUnits:0,ctor:function(t,e,i){var n;this._frames=[],void 0===t?this.initWithSpriteFrames(null,0):(n=t[0])&&(n instanceof cc.SpriteFrame?this.initWithSpriteFrames(t,e,i):n instanceof cc.AnimationFrame&&this.initWithAnimationFrames(t,e,i))},getFrames:function(){return this._frames},setFrames:function(t){this._frames=t},addSpriteFrame:function(t){var e=new cc.AnimationFrame;e.initWithSpriteFrame(t,1,null),this._frames.push(e),this._totalDelayUnits++},addSpriteFrameWithFile:function(t){t=cc.textureCache.addImage(t);var e=cc.rect(0,0,0,0);e.width=t.width,e.height=t.height,t=new cc.SpriteFrame(t,e),this.addSpriteFrame(t)},addSpriteFrameWithTexture:function(t,e){t=new cc.SpriteFrame(t,e);this.addSpriteFrame(t)},initWithAnimationFrames:function(t,e,i){for(cc.arrayVerifyType(t,cc.AnimationFrame),this._delayPerUnit=e,this._loops=void 0===i?1:i,this._totalDelayUnits=0,i=(e=this._frames).length=0;i<t.length;i++){var n=t[i];e.push(n),this._totalDelayUnits+=n.getDelayUnits()}return!0},clone:function(){var t=new cc.Animation;return t.initWithAnimationFrames(this._copyFrames(),this._delayPerUnit,this._loops),t.setRestoreOriginalFrame(this._restoreOriginalFrame),t},copyWithZone:function(t){return(t=new cc.Animation).initWithAnimationFrames(this._copyFrames(),this._delayPerUnit,this._loops),t.setRestoreOriginalFrame(this._restoreOriginalFrame),t},_copyFrames:function(){for(var t=[],e=0;e<this._frames.length;e++)t.push(this._frames[e].clone());return t},copy:function(t){return this.copyWithZone(null)},getLoops:function(){return this._loops},setLoops:function(t){this._loops=t},setRestoreOriginalFrame:function(t){this._restoreOriginalFrame=t},getRestoreOriginalFrame:function(){return this._restoreOriginalFrame},getDuration:function(){return this._totalDelayUnits*this._delayPerUnit},getDelayPerUnit:function(){return this._delayPerUnit},setDelayPerUnit:function(t){this._delayPerUnit=t},getTotalDelayUnits:function(){return this._totalDelayUnits},initWithSpriteFrames:function(t,e,i){if(cc.arrayVerifyType(t,cc.SpriteFrame),this._loops=void 0===i?1:i,this._delayPerUnit=e||0,this._totalDelayUnits=0,(e=this._frames).length=0,t){for(i=0;i<t.length;i++){var n=t[i],s=new cc.AnimationFrame;s.initWithSpriteFrame(n,1,null),e.push(s)}this._totalDelayUnits+=t.length}return!0},retain:function(){},release:function(){}}),cc.Animation.create=function(t,e,i){return new cc.Animation(t,e,i)},cc.Animation.createWithAnimationFrames=cc.Animation.create,cc.animationCache={_animations:{},addAnimation:function(t,e){this._animations[e]=t},removeAnimation:function(t){t&&this._animations[t]&&delete this._animations[t]},getAnimation:function(t){return this._animations[t]||null},_addAnimationsWithDictionary:function(t,e){var i=t.animations;if(i){var n=1;if(s=t.properties)for(var n=null!=s.format?parseInt(s.format):n,s=s.spritesheets,r=cc.spriteFrameCache,o=cc.path,a=0;a<s.length;a++)r.addSpriteFrames(o.changeBasename(e,s[a]));switch(n){case 1:this._parseVersion1(i);break;case 2:this._parseVersion2(i);break;default:cc.log(cc._LogInfos.animationCache__addAnimationsWithDictionary_2)}}else cc.log(cc._LogInfos.animationCache__addAnimationsWithDictionary)},addAnimations:function(t){cc.assert(t,cc._LogInfos.animationCache_addAnimations_2);var e=cc.loader.getRes(t);e?this._addAnimationsWithDictionary(e,t):cc.log(cc._LogInfos.animationCache_addAnimations)},_parseVersion1:function(t){var e,i=cc.spriteFrameCache;for(e in t){var n=(s=t[e]).frames,s=parseFloat(s.delay)||0,r=null;if(n){for(var r=[],o=0;o<n.length;o++){var a,c=i.getSpriteFrame(n[o]);c?((a=new cc.AnimationFrame).initWithSpriteFrame(c,1,null),r.push(a)):cc.log(cc._LogInfos.animationCache__parseVersion1_2,e,n[o])}0===r.length?cc.log(cc._LogInfos.animationCache__parseVersion1_3,e):(r.length!==n.length&&cc.log(cc._LogInfos.animationCache__parseVersion1_4,e),r=new cc.Animation(r,s,1),cc.animationCache.addAnimation(r,e))}else cc.log(cc._LogInfos.animationCache__parseVersion1,e)}},_parseVersion2:function(t){var e,i=cc.spriteFrameCache;for(e in t){var n=t[e],s=n.loop,r=parseInt(n.loops),s=s?cc.REPEAT_FOREVER:isNaN(r)?1:r,r=!(!n.restoreOriginalFrame||1!=n.restoreOriginalFrame),o=n.frames;if(o){for(var a=[],c=0;c<o.length;c++){var h,l=o[c],u=l.spriteframe,d=i.getSpriteFrame(u);d?(u=parseFloat(l.delayUnits)||0,l=l.notification,(h=new cc.AnimationFrame).initWithSpriteFrame(d,u,l),a.push(h)):cc.log(cc._LogInfos.animationCache__parseVersion2_2,e,u)}n=parseFloat(n.delayPerUnit)||0,(o=new cc.Animation).initWithAnimationFrames(a,n,s),o.setRestoreOriginalFrame(r),cc.animationCache.addAnimation(o,e)}else cc.log(cc._LogInfos.animationCache__parseVersion2,e)}},_clear:function(){this._animations={}}},cc.SpriteFrame=cc.Class.extend({_offset:null,_originalSize:null,_rectInPixels:null,_rotated:!1,_rect:null,_offsetInPixels:null,_originalSizeInPixels:null,_texture:null,_textureFilename:"",_textureLoaded:!1,ctor:function(t,e,i,n,s){this._offset=cc.p(0,0),this._offsetInPixels=cc.p(0,0),this._originalSize=cc.size(0,0),this._rotated=!1,this._originalSizeInPixels=cc.size(0,0),this._textureFilename="",this._texture=null,this._textureLoaded=!1,void 0!==t&&void 0!==e&&(void 0===i||void 0===n||void 0===s?this.initWithTexture(t,e):this.initWithTexture(t,e,i,n,s))},textureLoaded:function(){return this._textureLoaded},addLoadedEventListener:function(t,e){this.addEventListener("load",t,e)},getRectInPixels:function(){var t=this._rectInPixels;return cc.rect(t.x,t.y,t.width,t.height)},setRectInPixels:function(t){this._rectInPixels||(this._rectInPixels=cc.rect(0,0,0,0)),this._rectInPixels.x=t.x,this._rectInPixels.y=t.y,this._rectInPixels.width=t.width,this._rectInPixels.height=t.height,this._rect=cc.rectPixelsToPoints(t)},isRotated:function(){return this._rotated},setRotated:function(t){this._rotated=t},getRect:function(){var t=this._rect;return cc.rect(t.x,t.y,t.width,t.height)},setRect:function(t){this._rect||(this._rect=cc.rect(0,0,0,0)),this._rect.x=t.x,this._rect.y=t.y,this._rect.width=t.width,this._rect.height=t.height,this._rectInPixels=cc.rectPointsToPixels(this._rect)},getOffsetInPixels:function(){return cc.p(this._offsetInPixels)},setOffsetInPixels:function(t){this._offsetInPixels.x=t.x,this._offsetInPixels.y=t.y,cc._pointPixelsToPointsOut(this._offsetInPixels,this._offset)},getOriginalSizeInPixels:function(){return cc.size(this._originalSizeInPixels)},setOriginalSizeInPixels:function(t){this._originalSizeInPixels.width=t.width,this._originalSizeInPixels.height=t.height},getOriginalSize:function(){return cc.size(this._originalSize)},setOriginalSize:function(t){this._originalSize.width=t.width,this._originalSize.height=t.height},getTexture:function(){var t;return this._texture||(""!==this._textureFilename?((t=cc.textureCache.addImage(this._textureFilename))&&(this._textureLoaded=t.isLoaded()),t):null)},setTexture:function(t){var e;this._texture!==t&&(e=t.isLoaded(),this._textureLoaded=e,this._texture=t,e||t.addEventListener("load",function(t){var e,i;this._textureLoaded=!0,this._rotated&&cc._renderType===cc.game.RENDER_TYPE_CANVAS&&(e=t.getHtmlElementObj(),e=cc.Sprite.CanvasRenderCmd._cutRotateImageToCanvas(e,this.getRect()),(i=new cc.Texture2D).initWithElement(e),i.handleLoadedTexture(),this.setTexture(i),e=this.getRect(),this.setRect(cc.rect(0,0,e.width,e.height))),0===(e=this._rect).width&&0===e.height&&(e=t.width,t=t.height,this._rect.width=e,this._rect.height=t,this._rectInPixels=cc.rectPointsToPixels(this._rect),this._originalSizeInPixels.width=this._rectInPixels.width,this._originalSizeInPixels.height=this._rectInPixels.height,this._originalSize.width=e,this._originalSize.height=t),this.dispatchEvent("load")},this))},getOffset:function(){return cc.p(this._offset)},setOffset:function(t){this._offset.x=t.x,this._offset.y=t.y},clone:function(){var t=new cc.SpriteFrame;return t.initWithTexture(this._textureFilename,this._rectInPixels,this._rotated,this._offsetInPixels,this._originalSizeInPixels),t.setTexture(this._texture),t},copyWithZone:function(){var t=new cc.SpriteFrame;return t.initWithTexture(this._textureFilename,this._rectInPixels,this._rotated,this._offsetInPixels,this._originalSizeInPixels),t.setTexture(this._texture),t},copy:function(){return this.copyWithZone()},initWithTexture:function(t,e,i,n,s){var r,o;return 2===arguments.length&&(e=cc.rectPointsToPixels(e)),n=n||cc.p(0,0),s=s||e,i=i||!1,"string"==typeof t?(this._texture=null,this._textureFilename=t):t instanceof cc.Texture2D&&this.setTexture(t),t=this.getTexture(),this._rectInPixels=e,this._rect=cc.rectPixelsToPoints(e),t&&t.url&&t.isLoaded()&&(o=i?(r=e.x+e.height,e.y+e.width):(r=e.x+e.width,e.y+e.height),r>t.getPixelsWide()&&cc.error(cc._LogInfos.RectWidth,t.url),o>t.getPixelsHigh())&&cc.error(cc._LogInfos.RectHeight,t.url),this._offsetInPixels.x=n.x,this._offsetInPixels.y=n.y,cc._pointPixelsToPointsOut(n,this._offset),this._originalSizeInPixels.width=s.width,this._originalSizeInPixels.height=s.height,cc._sizePixelsToPointsOut(s,this._originalSize),this._rotated=i,!0}}),cc.EventHelper.prototype.apply(cc.SpriteFrame.prototype),cc.SpriteFrame.create=function(t,e,i,n,s){return new cc.SpriteFrame(t,e,i,n,s)},cc.SpriteFrame.createWithTexture=cc.SpriteFrame.create,cc.SpriteFrame._frameWithTextureForCanvas=function(t,e,i,n,s){var r=new cc.SpriteFrame;return r._texture=t,r._rectInPixels=e,r._rect=cc.rectPixelsToPoints(e),r._offsetInPixels.x=n.x,r._offsetInPixels.y=n.y,cc._pointPixelsToPointsOut(r._offsetInPixels,r._offset),r._originalSizeInPixels.width=s.width,r._originalSizeInPixels.height=s.height,cc._sizePixelsToPointsOut(r._originalSizeInPixels,r._originalSize),r._rotated=i,r},cc.spriteFrameCache={_CCNS_REG1:/^\s*\{\s*([\-]?\d+[.]?\d*)\s*,\s*([\-]?\d+[.]?\d*)\s*\}\s*$/,_CCNS_REG2:/^\s*\{\s*\{\s*([\-]?\d+[.]?\d*)\s*,\s*([\-]?\d+[.]?\d*)\s*\}\s*,\s*\{\s*([\-]?\d+[.]?\d*)\s*,\s*([\-]?\d+[.]?\d*)\s*\}\s*\}\s*$/,_spriteFrames:{},_spriteFramesAliases:{},_frameConfigCache:{},_rectFromString:function(t){return(t=this._CCNS_REG2.exec(t))?cc.rect(parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3]),parseFloat(t[4])):cc.rect(0,0,0,0)},_pointFromString:function(t){return(t=this._CCNS_REG1.exec(t))?cc.p(parseFloat(t[1]),parseFloat(t[2])):cc.p(0,0)},_sizeFromString:function(t){return(t=this._CCNS_REG1.exec(t))?cc.size(parseFloat(t[1]),parseFloat(t[2])):cc.size(0,0)},_getFrameConfig:function(t){var e=cc.loader.getRes(t);return cc.assert(e,cc._LogInfos.spriteFrameCache__getFrameConfig_2,t),cc.loader.release(t),e._inited?this._frameConfigCache[t]=e:(this._frameConfigCache[t]=this._parseFrameConfig(e),this._frameConfigCache[t])},_getFrameConfigByJsonObject:function(t,e){return cc.assert(e,cc._LogInfos.spriteFrameCache__getFrameConfig_2,t),this._frameConfigCache[t]=this._parseFrameConfig(e),this._frameConfigCache[t]},_parseFrameConfig:function(t){var e,i=t.frames,n=t.metadata||t.meta,s=(t={},{}),r=0;for(e in n&&(r=(r=n.format).length<=1?parseInt(r):r,s.image=n.textureFileName||n.textureFileName||n.image),i){var o,a,c=i[e];c&&(n={},0==r?(n.rect=cc.rect(c.x,c.y,c.width,c.height),n.rotated=!1,n.offset=cc.p(c.offsetX,c.offsetY),o=c.originalWidth,c=c.originalHeight,o&&c||cc.log(cc._LogInfos.spriteFrameCache__getFrameConfig),o=Math.abs(o),c=Math.abs(c),n.size=cc.size(o,c)):1==r||2==r?(n.rect=this._rectFromString(c.frame),n.rotated=c.rotated||!1,n.offset=this._pointFromString(c.offset),n.size=this._sizeFromString(c.sourceSize)):3==r?(o=this._sizeFromString(c.spriteSize),a=this._rectFromString(c.textureRect),o&&(a=cc.rect(a.x,a.y,o.width,o.height)),n.rect=a,n.rotated=c.textureRotated||!1,n.offset=this._pointFromString(c.spriteOffset),n.size=this._sizeFromString(c.spriteSourceSize),n.aliases=c.aliases):(o=c.frame,a=c.sourceSize,e=c.filename||e,n.rect=cc.rect(o.x,o.y,o.w,o.h),n.rotated=c.rotated||!1,n.offset=cc.p(0,0),n.size=cc.size(a.w,a.h)),t[e]=n)}return{_inited:!0,frames:t,meta:s}},_addSpriteFramesByObject:function(t,e,i){cc.assert(t,cc._LogInfos.spriteFrameCache_addSpriteFrames_2),e&&e.frames&&(e=this._frameConfigCache[t]||this._getFrameConfigByJsonObject(t,e),this._createSpriteFrames(t,e,i))},_createSpriteFrames:function(t,e,i){var n,s=e.frames;for(n in e=e.meta,i?i instanceof cc.Texture2D||(cc.isString(i)?i=cc.textureCache.addImage(i):cc.assert(0,cc._LogInfos.spriteFrameCache_addSpriteFrames_3)):(i=cc.path.changeBasename(t,e.image||".png"),i=cc.textureCache.addImage(i)),t=this._spriteFramesAliases,e=this._spriteFrames,s){var r=s[n],o=e[n];if(!o){if(o=new cc.SpriteFrame(i,cc.rect(r.rect),r.rotated,r.offset,r.size),r=r.aliases)for(var a=0,c=r.length;a<c;a++){var h=r[a];t[h]&&cc.log(cc._LogInfos.spriteFrameCache_addSpriteFrames,h),t[h]=n}cc._renderType===cc.game.RENDER_TYPE_CANVAS&&o.isRotated()&&o.getTexture().isLoaded()&&(r=o.getTexture().getHtmlElementObj(),r=cc.Sprite.CanvasRenderCmd._cutRotateImageToCanvas(r,o.getRectInPixels()),(a=new cc.Texture2D).initWithElement(r),a.handleLoadedTexture(),o.setTexture(a),o.setRotated(!1),r=o._rect,o.setRect(cc.rect(0,0,r.width,r.height))),e[n]=o}}},addSpriteFrames:function(t,e){cc.assert(t,cc._LogInfos.spriteFrameCache_addSpriteFrames_2);var i=this._frameConfigCache[t]||cc.loader.getRes(t);i&&i.frames&&(i=this._frameConfigCache[t]||this._getFrameConfig(t),this._createSpriteFrames(t,i,e))},_checkConflict:function(t){for(var e in t=t.frames)this._spriteFrames[e]&&cc.log(cc._LogInfos.spriteFrameCache__checkConflict,e)},addSpriteFrame:function(t,e){this._spriteFrames[e]=t},removeSpriteFrames:function(){this._spriteFrames={},this._spriteFramesAliases={}},removeSpriteFrameByName:function(t){t&&(this._spriteFramesAliases[t]&&delete this._spriteFramesAliases[t],this._spriteFrames[t])&&delete this._spriteFrames[t]},removeSpriteFramesFromFile:function(t){var e=this._spriteFrames,i=this._spriteFramesAliases;if(t=this._frameConfigCache[t])for(var n in t=t.frames)if(e[n])for(var s in delete e[n],i)i[s]===n&&delete i[s]},removeSpriteFramesFromTexture:function(t){var e,i=this._spriteFrames,n=this._spriteFramesAliases;for(e in i){var s=i[e];if(s&&s.getTexture()===t)for(var r in delete i[e],n)n[r]===e&&delete n[r]}},getSpriteFrame:function(t){var e,i=this._spriteFrames[t];return i||!(e=this._spriteFramesAliases[t])||(i=this._spriteFrames[e.toString()])||delete this._spriteFramesAliases[t],i},_clear:function(){this._spriteFrames={},this._spriteFramesAliases={},this._frameConfigCache={}}},cc.configuration={ERROR:0,STRING:1,INT:2,DOUBLE:3,BOOLEAN:4,_maxTextureSize:0,_maxModelviewStackDepth:0,_supportsPVRTC:!1,_supportsNPOT:!1,_supportsBGRA8888:!1,_supportsDiscardFramebuffer:!1,_supportsShareableVAO:!1,_maxSamplesAllowed:0,_maxTextureUnits:0,_GlExtensions:"",_valueDict:{},_inited:!1,_init:function(){var t=this._valueDict;t["cocos2d.x.version"]=cc.ENGINE_VERSION,t["cocos2d.x.compiled_with_profiler"]=!1,t["cocos2d.x.compiled_with_gl_state_cache"]=cc.ENABLE_GL_STATE_CACHE,this._inited=!0},getMaxTextureSize:function(){return this._maxTextureSize},getMaxModelviewStackDepth:function(){return this._maxModelviewStackDepth},getMaxTextureUnits:function(){return this._maxTextureUnits},supportsNPOT:function(){return this._supportsNPOT},supportsPVRTC:function(){return this._supportsPVRTC},supportsETC:function(){return!1},supportsS3TC:function(){return!1},supportsATITC:function(){return!1},supportsBGRA8888:function(){return this._supportsBGRA8888},supportsDiscardFramebuffer:function(){return this._supportsDiscardFramebuffer},supportsShareableVAO:function(){return this._supportsShareableVAO},checkForGLExtension:function(t){return-1<this._GlExtensions.indexOf(t)},getValue:function(t,e){this._inited||this._init();var i=this._valueDict;return i[t]||e},setValue:function(t,e){this._valueDict[t]=e},dumpInfo:function(){0===cc.ENABLE_GL_STATE_CACHE&&(cc.log(""),cc.log(cc._LogInfos.configuration_dumpInfo),cc.log(""))},gatherGPUInfo:function(){if(cc._renderType!==cc.game.RENDER_TYPE_CANVAS){this._inited||this._init();var t=cc._renderContext,e=this._valueDict;e["gl.vendor"]=t.getParameter(t.VENDOR),e["gl.renderer"]=t.getParameter(t.RENDERER),e["gl.version"]=t.getParameter(t.VERSION),this._GlExtensions="";for(var i=t.getSupportedExtensions(),n=0;n<i.length;n++)this._GlExtensions+=i[n]+" ";this._maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),e["gl.max_texture_size"]=this._maxTextureSize,this._maxTextureUnits=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS),e["gl.max_texture_units"]=this._maxTextureUnits,this._supportsPVRTC=this.checkForGLExtension("GL_IMG_texture_compression_pvrtc"),e["gl.supports_PVRTC"]=this._supportsPVRTC,this._supportsNPOT=!1,e["gl.supports_NPOT"]=this._supportsNPOT,this._supportsBGRA8888=this.checkForGLExtension("GL_IMG_texture_format_BGRA888"),e["gl.supports_BGRA8888"]=this._supportsBGRA8888,this._supportsDiscardFramebuffer=this.checkForGLExtension("GL_EXT_discard_framebuffer"),e["gl.supports_discard_framebuffer"]=this._supportsDiscardFramebuffer,this._supportsShareableVAO=this.checkForGLExtension("vertex_array_object"),e["gl.supports_vertex_array_object"]=this._supportsShareableVAO,cc.checkGLErrorDebug()}},loadConfigFile:function(t){this._inited||this._init();var e=cc.loader.getRes(t);if(!e)throw Error("Please load the resource first : "+t);if(cc.assert(e,cc._LogInfos.configuration_loadConfigFile_2,t),e=e.data)for(var i in e)this._valueDict[i]=e[i];else cc.log(cc._LogInfos.configuration_loadConfigFile,t)}},cc.g_NumberOfDraws=0,cc.Director=cc.Class.extend({_landscape:!1,_nextDeltaTimeZero:!1,_paused:!1,_purgeDirectorInNextLoop:!1,_sendCleanupToScene:!1,_animationInterval:0,_oldAnimationInterval:0,_projection:0,_contentScaleFactor:1,_deltaTime:0,_winSizeInPoints:null,_lastUpdate:null,_nextScene:null,_notificationNode:null,_openGLView:null,_scenesStack:null,_projectionDelegate:null,_runningScene:null,_totalFrames:0,_secondsPerFrame:0,_dirtyRegion:null,_scheduler:null,_actionManager:null,_eventProjectionChanged:null,_eventAfterUpdate:null,_eventAfterVisit:null,_eventAfterDraw:null,ctor:function(){var t=this;t._lastUpdate=Date.now(),cc.eventManager.addCustomListener(cc.game.EVENT_SHOW,function(){t._lastUpdate=Date.now()})},init:function(){return this._oldAnimationInterval=this._animationInterval=1/cc.defaultFPS,this._scenesStack=[],this._projection=cc.Director.PROJECTION_DEFAULT,this._projectionDelegate=null,this._totalFrames=0,this._lastUpdate=Date.now(),this._purgeDirectorInNextLoop=this._paused=!1,this._winSizeInPoints=cc.size(0,0),this._openGLView=null,this._contentScaleFactor=1,this._scheduler=new cc.Scheduler,cc.ActionManager?(this._actionManager=new cc.ActionManager,this._scheduler.scheduleUpdate(this._actionManager,cc.Scheduler.PRIORITY_SYSTEM,!1)):this._actionManager=null,this._eventAfterUpdate=new cc.EventCustom(cc.Director.EVENT_AFTER_UPDATE),this._eventAfterUpdate.setUserData(this),this._eventAfterVisit=new cc.EventCustom(cc.Director.EVENT_AFTER_VISIT),this._eventAfterVisit.setUserData(this),this._eventAfterDraw=new cc.EventCustom(cc.Director.EVENT_AFTER_DRAW),this._eventAfterDraw.setUserData(this),this._eventProjectionChanged=new cc.EventCustom(cc.Director.EVENT_PROJECTION_CHANGED),this._eventProjectionChanged.setUserData(this),!0},calculateDeltaTime:function(){var t=Date.now();this._nextDeltaTimeZero?(this._deltaTime=0,this._nextDeltaTimeZero=!1):this._deltaTime=(t-this._lastUpdate)/1e3,0<cc.game.config[cc.game.CONFIG_KEY.debugMode]&&.2<this._deltaTime&&(this._deltaTime=1/60),this._lastUpdate=t},convertToGL:function(t){var e=document.documentElement,i=cc.view,n=e.getBoundingClientRect();return n.left+=window.pageXOffset-e.clientLeft,n.top+=window.pageYOffset-e.clientTop,e=i._devicePixelRatio*(t.x-n.left),t=i._devicePixelRatio*(n.top+n.height-t.y),i._isRotated?{x:i._viewPortRect.width-t,y:e}:{x:e,y:t}},convertToUI:function(t){var e=document.documentElement,i=cc.view,n=e.getBoundingClientRect();return n.left+=window.pageXOffset-e.clientLeft,n.top+=window.pageYOffset-e.clientTop,e={x:0,y:0},i._isRotated?(e.x=n.left+t.y/i._devicePixelRatio,e.y=n.top+n.height-(i._viewPortRect.width-t.x)/i._devicePixelRatio):(e.x=n.left+t.x/i._devicePixelRatio,e.y=n.top+n.height-t.y/i._devicePixelRatio),e},drawScene:function(){var t=cc.renderer;this.calculateDeltaTime(),this._paused||(this._scheduler.update(this._deltaTime),cc.eventManager.dispatchEvent(this._eventAfterUpdate)),this._nextScene&&this.setNextScene(),this._runningScene&&(t.childrenOrderDirty?(cc.renderer.clearRenderCommands(),cc.renderer.assignedZ=0,this._runningScene._renderCmd._curLevel=0,this._runningScene.visit(),t.resetFlag()):t.transformDirty()&&t.transform()),t.clear(),this._notificationNode&&this._notificationNode.visit(),cc.eventManager.dispatchEvent(this._eventAfterVisit),cc.g_NumberOfDraws=0,t.rendering(cc._renderContext),this._totalFrames++,cc.eventManager.dispatchEvent(this._eventAfterDraw),cc.eventManager.frameUpdateListeners(),this._calculateMPF()},end:function(){this._purgeDirectorInNextLoop=!0},getContentScaleFactor:function(){return this._contentScaleFactor},getNotificationNode:function(){return this._notificationNode},getWinSize:function(){return cc.size(this._winSizeInPoints)},getWinSizeInPixels:function(){return cc.size(this._winSizeInPoints.width*this._contentScaleFactor,this._winSizeInPoints.height*this._contentScaleFactor)},getVisibleSize:null,getVisibleOrigin:null,getZEye:null,pause:function(){this._paused||(this._oldAnimationInterval=this._animationInterval,this.setAnimationInterval(.25),this._paused=!0)},popScene:function(){cc.assert(this._runningScene,cc._LogInfos.Director_popScene),this._scenesStack.pop();var t=this._scenesStack.length;0===t?this.end():(this._sendCleanupToScene=!0,this._nextScene=this._scenesStack[t-1])},purgeCachedData:function(){cc.animationCache._clear(),cc.spriteFrameCache._clear(),cc.textureCache._clear()},purgeDirector:function(){this.getScheduler().unscheduleAll(),cc.eventManager&&cc.eventManager.setEnabled(!1),this._runningScene&&(this._runningScene._performRecursive(cc.Node._stateCallbackType.onExitTransitionDidStart),this._runningScene._performRecursive(cc.Node._stateCallbackType.onExit),this._runningScene._performRecursive(cc.Node._stateCallbackType.cleanup)),this._nextScene=this._runningScene=null,this._scenesStack.length=0,this.stopAnimation(),this.purgeCachedData(),cc.checkGLErrorDebug()},pushScene:function(t){cc.assert(t,cc._LogInfos.Director_pushScene),this._sendCleanupToScene=!1,this._scenesStack.push(t),this._nextScene=t},runScene:function(t){var e;cc.assert(t,cc._LogInfos.Director_pushScene),this._runningScene?(0===(e=this._scenesStack.length)?(this._sendCleanupToScene=!0,this._scenesStack[e]=t):(this._sendCleanupToScene=!0,this._scenesStack[e-1]=t),this._nextScene=t):(this.pushScene(t),this.startAnimation())},resume:function(){this._paused&&(this.setAnimationInterval(this._oldAnimationInterval),(this._lastUpdate=Date.now())||cc.log(cc._LogInfos.Director_resume),this._paused=!1,this._deltaTime=0)},setContentScaleFactor:function(t){t!==this._contentScaleFactor&&(this._contentScaleFactor=t)},setDepthTest:null,setClearColor:null,setDefaultValues:function(){},setNextDeltaTimeZero:function(t){this._nextDeltaTimeZero=t},setNextScene:function(){var t=!1,e=!1;cc.TransitionScene&&(t=!!this._runningScene&&this._runningScene instanceof cc.TransitionScene,e=!!this._nextScene&&this._nextScene instanceof cc.TransitionScene),e||((e=this._runningScene)&&(e._performRecursive(cc.Node._stateCallbackType.onExitTransitionDidStart),e._performRecursive(cc.Node._stateCallbackType.onExit)),this._sendCleanupToScene&&e&&e._performRecursive(cc.Node._stateCallbackType.cleanup)),this._runningScene=this._nextScene,cc.renderer.childrenOrderDirty=!0,this._nextScene=null,t||null===this._runningScene||(this._runningScene._performRecursive(cc.Node._stateCallbackType.onEnter),this._runningScene._performRecursive(cc.Node._stateCallbackType.onEnterTransitionDidFinish))},setNotificationNode:function(t){cc.renderer.childrenOrderDirty=!0,this._notificationNode&&(this._notificationNode._performRecursive(cc.Node._stateCallbackType.onExitTransitionDidStart),this._notificationNode._performRecursive(cc.Node._stateCallbackType.onExit),this._notificationNode._performRecursive(cc.Node._stateCallbackType.cleanup)),(this._notificationNode=t)&&(this._notificationNode._performRecursive(cc.Node._stateCallbackType.onEnter),this._notificationNode._performRecursive(cc.Node._stateCallbackType.onEnterTransitionDidFinish))},getDelegate:function(){return this._projectionDelegate},setDelegate:function(t){this._projectionDelegate=t},setOpenGLView:null,setProjection:null,setViewport:null,getOpenGLView:null,getProjection:null,setAlphaBlending:null,isSendCleanupToScene:function(){return this._sendCleanupToScene},getRunningScene:function(){return this._runningScene},getAnimationInterval:function(){return this._animationInterval},isDisplayStats:function(){return!!cc.profiler&&cc.profiler.isShowingStats()},setDisplayStats:function(t){cc.profiler&&(t?cc.profiler.showStats():cc.profiler.hideStats())},getSecondsPerFrame:function(){return this._secondsPerFrame},isNextDeltaTimeZero:function(){return this._nextDeltaTimeZero},isPaused:function(){return this._paused},getTotalFrames:function(){return this._totalFrames},popToRootScene:function(){this.popToSceneStackLevel(1)},popToSceneStackLevel:function(t){cc.assert(this._runningScene,cc._LogInfos.Director_popToSceneStackLevel_2);var e=this._scenesStack,i=e.length;if(0===t)this.end();else if(!(i<=t)){for(;t<i;){var n=e.pop();n.running&&(n._performRecursive(cc.Node._stateCallbackType.onExitTransitionDidStart),n._performRecursive(cc.Node._stateCallbackType.onExit)),n._performRecursive(cc.Node._stateCallbackType.cleanup),i--}this._nextScene=e[e.length-1],this._sendCleanupToScene=!0}},getScheduler:function(){return this._scheduler},setScheduler:function(t){this._scheduler!==t&&(this._scheduler=t)},getActionManager:function(){return this._actionManager},setActionManager:function(t){this._actionManager!==t&&(this._actionManager=t)},getDeltaTime:function(){return this._deltaTime},_calculateMPF:function(){this._secondsPerFrame=(Date.now()-this._lastUpdate)/1e3}}),cc.Director.EVENT_PROJECTION_CHANGED="director_projection_changed",cc.Director.EVENT_AFTER_UPDATE="director_after_update",cc.Director.EVENT_AFTER_VISIT="director_after_visit",cc.Director.EVENT_AFTER_DRAW="director_after_draw",cc.DisplayLinkDirector=cc.Director.extend({invalid:!1,startAnimation:function(){this._nextDeltaTimeZero=!0,this.invalid=!1},mainLoop:function(){this._purgeDirectorInNextLoop?(this._purgeDirectorInNextLoop=!1,this.purgeDirector()):this.invalid||this.drawScene()},stopAnimation:function(){this.invalid=!0},setAnimationInterval:function(t){this._animationInterval=t,this.invalid||(this.stopAnimation(),this.startAnimation())}}),cc.Director.sharedDirector=null,cc.Director.firstUseDirector=!0,cc.Director._getInstance=function(){return cc.Director.firstUseDirector&&(cc.Director.firstUseDirector=!1,cc.Director.sharedDirector=new cc.DisplayLinkDirector,cc.Director.sharedDirector.init()),cc.Director.sharedDirector},cc.defaultFPS=60,cc.Director.PROJECTION_2D=0,cc.Director.PROJECTION_3D=1,cc.Director.PROJECTION_CUSTOM=3,cc.Director.PROJECTION_DEFAULT=cc.Director.PROJECTION_3D,cc.game.addEventListener(cc.game.EVENT_RENDERER_INITED,function(){var t;cc._renderType===cc.game.RENDER_TYPE_CANVAS?((t=cc.Director.prototype).getProjection=function(t){return this._projection},t.setProjection=function(t){this._projection=t,cc.eventManager.dispatchEvent(this._eventProjectionChanged)},t.setDepthTest=function(){},t.setClearColor=function(t){cc.renderer._clearColor=t,cc.renderer._clearFillStyle="rgb("+t.r+","+t.g+","+t.b+")"},t.setOpenGLView=function(t){this._winSizeInPoints.width=cc._canvas.width,this._winSizeInPoints.height=cc._canvas.height,this._openGLView=t||cc.view,cc.eventManager&&cc.eventManager.setEnabled(!0)},t.getVisibleSize=function(){return this.getWinSize()},t.getVisibleOrigin=function(){return cc.p(0,0)}):(cc.Director._fpsImage=new Image,cc.Director._fpsImage.addEventListener("load",function(){cc.Director._fpsImageLoaded=!0}),cc._fpsImage&&(cc.Director._fpsImage.src=cc._fpsImage))}),cc.game.addEventListener(cc.game.EVENT_RENDERER_INITED,function(){var t,i;cc._renderType===cc.game.RENDER_TYPE_WEBGL&&(cc.DirectorDelegate=cc.Class.extend({updateProjection:function(){}}),t=cc.Director.prototype,i=function(t){if(t&&t._renderCmd){t._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty);var e=t._children;for(t=0;t<e.length;t++)i(e[t])}},cc.eventManager.addCustomListener(cc.Director.EVENT_PROJECTION_CHANGED,function(){for(var t=cc.director._scenesStack,e=0;e<t.length;e++)i(t[e])}),t.setProjection=function(t){var e=this._winSizeInPoints;this.setViewport();var i=(o=this._openGLView)._viewPortRect.x/o._scaleX,n=o._viewPortRect.y/o._scaleY;switch(t){case cc.Director.PROJECTION_2D:cc.kmGLMatrixMode(cc.KM_GL_PROJECTION),cc.kmGLLoadIdentity(),o=cc.math.Matrix4.createOrthographicProjection(0,e.width,0,e.height,-1024,1024),cc.kmGLMultMatrix(o),cc.kmGLMatrixMode(cc.KM_GL_MODELVIEW),cc.kmGLLoadIdentity();break;case cc.Director.PROJECTION_3D:var s,r=this.getZEye(),o=(new cc.math.Matrix4,new cc.math.Matrix4);cc.kmGLMatrixMode(cc.KM_GL_PROJECTION),cc.kmGLLoadIdentity(),s=cc.math.Matrix4.createPerspectiveProjection(60,e.width/e.height,.1,2*r),cc.kmGLMultMatrix(s),r=new cc.math.Vec3(-i+e.width/2,-n+e.height/2,r),e=new cc.math.Vec3(-i+e.width/2,-n+e.height/2,0),i=new cc.math.Vec3(0,1,0),o.lookAt(r,e,i),cc.kmGLMultMatrix(o),cc.kmGLMatrixMode(cc.KM_GL_MODELVIEW),cc.kmGLLoadIdentity();break;case cc.Director.PROJECTION_CUSTOM:this._projectionDelegate&&this._projectionDelegate.updateProjection();break;default:cc.log(cc._LogInfos.Director_setProjection)}this._projection=t,cc.eventManager.dispatchEvent(this._eventProjectionChanged),cc.setProjectionMatrixDirty(),cc.renderer.childrenOrderDirty=!0},t.setDepthTest=function(t){cc.renderer.setDepthTest(t)},t.setClearColor=function(t){cc.renderer._clearColor=t},t.setOpenGLView=function(t){this._winSizeInPoints.width=cc._canvas.width,this._winSizeInPoints.height=cc._canvas.height,this._openGLView=t||cc.view,(t=cc.configuration).gatherGPUInfo(),t.dumpInfo(),this.setGLDefaultValues(),cc.eventManager&&cc.eventManager.setEnabled(!0)},t.getVisibleSize=function(){return this._openGLView.getVisibleSize()},t.getVisibleOrigin=function(){return this._openGLView.getVisibleOrigin()},t.getZEye=function(){return this._winSizeInPoints.height/1.1546999375},t.setViewport=function(){var t,e=this._openGLView;e&&(t=this._winSizeInPoints,e.setViewPortInPoints(-e._viewPortRect.x/e._scaleX,-e._viewPortRect.y/e._scaleY,t.width,t.height))},t.getOpenGLView=function(){return this._openGLView},t.getProjection=function(){return this._projection},t.setAlphaBlending=function(t){t?cc.glBlendFunc(cc.BLEND_SRC,cc.BLEND_DST):cc.glBlendFunc(cc._renderContext.ONE,cc._renderContext.ZERO)},t.setGLDefaultValues=function(){this.setAlphaBlending(!0),this.setProjection(this._projection),cc._renderContext.clearColor(0,0,0,0)})}),!function(){function c(t,e,i,n,s,r,o){this.prev=t,this.next=e,this.callback=i,this.target=n,this.priority=s,this.paused=r,this.markedForDeletion=o}function o(t,e,i,n){this.list=t,this.entry=e,this.target=i,this.callback=n}function l(t,e,i,n,s,r){this.timers=t,this.target=e,this.timerIndex=i,this.currentTimer=n,this.currentTimerSalvaged=s,this.paused=r}function u(){this._scheduler=null,this._elapsed=-1,this._useDelay=this._runForever=!1,this._interval=this._delay=this._repeat=this._timesExecuted=0,this._key=this._callback=this._target=null}var h=[],r=(c.get=function(t,e,i,n,s,r,o){var a=h.pop();return a?(a.prev=t,a.next=e,a.callback=i,a.target=n,a.priority=s,a.paused=r,a.markedForDeletion=o):a=new c(t,e,i,n,s,r,o),a},c.put=function(t){t.prev=null,t.next=null,t.callback=null,t.target=null,t.priority=0,t.paused=!1,t.markedForDeletion=!1,h.length<20&&h.push(t)},[]),a=(o.get=function(t,e,i,n){var s=r.pop();return s?(s.list=t,s.entry=e,s.target=i,s.callback=n):s=new o(t,e,i,n),s},o.put=function(t){t.list=null,t.entry=null,t.target=null,t.callback=null,r.length<20&&r.push(t)},[]),e=(l.get=function(t,e,i,n,s,r){var o=a.pop();return o?(o.timers=t,o.target=e,o.timerIndex=i,o.currentTimer=n,o.currentTimerSalvaged=s,o.paused=r):o=new l(t,e,i,n,s,r),o},l.put=function(t){t.timers=null,t.target=null,t.timerIndex=0,t.currentTimer=null,t.currentTimerSalvaged=!1,t.paused=!1,a.length<20&&a.push(t)},cc.inject({initWithCallback:function(t,e,i,n,s,r,o){return this._scheduler=t,this._target=i,this._callback=e,o&&(this._key=o),this._elapsed=-1,this._interval=n,this._delay=r,this._useDelay=0<this._delay,this._repeat=s,this._runForever=this._repeat===cc.REPEAT_FOREVER,!0},getInterval:function(){return this._interval},setInterval:function(t){this._interval=t},update:function(t){-1===this._elapsed?this._timesExecuted=this._elapsed=0:(this._elapsed+=t,this._runForever&&!this._useDelay?this._elapsed>=this._interval&&(this.trigger(),this._elapsed=0):(this._useDelay?this._elapsed>=this._delay&&(this.trigger(),this._elapsed-=this._delay,this._timesExecuted+=1,this._useDelay=!1):this._elapsed>=this._interval&&(this.trigger(),this._elapsed=0,this._timesExecuted+=1),this._callback&&!this._runForever&&this._timesExecuted>this._repeat&&this.cancel()))},getCallback:function(){return this._callback},getKey:function(){return this._key},trigger:function(){this._target&&this._callback&&this._callback.call(this._target,this._elapsed)},cancel:function(){this._scheduler.unschedule(this._callback,this._target)}},u.prototype),[]);u.get=function(){return e.pop()||new u},cc.Scheduler=cc.Class.extend({_timeScale:1,_updatesNegList:null,_updates0List:null,_updatesPosList:null,_hashForTimers:null,_arrayForTimers:null,_hashForUpdates:null,_currentTarget:null,_currentTargetSalvaged:!(u.put=function(t){t._scheduler=null,t._elapsed=-1,t._runForever=!1,t._useDelay=!1,t._timesExecuted=0,t._repeat=0,t._delay=0,t._interval=0,t._target=null,t._callback=null,t._key=null,e.length<20&&e.push(t)}),_updateHashLocked:!1,ctor:function(){this._timeScale=1,this._updatesNegList=[],this._updates0List=[],this._updatesPosList=[],this._hashForUpdates={},this._hashForTimers={},this._currentTarget=null,this._updateHashLocked=this._currentTargetSalvaged=!1,this._arrayForTimers=[]},_schedulePerFrame:function(t,e,i,n){var s=this._hashForUpdates[e.__instanceId];if(s&&s.entry){if(s.entry.priority===i)return s.entry.markedForDeletion=!1,void(s.entry.paused=n);if(this._updateHashLocked)return cc.log("warning: you CANNOT change update priority in scheduled function"),s.entry.markedForDeletion=!1,void(s.entry.paused=n);this.unscheduleUpdate(e)}0===i?this._appendIn(this._updates0List,t,e,n):i<0?this._priorityIn(this._updatesNegList,t,e,i,n):this._priorityIn(this._updatesPosList,t,e,i,n)},_removeHashElement:function(t){delete this._hashForTimers[t.target.__instanceId];for(var e=this._arrayForTimers,i=0,n=e.length;i<n;i++)if(e[i]===t){e.splice(i,1);break}l.put(t)},_removeUpdateFromHash:function(t){if(t=this._hashForUpdates[t.target.__instanceId]){for(var e=t.list,i=t.entry,n=0,s=e.length;n<s;n++)if(e[n]===i){e.splice(n,1);break}delete this._hashForUpdates[t.target.__instanceId],c.put(i),o.put(t)}},_priorityIn:function(t,e,i,n,s){if(e=c.get(null,null,e,i,n,s,!1),t){s=t.length-1;for(var r=0;r<=s&&!(n<t[r].priority);r++);t.splice(r,0,e)}else(t=[]).push(e);return this._hashForUpdates[i.__instanceId]=o.get(t,e,i,null),t},_appendIn:function(t,e,i,n){e=c.get(null,null,e,i,0,n,!1),t.push(e),this._hashForUpdates[i.__instanceId]=o.get(t,e,i,null,null)},setTimeScale:function(t){this._timeScale=t},getTimeScale:function(){return this._timeScale},update:function(t){var e,i,n,s;for(this._updateHashLocked=!0,1!==this._timeScale&&(t*=this._timeScale),e=0,n=(i=this._updatesNegList).length;e<n;e++)(s=i[e]).paused||s.markedForDeletion||s.callback(t);for(e=0,n=(i=this._updates0List).length;e<n;e++)(s=i[e]).paused||s.markedForDeletion||s.callback(t);for(e=0,n=(i=this._updatesPosList).length;e<n;e++)(s=i[e]).paused||s.markedForDeletion||s.callback(t);for(n=this._arrayForTimers,e=0;e<n.length;e++){if(this._currentTarget=i=n[e],this._currentTargetSalvaged=!1,!i.paused)for(i.timerIndex=0;i.timerIndex<i.timers.length;++i.timerIndex)i.currentTimer=i.timers[i.timerIndex],i.currentTimerSalvaged=!1,i.currentTimer.update(t),i.currentTimer=null;this._currentTargetSalvaged&&0===this._currentTarget.timers.length&&this._removeHashElement(this._currentTarget)}for(e=0,i=this._updatesNegList;e<i.length;)(s=i[e]).markedForDeletion?this._removeUpdateFromHash(s):e++;for(e=0,i=this._updates0List;e<i.length;)(s=i[e]).markedForDeletion?this._removeUpdateFromHash(s):e++;for(e=0,i=this._updatesPosList;e<i.length;)(s=i[e]).markedForDeletion?this._removeUpdateFromHash(s):e++;this._updateHashLocked=!1,this._currentTarget=null},scheduleCallbackForTarget:function(t,e,i,n,s,r){this.schedule(e,t,i,n,s,r,t.__instanceId+"")},schedule:function(t,e,i,n,s,r,o){var a,c,h;if("function"!=typeof t&&(a=t,t=e,e=a),4!==arguments.length&&5!==arguments.length||(o=s,r=n,n=cc.REPEAT_FOREVER,s=0),void 0===o&&(o=e.__instanceId+""),cc.assert(e,cc._LogInfos.Scheduler_scheduleCallbackForTarget_3),(a=this._hashForTimers[e.__instanceId])?cc.assert(a.paused===r,""):(a=l.get(null,e,0,null,null,r),this._arrayForTimers.push(a),this._hashForTimers[e.__instanceId]=a),null==a.timers)a.timers=[];else for(h=0;h<a.timers.length;h++)if(c=a.timers[h],t===c._callback)return cc.log(cc._LogInfos.Scheduler_scheduleCallbackForTarget,c.getInterval().toFixed(4),i.toFixed(4)),void(c._interval=i);(c=u.get()).initWithCallback(this,t,e,i,n,s,o),a.timers.push(c)},scheduleUpdate:function(e,t,i){this._schedulePerFrame(function(t){e.update(t)},e,t,i)},_getUnscheduleMark:function(t,e){switch(typeof t){case"number":case"string":return t===e._key;case"function":return t===e._callback}},unschedule:function(t,e){if(e&&t){var i=this._hashForTimers[e.__instanceId];if(i)for(var n=i.timers,s=0,r=n.length;s<r;s++){var o=n[s];if(this._getUnscheduleMark(t,o)){o!==i.currentTimer||i.currentTimerSalvaged||(i.currentTimerSalvaged=!0),n.splice(s,1),u.put(o),i.timerIndex>=s&&i.timerIndex--,0===n.length&&(this._currentTarget===i?this._currentTargetSalvaged=!0:this._removeHashElement(i));break}}}},unscheduleUpdate:function(t){(t=t&&this._hashForUpdates[t.__instanceId])&&(this._updateHashLocked?t.entry.markedForDeletion=!0:this._removeUpdateFromHash(t.entry))},unscheduleAllForTarget:function(t){if(t){var e=this._hashForTimers[t.__instanceId];if(e){var i=e.timers;-1<i.indexOf(e.currentTimer)&&!e.currentTimerSalvaged&&(e.currentTimerSalvaged=!0);for(var n=0,s=i.length;n<s;n++)u.put(i[n]);i.length=0,this._currentTarget===e?this._currentTargetSalvaged=!0:this._removeHashElement(e)}this.unscheduleUpdate(t)}},unscheduleAll:function(){this.unscheduleAllWithMinPriority(cc.Scheduler.PRIORITY_SYSTEM)},unscheduleAllWithMinPriority:function(t){for(var e,i=this._arrayForTimers,n=i.length-1;0<=n;n--)e=i[n],this.unscheduleAllForTarget(e.target);if(t<(i=0))for(n=0;n<this._updatesNegList.length;)i=this._updatesNegList.length,(e=this._updatesNegList[n])&&e.priority>=t&&this.unscheduleUpdate(e.target),i==this._updatesNegList.length&&n++;if(t<=0)for(n=0;n<this._updates0List.length;)i=this._updates0List.length,(e=this._updates0List[n])&&this.unscheduleUpdate(e.target),i==this._updates0List.length&&n++;for(n=0;n<this._updatesPosList.length;)i=this._updatesPosList.length,(e=this._updatesPosList[n])&&e.priority>=t&&this.unscheduleUpdate(e.target),i==this._updatesPosList.length&&n++},isScheduled:function(t,e){cc.assert(t,"Argument callback must not be empty"),cc.assert(e,"Argument target must be non-nullptr");var i=this._hashForTimers[e.__instanceId];if(i&&null!=i.timers)for(var i=i.timers,n=0;n<i.length;++n)if(t===i[n]._callback)return!0;return!1},pauseAllTargets:function(){return this.pauseAllTargetsWithMinPriority(cc.Scheduler.PRIORITY_SYSTEM)},pauseAllTargetsWithMinPriority:function(t){for(var e,i=[],n=this._arrayForTimers,s=0,r=n.length;s<r;s++)(e=n[s])&&(e.paused=!0,i.push(e.target));if(t<0)for(s=0;s<this._updatesNegList.length;s++)(e=this._updatesNegList[s])&&e.priority>=t&&(e.paused=!0,i.push(e.target));if(t<=0)for(s=0;s<this._updates0List.length;s++)(e=this._updates0List[s])&&(e.paused=!0,i.push(e.target));for(s=0;s<this._updatesPosList.length;s++)(e=this._updatesPosList[s])&&e.priority>=t&&(e.paused=!0,i.push(e.target));return i},resumeTargets:function(t){if(t)for(var e=0;e<t.length;e++)this.resumeTarget(t[e])},pauseTarget:function(t){cc.assert(t,cc._LogInfos.Scheduler_pauseTarget);var e=this._hashForTimers[t.__instanceId];e&&(e.paused=!0),(t=this._hashForUpdates[t.__instanceId])&&(t.entry.paused=!0)},resumeTarget:function(t){cc.assert(t,cc._LogInfos.Scheduler_resumeTarget);var e=this._hashForTimers[t.__instanceId];e&&(e.paused=!1),(t=this._hashForUpdates[t.__instanceId])&&(t.entry.paused=!1)},isTargetPaused:function(t){cc.assert(t,cc._LogInfos.Scheduler_isTargetPaused);var e=this._hashForTimers[t.__instanceId];return e?e.paused:!!(t=this._hashForUpdates[t.__instanceId])&&t.entry.paused},scheduleUpdateForTarget:function(t,e,i){this.scheduleUpdate(t,e,i)},unscheduleCallbackForTarget:function(t,e){this.unschedule(e,t)},unscheduleUpdateForTarget:function(t){this.unscheduleUpdate(t)},unscheduleAllCallbacksForTarget:function(t){this.unschedule(t.__instanceId+"",t)},unscheduleAllCallbacks:function(){this.unscheduleAllWithMinPriority(cc.Scheduler.PRIORITY_SYSTEM)},unscheduleAllCallbacksWithMinPriority:function(t){this.unscheduleAllWithMinPriority(t)}}),cc.Scheduler.PRIORITY_SYSTEM=-2147483648,cc.Scheduler.PRIORITY_NON_SYSTEM=cc.Scheduler.PRIORITY_SYSTEM+1}(),cc.PI2=2*Math.PI,cc.DrawingPrimitiveCanvas=cc.Class.extend({_cacheArray:[],_renderContext:null,ctor:function(t){this._renderContext=t},drawPoint:function(t,e){e=e||1;var i=this._renderContext.getContext();i.beginPath(),i.arc(t.x,-t.y,e,0,2*Math.PI,!1),i.closePath(),i.fill()},drawPoints:function(t,e,i){if(null!=t){i=i||1,(e=this._renderContext.getContext()).beginPath();for(var n=0,s=t.length;n<s;n++)e.arc(t[n].x,-t[n].y,i,0,2*Math.PI,!1);e.closePath(),e.fill()}},drawLine:function(t,e){var i=this._renderContext.getContext();i.beginPath(),i.moveTo(t.x,-t.y),i.lineTo(e.x,-e.y),i.closePath(),i.stroke()},drawRect:function(t,e){this.drawLine(cc.p(t.x,t.y),cc.p(e.x,t.y)),this.drawLine(cc.p(e.x,t.y),cc.p(e.x,e.y)),this.drawLine(cc.p(e.x,e.y),cc.p(t.x,e.y)),this.drawLine(cc.p(t.x,e.y),cc.p(t.x,t.y))},drawSolidRect:function(t,e,i){t=[t,cc.p(e.x,t.y),e,cc.p(t.x,e.y)],this.drawSolidPoly(t,4,i)},drawPoly:function(t,e,i,n){if(n=n||!1,null!=t){if(t.length<3)throw Error("Polygon's point must greater than 2");var s=t[0];(e=this._renderContext.getContext()).beginPath(),e.moveTo(s.x,-s.y);for(var s=1,r=t.length;s<r;s++)e.lineTo(t[s].x,-t[s].y);i&&e.closePath(),n?e.fill():e.stroke()}},drawSolidPoly:function(t,e,i){this.setDrawColor(i.r,i.g,i.b,i.a),this.drawPoly(t,e,!0,!0)},drawCircle:function(t,e,i,n,s){s=s||!1,(n=this._renderContext.getContext()).beginPath(),n.arc(0|t.x,0|-t.y,e,-i,-(i-2*Math.PI),!1),s&&n.lineTo(0|t.x,0|-t.y),n.stroke()},drawQuadBezier:function(t,e,i,n){for(var s=this._cacheArray,r=s.length=0,o=0;o<n;o++){var a=Math.pow(1-r,2)*t.x+2*(1-r)*r*e.x+r*r*i.x,c=Math.pow(1-r,2)*t.y+2*(1-r)*r*e.y+r*r*i.y;s.push(cc.p(a,c)),r+=1/n}s.push(cc.p(i.x,i.y)),this.drawPoly(s,n+1,!1,!1)},drawCubicBezier:function(t,e,i,n,s){for(var r=this._cacheArray,o=r.length=0,a=0;a<s;a++){var c=Math.pow(1-o,3)*t.x+3*Math.pow(1-o,2)*o*e.x+3*(1-o)*o*o*i.x+o*o*o*n.x,h=Math.pow(1-o,3)*t.y+3*Math.pow(1-o,2)*o*e.y+3*(1-o)*o*o*i.y+o*o*o*n.y;r.push(cc.p(c,h)),o+=1/s}r.push(cc.p(n.x,n.y)),this.drawPoly(r,s+1,!1,!1)},drawCatmullRom:function(t,e){this.drawCardinalSpline(t,.5,e)},drawCardinalSpline:function(t,e,i){cc._renderContext.setStrokeStyle("rgba(255,255,255,1)");var n=this._cacheArray;n.length=0;for(var s,r,o=1/t.length,a=0;a<i+1;a++)r=1===(r=a/i)?(s=t.length-1,1):(r-o*(s=0|r/o))/o,s=cc.CardinalSplineAt(cc.getControlPointAt(t,s-1),cc.getControlPointAt(t,+s),cc.getControlPointAt(t,s+1),cc.getControlPointAt(t,s+2),e,r),n.push(s);this.drawPoly(n,i+1,!1,!1)},drawImage:function(t,e,i,n,s){var r=arguments.length,o=this._renderContext.getContext();switch(r){case 2:o.drawImage(t,e.x,-(e.y+t.height));break;case 3:o.drawImage(t,e.x,-(e.y+i.height),i.width,i.height);break;case 5:o.drawImage(t,e.x,e.y,i.width,i.height,n.x,-(n.y+s.height),s.width,s.height);break;default:throw Error("Argument must be non-nil")}},drawStar:function(t,e,i){var n=(t=t||this._renderContext).getContext(),s=(i="rgba("+(0|i.r)+","+(0|i.g)+","+(0|i.b),t.setFillStyle(i+",1)"),e/10),r=(n.beginPath(),n.moveTo(-e,e),n.lineTo(0,s),n.lineTo(e,e),n.lineTo(s,0),n.lineTo(e,-e),n.lineTo(0,-s),n.lineTo(-e,-e),n.lineTo(-s,0),n.lineTo(-e,e),n.closePath(),n.fill(),n.createRadialGradient(0,0,s,0,0,e));r.addColorStop(0,i+", 1)"),r.addColorStop(.3,i+", 0.8)"),r.addColorStop(1,i+", 0.0)"),t.setFillStyle(r),n.beginPath(),n.arc(0,0,e-s,0,cc.PI2,!1),n.closePath(),n.fill()},drawColorBall:function(t,e,i){var n=(t=t||this._renderContext).getContext(),s=(i="rgba("+(0|i.r)+","+(0|i.g)+","+(0|i.b),n.createRadialGradient(0,0,e/10,0,0,e));s.addColorStop(0,i+", 1)"),s.addColorStop(.3,i+", 0.8)"),s.addColorStop(.6,i+", 0.4)"),s.addColorStop(1,i+", 0.0)"),t.setFillStyle(s),n.beginPath(),n.arc(0,0,e,0,cc.PI2,!1),n.closePath(),n.fill()},fillText:function(t,e,i){this._renderContext.getContext().fillText(t,e,-i)},setDrawColor:function(t,e,i,n){this._renderContext.setFillStyle("rgba("+t+","+e+","+i+","+n/255+")"),this._renderContext.setStrokeStyle("rgba("+t+","+e+","+i+","+n/255+")")},setPointSize:function(t){},setLineWidth:function(t){this._renderContext.getContext().lineWidth=t}}),cc.DrawingPrimitiveWebGL=cc.Class.extend({_renderContext:null,_initialized:!1,_shader:null,_colorLocation:"u_color",_colorArray:null,_pointSizeLocation:"u_pointSize",_pointSize:-1,ctor:function(t){if(!(t=null==t?cc._renderContext:t)instanceof WebGLRenderingContext)throw Error("Can't initialise DrawingPrimitiveWebGL. context need is WebGLRenderingContext");this._renderContext=t,this._colorArray=new Float32Array([1,1,1,1])},lazy_init:function(){this._initialized||(this._shader=cc.shaderCache.programForKey(cc.SHADER_POSITION_UCOLOR),this._shader._addUniformLocation(this._colorLocation),this._shader._addUniformLocation(this._pointSizeLocation),this._glProgramState=cc.GLProgramState.getOrCreateWithGLProgram(this._shader),this._initialized=!0)},drawInit:function(){this._initialized=!1},drawPoint:function(t){this.lazy_init();var e=this._renderContext,i=(this._glProgramState.apply(),this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),e.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),this._shader.setUniformLocationWith4fv(this._colorLocation,this._colorArray),this._shader.setUniformLocationWith1f(this._pointSizeLocation,this._pointSize),e.createBuffer());e.bindBuffer(e.ARRAY_BUFFER,i),e.bufferData(e.ARRAY_BUFFER,new Float32Array([t.x,t.y]),e.STATIC_DRAW),e.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,e.FLOAT,!1,0,0),e.drawArrays(e.POINTS,0,1),e.deleteBuffer(i),cc.incrementGLDraws(1)},drawPoints:function(t,e){var i,n;t&&0!==t.length&&(this.lazy_init(),i=this._renderContext,this._glProgramState.apply(),this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),i.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),this._shader.setUniformLocationWith4fv(this._colorLocation,this._colorArray),this._shader.setUniformLocationWith1f(this._pointSizeLocation,this._pointSize),n=i.createBuffer(),i.bindBuffer(i.ARRAY_BUFFER,n),i.bufferData(i.ARRAY_BUFFER,this._pointsToTypeArray(t),i.STATIC_DRAW),i.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,i.FLOAT,!1,0,0),i.drawArrays(i.POINTS,0,t.length),i.deleteBuffer(n),cc.incrementGLDraws(1))},_pointsToTypeArray:function(t){for(var e=new Float32Array(2*t.length),i=0;i<t.length;i++)e[2*i]=t[i].x,e[2*i+1]=t[i].y;return e},drawLine:function(t,e){this.lazy_init();var i=this._renderContext,n=(this._glProgramState.apply(),this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),i.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),this._shader.setUniformLocationWith4fv(this._colorLocation,this._colorArray),i.createBuffer());i.bindBuffer(i.ARRAY_BUFFER,n),i.bufferData(i.ARRAY_BUFFER,this._pointsToTypeArray([t,e]),i.STATIC_DRAW),i.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,i.FLOAT,!1,0,0),i.drawArrays(i.LINES,0,2),i.deleteBuffer(n),cc.incrementGLDraws(1)},drawRect:function(t,e){this.drawLine(cc.p(t.x,t.y),cc.p(e.x,t.y)),this.drawLine(cc.p(e.x,t.y),cc.p(e.x,e.y)),this.drawLine(cc.p(e.x,e.y),cc.p(t.x,e.y)),this.drawLine(cc.p(t.x,e.y),cc.p(t.x,t.y))},drawSolidRect:function(t,e,i){t=[t,cc.p(e.x,t.y),e,cc.p(t.x,e.y)],this.drawSolidPoly(t,4,i)},drawPoly:function(t,e,i){this.lazy_init(),e=this._renderContext,this._glProgramState.apply(),this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),e.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),this._shader.setUniformLocationWith4fv(this._colorLocation,this._colorArray);var n=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,n),e.bufferData(e.ARRAY_BUFFER,this._pointsToTypeArray(t),e.STATIC_DRAW),e.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,e.FLOAT,!1,0,0),i?e.drawArrays(e.LINE_LOOP,0,t.length):e.drawArrays(e.LINE_STRIP,0,t.length),e.deleteBuffer(n),cc.incrementGLDraws(1)},drawSolidPoly:function(t,e,i){this.lazy_init(),i&&this.setDrawColor(i.r,i.g,i.b,i.a),e=this._renderContext,this._glProgramState.apply(),this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),e.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),this._shader.setUniformLocationWith4fv(this._colorLocation,this._colorArray),i=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,i),e.bufferData(e.ARRAY_BUFFER,this._pointsToTypeArray(t),e.STATIC_DRAW),e.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,e.FLOAT,!1,0,0),e.drawArrays(e.TRIANGLE_FAN,0,t.length),e.deleteBuffer(i),cc.incrementGLDraws(1)},drawCircle:function(t,e,i,n,s){this.lazy_init();var r=1,o=(s&&r++,2*Math.PI/n);if(s=new Float32Array(2*(n+2))){for(var a=0;a<=n;a++){var c=a*o,h=e*Math.cos(c+i)+t.x,c=e*Math.sin(c+i)+t.y;s[2*a]=h,s[2*a+1]=c}s[2*(n+1)]=t.x,s[2*(n+1)+1]=t.y,t=this._renderContext,this._glProgramState.apply(),this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),t.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),this._shader.setUniformLocationWith4fv(this._colorLocation,this._colorArray),e=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,e),t.bufferData(t.ARRAY_BUFFER,s,t.STATIC_DRAW),t.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,t.FLOAT,!1,0,0),t.drawArrays(t.LINE_STRIP,0,n+r),t.deleteBuffer(e),cc.incrementGLDraws(1)}},drawQuadBezier:function(t,e,i,n){this.lazy_init();for(var s=new Float32Array(2*(n+1)),r=0,o=0;o<n;o++)s[2*o]=Math.pow(1-r,2)*t.x+2*(1-r)*r*e.x+r*r*i.x,s[2*o+1]=Math.pow(1-r,2)*t.y+2*(1-r)*r*e.y+r*r*i.y,r+=1/n;s[2*n]=i.x,s[2*n+1]=i.y,t=this._renderContext,this._glProgramState.apply(),this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),t.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),this._shader.setUniformLocationWith4fv(this._colorLocation,this._colorArray),e=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,e),t.bufferData(t.ARRAY_BUFFER,s,t.STATIC_DRAW),t.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,t.FLOAT,!1,0,0),t.drawArrays(t.LINE_STRIP,0,n+1),t.deleteBuffer(e),cc.incrementGLDraws(1)},drawCubicBezier:function(t,e,i,n,s){this.lazy_init();for(var r=new Float32Array(2*(s+1)),o=0,a=0;a<s;a++)r[2*a]=Math.pow(1-o,3)*t.x+3*Math.pow(1-o,2)*o*e.x+3*(1-o)*o*o*i.x+o*o*o*n.x,r[2*a+1]=Math.pow(1-o,3)*t.y+3*Math.pow(1-o,2)*o*e.y+3*(1-o)*o*o*i.y+o*o*o*n.y,o+=1/s;r[2*s]=n.x,r[2*s+1]=n.y,t=this._renderContext,this._glProgramState.apply(),this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),t.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),this._shader.setUniformLocationWith4fv(this._colorLocation,this._colorArray),e=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,e),t.bufferData(t.ARRAY_BUFFER,r,t.STATIC_DRAW),t.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,t.FLOAT,!1,0,0),t.drawArrays(t.LINE_STRIP,0,s+1),t.deleteBuffer(e),cc.incrementGLDraws(1)},drawCatmullRom:function(t,e){this.drawCardinalSpline(t,.5,e)},drawCardinalSpline:function(t,e,i){this.lazy_init();for(var n,s,r=new Float32Array(2*(i+1)),o=1/t.length,a=0;a<i+1;a++)s=1===(s=a/i)?(n=t.length-1,1):(s-o*(n=0|s/o))/o,n=cc.cardinalSplineAt(cc.getControlPointAt(t,n-1),cc.getControlPointAt(t,n),cc.getControlPointAt(t,n+1),cc.getControlPointAt(t,n+2),e,s),r[2*a]=n.x,r[2*a+1]=n.y;t=this._renderContext,this._glProgramState.apply(),this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),t.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),this._shader.setUniformLocationWith4fv(this._colorLocation,this._colorArray),e=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,e),t.bufferData(t.ARRAY_BUFFER,r,t.STATIC_DRAW),t.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,t.FLOAT,!1,0,0),t.drawArrays(t.LINE_STRIP,0,i+1),t.deleteBuffer(e),cc.incrementGLDraws(1)},setDrawColor:function(t,e,i,n){this._colorArray[0]=t/255,this._colorArray[1]=e/255,this._colorArray[2]=i/255,this._colorArray[3]=n/255},setPointSize:function(t){this._pointSize=t*cc.contentScaleFactor()},setLineWidth:function(t){this._renderContext.lineWidth&&this._renderContext.lineWidth(t)}}),cc._tmp.PrototypeLabelTTF=function(){var t=cc.LabelTTF.prototype;cc.defineGetterSetter(t,"color",t.getColor,t.setColor),cc.defineGetterSetter(t,"opacity",t.getOpacity,t.setOpacity),cc.defineGetterSetter(t,"string",t.getString,t.setString),cc.defineGetterSetter(t,"textAlign",t.getHorizontalAlignment,t.setHorizontalAlignment),cc.defineGetterSetter(t,"verticalAlign",t.getVerticalAlignment,t.setVerticalAlignment),cc.defineGetterSetter(t,"fontSize",t.getFontSize,t.setFontSize),cc.defineGetterSetter(t,"fontName",t.getFontName,t.setFontName),cc.defineGetterSetter(t,"font",t._getFont,t._setFont),cc.defineGetterSetter(t,"boundingWidth",t._getBoundingWidth,t._setBoundingWidth),cc.defineGetterSetter(t,"boundingHeight",t._getBoundingHeight,t._setBoundingHeight),cc.defineGetterSetter(t,"fillStyle",t._getFillStyle,t.setFontFillColor),cc.defineGetterSetter(t,"strokeStyle",t._getStrokeStyle,t._setStrokeStyle),cc.defineGetterSetter(t,"lineWidth",t._getLineWidth,t._setLineWidth),cc.defineGetterSetter(t,"shadowOffsetX",t._getShadowOffsetX,t._setShadowOffsetX),cc.defineGetterSetter(t,"shadowOffsetY",t._getShadowOffsetY,t._setShadowOffsetY),cc.defineGetterSetter(t,"shadowOpacity",t._getShadowOpacity,t._setShadowOpacity),cc.defineGetterSetter(t,"shadowBlur",t._getShadowBlur,t._setShadowBlur)},cc.LabelTTF=cc.Sprite.extend({_dimensions:null,_hAlignment:cc.TEXT_ALIGNMENT_CENTER,_vAlignment:cc.VERTICAL_TEXT_ALIGNMENT_TOP,_fontName:null,_fontSize:0,_string:"",_originalText:null,_onCacheCanvasMode:!0,_shadowEnabled:!1,_shadowOffset:null,_shadowOpacity:0,_shadowBlur:0,_shadowColor:null,_strokeEnabled:!1,_strokeColor:null,_strokeSize:0,_textFillColor:null,_strokeShadowOffsetX:0,_strokeShadowOffsetY:0,_needUpdateTexture:!1,_lineWidths:null,_className:"LabelTTF",_fontStyle:"normal",_fontWeight:"normal",_lineHeight:"normal",initWithString:function(t,e,i,n,s,r){return t=t?t+"":"",i=i||16,n=n||cc.size(0,0),s=s||cc.TEXT_ALIGNMENT_LEFT,r=r||cc.VERTICAL_TEXT_ALIGNMENT_TOP,this._opacityModifyRGB=!1,this._dimensions=cc.size(n.width,n.height),this._fontName=e||"Arial",this._hAlignment=s,this._vAlignment=r,this._fontSize=i,this._renderCmd._setFontStyle(this._fontName,i,this._fontStyle,this._fontWeight),this.string=t,this._renderCmd._setColorsString(),this._renderCmd._updateTexture(),this._setUpdateTextureDirty(),this._scaleX=this._scaleY=1/cc.view.getDevicePixelRatio(),!0},_setUpdateTextureDirty:function(){this._needUpdateTexture=!0,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.textDirty)},ctor:function(t,e,i,n,s,r){cc.Sprite.prototype.ctor.call(this),this._dimensions=cc.size(0,0),this._hAlignment=cc.TEXT_ALIGNMENT_LEFT,this._vAlignment=cc.VERTICAL_TEXT_ALIGNMENT_TOP,this._opacityModifyRGB=!1,this._fontName="Arial",this._shadowEnabled=!1,this._shadowOffset=cc.p(0,0),this._shadowBlur=this._shadowOpacity=0,this._strokeEnabled=!1,this._strokeColor=cc.color(255,255,255,255),this._strokeSize=0,this._textFillColor=cc.color(255,255,255,255),this._strokeShadowOffsetY=this._strokeShadowOffsetX=0,this._needUpdateTexture=!1,this._lineWidths=[],this._renderCmd._setColorsString(),this._textureLoaded=!0,e&&e instanceof cc.FontDefinition?this.initWithStringAndTextDefinition(t,e):cc.LabelTTF.prototype.initWithString.call(this,t,e,i,n,s,r)},init:function(){return this.initWithString(" ",this._fontName,this._fontSize)},description:function(){return"<cc.LabelTTF | FontName ="+this._fontName+" FontSize = "+this._fontSize.toFixed(1)+">"},getLineHeight:function(){return this._lineHeight&&!this._lineHeight.charAt&&this._lineHeight||this._renderCmd._getFontClientHeight()},setLineHeight:function(t){this._lineHeight=t},getString:function(){return this._string},getHorizontalAlignment:function(){return this._hAlignment},getVerticalAlignment:function(){return this._vAlignment},getDimensions:function(){return cc.size(this._dimensions)},getFontSize:function(){return this._fontSize},getFontName:function(){return this._fontName},initWithStringAndTextDefinition:function(t,e){return this._updateWithTextDefinition(e,!1),this.string=t,!0},setTextDefinition:function(t){t&&this._updateWithTextDefinition(t,!0)},getTextDefinition:function(){return this._prepareTextDefinition(!1)},enableShadow:function(t,e,i,n){null!=t.r&&null!=t.g&&null!=t.b&&null!=t.a?this._enableShadow(t,e,i):this._enableShadowNoneColor(t,e,i,n)},_enableShadowNoneColor:function(t,e,i,n){i=i||.5,!1===this._shadowEnabled&&(this._shadowEnabled=!0);var s=this._shadowOffset;(s&&s.x!==t||s._y!==e)&&(s.x=t,s.y=e),this._shadowOpacity!==i&&(this._shadowOpacity=i),this._renderCmd._setColorsString(),this._shadowBlur!==n&&(this._shadowBlur=n),this._setUpdateTextureDirty()},_enableShadow:function(t,e,i){this._shadowColor||(this._shadowColor=cc.color(255,255,255,128)),this._shadowColor.r=t.r,this._shadowColor.g=t.g,this._shadowColor.b=t.b,this._enableShadowNoneColor(e.width||e.x||0,e.height||e.y||0,null!=t.a?t.a/255:.5,i)},_getShadowOffsetX:function(){return this._shadowOffset.x},_setShadowOffsetX:function(t){!1===this._shadowEnabled&&(this._shadowEnabled=!0),this._shadowOffset.x!==t&&(this._shadowOffset.x=t,this._setUpdateTextureDirty())},_getShadowOffsetY:function(){return this._shadowOffset._y},_setShadowOffsetY:function(t){!1===this._shadowEnabled&&(this._shadowEnabled=!0),this._shadowOffset._y!==t&&(this._shadowOffset._y=t,this._setUpdateTextureDirty())},_getShadowOffset:function(){return cc.p(this._shadowOffset.x,this._shadowOffset.y)},_setShadowOffset:function(t){!1===this._shadowEnabled&&(this._shadowEnabled=!0),this._shadowOffset.x===t.x&&this._shadowOffset.y===t.y||(this._shadowOffset.x=t.x,this._shadowOffset.y=t.y,this._setUpdateTextureDirty())},_getShadowOpacity:function(){return this._shadowOpacity},_setShadowOpacity:function(t){!1===this._shadowEnabled&&(this._shadowEnabled=!0),this._shadowOpacity!==t&&(this._shadowOpacity=t,this._renderCmd._setColorsString(),this._setUpdateTextureDirty())},_getShadowBlur:function(){return this._shadowBlur},_setShadowBlur:function(t){!1===this._shadowEnabled&&(this._shadowEnabled=!0),this._shadowBlur!==t&&(this._shadowBlur=t,this._setUpdateTextureDirty())},disableShadow:function(){this._shadowEnabled&&(this._shadowEnabled=!1,this._setUpdateTextureDirty())},enableStroke:function(t,e){!1===this._strokeEnabled&&(this._strokeEnabled=!0);var i=this._strokeColor;i.r===t.r&&i.g===t.g&&i.b===t.b||(i.r=t.r,i.g=t.g,i.b=t.b,this._renderCmd._setColorsString()),this._strokeSize!==e&&(this._strokeSize=e||0),this._setUpdateTextureDirty()},_getStrokeStyle:function(){return this._strokeColor},_setStrokeStyle:function(t){!1===this._strokeEnabled&&(this._strokeEnabled=!0);var e=this._strokeColor;e.r===t.r&&e.g===t.g&&e.b===t.b||(e.r=t.r,e.g=t.g,e.b=t.b,this._renderCmd._setColorsString(),this._setUpdateTextureDirty())},_getLineWidth:function(){return this._strokeSize},_setLineWidth:function(t){!1===this._strokeEnabled&&(this._strokeEnabled=!0),this._strokeSize!==t&&(this._strokeSize=t||0,this._setUpdateTextureDirty())},disableStroke:function(){this._strokeEnabled&&(this._strokeEnabled=!1,this._setUpdateTextureDirty())},setFontFillColor:function(t){var e=this._textFillColor;e.r===t.r&&e.g===t.g&&e.b===t.b||(e.r=t.r,e.g=t.g,e.b=t.b,this._renderCmd._setColorsString(),this._needUpdateTexture=!0)},_getFillStyle:function(){return this._textFillColor},_updateWithTextDefinition:function(t,e){t.fontDimensions?(this._dimensions.width=t.boundingWidth,this._dimensions.height=t.boundingHeight):(this._dimensions.width=0,this._dimensions.height=0),this._hAlignment=t.textAlign,this._vAlignment=t.verticalAlign,this._fontName=t.fontName,this._fontSize=t.fontSize||12,this._lineHeight=t.lineHeight||this._fontSize,this._renderCmd._setFontStyle(t),t.shadowEnabled&&this.enableShadow(t.shadowOffsetX,t.shadowOffsetY,t.shadowOpacity,t.shadowBlur),t.strokeEnabled&&this.enableStroke(t.strokeStyle,t.lineWidth),this.setFontFillColor(t.fillStyle),e&&this._renderCmd._updateTexture();t=cc.Node._dirtyFlags;this._renderCmd.setDirtyFlag(t.colorDirty|t.opacityDirty|t.textDirty)},_prepareTextDefinition:function(t){var e,i=new cc.FontDefinition;return t?(i.fontSize=this._fontSize,i.boundingWidth=cc.contentScaleFactor()*this._dimensions.width,i.boundingHeight=cc.contentScaleFactor()*this._dimensions.height):(i.fontSize=this._fontSize,i.boundingWidth=this._dimensions.width,i.boundingHeight=this._dimensions.height),i.fontName=this._fontName,i.textAlign=this._hAlignment,i.verticalAlign=this._vAlignment,this._strokeEnabled?(i.strokeEnabled=!0,e=this._strokeColor,i.strokeStyle=cc.color(e.r,e.g,e.b),i.lineWidth=this._strokeSize):i.strokeEnabled=!1,this._shadowEnabled?(i.shadowEnabled=!0,i.shadowBlur=this._shadowBlur,i.shadowOpacity=this._shadowOpacity,i.shadowOffsetX=(t?cc.contentScaleFactor():1)*this._shadowOffset.x,i.shadowOffsetY=(t?cc.contentScaleFactor():1)*this._shadowOffset.y):i._shadowEnabled=!1,t=this._textFillColor,i.fillStyle=cc.color(t.r,t.g,t.b),i},getScale:function(){return this._scaleX!==this._scaleY&&cc.log(cc._LogInfos.Node_getScale),this._scaleX*cc.view.getDevicePixelRatio()},setScale:function(t,e){var i=cc.view.getDevicePixelRatio();this._scaleX=t/i,this._scaleY=(e||0===e?e:t)/i,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getScaleX:function(){return this._scaleX*cc.view.getDevicePixelRatio()},setScaleX:function(t){this._scaleX=t/cc.view.getDevicePixelRatio(),this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getScaleY:function(){return this._scaleY*cc.view.getDevicePixelRatio()},setScaleY:function(t){this._scaleY=t/cc.view.getDevicePixelRatio(),this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},setString:function(t){t=String(t),this._originalText!==t&&(this._originalText=t+"",this._updateString(),this._setUpdateTextureDirty(),this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty))},_updateString:function(){this._string&&""!==this._string||this._string===this._originalText||(cc.renderer.childrenOrderDirty=!0),this._string=this._originalText},setHorizontalAlignment:function(t){t!==this._hAlignment&&(this._hAlignment=t,this._setUpdateTextureDirty())},setVerticalAlignment:function(t){t!==this._vAlignment&&(this._vAlignment=t,this._setUpdateTextureDirty())},setDimensions:function(t,e){var i;void 0===e?(i=t.width,e=t.height):i=t,i===this._dimensions.width&&e===this._dimensions.height||(this._dimensions.width=i,this._dimensions.height=e,this._updateString(),this._setUpdateTextureDirty())},_getBoundingWidth:function(){return this._dimensions.width},_setBoundingWidth:function(t){t!==this._dimensions.width&&(this._dimensions.width=t,this._updateString(),this._setUpdateTextureDirty())},_getBoundingHeight:function(){return this._dimensions.height},_setBoundingHeight:function(t){t!==this._dimensions.height&&(this._dimensions.height=t,this._updateString(),this._setUpdateTextureDirty())},setFontSize:function(t){this._fontSize!==t&&(this._fontSize=t,this._renderCmd._setFontStyle(this._fontName,this._fontSize,this._fontStyle,this._fontWeight),this._setUpdateTextureDirty())},setFontName:function(t){this._fontName&&this._fontName!==t&&(this._fontName=t,this._renderCmd._setFontStyle(this._fontName,this._fontSize,this._fontStyle,this._fontWeight),this._setUpdateTextureDirty())},_getFont:function(){return this._renderCmd._getFontStyle()},_setFont:function(t){(t=cc.LabelTTF._fontStyleRE.exec(t))&&(this._fontSize=parseInt(t[1]),this._fontName=t[2],this._renderCmd._setFontStyle(this._fontName,this._fontSize,this._fontStyle,this._fontWeight),this._setUpdateTextureDirty())},getContentSize:function(){this._needUpdateTexture&&this._renderCmd._updateTTF();var t=cc.view.getDevicePixelRatio();return cc.size(this._contentSize.width/t,this._contentSize.height/t)},_getWidth:function(){return this._needUpdateTexture&&this._renderCmd._updateTTF(),this._contentSize.width/cc.view.getDevicePixelRatio()},_getHeight:function(){return this._needUpdateTexture&&this._renderCmd._updateTTF(),this._contentSize.height/cc.view.getDevicePixelRatio()},setTextureRect:function(t,e,i){this._rectRotated=e||!1,this.setContentSize(i||t),(e=this._rect).x=t.x,e.y=t.y,e.width=t.width,e.height=t.height,this._renderCmd._setTextureCoords(t,!1),i=this._unflippedOffsetPositionFromCenter.x;var n=this._unflippedOffsetPositionFromCenter.y;this._flippedX&&(i=-i),this._flippedY&&(n=-n),this._offsetPosition.x=i+(t.width-e.width)/2,this._offsetPosition.y=n+(t.height-e.height)/2},setDrawMode:function(t){this._onCacheCanvasMode=t},_createRenderCmd:function(){return new(cc._renderType===cc.game.RENDER_TYPE_WEBGL?cc.LabelTTF.WebGLRenderCmd:this._onCacheCanvasMode?cc.LabelTTF.CacheCanvasRenderCmd:cc.LabelTTF.CanvasRenderCmd)(this)},_setFontStyle:function(t){this._fontStyle!==t&&(this._fontStyle=t,this._renderCmd._setFontStyle(this._fontName,this._fontSize,this._fontStyle,this._fontWeight),this._setUpdateTextureDirty())},_getFontStyle:function(){return this._fontStyle},_setFontWeight:function(t){this._fontWeight!==t&&(this._fontWeight=t,this._renderCmd._setFontStyle(this._fontName,this._fontSize,this._fontStyle,this._fontWeight),this._setUpdateTextureDirty())},_getFontWeight:function(){return this._fontWeight}}),cc.assert(cc.isFunction(cc._tmp.PrototypeLabelTTF),cc._LogInfos.MissingFile,"LabelTTFPropertyDefine.js"),cc._tmp.PrototypeLabelTTF(),delete cc._tmp.PrototypeLabelTTF,cc.LabelTTF._fontStyleRE=/^(\d+)px\s+['"]?([\w\s\d]+)['"]?$/,cc.LabelTTF.create=function(t,e,i,n,s,r){return new cc.LabelTTF(t,e,i,n,s,r)},cc.LabelTTF.createWithFontDefinition=cc.LabelTTF.create,cc.LabelTTF.__labelHeightDiv=document.createElement("div"),cc.LabelTTF.__labelHeightDiv.style.fontFamily="Arial",cc.LabelTTF.__labelHeightDiv.style.position="absolute",cc.LabelTTF.__labelHeightDiv.style.left="-100px",cc.LabelTTF.__labelHeightDiv.style.top="-100px",cc.LabelTTF.__labelHeightDiv.style.lineHeight="normal",document.body?document.body.appendChild(cc.LabelTTF.__labelHeightDiv):window.addEventListener("load",function(){this.removeEventListener("load",arguments.callee,!1),document.body.appendChild(cc.LabelTTF.__labelHeightDiv)},!1),cc.LabelTTF.__getFontHeightByDiv=function(t,e){var i,n=cc.LabelTTF.__labelHeightDiv;if(t instanceof cc.FontDefinition){if(0<(i=cc.LabelTTF.__fontHeightCache[t._getCanvasFontStr()]))return i;n.innerHTML="ajghl~!",n.style.fontFamily=t.fontName,n.style.fontSize=t.fontSize+"px",n.style.fontStyle=t.fontStyle,n.style.fontWeight=t.fontWeight,i=n.clientHeight,cc.LabelTTF.__fontHeightCache[t._getCanvasFontStr()]=i}else{if(0<(i=cc.LabelTTF.__fontHeightCache[t+"."+e]))return i;n.innerHTML="ajghl~!",n.style.fontFamily=t,n.style.fontSize=e+"px",i=n.clientHeight,cc.LabelTTF.__fontHeightCache[t+"."+e]=i}return n.innerHTML="",i},cc.LabelTTF.__fontHeightCache={},cc.LabelTTF._textAlign=["left","center","right"],cc.LabelTTF._textBaseline=["top","middle","bottom"],cc.LabelTTF.wrapInspection=!0,cc.LabelTTF._wordRex=/([a-zA-Z0-9\-\u00bf\u00a1\u00ab\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02af\u0300-\u034e\u0350-\u036F\u0370-\u052f\u2011\u2035-\u2037\u2039\u2045]+|\S)/,cc.LabelTTF._symbolRex=/^[!,.:;}\]%\?>\u3001\u2018\u201c\u300b\u00bb\uff1f\u3002\uff0c\uff01\u2010\u2032-\u2034\u203a\u203c\u2046\u2047-\u2049]/,cc.LabelTTF._lastWordRex=/([a-zA-Z0-9\-\u00bf\u00a1\u00ab\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02af\u0300-\u034e\u0350-\u036F\u0370-\u052f\u2011\u2035-\u2037\u2039\u2045]+|\S)$/,cc.LabelTTF._lastEnglish=/[a-zA-Z0-9\-\u00bf\u00a1\u00ab\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02af\u0300-\u034e\u0350-\u036F\u0370-\u052f\u2011\u2035-\u2037\u2039\u2045]+$/,cc.LabelTTF._firsrEnglish=/^[a-zA-Z0-9\-\u00bf\u00a1\u00ab\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02af\u0300-\u034e\u0350-\u036F\u0370-\u052f\u2011\u2035-\u2037\u2039\u2045]/,!function(){cc.LabelTTF.RenderCmd=function(){this._fontClientHeight=18,this._fontStyleStr="",this._shadowColorStr="rgba(128, 128, 128, 0.5)",this._strokeColorStr="",this._fillColorStr="rgba(255,255,255,1)",this._labelContext=this._labelCanvas=null,this._lineWidths=[],this._strings=[],this._isMultiLine=!1,this._status=[],this._renderingIndex=0,this._canUseDirtyRegion=!0};var t=cc.LabelTTF.RenderCmd.prototype,i=(t.constructor=cc.LabelTTF.RenderCmd,t._labelCmdCtor=cc.LabelTTF.RenderCmd,t._setFontStyle=function(t,e,i,n){var s;t instanceof cc.FontDefinition?(this._fontStyleStr=t._getCanvasFontStr(),this._fontClientHeight=cc.LabelTTF.__getFontHeightByDiv(t)):(s=e*cc.view.getDevicePixelRatio(),this._fontStyleStr=i+" "+n+" "+s+"px '"+t+"'",this._fontClientHeight=cc.LabelTTF.__getFontHeightByDiv(t,e))},t._getFontStyle=function(){return this._fontStyleStr},t._getFontClientHeight=function(){return this._fontClientHeight},t._updateColor=function(){this._setColorsString(),this._updateTexture()},t._setColorsString=function(){var t=this._displayedColor,e=this._node,i=e._shadowColor||this._displayedColor,n=e._strokeColor,s=e._textFillColor,r=t.r/255,o=t.g/255,t=t.b/255;this._shadowColorStr="rgba("+(0|r*i.r)+","+(0|o*i.g)+","+(0|t*i.b)+","+e._shadowOpacity+")",this._fillColorStr="rgba("+(0|r*s.r)+","+(0|o*s.g)+","+(0|t*s.b)+", 1)",this._strokeColorStr="rgba("+(0|r*n.r)+","+(0|o*n.g)+","+(0|t*n.b)+", 1)"},new cc.Rect);t.getLocalBB=function(){var t=this._node,e=(i.x=i.y=0,cc.view.getDevicePixelRatio());return i.width=t._getWidth()*e,i.height=t._getHeight()*e,i},t._updateTTF=function(){var t,e,i,n=this._node,s=cc.view.getDevicePixelRatio(),r=n._dimensions.width*s,o=this._lineWidths,a=(o.length=0,this._isMultiLine=!1,this._measureConfig(),{});if(0!=r)for(this._strings=n._string.split("\n"),t=0;t<this._strings.length;t++)this._checkWarp(this._strings,t,r);else for(this._strings=n._string.split("\n"),t=0,e=this._strings.length;t<e;t++)this._strings[t]?(i=this._measure(this._strings[t]),o.push(i),a[this._strings[t]]=i):o.push(0);1<this._strings.length&&(this._isMultiLine=!0),e=t=0,n._strokeEnabled&&(t=e=2*n._strokeSize),n._shadowEnabled&&(i=n._shadowOffset,t+=2*Math.abs(i.x),e+=2*Math.abs(i.y)),s=0==r?this._isMultiLine?cc.size(Math.ceil(Math.max.apply(Math,o)+t),Math.ceil(this._fontClientHeight*s*this._strings.length+e)):(!(i=a[n._string])&&n._string&&(i=this._measure(n._string)),cc.size(Math.ceil((i||0)+t),Math.ceil(this._fontClientHeight*s+e))):0===n._dimensions.height?this._isMultiLine?cc.size(Math.ceil(r+t),Math.ceil(n.getLineHeight()*s*this._strings.length+e)):cc.size(Math.ceil(r+t),Math.ceil(n.getLineHeight()*s+e)):cc.size(Math.ceil(r+t),Math.ceil(n._dimensions.height*s+e)),"normal"!==n._getFontStyle()&&(s.width=Math.ceil(s.width+.3*n._fontSize)),n.setContentSize(s),n._strokeShadowOffsetX=t,n._strokeShadowOffsetY=e,n=n._anchorPoint,this._anchorPointInPoints.x=.5*t+(s.width-t)*n.x,this._anchorPointInPoints.y=.5*e+(s.height-e)*n.y},t._saveStatus=function(){var t=this._node,e=cc.view.getDevicePixelRatio(),i=t._strokeShadowOffsetX,n=t._strokeShadowOffsetY,s=t._contentSize.height-n,r=t._vAlignment,o=t._hAlignment,a=.5*i,n=s+.5*n,c=0,h=[],i=t._contentSize.width-i,e=((t=t.getLineHeight()*e)-this._fontClientHeight*e)/2,i=o===cc.TEXT_ALIGNMENT_RIGHT?0+i:o===cc.TEXT_ALIGNMENT_CENTER?0+i/2:0;if(this._isMultiLine)for(o=this._strings.length,r===cc.VERTICAL_TEXT_ALIGNMENT_BOTTOM?c=t-2*e+s-t*o:r===cc.VERTICAL_TEXT_ALIGNMENT_CENTER&&(c=(t-2*e)/2+(s-t*o)/2),r=0;r<o;r++)h.push(t*r+e-s+c);else r!==cc.VERTICAL_TEXT_ALIGNMENT_BOTTOM&&(c=r===cc.VERTICAL_TEXT_ALIGNMENT_TOP?c-s:c-.5*s),h.push(c);s={contextTransform:cc.p(a,n),xOffset:i,OffsetYArray:h},this._status.push(s)},t._drawTTFInCanvas=function(t){var e;t&&(e=this._status.pop(),t.setTransform(1,0,0,1,e.contextTransform.x,e.contextTransform.y),this.drawLabels(t,e.xOffset,e.OffsetYArray))},t._checkWarp=function(t,e,i){var n=t[e],s=this._measure(n);if(i<s&&1<n.length){for(var r,o=i/s*n.length|0,a=n.substr(o),c=s-this._measure(a),h=0,l=0;i<c&&l++<100;)a=n.substr(o=o*(i/c)|0),c=s-this._measure(a);for(l=0;c<i&&l++<100;)a&&(h=(r=cc.LabelTTF._wordRex.exec(a))?r[0].length:1,r=a),a=n.substr(o+=h),c=s-this._measure(a);0===(o-=h)&&(r=r.substr(o=1)),i=n.substr(0,o),cc.LabelTTF.wrapInspection&&cc.LabelTTF._symbolRex.test(r||a)&&(o-=(s=cc.LabelTTF._lastWordRex.exec(i))?s[0].length:0,r=n.substr(o=0===o?1:o),i=n.substr(0,o)),cc.LabelTTF._firsrEnglish.test(r)&&(s=cc.LabelTTF._lastEnglish.exec(i))&&i!==s[0]&&(o-=s[0].length,r=n.substr(o),i=n.substr(0,o)),t[e]=r||a,t.splice(e,0,i)}},t.updateStatus=function(){this._dirtyFlag&cc.Node._dirtyFlags.textDirty&&this._updateTexture(),this.originUpdateStatus()},t._syncStatus=function(t){var e=cc.Node._dirtyFlags,i=this._dirtyFlag;i&e.textDirty&&this._updateTexture(),this._originSyncStatus(t),(cc._renderType===cc.game.RENDER_TYPE_WEBGL||i&e.transformDirty)&&this.transform(t)},t.drawLabels=function(t,e,i){var n=this._node,s=(n._shadowEnabled&&(s=n._shadowOffset,t.shadowColor=this._shadowColorStr,t.shadowOffsetX=s.x,t.shadowOffsetY=-s.y,t.shadowBlur=n._shadowBlur),n._hAlignment),r=n._vAlignment,o=n._strokeSize;for(t.font!==this._fontStyleStr&&(t.font=this._fontStyleStr),t.fillStyle=this._fillColorStr,(n=n._strokeEnabled)&&(t.lineWidth=2*o,t.strokeStyle=this._strokeColorStr),t.textBaseline=cc.LabelTTF._textBaseline[r],t.textAlign=cc.LabelTTF._textAlign[s],s=this._strings.length,r=0;r<s;r++)o=this._strings[r],n&&(t.lineJoin="round",t.strokeText(o,e,i[r])),t.fillText(o,e,i[r]);cc.g_NumberOfDraws++}}(),!function(){cc.LabelTTF.CacheRenderCmd=function(){this._labelCmdCtor();var t=this._labelCanvas=document.createElement("canvas");t.width=1,t.height=1,this._labelContext=t.getContext("2d")},cc.LabelTTF.CacheRenderCmd.prototype=Object.create(cc.LabelTTF.RenderCmd.prototype),cc.inject(cc.LabelTTF.RenderCmd.prototype,cc.LabelTTF.CacheRenderCmd.prototype);var t=cc.LabelTTF.CacheRenderCmd.prototype;t.constructor=cc.LabelTTF.CacheRenderCmd,t._cacheCmdCtor=cc.LabelTTF.CacheRenderCmd,t._updateTexture=function(){this._dirtyFlag^=this._dirtyFlag&cc.Node._dirtyFlags.textDirty;var t,e=this._node,i=(e._needUpdateTexture=!1,e._contentSize),n=(this._updateTTF(),i.width),s=i.height,r=this._labelContext,o=this._labelCanvas;return e._texture||((t=new cc.Texture2D).initWithElement(this._labelCanvas),e.setTexture(t)),0===e._string.length?(o.width=1,o.height=i.height||1,e._texture&&(e._texture._htmlElementObj=this._labelCanvas,e._texture.handleLoadedTexture()),e.setTextureRect(cc.rect(0,0,1,i.height))):(r.font=this._fontStyleStr,i=o.width===n&&o.height===s,o.width=n,o.height=s,i&&r.clearRect(0,0,n,s),this._saveStatus(),this._drawTTFInCanvas(r),e._texture&&(e._texture._htmlElementObj=this._labelCanvas,e._texture.handleLoadedTexture()),e.setTextureRect(cc.rect(0,0,n,s))),!0},t._measureConfig=function(){this._labelContext.font=this._fontStyleStr},t._measure=function(t){return t?this._labelContext.measureText(t).width:0}}(),!function(){cc.LabelTTF.CacheCanvasRenderCmd=function(t){this._spriteCmdCtor(t),this._cacheCmdCtor()};var t=cc.LabelTTF.CacheCanvasRenderCmd.prototype=Object.create(cc.Sprite.CanvasRenderCmd.prototype);cc.inject(cc.LabelTTF.CacheRenderCmd.prototype,t),t.constructor=cc.LabelTTF.CacheCanvasRenderCmd}(),!function(){cc.LabelTTF.CanvasRenderCmd=function(t){this._spriteCmdCtor(t),this._labelCmdCtor()},cc.LabelTTF.CanvasRenderCmd.prototype=Object.create(cc.Sprite.CanvasRenderCmd.prototype),cc.inject(cc.LabelTTF.RenderCmd.prototype,cc.LabelTTF.CanvasRenderCmd.prototype);var t=cc.LabelTTF.CanvasRenderCmd.prototype;t.constructor=cc.LabelTTF.CanvasRenderCmd,t._measureConfig=function(){},t._measure=function(t){var e;return t?((e=cc._renderContext.getContext()).font=this._fontStyleStr,e.measureText(t).width):0},t._updateTexture=function(){this._dirtyFlag^=this._dirtyFlag&cc.Node._dirtyFlags.textDirty;var t=this._node,e=t._contentSize,i=(this._updateTTF(),e.width),n=e.height;return 0===t._string.length?t.setTextureRect(cc.rect(0,0,1,e.height)):(this._saveStatus(),t.setTextureRect(cc.rect(0,0,i,n))),!0},t.rendering=function(t){var e=cc.view.getScaleX(),i=cc.view.getScaleY(),n=(t=t||cc._renderContext).getContext();if(n){var s=this._node;if(t.computeRealOffsetY(),!(this._status.length<=0)){var r=this._renderingIndex>=this._status.length?this._renderingIndex-this._status.length:this._renderingIndex,o=this._status[r],a=(this._renderingIndex=r+1,s._offsetPosition.x),r=-s._offsetPosition.y-s._rect.height,c=this._displayedOpacity/255;for(t.setTransform(this._worldTransform,e,i),t.setCompositeOperation(this._blendFuncStr),t.setGlobalAlpha(c),t.save(),s._flippedX&&(a=-a-s._rect.width,n.scale(-1,1)),s._flippedY&&(r=s._offsetPosition.y,n.scale(1,-1)),e=o.xOffset+o.contextTransform.x+a*e,s=[],a=this._strings.length,c=0;c<a;c++)s.push(o.OffsetYArray[c]+o.contextTransform.y+r*i);this.drawLabels(n,e,s),t.restore()}}}}(),!function(){cc.LabelTTF.WebGLRenderCmd=function(t){this._spriteCmdCtor(t),this._cacheCmdCtor()};var t=cc.LabelTTF.WebGLRenderCmd.prototype=Object.create(cc.Sprite.WebGLRenderCmd.prototype);cc.inject(cc.LabelTTF.CacheRenderCmd.prototype,t),t.constructor=cc.LabelTTF.WebGLRenderCmd,t._updateColor=function(){}}(),cc.HashElement=function(){this.actions=[],this.target=null,this.actionIndex=0,this.currentAction=null,this.lock=this.paused=!1},cc.ActionManager=cc.Class.extend({_elementPool:[],_searchElementByTarget:function(t,e){for(var i=0;i<t.length;i++)if(e===t[i].target)return t[i];return null},ctor:function(){this._hashTargets={},this._arrayTargets=[],this._currentTarget=null},_getElement:function(t,e){var i=this._elementPool.pop();return(i=i||new cc.HashElement).target=t,i.paused=!!e,i},_putElement:function(t){t.actions.length=0,t.actionIndex=0,t.currentAction=null,t.paused=!1,t.target=null,t.lock=!1,this._elementPool.push(t)},addAction:function(t,e,i){if(!t)throw Error("cc.ActionManager.addAction(): action must be non-null");if(!e)throw Error("cc.ActionManager.addAction(): target must be non-null");var n=this._hashTargets[e.__instanceId];n?n.actions||(n.actions=[]):(n=this._getElement(e,i),this._hashTargets[e.__instanceId]=n,this._arrayTargets.push(n)),n.actions.push(t),t.startWithTarget(e)},removeAllActions:function(){for(var t=this._arrayTargets,e=0;e<t.length;e++){var i=t[e];i&&this.removeAllActionsFromTarget(i.target,!0)}},removeAllActionsFromTarget:function(t,e){null!=t&&(t=this._hashTargets[t.__instanceId])&&(t.actions.length=0,this._deleteHashElement(t))},removeAction:function(t){if(null!=t){var e=t.getOriginalTarget();if(e=this._hashTargets[e.__instanceId]){for(var i=0;i<e.actions.length;i++)if(e.actions[i]===t){e.actions.splice(i,1),e.actionIndex>=i&&e.actionIndex--;break}}else cc.log(cc._LogInfos.ActionManager_removeAction)}},removeActionByTag:function(t,e){t===cc.ACTION_TAG_INVALID&&cc.log(cc._LogInfos.ActionManager_addAction),cc.assert(e,cc._LogInfos.ActionManager_addAction);var i=this._hashTargets[e.__instanceId];if(i)for(var n=i.actions.length,s=0;s<n;++s){var r=i.actions[s];if(r&&r.getTag()===t&&r.getOriginalTarget()===e){this._removeActionAtIndex(s,i);break}}},getActionByTag:function(t,e){t===cc.ACTION_TAG_INVALID&&cc.log(cc._LogInfos.ActionManager_getActionByTag);var i=this._hashTargets[e.__instanceId];if(i){if(null!=i.actions)for(var n=0;n<i.actions.length;++n){var s=i.actions[n];if(s&&s.getTag()===t)return s}cc.log(cc._LogInfos.ActionManager_getActionByTag_2,t)}return null},numberOfRunningActionsInTarget:function(t){return(t=this._hashTargets[t.__instanceId])&&t.actions?t.actions.length:0},pauseTarget:function(t){(t=this._hashTargets[t.__instanceId])&&(t.paused=!0)},resumeTarget:function(t){(t=this._hashTargets[t.__instanceId])&&(t.paused=!1)},pauseAllRunningActions:function(){for(var t=[],e=this._arrayTargets,i=0;i<e.length;i++){var n=e[i];n&&!n.paused&&(n.paused=!0,t.push(n.target))}return t},resumeTargets:function(t){if(t)for(var e=0;e<t.length;e++)t[e]&&this.resumeTarget(t[e])},purgeSharedManager:function(){cc.director.getScheduler().unscheduleUpdate(this)},_removeActionAtIndex:function(t,e){e.actions.splice(t,1),e.actionIndex>=t&&e.actionIndex--,0===e.actions.length&&this._deleteHashElement(e)},_deleteHashElement:function(t){var e=!1;if(t&&!t.lock&&this._hashTargets[t.target.__instanceId]){delete this._hashTargets[t.target.__instanceId];for(var i=0,n=(e=this._arrayTargets).length;i<n;i++)if(e[i]===t){e.splice(i,1);break}this._putElement(t),e=!0}return e},update:function(t){for(var e,i,n=this._arrayTargets,s=0;s<n.length;s++){if(!(e=this._currentTarget=n[s]).paused&&e.actions){for(e.lock=!0,e.actionIndex=0;e.actionIndex<e.actions.length;e.actionIndex++)e.currentAction=e.actions[e.actionIndex],e.currentAction&&(e.currentAction.step(t*(e.currentAction._speedMethod?e.currentAction._speed:1)),e.currentAction&&e.currentAction.isDone()&&(e.currentAction.stop(),i=e.currentAction,e.currentAction=null,this.removeAction(i)),e.currentAction=null);e.lock=!1}0===e.actions.length&&this._deleteHashElement(e)&&s--}}}),cc.profiler=function(){var s=!1,t=!1,r=0,o=0,a=0,c=0,e=null,h=document.createElement("div"),l=document.createElement("div"),u=document.createElement("div"),i=document.createElement("div"),d=10,_=[0,10,20,30],p=[0,0,0,0],f=3,g=0,m=0;i.id="fps",i.style.position="absolute",i.style.padding="3px",i.style.textAlign="left",i.style.backgroundColor="rgb(0, 0, 34)",i.style.bottom=cc.DIRECTOR_STATS_POSITION.y+"0px",i.style.left=cc.DIRECTOR_STATS_POSITION.x+"px",i.style.width="45px",i.style.height="80px";for(var n=[u,l,h],y=0;y<3;++y){var T=n[y].style;T.color="rgb(0, 255, 255)",T.font="bold 12px Helvetica, Arial",T.lineHeight="20px",T.width="100%",i.appendChild(n[y])}function S(){if(a=cc.director.getSecondsPerFrame(),r++,(c+=cc.director.getDeltaTime())>cc.DIRECTOR_FPS_INTERVAL){if(o=r/c,c=r=0,C.onFrameRateChange){var t=o,e=_.length-1,i=e,n=0;for(g++,m+=t;0<=i;i--)if(_[i]<=t){p[i]++;break}if(d<=g){for(n=m/d,i=e;0<i;i--)if(.6<=(t=p[i]/d)&&_[i]<=n){i!=f&&(f=i,C.onFrameRateChange)&&C.onFrameRateChange(n.toFixed(2));break}for(m=g=_changeCount=0,i=e;0<i;i--)p[i]=0}}s&&(e=cc._renderType===cc.game.RENDER_TYPE_CANVAS?"\n canvas":"\n webgl",l.innerHTML=a.toFixed(3),h.innerHTML=o.toFixed(1).toString()+e,u.innerHTML=(0|cc.g_NumberOfDraws).toString())}}var C={onFrameRateChange:null,getSecondsPerFrame:function(){return a},getFrameRate:function(){return o},setProfileDuration:function(t){!isNaN(t)&&0<t&&(d=t/cc.DIRECTOR_FPS_INTERVAL)},resumeProfiling:function(){cc.eventManager.addListener(e,1)},stopProfiling:function(){cc.eventManager.removeListener(e)},isShowingStats:function(){return s},showStats:function(){t||this.init(),null===i.parentElement&&cc.container.appendChild(i),s=!0},hideStats:function(){s=!1,i.parentElement===cc.container&&cc.container.removeChild(i)},init:function(){t||(e=cc.eventManager.addCustomListener(cc.Director.EVENT_AFTER_VISIT,S),t=!0)}};return C}(),cc.math=cc.math||{},cc.math.EPSILON=.015625,cc.math.square=function(t){return t*t},cc.math.almostEqual=function(t,e){return t+cc.math.EPSILON>e&&t-cc.math.EPSILON<e},!function(e){e.math.Vec2=function(t,e){void 0===e?(this.x=t.x,this.y=t.y):(this.x=t||0,this.y=e||0)};var t=e.math.Vec2.prototype;t.fill=function(t,e){this.x=t,this.y=e},t.length=function(){return Math.sqrt(e.math.square(this.x)+e.math.square(this.y))},t.lengthSq=function(){return e.math.square(this.x)+e.math.square(this.y)},t.normalize=function(){var t=1/this.length();return this.x*=t,this.y*=t,this},e.math.Vec2.add=function(t,e,i){return t.x=e.x+i.x,t.y=e.y+i.y,t},t.add=function(t){return this.x+=t.x,this.y+=t.y,this},t.dot=function(t){return this.x*t.x+this.y*t.y},e.math.Vec2.subtract=function(t,e,i){return t.x=e.x-i.x,t.y=e.y-i.y,t},t.subtract=function(t){return this.x-=t.x,this.y-=t.y,this},t.transform=function(t){var e=this.x,i=this.y;return this.x=e*t.mat[0]+i*t.mat[3]+t.mat[6],this.y=e*t.mat[1]+i*t.mat[4]+t.mat[7],this},e.math.Vec2.scale=function(t,e,i){return t.x=e.x*i,t.y=e.y*i,t},t.scale=function(t){return this.x*=t,this.y*=t,this},t.equals=function(t){return this.x<t.x+e.math.EPSILON&&this.x>t.x-e.math.EPSILON&&this.y<t.y+e.math.EPSILON&&this.y>t.y-e.math.EPSILON}}(cc),!function(n){n.math.Vec3=n.kmVec3=function(t,e,i){t&&void 0===e?(this.x=t.x,this.y=t.y,this.z=t.z):(this.x=t||0,this.y=e||0,this.z=i||0)},n.math.vec3=function(t,e,i){return new n.math.Vec3(t,e,i)};var t=n.math.Vec3.prototype;t.fill=function(t,e,i){return t&&void 0===e?(this.x=t.x,this.y=t.y,this.z=t.z):(this.x=t,this.y=e,this.z=i),this},t.length=function(){return Math.sqrt(n.math.square(this.x)+n.math.square(this.y)+n.math.square(this.z))},t.lengthSq=function(){return n.math.square(this.x)+n.math.square(this.y)+n.math.square(this.z)},t.normalize=function(){var t=1/this.length();return this.x*=t,this.y*=t,this.z*=t,this},t.cross=function(t){var e=this.x,i=this.y,n=this.z;return this.x=i*t.z-n*t.y,this.y=n*t.x-e*t.z,this.z=e*t.y-i*t.x,this},t.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z},t.add=function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this},t.subtract=function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this},t.transform=function(t){var e=this.x,i=this.y,n=this.z;return t=t.mat,this.x=e*t[0]+i*t[4]+n*t[8]+t[12],this.y=e*t[1]+i*t[5]+n*t[9]+t[13],this.z=e*t[2]+i*t[6]+n*t[10]+t[14],this},t.transformNormal=function(t){var e=this.x,i=this.y,n=this.z;return t=t.mat,this.x=e*t[0]+i*t[4]+n*t[8],this.y=e*t[1]+i*t[5]+n*t[9],this.z=e*t[2]+i*t[6]+n*t[10],this},t.transformCoord=function(t){var e=new n.math.Vec4(this.x,this.y,this.z,1);return e.transform(t),this.x=e.x/e.w,this.y=e.y/e.w,this.z=e.z/e.w,this},t.scale=function(t){return this.x*=t,this.y*=t,this.z*=t,this},t.equals=function(t){var e=n.math.EPSILON;return this.x<t.x+e&&this.x>t.x-e&&this.y<t.y+e&&this.y>t.y-e&&this.z<t.z+e&&this.z>t.z-e},t.inverseTransform=function(t){t=t.mat;var e=new n.math.Vec3(this.x-t[12],this.y-t[13],this.z-t[14]);return this.x=e.x*t[0]+e.y*t[1]+e.z*t[2],this.y=e.x*t[4]+e.y*t[5]+e.z*t[6],this.z=e.x*t[8]+e.y*t[9]+e.z*t[10],this},t.inverseTransformNormal=function(t){var e=this.x,i=this.y,n=this.z;return t=t.mat,this.x=e*t[0]+i*t[1]+n*t[2],this.y=e*t[4]+i*t[5]+n*t[6],this.z=e*t[8]+i*t[9]+n*t[10],this},t.assignFrom=function(t){return t&&(this.x=t.x,this.y=t.y,this.z=t.z),this},n.math.Vec3.zero=function(t){return t.x=t.y=t.z=0,t},t.toTypeArray=function(){var t=new Float32Array(3);return t[0]=this.x,t[1]=this.y,t[2]=this.z,t}}(cc),!function(r){r.math.Vec4=function(t,e,i,n){t&&void 0===e?(this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w):(this.x=t||0,this.y=e||0,this.z=i||0,this.w=n||0)},r.kmVec4=r.math.Vec4;var t=r.math.Vec4.prototype;t.fill=function(t,e,i,n){t&&void 0===e?(this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w):(this.x=t,this.y=e,this.z=i,this.w=n)},t.add=function(t){return t&&(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w),this},t.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},t.length=function(){return Math.sqrt(r.math.square(this.x)+r.math.square(this.y)+r.math.square(this.z)+r.math.square(this.w))},t.lengthSq=function(){return r.math.square(this.x)+r.math.square(this.y)+r.math.square(this.z)+r.math.square(this.w)},t.lerp=function(t,e){return this},t.normalize=function(){var t=1/this.length();return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},t.scale=function(t){return this.normalize(),this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},t.subtract=function(t){this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w},t.transform=function(t){var e=this.x,i=this.y,n=this.z,s=this.w;return t=t.mat,this.x=e*t[0]+i*t[4]+n*t[8]+s*t[12],this.y=e*t[1]+i*t[5]+n*t[9]+s*t[13],this.z=e*t[2]+i*t[6]+n*t[10]+s*t[14],this.w=e*t[3]+i*t[7]+n*t[11]+s*t[15],this},r.math.Vec4.transformArray=function(t,e){for(var i=[],n=0;n<t.length;n++){var s=new r.math.Vec4(t[n]);s.transform(e),i.push(s)}return i},t.equals=function(t){var e=r.math.EPSILON;return this.x<t.x+e&&this.x>t.x-e&&this.y<t.y+e&&this.y>t.y-e&&this.z<t.z+e&&this.z>t.z-e&&this.w<t.w+e&&this.w>t.w-e},t.assignFrom=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this},t.toTypeArray=function(){var t=new Float32Array(4);return t[0]=this.x,t[1]=this.y,t[2]=this.z,t[3]=this.w,t}}(cc),!function(d){function u(t,e,i){(e=new d.math.Vec2(e)).subtract(t),i.x=-e.y,i.y=e.x,i.normalize()}d.math.Ray2=function(t,e){this.start=t||new d.math.Vec2,this.dir=e||new d.math.Vec2},d.math.Ray2.prototype.fill=function(t,e,i,n){this.start.x=t,this.start.y=e,this.dir.x=i,this.dir.y=n},d.math.Ray2.prototype.intersectLineSegment=function(t,e,i){var n=this.start.x,s=this.start.y,r=this.start.x+this.dir.x,o=this.start.y+this.dir.y,a=t.x,c=t.y,h=e.x,l=e.y,u=(l-c)*(r-n)-(h-a)*(o-s);return!(u>-d.math.EPSILON&&u<d.math.EPSILON||(a=n+(c=((h-a)*(s-c)-(l-c)*(n-a))/u)*(r-n),c=s+c*(o-s),a<Math.min(t.x,e.x)-d.math.EPSILON)||a>Math.max(t.x,e.x)+d.math.EPSILON||c<Math.min(t.y,e.y)-d.math.EPSILON||c>Math.max(t.y,e.y)+d.math.EPSILON||a<Math.min(n,r)-d.math.EPSILON||a>Math.max(n,r)+d.math.EPSILON||c<Math.min(s,o)-d.math.EPSILON||c>Math.max(s,o)+d.math.EPSILON||(i.x=a,i.y=c,0))},d.math.Ray2.prototype.intersectTriangle=function(t,e,i,n,s){var r,o=new d.math.Vec2,a=new d.math.Vec2,c=new d.math.Vec2,h=1e4,l=!1;return this.intersectLineSegment(t,e,o)&&(l=!0,(r=o.subtract(this.start).length())<h)&&(a.x=o.x,a.y=o.y,h=r,u(t,e,c)),this.intersectLineSegment(e,i,o)&&(l=!0,(r=o.subtract(this.start).length())<h)&&(a.x=o.x,a.y=o.y,h=r,u(e,i,c)),this.intersectLineSegment(i,t,o)&&(l=!0,(r=o.subtract(this.start).length())<h)&&(a.x=o.x,a.y=o.y,u(i,t,c)),l&&(n.x=a.x,n.y=a.y,s)&&(s.x=c.x,s.y=c.y),l}}(cc),window.Uint16Array=window.Uint16Array||window.Array,window.Float32Array=window.Float32Array||window.Array,!function(r){r.math.Matrix3=function(t){this.mat=t&&t.mat?new Float32Array(t.mat):new Float32Array(9)},r.kmMat3=r.math.Matrix3;var t=r.math.Matrix3.prototype,e=(t.fill=function(t){var e=this.mat;return t=t.mat,e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],this},t.adjugate=function(){var t=this.mat,e=t[0],i=t[1],n=t[2],s=t[3],r=t[4],o=t[5],a=t[6],c=t[7],h=t[8];return t[0]=r*h-o*c,t[1]=n*c-i*h,t[2]=i*o-n*r,t[3]=o*a-s*h,t[4]=e*h-n*a,t[5]=n*s-e*o,t[6]=s*c-r*a,t[8]=e*r-i*s,this},t.identity=function(){var t=this.mat;return t[1]=t[2]=t[3]=t[5]=t[6]=t[7]=0,t[0]=t[4]=t[8]=1,this},new r.math.Matrix3);t.inverse=function(t){return 0!==t&&(e.assignFrom(this),t=1/t,this.adjugate(),this.multiplyScalar(t)),this},t.isIdentity=function(){var t=this.mat;return 1===t[0]&&0===t[1]&&0===t[2]&&0===t[3]&&1===t[4]&&0===t[5]&&0===t[6]&&0===t[7]&&1===t[8]},t.transpose=function(){var t=this.mat,e=t[1],i=t[2],n=t[5],s=t[6],r=t[7];return t[1]=t[3],t[2]=s,t[3]=e,t[5]=r,t[6]=i,t[7]=n,this},t.determinant=function(){var t=this.mat;return t[0]*t[4]*t[8]+t[1]*t[5]*t[6]+t[2]*t[3]*t[7]-(t[2]*t[4]*t[6]+t[0]*t[5]*t[7]+t[1]*t[3]*t[8])},t.multiply=function(t){var e=this.mat,i=t.mat,n=(t=e[0],e[1]),s=e[2],r=e[3],o=e[4],a=e[5],c=e[6],h=e[7],l=e[8],u=i[0],d=i[1],_=i[2],p=i[3],f=i[4],g=i[5],m=i[6],y=i[7],i=i[8];return e[0]=t*u+r*d+c*_,e[1]=n*u+o*d+h*_,e[2]=s*u+a*d+l*_,e[3]=s*u+a*d+l*_,e[4]=n*p+o*f+h*g,e[5]=s*p+a*f+l*g,e[6]=t*m+r*y+c*i,e[7]=n*m+o*y+h*i,e[8]=s*m+a*y+l*i,this},t.multiplyScalar=function(t){var e=this.mat;return e[0]*=t,e[1]*=t,e[2]*=t,e[3]*=t,e[4]*=t,e[5]*=t,e[6]*=t,e[7]*=t,e[8]*=t,this},r.math.Matrix3.rotationAxisAngle=function(t,e){var i=Math.cos(e),e=Math.sin(e),n=new r.math.Matrix3,s=n.mat;return s[0]=i+t.x*t.x*(1-i),s[1]=t.z*e+t.y*t.x*(1-i),s[2]=-t.y*e+t.z*t.x*(1-i),s[3]=-t.z*e+t.x*t.y*(1-i),s[4]=i+t.y*t.y*(1-i),s[5]=t.x*e+t.z*t.y*(1-i),s[6]=t.y*e+t.x*t.z*(1-i),s[7]=-t.x*e+t.y*t.z*(1-i),s[8]=i+t.z*t.z*(1-i),n},t.assignFrom=function(t){var e;return this===t?r.log("cc.math.Matrix3.assign(): current matrix equals matIn"):(e=this.mat,t=t.mat,e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8]),this},t.equals=function(t){if(this!==t){var e=r.math.EPSILON,i=this.mat;t=t.mat;for(var n=0;n<9;++n)if(!(i[n]+e>t[n]&&i[n]-e<t[n]))return!1}return!0},r.math.Matrix3.createByRotationX=function(t){var e=new r.math.Matrix3,i=e.mat;return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=Math.cos(t),i[5]=Math.sin(t),i[6]=0,i[7]=-Math.sin(t),i[8]=Math.cos(t),e},r.math.Matrix3.createByRotationY=function(t){var e=new r.math.Matrix3,i=e.mat;return i[0]=Math.cos(t),i[1]=0,i[2]=-Math.sin(t),i[3]=0,i[4]=1,i[5]=0,i[6]=Math.sin(t),i[7]=0,i[8]=Math.cos(t),e},r.math.Matrix3.createByRotationZ=function(t){var e=new r.math.Matrix3,i=e.mat;return i[0]=Math.cos(t),i[1]=-Math.sin(t),i[2]=0,i[3]=Math.sin(t),i[4]=Math.cos(t),i[5]=0,i[6]=0,i[7]=0,i[8]=1,e},r.math.Matrix3.createByRotation=function(t){var e=new r.math.Matrix3,i=e.mat;return i[0]=Math.cos(t),i[1]=Math.sin(t),i[2]=0,i[3]=-Math.sin(t),i[4]=Math.cos(t),i[5]=0,i[6]=0,i[7]=0,i[8]=1,e},r.math.Matrix3.createByScale=function(t,e){var i=new r.math.Matrix3;return i.identity(),i.mat[0]=t,i.mat[4]=e,i},r.math.Matrix3.createByTranslation=function(t,e){var i=new r.math.Matrix3;return i.identity(),i.mat[6]=t,i.mat[7]=e,i},r.math.Matrix3.createByQuaternion=function(t){var e,i;return t?((i=(e=new r.math.Matrix3).mat)[0]=1-2*(t.y*t.y+t.z*t.z),i[1]=2*(t.x*t.y-t.w*t.z),i[2]=2*(t.x*t.z+t.w*t.y),i[3]=2*(t.x*t.y+t.w*t.z),i[4]=1-2*(t.x*t.x+t.z*t.z),i[5]=2*(t.y*t.z-t.w*t.x),i[6]=2*(t.x*t.z-t.w*t.y),i[7]=2*(t.y*t.z+t.w*t.x),i[8]=1-2*(t.x*t.x+t.y*t.y),e):null},t.rotationToAxisAngle=function(){return r.math.Quaternion.rotationMatrix(this).toAxisAndAngle()}}(cc),!function(l){l.math.Matrix4=function(t){this.mat=t&&t.mat?new Float32Array(t.mat):new Float32Array(16)},l.kmMat4=l.math.Matrix4;var t=l.math.Matrix4.prototype,n=(t.fill=function(t){for(var e=this.mat,i=0;i<16;i++)e[i]=t[i];return this},l.kmMat4Identity=function(t){var e=t.mat;return e[1]=e[2]=e[3]=e[4]=e[6]=e[7]=e[8]=e[9]=e[11]=e[12]=e[13]=e[14]=0,e[0]=e[5]=e[10]=e[15]=1,t},t.identity=function(){var t=this.mat;return t[1]=t[2]=t[3]=t[4]=t[6]=t[7]=t[8]=t[9]=t[11]=t[12]=t[13]=t[14]=0,t[0]=t[5]=t[10]=t[15]=1,this},t.get=function(t,e){return this.mat[t+4*e]},t.set=function(t,e,i){this.mat[t+4*e]=i},t.swap=function(t,e,i,n){var s=this.mat,r=s[t+4*e];s[t+4*e]=s[i+4*n],s[i+4*n]=r},l.math.Matrix4._gaussj=function(t,e){for(var i,n,s,r,o=0,a=0,c=[0,0,0,0],h=[0,0,0,0],l=[0,0,0,0],u=0;u<4;u++){for(i=r=0;i<4;i++)if(1!==l[i])for(n=0;n<4;n++)0===l[n]&&r<=(s=Math.abs(t.get(i,n)))&&(r=s,a=i,o=n);if(++l[o],a!==o){for(i=0;i<4;i++)t.swap(a,i,o,i);for(i=0;i<4;i++)e.swap(a,i,o,i)}if(h[u]=a,c[u]=o,0===t.get(o,o))return!1;for(n=1/t.get(o,o),t.set(o,o,1),i=0;i<4;i++)t.set(o,i,t.get(o,i)*n);for(i=0;i<4;i++)e.set(o,i,e.get(o,i)*n);for(n=0;n<4;n++)if(n!==o){for(s=t.get(n,o),t.set(n,o,0),i=0;i<4;i++)t.set(n,i,t.get(n,i)-t.get(o,i)*s);for(i=0;i<4;i++)e.set(n,i,t.get(n,i)-e.get(o,i)*s)}}for(i=3;0<=i;i--)if(h[i]!==c[i])for(n=0;n<4;n++)t.swap(n,h[i],n,c[i]);return!0},(new l.math.Matrix4).identity()),r=(l.kmMat4Inverse=function(t,e){var e=new l.math.Matrix4(e),i=new l.math.Matrix4(n);return!1===l.math.Matrix4._gaussj(e,i)?null:(t.assignFrom(e),t)},t.inverse=function(){var t=new l.math.Matrix4(this),e=new l.math.Matrix4(n);return!1===l.math.Matrix4._gaussj(t,e)?null:t},t.isIdentity=function(){var t=this.mat;return 1===t[0]&&0===t[1]&&0===t[2]&&0===t[3]&&0===t[4]&&1===t[5]&&0===t[6]&&0===t[7]&&0===t[8]&&0===t[9]&&1===t[10]&&0===t[11]&&0===t[12]&&0===t[13]&&0===t[14]&&1===t[15]},t.transpose=function(){var t=this.mat,e=t[1],i=t[2],n=t[3],s=t[6],r=t[7],o=t[8],a=t[9],c=t[11],h=t[12],l=t[13],u=t[14];return t[1]=t[4],t[2]=o,t[3]=h,t[4]=e,t[6]=a,t[7]=l,t[8]=i,t[9]=s,t[11]=u,t[12]=n,t[13]=r,t[14]=c,this},l.kmMat4Multiply=function(t,e,i){var n=t.mat,s=e.mat,r=i.mat,o=(i=s[0],e=s[1],s[2]),a=s[3],c=s[4],h=s[5],l=s[6],u=s[7],d=s[8],_=s[9],p=s[10],f=s[11],g=s[12],m=s[13],y=s[14],s=s[15],T=r[0],S=r[1],C=r[2],E=r[3],I=r[4],v=r[5],b=r[6],A=r[7],F=r[8],x=r[9],P=r[10],R=r[11],L=r[12],B=r[13],D=r[14],r=r[15];return n[0]=T*i+S*c+C*d+E*g,n[1]=T*e+S*h+C*_+E*m,n[2]=T*o+S*l+C*p+E*y,n[3]=T*a+S*u+C*f+E*s,n[4]=I*i+v*c+b*d+A*g,n[5]=I*e+v*h+b*_+A*m,n[6]=I*o+v*l+b*p+A*y,n[7]=I*a+v*u+b*f+A*s,n[8]=F*i+x*c+P*d+R*g,n[9]=F*e+x*h+P*_+R*m,n[10]=F*o+x*l+P*p+R*y,n[11]=F*a+x*u+P*f+R*s,n[12]=L*i+B*c+D*d+r*g,n[13]=L*e+B*h+D*_+r*m,n[14]=L*o+B*l+D*p+r*y,n[15]=L*a+B*u+D*f+r*s,t},t.multiply=function(t){var e=this.mat,i=t.mat,n=(t=e[0],e[1]),s=e[2],r=e[3],o=e[4],a=e[5],c=e[6],h=e[7],l=e[8],u=e[9],d=e[10],_=e[11],p=e[12],f=e[13],g=e[14],m=e[15],y=i[0],T=i[1],S=i[2],C=i[3],E=i[4],I=i[5],v=i[6],b=i[7],A=i[8],F=i[9],x=i[10],P=i[11],R=i[12],L=i[13],B=i[14],i=i[15];return e[0]=y*t+T*o+S*l+C*p,e[1]=y*n+T*a+S*u+C*f,e[2]=y*s+T*c+S*d+C*g,e[3]=y*r+T*h+S*_+C*m,e[4]=E*t+I*o+v*l+b*p,e[5]=E*n+I*a+v*u+b*f,e[6]=E*s+I*c+v*d+b*g,e[7]=E*r+I*h+v*_+b*m,e[8]=A*t+F*o+x*l+P*p,e[9]=A*n+F*a+x*u+P*f,e[10]=A*s+F*c+x*d+P*g,e[11]=A*r+F*h+x*_+P*m,e[12]=R*t+L*o+B*l+i*p,e[13]=R*n+L*a+B*u+i*f,e[14]=R*s+L*c+B*d+i*g,e[15]=R*r+L*h+B*_+i*m,this},l.getMat4MultiplyValue=function(t,e){var t=t.mat,e=e.mat,i=new Float32Array(16);return i[0]=t[0]*e[0]+t[4]*e[1]+t[8]*e[2]+t[12]*e[3],i[1]=t[1]*e[0]+t[5]*e[1]+t[9]*e[2]+t[13]*e[3],i[2]=t[2]*e[0]+t[6]*e[1]+t[10]*e[2]+t[14]*e[3],i[3]=t[3]*e[0]+t[7]*e[1]+t[11]*e[2]+t[15]*e[3],i[4]=t[0]*e[4]+t[4]*e[5]+t[8]*e[6]+t[12]*e[7],i[5]=t[1]*e[4]+t[5]*e[5]+t[9]*e[6]+t[13]*e[7],i[6]=t[2]*e[4]+t[6]*e[5]+t[10]*e[6]+t[14]*e[7],i[7]=t[3]*e[4]+t[7]*e[5]+t[11]*e[6]+t[15]*e[7],i[8]=t[0]*e[8]+t[4]*e[9]+t[8]*e[10]+t[12]*e[11],i[9]=t[1]*e[8]+t[5]*e[9]+t[9]*e[10]+t[13]*e[11],i[10]=t[2]*e[8]+t[6]*e[9]+t[10]*e[10]+t[14]*e[11],i[11]=t[3]*e[8]+t[7]*e[9]+t[11]*e[10]+t[15]*e[11],i[12]=t[0]*e[12]+t[4]*e[13]+t[8]*e[14]+t[12]*e[15],i[13]=t[1]*e[12]+t[5]*e[13]+t[9]*e[14]+t[13]*e[15],i[14]=t[2]*e[12]+t[6]*e[13]+t[10]*e[14]+t[14]*e[15],i[15]=t[3]*e[12]+t[7]*e[13]+t[11]*e[14]+t[15]*e[15],i},l.kmMat4Assign=function(t,e){var i;return t===e?l.log("cc.kmMat4Assign(): pOut equals pIn"):(i=t.mat,e=e.mat,i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[8]=e[8],i[9]=e[9],i[10]=e[10],i[11]=e[11],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),t},t.assignFrom=function(t){var e;return this===t?l.log("cc.mat.Matrix4.assignFrom(): mat4 equals current matrix"):(e=this.mat,t=t.mat,e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),this},t.equals=function(t){if(this===t)l.log("cc.kmMat4AreEqual(): pMat1 and pMat2 are same object.");else{var e=this.mat;t=t.mat;for(var i=l.math.EPSILON,n=0;n<16;n++)if(!(e[n]+i>t[n]&&e[n]-i<t[n]))return!1}return!0},l.math.Matrix4.createByRotationX=function(t,e){var i=(e=e||new l.math.Matrix4).mat;return i[0]=1,i[3]=i[2]=i[1]=0,i[4]=0,i[5]=Math.cos(t),i[6]=Math.sin(t),i[7]=0,i[8]=0,i[9]=-Math.sin(t),i[10]=Math.cos(t),i[11]=0,i[14]=i[13]=i[12]=0,i[15]=1,e},l.math.Matrix4.createByRotationY=function(t,e){var i=(e=e||new l.math.Matrix4).mat;return i[0]=Math.cos(t),i[1]=0,i[2]=-Math.sin(t),i[3]=0,i[7]=i[6]=i[4]=0,i[5]=1,i[8]=Math.sin(t),i[9]=0,i[10]=Math.cos(t),i[11]=0,i[14]=i[13]=i[12]=0,i[15]=1,e},l.math.Matrix4.createByRotationZ=function(t,e){var i=(e=e||new l.math.Matrix4).mat;return i[0]=Math.cos(t),i[1]=Math.sin(t),i[3]=i[2]=0,i[4]=-Math.sin(t),i[5]=Math.cos(t),i[7]=i[6]=0,i[11]=i[9]=i[8]=0,i[10]=1,i[14]=i[13]=i[12]=0,i[15]=1,e},l.math.Matrix4.createByPitchYawRoll=function(t,e,i,n){n=n||new l.math.Matrix4;var s=Math.cos(t),r=(t=Math.sin(t),Math.cos(e)),o=(e=Math.sin(e),Math.cos(i)),a=(i=Math.sin(i),t*e),c=s*e,h=n.mat;return h[0]=r*o,h[4]=r*i,h[8]=-e,h[1]=a*o-s*i,h[5]=a*i+s*o,h[9]=t*r,h[2]=c*o+t*i,h[6]=c*i-t*o,h[10]=s*r,h[3]=h[7]=h[11]=0,h[15]=1,n},l.math.Matrix4.createByQuaternion=function(t,e){var i=(e=e||new l.math.Matrix4).mat;return i[0]=1-2*(t.y*t.y+t.z*t.z),i[1]=2*(t.x*t.y+t.z*t.w),i[2]=2*(t.x*t.z-t.y*t.w),i[3]=0,i[4]=2*(t.x*t.y-t.z*t.w),i[5]=1-2*(t.x*t.x+t.z*t.z),i[6]=2*(t.z*t.y+t.x*t.w),i[7]=0,i[8]=2*(t.x*t.z+t.y*t.w),i[9]=2*(t.y*t.z-t.x*t.w),i[10]=1-2*(t.x*t.x+t.y*t.y),i[11]=0,i[14]=i[13]=i[12]=0,i[15]=1,e},l.math.Matrix4.createByRotationTranslation=function(t,e,i){var n=(i=i||new l.math.Matrix4).mat;return t=t.mat,n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=0,n[4]=t[3],n[5]=t[4],n[6]=t[5],n[7]=0,n[8]=t[6],n[9]=t[7],n[10]=t[8],n[11]=0,n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=1,i},l.math.Matrix4.createByScale=function(t,e,i,n){var s=(n=n||new l.math.Matrix4).mat;return s[0]=t,s[5]=e,s[10]=i,s[15]=1,s[1]=s[2]=s[3]=s[4]=s[6]=s[7]=s[8]=s[9]=s[11]=s[12]=s[13]=s[14]=0,n},l.kmMat4Translation=function(t,e,i,n){return t.mat[0]=t.mat[5]=t.mat[10]=t.mat[15]=1,t.mat[1]=t.mat[2]=t.mat[3]=t.mat[4]=t.mat[6]=t.mat[7]=t.mat[8]=t.mat[9]=t.mat[11]=0,t.mat[12]=e,t.mat[13]=i,t.mat[14]=n,t},l.math.Matrix4.createByTranslation=function(t,e,i,n){return(n=n||new l.math.Matrix4).identity(),n.mat[12]=t,n.mat[13]=e,n.mat[14]=i,n},t.getUpVec3=function(){var t=this.mat;return new l.math.Vec3(t[4],t[5],t[6]).normalize()},t.getRightVec3=function(){var t=this.mat;return new l.math.Vec3(t[0],t[1],t[2]).normalize()},t.getForwardVec3=function(){var t=this.mat;return new l.math.Vec3(t[8],t[9],t[10]).normalize()},l.kmMat4PerspectiveProjection=function(t,e,i,n,s){var r=l.degreesToRadians(e/2),o=(e=s-n,Math.sin(r));return 0===e||0===o||0===i?null:(r=Math.cos(r)/o,t.identity(),t.mat[0]=r/i,t.mat[5]=r,t.mat[10]=-(s+n)/e,t.mat[11]=-1,t.mat[14]=-2*n*s/e,t.mat[15]=0,t)},l.math.Matrix4.createPerspectiveProjection=function(t,e,i,n){var s,r=l.degreesToRadians(t/2),o=(t=n-i,Math.sin(r));return 0===t||0===o||0===e?null:(r=Math.cos(r)/o,s=(o=new l.math.Matrix4).mat,o.identity(),s[0]=r/e,s[5]=r,s[10]=-(n+i)/t,s[11]=-1,s[14]=-2*i*n/t,s[15]=0,o)},l.kmMat4OrthographicProjection=function(t,e,i,n,s,r,o){return t.identity(),t.mat[0]=2/(i-e),t.mat[5]=2/(s-n),t.mat[10]=-2/(o-r),t.mat[12]=-(i+e)/(i-e),t.mat[13]=-(s+n)/(s-n),t.mat[14]=-(o+r)/(o-r),t},l.math.Matrix4.createOrthographicProjection=function(t,e,i,n,s,r){var o=new l.math.Matrix4,a=o.mat;return o.identity(),a[0]=2/(e-t),a[5]=2/(n-i),a[10]=-2/(r-s),a[12]=-(e+t)/(e-t),a[13]=-(n+i)/(n-i),a[14]=-(r+s)/(r-s),o},l.kmMat4LookAt=function(t,e,i,n){i=new l.math.Vec3(i);var s=new l.math.Vec3(n);return i.subtract(e),i.normalize(),s.normalize(),(n=new l.math.Vec3(i)).cross(s),n.normalize(),(s=new l.math.Vec3(n)).cross(i),n.normalize(),t.identity(),t.mat[0]=n.x,t.mat[4]=n.y,t.mat[8]=n.z,t.mat[1]=s.x,t.mat[5]=s.y,t.mat[9]=s.z,t.mat[2]=-i.x,t.mat[6]=-i.y,t.mat[10]=-i.z,e=l.math.Matrix4.createByTranslation(-e.x,-e.y,-e.z),t.multiply(e),t},new l.math.Matrix4);t.lookAt=function(t,e,i){e=new l.math.Vec3(e);var n=new l.math.Vec3(i),s=(i=this.mat,e.subtract(t),e.normalize(),n.normalize(),new l.math.Vec3(e));return s.cross(n),s.normalize(),(n=new l.math.Vec3(s)).cross(e),s.normalize(),this.identity(),i[0]=s.x,i[4]=s.y,i[8]=s.z,i[1]=n.x,i[5]=n.y,i[9]=n.z,i[2]=-e.x,i[6]=-e.y,i[10]=-e.z,r=l.math.Matrix4.createByTranslation(-t.x,-t.y,-t.z,r),this.multiply(r),this},l.kmMat4RotationAxisAngle=function(t,e,i){var n=Math.cos(i);return i=Math.sin(i),(e=new l.math.Vec3(e)).normalize(),t.mat[0]=n+e.x*e.x*(1-n),t.mat[1]=e.z*i+e.y*e.x*(1-n),t.mat[2]=-e.y*i+e.z*e.x*(1-n),t.mat[3]=0,t.mat[4]=-e.z*i+e.x*e.y*(1-n),t.mat[5]=n+e.y*e.y*(1-n),t.mat[6]=e.x*i+e.z*e.y*(1-n),t.mat[7]=0,t.mat[8]=e.y*i+e.x*e.z*(1-n),t.mat[9]=-e.x*i+e.y*e.z*(1-n),t.mat[10]=n+e.z*e.z*(1-n),t.mat[11]=0,t.mat[12]=0,t.mat[13]=0,t.mat[14]=0,t.mat[15]=1,t},l.math.Matrix4.createByAxisAndAngle=function(t,e,i){i=i||new l.math.Matrix4;var n=this.mat,s=Math.cos(e);return e=Math.sin(e),(t=new l.math.Vec3(t)).normalize(),n[0]=s+t.x*t.x*(1-s),n[1]=t.z*e+t.y*t.x*(1-s),n[2]=-t.y*e+t.z*t.x*(1-s),n[3]=0,n[4]=-t.z*e+t.x*t.y*(1-s),n[5]=s+t.y*t.y*(1-s),n[6]=t.x*e+t.z*t.y*(1-s),n[7]=0,n[8]=t.y*e+t.x*t.z*(1-s),n[9]=-t.x*e+t.y*t.z*(1-s),n[10]=s+t.z*t.z*(1-s),n[11]=0,n[12]=n[13]=n[14]=0,n[15]=1,i},t.extractRotation=function(){var t=new l.math.Matrix3,e=this.mat,i=t.mat;return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[4],i[4]=e[5],i[5]=e[6],i[6]=e[8],i[7]=e[9],i[8]=e[10],t},t.extractPlane=function(t){var e=new l.math.Plane,i=this.mat;switch(t){case l.math.Plane.RIGHT:e.a=i[3]-i[0],e.b=i[7]-i[4],e.c=i[11]-i[8],e.d=i[15]-i[12];break;case l.math.Plane.LEFT:e.a=i[3]+i[0],e.b=i[7]+i[4],e.c=i[11]+i[8],e.d=i[15]+i[12];break;case l.math.Plane.BOTTOM:e.a=i[3]+i[1],e.b=i[7]+i[5],e.c=i[11]+i[9],e.d=i[15]+i[13];break;case l.math.Plane.TOP:e.a=i[3]-i[1],e.b=i[7]-i[5],e.c=i[11]-i[9],e.d=i[15]-i[13];break;case l.math.Plane.FAR:e.a=i[3]-i[2],e.b=i[7]-i[6],e.c=i[11]-i[10],e.d=i[15]-i[14];break;case l.math.Plane.NEAR:e.a=i[3]+i[2],e.b=i[7]+i[6],e.c=i[11]+i[10],e.d=i[15]+i[14];break;default:l.log("cc.math.Matrix4.extractPlane: Invalid plane index")}return t=Math.sqrt(e.a*e.a+e.b*e.b+e.c*e.c),e.a/=t,e.b/=t,e.c/=t,e.d/=t,e},t.toAxisAndAngle=function(){var t=this.extractRotation();return l.math.Quaternion.rotationMatrix(t).toAxisAndAngle()}}(cc),!function(s){s.math.Plane=function(t,e,i,n){t&&void 0===e?(this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d):(this.a=t||0,this.b=e||0,this.c=i||0,this.d=n||0)},s.kmPlane=s.math.Plane;var t=s.math.Plane.prototype;s.math.Plane.LEFT=0,s.math.Plane.RIGHT=1,s.math.Plane.BOTTOM=2,s.math.Plane.TOP=3,s.math.Plane.NEAR=4,s.math.Plane.FAR=5,s.math.Plane.POINT_INFRONT_OF_PLANE=0,s.math.Plane.POINT_BEHIND_PLANE=1,s.math.Plane.POINT_ON_PLANE=2,t.dot=function(t){return this.a*t.x+this.b*t.y+this.c*t.z+this.d*t.w},t.dotCoord=function(t){return this.a*t.x+this.b*t.y+this.c*t.z+this.d},t.dotNormal=function(t){return this.a*t.x+this.b*t.y+this.c*t.z},s.math.Plane.fromPointNormal=function(t,e){return new s.math.Plane(e.x,e.y,e.z,-e.dot(t))},s.math.Plane.fromPoints=function(t,e,i){e=new s.math.Vec3(e),i=new s.math.Vec3(i);var n=new s.math.Plane;return e.subtract(t),i.subtract(t),e.cross(i),e.normalize(),n.a=e.x,n.b=e.y,n.c=e.z,n.d=e.scale(-1).dot(t),n},t.normalize=function(){var t=new s.math.Vec3(this.a,this.b,this.c),e=1/t.length();return t.normalize(),this.a=t.x,this.b=t.y,this.c=t.z,this.d*=e,this},t.classifyPoint=function(t){return.001<(t=this.a*t.x+this.b*t.y+this.c*t.z+this.d)?s.math.Plane.POINT_INFRONT_OF_PLANE:t<-.001?s.math.Plane.POINT_BEHIND_PLANE:s.math.Plane.POINT_ON_PLANE}}(cc),!function(h){h.math.Quaternion=function(t,e,i,n){t&&void 0===e?(this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w):(this.x=t||0,this.y=e||0,this.z=i||0,this.w=n||0)},h.kmQuaternion=h.math.Quaternion;var t=h.math.Quaternion.prototype;t.conjugate=function(t){return this.x=-t.x,this.y=-t.y,this.z=-t.z,this.w=t.w,this},t.dot=function(t){return this.w*t.w+this.x*t.x+this.y*t.y+this.z*t.z},t.exponential=function(){return this},t.identity=function(){return this.z=this.y=this.x=0,this.w=1,this},t.inverse=function(){var t=this.length();return Math.abs(t)>h.math.EPSILON?this.w=this.z=this.y=this.x=0:this.conjugate(this).scale(1/t),this},t.isIdentity=function(){return 0===this.x&&0===this.y&&0===this.z&&1===this.w},t.length=function(){return Math.sqrt(this.lengthSq())},t.lengthSq=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},t.multiply=function(t){var e=this.x,i=this.y,n=this.z,s=this.w;return this.w=s*t.w-e*t.x-i*t.y-n*t.z,this.x=s*t.x+e*t.w+i*t.z-n*t.y,this.y=s*t.y+i*t.w+n*t.x-e*t.z,this.z=s*t.z+n*t.w+e*t.y-i*t.x,this},t.normalize=function(){var t=this.length();if(Math.abs(t)<=h.math.EPSILON)throw Error("current quaternion is an invalid value");return this.scale(1/t),this},t.rotationAxis=function(t,e){var e=.5*e,i=Math.sin(e);return this.w=Math.cos(e),this.x=t.x*i,this.y=t.y*i,this.z=t.z*i,this},h.math.Quaternion.rotationMatrix=function(t){var e,i,n,s;return t?(n=t.mat,(i=[])[t=0]=n[0],i[1]=n[3],i[2]=n[6],i[4]=n[1],i[5]=n[4],i[6]=n[7],i[8]=n[2],i[9]=n[5],i[10]=n[8],i[15]=1,(t=(s=i[0])[0]+s[5]+s[10]+1)>h.math.EPSILON?(t=2*Math.sqrt(t),i=(s[9]-s[6])/t,n=(s[2]-s[8])/t,e=(s[4]-s[1])/t,t*=.25):t=s[0]>s[5]&&s[0]>s[10]?(i=.25*(t=2*Math.sqrt(1+s[0]-s[5]-s[10])),n=(s[4]+s[1])/t,e=(s[2]+s[8])/t,(s[9]-s[6])/t):s[5]>s[10]?(t=2*Math.sqrt(1+s[5]-s[0]-s[10]),i=(s[4]+s[1])/t,n=.25*t,e=(s[9]+s[6])/t,(s[2]-s[8])/t):(t=2*Math.sqrt(1+s[10]-s[0]-s[5]),i=(s[2]+s[8])/t,n=(s[9]+s[6])/t,e=.25*t,(s[4]-s[1])/t),new h.math.Quaternion(i,n,e,t)):null},h.math.Quaternion.rotationYawPitchRoll=function(t,e,i){var n=h.degreesToRadians(e)/2,s=h.degreesToRadians(t)/2,r=h.degreesToRadians(i)/2,o=(i=Math.cos(n),t=Math.cos(s),e=Math.cos(r),n=Math.sin(n),t*e),a=(s=Math.sin(s))*(r=Math.sin(r)),c=new h.math.Quaternion;return c.w=i*o+n*a,c.x=n*o-i*a,c.y=i*s*e+n*t*r,c.z=i*t*r-n*s*e,c.normalize(),c},t.slerp=function(t,e){var i,n,s;return this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w||(i=this.dot(t),n=Math.acos(i),s=Math.sqrt(1-h.math.square(i)),i=Math.sin(e*n)/s,n=Math.sin((1-e)*n)/s,s=new h.math.Quaternion(t),this.scale(n),s.scale(i),this.add(s)),this},t.toAxisAndAngle=function(){var t=new h.math.Vec3,e=Math.acos(this.w),i=Math.sqrt(h.math.square(this.x)+h.math.square(this.y)+h.math.square(this.z));return i>-h.math.EPSILON&&i<h.math.EPSILON||i<2*Math.PI+h.math.EPSILON&&i>2*Math.PI-h.math.EPSILON?(t.x=e=0,t.y=0,t.z=1):(e*=2,t.x=this.x/i,t.y=this.y/i,t.z=this.z/i,t.normalize()),{axis:t,angle:e}},t.scale=function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},t.assignFrom=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this},t.add=function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this},h.math.Quaternion.rotationBetweenVec3=function(t,e,i){var n=new h.math.Vec3(t),s=new h.math.Vec3(e),r=(n.normalize(),s.normalize(),n.dot(s));return e=new h.math.Quaternion,1<=r?e.identity():r<-.999999?Math.abs(i.lengthSq())<h.math.EPSILON?e.rotationAxis(i,Math.PI):((n=new h.math.Vec3(1,0,0)).cross(t),Math.abs(n.lengthSq())<h.math.EPSILON&&(n.fill(0,1,0),n.cross(t)),n.normalize(),e.rotationAxis(n,Math.PI)):(i=1/(t=Math.sqrt(2*(1+r))),n.cross(s),e.x=n.x*i,e.y=n.y*i,e.z=n.z*i,e.w=.5*t,e.normalize()),e},t.multiplyVec3=function(t){var e=this.x,i=this.y,n=this.z,s=new h.math.Vec3(t),r=new h.math.Vec3(e,i,n),e=new h.math.Vec3(e,i,n);return r.cross(t),e.cross(r),r.scale(2*q.w),e.scale(2),s.add(r),s.add(e),s}}(cc),cc.math.AABB=function(t,e){this.min=t||new cc.math.Vec3,this.max=e||new cc.math.Vec3},cc.math.AABB.prototype.containsPoint=function(t){return t.x>=this.min.x&&t.x<=this.max.x&&t.y>=this.min.y&&t.y<=this.max.y&&t.z>=this.min.z&&t.z<=this.max.z},cc.math.AABB.containsPoint=function(t,e){return t.x>=e.min.x&&t.x<=e.max.x&&t.y>=e.min.y&&t.y<=e.max.y&&t.z>=e.min.z&&t.z<=e.max.z},cc.math.AABB.prototype.assignFrom=function(t){this.min.assignFrom(t.min),this.max.assignFrom(t.max)},cc.math.AABB.assign=function(t,e){return t.min.assignFrom(e.min),t.max.assignFrom(e.max),t},!function(i){i.math.Matrix4Stack=function(t,e){this.top=t,this.stack=e||[],this.lastUpdated=0},i.km_mat4_stack=i.math.Matrix4Stack;var t=i.math.Matrix4Stack.prototype;t.initialize=function(){this.stack.length=0,this.top=null},i.km_mat4_stack_push=function(t,e){t.stack.push(t.top),t.top=new i.math.Matrix4(e)},i.km_mat4_stack_pop=function(t,e){t.top=t.stack.pop()},i.km_mat4_stack_release=function(t){t.stack=null,t.top=null},t.push=function(t){t=t||this.top,this.stack.push(this.top),this.top=new i.math.Matrix4(t)},t.pop=function(){this.top=this.stack.pop()},t.release=function(){this._matrixPool=this.top=this.stack=null},t._getFromPool=function(t){var e=this._matrixPool;return 0===e.length?new i.math.Matrix4(t):((e=e.pop()).assignFrom(t),e)},t._putInPool=function(t){this._matrixPool.push(t)}}(cc),!function(s){s.KM_GL_MODELVIEW=5888,s.KM_GL_PROJECTION=5889,s.KM_GL_TEXTURE=5890,s.modelview_matrix_stack=new s.math.Matrix4Stack,s.projection_matrix_stack=new s.math.Matrix4Stack,s.texture_matrix_stack=new s.math.Matrix4Stack,s.current_stack=null,s.lazyInitialize=function(){var t=new s.math.Matrix4;s.modelview_matrix_stack.initialize(),s.projection_matrix_stack.initialize(),s.texture_matrix_stack.initialize(),s.current_stack=s.modelview_matrix_stack,s.initialized=!0,t.identity(),s.modelview_matrix_stack.push(t),s.projection_matrix_stack.push(t),s.texture_matrix_stack.push(t)},s.lazyInitialize(),s.kmGLFreeAll=function(){s.modelview_matrix_stack.release(),s.modelview_matrix_stack=null,s.projection_matrix_stack.release(),s.projection_matrix_stack=null,s.texture_matrix_stack.release(),s.texture_matrix_stack=null,s.initialized=!1,s.current_stack=null},s.kmGLPushMatrix=function(){s.current_stack.push(s.current_stack.top)},s.kmGLPushMatrixWitMat4=function(t){s.current_stack.stack.push(s.current_stack.top),t.assignFrom(s.current_stack.top),s.current_stack.top=t},s.kmGLPopMatrix=function(){s.current_stack.top=s.current_stack.stack.pop()},s.kmGLMatrixMode=function(t){switch(t){case s.KM_GL_MODELVIEW:s.current_stack=s.modelview_matrix_stack;break;case s.KM_GL_PROJECTION:s.current_stack=s.projection_matrix_stack;break;case s.KM_GL_TEXTURE:s.current_stack=s.texture_matrix_stack;break;default:throw Error("Invalid matrix mode specified")}s.current_stack.lastUpdated=s.director.getTotalFrames()},s.kmGLLoadIdentity=function(){s.current_stack.top.identity()},s.kmGLLoadMatrix=function(t){s.current_stack.top.assignFrom(t)},s.kmGLMultMatrix=function(t){s.current_stack.top.multiply(t)};var r=new s.math.Matrix4,o=(s.kmGLTranslatef=function(t,e,i){t=s.math.Matrix4.createByTranslation(t,e,i,r),s.current_stack.top.multiply(t)},new s.math.Vec3);s.kmGLRotatef=function(t,e,i,n){o.fill(e,i,n),t=s.math.Matrix4.createByAxisAndAngle(o,s.degreesToRadians(t),r),s.current_stack.top.multiply(t)},s.kmGLScalef=function(t,e,i){t=s.math.Matrix4.createByScale(t,e,i,r),s.current_stack.top.multiply(t)},s.kmGLGetMatrix=function(t,e){switch(t){case s.KM_GL_MODELVIEW:e.assignFrom(s.modelview_matrix_stack.top);break;case s.KM_GL_PROJECTION:e.assignFrom(s.projection_matrix_stack.top);break;case s.KM_GL_TEXTURE:e.assignFrom(s.texture_matrix_stack.top);break;default:throw Error("Invalid matrix mode specified")}}}(cc),cc.SHADER_POSITION_UCOLOR_FRAG="precision lowp float;\nvarying vec4 v_fragmentColor;\nvoid main()                              \n{ \n    gl_FragColor = v_fragmentColor;      \n}\n",cc.SHADER_POSITION_UCOLOR_VERT="attribute vec4 a_position;\nuniform    vec4 u_color;\nuniform float u_pointSize;\nvarying lowp vec4 v_fragmentColor; \nvoid main(void)   \n{\n    gl_Position = (CC_PMatrix * CC_MVMatrix) * a_position;  \n    gl_PointSize = u_pointSize;          \n    v_fragmentColor = u_color;           \n}",cc.SHADER_POSITION_COLOR_FRAG="precision lowp float; \nvarying vec4 v_fragmentColor; \nvoid main() \n{ \n     gl_FragColor = v_fragmentColor; \n} ",cc.SHADER_POSITION_COLOR_VERT="attribute vec4 a_position;\nattribute vec4 a_color;\nvarying lowp vec4 v_fragmentColor;\nvoid main()\n{\n    gl_Position = (CC_PMatrix * CC_MVMatrix) * a_position;  \n    v_fragmentColor = a_color;             \n}",cc.SHADER_SPRITE_POSITION_COLOR_VERT="attribute vec4 a_position;\nattribute vec4 a_color;\nvarying lowp vec4 v_fragmentColor;\nvoid main()\n{\n    gl_Position = CC_PMatrix * a_position;  \n    v_fragmentColor = a_color;             \n}",cc.SHADER_POSITION_COLOR_LENGTH_TEXTURE_FRAG="// #extension GL_OES_standard_derivatives : enable\nvarying mediump vec4 v_color;\nvarying mediump vec2 v_texcoord;\nvoid main()\t\n{ \n// #if defined GL_OES_standard_derivatives\t\n// gl_FragColor = v_color*smoothstep(0.0, length(fwidth(v_texcoord)), 1.0 - length(v_texcoord)); \n// #else\t\ngl_FragColor = v_color * step(0.0, 1.0 - length(v_texcoord)); \n// #endif \n}",cc.SHADER_POSITION_COLOR_LENGTH_TEXTURE_VERT="attribute mediump vec4 a_position; \nattribute mediump vec2 a_texcoord; \nattribute mediump vec4 a_color;\t\nvarying mediump vec4 v_color; \nvarying mediump vec2 v_texcoord;\t\nvoid main() \n{ \n     v_color = a_color;//vec4(a_color.rgb * a_color.a, a_color.a); \n     v_texcoord = a_texcoord; \n    gl_Position = (CC_PMatrix * CC_MVMatrix) * a_position;  \n}",cc.SHADER_POSITION_TEXTURE_FRAG="precision lowp float;   \nvarying vec2 v_texCoord;  \nvoid main() \n{  \n    gl_FragColor =  texture2D(CC_Texture0, v_texCoord);   \n}",cc.SHADER_POSITION_TEXTURE_VERT="attribute vec4 a_position; \nattribute vec2 a_texCoord; \nvarying mediump vec2 v_texCoord; \nvoid main() \n{ \n    gl_Position = (CC_PMatrix * CC_MVMatrix) * a_position;  \n    v_texCoord = a_texCoord;               \n}",cc.SHADER_POSITION_TEXTURE_UCOLOR_FRAG="precision lowp float;  \nuniform vec4 u_color; \nvarying vec2 v_texCoord; \nvoid main() \n{  \n    gl_FragColor =  texture2D(CC_Texture0, v_texCoord) * u_color;    \n}",cc.SHADER_POSITION_TEXTURE_UCOLOR_VERT="attribute vec4 a_position;\nattribute vec2 a_texCoord; \nvarying mediump vec2 v_texCoord; \nvoid main() \n{ \n    gl_Position = (CC_PMatrix * CC_MVMatrix) * a_position;  \n    v_texCoord = a_texCoord;                 \n}",cc.SHADER_POSITION_TEXTURE_A8COLOR_FRAG="precision lowp float;  \nvarying vec4 v_fragmentColor; \nvarying vec2 v_texCoord; \nvoid main() \n{ \n    gl_FragColor = vec4( v_fragmentColor.rgb,         \n        v_fragmentColor.a * texture2D(CC_Texture0, v_texCoord).a   \n    ); \n}",cc.SHADER_POSITION_TEXTURE_A8COLOR_VERT="attribute vec4 a_position; \nattribute vec2 a_texCoord; \nattribute vec4 a_color;  \nvarying lowp vec4 v_fragmentColor; \nvarying mediump vec2 v_texCoord; \nvoid main() \n{ \n    gl_Position = (CC_PMatrix * CC_MVMatrix) * a_position;  \n    v_fragmentColor = a_color; \n    v_texCoord = a_texCoord; \n}",cc.SHADER_POSITION_TEXTURE_COLOR_FRAG="precision lowp float;\nvarying vec4 v_fragmentColor; \nvarying vec2 v_texCoord; \nvoid main() \n{ \n    gl_FragColor = v_fragmentColor * texture2D(CC_Texture0, v_texCoord); \n}",cc.SHADER_POSITION_TEXTURE_COLOR_VERT="attribute vec4 a_position; \nattribute vec2 a_texCoord; \nattribute vec4 a_color;  \nvarying lowp vec4 v_fragmentColor; \nvarying mediump vec2 v_texCoord; \nvoid main() \n{ \n    gl_Position = (CC_PMatrix * CC_MVMatrix) * a_position;  \n    v_fragmentColor = a_color; \n    v_texCoord = a_texCoord; \n}",cc.SHADER_SPRITE_POSITION_TEXTURE_COLOR_VERT="attribute vec4 a_position; \nattribute vec2 a_texCoord; \nattribute vec4 a_color;  \nvarying lowp vec4 v_fragmentColor; \nvarying mediump vec2 v_texCoord; \nvoid main() \n{ \n    gl_Position = CC_PMatrix * a_position;  \n    v_fragmentColor = a_color; \n    v_texCoord = a_texCoord; \n}",cc.SHADER_SPRITE_POSITION_TEXTURE_COLOR_GRAY_FRAG="precision lowp float;\nvarying vec4 v_fragmentColor; \nvarying vec2 v_texCoord; \nvoid main() \n{ \n    vec4 c = texture2D(CC_Texture0, v_texCoord); \n    gl_FragColor.xyz = vec3(0.2126*c.r + 0.7152*c.g + 0.0722*c.b); \n     gl_FragColor.w = c.w ; \n}",cc.SHADER_POSITION_TEXTURE_COLOR_ALPHATEST_FRAG="precision lowp float;   \nvarying vec4 v_fragmentColor; \nvarying vec2 v_texCoord;   \nuniform float CC_alpha_value; \nvoid main() \n{  \n    vec4 texColor = texture2D(CC_Texture0, v_texCoord);  \n    if ( texColor.a <= CC_alpha_value )          \n        discard; \n    gl_FragColor = texColor * v_fragmentColor;  \n}",cc.SHADEREX_SWITCHMASK_FRAG="precision lowp float; \nvarying vec4 v_fragmentColor; \nvarying vec2 v_texCoord; \nuniform sampler2D u_texture;  \nuniform sampler2D   u_mask;   \nvoid main()  \n{  \n    vec4 texColor   = texture2D(u_texture, v_texCoord);  \n    vec4 maskColor  = texture2D(u_mask, v_texCoord); \n    vec4 finalColor = vec4(texColor.r, texColor.g, texColor.b, maskColor.a * texColor.a);        \n    gl_FragColor    = v_fragmentColor * finalColor; \n}",cc.shaderCache={TYPE_POSITION_TEXTURECOLOR:0,TYPE_POSITION_TEXTURECOLOR_ALPHATEST:1,TYPE_POSITION_COLOR:2,TYPE_POSITION_TEXTURE:3,TYPE_POSITION_TEXTURE_UCOLOR:4,TYPE_POSITION_TEXTURE_A8COLOR:5,TYPE_POSITION_UCOLOR:6,TYPE_POSITION_LENGTH_TEXTURECOLOR:7,TYPE_SPRITE_POSITION_TEXTURECOLOR:8,TYPE_SPRITE_POSITION_TEXTURECOLOR_ALPHATEST:9,TYPE_SPRITE_POSITION_COLOR:10,TYPE_SPRITE_POSITION_TEXTURECOLOR_GRAY:11,TYPE_MAX:11,_keyMap:[cc.SHADER_POSITION_TEXTURECOLOR,cc.SHADER_POSITION_TEXTURECOLORALPHATEST,cc.SHADER_POSITION_COLOR,cc.SHADER_POSITION_TEXTURE,cc.SHADER_POSITION_TEXTURE_UCOLOR,cc.SHADER_POSITION_TEXTUREA8COLOR,cc.SHADER_POSITION_UCOLOR,cc.SHADER_POSITION_LENGTHTEXTURECOLOR,cc.SHADER_SPRITE_POSITION_TEXTURECOLOR,cc.SHADER_SPRITE_POSITION_TEXTURECOLORALPHATEST,cc.SHADER_SPRITE_POSITION_COLOR,cc.SHADER_SPRITE_POSITION_TEXTURECOLOR_GRAY],_programs:{},_init:function(){return this.loadDefaultShaders(),!0},_loadDefaultShader:function(t,e){switch(e){case cc.SHADER_POSITION_TEXTURECOLOR:t.initWithVertexShaderByteArray(cc.SHADER_POSITION_TEXTURE_COLOR_VERT,cc.SHADER_POSITION_TEXTURE_COLOR_FRAG),t.addAttribute(cc.ATTRIBUTE_NAME_POSITION,cc.VERTEX_ATTRIB_POSITION),t.addAttribute(cc.ATTRIBUTE_NAME_COLOR,cc.VERTEX_ATTRIB_COLOR),t.addAttribute(cc.ATTRIBUTE_NAME_TEX_COORD,cc.VERTEX_ATTRIB_TEX_COORDS);break;case cc.SHADER_SPRITE_POSITION_TEXTURECOLOR:t.initWithVertexShaderByteArray(cc.SHADER_SPRITE_POSITION_TEXTURE_COLOR_VERT,cc.SHADER_POSITION_TEXTURE_COLOR_FRAG),t.addAttribute(cc.ATTRIBUTE_NAME_POSITION,cc.VERTEX_ATTRIB_POSITION),t.addAttribute(cc.ATTRIBUTE_NAME_COLOR,cc.VERTEX_ATTRIB_COLOR),t.addAttribute(cc.ATTRIBUTE_NAME_TEX_COORD,cc.VERTEX_ATTRIB_TEX_COORDS);break;case cc.SHADER_SPRITE_POSITION_TEXTURECOLOR_GRAY:t.initWithVertexShaderByteArray(cc.SHADER_SPRITE_POSITION_TEXTURE_COLOR_VERT,cc.SHADER_SPRITE_POSITION_TEXTURE_COLOR_GRAY_FRAG),t.addAttribute(cc.ATTRIBUTE_NAME_POSITION,cc.VERTEX_ATTRIB_POSITION),t.addAttribute(cc.ATTRIBUTE_NAME_COLOR,cc.VERTEX_ATTRIB_COLOR),t.addAttribute(cc.ATTRIBUTE_NAME_TEX_COORD,cc.VERTEX_ATTRIB_TEX_COORDS);break;case cc.SHADER_POSITION_TEXTURECOLORALPHATEST:t.initWithVertexShaderByteArray(cc.SHADER_POSITION_TEXTURE_COLOR_VERT,cc.SHADER_POSITION_TEXTURE_COLOR_ALPHATEST_FRAG),t.addAttribute(cc.ATTRIBUTE_NAME_POSITION,cc.VERTEX_ATTRIB_POSITION),t.addAttribute(cc.ATTRIBUTE_NAME_COLOR,cc.VERTEX_ATTRIB_COLOR),t.addAttribute(cc.ATTRIBUTE_NAME_TEX_COORD,cc.VERTEX_ATTRIB_TEX_COORDS);break;case cc.SHADER_SPRITE_POSITION_TEXTURECOLORALPHATEST:t.initWithVertexShaderByteArray(cc.SHADER_SPRITE_POSITION_TEXTURE_COLOR_VERT,cc.SHADER_POSITION_TEXTURE_COLOR_ALPHATEST_FRAG),t.addAttribute(cc.ATTRIBUTE_NAME_POSITION,cc.VERTEX_ATTRIB_POSITION),t.addAttribute(cc.ATTRIBUTE_NAME_COLOR,cc.VERTEX_ATTRIB_COLOR),t.addAttribute(cc.ATTRIBUTE_NAME_TEX_COORD,cc.VERTEX_ATTRIB_TEX_COORDS);break;case cc.SHADER_POSITION_COLOR:t.initWithVertexShaderByteArray(cc.SHADER_POSITION_COLOR_VERT,cc.SHADER_POSITION_COLOR_FRAG),t.addAttribute(cc.ATTRIBUTE_NAME_POSITION,cc.VERTEX_ATTRIB_POSITION),t.addAttribute(cc.ATTRIBUTE_NAME_COLOR,cc.VERTEX_ATTRIB_COLOR);break;case cc.SHADER_SPRITE_POSITION_COLOR:t.initWithVertexShaderByteArray(cc.SHADER_SPRITE_POSITION_COLOR_VERT,cc.SHADER_POSITION_COLOR_FRAG),t.addAttribute(cc.ATTRIBUTE_NAME_POSITION,cc.VERTEX_ATTRIB_POSITION),t.addAttribute(cc.ATTRIBUTE_NAME_COLOR,cc.VERTEX_ATTRIB_COLOR);break;case cc.SHADER_POSITION_TEXTURE:t.initWithVertexShaderByteArray(cc.SHADER_POSITION_TEXTURE_VERT,cc.SHADER_POSITION_TEXTURE_FRAG),t.addAttribute(cc.ATTRIBUTE_NAME_POSITION,cc.VERTEX_ATTRIB_POSITION),t.addAttribute(cc.ATTRIBUTE_NAME_TEX_COORD,cc.VERTEX_ATTRIB_TEX_COORDS);break;case cc.SHADER_POSITION_TEXTURE_UCOLOR:t.initWithVertexShaderByteArray(cc.SHADER_POSITION_TEXTURE_UCOLOR_VERT,cc.SHADER_POSITION_TEXTURE_UCOLOR_FRAG),t.addAttribute(cc.ATTRIBUTE_NAME_POSITION,cc.VERTEX_ATTRIB_POSITION),t.addAttribute(cc.ATTRIBUTE_NAME_TEX_COORD,cc.VERTEX_ATTRIB_TEX_COORDS);break;case cc.SHADER_POSITION_TEXTUREA8COLOR:t.initWithVertexShaderByteArray(cc.SHADER_POSITION_TEXTURE_A8COLOR_VERT,cc.SHADER_POSITION_TEXTURE_A8COLOR_FRAG),t.addAttribute(cc.ATTRIBUTE_NAME_POSITION,cc.VERTEX_ATTRIB_POSITION),t.addAttribute(cc.ATTRIBUTE_NAME_COLOR,cc.VERTEX_ATTRIB_COLOR),t.addAttribute(cc.ATTRIBUTE_NAME_TEX_COORD,cc.VERTEX_ATTRIB_TEX_COORDS);break;case cc.SHADER_POSITION_UCOLOR:t.initWithVertexShaderByteArray(cc.SHADER_POSITION_UCOLOR_VERT,cc.SHADER_POSITION_UCOLOR_FRAG),t.addAttribute("aVertex",cc.VERTEX_ATTRIB_POSITION);break;case cc.SHADER_POSITION_LENGTHTEXTURECOLOR:t.initWithVertexShaderByteArray(cc.SHADER_POSITION_COLOR_LENGTH_TEXTURE_VERT,cc.SHADER_POSITION_COLOR_LENGTH_TEXTURE_FRAG),t.addAttribute(cc.ATTRIBUTE_NAME_POSITION,cc.VERTEX_ATTRIB_POSITION),t.addAttribute(cc.ATTRIBUTE_NAME_TEX_COORD,cc.VERTEX_ATTRIB_TEX_COORDS),t.addAttribute(cc.ATTRIBUTE_NAME_COLOR,cc.VERTEX_ATTRIB_COLOR);break;default:return void cc.log("cocos2d: cc.shaderCache._loadDefaultShader, error shader type")}t.link(),t.updateUniforms()},loadDefaultShaders:function(){for(var t=0;t<this.TYPE_MAX;++t)this.programForKey(this._keyMap[t])},reloadDefaultShaders:function(){var t=this.programForKey(cc.SHADER_POSITION_TEXTURECOLOR);t.reset(),this._loadDefaultShader(t,cc.SHADER_POSITION_TEXTURECOLOR),(t=this.programForKey(cc.SHADER_SPRITE_POSITION_TEXTURECOLOR)).reset(),this._loadDefaultShader(t,cc.SHADER_SPRITE_POSITION_TEXTURECOLOR),(t=this.programForKey(cc.SHADER_POSITION_TEXTURECOLORALPHATEST)).reset(),this._loadDefaultShader(t,cc.SHADER_POSITION_TEXTURECOLORALPHATEST),(t=this.programForKey(cc.SHADER_SPRITE_POSITION_TEXTURECOLORALPHATEST)).reset(),this._loadDefaultShader(t,cc.SHADER_SPRITE_POSITION_TEXTURECOLORALPHATEST),(t=this.programForKey(cc.SHADER_POSITION_COLOR)).reset(),this._loadDefaultShader(t,cc.SHADER_POSITION_COLOR),(t=this.programForKey(cc.SHADER_POSITION_TEXTURE)).reset(),this._loadDefaultShader(t,cc.SHADER_POSITION_TEXTURE),(t=this.programForKey(cc.SHADER_SPRITE_POSITION_TEXTURE_COLOR_GRAY_FRAG)).reset(),this._loadDefaultShader(t,cc.SHADER_SPRITE_POSITION_TEXTURE_COLOR_GRAY_FRAG),(t=this.programForKey(cc.SHADER_POSITION_TEXTURE_UCOLOR)).reset(),this._loadDefaultShader(t,cc.SHADER_POSITION_TEXTURE_UCOLOR),(t=this.programForKey(cc.SHADER_POSITION_TEXTUREA8COLOR)).reset(),this._loadDefaultShader(t,cc.SHADER_POSITION_TEXTUREA8COLOR),(t=this.programForKey(cc.SHADER_POSITION_UCOLOR)).reset(),this._loadDefaultShader(t,cc.SHADER_POSITION_UCOLOR)},programForKey:function(t){var e;return this._programs[t]||(e=new cc.GLProgram,this._loadDefaultShader(e,t),this._programs[t]=e),this._programs[t]},getProgram:function(t){return this.programForKey(t)},addProgram:function(t,e){this._programs[e]=t}},cc.GLProgram=cc.Class.extend({_glContext:null,_programObj:null,_vertShader:null,_fragShader:null,_uniforms:null,_hashForUniforms:null,_usesTime:!1,_projectionUpdated:-1,_updateUniform:function(t){if(!t)return!1;var e=!1,i=this._hashForUniforms[t];if(Array.isArray(arguments[1]))n=arguments[1];else for(var n=Array(arguments.length-1),s=1;s<arguments.length;s+=1)n[s-1]=arguments[s];if(i&&i.length===n.length)for(s=0;s<n.length;s+=1)n[s]===i[s]&&"object"!=typeof n[s]||(i[s]=n[s],e=!0);else this._hashForUniforms[t]=[].concat(n),e=!0;return e},_description:function(){return"<CCGLProgram = "+this.toString()+" | Program = "+this._programObj.toString()+", VertexShader = "+this._vertShader.toString()+", FragmentShader = "+this._fragShader.toString()+">"},_compileShader:function(t,e,i){return!(!i||!t)&&(i=(cc.GLProgram._isHighpSupported()?"precision highp float;\n":"precision mediump float;\n")+"uniform mat4 CC_PMatrix;         \nuniform mat4 CC_MVMatrix;        \nuniform mat4 CC_MVPMatrix;       \nuniform vec4 CC_Time;            \nuniform vec4 CC_SinTime;         \nuniform vec4 CC_CosTime;         \nuniform vec4 CC_Random01;        \nuniform sampler2D CC_Texture0;   \n//CC INCLUDES END                \n"+i,this._glContext.shaderSource(t,i),this._glContext.compileShader(t),(i=this._glContext.getShaderParameter(t,this._glContext.COMPILE_STATUS))||(cc.log("cocos2d: ERROR: Failed to compile shader:\n"+this._glContext.getShaderSource(t)),e===this._glContext.VERTEX_SHADER?cc.log("cocos2d: \n"+this.vertexShaderLog()):cc.log("cocos2d: \n"+this.fragmentShaderLog())),!0===i)},ctor:function(t,e,i){this._uniforms={},this._hashForUniforms={},this._glContext=i||cc._renderContext,t&&e&&this.init(t,e)},destroyProgram:function(){this._hashForUniforms=this._uniforms=this._fragShader=this._vertShader=null,this._glContext.deleteProgram(this._programObj)},initWithVertexShaderByteArray:function(t,e){var i=this._glContext;return this._programObj=i.createProgram(),this._fragShader=this._vertShader=null,t&&(this._vertShader=i.createShader(i.VERTEX_SHADER),this._compileShader(this._vertShader,i.VERTEX_SHADER,t)||cc.log("cocos2d: ERROR: Failed to compile vertex shader")),e&&(this._fragShader=i.createShader(i.FRAGMENT_SHADER),this._compileShader(this._fragShader,i.FRAGMENT_SHADER,e)||cc.log("cocos2d: ERROR: Failed to compile fragment shader")),this._vertShader&&i.attachShader(this._programObj,this._vertShader),cc.checkGLErrorDebug(),this._fragShader&&i.attachShader(this._programObj,this._fragShader),0<Object.keys(this._hashForUniforms).length&&(this._hashForUniforms={}),cc.checkGLErrorDebug(),!0},initWithString:function(t,e){return this.initWithVertexShaderByteArray(t,e)},initWithVertexShaderFilename:function(t,e){var i=cc.loader.getRes(t);if(!i)throw Error("Please load the resource firset : "+t);t=cc.loader.getRes(e);if(t)return this.initWithVertexShaderByteArray(i,t);throw Error("Please load the resource firset : "+e)},init:function(t,e){return this.initWithVertexShaderFilename(t,e)},addAttribute:function(t,e){this._glContext.bindAttribLocation(this._programObj,e,t)},link:function(){return this._programObj?(this._glContext.linkProgram(this._programObj),this._vertShader&&this._glContext.deleteShader(this._vertShader),this._fragShader&&this._glContext.deleteShader(this._fragShader),this._fragShader=this._vertShader=null,!(cc.game.config[cc.game.CONFIG_KEY.debugMode]&&!this._glContext.getProgramParameter(this._programObj,this._glContext.LINK_STATUS)&&(cc.log("cocos2d: ERROR: Failed to link program: "+this._glContext.getProgramInfoLog(this._programObj)),cc.glDeleteProgram(this._programObj),this._programObj=null,1))):(cc.log("cc.GLProgram.link(): Cannot link invalid program"),!1)},use:function(){cc.glUseProgram(this._programObj)},updateUniforms:function(){this._addUniformLocation(cc.UNIFORM_PMATRIX_S),this._addUniformLocation(cc.UNIFORM_MVMATRIX_S),this._addUniformLocation(cc.UNIFORM_MVPMATRIX_S),this._addUniformLocation(cc.UNIFORM_TIME_S),this._addUniformLocation(cc.UNIFORM_SINTIME_S),this._addUniformLocation(cc.UNIFORM_COSTIME_S),this._addUniformLocation(cc.UNIFORM_RANDOM01_S),this._addUniformLocation(cc.UNIFORM_SAMPLER_S),this._usesTime=null!=this._uniforms[cc.UNIFORM_TIME_S]||null!=this._uniforms[cc.UNIFORM_SINTIME_S]||null!=this._uniforms[cc.UNIFORM_COSTIME_S],this.use(),this.setUniformLocationWith1i(this._uniforms[cc.UNIFORM_SAMPLER_S],0)},_addUniformLocation:function(t){var e=this._glContext.getUniformLocation(this._programObj,t);return e&&(e._name=t),this._uniforms[t]=e},getUniformLocationForName:function(t){if(!t)throw Error("cc.GLProgram.getUniformLocationForName(): uniform name should be non-null");if(this._programObj)return this._uniforms[t]||this._addUniformLocation(t);throw Error("cc.GLProgram.getUniformLocationForName(): Invalid operation. Cannot get uniform location when program is not initialized")},getUniformMVPMatrix:function(){return this._uniforms[cc.UNIFORM_MVPMATRIX_S]},getUniformSampler:function(){return this._uniforms[cc.UNIFORM_SAMPLER_S]},setUniformLocationWith1i:function(t,e){var i="string"==typeof t,n=i?t:t&&t._name;n?this._updateUniform(n,e)&&(i&&(t=this.getUniformLocationForName(n)),this._glContext.uniform1i(t,e)):this._glContext.uniform1i(t,e)},setUniformLocationWith2i:function(t,e,i){var n="string"==typeof t,s=n?t:t&&t._name;s?this._updateUniform(s,e,i)&&(n&&(t=this.getUniformLocationForName(s)),this._glContext.uniform2i(t,e,i)):this._glContext.uniform2i(t,e,i)},setUniformLocationWith3i:function(t,e,i,n){var s="string"==typeof t,r=s?t:t&&t._name;r?this._updateUniform(r,e,i,n)&&(s&&(t=this.getUniformLocationForName(r)),this._glContext.uniform3i(t,e,i,n)):this._glContext.uniform3i(t,e,i,n)},setUniformLocationWith4i:function(t,e,i,n,s){var r="string"==typeof t,o=r?t:t&&t._name;o?this._updateUniform(o,e,i,n,s)&&(r&&(t=this.getUniformLocationForName(o)),this._glContext.uniform4i(t,e,i,n,s)):this._glContext.uniform4i(t,e,i,n,s)},setUniformLocationWith2iv:function(t,e){var i="string"==typeof t,n=i?t:t&&t._name;n?this._updateUniform(n,e)&&(i&&(t=this.getUniformLocationForName(n)),this._glContext.uniform2iv(t,e)):this._glContext.uniform2iv(t,e)},setUniformLocationWith3iv:function(t,e){var i="string"==typeof t,n=i?t:t&&t._name;n?this._updateUniform(n,e)&&(i&&(t=this.getUniformLocationForName(n)),this._glContext.uniform3iv(t,e)):this._glContext.uniform3iv(t,e)},setUniformLocationWith4iv:function(t,e){var i="string"==typeof t,n=i?t:t&&t._name;n?this._updateUniform(n,e)&&(i&&(t=this.getUniformLocationForName(n)),this._glContext.uniform4iv(t,e)):this._glContext.uniform4iv(t,e)},setUniformLocationI32:function(t,e){this.setUniformLocationWith1i(t,e)},setUniformLocationWith1f:function(t,e){var i="string"==typeof t,n=i?t:t&&t._name;n?this._updateUniform(n,e)&&(i&&(t=this.getUniformLocationForName(n)),this._glContext.uniform1f(t,e)):this._glContext.uniform1f(t,e)},setUniformLocationWith2f:function(t,e,i){var n="string"==typeof t,s=n?t:t&&t._name;s?this._updateUniform(s,e,i)&&(n&&(t=this.getUniformLocationForName(s)),this._glContext.uniform2f(t,e,i)):this._glContext.uniform2f(t,e,i)},setUniformLocationWith3f:function(t,e,i,n){var s="string"==typeof t,r=s?t:t&&t._name;r?this._updateUniform(r,e,i,n)&&(s&&(t=this.getUniformLocationForName(r)),this._glContext.uniform3f(t,e,i,n)):this._glContext.uniform3f(t,e,i,n)},setUniformLocationWith4f:function(t,e,i,n,s){var r="string"==typeof t,o=r?t:t&&t._name;o?this._updateUniform(o,e,i,n,s)&&(r&&(t=this.getUniformLocationForName(o)),this._glContext.uniform4f(t,e,i,n,s)):(this._glContext.uniform4f(t,e,i,n,s),cc.log("uniform4f",e,i,n,s))},setUniformLocationWith2fv:function(t,e){var i="string"==typeof t,n=i?t:t&&t._name;n?this._updateUniform(n,e)&&(i&&(t=this.getUniformLocationForName(n)),this._glContext.uniform2fv(t,e)):this._glContext.uniform2fv(t,e)},setUniformLocationWith3fv:function(t,e){var i="string"==typeof t,n=i?t:t&&t._name;n?this._updateUniform(n,e)&&(i&&(t=this.getUniformLocationForName(n)),this._glContext.uniform3fv(t,e)):this._glContext.uniform3fv(t,e)},setUniformLocationWith4fv:function(t,e){var i="string"==typeof t,n=i?t:t&&t._name;n?this._updateUniform(n,e)&&(i&&(t=this.getUniformLocationForName(n)),this._glContext.uniform4fv(t,e)):(this._glContext.uniform4fv(t,e),cc.log("uniform4fv",e))},setUniformLocationWithMatrix2fv:function(t,e){var i="string"==typeof t,n=i?t:t&&t._name;n?this._updateUniform(n,e)&&(i&&(t=this.getUniformLocationForName(n)),this._glContext.uniformMatrix2fv(t,!1,e)):this._glContext.uniformMatrix2fv(t,!1,e)},setUniformLocationWithMatrix3fv:function(t,e){var i="string"==typeof t,n=i?t:t&&t._name;n?this._updateUniform(n,e)&&(i&&(t=this.getUniformLocationForName(n)),this._glContext.uniformMatrix3fv(t,!1,e)):this._glContext.uniformMatrix3fv(t,!1,e)},setUniformLocationWithMatrix4fv:function(t,e){var i="string"==typeof t,n=i?t:t&&t._name;n?this._updateUniform(n,e)&&(i&&(t=this.getUniformLocationForName(n)),this._glContext.uniformMatrix4fv(t,!1,e)):this._glContext.uniformMatrix4fv(t,!1,e)},setUniformLocationF32:function(){if(!(arguments.length<2))switch(arguments.length){case 2:this.setUniformLocationWith1f(arguments[0],arguments[1]);break;case 3:this.setUniformLocationWith2f(arguments[0],arguments[1],arguments[2]);break;case 4:this.setUniformLocationWith3f(arguments[0],arguments[1],arguments[2],arguments[3]);break;case 5:this.setUniformLocationWith4f(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4])}},setUniformsForBuiltins:function(){var t=new cc.math.Matrix4,e=new cc.math.Matrix4,i=new cc.math.Matrix4;cc.kmGLGetMatrix(cc.KM_GL_PROJECTION,t),cc.kmGLGetMatrix(cc.KM_GL_MODELVIEW,e),cc.kmMat4Multiply(i,t,e),this.setUniformLocationWithMatrix4fv(this._uniforms[cc.UNIFORM_PMATRIX_S],t.mat,1),this.setUniformLocationWithMatrix4fv(this._uniforms[cc.UNIFORM_MVMATRIX_S],e.mat,1),this.setUniformLocationWithMatrix4fv(this._uniforms[cc.UNIFORM_MVPMATRIX_S],i.mat,1),this._usesTime&&(t=(t=cc.director).getTotalFrames()*t.getAnimationInterval(),this.setUniformLocationWith4f(this._uniforms[cc.UNIFORM_TIME_S],t/10,t,2*t,4*t),this.setUniformLocationWith4f(this._uniforms[cc.UNIFORM_SINTIME_S],t/8,t/4,t/2,Math.sin(t)),this.setUniformLocationWith4f(this._uniforms[cc.UNIFORM_COSTIME_S],t/8,t/4,t/2,Math.cos(t))),-1!==this._uniforms[cc.UNIFORM_RANDOM01_S]&&this.setUniformLocationWith4f(this._uniforms[cc.UNIFORM_RANDOM01_S],Math.random(),Math.random(),Math.random(),Math.random())},_setUniformsForBuiltinsForRenderer:function(t){var e,i;t&&t._renderCmd&&(e=new cc.math.Matrix4,i=new cc.math.Matrix4,cc.kmGLGetMatrix(cc.KM_GL_PROJECTION,e),cc.kmMat4Multiply(i,e,t._renderCmd._stackMatrix),this.setUniformLocationWithMatrix4fv(this._uniforms[cc.UNIFORM_PMATRIX_S],e.mat,1),this.setUniformLocationWithMatrix4fv(this._uniforms[cc.UNIFORM_MVMATRIX_S],t._renderCmd._stackMatrix.mat,1),this.setUniformLocationWithMatrix4fv(this._uniforms[cc.UNIFORM_MVPMATRIX_S],i.mat,1),this._usesTime&&(t=(t=cc.director).getTotalFrames()*t.getAnimationInterval(),this.setUniformLocationWith4f(this._uniforms[cc.UNIFORM_TIME_S],t/10,t,2*t,4*t),this.setUniformLocationWith4f(this._uniforms[cc.UNIFORM_SINTIME_S],t/8,t/4,t/2,Math.sin(t)),this.setUniformLocationWith4f(this._uniforms[cc.UNIFORM_COSTIME_S],t/8,t/4,t/2,Math.cos(t))),-1!==this._uniforms[cc.UNIFORM_RANDOM01_S])&&this.setUniformLocationWith4f(this._uniforms[cc.UNIFORM_RANDOM01_S],Math.random(),Math.random(),Math.random(),Math.random())},setUniformForModelViewProjectionMatrix:function(){this.setUniformLocationWithMatrix4fv(this._uniforms[cc.UNIFORM_MVPMATRIX_S],cc.getMat4MultiplyValue(cc.projection_matrix_stack.top,cc.modelview_matrix_stack.top))},setUniformForModelViewProjectionMatrixWithMat4:function(t){cc.kmMat4Multiply(t,cc.projection_matrix_stack.top,cc.modelview_matrix_stack.top),this.setUniformLocationWithMatrix4fv(this._uniforms[cc.UNIFORM_MVPMATRIX_S],t.mat)},setUniformForModelViewAndProjectionMatrixWithMat4:function(){this.setUniformLocationWithMatrix4fv(this._uniforms[cc.UNIFORM_MVMATRIX_S],cc.modelview_matrix_stack.top.mat),this.setUniformLocationWithMatrix4fv(this._uniforms[cc.UNIFORM_PMATRIX_S],cc.projection_matrix_stack.top.mat)},_setUniformForMVPMatrixWithMat4:function(t){if(!t)throw Error("modelView matrix is undefined.");this.setUniformLocationWithMatrix4fv(this._uniforms[cc.UNIFORM_MVMATRIX_S],t.mat),this.setUniformLocationWithMatrix4fv(this._uniforms[cc.UNIFORM_PMATRIX_S],cc.projection_matrix_stack.top.mat)},_updateProjectionUniform:function(){var t=cc.projection_matrix_stack;t.lastUpdated!==this._projectionUpdated&&(this._glContext.uniformMatrix4fv(this._uniforms[cc.UNIFORM_PMATRIX_S],!1,t.top.mat),this._projectionUpdated=t.lastUpdated)},vertexShaderLog:function(){return this._glContext.getShaderInfoLog(this._vertShader)},getVertexShaderLog:function(){return this._glContext.getShaderInfoLog(this._vertShader)},getFragmentShaderLog:function(){return this._glContext.getShaderInfoLog(this._vertShader)},fragmentShaderLog:function(){return this._glContext.getShaderInfoLog(this._fragShader)},programLog:function(){return this._glContext.getProgramInfoLog(this._programObj)},getProgramLog:function(){return this._glContext.getProgramInfoLog(this._programObj)},reset:function(){this._fragShader=this._vertShader=null,0<Object.keys(this._uniforms).length&&(this._uniforms={}),this._glContext.deleteProgram(this._programObj),this._programObj=null,0<Object.keys(this._hashForUniforms).length&&(this._hashForUniforms={})},getProgram:function(){return this._programObj},retain:function(){},release:function(){}}),cc.GLProgram.create=function(t,e){return new cc.GLProgram(t,e)},cc.GLProgram._highpSupported=null,cc.GLProgram._isHighpSupported=function(){var t=cc._renderContext;return t.getShaderPrecisionFormat&&null==cc.GLProgram._highpSupported&&(t=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT),cc.GLProgram._highpSupported=0!==t.precision),cc.GLProgram._highpSupported},cc.setProgram=function(t,e){t.shaderProgram=e;var i=t.children;if(i)for(var n=0;n<i.length;n++)cc.setProgram(i[n],e)};var types={GL_FLOAT:0,GL_INT:1,GL_FLOAT_VEC2:2,GL_FLOAT_VEC3:3,GL_FLOAT_VEC4:4,GL_FLOAT_MAT4:5,GL_CALLBACK:6,GL_TEXTURE:7},_fntLoader=(cc.UniformValue=function(t,e){this._uniform=t,this._glprogram=e,this._value=null,this._type=-1},cc.UniformValue.prototype={setFloat:function(t){this._value=t,this._type=types.GL_FLOAT},setInt:function(t){this._value=t,this._type=types.GL_INT},setVec2:function(t,e){this._value=[t,e],this._type=types.GL_FLOAT_VEC2},setVec2v:function(t){this._value=t.slice(0),this._type=types.GL_FLOAT_VEC2},setVec3:function(t,e,i){this._value=[t,e,i],this._type=types.GL_FLOAT_VEC3},setVec3v:function(t){this._value=t.slice(0),this._type=types.GL_FLOAT_VEC3},setVec4:function(t,e,i,n){this._value=[t,e,i,n],this._type=types.GL_FLOAT_VEC4},setVec4v:function(t){this._value=t.slice(0),this._type=types.GL_FLOAT_VEC4},setMat4:function(t){this._value=t.slice(0),this._type=types.GL_FLOAT_MAT4},setCallback:function(t){this._value=t,this._type=types.GL_CALLBACK},setTexture:function(t,e){this._value=e,this._textureId=t,this._type=types.GL_TEXTURE},apply:function(){switch(this._type){case types.GL_INT:this._glprogram.setUniformLocationWith1i(this._uniform._location,this._value);break;case types.GL_FLOAT:this._glprogram.setUniformLocationWith1f(this._uniform._location,this._value);break;case types.GL_FLOAT_VEC2:this._glprogram.setUniformLocationWith2fv(this._uniform._location,this._value);break;case types.GL_FLOAT_VEC3:this._glprogram.setUniformLocationWith3fv(this._uniform._location,this._value);break;case types.GL_FLOAT_VEC4:this._glprogram.setUniformLocationWith4fv(this._uniform._location,this._value);break;case types.GL_FLOAT_MAT4:this._glprogram.setUniformLocationWithMatrix4fv(this._uniform._location,this._value);break;case types.GL_CALLBACK:this._value(this._glprogram,this._uniform);break;case types.GL_TEXTURE:this._glprogram.setUniformLocationWith1i(this._uniform._location,this._value),cc.glBindTexture2DN(this._value,this._textureId)}}},cc.GLProgramState=function(t){this._glprogram=t,this._uniforms={},this._boundTextureUnits={},this._textureUnitIndex=1;for(var e=t._glContext.getProgramParameter(t._programObj,t._glContext.ACTIVE_UNIFORMS),i=0;i<e;i+=1){var n,s=t._glContext.getActiveUniform(t._programObj,i);0!==s.name.indexOf("CC_")&&(s._location=t._glContext.getUniformLocation(t._programObj,s.name),s._location._name=s.name,n=new cc.UniformValue(s,t),this._uniforms[s.name]=n)}},cc.GLProgramState.prototype={apply:function(t){for(var e in this._glprogram.use(),t&&this._glprogram._setUniformForMVPMatrixWithMat4(t),this._uniforms)this._uniforms[e].apply()},setGLProgram:function(t){this._glprogram=t},getGLProgram:function(){return this._glprogram},getUniformCount:function(){return this._uniforms.length},getUniformValue:function(t){return this._uniforms[t]},setUniformInt:function(t,e){var i=this.getUniformValue(t);i?i.setInt(e):cc.log("cocos2d: warning: Uniform not found: "+t)},setUniformFloat:function(t,e){var i=this.getUniformValue(t);i?i.setFloat(e):cc.log("cocos2d: warning: Uniform not found: "+t)},setUniformVec2:function(t,e,i){var n=this.getUniformValue(t);n?n.setVec2(e,i):cc.log("cocos2d: warning: Uniform not found: "+t)},setUniformVec2v:function(t,e){var i=this.getUniformValue(t);i?i.setVec2v(e):cc.log("cocos2d: warning: Uniform not found: "+t)},setUniformVec3:function(t,e,i,n){var s=this.getUniformValue(t);s?s.setVec3(e,i,n):cc.log("cocos2d: warning: Uniform not found: "+t)},setUniformVec3v:function(t,e){var i=this.getUniformValue(t);i?i.setVec3v(e):cc.log("cocos2d: warning: Uniform not found: "+t)},setUniformVec4:function(t,e,i,n,s){var r=this.getUniformValue(t);r?r.setVec4(e,i,n,s):cc.log("cocos2d: warning: Uniform not found: "+t)},setUniformVec4v:function(t,e){var i=this.getUniformValue(t);i?i.setVec4v(e):cc.log("cocos2d: warning: Uniform not found: "+t)},setUniformMat4:function(t,e){var i=this.getUniformValue(t);i?i.setMat4(e):cc.log("cocos2d: warning: Uniform not found: "+t)},setUniformCallback:function(t,e){var i=this.getUniformValue(t);i?i.setCallback(e):cc.log("cocos2d: warning: Uniform not found: "+t)},setUniformTexture:function(t,e){var i,n=this.getUniformValue(t);n&&((i=this._boundTextureUnits[t])?n.setTexture(e,i):(n.setTexture(e,this._textureUnitIndex),this._boundTextureUnits[t]=this._textureUnitIndex++))}},cc.GLProgramState._cache={},cc.GLProgramState.getOrCreateWithGLProgram=function(t){var e=cc.GLProgramState._cache[t.__instanceId];return e||(e=new cc.GLProgramState(t),cc.GLProgramState._cache[t.__instanceId]=e),e},cc._currentProjectionMatrix=-1,cc.ENABLE_GL_STATE_CACHE&&(cc.MAX_ACTIVETEXTURE=16,cc._currentShaderProgram=-1,cc._currentBoundTexture=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],cc._blendingSource=-1,cc._blendingDest=-1,cc._GLServerState=0,cc.TEXTURE_ATLAS_USE_VAO)&&(cc._uVAO=0),cc.glInvalidateStateCache=function(){if(cc.kmGLFreeAll(),cc._currentProjectionMatrix=-1,cc.ENABLE_GL_STATE_CACHE){cc._currentShaderProgram=-1;for(var t=0;t<cc.MAX_ACTIVETEXTURE;t++)cc._currentBoundTexture[t]=-1;cc._blendingSource=-1,cc._blendingDest=-1,cc._GLServerState=0}},cc.glUseProgram=cc.ENABLE_GL_STATE_CACHE?function(t){t!==cc._currentShaderProgram&&(cc._currentShaderProgram=t,cc._renderContext.useProgram(t))}:function(t){cc._renderContext.useProgram(t)},cc.glDeleteProgram=function(t){cc.ENABLE_GL_STATE_CACHE&&t===cc._currentShaderProgram&&(cc._currentShaderProgram=-1),gl.deleteProgram(t)},cc.setBlending=function(t,e){var i=cc._renderContext;t===i.ONE&&e===i.ZERO?i.disable(i.BLEND):(i.enable(i.BLEND),cc._renderContext.blendFunc(t,e))},cc.glBlendFunc=cc.ENABLE_GL_STATE_CACHE?function(t,e){t===cc._blendingSource&&e===cc._blendingDest||(cc._blendingSource=t,cc._blendingDest=e,cc.setBlending(t,e))}:cc.setBlending,cc.glBlendFuncForParticle=function(t,e){var i;t===cc._blendingSource&&e===cc._blendingDest||(cc._blendingSource=t,cc._blendingDest=e,t===(i=cc._renderContext).ONE&&e===i.ZERO?i.disable(i.BLEND):(i.enable(i.BLEND),i.blendFuncSeparate(i.SRC_ALPHA,e,t,e)))},cc.glBlendResetToCache=function(){var t=cc._renderContext;t.blendEquation(t.FUNC_ADD),cc.ENABLE_GL_STATE_CACHE?cc.setBlending(cc._blendingSource,cc._blendingDest):cc.setBlending(t.BLEND_SRC,t.BLEND_DST)},cc.setProjectionMatrixDirty=function(){cc._currentProjectionMatrix=-1},cc.glBindTexture2D=function(t){cc.glBindTexture2DN(0,t)},cc.glBindTexture2DN=cc.ENABLE_GL_STATE_CACHE?function(t,e){var i;cc._currentBoundTexture[t]!==e&&(cc._currentBoundTexture[t]=e,(i=cc._renderContext).activeTexture(i.TEXTURE0+t),e?i.bindTexture(i.TEXTURE_2D,e._webTextureObj):i.bindTexture(i.TEXTURE_2D,null))}:function(t,e){var i=cc._renderContext;i.activeTexture(i.TEXTURE0+t),e?i.bindTexture(i.TEXTURE_2D,e._webTextureObj):i.bindTexture(i.TEXTURE_2D,null)},cc.glDeleteTexture=function(t){cc.glDeleteTextureN(0,t)},cc.glDeleteTextureN=function(t,e){cc.ENABLE_GL_STATE_CACHE&&e===cc._currentBoundTexture[t]&&(cc._currentBoundTexture[t]=-1),cc._renderContext.deleteTexture(e._webTextureObj)},cc.glBindVAO=function(t){cc.TEXTURE_ATLAS_USE_VAO&&cc.ENABLE_GL_STATE_CACHE&&cc._uVAO!==t&&(cc._uVAO=t)},cc.glEnable=function(t){},cc.IMAGE_FORMAT_JPEG=0,cc.IMAGE_FORMAT_PNG=1,cc.IMAGE_FORMAT_RAWDATA=9,cc.NextPOT=function(t){return--t,1+((t=(t=(t=(t|=t>>1)|t>>2)|t>>4)|t>>8)|t>>16)},cc.RenderTexture=cc.Node.extend({sprite:null,clearFlags:0,clearDepthVal:0,autoDraw:!1,_texture:null,_pixelFormat:0,clearStencilVal:0,_clearColor:null,_className:"RenderTexture",ctor:function(t,e,i,n){cc.Node.prototype.ctor.call(this),this._cascadeOpacityEnabled=this._cascadeColorEnabled=!0,this._pixelFormat=cc.Texture2D.PIXEL_FORMAT_RGBA8888,this._clearColor=new cc.Color(0,0,0,255),void 0!==t&&void 0!==e&&(i=i||cc.Texture2D.PIXEL_FORMAT_RGBA8888,this.initWithWidthAndHeight(t,e,i,n||0)),this.setAnchorPoint(0,0)},_createRenderCmd:function(){return new(cc._renderType===cc.game.RENDER_TYPE_CANVAS?cc.RenderTexture.CanvasRenderCmd:cc.RenderTexture.WebGLRenderCmd)(this)},visit:function(t){var e,i=this._renderCmd;t=t?t._renderCmd:null,this._visible?(e=cc.renderer,i.visit(t),e.pushRenderCommand(i),this.sprite.visit(this),i._dirtyFlag=0):i._propagateFlagsDown(t)},cleanup:function(){cc.Node.prototype.onExit.call(this),this._renderCmd.cleanup()},getSprite:function(){return this.sprite},setSprite:function(t){this.sprite=t},setVirtualViewport:function(t,e,i){this._renderCmd.setVirtualViewport(t,e,i)},initWithWidthAndHeight:function(t,e,i,n){return this._renderCmd.initWithWidthAndHeight(t,e,i,n)},begin:function(){cc.renderer._turnToCacheMode(this.__instanceId),this._renderCmd.begin()},beginWithClear:function(t,e,i,n,s,r){var o=cc._renderContext;s=s||o.COLOR_BUFFER_BIT,r=r||o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT,this._beginWithClear(t,e,i,n,s,r,o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT|o.STENCIL_BUFFER_BIT)},_beginWithClear:function(t,e,i,n,s,r,o){this.begin(),this._renderCmd._beginWithClear(t,e,i,n,s,r,o)},end:function(){this._renderCmd.end()},clear:function(t,e,i,n){this.beginWithClear(t,e,i,n),this.end()},clearRect:function(t,e,i,n){this._renderCmd.clearRect(t,e,i,n)},clearDepth:function(t){this._renderCmd.clearDepth(t)},clearStencil:function(t){this._renderCmd.clearStencil(t)},getClearFlags:function(){return this.clearFlags},setClearFlags:function(t){this.clearFlags=t},getClearColor:function(){return this._clearColor},setClearColor:function(t){var e=this._clearColor;e.r=t.r,e.g=t.g,e.b=t.b,e.a=t.a,this._renderCmd.updateClearColor(t)},getClearDepth:function(){return this.clearDepthVal},setClearDepth:function(t){this.clearDepthVal=t},getClearStencil:function(){return this.clearStencilVal},setClearStencil:function(t){this.clearStencilVal=t},isAutoDraw:function(){return this.autoDraw},setAutoDraw:function(t){this.autoDraw=t},saveToFile:function(t,e){cc.log("saveToFile isn't supported on Cocos2d-Html5")},newCCImage:function(t){return cc.log("saveToFile isn't supported on cocos2d-html5"),null},listenToBackground:function(t){},listenToForeground:function(t){}}),_p=cc.RenderTexture.prototype,cc.defineGetterSetter(_p,"clearColorVal",_p.getClearColor,_p.setClearColor),cc.RenderTexture.create=function(t,e,i,n){return new cc.RenderTexture(t,e,i,n)},!function(){cc.RenderTexture.CanvasRenderCmd=function(t){this._rootCtor(t),this._needDraw=!1,this._clearColorStr="rgba(255,255,255,1)",this._cacheCanvas=document.createElement("canvas"),this._cacheContext=new cc.CanvasContextWrapper(this._cacheCanvas.getContext("2d"))};var t=cc.RenderTexture.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);t.constructor=cc.RenderTexture.CanvasRenderCmd,t.cleanup=function(){this._cacheCanvas=this._cacheContext=null},t.clearStencil=function(t){},t.setVirtualViewport=function(t,e,i){},t.updateClearColor=function(t){this._clearColorStr="rgba("+(0|t.r)+","+(0|t.g)+","+(0|t.b)+","+t.a/255+")"},t.initWithWidthAndHeight=function(t,e,i,n){i=this._node,n=this._cacheCanvas;var s=cc.contentScaleFactor();return n.width=0|t*s,n.height=0|e*s,(t=new cc.Texture2D).initWithElement(n),t.handleLoadedTexture(),(t=i.sprite=new cc.Sprite(t)).setBlendFunc(cc.ONE,cc.ONE_MINUS_SRC_ALPHA),i.autoDraw=!1,i.addChild(t),!0},t.begin=function(){},t._beginWithClear=function(t,e,i,n,s,r,o){t=t||0,e=e||0,i=i||0,n=isNaN(n)?255:n,s=this._cacheContext.getContext(),r=this._cacheCanvas,s.setTransform(1,0,0,1,0,0),this._cacheContext.setFillStyle("rgba("+(0|t)+","+(0|e)+","+(0|i)+","+n/255+")"),s.clearRect(0,0,r.width,r.height),s.fillRect(0,0,r.width,r.height)},t.end=function(){var t=this._node,e=cc.contentScaleFactor();cc.renderer._renderingToCacheCanvas(this._cacheContext,t.__instanceId,e,e),(t=t.sprite._renderCmd)._notifyRegionStatus&&t._notifyRegionStatus(cc.Node.CanvasRenderCmd.RegionStatus.Dirty)},t.clearRect=function(t,e,i,n){this._cacheContext.clearRect(t,e,i,-n)},t.clearDepth=function(t){cc.log("clearDepth isn't supported on Cocos2d-Html5")}}(),!function(){cc.RenderTexture.WebGLRenderCmd=function(t){this._rootCtor(t),this._needDraw=!0,this._depthRenderBuffer=this._textureCopy=this._oldFBO=this._fBO=null,this._rtTextureRect=new cc.Rect,this._fullRect=new cc.Rect,this._fullViewport=new cc.Rect};var t=cc.RenderTexture.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype);t.constructor=cc.RenderTexture.WebGLRenderCmd,t.setVirtualViewport=function(t,e,i){this._rtTextureRect.x=t.x,this._rtTextureRect.y=t.y,this._fullRect=e,this._fullViewport=i},t.needDraw=function(){return this._needDraw&&this._node.autoDraw},t.rendering=function(t){var e=t||cc._renderContext;if((t=this._node).autoDraw){t.begin();var i,n,s,r=t.clearFlags;for(r&&(i=[0,0,0,0],s=n=0,r&e.COLOR_BUFFER_BIT&&(i=e.getParameter(e.COLOR_CLEAR_VALUE),e.clearColor(t._clearColor.r/255,t._clearColor.g/255,t._clearColor.b/255,t._clearColor.a/255)),r&e.DEPTH_BUFFER_BIT&&(n=e.getParameter(e.DEPTH_CLEAR_VALUE),e.clearDepth(t.clearDepthVal)),r&e.STENCIL_BUFFER_BIT&&(s=e.getParameter(e.STENCIL_CLEAR_VALUE),e.clearStencil(t.clearStencilVal)),e.clear(r),r&e.COLOR_BUFFER_BIT&&e.clearColor(i[0],i[1],i[2],i[3]),r&e.DEPTH_BUFFER_BIT&&e.clearDepth(n),r&e.STENCIL_BUFFER_BIT)&&e.clearStencil(s),t.sortAllChildren(),e=t._children,r=0;r<e.length;r++)(i=e[r])!==t.sprite&&i.visit(t.sprite);t.end()}},t.clearStencil=function(t){var e=cc._renderContext,i=e.getParameter(e.STENCIL_CLEAR_VALUE);e.clearStencil(t),e.clear(e.STENCIL_BUFFER_BIT),e.clearStencil(i)},t.cleanup=function(){this._textureCopy=null;var t=cc._renderContext;t.deleteFramebuffer(this._fBO),this._depthRenderBuffer&&t.deleteRenderbuffer(this._depthRenderBuffer)},t.updateClearColor=function(t){},t.initWithWidthAndHeight=function(t,e,i,n){var s=this._node,r=(i===cc.Texture2D.PIXEL_FORMAT_A8&&cc.log("cc.RenderTexture._initWithWidthAndHeightForWebGL() : only RGB and RGBA formats are valid for a render texture;"),cc._renderContext),o=cc.contentScaleFactor();this._fullRect=new cc.Rect(0,0,t,e),this._fullViewport=new cc.Rect(0,0,t,e),t=0|t*o,e=0|e*o,this._oldFBO=r.getParameter(r.FRAMEBUFFER_BINDING);for(var a=cc.configuration.supportsNPOT()?(o=t,e):(o=cc.NextPOT(t),cc.NextPOT(e)),c=new Uint8Array(o*a*4),h=0;h<o*a*4;h++)c[h]=0;if(this._pixelFormat=i,h=s._texture=new cc.Texture2D,!s._texture)return!1;if(h.initWithData(c,s._pixelFormat,o,a,cc.size(t,e)),i=r.getParameter(r.RENDERBUFFER_BINDING),cc.configuration.checkForGLExtension("GL_QCOM")){if(this._textureCopy=new cc.Texture2D,!this._textureCopy)return!1;this._textureCopy.initWithData(c,s._pixelFormat,o,a,cc.size(t,e))}return this._fBO=r.createFramebuffer(),r.bindFramebuffer(r.FRAMEBUFFER,this._fBO),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,h._webTextureObj,0),0!==n&&(this._depthRenderBuffer=r.createRenderbuffer(),r.bindRenderbuffer(r.RENDERBUFFER,this._depthRenderBuffer),r.renderbufferStorage(r.RENDERBUFFER,n,o,a),n===r.DEPTH_STENCIL?r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.RENDERBUFFER,this._depthRenderBuffer):n===r.STENCIL_INDEX||n===r.STENCIL_INDEX8?r.framebufferRenderbuffer(r.FRAMEBUFFER,r.STENCIL_ATTACHMENT,r.RENDERBUFFER,this._depthRenderBuffer):n===r.DEPTH_COMPONENT16&&r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.RENDERBUFFER,this._depthRenderBuffer)),r.checkFramebufferStatus(r.FRAMEBUFFER)!==r.FRAMEBUFFER_COMPLETE&&cc.log("Could not attach texture to the framebuffer"),h.setAliasTexParameters(),(t=s.sprite=new cc.Sprite(h)).scaleY=-1,t.setBlendFunc(r.ONE,r.ONE_MINUS_SRC_ALPHA),r.bindRenderbuffer(r.RENDERBUFFER,i),r.bindFramebuffer(r.FRAMEBUFFER,this._oldFBO),s.autoDraw=!1,s.addChild(t),!0},t.begin=function(){var t=this._node,e=(cc.kmGLMatrixMode(cc.KM_GL_PROJECTION),cc.kmGLPushMatrix(),cc.kmGLMatrixMode(cc.KM_GL_MODELVIEW),cc.kmGLPushMatrix(),cc._renderContext),i=((s=cc.director).setProjection(s.getProjection()),t._texture.getContentSizeInPixels()),n=cc.director.getWinSizeInPixels(),s=n.width/i.width,i=n.height/i.height,s=cc.math.Matrix4.createOrthographicProjection(-1/s,1/s,-1/i,1/i,-1,1);cc.kmGLMultMatrix(s),(s=new cc.Rect(0,0,0,0)).width=this._fullViewport.width,s.height=this._fullViewport.height,i=s.height/this._fullRect.height,s.x=s.width/this._fullRect.width*(this._fullRect.x-this._rtTextureRect.x),s.y=(this._fullRect.y-this._rtTextureRect.y)*i,e.viewport(s.x,s.y,s.width,s.height),this._oldFBO=e.getParameter(e.FRAMEBUFFER_BINDING),e.bindFramebuffer(e.FRAMEBUFFER,this._fBO),cc.configuration.checkForGLExtension("GL_QCOM")&&(e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this._textureCopy._webTextureObj,0),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t._texture._webTextureObj,0))},t._beginWithClear=function(t,e,i,n,s,r,o){t/=255,e/=255,i/=255,n/=255;var a=cc._renderContext,c=[0,0,0,0],h=0,l=0;o&a.COLOR_BUFFER_BIT&&(c=a.getParameter(a.COLOR_CLEAR_VALUE),a.clearColor(t,e,i,n)),o&a.DEPTH_BUFFER_BIT&&(h=a.getParameter(a.DEPTH_CLEAR_VALUE),a.clearDepth(s)),o&a.STENCIL_BUFFER_BIT&&(l=a.getParameter(a.STENCIL_CLEAR_VALUE),a.clearStencil(r)),a.clear(o),o&a.COLOR_BUFFER_BIT&&a.clearColor(c[0],c[1],c[2],c[3]),o&a.DEPTH_BUFFER_BIT&&a.clearDepth(h),o&a.STENCIL_BUFFER_BIT&&a.clearStencil(l)},t.end=function(){cc.renderer._renderingToBuffer(this._node.__instanceId);var t=cc._renderContext,e=cc.director;t.bindFramebuffer(t.FRAMEBUFFER,this._oldFBO),e.setViewport(),cc.kmGLMatrixMode(cc.KM_GL_PROJECTION),cc.kmGLPopMatrix(),cc.kmGLMatrixMode(cc.KM_GL_MODELVIEW),cc.kmGLPopMatrix()},t.clearRect=function(t,e,i,n){},t.clearDepth=function(t){var e=this._node,i=(e.begin(),cc._renderContext),n=i.getParameter(i.DEPTH_CLEAR_VALUE);i.clearDepth(t),i.clear(i.DEPTH_BUFFER_BIT),i.clearDepth(n),e.end()}}(),cc.LabelBMFont=cc.SpriteBatchNode.extend({_opacityModifyRGB:!1,_string:"",_config:null,_fntFile:"",_initialString:"",_alignment:cc.TEXT_ALIGNMENT_CENTER,_width:-1,_lineBreakWithoutSpaces:!1,_imageOffset:null,_textureLoaded:!1,_className:"LabelBMFont",_createRenderCmd:function(){return new(cc._renderType===cc.game.RENDER_TYPE_WEBGL?cc.LabelBMFont.WebGLRenderCmd:cc.LabelBMFont.CanvasRenderCmd)(this)},_setString:function(t,e){e?this._initialString=t:this._string=t;var i=this._children;if(i)for(var n=0;n<i.length;n++){var s=i[n];s&&s.setVisible(!1)}this._textureLoaded&&(this._string&&0<this._string.length&&this.createFontChars(),e)&&this.updateLabel()},ctor:function(t,e,i,n,s){cc.SpriteBatchNode.prototype.ctor.call(this),this._imageOffset=cc.p(0,0),this._cascadeOpacityEnabled=this._cascadeColorEnabled=!0,this.initWithString(t,e,i,n,s)},textureLoaded:function(){return this._textureLoaded},addLoadedEventListener:function(t,e){this.addEventListener("load",t,e)},isOpacityModifyRGB:function(){return this._opacityModifyRGB},setOpacityModifyRGB:function(t){if(this._opacityModifyRGB=t,t=this._children)for(var e=0;e<t.length;e++){var i=t[e];i&&(i.opacityModifyRGB=this._opacityModifyRGB)}},_changeTextureColor:function(){this._renderCmd._changeTextureColor()},init:function(){return this.initWithString(null,null,null,null,null)},initWithString:function(t,e,i,n,s){var r;if(t=t||"",this._config&&cc.log("cc.LabelBMFont.initWithString(): re-init is no longer supported"),e){if(!(r=cc.loader.getRes(e))&&!(r=cc.FntFrameCache[e]||cc.FntFrameCache[cc.path.basename(e)]))return cc.log("cc.LabelBMFont.initWithString(): Impossible to create font. Please check file"),!1;this._config=r,this._fntFile=e,e=r.atlasName,(e=cc.spriteFrameCache.getSpriteFrame(e)||cc.spriteFrameCache.getSpriteFrame(cc.path.basename(e)))?(r=e.getTexture(),this._spriteFrame=e):r=cc.textureCache.addImage(r.atlasName),(this._textureLoaded=e=r.isLoaded())||r.addEventListener("load",function(t){this._textureLoaded=!0,this.initWithTexture(t,this._initialString.length),this.setString(this._initialString,!0),this.dispatchEvent("load")},this)}else r=new cc.Texture2D,e=new Image,r.initWithElement(e),this._textureLoaded=!1;return!!this.initWithTexture(r,t.length)&&(this._alignment=n||cc.TEXT_ALIGNMENT_LEFT,this._imageOffset=s||cc.p(0,0),this._width=void 0===i?-1:i,this._realOpacity=255,this._realColor=cc.color(255,255,255,255),this._contentSize.width=0,this._contentSize.height=0,this.setAnchorPoint(.5,.5),this.setString(t,!0),!0)},createFontChars:function(){for(var t=this._string,e=t?t.length:0,i=this._renderCmd,n=i._texture||this._texture,s=0,r=cc.size(0,0),o=0,a=1,c=this._config,h=c.kerningDict,l=c.commonHeight,u=c.fontDefDictionary,d=0;d<e-1;d++)10===t.charCodeAt(d)&&a++;var _,p,f,g,m,y=l*a,a=-(l-l*a),T=-1;for(d=0;d<e;d++)0!==(l=t.charCodeAt(d))&&(10===l?(s=0,a-=c.commonHeight):(T=h[T<<16|65535&l]||0,(_=u[l])||(cc.log("cocos2d: LabelBMFont: character not found "+t[d]),_={rect:{x:0,y:0,width:0,height:0},xOffset:0,yOffset:0,xAdvance:0}),p=cc.rect(_.rect.x,_.rect.y,_.rect.width,_.rect.height),(p=cc.rectPixelsToPoints(p)).x+=this._imageOffset.x,p.y+=this._imageOffset.y,g=!1,this._spriteFrame&&(f=this._spriteFrame._rect,this._spriteFrame._rotated?(g=!0,m=p.x,p.x=p.y+f.x,p.y=m+f.y):(p.x+=f.x,p.y+=f.y)),(f=this.getChildByTag(d))?i._updateCharTexture(f,p,l,g):((f=new cc.Sprite).initWithTexture(n,p,g),f._newTextureWhenChangeColor=!0,this.addChild(f,0,d)),f.opacityModifyRGB=this._opacityModifyRGB,i._updateCharColorAndOpacity(f),p=cc.p(s+_.xOffset+.5*_.rect.width+T,a+(c.commonHeight-_.yOffset)-.5*p.height*cc.contentScaleFactor()),f.setPosition(cc.pointPixelsToPoints(p)),s+=_.xAdvance+T,T=l,o<s&&(o=s)));r.width=_&&_.xAdvance<_.rect.width?o-_.xAdvance+_.rect.width:o,r.height=y,this.setContentSize(cc.sizePixelsToPoints(r))},updateString:function(t){var e=this._children;if(e)for(var i=0,n=e.length;i<n;i++){var s=e[i];s&&(s.visible=!1)}this._config&&this._string&&0<this._string.length&&this.createFontChars(),t||this.updateLabel()},getString:function(){return this._initialString},setString:function(t,e){void 0===e&&(e=!0),void 0!==(t=String(t))&&"string"==typeof t||(t+=""),this._initialString=t,this._setString(t,e)},_setStringForSetter:function(t){this.setString(t,!1)},setCString:function(t){this.setString(t,!0)},_getCharsWidth:function(t,e){var i;return e<=0?0:(i=this.getChildByTag(t),t=this.getChildByTag(t+e),this._getLetterPosXLeft(t)-this._getLetterPosXLeft(i))},_checkWarp:function(t,e,i,n){for(var s=t[e],r=0,o=0;o<e;o++)r+=t[o].length;var r=r+e-n,a=this._getCharsWidth(r,t[e].length-1);if(i<a&&1<s.length){n=i/a*s.length|0;for(var c,o=s.substr(n),h=a-this._getCharsWidth(r+n,o.length-1),l=0,u=0;i<h&&u++<100;)o=s.substr(n=n*(i/h)|0),h=a-this._getCharsWidth(r+n,o.length-1);for(u=0;h<i&&u++<100;)o&&(l=(c=cc.LabelTTF._wordRex.exec(o))?c[0].length:1,c=o),this._lineBreakWithoutSpaces&&(l=0),o=s.substr(n+=l),h=a-this._getCharsWidth(r+n,o.length-1);0===(n-=l)&&(c=c.substr(n=1)),i=s.substr(0,n),cc.LabelTTF.wrapInspection&&cc.LabelTTF._symbolRex.test(c||o)&&(l=(r=cc.LabelTTF._lastWordRex.exec(i))?r[0].length:0,this._lineBreakWithoutSpaces&&(l=0),c=s.substr(n-=l),i=s.substr(0,n)),cc.LabelTTF._firsrEnglish.test(c)&&(r=cc.LabelTTF._lastEnglish.exec(i))&&i!==r[0]&&(l=r[0].length,this._lineBreakWithoutSpaces&&(l=0),c=s.substr(n-=l),i=s.substr(0,n)),t[e]=c||o,t.splice(e,0,i)}},updateLabel:function(){var t;if(this.string=this._initialString,0<this._width){for(var e=this.string.split("\n"),i="",n=0,s=0,r=0;r<e.length;r++)s=e.length,this._checkWarp(e,r,this._width*this._scaleX,n),s<e.length&&n++,0<r&&(i+="\n"),i+=e[r];i+=String.fromCharCode(0),this._setString(i,!1)}if(this._alignment!==cc.TEXT_ALIGNMENT_LEFT)for(e=r=0,i=this._string.length,n=[],s=0;s<i;s++)if(10===this._string[s].charCodeAt(0)||0===this._string[s].charCodeAt(0)){var o=0,a=n.length;if(0===a)e++;else if(!((t=r+a-1+e)<0)){var c=this.getChildByTag(t);if(null!=c){switch(o=c.getPositionX()+c._getWidth()/2,c=0,this._alignment){case cc.TEXT_ALIGNMENT_CENTER:c=this.width/2-o/2;break;case cc.TEXT_ALIGNMENT_RIGHT:c=this.width-o}if(0!==c)for(o=0;o<a;o++)(t=r+o+e)<0||(t=this.getChildByTag(t))&&(t.x+=c);r+=a,e++,n.length=0}}}else n.push(this._string[r])},setAlignment:function(t){this._alignment=t,this.updateLabel()},_getAlignment:function(){return this._alignment},setBoundingWidth:function(t){this._width=t,this.updateLabel()},_getBoundingWidth:function(){return this._width},setLineBreakWithoutSpace:function(t){this._lineBreakWithoutSpaces=t,this.updateLabel()},setScale:function(t,e){cc.Node.prototype.setScale.call(this,t,e),this.updateLabel()},setScaleX:function(t){cc.Node.prototype.setScaleX.call(this,t),this.updateLabel()},setScaleY:function(t){cc.Node.prototype.setScaleY.call(this,t),this.updateLabel()},setFntFile:function(t){var e;null!=t&&t!==this._fntFile&&((e=cc.loader.getRes(t))?(this._fntFile=t,this._config=e,t=cc.textureCache.addImage(e.atlasName),(this._textureLoaded=e=t.isLoaded())?(this.setTexture(t),this._string&&0<this._string.length&&this.createFontChars()):t.addEventListener("load",function(t){this._textureLoaded=!0,this.setTexture(t),this._string&&0<this._string.length&&this.createFontChars(),this._changeTextureColor(),this.updateLabel(),this.dispatchEvent("load")},this)):cc.log("cc.LabelBMFont.setFntFile() : Impossible to create font. Please check file"))},getFntFile:function(){return this._fntFile},setTexture:function(t){this._texture=t,this._renderCmd.setTexture(t)},setAnchorPoint:function(t,e){cc.Node.prototype.setAnchorPoint.call(this,t,e),this.updateLabel()},_setAnchorX:function(t){cc.Node.prototype._setAnchorX.call(this,t),this.updateLabel()},_setAnchorY:function(t){cc.Node.prototype._setAnchorY.call(this,t),this.updateLabel()},_atlasNameFromFntFile:function(t){},_kerningAmountForFirst:function(t,e){var i=0;return i=this._configuration.kerningDictionary&&(t=this._configuration.kerningDictionary[(t<<16|65535&e).toString()])?t.amount:i},_getLetterPosXLeft:function(t){return t.getPositionX()*this._scaleX-t._getWidth()*this._scaleX*t._getAnchorX()},_getLetterPosXRight:function(t){return t.getPositionX()*this._scaleX+t._getWidth()*this._scaleX*t._getAnchorX()},_isspace_unicode:function(t){return 9<=(t=t.charCodeAt(0))&&t<=13||32===t||133===t||160===t||5760===t||8192<=t&&t<=8202||8232===t||8233===t||8239===t||8287===t||12288===t},_utf8_trim_ws:function(t){var e=t.length;if(!(e<=0)&&this._isspace_unicode(t[--e])){for(var i=e-1;0<=i&&this._isspace_unicode(t[i]);--i)e=i;this._utf8_trim_from(t,e)}},_utf8_trim_from:function(t,e){var i=t.length;i<=e||e<0||t.splice(e,i)}}),!function(){var t=cc.LabelBMFont.prototype;cc.EventHelper.prototype.apply(t),cc.defineGetterSetter(t,"string",t.getString,t._setStringForSetter),cc.defineGetterSetter(t,"boundingWidth",t._getBoundingWidth,t.setBoundingWidth),cc.defineGetterSetter(t,"textAlign",t._getAlignment,t.setAlignment),cc.defineGetterSetter(t,"texture",t.getTexture,t.setTexture)}(),cc.LabelBMFont.create=function(t,e,i,n,s){return new cc.LabelBMFont(t,e,i,n,s)},cc.FntFrameCache={},{FNT_HEAD:/fntframes [^\n]*(\n|$)/gi,FNT_FRAME_NAME:/fntframe [^\n]*(\n|$)/gi,INFO_EXP:/info [^\n]*(\n|$)/gi,COMMON_EXP:/common [^\n]*(\n|$)/gi,PAGE_EXP:/page [^\n]*(\n|$)/gi,CHAR_EXP:/char [^\n]*(\n|$)/gi,KERNING_EXP:/kerning [^\n]*(\n|$)/gi,ITEM_EXP:/\w+=[^ \r\n]+/gi,INT_EXP:/^[\-]?\d+$/,_parseStrToObj:function(t){var e={};if(t=t.match(this.ITEM_EXP))for(var i=0,n=t.length;i<n;i++){var s=t[i],r=s.indexOf("="),o=s.substring(0,r);(s=s.substring(r+1)).match(this.INT_EXP)?s=parseInt(s):'"'===s[0]&&(s=s.substring(1,s.length-1)),e[o]=s}return e},_parseFntContent:function(t,e,i,n){var s,r=this._parseStrToObj(e.match(this.COMMON_EXP)[0]);for(t.commonHeight=r.lineHeight,cc._renderType===cc.game.RENDER_TYPE_WEBGL&&(s=cc.configuration.getMaxTextureSize(),r.scaleW>s.width||r.scaleH>s.height)&&cc.log("cc.LabelBMFont._parseCommonArguments(): page can't be larger than supported"),1!==r.pages&&cc.log("cc.LabelBMFont._parseCommonArguments(): only supports 1 page"),0!==(r=this._parseStrToObj(e.match(this.PAGE_EXP)[0])).id&&cc.log("cc.LabelBMFont._parseImageFileName() : file could not be found"),t.atlasName=n?cc.path.join(cc.path.dirname(n.path)+r.file):cc.path.changeBasename(i,r.file),r=e.match(this.CHAR_EXP),s=t.fontDefDictionary={},i=0,n=r.length;i<n;i++){var o=this._parseStrToObj(r[i]);s[o.id]={rect:{x:o.x,y:o.y,width:o.width,height:o.height},xOffset:o.xoffset,yOffset:o.yoffset,xAdvance:o.xadvance}}if(r=t.kerningDict={},e=e.match(this.KERNING_EXP))for(i=0,n=e.length;i<n;i++)r[(s=this._parseStrToObj(e[i])).first<<16|65535&s.second]=s.amount;return t},parseFnt:function(t,e){var i={};if(s=t.match(this.FNT_HEAD)){var n=this._parseStrToObj(s[0]);if(n&&n.count)for(var s=(t=t.substr(s[0].length)).split("----"),r=0;r<n.count;++r){var o,a,c=s[r],h=c.match(this.FNT_FRAME_NAME);h&&(o=this._parseStrToObj(h[0]))&&o.name&&(i={},a=cc.path.join(cc.path.dirname(e),o.name),cc.FntFrameCache[a]=this._parseFntContent(i,c.substr(h[0].length),e,{path:o.name}))}}else i=this._parseFntContent(i,t,e);return i},load:function(t,i,e,n){var s=this;cc.loader.loadTxt(t,function(t,e){if(t)return n(t);n(null,s.parseFnt(e,i))})}});function setProgram(t,e){t.shaderProgram=e;var i=t.children;if(i)for(var n=0;n<i.length;n++)setProgram(i[n],e)}cc.loader.register(["fnt"],_fntLoader),!function(){cc.LabelBMFont.CanvasRenderCmd=function(t){this._rootCtor(t)};var t=cc.LabelBMFont.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);t.constructor=cc.LabelBMFont.CanvasRenderCmd,t._updateCharTexture=function(t,e,i){32===i?t.setTextureRect(e,!1,cc.size(0,0)):(t.setTextureRect(e,!1),t.visible=!0)},t._updateCharColorAndOpacity=function(t){t._displayedColor=this._displayedColor,t._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty),t._displayedOpacity=this._displayedOpacity,t._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.opacityDirty)},t.setTexture=function(t){for(var e=this._node,i=e._children,n=this._displayedColor,s=0;s<i.length;s++){var r=i[s],o=r._renderCmd,a=o._displayedColor;(e._texture===o._texture||a.r===n.r&&a.g===n.g&&a.b===n.b)&&(r.texture=t)}e._texture=t},t._changeTextureColor=function(){var t=this._node,e=t._texture,i=e.getContentSize(),n=t._texture,s=n.getHtmlElementObj(),r=this._displayedColor,o=cc.rect(0,0,s.width,s.height);e&&0<i.width&&s&&(e=n._generateColorTexture(r.r,r.g,r.b,o),t.setTexture(e))},t._updateChildrenDisplayedOpacity=function(t){cc.Node.prototype.updateDisplayedOpacity.call(t,this._displayedOpacity)},t._updateChildrenDisplayedColor=function(t){cc.Node.prototype.updateDisplayedColor.call(t,this._displayedColor)}}(),!function(){cc.LabelBMFont.WebGLRenderCmd=function(t){this._rootCtor(t)};var t=cc.LabelBMFont.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype);t.constructor=cc.LabelBMFont.WebGLRenderCmd,t.setTexture=function(t){this._node.setOpacityModifyRGB(this._node._texture.hasPremultipliedAlpha())},t._updateCharTexture=function(t,e,i,n){t.setTextureRect(e,n),t.visible=!0},t._changeTextureColor=function(){},t._updateCharColorAndOpacity=function(){}}(),cc.LabelAtlas=cc.LabelBMFont.extend({_className:"LabelAtlas",ctor:function(t,e,i,n,s){cc.SpriteBatchNode.prototype.ctor.call(this),this._imageOffset=cc.p(0,0),this._cascadeOpacityEnabled=this._cascadeColorEnabled=!0,e&&cc.LabelAtlas.prototype.initWithString.call(this,t,e,i,n,s)},_createRenderCmd:function(){return new(cc._renderType===cc.game.RENDER_TYPE_WEBGL?cc.LabelBMFont.WebGLRenderCmd:cc.LabelBMFont.CanvasRenderCmd)(this)},_createFntConfig:function(t,e,i,n){var s={},r=(s.commonHeight=i,s.fontDefDictionary={}),o=t.pixelsWidth;t=t.pixelsHeight,n=n.charCodeAt(0);for(var a=0,c=i;c<=t;c+=i)for(var h=0;h<o;h+=e)r[n+a]={rect:{x:h,y:c-i,width:e,height:i},xOffset:0,yOffset:0,xAdvance:e},++a;return s.kerningDict={},s},initWithString:function(t,e,i,n,s){var r,o;if(this._string=this._initialString=t=t+""||"",void 0===i){if(s=cc.loader.getRes(e),1!==parseInt(s.version,10))return cc.log("cc.LabelAtlas.initWithString(): Unsupported version. Upgrade cocos2d version"),!1;r=cc.path.changeBasename(e,s.textureFilename),n=cc.contentScaleFactor(),i=parseInt(s.itemWidth,10)/n,n=parseInt(s.itemHeight,10)/n,s=String.fromCharCode(parseInt(s.firstChar,10))}else r=e,i=i||0,n=n||0,s=s||" ";return e?(this._fntFile="dummy_fnt_file:"+r,e=r,(o=cc.spriteFrameCache.getSpriteFrame(e)||cc.spriteFrameCache.getSpriteFrame(cc.path.basename(e)))?(e=o.getTexture(),this._spriteFrame=o):e=cc.textureCache.addImage(r),(i=this._createFntConfig(e,i,n,s)).atlasName=r,this._config=i,(this._textureLoaded=r=e.isLoaded())||e.addEventListener("load",function(t){this._textureLoaded=!0,this.initWithTexture(t,this._initialString.length),this.setString(this._initialString,!0),this.dispatchEvent("load")},this)):(e=new cc.Texture2D,r=new Image,e.initWithElement(r),this._textureLoaded=!1),!!this.initWithTexture(e,t.length)&&(this._alignment=cc.TEXT_ALIGNMENT_LEFT,this._imageOffset=cc.p(0,0),this._width=-1,this._realOpacity=255,this._realColor=cc.color(255,255,255,255),this._contentSize.width=0,this._contentSize.height=0,this.setString(t,!0),!0)},setFntFile:function(){cc.warn("setFntFile doesn't support with LabelAtlas.")}}),cc.LabelAtlas.create=function(t,e,i,n,s){return new cc.LabelAtlas(t,e,i,n,s)},!function(){cc.LabelAtlas.CanvasRenderCmd=function(t){cc.AtlasNode.CanvasRenderCmd.call(this,t),this._needDraw=!1};var t=cc.LabelAtlas.CanvasRenderCmd.prototype=Object.create(cc.AtlasNode.CanvasRenderCmd.prototype);t.constructor=cc.LabelAtlas.CanvasRenderCmd,t.setCascade=function(){var t=this._node;t._cascadeOpacityEnabled=!0,t._cascadeColorEnabled=!1},t.updateAtlasValues=function(){for(var t=this._node,e=t._string||"",i=e.length,n=this._textureToRender,s=t._itemWidth,r=t._itemHeight,o=0,a=-1;o<i;o++){var c,h=e.charCodeAt(o)-t._mapStartChar.charCodeAt(0),l=parseInt(h%t._itemsPerRow,10),h=parseInt(h/t._itemsPerRow,10);l<0||h<0||(l=cc.rect(l*s,h*r,s,r),h=n._contentSize,l.x<0)||l.y<0||l.x+l.width>h.width||l.y+l.height>h.height||(a++,h=e.charCodeAt(o),(c=t.getChildByTag(o))?32===h?(c.init(),c.setTextureRect(cc.rect(0,0,10,10),!1,cc.size(0,0))):(c.initWithTexture(n,l),c.visible=!0):(c=new cc.Sprite,32===h?(c.init(),c.setTextureRect(cc.rect(0,0,10,10),!1,cc.size(0,0))):c.initWithTexture(n,l),cc.Node.prototype.addChild.call(t,c,0,o)),c.setPosition(a*s+s/2,r/2))}this.updateContentSize(o,a+1)},t.updateContentSize=function(t,e){var i=this._node,n=i._contentSize;t!==e&&t*i._itemWidth===n.width&&i._itemHeight===n.height&&i.setContentSize(e*i._itemWidth,i._itemHeight)},t.setString=function(t){if((t=this._node)._children)for(var e=(t=t._children).length,i=0;i<e;i++){var n=t[i];n&&!n._lateChild&&(n.visible=!1)}},t._addChild=function(){child._lateChild=!0}}(),!function(){cc.LabelAtlas.WebGLRenderCmd=function(t){cc.AtlasNode.WebGLRenderCmd.call(this,t),this._needDraw=!0};var t=cc.LabelAtlas.WebGLRenderCmd.prototype=Object.create(cc.AtlasNode.WebGLRenderCmd.prototype);t.constructor=cc.LabelAtlas.WebGLRenderCmd,t._updateColor=function(){var t,e;this._colorF32Array&&(t=this._displayedColor,e=this._displayedOpacity/255,this._node._opacityModifyRGB?(this._colorF32Array[0]=t.r*e/255,this._colorF32Array[1]=t.g*e/255,this._colorF32Array[2]=t.b*e/255):(this._colorF32Array[0]=t.r/255,this._colorF32Array[1]=t.g/255,this._colorF32Array[2]=t.b/255),this._colorF32Array[3]=e)},t.setCascade=function(){var t=this._node;t._cascadeOpacityEnabled=!0,t._cascadeColorEnabled=!0},t.rendering=function(t){var e,i,n;cc.AtlasNode.WebGLRenderCmd.prototype.rendering.call(this,t),cc.LABELATLAS_DEBUG_DRAW&&(t=(e=this._node).getContentSize(),i=(e=e.getBoundingBoxToWorld()).x,n=e.y,t.width=e.width,t.height=e.height,t=[cc.p(i,n),cc.p(i+t.width,n),cc.p(t.width+i,t.height+n),cc.p(i,n+t.height)],cc._drawingUtil.drawPoly(t,4,!0))},t.updateAtlasValues=function(){var t=this._node,e=t._string,i=e.length,n=this._textureAtlas,s=(r=n.texture).pixelsWidth,r=r.pixelsHeight,o=t._itemWidth,a=t._itemHeight;t._ignoreContentScaleFactor||(o=t._itemWidth*cc.contentScaleFactor(),a=t._itemHeight*cc.contentScaleFactor()),i>n.getCapacity()&&cc.log("cc.LabelAtlas._updateAtlasValues(): Invalid String length");for(var c=n.quads,h=t._itemWidth,l=t._itemHeight,u=0,d=-1;u<i;u++){var _,p,f,g,m,y=e.charCodeAt(u)-t._mapStartChar.charCodeAt(0),T=y%t._itemsPerRow,S=0|y/t._itemsPerRow;T<0||S<0||s<T*h+h||r<S*l+l||(d++,_=cc.FIX_ARTIFACTS_BY_STRECHING_TEXEL?(y=(T=(2*T*o+1)/(2*s))+(2*o-2)/(2*s),(S=(2*S*a+1)/(2*r))+(2*a-2)/(2*r)):(y=(T=T*o/s)+o/s,(S=S*a/r)+a/r),p=(m=c[u]).tl,f=m.tr,g=m.bl,m=m.br,p.texCoords.u=T,p.texCoords.v=S,f.texCoords.u=y,f.texCoords.v=S,g.texCoords.u=T,g.texCoords.v=_,m.texCoords.u=y,m.texCoords.v=_,g.vertices.x=d*h,g.vertices.y=0,g.vertices.z=0,m.vertices.x=d*h+h,m.vertices.y=0,m.vertices.z=0,p.vertices.x=d*h,p.vertices.y=t._itemHeight,p.vertices.z=0,f.vertices.x=d*h+h,f.vertices.y=t._itemHeight,f.vertices.z=0)}this._updateColor(),this.updateContentSize(u,d+1),0<i&&(n.dirty=!0,(t=n.totalQuads)<i)&&n.increaseTotalQuadsWith(i-t)},t.updateContentSize=function(t,e){var i=this._node,n=i._contentSize;t!==e&&t*i._itemWidth===n.width&&i._itemHeight===n.height&&i.setContentSize(e*i._itemWidth,i._itemHeight)},t.setString=function(t){(t=t.length)>this._textureAtlas.totalQuads&&this._textureAtlas.resizeCapacity(t)},t._addChild=function(){}}(),cc.MotionStreak=cc.Node.extend({texture:null,fastMode:!1,startingPositionInitialized:!1,_blendFunc:null,_stroke:0,_fadeDelta:0,_minSeg:0,_maxPoints:0,_nuPoints:0,_previousNuPoints:0,_pointVertexes:null,_pointState:null,_vertices:null,_colorPointer:null,_texCoords:null,_verticesBuffer:null,_colorPointerBuffer:null,_texCoordsBuffer:null,_className:"MotionStreak",ctor:function(t,e,i,n,s){cc.Node.prototype.ctor.call(this),this._positionR=cc.p(0,0),this._blendFunc=new cc.BlendFunc(cc.SRC_ALPHA,cc.ONE_MINUS_SRC_ALPHA),this.startingPositionInitialized=this.fastMode=!1,this.texture=null,this._previousNuPoints=this._nuPoints=this._maxPoints=this._minSeg=this._fadeDelta=this._stroke=0,this._texCoordsBuffer=this._colorPointerBuffer=this._verticesBuffer=this._texCoords=this._colorPointer=this._vertices=this._pointState=this._pointVertexes=null,void 0!==s&&this.initWithFade(t,e,i,n,s)},getTexture:function(){return this.texture},setTexture:function(t){this.texture!==t&&(this.texture=t)},getBlendFunc:function(){return this._blendFunc},setBlendFunc:function(t,e){void 0===e?this._blendFunc=t:(this._blendFunc.src=t,this._blendFunc.dst=e)},getOpacity:function(){return cc.log("cc.MotionStreak.getOpacity has not been supported."),0},setOpacity:function(t){cc.log("cc.MotionStreak.setOpacity has not been supported.")},setOpacityModifyRGB:function(t){},isOpacityModifyRGB:function(){return!1},isFastMode:function(){return this.fastMode},setFastMode:function(t){this.fastMode=t},isStartingPositionInitialized:function(){return this.startingPositionInitialized},setStartingPositionInitialized:function(t){this.startingPositionInitialized=t},getStroke:function(){return this._stroke},setStroke:function(t){this._stroke=t},initWithFade:function(t,e,i,n,s){if(s)return cc.isString(s)&&(s=cc.textureCache.addImage(s)),cc.Node.prototype.setPosition.call(this,cc.p(0,0)),this.anchorY=this.anchorX=0,this.ignoreAnchor=!0,this.startingPositionInitialized=!1,this.fastMode=!0,this._minSeg=-1===e?i/5:e,this._minSeg*=this._minSeg,this._stroke=i,this._fadeDelta=1/t,this._maxPoints=t=2+(0|60*t),this._nuPoints=0,this._pointState=new Float32Array(t),this._pointVertexes=new Float32Array(2*t),this._vertices=new Float32Array(4*t),this._texCoords=new Float32Array(4*t),this._colorPointer=new Uint8Array(8*t),this._verticesBuffer=gl.createBuffer(),this._texCoordsBuffer=gl.createBuffer(),this._colorPointerBuffer=gl.createBuffer(),this._blendFunc.src=gl.SRC_ALPHA,this._blendFunc.dst=gl.ONE_MINUS_SRC_ALPHA,this.texture=s,this.color=n,this.scheduleUpdate(),gl.bindBuffer(gl.ARRAY_BUFFER,this._verticesBuffer),gl.bufferData(gl.ARRAY_BUFFER,this._vertices,gl.DYNAMIC_DRAW),gl.bindBuffer(gl.ARRAY_BUFFER,this._texCoordsBuffer),gl.bufferData(gl.ARRAY_BUFFER,this._texCoords,gl.DYNAMIC_DRAW),gl.bindBuffer(gl.ARRAY_BUFFER,this._colorPointerBuffer),gl.bufferData(gl.ARRAY_BUFFER,this._colorPointer,gl.DYNAMIC_DRAW),!0;throw Error("cc.MotionStreak.initWithFade(): Invalid filename or texture")},tintWithColor:function(t){this.color=t;for(var e=this._colorPointer,i=0,n=2*this._nuPoints;i<n;i++)e[4*i]=t.r,e[4*i+1]=t.g,e[4*i+2]=t.b},reset:function(){this._nuPoints=0},setPosition:function(t,e){this.startingPositionInitialized=!0,void 0===e?(this._positionR.x=t.x,this._positionR.y=t.y):(this._positionR.x=t,this._positionR.y=e)},getPositionX:function(){return this._positionR.x},setPositionX:function(t){this._positionR.x=t,this.startingPositionInitialized||(this.startingPositionInitialized=!0)},getPositionY:function(){return this._positionR.y},setPositionY:function(t){this._positionR.y=t,this.startingPositionInitialized||(this.startingPositionInitialized=!0)},update:function(t){if(this.startingPositionInitialized){this._renderCmd._updateDisplayColor(),t*=this._fadeDelta;for(var e,i,n,s=0,r=this._nuPoints,o=this._pointState,a=this._pointVertexes,c=this._vertices,h=this._colorPointer,l=0;l<r;l++)o[l]-=t,o[l]<=0?s++:(e=l-s,0<s?(o[e]=o[l],a[2*e]=a[2*l],a[2*e+1]=a[2*l+1],c[2*(i=2*e)]=c[2*(n=2*l)],c[2*i+1]=c[2*n+1],c[2*(i+1)]=c[2*(1+n)],c[2*(i+1)+1]=c[2*(1+n)+1],h[(i*=4)+0]=h[0+(n*=4)],h[i+1]=h[1+n],h[i+2]=h[2+n],h[i+4]=h[4+n],h[i+5]=h[5+n],h[i+6]=h[6+n]):i=8*e,e=255*o[e],h[i+3]=e,h[i+7]=e);if(l=!0,(l=(r-=s)>=this._maxPoints||0<r&&(t=cc.pDistanceSQ(cc.p(a[2*(r-1)],a[2*(r-1)+1]),this._positionR)<this._minSeg,i=1!==r&&cc.pDistanceSQ(cc.p(a[2*(r-2)],a[2*(r-2)+1]),this._positionR)<2*this._minSeg,t||i)?!1:l)&&(a[2*r]=this._positionR.x,a[2*r+1]=this._positionR.y,o[r]=1,o=8*r,l=this.getDisplayedColor(),h[o]=l.r,h[o+1]=l.g,h[o+2]=l.b,h[o+4]=l.r,h[o+5]=l.g,h[o+6]=l.b,h[o+3]=255,h[o+7]=255,0<r&&this.fastMode&&(1<r?cc.vertexLineToPolygon(a,this._stroke,this._vertices,r,1):cc.vertexLineToPolygon(a,this._stroke,this._vertices,0,2)),r++),this.fastMode||cc.vertexLineToPolygon(a,this._stroke,this._vertices,0,r),r&&this._previousNuPoints!==r){for(a=1/r,h=this._texCoords,l=0;l<r;l++)h[4*l]=0,h[4*l+1]=a*l,h[2*(2*l+1)]=1,h[2*(2*l+1)+1]=a*l;this._previousNuPoints=r}this._nuPoints=r}},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_WEBGL?new cc.MotionStreak.WebGLRenderCmd(this):null}}),cc.MotionStreak.create=function(t,e,i,n,s){return new cc.MotionStreak(t,e,i,n,s)},cc.MotionStreak.WebGLRenderCmd=function(t){this._rootCtor(t),this._needDraw=!0,this._matrix=new cc.math.Matrix4,this._matrix.identity(),this._shaderProgram=cc.shaderCache.programForKey(cc.SHADER_POSITION_TEXTURECOLOR)},cc.MotionStreak.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype),cc.MotionStreak.WebGLRenderCmd.prototype.constructor=cc.Sprite.WebGLRenderCmd,cc.MotionStreak.WebGLRenderCmd.prototype.rendering=function(t){var e,i=this._node;i._nuPoints<=1||!i.texture||!i.texture.isLoaded()||(t=t||cc._renderContext,e=this._worldTransform,this._matrix.mat[0]=e.a,this._matrix.mat[4]=e.c,this._matrix.mat[12]=e.tx,this._matrix.mat[1]=e.b,this._matrix.mat[5]=e.d,this._matrix.mat[13]=e.ty,this._glProgramState.apply(this._matrix),cc.glBlendFunc(i._blendFunc.src,i._blendFunc.dst),cc.glBindTexture2D(i.texture),t.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),t.enableVertexAttribArray(cc.VERTEX_ATTRIB_COLOR),t.enableVertexAttribArray(cc.VERTEX_ATTRIB_TEX_COORDS),t.bindBuffer(t.ARRAY_BUFFER,i._verticesBuffer),t.bufferData(t.ARRAY_BUFFER,i._vertices,t.DYNAMIC_DRAW),t.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,i._texCoordsBuffer),t.bufferData(t.ARRAY_BUFFER,i._texCoords,t.DYNAMIC_DRAW),t.vertexAttribPointer(cc.VERTEX_ATTRIB_TEX_COORDS,2,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,i._colorPointerBuffer),t.bufferData(t.ARRAY_BUFFER,i._colorPointer,t.DYNAMIC_DRAW),t.vertexAttribPointer(cc.VERTEX_ATTRIB_COLOR,4,t.UNSIGNED_BYTE,!0,0,0),t.drawArrays(t.TRIANGLE_STRIP,0,2*i._nuPoints),cc.g_NumberOfDraws++)},cc.NodeGrid=cc.Node.extend({grid:null,_target:null,_gridRect:null,ctor:function(t){cc.Node.prototype.ctor.call(this),void 0===t&&(t=cc.rect()),this._gridRect=t},getGrid:function(){return this.grid},setGrid:function(t){this.grid=t},setGridRect:function(t){this._gridRect=t},getGridRect:function(){return this._gridRect},setTarget:function(t){this._target=t},_createRenderCmd:function(){return new(cc._renderType===cc.game.RENDER_TYPE_WEBGL?cc.NodeGrid.WebGLRenderCmd:cc.Node.CanvasRenderCmd)(this)}}),_p=cc.NodeGrid.prototype,cc.defineGetterSetter(_p,"target",null,_p.setTarget),cc.NodeGrid.create=function(){return new cc.NodeGrid},!function(){cc.NodeGrid.WebGLRenderCmd=function(t){this._rootCtor(t),this._needDraw=!1,this._gridBeginCommand=new cc.CustomRenderCmd(this,this.onGridBeginDraw),this._gridEndCommand=new cc.CustomRenderCmd(this,this.onGridEndDraw)};var t=cc.NodeGrid.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype);t.constructor=cc.NodeGrid.WebGLRenderCmd,t.visit=function(t){var e=this._node;if(e._visible){(t=t||this.getParentRenderCmd())&&(this._curLevel=t._curLevel+1);var i=cc.current_stack;if(i.stack.push(i.top),this._syncStatus(t),i.top=this._stackMatrix,cc.renderer.pushRenderCommand(this._gridBeginCommand),e._target&&e._target.visit(),(t=e._children)&&0<t.length){var n=t.length;for(e.sortAllChildren(),e=0;e<n;e++){var s=t[e];s&&s.visit()}}cc.renderer.pushRenderCommand(this._gridEndCommand),this._dirtyFlag=0,i.top=i.stack.pop()}},t.onGridBeginDraw=function(){var t=this._node.grid;t&&t._active&&t.beforeDraw()},t.onGridEndDraw=function(){var t=this._node.grid;t&&t._active&&t.afterDraw(this._node)}}(),cc.DrawNode=cc.Node.extend({_buffer:null,_blendFunc:null,_lineWidth:1,_drawColor:null,getBlendFunc:function(){return this._blendFunc},setBlendFunc:function(t,e){void 0===e?(this._blendFunc.src=t.src,this._blendFunc.dst=t.dst):(this._blendFunc.src=t,this._blendFunc.dst=e)},setLineWidth:function(t){this._lineWidth=t},getLineWidth:function(){return this._lineWidth},setDrawColor:function(t){var e=this._drawColor;e.r=t.r,e.g=t.g,e.b=t.b,e.a=null==t.a?255:t.a},getDrawColor:function(){return cc.color(this._drawColor.r,this._drawColor.g,this._drawColor.b,this._drawColor.a)}}),cc.DrawNode.create=function(){return new cc.DrawNode},cc.DrawNode.TYPE_DOT=0,cc.DrawNode.TYPE_SEGMENT=1,cc.DrawNode.TYPE_POLY=2,cc.game.addEventListener(cc.game.EVENT_RENDERER_INITED,function(){var s,y,u,d,a,x,P,R,L,T;cc._renderType===cc.game.RENDER_TYPE_CANVAS?(cc._DrawNodeElement=function(t,e,i,n,s,r,o,a,c){this.type=t,this.verts=e||null,this.fillColor=i||null,this.lineWidth=n||0,this.lineColor=s||null,this.lineCap=r||"butt",this.isClosePolygon=o||!1,this.isFill=a||!1,this.isStroke=c||!1},cc.extend(cc.DrawNode.prototype,{_className:"DrawNodeCanvas",ctor:function(){cc.Node.prototype.ctor.call(this);var t=this._renderCmd;t._buffer=this._buffer=[],t._drawColor=this._drawColor=cc.color(255,255,255,255),t._blendFunc=this._blendFunc=new cc.BlendFunc(cc.SRC_ALPHA,cc.ONE_MINUS_SRC_ALPHA),this.init(),this._localBB=new cc.Rect},setLocalBB:function(t,e,i,n){var s=this._localBB;void 0===e?(s.x=t.x,s.y=t.y,s.width=t.width,s.height=t.height):(s.x=t,s.y=e,s.width=i,s.height=n)},drawRect:function(t,e,i,n,s){n=null==n?this._lineWidth:n,null==(s=s||this.getDrawColor()).a&&(s.a=255),t=[t,cc.p(e.x,t.y),e,cc.p(t.x,e.y)],(e=new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY)).verts=t,e.lineWidth=n,e.lineColor=s,e.isClosePolygon=!0,e.isStroke=!0,e.lineCap="butt",(e.fillColor=i)&&(null==i.a&&(i.a=255),e.isFill=!0),this._buffer.push(e)},drawCircle:function(t,e,i,n,s,r,o){r=r||this._lineWidth,null==(o=o||this.getDrawColor()).a&&(o.a=255);for(var a=2*Math.PI/n,c=[],h=0;h<=n;h++){var l=h*a,u=e*Math.cos(l+i)+t.x,l=e*Math.sin(l+i)+t.y;c.push(cc.p(u,l))}s&&c.push(cc.p(t.x,t.y)),(t=new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY)).verts=c,t.lineWidth=r,t.lineColor=o,t.isClosePolygon=!0,t.isStroke=!0,this._buffer.push(t)},drawQuadBezier:function(t,e,i,n,s,r){s=s||this._lineWidth,null==(r=r||this.getDrawColor()).a&&(r.a=255);for(var o=[],a=0,c=0;c<n;c++){var h=Math.pow(1-a,2)*t.x+2*(1-a)*a*e.x+a*a*i.x,l=Math.pow(1-a,2)*t.y+2*(1-a)*a*e.y+a*a*i.y;o.push(cc.p(h,l)),a+=1/n}o.push(cc.p(i.x,i.y)),(t=new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY)).verts=o,t.lineWidth=s,t.lineColor=r,t.isStroke=!0,t.lineCap="round",this._buffer.push(t)},drawCubicBezier:function(t,e,i,n,s,r,o){r=r||this._lineWidth,null==(o=o||this.getDrawColor()).a&&(o.a=255);for(var a=[],c=0,h=0;h<s;h++){var l=Math.pow(1-c,3)*t.x+3*Math.pow(1-c,2)*c*e.x+3*(1-c)*c*c*i.x+c*c*c*n.x,u=Math.pow(1-c,3)*t.y+3*Math.pow(1-c,2)*c*e.y+3*(1-c)*c*c*i.y+c*c*c*n.y;a.push(cc.p(l,u)),c+=1/s}a.push(cc.p(n.x,n.y)),(t=new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY)).verts=a,t.lineWidth=r,t.lineColor=o,t.isStroke=!0,t.lineCap="round",this._buffer.push(t)},drawCatmullRom:function(t,e,i,n){this.drawCardinalSpline(t,.5,e,i,n)},drawCardinalSpline:function(t,e,i,n,s){n=n||this._lineWidth,null==(s=s||this.getDrawColor()).a&&(s.a=255);for(var r,o,a=[],c=1/t.length,h=0;h<i+1;h++)o=1===(o=h/i)?(r=t.length-1,1):(o-c*(r=0|o/c))/c,r=cc.cardinalSplineAt(cc.getControlPointAt(t,r-1),cc.getControlPointAt(t,+r),cc.getControlPointAt(t,r+1),cc.getControlPointAt(t,r+2),e,o),a.push(r);(t=new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY)).verts=a,t.lineWidth=n,t.lineColor=s,t.isStroke=!0,t.lineCap="round",this._buffer.push(t)},drawDot:function(t,e,i){null==(i=i||this.getDrawColor()).a&&(i.a=255);var n=new cc._DrawNodeElement(cc.DrawNode.TYPE_DOT);n.verts=[t],n.lineWidth=e,n.fillColor=i,this._buffer.push(n)},drawDots:function(t,e,i){if(t&&0!=t.length){null==(i=i||this.getDrawColor()).a&&(i.a=255);for(var n=0,s=t.length;n<s;n++)this.drawDot(t[n],e,i)}},drawSegment:function(t,e,i,n){i=i||this._lineWidth,null==(n=n||this.getDrawColor()).a&&(n.a=255);var s=new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY);s.verts=[t,e],s.lineWidth=2*i,s.lineColor=n,s.isStroke=!0,s.lineCap="round",this._buffer.push(s)},drawPoly_:function(t,e,i,n){i=null==i?this._lineWidth:i,null==(n=n||this.getDrawColor()).a&&(n.a=255);var s=new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY);s.verts=t,s.fillColor=e,s.lineWidth=i,s.lineColor=n,s.isClosePolygon=!0,s.isStroke=!0,s.lineCap="round",e&&(s.isFill=!0),this._buffer.push(s)},drawPoly:function(t,e,i,n){for(var s=[],r=0;r<t.length;r++)s.push(cc.p(t[r].x,t[r].y));return this.drawPoly_(s,e,i,n)},clear:function(){this._buffer.length=0},_createRenderCmd:function(){return new cc.DrawNode.CanvasRenderCmd(this)}})):cc._renderType===cc.game.RENDER_TYPE_WEBGL&&(s=null,y=[],u=cc.p(),d=cc.p(),a=new Uint32Array(1),x=cc.p(),P=cc.p(),R=cc.p(),L=cc.p(),T=[],cc.extend(cc.DrawNode.prototype,{_bufferCapacity:0,_vertexCount:0,_offset:0,_occupiedSize:0,_f32Buffer:null,_ui32Buffer:null,_dirty:!1,_className:"DrawNodeWebGL",manualRelease:!1,ctor:function(t,e){cc.Node.prototype.ctor.call(this),s=s||new GlobalVertexBuffer(cc._renderContext,20*cc.DRAWNODE_TOTAL_VERTICES),this._renderCmd._shaderProgram=cc.shaderCache.programForKey(cc.SHADER_POSITION_LENGTHTEXTURECOLOR),this._blendFunc=new cc.BlendFunc(cc.SRC_ALPHA,cc.ONE_MINUS_SRC_ALPHA),this._drawColor=cc.color(255,255,255,255),this._bufferCapacity=t||64,this.manualRelease=e,this._dirty=!0},onEnter:function(){cc.Node.prototype.onEnter.call(this),this._occupiedSize<this._bufferCapacity&&this._ensureCapacity(this._bufferCapacity)},onExit:function(){this.manualRelease||this.release(),cc.Node.prototype.onExit.call(this)},release:function(){0<this._occupiedSize&&(this._vertexCount=0,s.freeBuffer(this._offset,20*this._occupiedSize),this._occupiedSize=0)},_ensureCapacity:function(t){var e=this._occupiedSize,i=this._offset;if(e<t||this._bufferCapacity>e){var n=Math.max(Math.min(e+e,200),t,this._bufferCapacity);if(0!==e&&(s.freeBuffer(i,20*e),this._occupiedSize=0),0<=(t=this._offset=s.requestBuffer(20*n))){if(this._occupiedSize=this._bufferCapacity=n,this._f32Buffer=new Float32Array(s.data,t,5*this._occupiedSize),this._ui32Buffer=new Uint32Array(s.data,t,5*this._occupiedSize),0!==e&&i!==t)for(e=i/4+5*e,t/=4,i/=4;i<e;t++,i++)s.dataArray[t]=s.dataArray[i];return!0}return cc.warn("Failed to allocate buffer for DrawNode: buffer for "+n+" vertices requested"),!1}return!0},drawRect:function(t,e,i,n,s){n=null==n?this._lineWidth:n,s=s||this._drawColor,y.length=0,y.push(t.x,t.y,e.x,t.y,e.x,e.y,t.x,e.y),null==i?this._drawSegments(y,n,s,!0):this.drawPoly(y,i,n,s),y.length=0},drawCircle:function(t,e,i,n,s,r,o){r=r||this._lineWidth,o=o||this._drawColor;for(var a=2*Math.PI/n,c=y.length=0;c<=n;c++){var h=c*a,l=e*Math.cos(h+i)+t.x,h=e*Math.sin(h+i)+t.y;y.push(l,h)}for(s&&y.push(t.x,t.y),r*=.5,c=0,t=y.length-2;c<t;c+=2)u.x=y[c],u.y=y[c+1],d.x=y[c+2],d.y=y[c+3],this.drawSegment(u,d,r,o);y.length=0},drawQuadBezier:function(t,e,i,n,s,r){s=s||this._lineWidth,r=r||this._drawColor;for(var o=0,a=y.length=0;a<n;a++){var c=Math.pow(1-o,2)*t.x+2*(1-o)*o*e.x+o*o*i.x,h=Math.pow(1-o,2)*t.y+2*(1-o)*o*e.y+o*o*i.y;y.push(c,h),o+=1/n}y.push(i.x,i.y),this._drawSegments(y,s,r,!1),y.length=0},drawCubicBezier:function(t,e,i,n,s,r,o){r=r||this._lineWidth,o=o||this._drawColor;for(var a=0,c=y.length=0;c<s;c++){var h=Math.pow(1-a,3)*t.x+3*Math.pow(1-a,2)*a*e.x+3*(1-a)*a*a*i.x+a*a*a*n.x,l=Math.pow(1-a,3)*t.y+3*Math.pow(1-a,2)*a*e.y+3*(1-a)*a*a*i.y+a*a*a*n.y;y.push(h,l),a+=1/s}y.push(n.x,n.y),this._drawSegments(y,r,o,!1),y.length=0},drawCatmullRom:function(t,e,i,n){this.drawCardinalSpline(t,.5,e,i,n)},drawCardinalSpline:function(t,e,i,n,s){n=n||this._lineWidth,s=s||this._drawColor;for(var r,o,a=1/t.length,c=y.length=0;c<i+1;c++)o=1===(o=c/i)?(r=t.length-1,1):(o-a*(r=0|o/a))/a,cc.cardinalSplineAt(cc.getControlPointAt(t,r-1),cc.getControlPointAt(t,+r),cc.getControlPointAt(t,r+1),cc.getControlPointAt(t,r+2),e,o,u),y.push(u.x,u.y);for(n*=.5,t=0,e=y.length-2;t<e;t+=2)u.x=y[t],u.y=y[t+1],d.x=y[t+2],d.y=y[t+3],this.drawSegment(u,d,n,s);y.length=0},drawDots:function(t,e,i){if(t&&0!==t.length){i=i||this._drawColor;for(var n=0,s=t.length;n<s;n++)this.drawDot(t[n],e,i)}},_render:function(){var t=cc._renderContext;this._offset<0||this._vertexCount<=0||(this._dirty?(s.updateSubData(this._offset,this._f32Buffer),this._dirty=!1):t.bindBuffer(t.ARRAY_BUFFER,s.vertexBuffer),t.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),t.enableVertexAttribArray(cc.VERTEX_ATTRIB_COLOR),t.enableVertexAttribArray(cc.VERTEX_ATTRIB_TEX_COORDS),t.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,t.FLOAT,!1,20,0),t.vertexAttribPointer(cc.VERTEX_ATTRIB_COLOR,4,t.UNSIGNED_BYTE,!0,20,8),t.vertexAttribPointer(cc.VERTEX_ATTRIB_TEX_COORDS,2,t.FLOAT,!1,20,12),t.drawArrays(t.TRIANGLES,this._offset/20,this._vertexCount),cc.incrementGLDraws(1))},appendVertexData:function(t,e,i,n,s){var r=this._f32Buffer,o=5*this._vertexCount;r[o]=t,r[1+o]=e,a[0]=i.a<<24|i.b<<16|i.g<<8|i.r,this._ui32Buffer[2+o]=a[0],r[3+o]=n,r[4+o]=s,this._vertexCount++},drawDot:function(t,e,i){null==(i=i||this._drawColor).a&&(i.a=255);var n=t.x-e,s=t.y-e,r=t.x+e;t=t.y+e,this._ensureCapacity(this._vertexCount+6)&&(this.appendVertexData(n,s,i,-1,-1),this.appendVertexData(n,t,i,-1,1),this.appendVertexData(r,t,i,1,1),this.appendVertexData(n,s,i,-1,-1),this.appendVertexData(r,t,i,1,1),this.appendVertexData(r,s,i,1,-1),this._dirty=!0)},drawSegment:function(t,e,i,n){var s,r,o,a,c,h,l,u,d,_,p,f,g,m,y,T,S,C,E,I,v,b,A,F;null==(n=n||this.getDrawColor()).a&&(n.a=255),i=i||.5*this._lineWidth,this._ensureCapacity(this._vertexCount+18)&&(x.x=t.y-e.y,x.y=e.x-t.x,cc.pNormalizeIn(x),P.x=-x.y,P.y=x.x,s=i,R.x=x.x*s,R.y=x.y*s,L.x=P.x*i,L.y=P.y*i,i=e.x+R.x-L.x,s=e.y+R.y-L.y,r=x.x-P.x,o=x.y-P.y,a=e.x-R.x,c=e.y-R.y,h=-x.x,l=-x.y,u=e.x+R.x,d=e.y+R.y,_=x.x,p=x.y,f=t.x-R.x,g=t.y-R.y,m=t.x+R.x,y=t.y+R.y,T=x.x,S=x.y,C=t.x-R.x+L.x,E=t.y-R.y+L.y,I=P.x-x.x,v=P.y-x.y,b=t.x+R.x+L.x,t=t.y+R.y+L.y,A=x.x+P.x,F=x.y+P.y,this.appendVertexData(e.x-R.x-L.x,e.y-R.y-L.y,n,-(x.x+P.x),-(x.y+P.y)),this.appendVertexData(i,s,n,r,o),this.appendVertexData(a,c,n,h,l),this.appendVertexData(u,d,n,_,p),this.appendVertexData(i,s,n,r,o),this.appendVertexData(a,c,n,h,l),this.appendVertexData(u,d,n,_,p),this.appendVertexData(f,g,n,h,l),this.appendVertexData(a,c,n,h,l),this.appendVertexData(u,d,n,_,p),this.appendVertexData(f,g,n,h,l),this.appendVertexData(m,y,n,T,S),this.appendVertexData(C,E,n,I,v),this.appendVertexData(f,g,n,h,l),this.appendVertexData(m,y,n,T,S),this.appendVertexData(C,E,n,I,v),this.appendVertexData(b,t,n,A,F),this.appendVertexData(m,y,n,T,S),this._dirty=!0)},drawPoly:function(t,e,i,n){if("object"==typeof t[0]){for(var s=y.length=0;s<t.length;s++)y.push(t[s].x,t[s].y);t=y}if(null==e)this._drawSegments(t,i,n,!0);else{null==e.a&&(e.a=255),null==n.a&&(n.a=255),i=null==i?this._lineWidth:i,i*=.5;for(var r,o,a,c,h,l,u,d=t.length,s=T.length=0;s<d;s+=2)r=t[(s-2+d)%d],o=t[(s-1+d)%d],a=t[s],c=t[s+1],h=t[(s+2)%d],l=t[(s+3)%d],x.x=o-c,x.y=a-r,R.x=c-l,R.y=h-a,cc.pNormalizeIn(x),cc.pNormalizeIn(R),c=x.x*R.x+x.y*R.y+1,u=(x.x+R.x)/c,c=(x.y+R.y)/c,T.push(u,c,R.x,R.y);if(u=0<i,this._ensureCapacity(this._vertexCount+3*(3*(d/=2)-2))){for(var _,p,f,g,m=0==u?.5:0,s=0;s<d-2;s++)r=t[0]-T[0]*m,o=t[1]-T[1]*m,a=t[2*s+2]-T[4*(s+1)]*m,c=t[2*s+3]-T[4*(s+1)+1]*m,h=t[2*s+4]-T[4*(s+2)]*m,l=t[2*s+5]-T[4*(s+2)+1]*m,this.appendVertexData(r,o,e,0,0),this.appendVertexData(a,c,e,0,0),this.appendVertexData(h,l,e,0,0);for(i=u?i:.5,e=u?n:e,s=0;s<d;s++)r=t[2*s],o=t[2*s+1],a=t[2*(n=(s+1)%d)],c=t[2*n+1],x.x=T[4*s+2],x.y=T[4*s+3],R.x=u?-x.x:0,R.y=u?-x.y:0,f=T[4*n],g=T[4*n+1],n=r-(_=T[4*s])*i,h=o-(p=T[4*s+1])*i,l=a-f*i,m=c-g*i,r+=_*i,o+=p*i,a+=f*i,c+=g*i,this.appendVertexData(n,h,e,R.x,R.y),this.appendVertexData(l,m,e,R.x,R.y),this.appendVertexData(a,c,e,x.x,x.y),this.appendVertexData(n,h,e,R.x,R.y),this.appendVertexData(r,o,e,x.x,x.y),this.appendVertexData(a,c,e,x.x,x.y);y.length=T.length=0,this._dirty=!0}}},_drawSegments:function(t,e,i,n){if(!((e=null==e?this._lineWidth:e)<=0)){null==(i=i||this._drawColor).a&&(i.a=255),e*=.5;for(var s,r,o,a,c,h,l,u,d,_,p,f,g=t.length,m=T.length=0;m<g;m+=2)s=t[(m-2+g)%g],r=t[(m-1+g)%g],o=t[m],a=t[m+1],c=t[(m+2)%g],h=t[(m+3)%g],x.x=r-a,x.y=o-s,R.x=a-h,R.y=c-o,cc.pNormalizeIn(x),cc.pNormalizeIn(R),o=x.x*R.x+x.y*R.y+1,a=(x.x+R.x)/o,o=(x.y+R.y)/o,T.push(a,o,R.x,R.y);if(this._ensureCapacity(this._vertexCount+3*(3*(g/=2)-2))){for(n=n?g:g-1,m=0;m<n;m++)s=t[2*m],r=t[2*m+1],o=t[2*(c=(m+1)%g)],a=t[2*c+1],x.x=T[4*m+2],x.y=T[4*m+3],d=T[4*c],_=T[4*c+1],c=s-(l=T[4*m])*e,h=r-(u=T[4*m+1])*e,p=o-d*e,f=a-_*e,s+=l*e,r+=u*e,o+=d*e,a+=_*e,this.appendVertexData(c,h,i,-x.x,-x.y),this.appendVertexData(p,f,i,-x.x,-x.y),this.appendVertexData(o,a,i,x.x,x.y),this.appendVertexData(c,h,i,-x.x,-x.y),this.appendVertexData(s,r,i,x.x,x.y),this.appendVertexData(o,a,i,x.x,x.y);T.length=0,this._dirty=!0}}},clear:function(){this.release(),this._dirty=!0},_createRenderCmd:function(){return new cc.DrawNode.WebGLRenderCmd(this)}}))}),cc.DrawNode.CanvasRenderCmd=function(t){this._rootCtor(t),this._needDraw=!0,this._blendFunc=this._drawColor=this._buffer=null},cc.DrawNode.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype),cc.DrawNode.CanvasRenderCmd.prototype.constructor=cc.DrawNode.CanvasRenderCmd,cc.DrawNode.CanvasRenderCmd.prototype.getLocalBB=function(){return this._node._localBB},cc.extend(cc.DrawNode.CanvasRenderCmd.prototype,{rendering:function(t,e,i){if((t=t||cc._renderContext).getContext(),0!=(n=this._displayedOpacity/255)){t.setTransform(this._worldTransform,e,i),t.setGlobalAlpha(n),this._blendFunc&&this._blendFunc.src===cc.SRC_ALPHA&&this._blendFunc.dst===cc.ONE&&t.setCompositeOperation("lighter");for(var n,s=0,r=(n=this._buffer).length;s<r;s++){var o=n[s];switch(o.type){case cc.DrawNode.TYPE_DOT:this._drawDot(t,o,e,i);break;case cc.DrawNode.TYPE_SEGMENT:this._drawSegment(t,o,e,i);break;case cc.DrawNode.TYPE_POLY:this._drawPoly(t,o,e,i)}}}},_drawDot:function(t,e){var i=e.fillColor,n=e.verts[0],e=e.lineWidth,s=t.getContext();t.setFillStyle("rgba("+(0|i.r)+","+(0|i.g)+","+(0|i.b)+","+i.a/255+")"),s.beginPath(),s.arc(n.x,-n.y,e,0,2*Math.PI,!1),s.closePath(),s.fill()},_drawSegment:function(t,e,i){var n=e.lineColor,s=e.verts[0],r=e.verts[1],o=e.lineWidth,a=(e=e.lineCap,t.getContext());t.setStrokeStyle("rgba("+(0|n.r)+","+(0|n.g)+","+(0|n.b)+","+n.a/255+")"),a.lineWidth=o*i,a.beginPath(),a.lineCap=e,a.moveTo(s.x,-s.y),a.lineTo(r.x,-r.y),a.stroke()},_drawPoly:function(t,e,i){var n=e.verts,s=e.lineCap;if(null!=n){var r=e.fillColor,o=e.lineWidth,a=e.lineColor,c=e.isClosePolygon,h=e.isFill,l=(e=e.isStroke,t.getContext()),u=n[0];for(l.lineCap=s,r&&t.setFillStyle("rgba("+(0|r.r)+","+(0|r.g)+","+(0|r.b)+","+r.a/255+")"),o&&(l.lineWidth=o*i),a&&t.setStrokeStyle("rgba("+(0|a.r)+","+(0|a.g)+","+(0|a.b)+","+a.a/255+")"),l.beginPath(),l.moveTo(u.x,-u.y),t=1,i=n.length;t<i;t++)l.lineTo(n[t].x,-n[t].y);c&&l.closePath(),h&&l.fill(),e&&l.stroke()}}}),cc.DrawNode.WebGLRenderCmd=function(t){this._rootCtor(t),this._needDraw=!0,this._matrix=new cc.math.Matrix4,this._matrix.identity()},cc.DrawNode.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype),cc.DrawNode.WebGLRenderCmd.prototype.constructor=cc.DrawNode.WebGLRenderCmd,cc.DrawNode.WebGLRenderCmd.prototype.rendering=function(t){var e;0<(t=this._node)._vertexCount&&(e=this._worldTransform,this._matrix.mat[0]=e.a,this._matrix.mat[4]=e.c,this._matrix.mat[12]=e.tx,this._matrix.mat[1]=e.b,this._matrix.mat[5]=e.d,this._matrix.mat[13]=e.ty,cc.glBlendFunc(t._blendFunc.src,t._blendFunc.dst),this._glProgramState.apply(this._matrix),t._render())},cc.stencilBits=-1,cc.ClippingNode=cc.Node.extend({inverted:!1,_alphaThreshold:0,_stencil:null,_className:"ClippingNode",_originStencilProgram:null,ctor:function(t){t=t||null,cc.Node.prototype.ctor.call(this),(this._stencil=t)&&(this._originStencilProgram=t.getShaderProgram()),this.alphaThreshold=1,this.inverted=!1,this._renderCmd.initStencilBits()},onEnter:function(){cc.Node.prototype.onEnter.call(this),this._stencil&&this._stencil._performRecursive(cc.Node._stateCallbackType.onEnter)},onEnterTransitionDidFinish:function(){cc.Node.prototype.onEnterTransitionDidFinish.call(this),this._stencil&&this._stencil._performRecursive(cc.Node._stateCallbackType.onEnterTransitionDidFinish)},onExitTransitionDidStart:function(){this._stencil._performRecursive(cc.Node._stateCallbackType.onExitTransitionDidStart),cc.Node.prototype.onExitTransitionDidStart.call(this)},onExit:function(){this._stencil._performRecursive(cc.Node._stateCallbackType.onExit),cc.Node.prototype.onExit.call(this)},visit:function(t){this._renderCmd.clippingVisit(t&&t._renderCmd)},_visitChildren:function(){this._reorderChildDirty&&this.sortAllChildren();for(var t,e=this._children,i=0,n=e.length;i<n;i++)(t=e[i])&&t._visible&&t.visit(this);this._renderCmd._dirtyFlag=0},getAlphaThreshold:function(){return this._alphaThreshold},setAlphaThreshold:function(t){1===t&&t!==this._alphaThreshold&&this._renderCmd.resetProgramByStencil(),this._alphaThreshold=t},isInverted:function(){return this.inverted},setInverted:function(t){this.inverted=t},getStencil:function(){return this._stencil},setStencil:function(t){this._stencil!==t&&(t&&(this._originStencilProgram=t.getShaderProgram()),this._renderCmd.setStencil(t))},_createRenderCmd:function(){return new(cc._renderType===cc.game.RENDER_TYPE_CANVAS?cc.ClippingNode.CanvasRenderCmd:cc.ClippingNode.WebGLRenderCmd)(this)}}),_p=cc.ClippingNode.prototype,cc.defineGetterSetter(_p,"stencil",_p.getStencil,_p.setStencil),cc.defineGetterSetter(_p,"alphaThreshold",_p.getAlphaThreshold,_p.setAlphaThreshold),cc.ClippingNode.create=function(t){return new cc.ClippingNode(t)},!function(){cc.ClippingNode.CanvasRenderCmd=function(t){this._rootCtor(t),this._clipElemType=this._godhelpme=this._needDraw=!1,this._rendererSaveCmd=new cc.CustomRenderCmd(this,this._saveCmdCallback),this._rendererClipCmd=new cc.CustomRenderCmd(this,this._clipCmdCallback),this._rendererRestoreCmd=new cc.CustomRenderCmd(this,this._restoreCmdCallback)};var t=cc.ClippingNode.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);t.constructor=cc.ClippingNode.CanvasRenderCmd,t.resetProgramByStencil=function(){},t.initStencilBits=function(){},t.setStencil=function(t){if(null!=t)if((this._node._stencil=t)instanceof cc.DrawNode){if(t._buffer)for(var e=0;e<t._buffer.length;e++)t._buffer[e].isFill=!1,t._buffer[e].isStroke=!1;t._renderCmd.rendering=function(t,e,i){},t._renderCmd._canUseDirtyRegion=!0,this._rendererSaveCmd._canUseDirtyRegion=!0,this._rendererClipCmd._canUseDirtyRegion=!0,this._rendererRestoreCmd._canUseDirtyRegion=!0}else t._parent=this._node},t._saveCmdCallback=function(t,e,i){var n=t||cc._renderContext;t=n.getContext(),this._clipElemType?(e=cc.ClippingNode.CanvasRenderCmd._getSharedCache(),i=t.canvas,e.width=i.width,e.height=i.height,e.getContext("2d").drawImage(i,0,0)):(n.save(),n.setTransform(this._worldTransform,e,i),this._node.inverted&&(t.beginPath(),t.rect(0,0,t.canvas.width,-t.canvas.height),t.clip()))},t._setStencilCompositionOperation=function(t){if(t){var e=this._node;if(t._renderCmd&&t._renderCmd._blendFuncStr&&(t._renderCmd._blendFuncStr=e.inverted?"destination-out":"destination-in"),t._children)for(var e=0,i=(t=t._children).length;e<i;e++)this._setStencilCompositionOperation(t[e])}},t._clipCmdCallback=function(t){var e=this._node;if(t=(t||cc._renderContext).getContext(),this._clipElemType)this._setStencilCompositionOperation(e._stencil);else{if((e=this._node._stencil)instanceof cc.DrawNode){t.beginPath();var i=e._renderCmd._transform;for(t.transform(i.a,i.b,i.c,i.d,i.tx,-i.ty),i=0;i<e._buffer.length;i++){var n=e._buffer[i].verts,s=n[0];for(t.moveTo(s.x,-s.y),s=n.length-1;0<s;s--)t.lineTo(n[s].x,-n[s].y)}}t.clip()}},t._restoreCmdCallback=function(t){var e=cc.ClippingNode.CanvasRenderCmd._getSharedCache(),i=(t=t||cc._renderContext).getContext();this._clipElemType?(i.save(),i.setTransform(1,0,0,1,0,0),i.globalCompositeOperation="destination-over",i.drawImage(e,0,0),i.restore(),this._dirtyFlag=0):t.restore()},t.transform=function(t,e){this.originTransform(t,e);t=this._node;t._stencil&&t._stencil._renderCmd&&(t._stencil._renderCmd.transform(this,!0),t._stencil._dirtyFlag&=~cc.Node._dirtyFlags.transformDirty)},t._cangodhelpme=function(t){return!0!==t&&!1!==t||(cc.ClippingNode.CanvasRenderCmd.prototype._godhelpme=t),cc.ClippingNode.CanvasRenderCmd.prototype._godhelpme},t.clippingVisit=function(t){var e=this._node;if(t=t||this.getParentRenderCmd(),this.visit(t),this._clipElemType=!(!this._cangodhelpme()&&e._stencil instanceof cc.DrawNode),e._stencil&&e._stencil.visible){if(cc.renderer.pushRenderCommand(this._rendererSaveCmd),this._clipElemType?e._visitChildren():e._stencil.visit(e),cc.renderer.pushRenderCommand(this._rendererClipCmd),this._clipElemType)e._stencil.visit(e);else{this._cangodhelpme(!0);var i,n=(t=e._children).length;if(0<n)for(e.sortAllChildren(),i=0;i<n;i++)t[i].visit(e);this._cangodhelpme(!1)}cc.renderer.pushRenderCommand(this._rendererRestoreCmd),this._dirtyFlag=0}else this.inverted&&e._visitChildren()},cc.ClippingNode.CanvasRenderCmd._sharedCache=null,cc.ClippingNode.CanvasRenderCmd._getSharedCache=function(){return cc.ClippingNode.CanvasRenderCmd._sharedCache||(cc.ClippingNode.CanvasRenderCmd._sharedCache=document.createElement("canvas"))}}(),!function(){cc.ClippingNode.WebGLRenderCmd=function(t){this._rootCtor(t),this._needDraw=!1,this._beforeVisitCmd=new cc.CustomRenderCmd(this,this._onBeforeVisit),this._afterDrawStencilCmd=new cc.CustomRenderCmd(this,this._onAfterDrawStencil),this._afterVisitCmd=new cc.CustomRenderCmd(this,this._onAfterVisit),this._mask_layer_le=this._currentStencilEnabled=null};var t=cc.ClippingNode.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype);t.constructor=cc.ClippingNode.WebGLRenderCmd,cc.ClippingNode.WebGLRenderCmd._init_once=null,cc.ClippingNode.WebGLRenderCmd._visit_once=null,cc.ClippingNode.WebGLRenderCmd._layer=-1,t.initStencilBits=function(){cc.ClippingNode.WebGLRenderCmd._init_once=!0,cc.ClippingNode.WebGLRenderCmd._init_once&&(cc.stencilBits=cc._renderContext.getParameter(cc._renderContext.STENCIL_BITS),cc.stencilBits<=0&&cc.log("Stencil buffer is not enabled."),cc.ClippingNode.WebGLRenderCmd._init_once=!1)},t.transform=function(t,e){var i=this._node;this.originTransform(t,e),i._stencil&&(i._stencil._renderCmd.transform(this,!0),i._stencil._dirtyFlag&=~cc.Node._dirtyFlags.transformDirty)},t.clippingVisit=function(t){var e=this._node;if(t=t||this.getParentRenderCmd(),this.visit(t),cc.stencilBits<1)e._visitChildren();else if(e._stencil&&e._stencil.visible)if(cc.ClippingNode.WebGLRenderCmd._layer+1===cc.stencilBits)cc.ClippingNode.WebGLRenderCmd._visit_once=!0,cc.ClippingNode.WebGLRenderCmd._visit_once&&(cc.log("Nesting more than "+cc.stencilBits+"stencils is not supported. Everything will be drawn without stencil for this node and its children."),cc.ClippingNode.WebGLRenderCmd._visit_once=!1),e._visitChildren();else{if(cc.renderer.pushRenderCommand(this._beforeVisitCmd),e._stencil.visit(e),cc.renderer.pushRenderCommand(this._afterDrawStencilCmd),(t=e._children)&&0<t.length){var i=t.length;e.sortAllChildren();for(var n=0;n<i;n++)t[n].visit(e)}cc.renderer.pushRenderCommand(this._afterVisitCmd),this._dirtyFlag=0}else e.inverted&&e._visitChildren()},t.setStencil=function(t){var e=this._node;e._stencil&&(e._stencil._parent=null),e._stencil=t,e._stencil&&(e._stencil._parent=e)},t.resetProgramByStencil=function(){var t=this._node;t._stencil&&setProgram(t._stencil,t._originStencilProgram)},t._onBeforeVisit=function(t){var e=t||cc._renderContext,i=(t=this._node,cc.ClippingNode.WebGLRenderCmd._layer++,1<<cc.ClippingNode.WebGLRenderCmd._layer);this._mask_layer_le=i|i-1,this._currentStencilEnabled=e.isEnabled(e.STENCIL_TEST),e.clear(e.DEPTH_BUFFER_BIT),e.enable(e.STENCIL_TEST),e.depthMask(!1),e.stencilFunc(e.NEVER,i,i),e.stencilOp(e.REPLACE,e.KEEP,e.KEEP),e.stencilMask(i),e.clear(e.STENCIL_BUFFER_BIT),t.alphaThreshold<1&&(e=cc.shaderCache.programForKey(cc.SHADER_POSITION_TEXTURECOLORALPHATEST),cc.glUseProgram(e.getProgram()),e.setUniformLocationWith1f(cc.UNIFORM_ALPHA_TEST_VALUE_S,t.alphaThreshold),e.setUniformLocationWithMatrix4fv(cc.UNIFORM_MVMATRIX_S,cc.renderer.mat4Identity.mat),cc.setProgram(t._stencil,e))},t._onAfterDrawStencil=function(t){(t=t||cc._renderContext).depthMask(!0),t.stencilFunc(this._node.inverted?t.NOTEQUAL:t.EQUAL,this._mask_layer_le,this._mask_layer_le),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},t._onAfterVisit=function(t){var e,i;t=t||cc._renderContext,cc.ClippingNode.WebGLRenderCmd._layer--,this._currentStencilEnabled?(i=(e=1<<cc.ClippingNode.WebGLRenderCmd._layer)|e-1,t.stencilMask(e),t.stencilFunc(t.EQUAL,i,i)):t.disable(t.STENCIL_TEST)}}(),cc.GridBase=cc.Class.extend({_active:!1,_reuseGrid:0,_gridSize:null,_gridRect:null,_texture:null,_step:null,_grabber:null,_isTextureFlipped:!1,_glProgramState:null,_directorProjection:0,_dirty:!1,ctor:function(t,e,i,n){cc.sys._checkWebGLRenderMode(),this._active=!1,this._reuseGrid=0,this._gridSize=null,this._gridRect=new cc.rect,this._texture=null,this._step=cc.p(0,0),this._grabber=null,this._isTextureFlipped=!1,this._glProgramState=null,this._directorProjection=0,this._dirty=!1,void 0!==t&&this.initWithSize(t,e,i,n)},isActive:function(){return this._active},setActive:function(t){var e;(this._active=t)||(e=(t=cc.director).getProjection(),t.setProjection(e))},getReuseGrid:function(){return this._reuseGrid},setReuseGrid:function(t){this._reuseGrid=t},getGridSize:function(){return cc.size(this._gridSize.width,this._gridSize.height)},setGridSize:function(t){this._gridSize.width=parseInt(t.width),this._gridSize.height=parseInt(t.height)},setGridRect:function(t){this._gridRect=t},getGridRect:function(){return this._gridRect},getStep:function(){return cc.p(this._step.x,this._step.y)},setStep:function(t){this._step.x=t.x,this._step.y=t.y},isTextureFlipped:function(){return this._isTextureFlipped},setTextureFlipped:function(t){this._isTextureFlipped!==t&&(this._isTextureFlipped=t,this.calculateVertexPoints())},initWithSize:function(t,e,i,n){if(!e){var s=cc.director.getWinSizeInPixels(),r=cc.NextPOT(s.width),o=cc.NextPOT(s.height),a=new Uint8Array(r*o*4);if(!a)return cc.log("cocos2d: CCGrid: not enough memory."),!1;if((e=new cc.Texture2D).initWithData(a,cc.Texture2D.PIXEL_FORMAT_RGBA8888,r,o,s),!e)return cc.log("cocos2d: CCGrid: error creating texture"),!1}return this._active=!1,this._reuseGrid=0,this._gridSize=t,this._texture=e,this._isTextureFlipped=i||!1,void 0!==n&&!cc._rectEqualToZero(n)||(e=this._texture.getContentSize(),n=new cc.rect(0,0,e.width,e.height)),this._gridRect=n,this._step.x=this._gridRect.width/t.width,this._step.y=this._gridRect.height/t.height,this._grabber=new cc.Grabber,!!this._grabber&&(this._grabber.grab(this._texture),this._glProgramState=cc.GLProgramState.getOrCreateWithGLProgram(cc.shaderCache.programForKey(cc.SHADER_POSITION_TEXTURE)),this.calculateVertexPoints(),!0)},beforeDraw:function(){this._directorProjection=cc.director.getProjection();var t=cc.director.getWinSizeInPixels();gl.viewport(0,0,t.width,t.height),this._grabber.beforeRender(this._texture)},afterDraw:function(t){this._grabber.afterRender(this._texture),cc.director.setViewport(),cc.glBindTexture2D(this._texture),this.beforeBlit(),this.blit(t),this.afterBlit()},beforeBlit:function(){},afterBlit:function(){},blit:function(){cc.log("cc.GridBase.blit(): Shall be overridden in subclass.")},reuse:function(){cc.log("cc.GridBase.reuse(): Shall be overridden in subclass.")},calculateVertexPoints:function(){cc.log("cc.GridBase.calculateVertexPoints(): Shall be overridden in subclass.")},set2DProjection:function(){var t=cc.director.getWinSizeInPixels();cc._renderContext.viewport(0,0,t.width,t.height),cc.kmGLMatrixMode(cc.KM_GL_PROJECTION),cc.kmGLLoadIdentity(),t=cc.math.Matrix4.createOrthographicProjection(0,t.width,0,t.height,-1,1),cc.kmGLMultMatrix(t),cc.kmGLMatrixMode(cc.KM_GL_MODELVIEW),cc.kmGLLoadIdentity(),cc.setProjectionMatrixDirty()}}),cc.GridBase.create=function(t,e,i,n){return new cc.GridBase(t,e,i,n)},cc.Grid3D=cc.GridBase.extend({_texCoordinates:null,_vertices:null,_originalVertices:null,_indices:null,_texCoordinateBuffer:null,_verticesBuffer:null,_indicesBuffer:null,_needDepthTestForBlit:!1,_oldDepthTestValue:!1,_oldDepthWriteValue:!1,ctor:function(t,e,i,n){cc.GridBase.prototype.ctor.call(this),this._indicesBuffer=this._verticesBuffer=this._texCoordinateBuffer=this._indices=this._originalVertices=this._vertices=this._texCoordinates=null,this._matrix=new cc.math.Matrix4,this._matrix.identity(),void 0!==t&&this.initWithSize(t,e,i,n)},vertex:function(t){return this.getVertex(t)},getVertex:function(t){t.x===(0|t.x)&&t.y===(0|t.y)||cc.log("cc.Grid3D.vertex() : Numbers must be integers"),t=0|3*(t.x*(this._gridSize.height+1)+t.y);var e=this._vertices;return new cc.Vertex3F(e[t],e[t+1],e[t+2])},originalVertex:function(t){return this.getOriginalVertex(t)},getOriginalVertex:function(t){t.x===(0|t.x)&&t.y===(0|t.y)||cc.log("cc.Grid3D.originalVertex() : Numbers must be integers"),t=0|3*(t.x*(this._gridSize.height+1)+t.y);var e=this._originalVertices;return new cc.Vertex3F(e[t],e[t+1],e[t+2])},setVertex:function(t,e){t.x===(0|t.x)&&t.y===(0|t.y)||cc.log("cc.Grid3D.setVertex() : Numbers must be integers");var t=0|3*(t.x*(this._gridSize.height+1)+t.y),i=this._vertices;i[t]=e.x,i[1+t]=e.y,i[2+t]=e.z,this._dirty=!0},beforeBlit:function(){var t;this._needDepthTestForBlit&&(t=cc._renderContext,this._oldDepthTestValue=t.isEnabled(t.DEPTH_TEST),this._oldDepthWriteValue=t.getParameter(t.DEPTH_WRITEMASK),t.enable(t.DEPTH_TEST),t.depthMask(!0))},afterBlit:function(){var t;this._needDepthTestForBlit&&(t=cc._renderContext,this._oldDepthTestValue?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST),t.depthMask(this._oldDepthWriteValue))},blit:function(t){var e=this._gridSize.width*this._gridSize.height,i=(t=t._renderCmd._worldTransform,this._matrix.mat[0]=t.a,this._matrix.mat[4]=t.c,this._matrix.mat[12]=t.tx,this._matrix.mat[1]=t.b,this._matrix.mat[5]=t.d,this._matrix.mat[13]=t.ty,this._glProgramState.apply(this._matrix),t=cc._renderContext,this._dirty);t.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),t.enableVertexAttribArray(cc.VERTEX_ATTRIB_TEX_COORDS),t.bindBuffer(t.ARRAY_BUFFER,this._verticesBuffer),i&&t.bufferData(t.ARRAY_BUFFER,this._vertices,t.DYNAMIC_DRAW),t.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,3,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,this._texCoordinateBuffer),i&&t.bufferData(t.ARRAY_BUFFER,this._texCoordinates,t.DYNAMIC_DRAW),t.vertexAttribPointer(cc.VERTEX_ATTRIB_TEX_COORDS,2,t.FLOAT,!1,0,0),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this._indicesBuffer),i&&t.bufferData(t.ELEMENT_ARRAY_BUFFER,this._indices,t.STATIC_DRAW),t.drawElements(t.TRIANGLES,6*e,t.UNSIGNED_SHORT,0),i&&(this._dirty=!1),cc.incrementGLDraws(1)},reuse:function(){if(0<this._reuseGrid){for(var t=this._originalVertices,e=this._vertices,i=0,n=this._vertices.length;i<n;i++)t[i]=e[i];--this._reuseGrid}},calculateVertexPoints:function(){var t=cc._renderContext,e=this._texture.pixelsWidth,i=this._texture.pixelsHeight,n=this._texture.getContentSizeInPixels().height,s=this._gridSize,r=(s.width+1)*(s.height+1);this._vertices=new Float32Array(3*r),this._texCoordinates=new Float32Array(2*r),this._indices=new Uint16Array(s.width*s.height*6),this._verticesBuffer&&t.deleteBuffer(this._verticesBuffer),this._verticesBuffer=t.createBuffer(),this._texCoordinateBuffer&&t.deleteBuffer(this._texCoordinateBuffer),this._texCoordinateBuffer=t.createBuffer(),this._indicesBuffer&&t.deleteBuffer(this._indicesBuffer),this._indicesBuffer=t.createBuffer();for(var o,a=this._indices,c=this._texCoordinates,h=this._isTextureFlipped,l=this._vertices,r=0;r<s.width;++r)for(o=0;o<s.height;++o){var u,d=o*s.width+r,_=(u=r*this._step.x+this._gridRect.x)+this._step.x,p=o*this._step.y+this._gridRect.y,f=p+this._step.y,g=r*(s.height+1)+o,m=(r+1)*(s.height+1)+o,y=(r+1)*(s.height+1)+(o+1),T=r*(s.height+1)+(o+1),d=(a[6*d]=g,a[6*d+1]=m,a[6*d+2]=T,[3*g,3*(a[6*d+3]=m),3*(a[6*d+4]=y),3*(a[6*d+5]=T)]),S=[{x:u,y:p,z:0},{x:_,y:p,z:0},{x:_,y:f,z:0},{x:u,y:f,z:0}],g=[2*g,2*m,2*y,2*T],_=[cc.p(u,p),cc.p(_,p),cc.p(_,f),cc.p(u,f)];for(u=0;u<4;++u)l[d[u]]=S[u].x,l[d[u]+1]=S[u].y,l[d[u]+2]=S[u].z,c[g[u]]=_[u].x/e,c[g[u]+1]=h?(n-_[u].y)/i:_[u].y/i}this._originalVertices=new Float32Array(this._vertices),t.bindBuffer(t.ARRAY_BUFFER,this._verticesBuffer),t.bufferData(t.ARRAY_BUFFER,this._vertices,t.DYNAMIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this._texCoordinateBuffer),t.bufferData(t.ARRAY_BUFFER,this._texCoordinates,t.DYNAMIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this._indicesBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this._indices,t.STATIC_DRAW),this._dirty=!0},setNeedDepthTestForBlit:function(t){this._needDepthTestForBlit=t},getNeedDepthTestForBlit:function(){return this._needDepthTestForBlit}}),cc.Grid3D.create=function(t,e,i){return new cc.Grid3D(t,e,i)},cc.TiledGrid3D=cc.GridBase.extend({_texCoordinates:null,_vertices:null,_originalVertices:null,_indices:null,_texCoordinateBuffer:null,_verticesBuffer:null,_indicesBuffer:null,ctor:function(t,e,i,n){cc.GridBase.prototype.ctor.call(this),this._indicesBuffer=this._verticesBuffer=this._texCoordinateBuffer=this._indices=this._originalVertices=this._vertices=this._texCoordinates=null,this._matrix=new cc.math.Matrix4,this._matrix.identity(),void 0!==t&&this.initWithSize(t,e,i,n)},tile:function(t){return this.getTile(t)},getTile:function(t){t.x===(0|t.x)&&t.y===(0|t.y)||cc.log("cc.TiledGrid3D.tile() : Numbers must be integers"),t=12*(this._gridSize.height*t.x+t.y);var e=this._vertices;return new cc.Quad3(new cc.Vertex3F(e[t],e[t+1],e[t+2]),new cc.Vertex3F(e[t+3],e[t+4],e[t+5]),new cc.Vertex3F(e[t+6],e[t+7],e[t+8]),new cc.Vertex3F(e[t+9],e[t+10],e[t+11]))},getOriginalTile:function(t){t.x===(0|t.x)&&t.y===(0|t.y)||cc.log("cc.TiledGrid3D.originalTile() : Numbers must be integers"),t=12*(this._gridSize.height*t.x+t.y);var e=this._originalVertices;return new cc.Quad3(new cc.Vertex3F(e[t],e[t+1],e[t+2]),new cc.Vertex3F(e[t+3],e[t+4],e[t+5]),new cc.Vertex3F(e[t+6],e[t+7],e[t+8]),new cc.Vertex3F(e[t+9],e[t+10],e[t+11]))},originalTile:function(t){return this.getOriginalTile(t)},setTile:function(t,e){t.x===(0|t.x)&&t.y===(0|t.y)||cc.log("cc.TiledGrid3D.setTile() : Numbers must be integers");var t=12*(this._gridSize.height*t.x+t.y),i=this._vertices;i[t]=e.bl.x,i[1+t]=e.bl.y,i[2+t]=e.bl.z,i[3+t]=e.br.x,i[4+t]=e.br.y,i[5+t]=e.br.z,i[6+t]=e.tl.x,i[7+t]=e.tl.y,i[8+t]=e.tl.z,i[9+t]=e.tr.x,i[10+t]=e.tr.y,i[11+t]=e.tr.z,this._dirty=!0},blit:function(t){var e=this._gridSize.width*this._gridSize.height,i=(t=t._renderCmd._worldTransform,this._matrix.mat[0]=t.a,this._matrix.mat[4]=t.c,this._matrix.mat[12]=t.tx,this._matrix.mat[1]=t.b,this._matrix.mat[5]=t.d,this._matrix.mat[13]=t.ty,this._glProgramState.apply(this._matrix),t=cc._renderContext,this._dirty);t.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),t.enableVertexAttribArray(cc.VERTEX_ATTRIB_TEX_COORDS),t.bindBuffer(t.ARRAY_BUFFER,this._verticesBuffer),i&&t.bufferData(t.ARRAY_BUFFER,this._vertices,t.DYNAMIC_DRAW),t.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,3,t.FLOAT,!1,0,this._vertices),t.bindBuffer(t.ARRAY_BUFFER,this._texCoordinateBuffer),i&&t.bufferData(t.ARRAY_BUFFER,this._texCoordinates,t.DYNAMIC_DRAW),t.vertexAttribPointer(cc.VERTEX_ATTRIB_TEX_COORDS,2,t.FLOAT,!1,0,this._texCoordinates),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this._indicesBuffer),i&&t.bufferData(t.ELEMENT_ARRAY_BUFFER,this._indices,t.STATIC_DRAW),t.drawElements(t.TRIANGLES,6*e,t.UNSIGNED_SHORT,0),i&&(this._dirty=!1),cc.incrementGLDraws(1)},reuse:function(){if(0<this._reuseGrid){for(var t=this._vertices,e=this._originalVertices,i=0;i<t.length;i++)e[i]=t[i];--this._reuseGrid}},calculateVertexPoints:function(){var t=this._texture.pixelsWidth,e=this._texture.pixelsHeight,i=this._texture.getContentSizeInPixels().height,n=this._gridSize,s=n.width*n.height,r=(this._vertices=new Float32Array(12*s),this._texCoordinates=new Float32Array(8*s),this._indices=new Uint16Array(6*s),cc._renderContext);this._verticesBuffer&&r.deleteBuffer(this._verticesBuffer),this._verticesBuffer=r.createBuffer(),this._texCoordinateBuffer&&r.deleteBuffer(this._texCoordinateBuffer),this._texCoordinateBuffer=r.createBuffer(),this._indicesBuffer&&r.deleteBuffer(this._indicesBuffer),this._indicesBuffer=r.createBuffer();for(var o,a=0,c=this._step,h=this._vertices,l=this._texCoordinates,u=this._isTextureFlipped,d=0;d<n.width;d++)for(o=0;o<n.height;o++){var _=d*c.x,p=_+c.x,f=o*c.y,g=f+c.y,m=(h[12*a]=_,h[12*a+1]=f,h[12*a+2]=0,h[12*a+3]=p,h[12*a+4]=f,h[12*a+5]=0,h[12*a+6]=_,h[12*a+7]=g,h[12*a+8]=0,h[12*a+9]=p,h[12*a+10]=g,h[12*a+11]=0,f),y=g;u&&(m=i-f,y=i-g),l[8*a]=_/t,l[8*a+1]=m/e,l[8*a+2]=p/t,l[8*a+3]=m/e,l[8*a+4]=_/t,l[8*a+5]=y/e,l[8*a+6]=p/t,l[8*a+7]=y/e,a++}for(t=this._indices,d=0;d<s;d++)t[6*d+0]=4*d+0,t[6*d+1]=4*d+1,t[6*d+2]=4*d+2,t[6*d+3]=4*d+1,t[6*d+4]=4*d+2,t[6*d+5]=4*d+3;this._originalVertices=new Float32Array(this._vertices),r.bindBuffer(r.ARRAY_BUFFER,this._verticesBuffer),r.bufferData(r.ARRAY_BUFFER,this._vertices,r.DYNAMIC_DRAW),r.bindBuffer(r.ARRAY_BUFFER,this._texCoordinateBuffer),r.bufferData(r.ARRAY_BUFFER,this._texCoordinates,r.DYNAMIC_DRAW),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,this._indicesBuffer),r.bufferData(r.ELEMENT_ARRAY_BUFFER,this._indices,r.DYNAMIC_DRAW),this._dirty=!0}}),cc.TiledGrid3D.create=function(t,e,i){return new cc.TiledGrid3D(t,e,i)},cc.Grabber=cc.Class.extend({_FBO:null,_oldFBO:null,_oldClearColor:null,_gl:null,ctor:function(){cc.sys._checkWebGLRenderMode(),this._gl=cc._renderContext,this._oldClearColor=[0,0,0,0],this._oldFBO=null,this._FBO=this._gl.createFramebuffer()},grab:function(t){var e=this._gl;this._oldFBO=e.getParameter(e.FRAMEBUFFER_BINDING),e.bindFramebuffer(e.FRAMEBUFFER,this._FBO),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t._webTextureObj,0),e.checkFramebufferStatus(e.FRAMEBUFFER)!==e.FRAMEBUFFER_COMPLETE&&cc.log("Frame Grabber: could not attach texture to frmaebuffer"),e.bindFramebuffer(e.FRAMEBUFFER,this._oldFBO)},beforeRender:function(t){t=this._gl,this._oldFBO=t.getParameter(t.FRAMEBUFFER_BINDING),t.bindFramebuffer(t.FRAMEBUFFER,this._FBO),this._oldClearColor=t.getParameter(t.COLOR_CLEAR_VALUE),t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT)},afterRender:function(t){(t=this._gl).bindFramebuffer(t.FRAMEBUFFER,this._oldFBO),t.colorMask(!0,!0,!0,!0)},destroy:function(){this._gl.deleteFramebuffer(this._FBO)}}),cc.ACTION_TAG_INVALID=-1,cc.Action=cc.Class.extend({originalTarget:null,target:null,tag:cc.ACTION_TAG_INVALID,ctor:function(){this.target=this.originalTarget=null,this.tag=cc.ACTION_TAG_INVALID},copy:function(){return cc.log("copy is deprecated. Please use clone instead."),this.clone()},clone:function(){var t=new cc.Action;return t.originalTarget=null,t.target=null,t.tag=this.tag,t},isDone:function(){return!0},startWithTarget:function(t){this.target=this.originalTarget=t},stop:function(){this.target=null},step:function(t){cc.log("[Action step]. override me")},update:function(t){cc.log("[Action update]. override me")},getTarget:function(){return this.target},setTarget:function(t){this.target=t},getOriginalTarget:function(){return this.originalTarget},setOriginalTarget:function(t){this.originalTarget=t},getTag:function(){return this.tag},setTag:function(t){this.tag=t},retain:function(){},release:function(){}}),cc.action=function(){return new cc.Action},cc.Action.create=cc.action,cc.FiniteTimeAction=cc.Action.extend({_duration:0,ctor:function(){cc.Action.prototype.ctor.call(this),this._duration=0},getDuration:function(){return this._duration*(this._timesForRepeat||1)},setDuration:function(t){this._duration=t},reverse:function(){return cc.log("cocos2d: FiniteTimeAction#reverse: Implement me"),null},clone:function(){return new cc.FiniteTimeAction}}),cc.Speed=cc.Action.extend({_speed:0,_innerAction:null,ctor:function(t,e){cc.Action.prototype.ctor.call(this),this._speed=0,this._innerAction=null,t&&this.initWithAction(t,e)},getSpeed:function(){return this._speed},setSpeed:function(t){this._speed=t},initWithAction:function(t,e){if(t)return this._innerAction=t,this._speed=e,!0;throw Error("cc.Speed.initWithAction(): action must be non nil")},clone:function(){var t=new cc.Speed;return t.initWithAction(this._innerAction.clone(),this._speed),t},startWithTarget:function(t){cc.Action.prototype.startWithTarget.call(this,t),this._innerAction.startWithTarget(t)},stop:function(){this._innerAction.stop(),cc.Action.prototype.stop.call(this)},step:function(t){this._innerAction.step(t*this._speed)},isDone:function(){return this._innerAction.isDone()},reverse:function(){return new cc.Speed(this._innerAction.reverse(),this._speed)},setInnerAction:function(t){this._innerAction!==t&&(this._innerAction=t)},getInnerAction:function(){return this._innerAction}}),cc.speed=function(t,e){return new cc.Speed(t,e)},cc.Speed.create=cc.speed,cc.Follow=cc.Action.extend({_followedNode:null,_boundarySet:!1,_boundaryFullyCovered:!1,_halfScreenSize:null,_fullScreenSize:null,_worldRect:null,leftBoundary:0,rightBoundary:0,topBoundary:0,bottomBoundary:0,ctor:function(t,e){cc.Action.prototype.ctor.call(this),this._followedNode=null,this._boundaryFullyCovered=this._boundarySet=!1,this._fullScreenSize=this._halfScreenSize=null,this.bottomBoundary=this.topBoundary=this.rightBoundary=this.leftBoundary=0,this._worldRect=cc.rect(0,0,0,0),t&&(e?this.initWithTarget(t,e):this.initWithTarget(t))},clone:function(){var t=new cc.Follow,e=this._worldRect,e=new cc.Rect(e.x,e.y,e.width,e.height);return t.initWithTarget(this._followedNode,e),t},isBoundarySet:function(){return this._boundarySet},setBoudarySet:function(t){this._boundarySet=t},initWithTarget:function(t,e){if(!t)throw Error("cc.Follow.initWithAction(): followedNode must be non nil");e=e||cc.rect(0,0,0,0),this._followedNode=t,this._worldRect=e,this._boundarySet=!cc._rectEqualToZero(e),this._boundaryFullyCovered=!1;t=cc.director.getWinSize();return this._fullScreenSize=cc.p(t.width,t.height),this._halfScreenSize=cc.pMult(this._fullScreenSize,.5),this._boundarySet&&(this.leftBoundary=-(e.x+e.width-this._fullScreenSize.x),this.rightBoundary=-e.x,this.topBoundary=-e.y,this.bottomBoundary=-(e.y+e.height-this._fullScreenSize.y),this.rightBoundary<this.leftBoundary&&(this.rightBoundary=this.leftBoundary=(this.leftBoundary+this.rightBoundary)/2),this.topBoundary<this.bottomBoundary&&(this.topBoundary=this.bottomBoundary=(this.topBoundary+this.bottomBoundary)/2),this.topBoundary===this.bottomBoundary)&&this.leftBoundary===this.rightBoundary&&(this._boundaryFullyCovered=!0),!0},step:function(t){t=this._followedNode.x;var e=this._followedNode.y;t=this._halfScreenSize.x-t,e=this._halfScreenSize.y-e,this.target._renderCmd._dirtyFlag=0,this._boundarySet?this._boundaryFullyCovered||this.target.setPosition(cc.clampf(t,this.leftBoundary,this.rightBoundary),cc.clampf(e,this.bottomBoundary,this.topBoundary)):this.target.setPosition(t,e)},isDone:function(){return!this._followedNode.running},stop:function(){this.target=null,cc.Action.prototype.stop.call(this)}}),cc.follow=function(t,e){return new cc.Follow(t,e)},cc.Follow.create=cc.follow,cc.ActionInterval=cc.FiniteTimeAction.extend({_elapsed:0,_firstTick:!1,_easeList:null,_timesForRepeat:1,_repeatForever:!1,_repeatMethod:!1,_speed:1,_speedMethod:!1,ctor:function(t){this._timesForRepeat=this._speed=1,this._repeatForever=!1,this.MAX_VALUE=2,this._speedMethod=this._repeatMethod=!1,cc.FiniteTimeAction.prototype.ctor.call(this),void 0!==t&&this.initWithDuration(t)},getElapsed:function(){return this._elapsed},initWithDuration:function(t){return this._duration=0===t?cc.FLT_EPSILON:t,this._elapsed=0,this._firstTick=!0},isDone:function(){return this._elapsed>=this._duration},_cloneDecoration:function(t){t._repeatForever=this._repeatForever,t._speed=this._speed,t._timesForRepeat=this._timesForRepeat,t._easeList=this._easeList,t._speedMethod=this._speedMethod,t._repeatMethod=this._repeatMethod},_reverseEaseList:function(t){if(this._easeList){t._easeList=[];for(var e=0;e<this._easeList.length;e++)t._easeList.push(this._easeList[e].reverse())}},clone:function(){var t=new cc.ActionInterval(this._duration);return this._cloneDecoration(t),t},easing:function(t){this._easeList?this._easeList.length=0:this._easeList=[];for(var e=0;e<arguments.length;e++)this._easeList.push(arguments[e]);return this},_computeEaseTime:function(t){var e=this._easeList;if(e&&0!==e.length)for(var i=0,n=e.length;i<n;i++)t=e[i].easing(t);return t},step:function(t){this._firstTick?(this._firstTick=!1,this._elapsed=0):this._elapsed+=t,t=this._elapsed/(1.192092896e-7<this._duration?this._duration:1.192092896e-7),this.update(0<(t=t<1?t:1)?t:0),this._repeatMethod&&1<this._timesForRepeat&&this.isDone()&&(this._repeatForever||this._timesForRepeat--,this.startWithTarget(this.target),this.step(this._elapsed-this._duration))},startWithTarget:function(t){cc.Action.prototype.startWithTarget.call(this,t),this._elapsed=0,this._firstTick=!0},reverse:function(){return cc.log("cc.IntervalAction: reverse not implemented."),null},setAmplitudeRate:function(t){cc.log("cc.ActionInterval.setAmplitudeRate(): it should be overridden in subclass.")},getAmplitudeRate:function(){return cc.log("cc.ActionInterval.getAmplitudeRate(): it should be overridden in subclass."),0},speed:function(t){return t<=0?cc.log("The speed parameter error"):(this._speedMethod=!0,this._speed*=t),this},getSpeed:function(){return this._speed},setSpeed:function(t){return this._speed=t,this},repeat:function(t){return t=Math.round(t),isNaN(t)||t<1?cc.log("The repeat parameter error"):(this._repeatMethod=!0,this._timesForRepeat*=t),this},repeatForever:function(){return this._repeatMethod=!0,this._timesForRepeat=this.MAX_VALUE,this._repeatForever=!0,this}}),cc.actionInterval=function(t){return new cc.ActionInterval(t)},cc.ActionInterval.create=cc.actionInterval,cc.Sequence=cc.ActionInterval.extend({_actions:null,_split:null,_last:0,ctor:function(t){cc.ActionInterval.prototype.ctor.call(this),this._actions=[];var e=t instanceof Array?t:arguments,i=e.length-1;if(0<=i&&null==e[i]&&cc.log("parameters should not be ending with null in Javascript"),0<=i){for(var n=e[0],s=1;s<i;s++)e[s]&&(n=cc.Sequence._actionOneTwo(n,e[s]));this.initWithTwoActions(n,e[i])}},initWithTwoActions:function(t,e){if(t&&e)return this.initWithDuration(t._duration+e._duration),this._actions[0]=t,this._actions[1]=e,!0;throw Error("cc.Sequence.initWithTwoActions(): arguments must all be non nil")},clone:function(){var t=new cc.Sequence;return this._cloneDecoration(t),t.initWithTwoActions(this._actions[0].clone(),this._actions[1].clone()),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._split=this._actions[0]._duration/this._duration,this._last=-1},stop:function(){-1!==this._last&&this._actions[this._last].stop(),cc.Action.prototype.stop.call(this)},update:function(t){var e=0,i=this._split,n=this._actions,s=this._last;(t=this._computeEaseTime(t))<i?(t=0!==i?t/i:1,0===e&&1===s&&(n[1].update(0),n[1].stop())):(t=(e=1)===i?1:(t-i)/(1-i),-1===s&&(n[0].startWithTarget(this.target),n[0].update(1),n[0].stop()),s||(n[0].update(1),n[0].stop())),n=n[e],s===e&&n.isDone()||(s!==e&&n.startWithTarget(this.target),t*=n._timesForRepeat,n.update(1<t?t%1:t),this._last=e)},reverse:function(){var t=cc.Sequence._actionOneTwo(this._actions[1].reverse(),this._actions[0].reverse());return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.sequence=function(t){var e,i,n,s,r=t instanceof Array?t:arguments;for(0<r.length&&null==r[r.length-1]&&cc.log("parameters should not be ending with null in Javascript");r&&0<r.length;)for(s=(i=Array.prototype.shift.call(r))._timesForRepeat||1,i._repeatMethod=!1,i._timesForRepeat=1,n=0,e||(e=i,n=1);n<s;n++)e=cc.Sequence._actionOneTwo(e,i);return e},cc.Sequence.create=cc.sequence,cc.Sequence._actionOneTwo=function(t,e){var i=new cc.Sequence;return i.initWithTwoActions(t,e),i},cc.Repeat=cc.ActionInterval.extend({_times:0,_total:0,_nextDt:0,_actionInstant:!1,_innerAction:null,ctor:function(t,e){cc.ActionInterval.prototype.ctor.call(this),void 0!==e&&this.initWithAction(t,e)},initWithAction:function(t,e){return!!this.initWithDuration(t._duration*e)&&(this._times=e,(this._innerAction=t)instanceof cc.ActionInstant&&(this._actionInstant=!0,--this._times),!(this._total=0))},clone:function(){var t=new cc.Repeat;return this._cloneDecoration(t),t.initWithAction(this._innerAction.clone(),this._times),t},startWithTarget:function(t){this._total=0,this._nextDt=this._innerAction._duration/this._duration,cc.ActionInterval.prototype.startWithTarget.call(this,t),this._innerAction.startWithTarget(t)},stop:function(){this._innerAction.stop(),cc.Action.prototype.stop.call(this)},update:function(t){t=this._computeEaseTime(t);var e=this._innerAction,i=this._duration,n=this._times,s=this._nextDt;if(s<=t){for(;s<t&&this._total<n;)e.update(1),this._total++,e.stop(),e.startWithTarget(this.target),this._nextDt=s+=e._duration/i;1<=t&&this._total<n&&this._total++,this._actionInstant||(this._total===n?(e.update(1),e.stop()):e.update(t-(s-e._duration/i)))}else e.update(t*n%1)},isDone:function(){return this._total===this._times},reverse:function(){var t=new cc.Repeat(this._innerAction.reverse(),this._times);return this._cloneDecoration(t),this._reverseEaseList(t),t},setInnerAction:function(t){this._innerAction!==t&&(this._innerAction=t)},getInnerAction:function(){return this._innerAction}}),cc.repeat=function(t,e){return new cc.Repeat(t,e)},cc.Repeat.create=cc.repeat,cc.RepeatForever=cc.ActionInterval.extend({_innerAction:null,ctor:function(t){cc.ActionInterval.prototype.ctor.call(this),this._innerAction=null,t&&this.initWithAction(t)},initWithAction:function(t){if(t)return this._innerAction=t,!0;throw Error("cc.RepeatForever.initWithAction(): action must be non null")},clone:function(){var t=new cc.RepeatForever;return this._cloneDecoration(t),t.initWithAction(this._innerAction.clone()),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._innerAction.startWithTarget(t)},step:function(t){var e=this._innerAction;e.step(t),e.isDone()&&(e.startWithTarget(this.target),e.step(e.getElapsed()-e._duration))},isDone:function(){return!1},reverse:function(){var t=new cc.RepeatForever(this._innerAction.reverse());return this._cloneDecoration(t),this._reverseEaseList(t),t},setInnerAction:function(t){this._innerAction!==t&&(this._innerAction=t)},getInnerAction:function(){return this._innerAction}}),cc.repeatForever=function(t){return new cc.RepeatForever(t)},cc.RepeatForever.create=cc.repeatForever,cc.Spawn=cc.ActionInterval.extend({_one:null,_two:null,ctor:function(t){var e,i;if(cc.ActionInterval.prototype.ctor.call(this),this._two=this._one=null,t instanceof Array)e=t;else for(e=Array(arguments.length),s=0;s<arguments.length;++s)e[s]=arguments[s];if(0<=(i=e.length-1)&&null==e[i]&&cc.log("parameters should not be ending with null in Javascript"),0<=i){for(var n=e[0],s=1;s<i;s++)e[s]&&(n=cc.Spawn._actionOneTwo(n,e[s]));this.initWithTwoActions(n,e[i])}},initWithTwoActions:function(t,e){var i,n,s;if(t&&e)return i=!1,n=t._duration,s=e._duration,this.initWithDuration(Math.max(n,s))&&(this._one=t,this._two=e,s<n?this._two=cc.Sequence._actionOneTwo(e,cc.delayTime(n-s)):n<s&&(this._one=cc.Sequence._actionOneTwo(t,cc.delayTime(s-n))),i=!0),i;throw Error("cc.Spawn.initWithTwoActions(): arguments must all be non null")},clone:function(){var t=new cc.Spawn;return this._cloneDecoration(t),t.initWithTwoActions(this._one.clone(),this._two.clone()),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._one.startWithTarget(t),this._two.startWithTarget(t)},stop:function(){this._one.stop(),this._two.stop(),cc.Action.prototype.stop.call(this)},update:function(t){t=this._computeEaseTime(t),this._one&&this._one.update(t),this._two&&this._two.update(t)},reverse:function(){var t=cc.Spawn._actionOneTwo(this._one.reverse(),this._two.reverse());return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.spawn=function(t){var e=t instanceof Array?t:arguments;0<e.length&&null==e[e.length-1]&&cc.log("parameters should not be ending with null in Javascript");for(var i=e[0],n=1;n<e.length;n++)null!=e[n]&&(i=cc.Spawn._actionOneTwo(i,e[n]));return i},cc.Spawn.create=cc.spawn,cc.Spawn._actionOneTwo=function(t,e){var i=new cc.Spawn;return i.initWithTwoActions(t,e),i},cc.RotateTo=cc.ActionInterval.extend({_dstAngleX:0,_startAngleX:0,_diffAngleX:0,_dstAngleY:0,_startAngleY:0,_diffAngleY:0,ctor:function(t,e,i){cc.ActionInterval.prototype.ctor.call(this),void 0!==e&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._dstAngleX=e||0,this._dstAngleY=void 0!==i?i:this._dstAngleX,!0)},clone:function(){var t=new cc.RotateTo;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._dstAngleX,this._dstAngleY),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t);var e=t.rotationX%360,i=this._dstAngleX-e;180<i&&(i-=360),i<-180&&(i+=360),this._startAngleX=e,this._diffAngleX=i,this._startAngleY=t.rotationY%360,180<(t=this._dstAngleY-this._startAngleY)&&(t-=360),t<-180&&(t+=360),this._diffAngleY=t},reverse:function(){cc.log("cc.RotateTo.reverse(): it should be overridden in subclass.")},update:function(t){t=this._computeEaseTime(t),this.target&&(this.target.rotationX=this._startAngleX+this._diffAngleX*t,this.target.rotationY=this._startAngleY+this._diffAngleY*t)}}),cc.rotateTo=function(t,e,i){return new cc.RotateTo(t,e,i)},cc.RotateTo.create=cc.rotateTo,cc.RotateBy=cc.ActionInterval.extend({_angleX:0,_startAngleX:0,_angleY:0,_startAngleY:0,ctor:function(t,e,i){cc.ActionInterval.prototype.ctor.call(this),void 0!==e&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._angleX=e||0,this._angleY=i||this._angleX,!0)},clone:function(){var t=new cc.RotateBy;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._angleX,this._angleY),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._startAngleX=t.rotationX,this._startAngleY=t.rotationY},update:function(t){t=this._computeEaseTime(t),this.target&&(this.target.rotationX=this._startAngleX+this._angleX*t,this.target.rotationY=this._startAngleY+this._angleY*t)},reverse:function(){var t=new cc.RotateBy(this._duration,-this._angleX,-this._angleY);return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.rotateBy=function(t,e,i){return new cc.RotateBy(t,e,i)},cc.RotateBy.create=cc.rotateBy,cc.MoveBy=cc.ActionInterval.extend({_positionDelta:null,_startPosition:null,_previousPosition:null,ctor:function(t,e,i){cc.ActionInterval.prototype.ctor.call(this),this._positionDelta=cc.p(0,0),this._startPosition=cc.p(0,0),this._previousPosition=cc.p(0,0),void 0!==e&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(void 0!==e.x&&(i=e.y,e=e.x),this._positionDelta.x=e,this._positionDelta.y=i,!0)},clone:function(){var t=new cc.MoveBy;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._positionDelta),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t);var e=t.getPositionX();t=t.getPositionY(),this._previousPosition.x=e,this._previousPosition.y=t,this._startPosition.x=e,this._startPosition.y=t},update:function(t){var e,i,n,s,r;t=this._computeEaseTime(t),this.target&&(e=this._positionDelta.x*t,t*=this._positionDelta.y,i=this._startPosition,cc.ENABLE_STACKABLE_ACTIONS?(n=this.target.getPositionX(),s=this.target.getPositionY(),r=this._previousPosition,i.x=i.x+n-r.x,i.y=i.y+s-r.y,e+=i.x,t+=i.y,r.x=e,r.y=t,this.target.setPosition(e,t)):this.target.setPosition(i.x+e,i.y+t))},reverse:function(){var t=new cc.MoveBy(this._duration,cc.p(-this._positionDelta.x,-this._positionDelta.y));return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.moveBy=function(t,e,i){return new cc.MoveBy(t,e,i)},cc.MoveBy.create=cc.moveBy,cc.MoveTo=cc.MoveBy.extend({_endPosition:null,ctor:function(t,e,i){cc.MoveBy.prototype.ctor.call(this),this._endPosition=cc.p(0,0),void 0!==e&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){return!!cc.MoveBy.prototype.initWithDuration.call(this,t,e,i)&&(void 0!==e.x&&(i=e.y,e=e.x),this._endPosition.x=e,this._endPosition.y=i,!0)},clone:function(){var t=new cc.MoveTo;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._endPosition),t},startWithTarget:function(t){cc.MoveBy.prototype.startWithTarget.call(this,t),this._positionDelta.x=this._endPosition.x-t.getPositionX(),this._positionDelta.y=this._endPosition.y-t.getPositionY()}}),cc.moveTo=function(t,e,i){return new cc.MoveTo(t,e,i)},cc.MoveTo.create=cc.moveTo,cc.SkewTo=cc.ActionInterval.extend({_skewX:0,_skewY:0,_startSkewX:0,_startSkewY:0,_endSkewX:0,_endSkewY:0,_deltaX:0,_deltaY:0,ctor:function(t,e,i){cc.ActionInterval.prototype.ctor.call(this),void 0!==i&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){var n=!1;return cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._endSkewX=e,this._endSkewY=i,n=!0),n},clone:function(){var t=new cc.SkewTo;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._endSkewX,this._endSkewY),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._startSkewX=t.skewX%180,this._deltaX=this._endSkewX-this._startSkewX,180<this._deltaX&&(this._deltaX-=360),this._deltaX<-180&&(this._deltaX+=360),this._startSkewY=t.skewY%360,this._deltaY=this._endSkewY-this._startSkewY,180<this._deltaY&&(this._deltaY-=360),this._deltaY<-180&&(this._deltaY+=360)},update:function(t){t=this._computeEaseTime(t),this.target.skewX=this._startSkewX+this._deltaX*t,this.target.skewY=this._startSkewY+this._deltaY*t}}),cc.skewTo=function(t,e,i){return new cc.SkewTo(t,e,i)},cc.SkewTo.create=cc.skewTo,cc.SkewBy=cc.SkewTo.extend({ctor:function(t,e,i){cc.SkewTo.prototype.ctor.call(this),void 0!==i&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){var n=!1;return cc.SkewTo.prototype.initWithDuration.call(this,t,e,i)&&(this._skewX=e,this._skewY=i,n=!0),n},clone:function(){var t=new cc.SkewBy;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._skewX,this._skewY),t},startWithTarget:function(t){cc.SkewTo.prototype.startWithTarget.call(this,t),this._deltaX=this._skewX,this._deltaY=this._skewY,this._endSkewX=this._startSkewX+this._deltaX,this._endSkewY=this._startSkewY+this._deltaY},reverse:function(){var t=new cc.SkewBy(this._duration,-this._skewX,-this._skewY);return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.skewBy=function(t,e,i){return new cc.SkewBy(t,e,i)},cc.SkewBy.create=cc.skewBy,cc.JumpBy=cc.ActionInterval.extend({_startPosition:null,_delta:null,_height:0,_jumps:0,_previousPosition:null,ctor:function(t,e,i,n,s){cc.ActionInterval.prototype.ctor.call(this),this._startPosition=cc.p(0,0),this._previousPosition=cc.p(0,0),this._delta=cc.p(0,0),void 0!==n&&this.initWithDuration(t,e,i,n,s)},initWithDuration:function(t,e,i,n,s){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(void 0===s&&(s=n,n=i,i=e.y,e=e.x),this._delta.x=e,this._delta.y=i,this._height=n,this._jumps=s,!0)},clone:function(){var t=new cc.JumpBy;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._delta,this._height,this._jumps),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t);var e=t.getPositionX();t=t.getPositionY(),this._previousPosition.x=e,this._previousPosition.y=t,this._startPosition.x=e,this._startPosition.y=t},update:function(t){var e,i,n,s,r;t=this._computeEaseTime(t),this.target&&(e=t*this._jumps%1,e=(e=4*this._height*e*(1-e))+this._delta.y*t,t*=this._delta.x,i=this._startPosition,cc.ENABLE_STACKABLE_ACTIONS?(n=this.target.getPositionX(),s=this.target.getPositionY(),r=this._previousPosition,i.x=i.x+n-r.x,i.y=i.y+s-r.y,t+=i.x,e+=i.y,r.x=t,r.y=e,this.target.setPosition(t,e)):this.target.setPosition(i.x+t,i.y+e))},reverse:function(){var t=new cc.JumpBy(this._duration,cc.p(-this._delta.x,-this._delta.y),this._height,this._jumps);return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.jumpBy=function(t,e,i,n,s){return new cc.JumpBy(t,e,i,n,s)},cc.JumpBy.create=cc.jumpBy,cc.JumpTo=cc.JumpBy.extend({_endPosition:null,ctor:function(t,e,i,n,s){cc.JumpBy.prototype.ctor.call(this),this._endPosition=cc.p(0,0),void 0!==n&&this.initWithDuration(t,e,i,n,s)},initWithDuration:function(t,e,i,n,s){return!!cc.JumpBy.prototype.initWithDuration.call(this,t,e,i,n,s)&&(void 0===s&&(i=e.y,e=e.x),this._endPosition.x=e,this._endPosition.y=i,!0)},startWithTarget:function(t){cc.JumpBy.prototype.startWithTarget.call(this,t),this._delta.x=this._endPosition.x-this._startPosition.x,this._delta.y=this._endPosition.y-this._startPosition.y},clone:function(){var t=new cc.JumpTo;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._endPosition,this._height,this._jumps),t}}),cc.jumpTo=function(t,e,i,n,s){return new cc.JumpTo(t,e,i,n,s)},cc.JumpTo.create=cc.jumpTo,cc.bezierAt=function(t,e,i,n,s){return Math.pow(1-s,3)*t+3*s*Math.pow(1-s,2)*e+3*Math.pow(s,2)*(1-s)*i+Math.pow(s,3)*n},cc.BezierBy=cc.ActionInterval.extend({_config:null,_startPosition:null,_previousPosition:null,ctor:function(t,e){cc.ActionInterval.prototype.ctor.call(this),this._config=[],this._startPosition=cc.p(0,0),this._previousPosition=cc.p(0,0),e&&this.initWithDuration(t,e)},initWithDuration:function(t,e){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._config=e,!0)},clone:function(){var t=new cc.BezierBy;this._cloneDecoration(t);for(var e=[],i=0;i<this._config.length;i++){var n=this._config[i];e.push(cc.p(n.x,n.y))}return t.initWithDuration(this._duration,e),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t);var e=t.getPositionX();t=t.getPositionY(),this._previousPosition.x=e,this._previousPosition.y=t,this._startPosition.x=e,this._startPosition.y=t},update:function(t){var e,i,n,s,r;t=this._computeEaseTime(t),this.target&&(e=(i=this._config)[0].y,n=i[1].y,s=i[2].y,i=cc.bezierAt(0,i[0].x,i[1].x,i[2].x,t),t=cc.bezierAt(0,e,n,s,t),e=this._startPosition,cc.ENABLE_STACKABLE_ACTIONS?(n=this.target.getPositionX(),s=this.target.getPositionY(),r=this._previousPosition,e.x=e.x+n-r.x,e.y=e.y+s-r.y,i+=e.x,t+=e.y,r.x=i,r.y=t,this.target.setPosition(i,t)):this.target.setPosition(e.x+i,e.y+t))},reverse:function(){var t=this._config,t=[cc.pAdd(t[1],cc.pNeg(t[2])),cc.pAdd(t[0],cc.pNeg(t[2])),cc.pNeg(t[2])],t=new cc.BezierBy(this._duration,t);return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.bezierBy=function(t,e){return new cc.BezierBy(t,e)},cc.BezierBy.create=cc.bezierBy,cc.BezierTo=cc.BezierBy.extend({_toConfig:null,ctor:function(t,e){cc.BezierBy.prototype.ctor.call(this),this._toConfig=[],e&&this.initWithDuration(t,e)},initWithDuration:function(t,e){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._toConfig=e,!0)},clone:function(){var t=new cc.BezierTo;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._toConfig),t},startWithTarget:function(t){cc.BezierBy.prototype.startWithTarget.call(this,t),t=this._startPosition;var e=this._toConfig,i=this._config;i[0]=cc.pSub(e[0],t),i[1]=cc.pSub(e[1],t),i[2]=cc.pSub(e[2],t)}}),cc.bezierTo=function(t,e){return new cc.BezierTo(t,e)},cc.BezierTo.create=cc.bezierTo,cc.ScaleTo=cc.ActionInterval.extend({_scaleX:1,_scaleY:1,_startScaleX:1,_startScaleY:1,_endScaleX:0,_endScaleY:0,_deltaX:0,_deltaY:0,ctor:function(t,e,i){cc.ActionInterval.prototype.ctor.call(this),void 0!==e&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._endScaleX=e,this._endScaleY=null!=i?i:e,!0)},clone:function(){var t=new cc.ScaleTo;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._endScaleX,this._endScaleY),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._startScaleX=t.scaleX,this._startScaleY=t.scaleY,this._deltaX=this._endScaleX-this._startScaleX,this._deltaY=this._endScaleY-this._startScaleY},update:function(t){t=this._computeEaseTime(t),this.target&&(this.target.scaleX=this._startScaleX+this._deltaX*t,this.target.scaleY=this._startScaleY+this._deltaY*t)}}),cc.scaleTo=function(t,e,i){return new cc.ScaleTo(t,e,i)},cc.ScaleTo.create=cc.scaleTo,cc.ScaleBy=cc.ScaleTo.extend({startWithTarget:function(t){cc.ScaleTo.prototype.startWithTarget.call(this,t),this._deltaX=this._startScaleX*this._endScaleX-this._startScaleX,this._deltaY=this._startScaleY*this._endScaleY-this._startScaleY},reverse:function(){var t=new cc.ScaleBy(this._duration,1/this._endScaleX,1/this._endScaleY);return this._cloneDecoration(t),this._reverseEaseList(t),t},clone:function(){var t=new cc.ScaleBy;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._endScaleX,this._endScaleY),t}}),cc.scaleBy=function(t,e,i){return new cc.ScaleBy(t,e,i)},cc.ScaleBy.create=cc.scaleBy,cc.Blink=cc.ActionInterval.extend({_times:0,_originalState:!1,ctor:function(t,e){cc.ActionInterval.prototype.ctor.call(this),void 0!==e&&this.initWithDuration(t,e)},initWithDuration:function(t,e){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._times=e,!0)},clone:function(){var t=new cc.Blink;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._times),t},update:function(t){var e;t=this._computeEaseTime(t),this.target&&!this.isDone()&&(e=1/this._times,this.target.visible=e/2<t%e)},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._originalState=t.visible},stop:function(){this.target.visible=this._originalState,cc.ActionInterval.prototype.stop.call(this)},reverse:function(){var t=new cc.Blink(this._duration,this._times);return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.blink=function(t,e){return new cc.Blink(t,e)},cc.Blink.create=cc.blink,cc.FadeTo=cc.ActionInterval.extend({_toOpacity:0,_fromOpacity:0,ctor:function(t,e){cc.ActionInterval.prototype.ctor.call(this),void 0!==e&&this.initWithDuration(t,e)},initWithDuration:function(t,e){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._toOpacity=e,!0)},clone:function(){var t=new cc.FadeTo;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._toOpacity),t},update:function(t){t=this._computeEaseTime(t);var e=void 0!==this._fromOpacity?this._fromOpacity:255;this.target.opacity=e+(this._toOpacity-e)*t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._fromOpacity=t.opacity}}),cc.fadeTo=function(t,e){return new cc.FadeTo(t,e)},cc.FadeTo.create=cc.fadeTo,cc.FadeIn=cc.FadeTo.extend({_reverseAction:null,ctor:function(t){cc.FadeTo.prototype.ctor.call(this),this.initWithDuration(t=null==t?0:t,255)},reverse:function(){var t=new cc.FadeOut;return t.initWithDuration(this._duration,0),this._cloneDecoration(t),this._reverseEaseList(t),t},clone:function(){var t=new cc.FadeIn;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._toOpacity),t},startWithTarget:function(t){this._reverseAction&&(this._toOpacity=this._reverseAction._fromOpacity),cc.FadeTo.prototype.startWithTarget.call(this,t)}}),cc.fadeIn=function(t){return new cc.FadeIn(t)},cc.FadeIn.create=cc.fadeIn,cc.FadeOut=cc.FadeTo.extend({ctor:function(t){cc.FadeTo.prototype.ctor.call(this),this.initWithDuration(t=null==t?0:t,0)},reverse:function(){var t=new cc.FadeIn;return t._reverseAction=this,t.initWithDuration(this._duration,255),this._cloneDecoration(t),this._reverseEaseList(t),t},clone:function(){var t=new cc.FadeOut;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._toOpacity),t}}),cc.fadeOut=function(t){return new cc.FadeOut(t)},cc.FadeOut.create=cc.fadeOut,cc.TintTo=cc.ActionInterval.extend({_to:null,_from:null,ctor:function(t,e,i,n){cc.ActionInterval.prototype.ctor.call(this),this._to=cc.color(0,0,0),this._from=cc.color(0,0,0),void 0!==n&&this.initWithDuration(t,e,i,n)},initWithDuration:function(t,e,i,n){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._to=cc.color(e,i,n),!0)},clone:function(){var t=new cc.TintTo,e=(this._cloneDecoration(t),this._to);return t.initWithDuration(this._duration,e.r,e.g,e.b),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._from=this.target.color},update:function(t){t=this._computeEaseTime(t);var e=this._from,i=this._to;e&&this.target.setColor(cc.color(e.r+(i.r-e.r)*t,e.g+(i.g-e.g)*t,e.b+(i.b-e.b)*t))}}),cc.tintTo=function(t,e,i,n){return new cc.TintTo(t,e,i,n)},cc.TintTo.create=cc.tintTo,cc.TintBy=cc.ActionInterval.extend({_deltaR:0,_deltaG:0,_deltaB:0,_fromR:0,_fromG:0,_fromB:0,ctor:function(t,e,i,n){cc.ActionInterval.prototype.ctor.call(this),void 0!==n&&this.initWithDuration(t,e,i,n)},initWithDuration:function(t,e,i,n){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._deltaR=e,this._deltaG=i,this._deltaB=n,!0)},clone:function(){var t=new cc.TintBy;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._deltaR,this._deltaG,this._deltaB),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),t=t.color,this._fromR=t.r,this._fromG=t.g,this._fromB=t.b},update:function(t){t=this._computeEaseTime(t),this.target.color=cc.color(this._fromR+this._deltaR*t,this._fromG+this._deltaG*t,this._fromB+this._deltaB*t)},reverse:function(){var t=new cc.TintBy(this._duration,-this._deltaR,-this._deltaG,-this._deltaB);return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.tintBy=function(t,e,i,n){return new cc.TintBy(t,e,i,n)},cc.TintBy.create=cc.tintBy,cc.DelayTime=cc.ActionInterval.extend({update:function(t){},reverse:function(){var t=new cc.DelayTime(this._duration);return this._cloneDecoration(t),this._reverseEaseList(t),t},clone:function(){var t=new cc.DelayTime;return this._cloneDecoration(t),t.initWithDuration(this._duration),t}}),cc.delayTime=function(t){return new cc.DelayTime(t)},cc.DelayTime.create=cc.delayTime,cc.ReverseTime=cc.ActionInterval.extend({_other:null,ctor:function(t){cc.ActionInterval.prototype.ctor.call(this),this._other=null,t&&this.initWithAction(t)},initWithAction:function(t){if(!t)throw Error("cc.ReverseTime.initWithAction(): action must be non null");if(t===this._other)throw Error("cc.ReverseTime.initWithAction(): the action was already passed in.");return!!cc.ActionInterval.prototype.initWithDuration.call(this,t._duration)&&(this._other=t,!0)},clone:function(){var t=new cc.ReverseTime;return this._cloneDecoration(t),t.initWithAction(this._other.clone()),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._other.startWithTarget(t)},update:function(t){t=this._computeEaseTime(t),this._other&&this._other.update(1-t)},reverse:function(){return this._other.clone()},stop:function(){this._other.stop(),cc.Action.prototype.stop.call(this)}}),cc.reverseTime=function(t){return new cc.ReverseTime(t)},cc.ReverseTime.create=cc.reverseTime,cc.Animate=cc.ActionInterval.extend({_animation:null,_nextFrame:0,_origFrame:null,_executedLoops:0,_splitTimes:null,_currFrameIndex:0,ctor:function(t){cc.ActionInterval.prototype.ctor.call(this),this._splitTimes=[],t&&this.initWithAnimation(t)},getAnimation:function(){return this._animation},setAnimation:function(t){this._animation=t},getCurrentFrameIndex:function(){return this._currFrameIndex},initWithAnimation:function(t){if(!t)throw Error("cc.Animate.initWithAnimation(): animation must be non-NULL");var e=t.getDuration();if(this.initWithDuration(e*t.getLoops())){this._nextFrame=0,this.setAnimation(t),this._origFrame=null,this._executedLoops=0;var i=this._splitTimes,n=i.length=0,s=e/t.getTotalDelayUnits();t=t.getFrames(),cc.arrayVerifyType(t,cc.AnimationFrame);for(var r=0;r<t.length;r++){var o=n*s/e,n=n+t[r].getDelayUnits();i.push(o)}return!0}return!1},clone:function(){var t=new cc.Animate;return this._cloneDecoration(t),t.initWithAnimation(this._animation.clone()),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._animation.getRestoreOriginalFrame()&&(this._origFrame=t.getSpriteFrame()),this._executedLoops=this._nextFrame=0},update:function(t){(t=this._computeEaseTime(t))<1&&((0|(t*=this._animation.getLoops()))>this._executedLoops&&(this._nextFrame=0,this._executedLoops++),t%=1);for(var e=this._animation.getFrames(),i=e.length,n=this._splitTimes,s=this._nextFrame;s<i&&n[s]<=t;s++)_currFrameIndex=s,this.target.setSpriteFrame(e[_currFrameIndex].getSpriteFrame()),this._nextFrame=s+1},reverse:function(){var t=this._animation,e=t.getFrames(),i=[];if(cc.arrayVerifyType(e,cc.AnimationFrame),0<e.length)for(var n=e.length-1;0<=n;n--){var s=e[n];if(!s)break;i.push(s.clone())}return(e=new cc.Animation(i,t.getDelayPerUnit(),t.getLoops())).setRestoreOriginalFrame(t.getRestoreOriginalFrame()),t=new cc.Animate(e),this._cloneDecoration(t),this._reverseEaseList(t),t},stop:function(){this._animation.getRestoreOriginalFrame()&&this.target&&this.target.setSpriteFrame(this._origFrame),cc.Action.prototype.stop.call(this)}}),cc.animate=function(t){return new cc.Animate(t)},cc.Animate.create=cc.animate,cc.TargetedAction=cc.ActionInterval.extend({_action:null,_forcedTarget:null,ctor:function(t,e){cc.ActionInterval.prototype.ctor.call(this),e&&this.initWithTarget(t,e)},initWithTarget:function(t,e){return!!this.initWithDuration(e._duration)&&(this._forcedTarget=t,this._action=e,!0)},clone:function(){var t=new cc.TargetedAction;return this._cloneDecoration(t),t.initWithTarget(this._forcedTarget,this._action.clone()),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._action.startWithTarget(this._forcedTarget)},stop:function(){this._action.stop()},update:function(t){t=this._computeEaseTime(t),this._action.update(t)},getForcedTarget:function(){return this._forcedTarget},setForcedTarget:function(t){this._forcedTarget!==t&&(this._forcedTarget=t)}}),cc.targetedAction=function(t,e){return new cc.TargetedAction(t,e)},cc.TargetedAction.create=cc.targetedAction,cc.ActionInstant=cc.FiniteTimeAction.extend({isDone:function(){return!0},step:function(t){this.update(1)},update:function(t){},reverse:function(){return this.clone()},clone:function(){return new cc.ActionInstant}}),cc.Show=cc.ActionInstant.extend({update:function(t){this.target.visible=!0},reverse:function(){return new cc.Hide},clone:function(){return new cc.Show}}),cc.show=function(){return new cc.Show},cc.Show.create=cc.show,cc.Hide=cc.ActionInstant.extend({update:function(t){this.target.visible=!1},reverse:function(){return new cc.Show},clone:function(){return new cc.Hide}}),cc.hide=function(){return new cc.Hide},cc.Hide.create=cc.hide,cc.ToggleVisibility=cc.ActionInstant.extend({update:function(t){this.target.visible=!this.target.visible},reverse:function(){return new cc.ToggleVisibility},clone:function(){return new cc.ToggleVisibility}}),cc.toggleVisibility=function(){return new cc.ToggleVisibility},cc.ToggleVisibility.create=cc.toggleVisibility,cc.RemoveSelf=cc.ActionInstant.extend({_isNeedCleanUp:!0,ctor:function(t){cc.FiniteTimeAction.prototype.ctor.call(this),void 0!==t&&this.init(t)},update:function(t){this.target.removeFromParent(this._isNeedCleanUp)},init:function(t){return this._isNeedCleanUp=t,!0},reverse:function(){return new cc.RemoveSelf(this._isNeedCleanUp)},clone:function(){return new cc.RemoveSelf(this._isNeedCleanUp)}}),cc.removeSelf=function(t){return new cc.RemoveSelf(t)},cc.RemoveSelf.create=cc.removeSelf,cc.FlipX=cc.ActionInstant.extend({_flippedX:!1,ctor:function(t){cc.FiniteTimeAction.prototype.ctor.call(this),this._flippedX=!1,void 0!==t&&this.initWithFlipX(t)},initWithFlipX:function(t){return this._flippedX=t,!0},update:function(t){this.target.flippedX=this._flippedX},reverse:function(){return new cc.FlipX(!this._flippedX)},clone:function(){var t=new cc.FlipX;return t.initWithFlipX(this._flippedX),t}}),cc.flipX=function(t){return new cc.FlipX(t)},cc.FlipX.create=cc.flipX,cc.FlipY=cc.ActionInstant.extend({_flippedY:!1,ctor:function(t){cc.FiniteTimeAction.prototype.ctor.call(this),this._flippedY=!1,void 0!==t&&this.initWithFlipY(t)},initWithFlipY:function(t){return this._flippedY=t,!0},update:function(t){this.target.flippedY=this._flippedY},reverse:function(){return new cc.FlipY(!this._flippedY)},clone:function(){var t=new cc.FlipY;return t.initWithFlipY(this._flippedY),t}}),cc.flipY=function(t){return new cc.FlipY(t)},cc.FlipY.create=cc.flipY,cc.Place=cc.ActionInstant.extend({_x:0,_y:0,ctor:function(t,e){cc.FiniteTimeAction.prototype.ctor.call(this),void(this._y=this._x=0)!==t&&(void 0!==t.x&&(e=t.y,t=t.x),this.initWithPosition(t,e))},initWithPosition:function(t,e){return this._x=t,this._y=e,!0},update:function(t){this.target.setPosition(this._x,this._y)},clone:function(){var t=new cc.Place;return t.initWithPosition(this._x,this._y),t}}),cc.place=function(t,e){return new cc.Place(t,e)},cc.Place.create=cc.place,cc.CallFunc=cc.ActionInstant.extend({_selectorTarget:null,_function:null,_data:null,ctor:function(t,e,i){cc.FiniteTimeAction.prototype.ctor.call(this),this.initWithFunction(t,e,i)},initWithFunction:function(t,e,i){return t&&(this._function=t),e&&(this._selectorTarget=e),void 0!==i&&(this._data=i),!0},execute:function(){this._function&&this._function.call(this._selectorTarget,this.target,this._data)},update:function(t){this.execute()},getTargetCallback:function(){return this._selectorTarget},setTargetCallback:function(t){t!==this._selectorTarget&&(this._selectorTarget&&(this._selectorTarget=null),this._selectorTarget=t)},clone:function(){var t=new cc.CallFunc;return t.initWithFunction(this._function,this._selectorTarget,this._data),t}}),cc.callFunc=function(t,e,i){return new cc.CallFunc(t,e,i)},cc.CallFunc.create=cc.callFunc,cc.ActionEase=cc.ActionInterval.extend({_inner:null,ctor:function(t){cc.ActionInterval.prototype.ctor.call(this),t&&this.initWithAction(t)},initWithAction:function(t){if(t)return!!this.initWithDuration(t.getDuration())&&(this._inner=t,!0);throw Error("cc.ActionEase.initWithAction(): action must be non nil")},clone:function(){var t=new cc.ActionEase;return t.initWithAction(this._inner.clone()),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._inner.startWithTarget(this.target)},stop:function(){this._inner.stop(),cc.ActionInterval.prototype.stop.call(this)},update:function(t){this._inner.update(t)},reverse:function(){return new cc.ActionEase(this._inner.reverse())},getInnerAction:function(){return this._inner}}),cc.actionEase=function(t){return new cc.ActionEase(t)},cc.ActionEase.create=cc.actionEase,cc.EaseRateAction=cc.ActionEase.extend({_rate:0,ctor:function(t,e){cc.ActionEase.prototype.ctor.call(this),void 0!==e&&this.initWithAction(t,e)},setRate:function(t){this._rate=t},getRate:function(){return this._rate},initWithAction:function(t,e){return!!cc.ActionEase.prototype.initWithAction.call(this,t)&&(this._rate=e,!0)},clone:function(){var t=new cc.EaseRateAction;return t.initWithAction(this._inner.clone(),this._rate),t},reverse:function(){return new cc.EaseRateAction(this._inner.reverse(),1/this._rate)}}),cc.easeRateAction=function(t,e){return new cc.EaseRateAction(t,e)},cc.EaseRateAction.create=cc.easeRateAction,cc.EaseIn=cc.EaseRateAction.extend({update:function(t){this._inner.update(Math.pow(t,this._rate))},reverse:function(){return new cc.EaseIn(this._inner.reverse(),1/this._rate)},clone:function(){var t=new cc.EaseIn;return t.initWithAction(this._inner.clone(),this._rate),t}}),cc.EaseIn.create=function(t,e){return new cc.EaseIn(t,e)},cc.easeIn=function(t){return{_rate:t,easing:function(t){return Math.pow(t,this._rate)},reverse:function(){return cc.easeIn(1/this._rate)}}},cc.EaseOut=cc.EaseRateAction.extend({update:function(t){this._inner.update(Math.pow(t,1/this._rate))},reverse:function(){return new cc.EaseOut(this._inner.reverse(),1/this._rate)},clone:function(){var t=new cc.EaseOut;return t.initWithAction(this._inner.clone(),this._rate),t}}),cc.EaseOut.create=function(t,e){return new cc.EaseOut(t,e)},cc.easeOut=function(t){return{_rate:t,easing:function(t){return Math.pow(t,1/this._rate)},reverse:function(){return cc.easeOut(1/this._rate)}}},cc.EaseInOut=cc.EaseRateAction.extend({update:function(t){(t*=2)<1?this._inner.update(.5*Math.pow(t,this._rate)):this._inner.update(1-.5*Math.pow(2-t,this._rate))},clone:function(){var t=new cc.EaseInOut;return t.initWithAction(this._inner.clone(),this._rate),t},reverse:function(){return new cc.EaseInOut(this._inner.reverse(),this._rate)}}),cc.EaseInOut.create=function(t,e){return new cc.EaseInOut(t,e)},cc.easeInOut=function(t){return{_rate:t,easing:function(t){return(t*=2)<1?.5*Math.pow(t,this._rate):1-.5*Math.pow(2-t,this._rate)},reverse:function(){return cc.easeInOut(this._rate)}}},cc.EaseExponentialIn=cc.ActionEase.extend({update:function(t){this._inner.update(0===t?0:Math.pow(2,10*(t-1)))},reverse:function(){return new cc.EaseExponentialOut(this._inner.reverse())},clone:function(){var t=new cc.EaseExponentialIn;return t.initWithAction(this._inner.clone()),t}}),cc.EaseExponentialIn.create=function(t){return new cc.EaseExponentialIn(t)},cc._easeExponentialInObj={easing:function(t){return 0===t?0:Math.pow(2,10*(t-1))},reverse:function(){return cc._easeExponentialOutObj}},cc.easeExponentialIn=function(){return cc._easeExponentialInObj},cc.EaseExponentialOut=cc.ActionEase.extend({update:function(t){this._inner.update(1===t?1:1-Math.pow(2,-10*t))},reverse:function(){return new cc.EaseExponentialIn(this._inner.reverse())},clone:function(){var t=new cc.EaseExponentialOut;return t.initWithAction(this._inner.clone()),t}}),cc.EaseExponentialOut.create=function(t){return new cc.EaseExponentialOut(t)},cc._easeExponentialOutObj={easing:function(t){return 1===t?1:1-Math.pow(2,-10*t)},reverse:function(){return cc._easeExponentialInObj}},cc.easeExponentialOut=function(){return cc._easeExponentialOutObj},cc.EaseExponentialInOut=cc.ActionEase.extend({update:function(t){1!==t&&0!==t&&(t=(t*=2)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*(t-1)))),this._inner.update(t)},reverse:function(){return new cc.EaseExponentialInOut(this._inner.reverse())},clone:function(){var t=new cc.EaseExponentialInOut;return t.initWithAction(this._inner.clone()),t}}),cc.EaseExponentialInOut.create=function(t){return new cc.EaseExponentialInOut(t)},cc._easeExponentialInOutObj={easing:function(t){return 1!==t&&0!==t?(t*=2)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*(t-1))):t},reverse:function(){return cc._easeExponentialInOutObj}},cc.easeExponentialInOut=function(){return cc._easeExponentialInOutObj},cc.EaseSineIn=cc.ActionEase.extend({update:function(t){t=0===t||1===t?t:-1*Math.cos(t*Math.PI/2)+1,this._inner.update(t)},reverse:function(){return new cc.EaseSineOut(this._inner.reverse())},clone:function(){var t=new cc.EaseSineIn;return t.initWithAction(this._inner.clone()),t}}),cc.EaseSineIn.create=function(t){return new cc.EaseSineIn(t)},cc._easeSineInObj={easing:function(t){return 0===t||1===t?t:-1*Math.cos(t*Math.PI/2)+1},reverse:function(){return cc._easeSineOutObj}},cc.easeSineIn=function(){return cc._easeSineInObj},cc.EaseSineOut=cc.ActionEase.extend({update:function(t){t=0===t||1===t?t:Math.sin(t*Math.PI/2),this._inner.update(t)},reverse:function(){return new cc.EaseSineIn(this._inner.reverse())},clone:function(){var t=new cc.EaseSineOut;return t.initWithAction(this._inner.clone()),t}}),cc.EaseSineOut.create=function(t){return new cc.EaseSineOut(t)},cc._easeSineOutObj={easing:function(t){return 0===t||1===t?t:Math.sin(t*Math.PI/2)},reverse:function(){return cc._easeSineInObj}},cc.easeSineOut=function(){return cc._easeSineOutObj},cc.EaseSineInOut=cc.ActionEase.extend({update:function(t){t=0===t||1===t?t:-.5*(Math.cos(Math.PI*t)-1),this._inner.update(t)},clone:function(){var t=new cc.EaseSineInOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseSineInOut(this._inner.reverse())}}),cc.EaseSineInOut.create=function(t){return new cc.EaseSineInOut(t)},cc._easeSineInOutObj={easing:function(t){return 0===t||1===t?t:-.5*(Math.cos(Math.PI*t)-1)},reverse:function(){return cc._easeSineInOutObj}},cc.easeSineInOut=function(){return cc._easeSineInOutObj},cc.EaseElastic=cc.ActionEase.extend({_period:.3,ctor:function(t,e){cc.ActionEase.prototype.ctor.call(this),t&&this.initWithAction(t,e)},getPeriod:function(){return this._period},setPeriod:function(t){this._period=t},initWithAction:function(t,e){return cc.ActionEase.prototype.initWithAction.call(this,t),this._period=null==e?.3:e,!0},reverse:function(){return cc.log("cc.EaseElastic.reverse(): it should be overridden in subclass."),null},clone:function(){var t=new cc.EaseElastic;return t.initWithAction(this._inner.clone(),this._period),t}}),cc.EaseElastic.create=function(t,e){return new cc.EaseElastic(t,e)},cc.EaseElasticIn=cc.EaseElastic.extend({update:function(t){var e=0,e=0===t||1===t?t:(e=this._period/4,--t,-Math.pow(2,10*t)*Math.sin((t-e)*Math.PI*2/this._period));this._inner.update(e)},reverse:function(){return new cc.EaseElasticOut(this._inner.reverse(),this._period)},clone:function(){var t=new cc.EaseElasticIn;return t.initWithAction(this._inner.clone(),this._period),t}}),cc.EaseElasticIn.create=function(t,e){return new cc.EaseElasticIn(t,e)},cc._easeElasticInObj={easing:function(t){return 0===t||1===t?t:(--t,-Math.pow(2,10*t)*Math.sin((t-.075)*Math.PI*2/.3))},reverse:function(){return cc._easeElasticOutObj}},cc.easeElasticIn=function(t){return t&&.3!==t?{_period:t,easing:function(t){return 0===t||1===t?t:(--t,-Math.pow(2,10*t)*Math.sin((t-this._period/4)*Math.PI*2/this._period))},reverse:function(){return cc.easeElasticOut(this._period)}}:cc._easeElasticInObj},cc.EaseElasticOut=cc.EaseElastic.extend({update:function(t){var e=0,e=0===t||1===t?t:(e=this._period/4,Math.pow(2,-10*t)*Math.sin((t-e)*Math.PI*2/this._period)+1);this._inner.update(e)},reverse:function(){return new cc.EaseElasticIn(this._inner.reverse(),this._period)},clone:function(){var t=new cc.EaseElasticOut;return t.initWithAction(this._inner.clone(),this._period),t}}),cc.EaseElasticOut.create=function(t,e){return new cc.EaseElasticOut(t,e)},cc._easeElasticOutObj={easing:function(t){return 0===t||1===t?t:Math.pow(2,-10*t)*Math.sin((t-.075)*Math.PI*2/.3)+1},reverse:function(){return cc._easeElasticInObj}},cc.easeElasticOut=function(t){return t&&.3!==t?{_period:t,easing:function(t){return 0===t||1===t?t:Math.pow(2,-10*t)*Math.sin((t-this._period/4)*Math.PI*2/this._period)+1},reverse:function(){return cc.easeElasticIn(this._period)}}:cc._easeElasticOutObj},cc.EaseElasticInOut=cc.EaseElastic.extend({update:function(t){var e,i=0,i=this._period;i=0===t||1===t?t:(e=(i=i||(this._period=.3*1.5))/4,(t=2*t-1)<0?-.5*Math.pow(2,10*t)*Math.sin((t-e)*Math.PI*2/i):Math.pow(2,-10*t)*Math.sin((t-e)*Math.PI*2/i)*.5+1),this._inner.update(i)},reverse:function(){return new cc.EaseElasticInOut(this._inner.reverse(),this._period)},clone:function(){var t=new cc.EaseElasticInOut;return t.initWithAction(this._inner.clone(),this._period),t}}),cc.EaseElasticInOut.create=function(t,e){return new cc.EaseElasticInOut(t,e)},cc.easeElasticInOut=function(t){return{_period:t||.3,easing:function(t){var e,i=0,i=this._period;return i=0===t||1===t?t:(e=(i=i||(this._period=.3*1.5))/4,(t=2*t-1)<0?-.5*Math.pow(2,10*t)*Math.sin((t-e)*Math.PI*2/i):Math.pow(2,-10*t)*Math.sin((t-e)*Math.PI*2/i)*.5+1)},reverse:function(){return cc.easeElasticInOut(this._period)}}},cc.EaseBounce=cc.ActionEase.extend({bounceTime:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},clone:function(){var t=new cc.EaseBounce;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseBounce(this._inner.reverse())}}),cc.EaseBounce.create=function(t){return new cc.EaseBounce(t)},cc.EaseBounceIn=cc.EaseBounce.extend({update:function(t){t=1-this.bounceTime(1-t),this._inner.update(t)},reverse:function(){return new cc.EaseBounceOut(this._inner.reverse())},clone:function(){var t=new cc.EaseBounceIn;return t.initWithAction(this._inner.clone()),t}}),cc.EaseBounceIn.create=function(t){return new cc.EaseBounceIn(t)},cc._bounceTime=function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},cc._easeBounceInObj={easing:function(t){return 1-cc._bounceTime(1-t)},reverse:function(){return cc._easeBounceOutObj}},cc.easeBounceIn=function(){return cc._easeBounceInObj},cc.EaseBounceOut=cc.EaseBounce.extend({update:function(t){t=this.bounceTime(t),this._inner.update(t)},reverse:function(){return new cc.EaseBounceIn(this._inner.reverse())},clone:function(){var t=new cc.EaseBounceOut;return t.initWithAction(this._inner.clone()),t}}),cc.EaseBounceOut.create=function(t){return new cc.EaseBounceOut(t)},cc._easeBounceOutObj={easing:function(t){return cc._bounceTime(t)},reverse:function(){return cc._easeBounceInObj}},cc.easeBounceOut=function(){return cc._easeBounceOutObj},cc.EaseBounceInOut=cc.EaseBounce.extend({update:function(t){t=t<.5?.5*(1-this.bounceTime(1-2*t)):.5*this.bounceTime(2*t-1)+.5;this._inner.update(t)},clone:function(){var t=new cc.EaseBounceInOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseBounceInOut(this._inner.reverse())}}),cc.EaseBounceInOut.create=function(t){return new cc.EaseBounceInOut(t)},cc._easeBounceInOutObj={easing:function(t){return t<.5?.5*(1-cc._bounceTime(1-2*t)):.5*cc._bounceTime(2*t-1)+.5},reverse:function(){return cc._easeBounceInOutObj}},cc.easeBounceInOut=function(){return cc._easeBounceInOutObj},cc.EaseBackIn=cc.ActionEase.extend({update:function(t){this._inner.update(0===t||1===t?t:t*t*(2.70158*t-1.70158))},reverse:function(){return new cc.EaseBackOut(this._inner.reverse())},clone:function(){var t=new cc.EaseBackIn;return t.initWithAction(this._inner.clone()),t}}),cc.EaseBackIn.create=function(t){return new cc.EaseBackIn(t)},cc._easeBackInObj={easing:function(t){return 0===t||1===t?t:t*t*(2.70158*t-1.70158)},reverse:function(){return cc._easeBackOutObj}},cc.easeBackIn=function(){return cc._easeBackInObj},cc.EaseBackOut=cc.ActionEase.extend({update:function(t){this._inner.update(--t*t*(2.70158*t+1.70158)+1)},reverse:function(){return new cc.EaseBackIn(this._inner.reverse())},clone:function(){var t=new cc.EaseBackOut;return t.initWithAction(this._inner.clone()),t}}),cc.EaseBackOut.create=function(t){return new cc.EaseBackOut(t)},cc._easeBackOutObj={easing:function(t){return--t*t*(2.70158*t+1.70158)+1},reverse:function(){return cc._easeBackInObj}},cc.easeBackOut=function(){return cc._easeBackOutObj},cc.EaseBackInOut=cc.ActionEase.extend({update:function(t){(t*=2)<1?this._inner.update(t*t*(3.5949095*t-2.5949095)/2):this._inner.update((t-=2)*t*(3.5949095*t+2.5949095)/2+1)},clone:function(){var t=new cc.EaseBackInOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseBackInOut(this._inner.reverse())}}),cc.EaseBackInOut.create=function(t){return new cc.EaseBackInOut(t)},cc._easeBackInOutObj={easing:function(t){return(t*=2)<1?t*t*(3.5949095*t-2.5949095)/2:(t-=2)*t*(3.5949095*t+2.5949095)/2+1},reverse:function(){return cc._easeBackInOutObj}},cc.easeBackInOut=function(){return cc._easeBackInOutObj},cc.EaseBezierAction=cc.ActionEase.extend({_p0:null,_p1:null,_p2:null,_p3:null,ctor:function(t){cc.ActionEase.prototype.ctor.call(this,t)},_updateTime:function(t,e,i,n,s){return Math.pow(1-s,3)*t+3*s*Math.pow(1-s,2)*e+3*Math.pow(s,2)*(1-s)*i+Math.pow(s,3)*n},update:function(t){t=this._updateTime(this._p0,this._p1,this._p2,this._p3,t),this._inner.update(t)},clone:function(){var t=new cc.EaseBezierAction;return t.initWithAction(this._inner.clone()),t.setBezierParamer(this._p0,this._p1,this._p2,this._p3),t},reverse:function(){var t=new cc.EaseBezierAction(this._inner.reverse());return t.setBezierParamer(this._p3,this._p2,this._p1,this._p0),t},setBezierParamer:function(t,e,i,n){this._p0=t||0,this._p1=e||0,this._p2=i||0,this._p3=n||0}}),cc.EaseBezierAction.create=function(t){return new cc.EaseBezierAction(t)},cc.easeBezierAction=function(e,i,n,s){return{easing:function(t){return cc.EaseBezierAction.prototype._updateTime(e,i,n,s,t)},reverse:function(){return cc.easeBezierAction(s,n,i,e)}}},cc.EaseQuadraticActionIn=cc.ActionEase.extend({_updateTime:function(t){return Math.pow(t,2)},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseQuadraticActionIn;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseQuadraticActionIn(this._inner.reverse())}}),cc.EaseQuadraticActionIn.create=function(t){return new cc.EaseQuadraticActionIn(t)},cc._easeQuadraticActionIn={easing:cc.EaseQuadraticActionIn.prototype._updateTime,reverse:function(){return cc._easeQuadraticActionIn}},cc.easeQuadraticActionIn=function(){return cc._easeQuadraticActionIn},cc.EaseQuadraticActionOut=cc.ActionEase.extend({_updateTime:function(t){return-t*(t-2)},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseQuadraticActionOut;return t.initWithAction(),t},reverse:function(){return new cc.EaseQuadraticActionOut(this._inner.reverse())}}),cc.EaseQuadraticActionOut.create=function(t){return new cc.EaseQuadraticActionOut(t)},cc._easeQuadraticActionOut={easing:cc.EaseQuadraticActionOut.prototype._updateTime,reverse:function(){return cc._easeQuadraticActionOut}},cc.easeQuadraticActionOut=function(){return cc._easeQuadraticActionOut},cc.EaseQuadraticActionInOut=cc.ActionEase.extend({_updateTime:function(t){return(t*=2)<1?t*t*.5:-.5*(--t*(t-2)-1)},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseQuadraticActionInOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseQuadraticActionInOut(this._inner.reverse())}}),cc.EaseQuadraticActionInOut.create=function(t){return new cc.EaseQuadraticActionInOut(t)},cc._easeQuadraticActionInOut={easing:cc.EaseQuadraticActionInOut.prototype._updateTime,reverse:function(){return cc._easeQuadraticActionInOut}},cc.easeQuadraticActionInOut=function(){return cc._easeQuadraticActionInOut},cc.EaseQuarticActionIn=cc.ActionEase.extend({_updateTime:function(t){return t*t*t*t},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseQuarticActionIn;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseQuarticActionIn(this._inner.reverse())}}),cc.EaseQuarticActionIn.create=function(t){return new cc.EaseQuarticActionIn(t)},cc._easeQuarticActionIn={easing:cc.EaseQuarticActionIn.prototype._updateTime,reverse:function(){return cc._easeQuarticActionIn}},cc.easeQuarticActionIn=function(){return cc._easeQuarticActionIn},cc.EaseQuarticActionOut=cc.ActionEase.extend({_updateTime:function(t){return-(--t*t*t*t-1)},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseQuarticActionOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseQuarticActionOut(this._inner.reverse())}}),cc.EaseQuarticActionOut.create=function(t){return new cc.EaseQuarticActionOut(t)},cc._easeQuarticActionOut={easing:cc.EaseQuarticActionOut.prototype._updateTime,reverse:function(){return cc._easeQuarticActionOut}},cc.easeQuarticActionOut=function(){return cc._easeQuarticActionOut},cc.EaseQuarticActionInOut=cc.ActionEase.extend({_updateTime:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseQuarticActionInOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseQuarticActionInOut(this._inner.reverse())}}),cc.EaseQuarticActionInOut.create=function(t){return new cc.EaseQuarticActionInOut(t)},cc._easeQuarticActionInOut={easing:cc.EaseQuarticActionInOut.prototype._updateTime,reverse:function(){return cc._easeQuarticActionInOut}},cc.easeQuarticActionInOut=function(){return cc._easeQuarticActionInOut},cc.EaseQuinticActionIn=cc.ActionEase.extend({_updateTime:function(t){return t*t*t*t*t},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseQuinticActionIn;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseQuinticActionIn(this._inner.reverse())}}),cc.EaseQuinticActionIn.create=function(t){return new cc.EaseQuinticActionIn(t)},cc._easeQuinticActionIn={easing:cc.EaseQuinticActionIn.prototype._updateTime,reverse:function(){return cc._easeQuinticActionIn}},cc.easeQuinticActionIn=function(){return cc._easeQuinticActionIn},cc.EaseQuinticActionOut=cc.ActionEase.extend({_updateTime:function(t){return--t*t*t*t*t+1},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseQuinticActionOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseQuinticActionOut(this._inner.reverse())}}),cc.EaseQuinticActionOut.create=function(t){return new cc.EaseQuinticActionOut(t)},cc._easeQuinticActionOut={easing:cc.EaseQuinticActionOut.prototype._updateTime,reverse:function(){return cc._easeQuinticActionOut}},cc.easeQuinticActionOut=function(){return cc._easeQuinticActionOut},cc.EaseQuinticActionInOut=cc.ActionEase.extend({_updateTime:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseQuinticActionInOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseQuinticActionInOut(this._inner.reverse())}}),cc.EaseQuinticActionInOut.create=function(t){return new cc.EaseQuinticActionInOut(t)},cc._easeQuinticActionInOut={easing:cc.EaseQuinticActionInOut.prototype._updateTime,reverse:function(){return cc._easeQuinticActionInOut}},cc.easeQuinticActionInOut=function(){return cc._easeQuinticActionInOut},cc.EaseCircleActionIn=cc.ActionEase.extend({_updateTime:function(t){return-1*(Math.sqrt(1-t*t)-1)},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseCircleActionIn;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseCircleActionIn(this._inner.reverse())}}),cc.EaseCircleActionIn.create=function(t){return new cc.EaseCircleActionIn(t)},cc._easeCircleActionIn={easing:cc.EaseCircleActionIn.prototype._updateTime,reverse:function(){return cc._easeCircleActionIn}},cc.easeCircleActionIn=function(){return cc._easeCircleActionIn},cc.EaseCircleActionOut=cc.ActionEase.extend({_updateTime:function(t){return--t,Math.sqrt(1-t*t)},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseCircleActionOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseCircleActionOut(this._inner.reverse())}}),cc.EaseCircleActionOut.create=function(t){return new cc.EaseCircleActionOut(t)},cc._easeCircleActionOut={easing:cc.EaseCircleActionOut.prototype._updateTime,reverse:function(){return cc._easeCircleActionOut}},cc.easeCircleActionOut=function(){return cc._easeCircleActionOut},cc.EaseCircleActionInOut=cc.ActionEase.extend({_updateTime:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):(t-=2,.5*(Math.sqrt(1-t*t)+1))},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseCircleActionInOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseCircleActionInOut(this._inner.reverse())}}),cc.EaseCircleActionInOut.create=function(t){return new cc.EaseCircleActionInOut(t)},cc._easeCircleActionInOut={easing:cc.EaseCircleActionInOut.prototype._updateTime,reverse:function(){return cc._easeCircleActionInOut}},cc.easeCircleActionInOut=function(){return cc._easeCircleActionInOut},cc.EaseCubicActionIn=cc.ActionEase.extend({_updateTime:function(t){return t*t*t},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseCubicActionIn;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseCubicActionIn(this._inner.reverse())}}),cc.EaseCubicActionIn.create=function(t){return new cc.EaseCubicActionIn(t)},cc._easeCubicActionIn={easing:cc.EaseCubicActionIn.prototype._updateTime,reverse:function(){return cc._easeCubicActionIn}},cc.easeCubicActionIn=function(){return cc._easeCubicActionIn},cc.EaseCubicActionOut=cc.ActionEase.extend({_updateTime:function(t){return--t*t*t+1},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseCubicActionOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseCubicActionOut(this._inner.reverse())}}),cc.EaseCubicActionOut.create=function(t){return new cc.EaseCubicActionOut(t)},cc._easeCubicActionOut={easing:cc.EaseCubicActionOut.prototype._updateTime,reverse:function(){return cc._easeCubicActionOut}},cc.easeCubicActionOut=function(){return cc._easeCubicActionOut},cc.EaseCubicActionInOut=cc.ActionEase.extend({_updateTime:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseCubicActionInOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseCubicActionInOut(this._inner.reverse())}}),cc.EaseCubicActionInOut.create=function(t){return new cc.EaseCubicActionInOut(t)},cc._easeCubicActionInOut={easing:cc.EaseCubicActionInOut.prototype._updateTime,reverse:function(){return cc._easeCubicActionInOut}},cc.easeCubicActionInOut=function(){return cc._easeCubicActionInOut},cc.cardinalSplineAt=function(t,e,i,n,s,r,o){var a=(l=r*r)*r,c=(1-s)/2,h=c*(l-a)+(2*a-3*l+1),l=t.x*(s=c*(2*l-a-r))+e.x*h+i.x*(r=c*(a-2*l+r)+(-2*a+3*l))+n.x*(a=c*(a-l));if(t=t.y*s+e.y*h+i.y*r+n.y*a,void 0===o)return cc.p(l,t);o.x=l,o.y=t},cc.reverseControlPoints=function(t){for(var e=[],i=t.length-1;0<=i;i--)e.push(cc.p(t[i].x,t[i].y));return e},cc.cloneControlPoints=function(t){for(var e=[],i=0;i<t.length;i++)e.push(cc.p(t[i].x,t[i].y));return e},cc.copyControlPoints=cc.cloneControlPoints,cc.getControlPointAt=function(t,e){return t[Math.min(t.length-1,Math.max(e,0))]},cc.reverseControlPointsInline=function(t){for(var e=t.length,i=0|e/2,n=0;n<i;++n){var s=t[n];t[n]=t[e-n-1],t[e-n-1]=s}},cc.CardinalSplineTo=cc.ActionInterval.extend({_points:null,_deltaT:0,_tension:0,_previousPosition:null,_accumulatedDiff:null,ctor:function(t,e,i){cc.ActionInterval.prototype.ctor.call(this),this._points=[],void 0!==i&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){if(e&&0!==e.length)return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this.setPoints(e),this._tension=i,!0);throw Error("Invalid configuration. It must at least have one control point")},clone:function(){var t=new cc.CardinalSplineTo;return t.initWithDuration(this._duration,cc.copyControlPoints(this._points),this._tension),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._deltaT=1/(this._points.length-1),this._previousPosition=cc.p(this.target.getPositionX(),this.target.getPositionY()),this._accumulatedDiff=cc.p(0,0)},update:function(t){t=this._computeEaseTime(t);var e,i,n=this._points;t=1===t?(i=n.length-1,1):(t-(e=this._deltaT)*(i=0|t/e))/e,i=cc.cardinalSplineAt(cc.getControlPointAt(n,i-1),cc.getControlPointAt(n,+i),cc.getControlPointAt(n,i+1),cc.getControlPointAt(n,i+2),this._tension,t),cc.ENABLE_STACKABLE_ACTIONS&&(n=this.target.getPositionX()-this._previousPosition.x,t=this.target.getPositionY()-this._previousPosition.y,0!==n||0!==t)&&(n=(e=this._accumulatedDiff).x+n,t=e.y+t,e.x=n,e.y=t,i.x+=n,i.y+=t),this.updatePosition(i)},reverse:function(){var t=cc.reverseControlPoints(this._points);return cc.cardinalSplineTo(this._duration,t,this._tension)},updatePosition:function(t){this.target.setPosition(t),this._previousPosition=t},getPoints:function(){return this._points},setPoints:function(t){this._points=t}}),cc.cardinalSplineTo=function(t,e,i){return new cc.CardinalSplineTo(t,e,i)},cc.CardinalSplineTo.create=cc.cardinalSplineTo,cc.CardinalSplineBy=cc.CardinalSplineTo.extend({_startPosition:null,ctor:function(t,e,i){cc.CardinalSplineTo.prototype.ctor.call(this),this._startPosition=cc.p(0,0),void 0!==i&&this.initWithDuration(t,e,i)},startWithTarget:function(t){cc.CardinalSplineTo.prototype.startWithTarget.call(this,t),this._startPosition.x=t.getPositionX(),this._startPosition.y=t.getPositionY()},reverse:function(){for(var t,e=this._points.slice(),i=e[0],n=1;n<e.length;++n)t=e[n],e[n]=cc.pSub(t,i),i=t;for(i=(e=cc.reverseControlPoints(e))[e.length-1],e.pop(),i.x=-i.x,i.y=-i.y,e.unshift(i),n=1;n<e.length;++n)(t=e[n]).x=-t.x,t.y=-t.y,t.x+=i.x,t.y+=i.y,i=e[n]=t;return cc.cardinalSplineBy(this._duration,e,this._tension)},updatePosition:function(t){var e=this._startPosition,i=t.x+e.x;t=t.y+e.y,this._previousPosition.x=i,this._previousPosition.y=t,this.target.setPosition(i,t)},clone:function(){var t=new cc.CardinalSplineBy;return t.initWithDuration(this._duration,cc.copyControlPoints(this._points),this._tension),t}}),cc.cardinalSplineBy=function(t,e,i){return new cc.CardinalSplineBy(t,e,i)},cc.CardinalSplineBy.create=cc.cardinalSplineBy,cc.CatmullRomTo=cc.CardinalSplineTo.extend({ctor:function(t,e){e&&this.initWithDuration(t,e)},initWithDuration:function(t,e){return cc.CardinalSplineTo.prototype.initWithDuration.call(this,t,e,.5)},clone:function(){var t=new cc.CatmullRomTo;return t.initWithDuration(this._duration,cc.copyControlPoints(this._points)),t}}),cc.catmullRomTo=function(t,e){return new cc.CatmullRomTo(t,e)},cc.CatmullRomTo.create=cc.catmullRomTo,cc.CatmullRomBy=cc.CardinalSplineBy.extend({ctor:function(t,e){cc.CardinalSplineBy.prototype.ctor.call(this),e&&this.initWithDuration(t,e)},initWithDuration:function(t,e){return cc.CardinalSplineTo.prototype.initWithDuration.call(this,t,e,.5)},clone:function(){var t=new cc.CatmullRomBy;return t.initWithDuration(this._duration,cc.copyControlPoints(this._points)),t}}),cc.catmullRomBy=function(t,e){return new cc.CatmullRomBy(t,e)},cc.CatmullRomBy.create=cc.catmullRomBy,cc.ActionTweenDelegate=cc.Class.extend({updateTweenAction:function(t,e){}}),cc.ActionTween=cc.ActionInterval.extend({key:"",from:0,to:0,delta:0,ctor:function(t,e,i,n){cc.ActionInterval.prototype.ctor.call(this),this.key="",void 0!==n&&this.initWithDuration(t,e,i,n)},initWithDuration:function(t,e,i,n){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this.key=e,this.to=n,this.from=i,!0)},startWithTarget:function(t){if(!t||!t.updateTweenAction)throw Error("cc.ActionTween.startWithTarget(): target must be non-null, and target must implement updateTweenAction function");cc.ActionInterval.prototype.startWithTarget.call(this,t),this.delta=this.to-this.from},update:function(t){this.target.updateTweenAction(this.to-this.delta*(1-t),this.key)},reverse:function(){return new cc.ActionTween(this.duration,this.key,this.to,this.from)},clone:function(){var t=new cc.ActionTween;return t.initWithDuration(this._duration,this.key,this.from,this.to),t}}),cc.actionTween=function(t,e,i,n){return new cc.ActionTween(t,e,i,n)},cc.ActionTween.create=cc.actionTween,cc.GridAction=cc.ActionInterval.extend({_gridSize:null,_gridNodeTarget:null,ctor:function(t,e){cc.sys._checkWebGLRenderMode(),cc.ActionInterval.prototype.ctor.call(this),this._gridSize=cc.size(0,0),e&&this.initWithDuration(t,e)},_cacheTargetAsGridNode:function(t){this._gridNodeTarget=t},clone:function(){var t=new cc.GridAction,e=this._gridSize;return t.initWithDuration(this._duration,cc.size(e.width,e.height)),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),cc.renderer.childrenOrderDirty=!0,this._cacheTargetAsGridNode(t);var e=this.getGrid();(t=this._gridNodeTarget.getGrid())&&0<t.getReuseGrid()?(e=t.getGridSize(),t.isActive()&&e.width===this._gridSize.width&&e.height===this._gridSize.height&&t.reuse()):(t&&t.isActive()&&t.setActive(!1),this._gridNodeTarget.setGrid(e),this._gridNodeTarget.getGrid().setActive(!0))},reverse:function(){return new cc.ReverseTime(this)},initWithDuration:function(t,e){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._gridSize.width=e.width,this._gridSize.height=e.height,!0)},getGrid:function(){cc.log("cc.GridAction.getGrid(): it should be overridden in subclass.")}}),cc.gridAction=function(t,e){return new cc.GridAction(t,e)},cc.GridAction.create=cc.gridAction,cc.Grid3DAction=cc.GridAction.extend({getGrid:function(){return new cc.Grid3D(this._gridSize,void 0,void 0,this._gridNodeTarget.getGridRect())},getGridRect:function(){return this._gridNodeTarget.getGridRect()},vertex:function(t){return this.getVertex(t)},getVertex:function(t){return this.target.grid.getVertex(t)},originalVertex:function(t){return this.getOriginalVertex(t)},getOriginalVertex:function(t){return this.target.grid.originalVertex(t)},setVertex:function(t,e){this.target.grid.setVertex(t,e)}}),cc.grid3DAction=function(t,e){return new cc.Grid3DAction(t,e)},cc.Grid3DAction.create=cc.grid3DAction,cc.TiledGrid3DAction=cc.GridAction.extend({tile:function(t){return this.getTile(t)},getTile:function(t){return this.target.grid.tile(t)},originalTile:function(t){return this.getOriginalTile(t)},getOriginalTile:function(t){return this.target.grid.originalTile(t)},setTile:function(t,e){this.target.grid.setTile(t,e)},getGrid:function(){return new cc.TiledGrid3D(this._gridSize,void 0,void 0,this._gridNodeTarget.getGridRect())}}),cc.tiledGrid3DAction=function(t,e){return new cc.TiledGrid3DAction(t,e)},cc.TiledGrid3DAction.create=cc.tiledGrid3DAction,cc.StopGrid=cc.ActionInstant.extend({startWithTarget:function(t){cc.ActionInstant.prototype.startWithTarget.call(this,t),cc.renderer.childrenOrderDirty=!0,(t=this.target.grid)&&t.isActive()&&t.setActive(!1)}}),cc.stopGrid=function(){return new cc.StopGrid},cc.StopGrid.create=cc.stopGrid,cc.ReuseGrid=cc.ActionInstant.extend({_times:null,ctor:function(t){cc.ActionInstant.prototype.ctor.call(this),void 0!==t&&this.initWithTimes(t)},initWithTimes:function(t){return this._times=t,!0},startWithTarget:function(t){cc.ActionInstant.prototype.startWithTarget.call(this,t),cc.renderer.childrenOrderDirty=!0,this.target.grid&&this.target.grid.isActive()&&this.target.grid.setReuseGrid(this.target.grid.getReuseGrid()+this._times)}}),cc.reuseGrid=function(t){return new cc.ReuseGrid(t)},cc.ReuseGrid.create=cc.reuseGrid,cc.Waves3D=cc.Grid3DAction.extend({_waves:0,_amplitude:0,_amplitudeRate:0,ctor:function(t,e,i,n){cc.GridAction.prototype.ctor.call(this),void 0!==n&&this.initWithDuration(t,e,i,n)},getAmplitude:function(){return this._amplitude},setAmplitude:function(t){this._amplitude=t},getAmplitudeRate:function(){return this._amplitudeRate},setAmplitudeRate:function(t){this._amplitudeRate=t},initWithDuration:function(t,e,i,n){return!!cc.Grid3DAction.prototype.initWithDuration.call(this,t,e)&&(this._waves=i,this._amplitude=n,this._amplitudeRate=1,!0)},update:function(t){for(var e=this._gridSize,i=this._amplitude,n=cc.p(0,0),s=this._amplitudeRate,r=this._waves,o=0;o<e.width+1;++o)for(var a=0;a<e.height+1;++a){n.x=o,n.y=a;var c=this.originalVertex(n);c.z+=Math.sin(Math.PI*t*r*2+.01*(c.y+c.x))*i*s,this.setVertex(n,c)}}}),cc.waves3D=function(t,e,i,n){return new cc.Waves3D(t,e,i,n)},cc.Waves3D.create=cc.waves3D,cc.FlipX3D=cc.Grid3DAction.extend({ctor:function(t){void 0!==t?cc.GridAction.prototype.ctor.call(this,t,cc.size(1,1)):cc.GridAction.prototype.ctor.call(this)},initWithDuration:function(t){return cc.Grid3DAction.prototype.initWithDuration.call(this,t,cc.size(1,1))},initWithSize:function(t,e){return 1!==t.width||1!==t.height?(cc.log("Grid size must be (1,1)"),!1):cc.Grid3DAction.prototype.initWithDuration.call(this,e,t)},update:function(t){var e,i,n=Math.PI*t,s=(t=Math.sin(n),Math.cos(n/2)),n=new cc.Vertex3F,r=((o=cc.p(0,0)).x=o.y=1,this.originalVertex(o)),o=(o.x=o.y=0,this.originalVertex(o)),a=r.x,c=o.x;c<a?(r=cc.p(0,0),o=cc.p(0,1),e=cc.p(1,0),i=cc.p(1,1)):(e=cc.p(0,0),i=cc.p(0,1),r=cc.p(1,0),o=cc.p(1,1),a=c),n.x=a-a*s,n.z=Math.abs(parseFloat(a*t/4)),(t=this.originalVertex(r)).x=n.x,t.z+=n.z,this.setVertex(r,t),(t=this.originalVertex(o)).x=n.x,t.z+=n.z,this.setVertex(o,t),(t=this.originalVertex(e)).x-=n.x,t.z-=n.z,this.setVertex(e,t),(t=this.originalVertex(i)).x-=n.x,t.z-=n.z,this.setVertex(i,t)}}),cc.flipX3D=function(t){return new cc.FlipX3D(t)},cc.FlipX3D.create=cc.flipX3D,cc.FlipY3D=cc.FlipX3D.extend({ctor:function(t){void 0!==t?cc.GridAction.prototype.ctor.call(this,t,cc.size(1,1)):cc.GridAction.prototype.ctor.call(this)},update:function(t){var e,i,n=Math.PI*t,s=(t=Math.sin(n),Math.cos(n/2)),n=new cc.Vertex3F,r=((o=cc.p(0,0)).x=o.y=1,this.originalVertex(o)),o=(o.x=o.y=0,this.originalVertex(o)),a=r.y,c=o.y;c<a?(r=cc.p(0,0),o=cc.p(0,1),e=cc.p(1,0),i=cc.p(1,1)):(o=cc.p(0,0),r=cc.p(0,1),i=cc.p(1,0),e=cc.p(1,1),a=c),n.y=a-a*s,n.z=Math.abs(parseFloat(a*t)/4),(t=this.originalVertex(r)).y=n.y,t.z+=n.z,this.setVertex(r,t),(t=this.originalVertex(o)).y-=n.y,t.z-=n.z,this.setVertex(o,t),(t=this.originalVertex(e)).y=n.y,t.z+=n.z,this.setVertex(e,t),(t=this.originalVertex(i)).y-=n.y,t.z-=n.z,this.setVertex(i,t)}}),cc.flipY3D=function(t){return new cc.FlipY3D(t)},cc.FlipY3D.create=cc.flipY3D,cc.Lens3D=cc.Grid3DAction.extend({_position:null,_radius:0,_lensEffect:0,_concave:!1,_dirty:!1,ctor:function(t,e,i,n){cc.GridAction.prototype.ctor.call(this),this._position=cc.p(0,0),void 0!==n&&this.initWithDuration(t,e,i,n)},getLensEffect:function(){return this._lensEffect},setLensEffect:function(t){this._lensEffect=t},setConcave:function(t){this._concave=t},getPosition:function(){return this._position},setPosition:function(t){cc.pointEqualToPoint(t,this._position)||(this._position.x=t.x,this._position.y=t.y,this._dirty=!0)},initWithDuration:function(t,e,i,n){return!!cc.Grid3DAction.prototype.initWithDuration.call(this,t,e)&&(this.setPosition(i),this._radius=n,this._lensEffect=.7,this._dirty=!0)},update:function(t){if(this._dirty){t=this._gridSize.width;for(var e,i,n,s=this._gridSize.height,r=this._radius,o=this._lensEffect,a=cc.p(0,0),c=cc.p(0,0),h=0;h<t+1;++h)for(var l=0;l<s+1;++l)a.x=h,a.y=l,e=this.originalVertex(a),c.x=this._position.x-e.x,c.y=this._position.y-e.y,(i=cc.pLength(c))<r&&(i=r-i,0===(i/=r)&&(i=.001),i=Math.log(i)*o,n=Math.exp(i)*r,0<(i=cc.pLength(c)))&&(c.x/=i,c.y/=i,c.x*=n,c.y*=n,e.z+=cc.pLength(c)*o),this.setVertex(a,e);this._dirty=!1}}}),cc.lens3D=function(t,e,i,n){return new cc.Lens3D(t,e,i,n)},cc.Lens3D.create=cc.lens3D,cc.Ripple3D=cc.Grid3DAction.extend({_position:null,_radius:0,_waves:0,_amplitude:0,_amplitudeRate:0,ctor:function(t,e,i,n,s,r){cc.GridAction.prototype.ctor.call(this),this._position=cc.p(0,0),void 0!==r&&this.initWithDuration(t,e,i,n,s,r)},getPosition:function(){return this._position},setPosition:function(t){this._position.x=t.x,this._position.y=t.y},getAmplitude:function(){return this._amplitude},setAmplitude:function(t){this._amplitude=t},getAmplitudeRate:function(){return this._amplitudeRate},setAmplitudeRate:function(t){this._amplitudeRate=t},initWithDuration:function(t,e,i,n,s,r){return!!cc.Grid3DAction.prototype.initWithDuration.call(this,t,e)&&(this.setPosition(i),this._radius=n,this._waves=s,this._amplitude=r,this._amplitudeRate=1,!0)},update:function(t){for(var e,i,n,s=this._gridSize.width,r=this._gridSize.height,o=cc.p(0,0),a=this._radius,c=this._waves,h=this._amplitude,l=this._amplitudeRate,u=cc.p(0,0),d=0;d<s+1;++d)for(var _=0;_<r+1;++_)o.x=d,o.y=_,e=this.originalVertex(o),u.x=this._position.x-e.x,u.y=this._position.y-e.y,(i=cc.pLength(u))<a&&(i=a-i,n=Math.pow(i/a,2),e.z+=Math.sin(t*Math.PI*c*2+.1*i)*h*l*n),this.setVertex(o,e)}}),cc.ripple3D=function(t,e,i,n,s,r){return new cc.Ripple3D(t,e,i,n,s,r)},cc.Ripple3D.create=cc.ripple3D,cc.Shaky3D=cc.Grid3DAction.extend({_randRange:0,_shakeZ:!1,ctor:function(t,e,i,n){cc.GridAction.prototype.ctor.call(this),void 0!==n&&this.initWithDuration(t,e,i,n)},initWithDuration:function(t,e,i,n){return!!cc.Grid3DAction.prototype.initWithDuration.call(this,t,e)&&(this._randRange=i,this._shakeZ=n,!0)},update:function(t){t=this._gridSize.width;for(var e,i=this._gridSize.height,n=this._randRange,s=this._shakeZ,r=cc.p(0,0),o=0;o<t+1;++o)for(var a=0;a<i+1;++a)r.x=o,r.y=a,(e=this.originalVertex(r)).x+=cc.rand()%(2*n)-n,e.y+=cc.rand()%(2*n)-n,s&&(e.z+=cc.rand()%(2*n)-n),this.setVertex(r,e)}}),cc.shaky3D=function(t,e,i,n){return new cc.Shaky3D(t,e,i,n)},cc.Shaky3D.create=cc.shaky3D,cc.Liquid=cc.Grid3DAction.extend({_waves:0,_amplitude:0,_amplitudeRate:0,ctor:function(t,e,i,n){cc.GridAction.prototype.ctor.call(this),void 0!==n&&this.initWithDuration(t,e,i,n)},getAmplitude:function(){return this._amplitude},setAmplitude:function(t){this._amplitude=t},getAmplitudeRate:function(){return this._amplitudeRate},setAmplitudeRate:function(t){this._amplitudeRate=t},initWithDuration:function(t,e,i,n){return!!cc.Grid3DAction.prototype.initWithDuration.call(this,t,e)&&(this._waves=i,this._amplitude=n,this._amplitudeRate=1,!0)},update:function(t){for(var e,i=this._gridSize.width,n=this._gridSize.height,s=cc.p(0,0),r=this._waves,o=this._amplitude,a=this._amplitudeRate,c=1;c<i;++c)for(var h=1;h<n;++h)s.x=c,s.y=h,(e=this.originalVertex(s)).x+=Math.sin(t*Math.PI*r*2+.01*e.x)*o*a,e.y+=Math.sin(t*Math.PI*r*2+.01*e.y)*o*a,this.setVertex(s,e)}}),cc.liquid=function(t,e,i,n){return new cc.Liquid(t,e,i,n)},cc.Liquid.create=cc.liquid,cc.Waves=cc.Grid3DAction.extend({_waves:0,_amplitude:0,_amplitudeRate:0,_vertical:!1,_horizontal:!1,ctor:function(t,e,i,n,s,r){cc.GridAction.prototype.ctor.call(this),void 0!==r&&this.initWithDuration(t,e,i,n,s,r)},getAmplitude:function(){return this._amplitude},setAmplitude:function(t){this._amplitude=t},getAmplitudeRate:function(){return this._amplitudeRate},setAmplitudeRate:function(t){this._amplitudeRate=t},initWithDuration:function(t,e,i,n,s,r){return!!cc.Grid3DAction.prototype.initWithDuration.call(this,t,e)&&(this._waves=i,this._amplitude=n,this._amplitudeRate=1,this._horizontal=s,this._vertical=r,!0)},update:function(t){for(var e,i=this._gridSize.width,n=this._gridSize.height,s=cc.p(0,0),r=this._vertical,o=this._horizontal,a=this._waves,c=this._amplitude,h=this._amplitudeRate,l=0;l<i+1;++l)for(var u=0;u<n+1;++u)s.x=l,s.y=u,e=this.originalVertex(s),r&&(e.x+=Math.sin(t*Math.PI*a*2+.01*e.y)*c*h),o&&(e.y+=Math.sin(t*Math.PI*a*2+.01*e.x)*c*h),this.setVertex(s,e)}}),cc.waves=function(t,e,i,n,s,r){return new cc.Waves(t,e,i,n,s,r)},cc.Waves.create=cc.waves,cc.Twirl=cc.Grid3DAction.extend({_position:null,_twirls:0,_amplitude:0,_amplitudeRate:0,ctor:function(t,e,i,n,s){cc.GridAction.prototype.ctor.call(this),this._position=cc.p(0,0),void 0!==s&&this.initWithDuration(t,e,i,n,s)},getPosition:function(){return this._position},setPosition:function(t){this._position.x=t.x,this._position.y=t.y},getAmplitude:function(){return this._amplitude},setAmplitude:function(t){this._amplitude=t},getAmplitudeRate:function(){return this._amplitudeRate},setAmplitudeRate:function(t){this._amplitudeRate=t},initWithDuration:function(t,e,i,n,s){return!!cc.Grid3DAction.prototype.initWithDuration.call(this,t,e)&&(this.setPosition(i),this._twirls=n,this._amplitude=s,this._amplitudeRate=1,!0)},update:function(t){for(var e,i,n,s=this._position,r=this._gridSize.width,o=this._gridSize.height,a=cc.p(0,0),c=.1*this._amplitude*this._amplitudeRate,h=this._twirls,l=cc.p(0,0),u=0;u<r+1;++u)for(var d=0;d<o+1;++d)a.x=u,a.y=d,e=this.originalVertex(a),l.x=u-r/2,l.y=d-o/2,i=cc.pLength(l)*Math.cos(Math.PI/2+t*Math.PI*h*2)*c,n=Math.sin(i)*(e.y-s.y)+Math.cos(i)*(e.x-s.x),i=Math.cos(i)*(e.y-s.y)-Math.sin(i)*(e.x-s.x),e.x=s.x+n,e.y=s.y+i,this.setVertex(a,e)}}),cc.twirl=function(t,e,i,n,s){return new cc.Twirl(t,e,i,n,s)},cc.Twirl.create=cc.twirl,cc.ShakyTiles3D=cc.TiledGrid3DAction.extend({_randRange:0,_shakeZ:!1,ctor:function(t,e,i,n){cc.GridAction.prototype.ctor.call(this),void 0!==n&&this.initWithDuration(t,e,i,n)},initWithDuration:function(t,e,i,n){return!!cc.TiledGrid3DAction.prototype.initWithDuration.call(this,t,e)&&(this._randRange=i,this._shakeZ=n,!0)},update:function(t){t=this._gridSize;for(var e=this._randRange,i=cc.p(0,0),n=0;n<t.width;++n)for(var s=0;s<t.height;++s){i.x=n,i.y=s;var r=this.originalTile(i);r.bl.x+=cc.rand()%(2*e)-e,r.br.x+=cc.rand()%(2*e)-e,r.tl.x+=cc.rand()%(2*e)-e,r.tr.x+=cc.rand()%(2*e)-e,r.bl.y+=cc.rand()%(2*e)-e,r.br.y+=cc.rand()%(2*e)-e,r.tl.y+=cc.rand()%(2*e)-e,r.tr.y+=cc.rand()%(2*e)-e,this._shakeZ&&(r.bl.z+=cc.rand()%(2*e)-e,r.br.z+=cc.rand()%(2*e)-e,r.tl.z+=cc.rand()%(2*e)-e,r.tr.z+=cc.rand()%(2*e)-e),this.setTile(i,r)}}}),cc.shakyTiles3D=function(t,e,i,n){return new cc.ShakyTiles3D(t,e,i,n)},cc.ShakyTiles3D.create=cc.shakyTiles3D,cc.ShatteredTiles3D=cc.TiledGrid3DAction.extend({_randRange:0,_once:!1,_shatterZ:!1,ctor:function(t,e,i,n){cc.GridAction.prototype.ctor.call(this),void 0!==n&&this.initWithDuration(t,e,i,n)},initWithDuration:function(t,e,i,n){return!!cc.TiledGrid3DAction.prototype.initWithDuration.call(this,t,e)&&(this._once=!1,this._randRange=i,this._shatterZ=n,!0)},update:function(t){if(!1===this._once){t=this._gridSize;for(var e,i=this._randRange,n=cc.p(0,0),s=0;s<t.width;++s)for(var r=0;r<t.height;++r)n.x=s,n.y=r,(e=this.originalTile(n)).bl.x+=cc.rand()%(2*i)-i,e.br.x+=cc.rand()%(2*i)-i,e.tl.x+=cc.rand()%(2*i)-i,e.tr.x+=cc.rand()%(2*i)-i,e.bl.y+=cc.rand()%(2*i)-i,e.br.y+=cc.rand()%(2*i)-i,e.tl.y+=cc.rand()%(2*i)-i,e.tr.y+=cc.rand()%(2*i)-i,this._shatterZ&&(e.bl.z+=cc.rand()%(2*i)-i,e.br.z+=cc.rand()%(2*i)-i,e.tl.z+=cc.rand()%(2*i)-i,e.tr.z+=cc.rand()%(2*i)-i),this.setTile(n,e);this._once=!0}}}),cc.shatteredTiles3D=function(t,e,i,n){return new cc.ShatteredTiles3D(t,e,i,n)},cc.ShatteredTiles3D.create=cc.shatteredTiles3D,cc.Tile=function(t,e,i){this.position=t||cc.p(0,0),this.startPosition=e||cc.p(0,0),this.delta=i||cc.p(0,0)},cc.ShuffleTiles=cc.TiledGrid3DAction.extend({_seed:0,_tilesCount:0,_tilesOrder:null,_tiles:null,ctor:function(t,e,i){cc.GridAction.prototype.ctor.call(this),this._tilesOrder=[],this._tiles=[],void 0!==i&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){return!!cc.TiledGrid3DAction.prototype.initWithDuration.call(this,t,e)&&(this._seed=i,this._tilesOrder.length=0,!(this._tiles.length=0))},shuffle:function(t,e){for(var i=e-1;0<=i;i--){var n=0|cc.rand()%(i+1),s=t[i];t[i]=t[n],t[n]=s}},getDelta:function(t){var e=this._gridSize,i=t.width*e.height+t.height;return cc.size(this._tilesOrder[i]/e.height-t.width,this._tilesOrder[i]%e.height-t.height)},placeTile:function(t,e){var i=this.originalTile(t),n=this.target.grid.getStep(),e=e.position;i.bl.x+=e.x*n.x,i.bl.y+=e.y*n.y,i.br.x+=e.x*n.x,i.br.y+=e.y*n.y,i.tl.x+=e.x*n.x,i.tl.y+=e.y*n.y,i.tr.x+=e.x*n.x,i.tr.y+=e.y*n.y,this.setTile(t,i)},startWithTarget:function(t){cc.TiledGrid3DAction.prototype.startWithTarget.call(this,t),t=this._gridSize,this._tilesCount=t.width*t.height;for(var e=this._tilesOrder,i=e.length=0;i<this._tilesCount;++i)e[i]=i;this.shuffle(e,this._tilesCount);for(var i=(e=this._tiles).length=0,n=cc.size(0,0),s=0;s<t.width;++s)for(var r=0;r<t.height;++r)e[i]=new cc.Tile,e[i].position=cc.p(s,r),e[i].startPosition=cc.p(s,r),n.width=s,n.height=r,e[i].delta=this.getDelta(n),++i},update:function(t){for(var e,i=0,n=this._gridSize,s=this._tiles,r=cc.p(0,0),o=0;o<n.width;++o)for(var a=0;a<n.height;++a)r.x=o,r.y=a,(e=s[i]).position.x=e.delta.width*t,e.position.y=e.delta.height*t,this.placeTile(r,e),++i}}),cc.shuffleTiles=function(t,e,i){return new cc.ShuffleTiles(t,e,i)},cc.ShuffleTiles.create=cc.shuffleTiles,cc.FadeOutTRTiles=cc.TiledGrid3DAction.extend({testFunc:function(t,e){var i=this._gridSize.width*e,e=this._gridSize.height*e;return i===this._gridSize.width&&e===this._gridSize.height?0:0==i+e?1:Math.pow((t.x+t.y)/(i+e),6)},turnOnTile:function(t){this.setTile(t,this.originalTile(t))},turnOffTile:function(t){this.setTile(t,new cc.Quad3)},transformTile:function(t,e){var i=this.originalTile(t),n=this.target.grid.getStep();i.bl.x+=n.x/2*(1-e),i.bl.y+=n.y/2*(1-e),i.br.x-=n.x/2*(1-e),i.br.y+=n.y/2*(1-e),i.tl.x+=n.x/2*(1-e),i.tl.y-=n.y/2*(1-e),i.tr.x-=n.x/2*(1-e),i.tr.y-=n.y/2*(1-e),this.setTile(t,i)},update:function(t){for(var e,i=this._gridSize,n=cc.p(0,0),s=0;s<i.width;++s)for(var r=0;r<i.height;++r)n.x=s,n.y=r,0===(e=this.testFunc(n,t))?this.turnOffTile(n):e<1?this.transformTile(n,e):this.turnOnTile(n)}}),cc.fadeOutTRTiles=function(t,e){return new cc.FadeOutTRTiles(t,e)},cc.FadeOutTRTiles.create=cc.fadeOutTRTiles,cc.FadeOutBLTiles=cc.FadeOutTRTiles.extend({testFunc:function(t,e){var i=this._gridSize.width*(1-e),e=this._gridSize.height*(1-e);return 0==i+e?0:0===t.x+t.y?1:Math.pow((i+e)/(t.x+t.y),6)}}),cc.fadeOutBLTiles=function(t,e){return new cc.FadeOutBLTiles(t,e)},cc.FadeOutBLTiles.create=cc.fadeOutBLTiles,cc.FadeOutUpTiles=cc.FadeOutTRTiles.extend({testFunc:function(t,e){e=this._gridSize.height*e;return e===this._gridSize.height?0:0==e?1:Math.pow(t.y/e,6)},transformTile:function(t,e){var i=this.originalTile(t),n=this.target.grid.getStep();i.bl.y+=n.y/2*(1-e),i.br.y+=n.y/2*(1-e),i.tl.y-=n.y/2*(1-e),i.tr.y-=n.y/2*(1-e),this.setTile(t,i)}}),cc.fadeOutUpTiles=function(t,e){return new cc.FadeOutUpTiles(t,e)},cc.FadeOutUpTiles.create=cc.fadeOutUpTiles,cc.FadeOutDownTiles=cc.FadeOutUpTiles.extend({testFunc:function(t,e){e=this._gridSize.height*(1-e);return 0==e?0:0===t.y?1:Math.pow(e/t.y,6)}}),cc.fadeOutDownTiles=function(t,e){return new cc.FadeOutDownTiles(t,e)},cc.FadeOutDownTiles.create=cc.fadeOutDownTiles,cc.TurnOffTiles=cc.TiledGrid3DAction.extend({_seed:null,_tilesCount:0,_tilesOrder:null,ctor:function(t,e,i){cc.GridAction.prototype.ctor.call(this),this._tilesOrder=[],void 0!==e&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){return!!cc.TiledGrid3DAction.prototype.initWithDuration.call(this,t,e)&&(this._seed=i||0,!(this._tilesOrder.length=0))},shuffle:function(t,e){for(var i=e-1;0<=i;i--){var n=0|cc.rand()%(i+1),s=t[i];t[i]=t[n],t[n]=s}},turnOnTile:function(t){this.setTile(t,this.originalTile(t))},turnOffTile:function(t){this.setTile(t,new cc.Quad3)},startWithTarget:function(t){cc.TiledGrid3DAction.prototype.startWithTarget.call(this,t),this._tilesCount=this._gridSize.width*this._gridSize.height;for(var e=(t=this._tilesOrder).length=0;e<this._tilesCount;++e)t[e]=e;this.shuffle(t,this._tilesCount)},update:function(t){t=0|t*this._tilesCount;for(var e,i=this._gridSize,n=cc.p(0,0),s=this._tilesOrder,r=0;r<this._tilesCount;r++)e=s[r],n.x=0|e/i.height,n.y=e%(0|i.height),r<t?this.turnOffTile(n):this.turnOnTile(n)}}),cc.turnOffTiles=function(t,e,i){return new cc.TurnOffTiles(t,e,i)},cc.TurnOffTiles.create=cc.turnOffTiles,cc.WavesTiles3D=cc.TiledGrid3DAction.extend({_waves:0,_amplitude:0,_amplitudeRate:0,ctor:function(t,e,i,n){cc.GridAction.prototype.ctor.call(this),void 0!==n&&this.initWithDuration(t,e,i,n)},getAmplitude:function(){return this._amplitude},setAmplitude:function(t){this._amplitude=t},getAmplitudeRate:function(){return this._amplitudeRate},setAmplitudeRate:function(t){this._amplitudeRate=t},initWithDuration:function(t,e,i,n){return!!cc.TiledGrid3DAction.prototype.initWithDuration.call(this,t,e)&&(this._waves=i,this._amplitude=n,this._amplitudeRate=1,!0)},update:function(t){for(var e,i=this._gridSize,n=this._waves,s=this._amplitude,r=this._amplitudeRate,o=cc.p(0,0),a=0;a<i.width;a++)for(var c=0;c<i.height;c++)o.x=a,o.y=c,(e=this.originalTile(o)).bl.z=Math.sin(t*Math.PI*n*2+.01*(e.bl.y+e.bl.x))*s*r,e.br.z=e.bl.z,e.tl.z=e.bl.z,e.tr.z=e.bl.z,this.setTile(o,e)}}),cc.wavesTiles3D=function(t,e,i,n){return new cc.WavesTiles3D(t,e,i,n)},cc.WavesTiles3D.create=cc.wavesTiles3D,cc.JumpTiles3D=cc.TiledGrid3DAction.extend({_jumps:0,_amplitude:0,_amplitudeRate:0,ctor:function(t,e,i,n){cc.GridAction.prototype.ctor.call(this),void 0!==n&&this.initWithDuration(t,e,i,n)},getAmplitude:function(){return this._amplitude},setAmplitude:function(t){this._amplitude=t},getAmplitudeRate:function(){return this._amplitudeRate},setAmplitudeRate:function(t){this._amplitudeRate=t},initWithDuration:function(t,e,i,n){return!!cc.TiledGrid3DAction.prototype.initWithDuration.call(this,t,e)&&(this._jumps=i,this._amplitude=n,this._amplitudeRate=1,!0)},update:function(t){var e=Math.sin(Math.PI*t*this._jumps*2)*this._amplitude*this._amplitudeRate;t=Math.sin(Math.PI*(t*this._jumps*2+1))*this._amplitude*this._amplitudeRate;for(var i,n=this._gridSize,s=this.target.grid,r=cc.p(0,0),o=0;o<n.width;o++)for(var a=0;a<n.height;a++)r.x=o,r.y=a,i=s.originalTile(r),0==(o+a)%2?(i.bl.z+=e,i.br.z+=e,i.tl.z+=e,i.tr.z+=e):(i.bl.z+=t,i.br.z+=t,i.tl.z+=t,i.tr.z+=t),s.setTile(r,i)}}),cc.jumpTiles3D=function(t,e,i,n){return new cc.JumpTiles3D(t,e,i,n)},cc.JumpTiles3D.create=cc.jumpTiles3D,cc.SplitRows=cc.TiledGrid3DAction.extend({_rows:0,_winSize:null,ctor:function(t,e){cc.GridAction.prototype.ctor.call(this),void 0!==e&&this.initWithDuration(t,e)},initWithDuration:function(t,e){return this._rows=e,cc.TiledGrid3DAction.prototype.initWithDuration.call(this,t,cc.size(1,e))},update:function(t){for(var e,i,n=this._gridSize,s=this._winSize.width,r=cc.p(0,0),o=0;o<n.height;++o)r.y=o,(e=this.originalTile(r)).bl.x+=(i=0==o%2?-1:1)*s*t,e.br.x+=i*s*t,e.tl.x+=i*s*t,e.tr.x+=i*s*t,this.setTile(r,e)},startWithTarget:function(t){cc.TiledGrid3DAction.prototype.startWithTarget.call(this,t),this._winSize=cc.director.getWinSizeInPixels()}}),cc.splitRows=function(t,e){return new cc.SplitRows(t,e)},cc.SplitRows.create=cc.splitRows,cc.SplitCols=cc.TiledGrid3DAction.extend({_cols:0,_winSize:null,ctor:function(t,e){cc.GridAction.prototype.ctor.call(this),void 0!==e&&this.initWithDuration(t,e)},initWithDuration:function(t,e){return this._cols=e,cc.TiledGrid3DAction.prototype.initWithDuration.call(this,t,cc.size(e,1))},update:function(t){for(var e,i,n=this._gridSize.width,s=this._winSize.height,r=cc.p(0,0),o=0;o<n;++o)r.x=o,(e=this.originalTile(r)).bl.y+=(i=0==o%2?-1:1)*s*t,e.br.y+=i*s*t,e.tl.y+=i*s*t,e.tr.y+=i*s*t,this.setTile(r,e);cc.renderer.childrenOrderDirty=!0},startWithTarget:function(t){cc.TiledGrid3DAction.prototype.startWithTarget.call(this,t),this._winSize=cc.director.getWinSizeInPixels()}}),cc.splitCols=function(t,e){return new cc.SplitCols(t,e)},cc.SplitCols.create=cc.splitCols,cc.PageTurn3D=cc.Grid3DAction.extend({getGrid:function(){var t=new cc.Grid3D(this._gridSize,void 0,void 0,this._gridNodeTarget.getGridRect());return t.setNeedDepthTestForBlit(!0),t},clone:function(){var t=new cc.PageTurn3D;return t.initWithDuration(this._duration,this._gridSize),t},update:function(t){var e=-100-(e=Math.max(0,t-.25))*e*500,i=.5<(n=Math.sqrt(t))?Math.PI/2*n:Math.PI/2*(1-n);t=(2-t)*Math.PI;for(var n=Math.sin(i),i=Math.cos(i),s=this._gridSize,r=cc.p(0,0),o=0;o<=s.width;++o)for(var a=0;a<=s.height;++a){r.x=o,r.y=a;var c=this.getOriginalVertex(r),h=(c.x-=this.getGridRect().x,Math.sqrt(c.x*c.x+(c.y-e)*(c.y-e))),l=h*n,u=Math.asin(c.x/h)/n,d=Math.cos(u);c.x=u<=Math.PI?l*Math.sin(u):0,c.y=h+e-l*(1-d)*n,c.z=l*(1-d)*i,c.x=c.z*Math.sin(t)+c.x*Math.cos(t),c.z=c.z*Math.cos(t)-c.x*Math.cos(t),c.z/=7,c.z<.5&&(c.z=.5),c.x+=this.getGridRect().x,this.setVertex(r,c)}}}),cc.pageTurn3D=function(t,e){return new cc.PageTurn3D(t,e)},cc.PageTurn3D.create=cc.pageTurn3D,cc.ProgressTimer=cc.Node.extend({_type:null,_percentage:0,_sprite:null,_midPoint:null,_barChangeRate:null,_reverseDirection:!1,_className:"ProgressTimer",ctor:function(t){cc.Node.prototype.ctor.call(this),this._type=cc.ProgressTimer.TYPE_RADIAL,this._percentage=0,this._midPoint=cc.p(0,0),this._barChangeRate=cc.p(0,0),this._reverseDirection=!1,this._sprite=null,t&&this.initWithSprite(t)},onEnter:function(){this._super(),cc._renderType===cc.game.RENDER_TYPE_WEBGL&&(this._renderCmd.initCmd(),this._renderCmd._updateProgress())},cleanup:function(){cc._renderType===cc.game.RENDER_TYPE_WEBGL&&this._renderCmd.releaseData(),this._super()},getMidpoint:function(){return cc.p(this._midPoint.x,this._midPoint.y)},setMidpoint:function(t){this._midPoint=cc.pClamp(t,cc.p(0,0),cc.p(1,1))},getBarChangeRate:function(){return cc.p(this._barChangeRate.x,this._barChangeRate.y)},setBarChangeRate:function(t){this._barChangeRate=cc.pClamp(t,cc.p(0,0),cc.p(1,1))},getType:function(){return this._type},getPercentage:function(){return this._percentage},getSprite:function(){return this._sprite},setPercentage:function(t){this._percentage!==t&&(this._percentage=cc.clampf(t,0,100),this._renderCmd._updateProgress())},setOpacityModifyRGB:function(t){},isOpacityModifyRGB:function(){return!1},isReverseDirection:function(){return this._reverseDirection},setColor:function(t){this._sprite.color=t,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty)},setOpacity:function(t){this._sprite.opacity=t,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.opacityDirty)},getColor:function(){return this._sprite.color},getOpacity:function(){return this._sprite.opacity},setReverseProgress:function(t){this._reverseDirection!==t&&(this._reverseDirection=t,this._renderCmd.resetVertexData())},setSprite:function(t){this._sprite!==t&&((this._sprite=t)?(this.setContentSize(t.width,t.height),t.ignoreAnchorPointForPosition(!0)):this.setContentSize(0,0),this._renderCmd.resetVertexData())},setType:function(t){t!==this._type&&(this._type=t,this._renderCmd.resetVertexData())},setReverseDirection:function(t){this._reverseDirection!==t&&(this._reverseDirection=t,this._renderCmd.resetVertexData())},initWithSprite:function(t){return this.percentage=0,this.setAnchorPoint(.5,.5),this._type=cc.ProgressTimer.TYPE_RADIAL,this._reverseDirection=!1,this.midPoint=cc.p(.5,.5),this.barChangeRate=cc.p(1,1),this.setSprite(t),this._renderCmd.resetVertexData(),!0},_createRenderCmd:function(){return new(cc._renderType===cc.game.RENDER_TYPE_CANVAS?cc.ProgressTimer.CanvasRenderCmd:cc.ProgressTimer.WebGLRenderCmd)(this)}}),_p=cc.ProgressTimer.prototype,cc.defineGetterSetter(_p,"midPoint",_p.getMidpoint,_p.setMidpoint),cc.defineGetterSetter(_p,"barChangeRate",_p.getBarChangeRate,_p.setBarChangeRate),cc.defineGetterSetter(_p,"type",_p.getType,_p.setType),cc.defineGetterSetter(_p,"percentage",_p.getPercentage,_p.setPercentage),cc.defineGetterSetter(_p,"sprite",_p.getSprite,_p.setSprite),cc.defineGetterSetter(_p,"reverseDir",_p.isReverseDirection,_p.setReverseDirection),cc.ProgressTimer.create=function(t){return new cc.ProgressTimer(t)},cc.ProgressTimer.TEXTURE_COORDS_COUNT=4,cc.ProgressTimer.TEXTURE_COORDS=75,cc.ProgressTimer.TYPE_RADIAL=0,cc.ProgressTimer.TYPE_BAR=1,cc.ProgressTo=cc.ActionInterval.extend({_to:0,_from:0,ctor:function(t,e){cc.ActionInterval.prototype.ctor.call(this),void(this._from=this._to=0)!==e&&this.initWithDuration(t,e)},initWithDuration:function(t,e){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._to=e,!0)},clone:function(){var t=new cc.ProgressTo;return t.initWithDuration(this._duration,this._to),t},reverse:function(){return cc.log("cc.ProgressTo.reverse(): reverse hasn't been supported."),null},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._from=t.percentage},update:function(t){this.target instanceof cc.ProgressTimer&&(this.target.percentage=this._from+(this._to-this._from)*t)}}),cc.progressTo=function(t,e){return new cc.ProgressTo(t,e)},cc.ProgressTo.create=cc.progressTo,cc.ProgressFromTo=cc.ActionInterval.extend({_to:0,_from:0,ctor:function(t,e,i){cc.ActionInterval.prototype.ctor.call(this),void(this._from=this._to=0)!==i&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._to=i,this._from=e,!0)},clone:function(){var t=new cc.ProgressFromTo;return t.initWithDuration(this._duration,this._from,this._to),t},reverse:function(){return cc.progressFromTo(this._duration,this._to,this._from)},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t)},update:function(t){this.target instanceof cc.ProgressTimer&&(this.target.percentage=this._from+(this._to-this._from)*t)}}),cc.progressFromTo=function(t,e,i){return new cc.ProgressFromTo(t,e,i)},cc.ProgressFromTo.create=cc.progressFromTo,!function(){cc.ProgressTimer.CanvasRenderCmd=function(t){this._rootCtor(t),this._needDraw=!0,this._PI180=Math.PI/180,this._barRect=cc.rect(0,0,0,0),this._origin=cc.p(0,0),this._radius=0,this._endAngle=this._startAngle=270,this._counterClockWise=!1,this._canUseDirtyRegion=!0};var t=cc.ProgressTimer.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);t.constructor=cc.ProgressTimer.CanvasRenderCmd,t.rendering=function(t,e,i){var n,s,r=(t=t||cc._renderContext).getContext(),o=this._node,a=o._sprite,c=a._renderCmd._textureCoord,h=a._renderCmd._displayedOpacity/255;0!==c.width&&0!==c.height&&a._texture&&c.validRect&&0!=h&&(t.setTransform(this._worldTransform,e,i),t.setCompositeOperation(a._blendFuncStr),t.setGlobalAlpha(h),n=a._rect,e=(s=a._offsetPosition).x,i=-s.y-n.height,h=n.width,n=n.height,t.save(),a._flippedX&&(e=-e-h,r.scale(-1,1)),a._flippedY&&(i=s.y,r.scale(1,-1)),o._type===cc.ProgressTimer.TYPE_BAR?(o=this._barRect,r.beginPath(),r.rect(o.x,o.y,o.width,o.height),r.clip(),r.closePath()):o._type===cc.ProgressTimer.TYPE_RADIAL&&(o=this._origin.x,s=this._origin.y,r.beginPath(),r.arc(o,s,this._radius,this._PI180*this._startAngle,this._PI180*this._endAngle,this._counterClockWise),r.lineTo(o,s),r.clip(),r.closePath()),o=(a._renderCmd._textureToRender||a._texture).getHtmlElementObj(),a._renderCmd._colorized?r.drawImage(o,0,0,c.width,c.height,e,i,h,n):r.drawImage(o,c.renderX,c.renderY,c.width,c.height,e,i,h,n),t.restore(),cc.g_NumberOfDraws++)},t.releaseData=function(){},t.resetVertexData=function(){},t._updateProgress=function(){this.setDirtyFlag(cc.Node._dirtyFlags.contentDirty);var t,e,i,n=this._node,s=n._sprite,r=s.width,o=s.height,a=n._midPoint;n._type===cc.ProgressTimer.TYPE_RADIAL?(this._radius=Math.round(Math.sqrt(r*r+o*o)),e=!1,(i=this._origin).x=r*a.x,i.y=-o*a.y,n._reverseDirection?a=(t=270)-3.6*n._percentage:(a=-90,t=3.6*n._percentage-90),s._flippedX&&(i.x-=2*r*n._midPoint.x,a=-a-180,t=-t-180,e=!e),s._flippedY&&(i.y+=2*o*n._midPoint.y,e=!e,a=-a,t=-t),this._startAngle=a,this._endAngle=t,this._counterClockWise=e):(e=n._barChangeRate,i=n._percentage/100,n=this._barRect,e=cc.size(r*(1-e.x),o*(1-e.y)),i=cc.size((r-e.width)*i,(o-e.height)*i),e=cc.size(e.width+i.width,e.height+i.height),i=(t=cc.p(r*a.x,o*a.y)).x-e.width/2,.5<a.x&&e.width/2>=r-t.x&&(i=r-e.width),r=t.y-e.height/2,.5<a.y&&e.height/2>=o-t.y&&(r=o-e.height),n.x=0,o=1,s._flippedX&&(n.x-=e.width,o=-1),0<i&&(n.x+=i*o),n.y=0,o=1,s._flippedY&&(n.y+=e.height,o=-1),0<r&&(n.y-=r*o),n.width=e.width,n.height=-e.height)},t._syncStatus=function(t){var e,i,n,s,r=this._node;r._sprite&&(e=cc.Node._dirtyFlags,i=this._dirtyFlag,(n=t?t._node:null)&&n._cascadeColorEnabled&&t._dirtyFlag&e.colorDirty&&(i|=e.colorDirty),n&&n._cascadeOpacityEnabled&&t._dirtyFlag&e.opacityDirty&&(i|=e.opacityDirty),t&&t._dirtyFlag&e.transformDirty&&(i|=e.transformDirty),this._dirtyFlag=i,n=(s=(r=r._sprite._renderCmd)._dirtyFlag)&e.colorDirty,s&=e.opacityDirty,n&&(r._syncDisplayColor(),r._dirtyFlag&=~e.colorDirty,this._dirtyFlag&=~e.colorDirty),s&&(r._syncDisplayOpacity(),r._dirtyFlag&=~e.opacityDirty,this._dirtyFlag&=~e.opacityDirty),(n||s)&&r._updateColor(),i&e.transformDirty&&this.transform(t),i&e.orderDirty)&&(this._dirtyFlag&=~e.orderDirty)},t.updateStatus=function(){var t,e,i,n,s=this._node;s._sprite&&(t=cc.Node._dirtyFlags,e=this._dirtyFlag,i=(n=(s=s._sprite._renderCmd)._dirtyFlag)&t.colorDirty,n&=t.opacityDirty,i&&(s._updateDisplayColor(),s._dirtyFlag^=s._dirtyFlag&t.colorDirty,this._dirtyFlag^=this._dirtyFlag&t.colorDirty),n&&(s._updateDisplayOpacity(),s._dirtyFlag^=s._dirtyFlag&t.opacityDirty,this._dirtyFlag^=this._dirtyFlag&t.opacityDirty),(i||n)&&s._updateColor(),e&t.transformDirty&&this.transform(this.getParentRenderCmd(),!0),e&t.contentDirty&&this._notifyRegionStatus&&this._notifyRegionStatus(cc.Node.CanvasRenderCmd.RegionStatus.Dirty),this._dirtyFlag=0)}}(),!function(){cc.ProgressTimer.WebGLRenderCmd=function(t){this._rootCtor(t),this._progressDirty=this._needDraw=!0,this._bl=cc.p(),this._tr=cc.p(),this._transformUpdating=!1,this.initCmd()};var t=cc.ProgressTimer.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype);t.constructor=cc.ProgressTimer.WebGLRenderCmd,t.transform=function(t,e){this.originTransform(t,e);(t=this._node._sprite)._renderCmd.transform(this,e);var e=t._offsetPosition.x,i=e+t._rect.width,n=t._offsetPosition.y,t=n+t._rect.height,s=this._worldTransform;this._bl.x=e*s.a+n*s.c+s.tx,this._bl.y=e*s.b+n*s.d+s.ty,this._tr.x=i*s.a+t*s.c+s.tx,this._tr.y=i*s.b+t*s.d+s.ty,this._transformUpdating=!0,this._updateProgressData(),this._transformUpdating=!1},t.rendering=function(t){var e,i=this._node;t=t||cc._renderContext,0!==this._vertexDataCount&&i._sprite&&(this._glProgramState.apply(),this._shaderProgram._updateProjectionUniform(),e=i._sprite._blendFunc,cc.glBlendFunc(e.src,e.dst),cc.glBindTexture2D(i._sprite.texture),t.bindBuffer(t.ARRAY_BUFFER,this._vertexWebGLBuffer),t.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),t.enableVertexAttribArray(cc.VERTEX_ATTRIB_COLOR),t.enableVertexAttribArray(cc.VERTEX_ATTRIB_TEX_COORDS),this._vertexDataDirty&&(t.bufferSubData(t.ARRAY_BUFFER,0,this._float32View),this._vertexDataDirty=!1),e=cc.V3F_C4B_T2F.BYTES_PER_ELEMENT,t.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,3,t.FLOAT,!1,e,0),t.vertexAttribPointer(cc.VERTEX_ATTRIB_COLOR,4,t.UNSIGNED_BYTE,!0,e,12),t.vertexAttribPointer(cc.VERTEX_ATTRIB_TEX_COORDS,2,t.FLOAT,!1,e,16),i._type===cc.ProgressTimer.TYPE_RADIAL?t.drawArrays(t.TRIANGLE_FAN,0,this._vertexDataCount):i._type===cc.ProgressTimer.TYPE_BAR&&(i._reverseDirection?(t.drawArrays(t.TRIANGLE_STRIP,0,this._vertexDataCount/2),t.drawArrays(t.TRIANGLE_STRIP,4,this._vertexDataCount/2),cc.g_NumberOfDraws++):t.drawArrays(t.TRIANGLE_STRIP,0,this._vertexDataCount)),cc.g_NumberOfDraws++)},t._syncStatus=function(t){var e,i,n,s,r=this._node;r._sprite&&(e=cc.Node._dirtyFlags,i=this._dirtyFlag,(n=t?t._node:null)&&n._cascadeColorEnabled&&t._dirtyFlag&e.colorDirty&&(i|=e.colorDirty),n&&n._cascadeOpacityEnabled&&t._dirtyFlag&e.opacityDirty&&(i|=e.opacityDirty),t&&t._dirtyFlag&e.transformDirty&&(i|=e.transformDirty),n=((this._dirtyFlag=i)|(s=(r=r._sprite._renderCmd)._dirtyFlag))&e.colorDirty,s=(i|s)&e.opacityDirty,n&&(r._syncDisplayColor(),r._dirtyFlag&=~e.colorDirty,this._dirtyFlag&=~e.colorDirty),s&&(r._syncDisplayOpacity(),r._dirtyFlag&=~e.opacityDirty,this._dirtyFlag&=~e.opacityDirty),(n||s)&&this._updateColor(),i&e.transformDirty&&this.transform(t),i&e.textureDirty&&(this._updateProgressData(),this._dirtyFlag&=~e.textureDirty),r._dirtyFlag=0)},t.updateStatus=function(){var t,e,i,n,s=this._node;s._sprite&&(t=cc.Node._dirtyFlags,i=((e=this._dirtyFlag)|(n=(s=s._sprite._renderCmd)._dirtyFlag))&t.colorDirty,n=(e|n)&t.opacityDirty,i&&(s._updateDisplayColor(),s._dirtyFlag^=s._dirtyFlag&t.colorDirty,this._dirtyFlag^=this._dirtyFlag&t.colorDirty),n&&(s._updateDisplayOpacity(),s._dirtyFlag^=s._dirtyFlag&t.opacityDirty,this._dirtyFlag^=this._dirtyFlag&t.opacityDirty),(i||n)&&this._updateColor(),e&t.transformDirty&&this.transform(this.getParentRenderCmd(),!0),e&t.orderDirty&&(this._dirtyFlag^=this._dirtyFlag&t.orderDirty),e&t.textureDirty)&&(this._updateProgressData(),this._dirtyFlag^=this._dirtyFlag&t.textureDirty)},t.releaseData=function(){var t;this._vertexData&&(t=this._vertexWebGLBuffer,setTimeout(function(){cc._renderContext.deleteBuffer(t)},.1),this._vertexArrayBuffer=this._float32View=this._vertexData=this._vertexWebGLBuffer=null,this._vertexDataCount=0)},t.initCmd=function(){if(!this._vertexData){this._vertexWebGLBuffer=cc._renderContext.createBuffer();var t=cc.V3F_C4B_T2F.BYTES_PER_ELEMENT;this._vertexArrayBuffer=new ArrayBuffer(8*t),this._float32View=new Float32Array(this._vertexArrayBuffer),this._vertexData=[];for(var e=0;e<8;e++)this._vertexData[e]=new cc.V3F_C4B_T2F(null,null,null,this._vertexArrayBuffer,e*t);gl.bindBuffer(gl.ARRAY_BUFFER,this._vertexWebGLBuffer),gl.bufferData(gl.ARRAY_BUFFER,this._float32View,gl.DYNAMIC_DRAW),this._vertexDataCount=0,this._vertexDataDirty=!0,this._shaderProgram=cc.shaderCache.programForKey(cc.SHADER_SPRITE_POSITION_TEXTURECOLOR)}},t.resetVertexData=function(){this._vertexDataCount=0},t._updateProgressData=function(){var t=this._node._type;t===cc.ProgressTimer.TYPE_RADIAL?this._updateRadial():t===cc.ProgressTimer.TYPE_BAR&&this._updateBar(),this._vertexDataDirty=!0},t._updateProgress=function(){this.setDirtyFlag(cc.Node._dirtyFlags.textureDirty)},t._updateBar=function(){var t,e,i=this._node;i._sprite&&(e=i._percentage/100,t=i._barChangeRate,t=cc.pMult(cc.p(1-t.x+e*t.x,1-t.y+e*t.y),.5),e=cc.pSub(i._midPoint,t),i=cc.pAdd(i._midPoint,t),e.x<0&&(i.x+=-e.x,e.x=0),1<i.x&&(e.x-=i.x-1,i.x=1),e.y<0&&(i.y+=-e.y,e.y=0),1<i.y&&(e.y-=i.y-1,i.y=1),this._reverseDirection?(t=this._vertexData,this._vertexDataCount||(this._vertexDataCount=8,this._textureCoordFromAlphaPoint(t[0].texCoords,0,1),this._vertexFromAlphaPoint(t[0].vertices,0,1),this._textureCoordFromAlphaPoint(t[1].texCoords,0,0),this._vertexFromAlphaPoint(t[1].vertices,0,0),this._textureCoordFromAlphaPoint(t[6].texCoords,1,1),this._vertexFromAlphaPoint(t[6].vertices,1,1),this._textureCoordFromAlphaPoint(t[7].texCoords,1,0),this._vertexFromAlphaPoint(t[7].vertices,1,0)),this._textureCoordFromAlphaPoint(t[2].texCoords,e.x,i.y),this._vertexFromAlphaPoint(t[2].vertices,e.x,i.y),this._textureCoordFromAlphaPoint(t[3].texCoords,e.x,e.y),this._vertexFromAlphaPoint(t[3].vertices,e.x,e.y),this._textureCoordFromAlphaPoint(t[4].texCoords,i.x,i.y),this._vertexFromAlphaPoint(t[4].vertices,i.x,i.y),this._textureCoordFromAlphaPoint(t[5].texCoords,i.x,e.y),this._vertexFromAlphaPoint(t[5].vertices,i.x,e.y)):(this._vertexDataCount||(this._vertexDataCount=4),t=this._vertexData,this._textureCoordFromAlphaPoint(t[0].texCoords,e.x,i.y),this._vertexFromAlphaPoint(t[0].vertices,e.x,i.y),this._textureCoordFromAlphaPoint(t[1].texCoords,e.x,e.y),this._vertexFromAlphaPoint(t[1].vertices,e.x,e.y),this._textureCoordFromAlphaPoint(t[2].texCoords,i.x,i.y),this._vertexFromAlphaPoint(t[2].vertices,i.x,i.y),this._textureCoordFromAlphaPoint(t[3].texCoords,i.x,e.y),this._vertexFromAlphaPoint(t[3].vertices,i.x,e.y)),this._updateColor())},t._updateRadial=function(){if((i=this._node)._sprite){var t=i._midPoint,e=(o=i._percentage/100,2*cc.PI*(i._reverseDirection?o:1-o)),i=cc.p(t.x,1),n=cc.pRotateByAngle(i,t,e),e=0;if(0===o)n=i,e=0;else if(1===o)n=i,e=4;else{for(var s=cc.FLT_MAX,r=cc.ProgressTimer.TEXTURE_COORDS_COUNT,o=0;o<=r;++o){var a=(o+(r-1))%r,c=this._boundaryTexCoord(o%r),a=this._boundaryTexCoord(a),h=(0===o?a=cc.pLerp(c,a,1-t.x):4===o&&(c=cc.pLerp(c,a,1-t.x)),cc.p(0,0));cc.pLineIntersect(c,a,t,n,h)&&(0!==o&&4!==o||0<=h.x&&h.x<=1)&&0<=h.y&&h.y<s&&(s=h.y,e=o)}n=cc.pAdd(t,cc.pMult(cc.pSub(n,t),s))}if(o=!0,this._vertexDataCount!==e+3&&(o=!1,this._vertexDataCount=e+3),this._updateColor(),s=this._vertexData,this._transformUpdating||!o)for(this._textureCoordFromAlphaPoint(s[0].texCoords,t.x,t.y),this._vertexFromAlphaPoint(s[0].vertices,t.x,t.y),this._textureCoordFromAlphaPoint(s[1].texCoords,i.x,i.y),this._vertexFromAlphaPoint(s[1].vertices,i.x,i.y),o=0;o<e;o++)t=this._boundaryTexCoord(o),this._textureCoordFromAlphaPoint(s[o+2].texCoords,t.x,t.y),this._vertexFromAlphaPoint(s[o+2].vertices,t.x,t.y);this._textureCoordFromAlphaPoint(s[this._vertexDataCount-1].texCoords,n.x,n.y),this._vertexFromAlphaPoint(s[this._vertexDataCount-1].vertices,n.x,n.y)}},t._boundaryTexCoord=function(t){var e;return t<cc.ProgressTimer.TEXTURE_COORDS_COUNT?(e=cc.ProgressTimer.TEXTURE_COORDS,this._node._reverseDirection?cc.p(e>>7-(t<<1)&1,e>>7-(1+(t<<1))&1):cc.p(e>>1+(t<<1)&1,e>>(t<<1)&1)):cc.p(0,0)},t._textureCoordFromAlphaPoint=function(t,e,i){var n,s,r=this._node._sprite;r?(n=(s=r._renderCmd._vertices)[1],s=s[2],n=cc.p(n.u,n.v),s=cc.p(s.u,s.v),r.textureRectRotated&&(r=e,e=i,i=r),t.u=n.x*(1-e)+s.x*e,t.v=n.y*(1-i)+s.y*i):(t.u=0,t.v=0)},t._vertexFromAlphaPoint=function(t,e,i){t.x=this._bl.x*(1-e)+this._tr.x*e,t.y=this._bl.y*(1-i)+this._tr.y*i,t.z=this._node._vertexZ},t._updateColor=function(){var t=this._node._sprite;if(this._vertexDataCount&&t){var e=this._displayedColor,i=(s=t._renderCmd._displayedColor).r,n=s.g,s=s.b,r=t._renderCmd._displayedOpacity/255;for(t._opacityModifyRGB&&(i*=r,n*=r,s*=r),e.r=i,e.g=n,e.b=s,e.a=t._renderCmd._displayedOpacity,t=this._vertexData,i=0,n=this._vertexDataCount;i<n;++i)t[i].colors=e;this._vertexDataDirty=!0}}}(),cc.SCENE_FADE=4208917214,cc.TRANSITION_ORIENTATION_LEFT_OVER=0,cc.TRANSITION_ORIENTATION_RIGHT_OVER=1,cc.TRANSITION_ORIENTATION_UP_OVER=0,cc.TRANSITION_ORIENTATION_DOWN_OVER=1,cc.TransitionScene=cc.Scene.extend({_inScene:null,_outScene:null,_duration:null,_isInSceneOnTop:!1,_isSendCleanupToScene:!1,_className:"TransitionScene",ctor:function(t,e){cc.Scene.prototype.ctor.call(this),void 0!==t&&void 0!==e&&this.initWithDuration(t,e)},_setNewScene:function(t){this.unschedule(this._setNewScene),t=cc.director,this._isSendCleanupToScene=t.isSendCleanupToScene(),t.runScene(this._inScene),cc.eventManager.setEnabled(!0),this._outScene.visible=!0},_sceneOrder:function(){this._isInSceneOnTop=!0},visit:function(){(this._isInSceneOnTop?(this._outScene.visit(),this._inScene):(this._inScene.visit(),this._outScene)).visit(),cc.Node.prototype.visit.call(this)},onEnter:function(){cc.Node.prototype.onEnter.call(this),cc.eventManager.setEnabled(!1),this._outScene._performRecursive(cc.Node._stateCallbackType.onExitTransitionDidStart),this._inScene._performRecursive(cc.Node._stateCallbackType.onEnter)},onExit:function(){cc.Node.prototype.onExit.call(this),cc.eventManager.setEnabled(!0),this._outScene._performRecursive(cc.Node._stateCallbackType.onExit),this._inScene._performRecursive(cc.Node._stateCallbackType.onEnterTransitionDidFinish)},cleanup:function(){cc.Node.prototype.cleanup.call(this),this._isSendCleanupToScene&&this._outScene._performRecursive(cc.Node._stateCallbackType.cleanup)},initWithDuration:function(t,e){if(!e)throw Error("cc.TransitionScene.initWithDuration(): Argument scene must be non-nil");if(this.init()){if(this._duration=t,this.attr({x:0,y:0,anchorX:0,anchorY:0}),this._inScene=e,this._outScene=cc.director.getRunningScene(),this._outScene||(this._outScene=new cc.Scene,this._outScene.init()),this._inScene===this._outScene)throw Error("cc.TransitionScene.initWithDuration(): Incoming scene must be different from the outgoing scene");return this._sceneOrder(),!0}return!1},finish:function(){this._inScene.attr({visible:!0,x:0,y:0,scale:1,rotation:0}),this._outScene.attr({visible:!1,x:0,y:0,scale:1,rotation:0}),this.schedule(this._setNewScene,0)},hideOutShowIn:function(){this._inScene.visible=!0,this._outScene.visible=!1}}),cc.TransitionScene.create=function(t,e){return new cc.TransitionScene(t,e)},cc.TransitionSceneOriented=cc.TransitionScene.extend({_orientation:0,ctor:function(t,e,i){cc.TransitionScene.prototype.ctor.call(this),null!=i&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){return cc.TransitionScene.prototype.initWithDuration.call(this,t,e)&&(this._orientation=i),!0}}),cc.TransitionSceneOriented.create=function(t,e,i){return new cc.TransitionSceneOriented(t,e,i)},cc.TransitionRotoZoom=cc.TransitionScene.extend({ctor:function(t,e){cc.TransitionScene.prototype.ctor.call(this),e&&this.initWithDuration(t,e)},onEnter:function(){cc.TransitionScene.prototype.onEnter.call(this),this._inScene.attr({scale:.001,anchorX:.5,anchorY:.5}),this._outScene.attr({scale:1,anchorX:.5,anchorY:.5});var t=cc.sequence(cc.spawn(cc.scaleBy(this._duration/2,.001),cc.rotateBy(this._duration/2,720)),cc.delayTime(this._duration/2));this._outScene.runAction(t),this._inScene.runAction(cc.sequence(t.reverse(),cc.callFunc(this.finish,this)))}}),cc.TransitionRotoZoom.create=function(t,e){return new cc.TransitionRotoZoom(t,e)},cc.TransitionJumpZoom=cc.TransitionScene.extend({ctor:function(t,e){cc.TransitionScene.prototype.ctor.call(this),e&&this.initWithDuration(t,e)},onEnter:function(){cc.TransitionScene.prototype.onEnter.call(this);var t=cc.director.getWinSize(),e=(this._inScene.attr({scale:.5,x:t.width,y:0,anchorX:.5,anchorY:.5}),this._outScene.anchorX=.5,this._outScene.anchorY=.5,cc.jumpBy(this._duration/4,cc.p(-t.width,0),t.width/4,2)),i=cc.scaleTo(this._duration/4,1),t=cc.scaleTo(this._duration/4,.5),t=cc.sequence(t,e),e=cc.sequence(e,i),i=cc.delayTime(this._duration/2);this._outScene.runAction(t),this._inScene.runAction(cc.sequence(i,e,cc.callFunc(this.finish,this)))}}),cc.TransitionJumpZoom.create=function(t,e){return new cc.TransitionJumpZoom(t,e)},cc.TransitionMoveInL=cc.TransitionScene.extend({ctor:function(t,e){cc.TransitionScene.prototype.ctor.call(this),e&&this.initWithDuration(t,e)},onEnter:function(){cc.TransitionScene.prototype.onEnter.call(this),this.initScenes();var t=this.action();this._inScene.runAction(cc.sequence(this.easeActionWithAction(t),cc.callFunc(this.finish,this)))},initScenes:function(){this._inScene.setPosition(-cc.director.getWinSize().width,0)},action:function(){return cc.moveTo(this._duration,cc.p(0,0))},easeActionWithAction:function(t){return new cc.EaseOut(t,2)}}),cc.TransitionMoveInL.create=function(t,e){return new cc.TransitionMoveInL(t,e)},cc.TransitionMoveInR=cc.TransitionMoveInL.extend({ctor:function(t,e){cc.TransitionMoveInL.prototype.ctor.call(this),e&&this.initWithDuration(t,e)},initScenes:function(){this._inScene.setPosition(cc.director.getWinSize().width,0)}}),cc.TransitionMoveInR.create=function(t,e){return new cc.TransitionMoveInR(t,e)},cc.TransitionMoveInT=cc.TransitionMoveInL.extend({ctor:function(t,e){cc.TransitionMoveInL.prototype.ctor.call(this),e&&this.initWithDuration(t,e)},initScenes:function(){this._inScene.setPosition(0,cc.director.getWinSize().height)}}),cc.TransitionMoveInT.create=function(t,e){return new cc.TransitionMoveInT(t,e)},cc.TransitionMoveInB=cc.TransitionMoveInL.extend({ctor:function(t,e){cc.TransitionMoveInL.prototype.ctor.call(this),e&&this.initWithDuration(t,e)},initScenes:function(){this._inScene.setPosition(0,-cc.director.getWinSize().height)}}),cc.TransitionMoveInB.create=function(t,e){return new cc.TransitionMoveInB(t,e)},cc.ADJUST_FACTOR=.5,cc.TransitionSlideInL=cc.TransitionScene.extend({ctor:function(t,e){cc.TransitionScene.prototype.ctor.call(this),e&&this.initWithDuration(t,e)},_sceneOrder:function(){this._isInSceneOnTop=!1},onEnter:function(){cc.TransitionScene.prototype.onEnter.call(this),this.initScenes();var t=this.action(),e=this.action(),t=cc.sequence(this.easeActionWithAction(t),cc.callFunc(this.finish,this)),e=this.easeActionWithAction(e);this._inScene.runAction(t),this._outScene.runAction(e)},initScenes:function(){this._inScene.setPosition(-cc.director.getWinSize().width+cc.ADJUST_FACTOR,0)},action:function(){return cc.moveBy(this._duration,cc.p(cc.director.getWinSize().width-cc.ADJUST_FACTOR,0))},easeActionWithAction:function(t){return new cc.EaseInOut(t,2)}}),cc.TransitionSlideInL.create=function(t,e){return new cc.TransitionSlideInL(t,e)},cc.TransitionSlideInR=cc.TransitionSlideInL.extend({ctor:function(t,e){cc.TransitionSlideInL.prototype.ctor.call(this),e&&this.initWithDuration(t,e)},_sceneOrder:function(){this._isInSceneOnTop=!0},initScenes:function(){this._inScene.setPosition(cc.director.getWinSize().width-cc.ADJUST_FACTOR,0)},action:function(){return cc.moveBy(this._duration,cc.p(-(cc.director.getWinSize().width-cc.ADJUST_FACTOR),0))}}),cc.TransitionSlideInR.create=function(t,e){return new cc.TransitionSlideInR(t,e)},cc.TransitionSlideInB=cc.TransitionSlideInL.extend({ctor:function(t,e){cc.TransitionSlideInL.prototype.ctor.call(this),e&&this.initWithDuration(t,e)},_sceneOrder:function(){this._isInSceneOnTop=!1},initScenes:function(){this._inScene.setPosition(0,-(cc.director.getWinSize().height-cc.ADJUST_FACTOR))},action:function(){return cc.moveBy(this._duration,cc.p(0,cc.director.getWinSize().height-cc.ADJUST_FACTOR))}}),cc.TransitionSlideInB.create=function(t,e){return new cc.TransitionSlideInB(t,e)},cc.TransitionSlideInT=cc.TransitionSlideInL.extend({ctor:function(t,e){cc.TransitionSlideInL.prototype.ctor.call(this),e&&this.initWithDuration(t,e)},_sceneOrder:function(){this._isInSceneOnTop=!0},initScenes:function(){this._inScene.setPosition(0,cc.director.getWinSize().height-cc.ADJUST_FACTOR)},action:function(){return cc.moveBy(this._duration,cc.p(0,-(cc.director.getWinSize().height-cc.ADJUST_FACTOR)))}}),cc.TransitionSlideInT.create=function(t,e){return new cc.TransitionSlideInT(t,e)},cc.TransitionShrinkGrow=cc.TransitionScene.extend({ctor:function(t,e){cc.TransitionScene.prototype.ctor.call(this),e&&this.initWithDuration(t,e)},onEnter:function(){cc.TransitionScene.prototype.onEnter.call(this),this._inScene.attr({scale:.001,anchorX:2/3,anchorY:.5}),this._outScene.attr({scale:1,anchorX:1/3,anchorY:.5});var t=cc.scaleTo(this._duration,.01),e=cc.scaleTo(this._duration,1);this._inScene.runAction(cc.sequence(this.easeActionWithAction(e),cc.callFunc(this.finish,this))),this._outScene.runAction(this.easeActionWithAction(t))},easeActionWithAction:function(t){return new cc.EaseOut(t,2)}}),cc.TransitionShrinkGrow.create=function(t,e){return new cc.TransitionShrinkGrow(t,e)},cc.TransitionFade=cc.TransitionScene.extend({_color:null,ctor:function(t,e,i){cc.TransitionScene.prototype.ctor.call(this),this._color=cc.color(),e&&this.initWithDuration(t,e,i)},onEnter:function(){cc.TransitionScene.prototype.onEnter.call(this);var t=new cc.LayerColor(this._color),t=(this._inScene.visible=!1,this.addChild(t,2,cc.SCENE_FADE),this.getChildByTag(cc.SCENE_FADE)),e=cc.sequence(cc.fadeIn(this._duration/2),cc.callFunc(this.hideOutShowIn,this),cc.fadeOut(this._duration/2),cc.callFunc(this.finish,this));t.runAction(e)},onExit:function(){cc.TransitionScene.prototype.onExit.call(this),this.removeChildByTag(cc.SCENE_FADE,!1)},initWithDuration:function(t,e,i){return i=i||cc.color.BLACK,cc.TransitionScene.prototype.initWithDuration.call(this,t,e)&&(this._color.r=i.r,this._color.g=i.g,this._color.b=i.b,this._color.a=0),!0}}),cc.TransitionFade.create=function(t,e,i){return new cc.TransitionFade(t,e,i)},cc.TransitionCrossFade=cc.TransitionScene.extend({ctor:function(t,e){cc.TransitionScene.prototype.ctor.call(this),e&&this.initWithDuration(t,e)},onEnter:function(){cc.TransitionScene.prototype.onEnter.call(this);var t=cc.color(0,0,0,0),e=cc.director.getWinSize(),t=new cc.LayerColor(t),i=new cc.RenderTexture(e.width,e.height),n=(i.sprite.anchorX=.5,i.sprite.anchorY=.5,i.attr({x:e.width/2,y:e.height/2,anchorX:.5,anchorY:.5}),i.begin(),this._inScene.visit(),i.end(),new cc.RenderTexture(e.width,e.height));n.setPosition(e.width/2,e.height/2),n.sprite.anchorX=n.anchorX=.5,n.sprite.anchorY=n.anchorY=.5,n.begin(),this._outScene.visit(),n.end(),i.sprite.setBlendFunc(cc.ONE,cc.ONE),n.sprite.setBlendFunc(cc.SRC_ALPHA,cc.ONE_MINUS_SRC_ALPHA),t.addChild(i),t.addChild(n),i.sprite.opacity=255,n.sprite.opacity=255,e=cc.sequence(cc.fadeTo(this._duration,0),cc.callFunc(this.hideOutShowIn,this),cc.callFunc(this.finish,this)),n.sprite.runAction(e),this.addChild(t,2,cc.SCENE_FADE)},onExit:function(){this.removeChildByTag(cc.SCENE_FADE,!1),cc.TransitionScene.prototype.onExit.call(this)}}),cc.TransitionCrossFade.create=function(t,e){return new cc.TransitionCrossFade(t,e)},cc.TransitionTurnOffTiles=cc.TransitionScene.extend({_gridProxy:null,ctor:function(t,e){cc.TransitionScene.prototype.ctor.call(this),this._gridProxy=new cc.NodeGrid,e&&this.initWithDuration(t,e)},_sceneOrder:function(){this._isInSceneOnTop=!1},onEnter:function(){cc.TransitionScene.prototype.onEnter.call(this),this._gridProxy.setTarget(this._outScene),this._gridProxy._performRecursive(cc.Node._stateCallbackType.onEnter);var t=cc.director.getWinSize(),t=cc.turnOffTiles(this._duration,cc.size(0|t.width/t.height*12,12)),t=this.easeActionWithAction(t);this._gridProxy.runAction(cc.sequence(t,cc.callFunc(this.finish,this),cc.stopGrid()))},visit:function(){this._inScene.visit(),this._gridProxy.visit()},easeActionWithAction:function(t){return t}}),cc.TransitionTurnOffTiles.create=function(t,e){return new cc.TransitionTurnOffTiles(t,e)},cc.TransitionSplitCols=cc.TransitionScene.extend({_gridProxy:null,_switchTargetToInscene:function(){this._gridProxy.setTarget(this._inScene)},ctor:function(t,e){cc.TransitionScene.prototype.ctor.call(this),this._gridProxy=new cc.NodeGrid,e&&this.initWithDuration(t,e)},onEnter:function(){cc.TransitionScene.prototype.onEnter.call(this),this._gridProxy.setTarget(this._outScene),this._gridProxy._performRecursive(cc.Node._stateCallbackType.onEnter);var t=this.action(),t=cc.sequence(t,cc.callFunc(this._switchTargetToInscene,this),t.reverse());this._gridProxy.runAction(cc.sequence(this.easeActionWithAction(t),cc.callFunc(this.finish,this),cc.stopGrid()))},onExit:function(){this._gridProxy.setTarget(null),this._gridProxy._performRecursive(cc.Node._stateCallbackType.onExit),cc.TransitionScene.prototype.onExit.call(this)},visit:function(){this._gridProxy.visit()},easeActionWithAction:function(t){return new cc.EaseInOut(t,3)},action:function(){return cc.splitCols(this._duration/2,3)}}),cc.TransitionSplitCols.create=function(t,e){return new cc.TransitionSplitCols(t,e)},cc.TransitionSplitRows=cc.TransitionSplitCols.extend({ctor:function(t,e){cc.TransitionSplitCols.prototype.ctor.call(this),e&&this.initWithDuration(t,e)},action:function(){return cc.splitRows(this._duration/2,3)}}),cc.TransitionSplitRows.create=function(t,e){return new cc.TransitionSplitRows(t,e)},cc.TransitionFadeTR=cc.TransitionScene.extend({_gridProxy:null,ctor:function(t,e){cc.TransitionScene.prototype.ctor.call(this),this._gridProxy=new cc.NodeGrid,e&&this.initWithDuration(t,e)},_sceneOrder:function(){this._isInSceneOnTop=!1},onEnter:function(){cc.TransitionScene.prototype.onEnter.call(this),this._gridProxy.setTarget(this._outScene),this._gridProxy._performRecursive(cc.Node._stateCallbackType.onEnter);var t=cc.director.getWinSize(),t=this.actionWithSize(cc.size(0|t.width/t.height*12,12));this._gridProxy.runAction(cc.sequence(this.easeActionWithAction(t),cc.callFunc(this.finish,this),cc.stopGrid()))},visit:function(){this._inScene.visit(),this._gridProxy.visit()},easeActionWithAction:function(t){return t},actionWithSize:function(t){return cc.fadeOutTRTiles(this._duration,t)}}),cc.TransitionFadeTR.create=function(t,e){return new cc.TransitionFadeTR(t,e)},cc.TransitionFadeBL=cc.TransitionFadeTR.extend({ctor:function(t,e){cc.TransitionFadeTR.prototype.ctor.call(this),e&&this.initWithDuration(t,e)},actionWithSize:function(t){return cc.fadeOutBLTiles(this._duration,t)}}),cc.TransitionFadeBL.create=function(t,e){return new cc.TransitionFadeBL(t,e)},cc.TransitionFadeUp=cc.TransitionFadeTR.extend({ctor:function(t,e){cc.TransitionFadeTR.prototype.ctor.call(this),e&&this.initWithDuration(t,e)},actionWithSize:function(t){return new cc.FadeOutUpTiles(this._duration,t)}}),cc.TransitionFadeUp.create=function(t,e){return new cc.TransitionFadeUp(t,e)},cc.TransitionFadeDown=cc.TransitionFadeTR.extend({ctor:function(t,e){cc.TransitionFadeTR.prototype.ctor.call(this),e&&this.initWithDuration(t,e)},actionWithSize:function(t){return cc.fadeOutDownTiles(this._duration,t)}}),cc.TransitionFadeDown.create=function(t,e){return new cc.TransitionFadeDown(t,e)},cc.SCENE_RADIAL=49153,cc.TransitionProgress=cc.TransitionScene.extend({_to:0,_from:0,_sceneToBeModified:null,_className:"TransitionProgress",ctor:function(t,e){cc.TransitionScene.prototype.ctor.call(this),e&&this.initWithDuration(t,e)},_setAttrs:function(t,e,i){t.attr({x:e,y:i,anchorX:.5,anchorY:.5})},onEnter:function(){cc.TransitionScene.prototype.onEnter.call(this),this._setupTransition();var t=cc.director.getWinSize(),e=new cc.RenderTexture(t.width,t.height);e.sprite.anchorX=.5,e.sprite.anchorY=.5,this._setAttrs(e,t.width/2,t.height/2),e.clear(0,0,0,1),e.begin(),this._sceneToBeModified.visit(),e.end(),this._sceneToBeModified===this._outScene&&this.hideOutShowIn(),t=this._progressTimerNodeWithRenderTexture(e),e=cc.sequence(cc.progressFromTo(this._duration,this._from,this._to),cc.callFunc(this.finish,this)),t.runAction(e),this.addChild(t,2,cc.SCENE_RADIAL)},onExit:function(){this.removeChildByTag(cc.SCENE_RADIAL,!0),cc.TransitionScene.prototype.onExit.call(this)},_setupTransition:function(){this._sceneToBeModified=this._outScene,this._from=100,this._to=0},_progressTimerNodeWithRenderTexture:function(t){return cc.log("cc.TransitionProgress._progressTimerNodeWithRenderTexture(): should be overridden in subclass"),null},_sceneOrder:function(){this._isInSceneOnTop=!1}}),cc.TransitionProgress.create=function(t,e){return new cc.TransitionProgress(t,e)},cc.TransitionProgressRadialCCW=cc.TransitionProgress.extend({ctor:function(t,e){cc.TransitionProgress.prototype.ctor.call(this),e&&this.initWithDuration(t,e)},_progressTimerNodeWithRenderTexture:function(t){var e=cc.director.getWinSize();return t=new cc.ProgressTimer(t.sprite),cc._renderType===cc.game.RENDER_TYPE_WEBGL&&(t.sprite.flippedY=!0),t.type=cc.ProgressTimer.TYPE_RADIAL,t.reverseDir=!1,t.percentage=100,this._setAttrs(t,e.width/2,e.height/2),t}}),cc.TransitionProgressRadialCCW.create=function(t,e){return new cc.TransitionProgressRadialCCW(t,e)},cc.TransitionProgressRadialCW=cc.TransitionProgress.extend({ctor:function(t,e){cc.TransitionProgress.prototype.ctor.call(this),e&&this.initWithDuration(t,e)},_progressTimerNodeWithRenderTexture:function(t){var e=cc.director.getWinSize();return t=new cc.ProgressTimer(t.sprite),cc._renderType===cc.game.RENDER_TYPE_WEBGL&&(t.sprite.flippedY=!0),t.type=cc.ProgressTimer.TYPE_RADIAL,t.reverseDir=!0,t.percentage=100,this._setAttrs(t,e.width/2,e.height/2),t}}),cc.TransitionProgressRadialCW.create=function(t,e){var i=new cc.TransitionProgressRadialCW;return null!==i&&i.initWithDuration(t,e)?i:new cc.TransitionProgressRadialCW(t,e)},cc.TransitionProgressHorizontal=cc.TransitionProgress.extend({ctor:function(t,e){cc.TransitionProgress.prototype.ctor.call(this),e&&this.initWithDuration(t,e)},_progressTimerNodeWithRenderTexture:function(t){var e=cc.director.getWinSize();return t=new cc.ProgressTimer(t.sprite),cc._renderType===cc.game.RENDER_TYPE_WEBGL&&(t.sprite.flippedY=!0),t.type=cc.ProgressTimer.TYPE_BAR,t.midPoint=cc.p(1,0),t.barChangeRate=cc.p(1,0),t.percentage=100,this._setAttrs(t,e.width/2,e.height/2),t}}),cc.TransitionProgressHorizontal.create=function(t,e){return new cc.TransitionProgressHorizontal(t,e)},cc.TransitionProgressVertical=cc.TransitionProgress.extend({ctor:function(t,e){cc.TransitionProgress.prototype.ctor.call(this),e&&this.initWithDuration(t,e)},_progressTimerNodeWithRenderTexture:function(t){var e=cc.director.getWinSize();return t=new cc.ProgressTimer(t.sprite),cc._renderType===cc.game.RENDER_TYPE_WEBGL&&(t.sprite.flippedY=!0),t.type=cc.ProgressTimer.TYPE_BAR,t.midPoint=cc.p(0,0),t.barChangeRate=cc.p(0,1),t.percentage=100,this._setAttrs(t,e.width/2,e.height/2),t}}),cc.TransitionProgressVertical.create=function(t,e){return new cc.TransitionProgressVertical(t,e)},cc.TransitionProgressInOut=cc.TransitionProgress.extend({ctor:function(t,e){cc.TransitionProgress.prototype.ctor.call(this),e&&this.initWithDuration(t,e)},_progressTimerNodeWithRenderTexture:function(t){var e=cc.director.getWinSize();return t=new cc.ProgressTimer(t.sprite),cc._renderType===cc.game.RENDER_TYPE_WEBGL&&(t.sprite.flippedY=!0),t.type=cc.ProgressTimer.TYPE_BAR,t.midPoint=cc.p(.5,.5),t.barChangeRate=cc.p(1,1),t.percentage=0,this._setAttrs(t,e.width/2,e.height/2),t},_sceneOrder:function(){this._isInSceneOnTop=!1},_setupTransition:function(){this._sceneToBeModified=this._inScene,this._from=0,this._to=100}}),cc.TransitionProgressInOut.create=function(t,e){return new cc.TransitionProgressInOut(t,e)},cc.TransitionProgressOutIn=cc.TransitionProgress.extend({ctor:function(t,e){cc.TransitionProgress.prototype.ctor.call(this),e&&this.initWithDuration(t,e)},_progressTimerNodeWithRenderTexture:function(t){var e=cc.director.getWinSize();return t=new cc.ProgressTimer(t.sprite),cc._renderType===cc.game.RENDER_TYPE_WEBGL&&(t.sprite.flippedY=!0),t.type=cc.ProgressTimer.TYPE_BAR,t.midPoint=cc.p(.5,.5),t.barChangeRate=cc.p(1,1),t.percentage=100,this._setAttrs(t,e.width/2,e.height/2),t}}),cc.TransitionProgressOutIn.create=function(t,e){return new cc.TransitionProgressOutIn(t,e)},cc.TransitionPageTurn=cc.TransitionScene.extend({ctor:function(t,e,i){cc.TransitionScene.prototype.ctor.call(this),this._gridProxy=new cc.NodeGrid,this.initWithDuration(t,e,i)},_back:!0,_gridProxy:null,_className:"TransitionPageTurn",initWithDuration:function(t,e,i){return this._back=i,cc.TransitionScene.prototype.initWithDuration.call(this,t,e),!0},actionWithSize:function(t){return this._back?cc.reverseTime(cc.pageTurn3D(this._duration,t)):cc.pageTurn3D(this._duration,t)},onEnter:function(){cc.TransitionScene.prototype.onEnter.call(this);var t=(e=cc.director.getWinSize()).width>e.height?(e=16,12):(e=12,16),e=this.actionWithSize(cc.size(e,t));t=this._gridProxy,this._back?(t.setTarget(this._inScene),t._performRecursive(cc.Node._stateCallbackType.onEnter),this._inScene.visible=!1,t.runAction(cc.sequence(e,cc.callFunc(this.finish,this),cc.stopGrid())),this._inScene.runAction(cc.show())):(t.setTarget(this._outScene),t._performRecursive(cc.Node._stateCallbackType.onEnter),t.runAction(cc.sequence(e,cc.callFunc(this.finish,this),cc.stopGrid())))},visit:function(){(this._back?this._outScene:this._inScene).visit(),this._gridProxy.visit()},_sceneOrder:function(){this._isInSceneOnTop=this._back}}),cc.TransitionPageTurn.create=function(t,e,i){return new cc.TransitionPageTurn(t,e,i)},cc.Codec={name:"Jacob__Codec"},cc.unzip=function(){return cc.Codec.GZip.gunzip.apply(cc.Codec.GZip,arguments)},cc.unzipBase64=function(){var t=cc.Codec.Base64.decode.apply(cc.Codec.Base64,arguments);return cc.Codec.GZip.gunzip.apply(cc.Codec.GZip,[t])},cc.unzipBase64AsArray=function(t,e){e=e||1;for(var i,n=this.unzipBase64(t),s=[],r=0,o=n.length/e;r<o;r++)for(s[r]=0,i=e-1;0<=i;--i)s[r]+=n.charCodeAt(r*e+i)<<8*i;return s},cc.unzipAsArray=function(t,e){e=e||1;for(var i,n=this.unzip(t),s=[],r=0,o=n.length/e;r<o;r++)for(s[r]=0,i=e-1;0<=i;--i)s[r]+=n.charCodeAt(r*e+i)<<8*i;return s},cc.StringToArray=function(t){t=t.split(",");for(var e=[],i=0;i<t.length;i++)e.push(parseInt(t[i]));return e},cc.Codec.Base64={name:"Jacob__Codec__Base64"},cc.Codec.Base64._keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",cc.Codec.Base64.decode=function(t){var e,i,n,s,r,o=[],a=0;for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");a<t.length;)e=this._keyStr.indexOf(t.charAt(a++))<<2|(i=this._keyStr.indexOf(t.charAt(a++)))>>4,i=(15&i)<<4|(s=this._keyStr.indexOf(t.charAt(a++)))>>2,n=(3&s)<<6|(r=this._keyStr.indexOf(t.charAt(a++))),o.push(String.fromCharCode(e)),64!==s&&o.push(String.fromCharCode(i)),64!==r&&o.push(String.fromCharCode(n));return o.join("")},cc.Codec.Base64.decodeAsArray=function(t,e){for(var i,n=this.decode(t),s=[],r=0,o=n.length/e;r<o;r++)for(s[r]=0,i=e-1;0<=i;--i)s[r]+=n.charCodeAt(r*e+i)<<8*i;return s},cc.uint8ArrayToUint32Array=function(t){if(0!=t.length%4)return null;for(var e=t.length/4,i=window.Uint32Array?new Uint32Array(e):[],n=0;n<e;n++){var s=4*n;i[n]=t[s]+256*t[1+s]+65536*t[2+s]+16777216*t[3+s]}return i},cc.PNGReader=cc.Class.extend({ctor:function(t){var e,i,n,s;for(this.data=t,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},n=null;;){for(e=this.readUInt32(),s=t=void 0,s=[],t=0;t<4;++t)s.push(String.fromCharCode(this.data[this.pos++]));switch(t=s.join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(e);break;case"fcTL":n&&this.animation.frames.push(n),this.pos+=4,n={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},t=this.readUInt16(),e=this.readUInt16()||100,n.delay=1e3*t/e,n.disposeOp=this.data[this.pos++],n.blendOp=this.data[this.pos++],n.data=[];break;case"IDAT":case"fdAT":for("fdAT"===t&&(this.pos+=4,e-=4),t=(null!=n?n.data:void 0)||this.imgData,s=0;0<=e?s<e:e<s;0<=e?++s:--s)t.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(this.transparency.indexed=this.read(e),0<(e=255-this.transparency.indexed.length))for(t=0;0<=e?t<e:e<t;0<=e?++t:--t)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(e)[0];break;case 2:this.transparency.rgb=this.read(e)}break;case"tEXt":e=(s=this.read(e)).indexOf(0),t=String.fromCharCode.apply(String,s.slice(0,e)),this.text[t]=String.fromCharCode.apply(String,s.slice(e+1));break;case"IEND":n&&this.animation.frames.push(n);t:{switch(this.colorType){case 0:case 3:case 4:n=1;break t;case 2:case 6:n=3;break t}n=void 0}this.colors=n,this.hasAlphaChannel=4===(i=this.colorType)||6===i,i=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*i;t:{switch(this.colors){case 1:i="DeviceGray";break t;case 3:i="DeviceRGB";break t}i=void 0}return this.colorSpace=i,void(Uint8Array!=Array&&(this.imgData=new Uint8Array(this.imgData)));default:this.pos+=e}if(this.pos+=4,this.pos>this.data.length)throw Error("Incomplete or corrupt PNG file")}},read:function(t){for(var e=[],i=0;0<=t?i<t:t<i;0<=t?++i:--i)e.push(this.data[this.pos++]);return e},readUInt32:function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},readUInt16:function(){return this.data[this.pos++]<<8|this.data[this.pos++]},decodePixels:function(t){var e,i,n,s,r,o,a,c,h,l,u,d,_,p,f;if(0===(t=null==t?this.imgData:t).length)return new Uint8Array(0);for(t=new Zlib.Inflate(t,{index:0,verify:!1}).decompress(),d=(c=this.pixelBitlength/8)*this.width,h=new Uint8Array(d*this.height),o=t.length,i=l=u=0;l<o;){switch(t[l++]){case 0:for(e=0;e<d;e+=1)h[i++]=t[l++];break;case 1:for(s=_=0;_<d;s=_+=1)e=t[l++],r=s<c?0:h[i-c],h[i++]=(e+r)%256;break;case 2:for(s=r=0;r<d;s=r+=1)e=t[l++],n=(s-s%c)/c,_=u&&h[(u-1)*d+n*c+s%c],h[i++]=(_+e)%256;break;case 3:for(s=f=0;f<d;s=f+=1)e=t[l++],n=(s-s%c)/c,r=s<c?0:h[i-c],_=u&&h[(u-1)*d+n*c+s%c],h[i++]=(e+Math.floor((r+_)/2))%256;break;case 4:for(s=f=0;f<d;s=f+=1)e=t[l++],n=(s-s%c)/c,r=s<c?0:h[i-c],0===u?_=p=0:(_=h[(u-1)*d+n*c+s%c],p=n&&h[(u-1)*d+(n-1)*c+s%c]),a=r+_-p,s=Math.abs(a-r),n=Math.abs(a-_),a=Math.abs(a-p),h[i++]=(e+(r=s<=n&&s<=a?r:n<=a?_:p))%256;break;default:throw Error("Invalid filter algorithm: "+t[l-1])}u++}return h},copyToImageData:function(t,e){var i,n,s,r,o,a=this.colors,c=null,h=this.hasAlphaChannel;if(this.palette.length&&(c=null!=(i=this._decodedPalette)?i:this._decodedPalette=this.decodePalette(),a=4,h=!0),o=(i=t.data||t).length,s=c||e,n=r=0,1===a)for(;n<o;)a=c?4*e[n/4]:r,r=s[a++],i[n++]=r,i[n++]=r,i[n++]=r,i[n++]=h?s[a++]:255,r=a;else for(;n<o;)a=c?4*e[n/4]:r,i[n++]=s[a++],i[n++]=s[a++],i[n++]=s[a++],i[n++]=h?s[a++]:255,r=a},decodePalette:function(){for(var t,e,i,n,s=this.palette,r=this.transparency.indexed||[],o=new Uint8Array((r.length||0)+s.length),a=i=t=e=0,c=s.length;i<c;a=i+=3)o[e++]=s[a],o[e++]=s[a+1],o[e++]=s[a+2],o[e++]=null!=(n=r[t++])?n:255;return o},render:function(t){var e;return t.width=this.width,t.height=this.height,e=(t=t.getContext("2d")).createImageData(this.width,this.height),this.copyToImageData(e,this.decodePixels()),t.putImageData(e,0,0)}}),cc.tiffReader={_littleEndian:!1,_tiffData:null,_fileDirectories:[],getUint8:function(t){return this._tiffData[t]},getUint16:function(t){return this._littleEndian?this._tiffData[t+1]<<8|this._tiffData[t]:this._tiffData[t]<<8|this._tiffData[t+1]},getUint32:function(t){var e=this._tiffData;return this._littleEndian?e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]:e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]},checkLittleEndian:function(){var t=this.getUint16(0);if(18761===t)this.littleEndian=!0;else{if(19789!==t)throw console.log(t),TypeError("Invalid byte order value.");this.littleEndian=!1}return this.littleEndian},hasTowel:function(){if(42!==this.getUint16(2))throw RangeError("You forgot your towel!");return!0},getFieldTypeName:function(t){var e=this.fieldTypeNames;return t in e?e[t]:null},getFieldTagName:function(t){var e=this.fieldTagNames;return t in e?e[t]:(console.log("Unknown Field Tag:",t),"Tag"+t)},getFieldTypeLength:function(t){return-1!==["BYTE","ASCII","SBYTE","UNDEFINED"].indexOf(t)?1:-1!==["SHORT","SSHORT"].indexOf(t)?2:-1!==["LONG","SLONG","FLOAT"].indexOf(t)?4:-1!==["RATIONAL","SRATIONAL","DOUBLE"].indexOf(t)?8:null},getFieldValues:function(t,e,i,n){t=[];var s=this.getFieldTypeLength(e);if(s*i<=4)!1===this.littleEndian?t.push(n>>>8*(4-s)):t.push(n);else for(var r=0;r<i;r++){var o=s*r;8<=s?-1!==["RATIONAL","SRATIONAL"].indexOf(e)?(t.push(this.getUint32(n+o)),t.push(this.getUint32(n+o+4))):cc.log("Can't handle this field type or size"):t.push(this.getBytes(s,n+o))}return"ASCII"===e&&t.forEach(function(t,e,i){i[e]=String.fromCharCode(t)}),t},getBytes:function(t,e){if(!(t<=0))return t<=1?this.getUint8(e):t<=2?this.getUint16(e):t<=3?this.getUint32(e)>>>8:t<=4?this.getUint32(e):void cc.log("Too many bytes requested");cc.log("No bytes requested")},getBits:function(t,e,i){i=i||0,e+=Math.floor(i/8);var n,s,r=i+t;return t=32-t,r<=0?console.log("No bits requested"):r<=8?(n=24+i,s=this.getUint8(e)):r<=16?(n=16+i,s=this.getUint16(e)):r<=32?(n=i,s=this.getUint32(e)):console.log("Too many bits requested"),{bits:s<<n>>>t,byteOffset:e+Math.floor(r/8),bitOffset:r%8}},parseFileDirectory:function(t){var e=this.getUint16(t),i=[];t+=2;for(var n=0;n<e;t+=12,n++){var s=this.getUint16(t),r=this.getUint16(t+2),o=this.getUint32(t+4),a=this.getUint32(t+8),s=this.getFieldTagName(s),r=this.getFieldTypeName(r),o=this.getFieldValues(s,r,o,a);i[s]={type:r,values:o}}this._fileDirectories.push(i),0!==(e=this.getUint32(t))&&this.parseFileDirectory(e)},clampColorSample:function(t,e){e=Math.pow(2,8-e);return Math.floor(t*e+(e-1))},parseTIFF:function(t,e){if(e=e||document.createElement("canvas"),this._tiffData=t,this.canvas=e,this.checkLittleEndian(),this.hasTowel()){var i=this.getUint32(4),n=(this._fileDirectories.length=0,this.parseFileDirectory(i),this._fileDirectories[0]),i=n.ImageWidth.values[0],s=n.ImageLength.values[0],r=(this.canvas.width=i,this.canvas.height=s,[]),o=n.Compression?n.Compression.values[0]:1,a=n.SamplesPerPixel.values[0],c=[],h=0,l=!1,u=(n.BitsPerSample.values.forEach(function(t,e,i){c[e]={bitsPerSample:t,hasBytesPerSample:!1,bytesPerSample:void 0},0==t%8&&(c[e].hasBytesPerSample=!0,c[e].bytesPerSample=t/8),h+=t},this),0==h%8&&(l=!0,f=h/8),n.StripOffsets.values),d=u.length;if(n.StripByteCounts)var _=n.StripByteCounts.values;else{if(cc.log("Missing StripByteCounts!"),1!==d)throw Error("Cannot recover from missing StripByteCounts");_=[Math.ceil(i*s*h/8)]}for(var p,f,g,m=0;m<d;m++){var y=u[m];r[m]=[];for(var T,S=_[m],C=0,E=0,I=1,v=!0,b=[],A=0,F=0,x=0;C<S;C+=I)switch(o){case 1:for(I=0,b=[];I<a;I++){if(!c[I].hasBytesPerSample)throw T=this.getBits(c[I].bitsPerSample,y+C,E),b.push(T.bits),C=T.byteOffset-y,E=T.bitOffset,RangeError("Cannot handle sub-byte bits per sample");b.push(this.getBytes(c[I].bytesPerSample,y+C+c[I].bytesPerSample*I))}if(r[m].push(b),!l)throw I=0,RangeError("Cannot handle sub-byte bits per pixel");I=f;break;case 32773:if(v){var v=!1,P=1,R=1;0<=(I=this.getInt8(y+C))&&I<=127?P=I+1:-127<=I&&I<=-1?R=1-I:v=!0}else{for(var L=this.getUint8(y+C),I=0;I<R;I++){if(!c[F].hasBytesPerSample)throw RangeError("Cannot handle sub-byte bits per sample");x=x<<8*A|L,++A===c[F].bytesPerSample&&(b.push(x),x=A=0,F++),F===a&&(r[m].push(b),b=[],F=0)}0===--P&&(v=!0)}I=1}}if(e.getContext)for((f=this.canvas.getContext("2d")).fillStyle="rgba(255, 255, 255, 0)",m=n.RowsPerStrip?n.RowsPerStrip.values[0]:s,y=r.length,s=0==(s%=m)?m:s,C=m,b=n.PhotometricInterpretation.values[o=0],P=[],R=0,n.ExtraSamples&&(R=(P=n.ExtraSamples.values).length),n.ColorMap&&(T=n.ColorMap.values,p=Math.pow(2,c[0].bitsPerSample)),m=0;m<y;m++){for(m+1===y&&(C=s),n=r[m].length,o*=m,l=a=0;l<n;a++)for(u=0;u<i;u++,l++){if(_=r[m][l],d=1,(v=E=S=0)<R)for(S=0;S<R;S++)if(1===P[S]||2===P[S]){d=_[3+S]/256;break}switch(b){case 0:c[0].hasBytesPerSample&&(g=Math.pow(16,2*c[0].bytesPerSample)),_.forEach(function(t,e,i){i[e]=g-t});case 1:S=E=v=this.clampColorSample(_[0],c[0].bitsPerSample);break;case 2:S=this.clampColorSample(_[0],c[0].bitsPerSample),E=this.clampColorSample(_[1],c[1].bitsPerSample),v=this.clampColorSample(_[2],c[2].bitsPerSample);break;case 3:if(void 0===T)throw Error("Palette image missing color map");_=_[0],S=this.clampColorSample(T[_],16),E=this.clampColorSample(T[p+_],16),v=this.clampColorSample(T[2*p+_],16);break;default:throw RangeError("Unknown Photometric Interpretation:",b)}f.fillStyle="rgba("+S+", "+E+", "+v+", "+d+")",f.fillRect(u,o+a,1,1)}o=C}return this.canvas}},fieldTagNames:{315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",259:"Compression",33432:"Copyright",306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",273:"StripOffsets",255:"SubfileType",263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",322:"TileWidth",301:"TransferFunction",318:"WhitePoint",344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",37510:"UserComment",33723:"IPTC",34675:"ICC Profile",700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop"},fieldTypeNames:{1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",10:"SRATIONAL",11:"FLOAT",12:"DOUBLE"}},cc.Particle=function(t,e,i,n,s,r,o,a,c,h,l,u){this.pos=t||cc.p(0,0),this.startPos=e||cc.p(0,0),this.color=i||{r:0,g:0,b:0,a:255},this.deltaColor=n||{r:0,g:0,b:0,a:255},this.size=s||0,this.deltaSize=r||0,this.rotation=o||0,this.deltaRotation=a||0,this.timeToLive=c||0,this.atlasIndex=h||0,this.modeA=l||new cc.Particle.ModeA,this.modeB=u||new cc.Particle.ModeB,this.isChangeColor=!1,this.drawPos=cc.p(0,0)},cc.Particle.ModeA=function(t,e,i){this.dir=t||cc.p(0,0),this.radialAccel=e||0,this.tangentialAccel=i||0},cc.Particle.ModeB=function(t,e,i,n){this.angle=t||0,this.degreesPerSecond=e||0,this.radius=i||0,this.deltaRadius=n||0},cc.Particle.TemporaryPoints=[cc.p(),cc.p(),cc.p(),cc.p()],cc.ParticleSystem=cc.Node.extend({_className:"ParticleSystem",_plistFile:"",_elapsed:0,_dontTint:!1,modeA:null,modeB:null,_pointZeroForParticle:cc.p(0,0),_particles:null,_emitCounter:0,_particleIdx:0,_batchNode:null,atlasIndex:0,_transformSystemDirty:!1,_allocatedParticles:0,_isActive:!1,particleCount:0,duration:0,_sourcePosition:null,_posVar:null,life:0,lifeVar:0,angle:0,angleVar:0,startSize:0,startSizeVar:0,endSize:0,endSizeVar:0,_startColor:null,_startColorVar:null,_endColor:null,_endColorVar:null,startSpin:0,startSpinVar:0,endSpin:0,endSpinVar:0,emissionRate:0,_totalParticles:0,_texture:null,_blendFunc:null,_opacityModifyRGB:!1,positionType:null,autoRemoveOnFinish:!1,emitterMode:0,_textureLoaded:null,ctor:function(t){cc.Node.prototype.ctor.call(this),this.emitterMode=cc.ParticleSystem.MODE_GRAVITY,this.modeA=new cc.ParticleSystem.ModeA,this.modeB=new cc.ParticleSystem.ModeB,this._blendFunc={src:cc.BLEND_SRC,dst:cc.BLEND_DST},this._particles=[],this._sourcePosition=cc.p(0,0),this._posVar=cc.p(0,0),this._startColor=cc.color(255,255,255,255),this._startColorVar=cc.color(255,255,255,255),this._endColor=cc.color(255,255,255,255),this._endColorVar=cc.color(255,255,255,255),this._plistFile="",this._elapsed=0,this._dontTint=!1,this._pointZeroForParticle=cc.p(0,0),this._particleIdx=this._emitCounter=0,this._batchNode=null,this.atlasIndex=0,this._transformSystemDirty=!1,this._allocatedParticles=0,this._isActive=!1,this._totalParticles=this.emissionRate=this.endSpinVar=this.endSpin=this.startSpinVar=this.startSpin=this.endSizeVar=this.endSize=this.startSizeVar=this.startSize=this.angleVar=this.angle=this.lifeVar=this.life=this.duration=this.particleCount=0,this._texture=null,this._opacityModifyRGB=!1,this.positionType=cc.ParticleSystem.TYPE_FREE,this.autoRemoveOnFinish=!1,this._textureLoaded=!0,!t||cc.isNumber(t)?(t=t||100,this.setDrawMode(cc.ParticleSystem.TEXTURE_MODE),this.initWithTotalParticles(t)):cc.isString(t)?this.initWithFile(t):cc.isObject(t)&&this.initWithDictionary(t,"")},_createRenderCmd:function(){return new(cc._renderType===cc.game.RENDER_TYPE_CANVAS?cc.ParticleSystem.CanvasRenderCmd:cc.ParticleSystem.WebGLRenderCmd)(this)},ignoreColor:function(t){this._dontTint=t},initTexCoordsWithRect:function(t){this._renderCmd.initTexCoordsWithRect(t)},getBatchNode:function(){return this._batchNode},setBatchNode:function(t){this._renderCmd.setBatchNode(t)},getAtlasIndex:function(){return this.atlasIndex},setAtlasIndex:function(t){this.atlasIndex=t},getDrawMode:function(){return this._renderCmd.getDrawMode()},setDrawMode:function(t){this._renderCmd.setDrawMode(t)},getShapeType:function(){return this._renderCmd.getShapeType()},setShapeType:function(t){this._renderCmd.setShapeType(t)},isActive:function(){return this._isActive},getParticleCount:function(){return this.particleCount},setParticleCount:function(t){this.particleCount=t},getDuration:function(){return this.duration},setDuration:function(t){this.duration=t},getSourcePosition:function(){return{x:this._sourcePosition.x,y:this._sourcePosition.y}},setSourcePosition:function(t){this._sourcePosition.x=t.x,this._sourcePosition.y=t.y},getPosVar:function(){return{x:this._posVar.x,y:this._posVar.y}},setPosVar:function(t){this._posVar.x=t.x,this._posVar.y=t.y},getLife:function(){return this.life},setLife:function(t){this.life=t},getLifeVar:function(){return this.lifeVar},setLifeVar:function(t){this.lifeVar=t},getAngle:function(){return this.angle},setAngle:function(t){this.angle=t},getAngleVar:function(){return this.angleVar},setAngleVar:function(t){this.angleVar=t},getGravity:function(){this.emitterMode!==cc.ParticleSystem.MODE_GRAVITY&&cc.log("cc.ParticleBatchNode.getGravity() : Particle Mode should be Gravity");var t=this.modeA.gravity;return cc.p(t.x,t.y)},setGravity:function(t){this.emitterMode!==cc.ParticleSystem.MODE_GRAVITY&&cc.log("cc.ParticleBatchNode.setGravity() : Particle Mode should be Gravity"),this.modeA.gravity=t},getSpeed:function(){return this.emitterMode!==cc.ParticleSystem.MODE_GRAVITY&&cc.log("cc.ParticleBatchNode.getSpeed() : Particle Mode should be Gravity"),this.modeA.speed},setSpeed:function(t){this.emitterMode!==cc.ParticleSystem.MODE_GRAVITY&&cc.log("cc.ParticleBatchNode.setSpeed() : Particle Mode should be Gravity"),this.modeA.speed=t},getSpeedVar:function(){return this.emitterMode!==cc.ParticleSystem.MODE_GRAVITY&&cc.log("cc.ParticleBatchNode.getSpeedVar() : Particle Mode should be Gravity"),this.modeA.speedVar},setSpeedVar:function(t){this.emitterMode!==cc.ParticleSystem.MODE_GRAVITY&&cc.log("cc.ParticleBatchNode.setSpeedVar() : Particle Mode should be Gravity"),this.modeA.speedVar=t},getTangentialAccel:function(){return this.emitterMode!==cc.ParticleSystem.MODE_GRAVITY&&cc.log("cc.ParticleBatchNode.getTangentialAccel() : Particle Mode should be Gravity"),this.modeA.tangentialAccel},setTangentialAccel:function(t){this.emitterMode!==cc.ParticleSystem.MODE_GRAVITY&&cc.log("cc.ParticleBatchNode.setTangentialAccel() : Particle Mode should be Gravity"),this.modeA.tangentialAccel=t},getTangentialAccelVar:function(){return this.emitterMode!==cc.ParticleSystem.MODE_GRAVITY&&cc.log("cc.ParticleBatchNode.getTangentialAccelVar() : Particle Mode should be Gravity"),this.modeA.tangentialAccelVar},setTangentialAccelVar:function(t){this.emitterMode!==cc.ParticleSystem.MODE_GRAVITY&&cc.log("cc.ParticleBatchNode.setTangentialAccelVar() : Particle Mode should be Gravity"),this.modeA.tangentialAccelVar=t},getRadialAccel:function(){return this.emitterMode!==cc.ParticleSystem.MODE_GRAVITY&&cc.log("cc.ParticleBatchNode.getRadialAccel() : Particle Mode should be Gravity"),this.modeA.radialAccel},setRadialAccel:function(t){this.emitterMode!==cc.ParticleSystem.MODE_GRAVITY&&cc.log("cc.ParticleBatchNode.setRadialAccel() : Particle Mode should be Gravity"),this.modeA.radialAccel=t},getRadialAccelVar:function(){return this.emitterMode!==cc.ParticleSystem.MODE_GRAVITY&&cc.log("cc.ParticleBatchNode.getRadialAccelVar() : Particle Mode should be Gravity"),this.modeA.radialAccelVar},setRadialAccelVar:function(t){this.emitterMode!==cc.ParticleSystem.MODE_GRAVITY&&cc.log("cc.ParticleBatchNode.setRadialAccelVar() : Particle Mode should be Gravity"),this.modeA.radialAccelVar=t},getRotationIsDir:function(){return this.emitterMode!==cc.ParticleSystem.MODE_GRAVITY&&cc.log("cc.ParticleBatchNode.getRotationIsDir() : Particle Mode should be Gravity"),this.modeA.rotationIsDir},setRotationIsDir:function(t){this.emitterMode!==cc.ParticleSystem.MODE_GRAVITY&&cc.log("cc.ParticleBatchNode.setRotationIsDir() : Particle Mode should be Gravity"),this.modeA.rotationIsDir=t},getStartRadius:function(){return this.emitterMode!==cc.ParticleSystem.MODE_RADIUS&&cc.log("cc.ParticleBatchNode.getStartRadius() : Particle Mode should be Radius"),this.modeB.startRadius},setStartRadius:function(t){this.emitterMode!==cc.ParticleSystem.MODE_RADIUS&&cc.log("cc.ParticleBatchNode.setStartRadius() : Particle Mode should be Radius"),this.modeB.startRadius=t},getStartRadiusVar:function(){return this.emitterMode!==cc.ParticleSystem.MODE_RADIUS&&cc.log("cc.ParticleBatchNode.getStartRadiusVar() : Particle Mode should be Radius"),this.modeB.startRadiusVar},setStartRadiusVar:function(t){this.emitterMode!==cc.ParticleSystem.MODE_RADIUS&&cc.log("cc.ParticleBatchNode.setStartRadiusVar() : Particle Mode should be Radius"),this.modeB.startRadiusVar=t},getEndRadius:function(){return this.emitterMode!==cc.ParticleSystem.MODE_RADIUS&&cc.log("cc.ParticleBatchNode.getEndRadius() : Particle Mode should be Radius"),this.modeB.endRadius},setEndRadius:function(t){this.emitterMode!==cc.ParticleSystem.MODE_RADIUS&&cc.log("cc.ParticleBatchNode.setEndRadius() : Particle Mode should be Radius"),this.modeB.endRadius=t},getEndRadiusVar:function(){return this.emitterMode!==cc.ParticleSystem.MODE_RADIUS&&cc.log("cc.ParticleBatchNode.getEndRadiusVar() : Particle Mode should be Radius"),this.modeB.endRadiusVar},setEndRadiusVar:function(t){this.emitterMode!==cc.ParticleSystem.MODE_RADIUS&&cc.log("cc.ParticleBatchNode.setEndRadiusVar() : Particle Mode should be Radius"),this.modeB.endRadiusVar=t},getRotatePerSecond:function(){return this.emitterMode!==cc.ParticleSystem.MODE_RADIUS&&cc.log("cc.ParticleBatchNode.getRotatePerSecond() : Particle Mode should be Radius"),this.modeB.rotatePerSecond},setRotatePerSecond:function(t){this.emitterMode!==cc.ParticleSystem.MODE_RADIUS&&cc.log("cc.ParticleBatchNode.setRotatePerSecond() : Particle Mode should be Radius"),this.modeB.rotatePerSecond=t},getRotatePerSecondVar:function(){return this.emitterMode!==cc.ParticleSystem.MODE_RADIUS&&cc.log("cc.ParticleBatchNode.getRotatePerSecondVar() : Particle Mode should be Radius"),this.modeB.rotatePerSecondVar},setRotatePerSecondVar:function(t){this.emitterMode!==cc.ParticleSystem.MODE_RADIUS&&cc.log("cc.ParticleBatchNode.setRotatePerSecondVar() : Particle Mode should be Radius"),this.modeB.rotatePerSecondVar=t},setScale:function(t,e){this._transformSystemDirty=!0,cc.Node.prototype.setScale.call(this,t,e)},setRotation:function(t){this._transformSystemDirty=!0,cc.Node.prototype.setRotation.call(this,t)},setScaleX:function(t){this._transformSystemDirty=!0,cc.Node.prototype.setScaleX.call(this,t)},setScaleY:function(t){this._transformSystemDirty=!0,cc.Node.prototype.setScaleY.call(this,t)},getStartSize:function(){return this.startSize},setStartSize:function(t){this.startSize=t},getStartSizeVar:function(){return this.startSizeVar},setStartSizeVar:function(t){this.startSizeVar=t},getEndSize:function(){return this.endSize},setEndSize:function(t){this.endSize=t},getEndSizeVar:function(){return this.endSizeVar},setEndSizeVar:function(t){this.endSizeVar=t},getStartColor:function(){return cc.color(this._startColor.r,this._startColor.g,this._startColor.b,this._startColor.a)},setStartColor:function(t){this._startColor.r=t.r,this._startColor.g=t.g,this._startColor.b=t.b,this._startColor.a=t.a},getStartColorVar:function(){return cc.color(this._startColorVar.r,this._startColorVar.g,this._startColorVar.b,this._startColorVar.a)},setStartColorVar:function(t){this._startColorVar.r=t.r,this._startColorVar.g=t.g,this._startColorVar.b=t.b,this._startColorVar.a=t.a},getEndColor:function(){return cc.color(this._endColor.r,this._endColor.g,this._endColor.b,this._endColor.a)},setEndColor:function(t){this._endColor.r=t.r,this._endColor.g=t.g,this._endColor.b=t.b,this._endColor.a=t.a},getEndColorVar:function(){return cc.color(this._endColorVar.r,this._endColorVar.g,this._endColorVar.b,this._endColorVar.a)},setEndColorVar:function(t){this._endColorVar.r=t.r,this._endColorVar.g=t.g,this._endColorVar.b=t.b,this._endColorVar.a=t.a},getStartSpin:function(){return this.startSpin},setStartSpin:function(t){this.startSpin=t},getStartSpinVar:function(){return this.startSpinVar},setStartSpinVar:function(t){this.startSpinVar=t},getEndSpin:function(){return this.endSpin},setEndSpin:function(t){this.endSpin=t},getEndSpinVar:function(){return this.endSpinVar},setEndSpinVar:function(t){this.endSpinVar=t},getEmissionRate:function(){return this.emissionRate},setEmissionRate:function(t){this.emissionRate=t},getTotalParticles:function(){return this._totalParticles},setTotalParticles:function(t){this._renderCmd.setTotalParticles(t)},getTexture:function(){return this._texture},setTexture:function(t){t&&(t.isLoaded()?this.setTextureWithRect(t,cc.rect(0,0,t.width,t.height)):(this._textureLoaded=!1,t.addEventListener("load",function(t){this._textureLoaded=!0,this.setTextureWithRect(t,cc.rect(0,0,t.width,t.height))},this)))},getBlendFunc:function(){return this._blendFunc},setBlendFunc:function(t,e){void 0===e?this._blendFunc!==t&&(this._blendFunc=t,this._updateBlendFunc()):this._blendFunc.src===t&&this._blendFunc.dst===e||(this._blendFunc={src:t,dst:e},this._updateBlendFunc())},isOpacityModifyRGB:function(){return this._opacityModifyRGB},setOpacityModifyRGB:function(t){this._opacityModifyRGB=t},isBlendAdditive:function(){return this._blendFunc.src===cc.SRC_ALPHA&&this._blendFunc.dst===cc.ONE||this._blendFunc.src===cc.ONE&&this._blendFunc.dst===cc.ONE},setBlendAdditive:function(t){var e=this._blendFunc;t?(e.src=cc.SRC_ALPHA,e.dst=cc.ONE):this._renderCmd._setBlendAdditive()},getPositionType:function(){return this.positionType},setPositionType:function(t){this.positionType=t},isAutoRemoveOnFinish:function(){return this.autoRemoveOnFinish},setAutoRemoveOnFinish:function(t){this.autoRemoveOnFinish=t},getEmitterMode:function(){return this.emitterMode},setEmitterMode:function(t){this.emitterMode=t},init:function(){return this.initWithTotalParticles(150)},initWithFile:function(t){return this._plistFile=t,(t=cc.loader.getRes(t))?this.initWithDictionary(t,""):(cc.log("cc.ParticleSystem.initWithFile(): Particles: file not found"),!1)},getBoundingBoxToWorld:function(){return cc.rect(0,0,cc._canvas.width,cc._canvas.height)},initWithDictionary:function(t,e){var i=!1,n=null,n=this._valueForKey,s=parseInt(n("maxParticles",t));if(this.initWithTotalParticles(s)){if(this.angle=parseFloat(n("angle",t)),this.angleVar=parseFloat(n("angleVariance",t)),this.duration=parseFloat(n("duration",t)),this._blendFunc.src=parseInt(n("blendFuncSource",t)),this._blendFunc.dst=parseInt(n("blendFuncDestination",t)),(i=this._startColor).r=255*parseFloat(n("startColorRed",t)),i.g=255*parseFloat(n("startColorGreen",t)),i.b=255*parseFloat(n("startColorBlue",t)),i.a=255*parseFloat(n("startColorAlpha",t)),(i=this._startColorVar).r=255*parseFloat(n("startColorVarianceRed",t)),i.g=255*parseFloat(n("startColorVarianceGreen",t)),i.b=255*parseFloat(n("startColorVarianceBlue",t)),i.a=255*parseFloat(n("startColorVarianceAlpha",t)),(i=this._endColor).r=255*parseFloat(n("finishColorRed",t)),i.g=255*parseFloat(n("finishColorGreen",t)),i.b=255*parseFloat(n("finishColorBlue",t)),i.a=255*parseFloat(n("finishColorAlpha",t)),(i=this._endColorVar).r=255*parseFloat(n("finishColorVarianceRed",t)),i.g=255*parseFloat(n("finishColorVarianceGreen",t)),i.b=255*parseFloat(n("finishColorVarianceBlue",t)),i.a=255*parseFloat(n("finishColorVarianceAlpha",t)),this.startSize=parseFloat(n("startParticleSize",t)),this.startSizeVar=parseFloat(n("startParticleSizeVariance",t)),this.endSize=parseFloat(n("finishParticleSize",t)),this.endSizeVar=parseFloat(n("finishParticleSizeVariance",t)),this.setPosition(parseFloat(n("sourcePositionx",t)),parseFloat(n("sourcePositiony",t))),this._posVar.x=parseFloat(n("sourcePositionVariancex",t)),this._posVar.y=parseFloat(n("sourcePositionVariancey",t)),this.startSpin=parseFloat(n("rotationStart",t)),this.startSpinVar=parseFloat(n("rotationStartVariance",t)),this.endSpin=parseFloat(n("rotationEnd",t)),this.endSpinVar=parseFloat(n("rotationEndVariance",t)),this.emitterMode=parseInt(n("emitterType",t)),this.emitterMode===cc.ParticleSystem.MODE_GRAVITY)(i=this.modeA).gravity.x=parseFloat(n("gravityx",t)),i.gravity.y=parseFloat(n("gravityy",t)),i.speed=parseFloat(n("speed",t)),i.speedVar=parseFloat(n("speedVariance",t)),s=n("radialAcceleration",t),i.radialAccel=s?parseFloat(s):0,s=n("radialAccelVariance",t),i.radialAccelVar=s?parseFloat(s):0,s=n("tangentialAcceleration",t),i.tangentialAccel=s?parseFloat(s):0,s=n("tangentialAccelVariance",t),i.tangentialAccelVar=s?parseFloat(s):0,null!==(s=n("rotationIsDir",t))?(s=s.toString().toLowerCase(),i.rotationIsDir="true"===s||"1"===s):i.rotationIsDir=!1;else{if(this.emitterMode!==cc.ParticleSystem.MODE_RADIUS)return cc.log("cc.ParticleSystem.initWithDictionary(): Invalid emitterType in config file"),!1;(i=this.modeB).startRadius=parseFloat(n("maxRadius",t)),i.startRadiusVar=parseFloat(n("maxRadiusVariance",t)),i.endRadius=parseFloat(n("minRadius",t)),i.endRadiusVar=0,i.rotatePerSecond=parseFloat(n("rotatePerSecond",t)),i.rotatePerSecondVar=parseFloat(n("rotatePerSecondVariance",t))}if(this.life=parseFloat(n("particleLifespan",t)),this.lifeVar=parseFloat(n("particleLifespanVariance",t)),this.emissionRate=this._totalParticles/this.life,!this._batchNode)if(this._opacityModifyRGB=!1,i=n("textureFileName",t),i=cc.path.changeBasename(this._plistFile,i),s=cc.textureCache.getTextureForKey(i))this.setTexture(s);else if((n=n("textureImageData",t))&&0!==n.length){if(!(n=cc.unzipBase64AsArray(n,1)))return cc.log("cc.ParticleSystem: error decoding or ungzipping textureImageData"),!1;if((s=cc.getImageFormatByData(n))!==cc.FMT_TIFF&&s!==cc.FMT_PNG)return cc.log("cc.ParticleSystem: unknown image format with Data"),!1;t=document.createElement("canvas");s===cc.FMT_PNG?new cc.PNGReader(n).render(t):cc.tiffReader.parseTIFF(n,t),cc.textureCache.cacheImage(i,t),(n=cc.textureCache.getTextureForKey(i))||cc.log("cc.ParticleSystem.initWithDictionary() : error loading the texture"),this.setTexture(n)}else{if(!(s=cc.textureCache.addImage(i)))return!1;this.setTexture(s)}i=!0}return i},initWithTotalParticles:function(t){this._totalParticles=t;for(var e=this._particles,i=e.length=0;i<t;i++)e[i]=new cc.Particle;if(!e)return cc.log("Particle system: not enough memory"),!1;if(this._allocatedParticles=t,this._batchNode)for(i=0;i<this._totalParticles;i++)e[i].atlasIndex=i;return this._isActive=!0,this._blendFunc.src=cc.BLEND_SRC,this._blendFunc.dst=cc.BLEND_DST,this.positionType=cc.ParticleSystem.TYPE_FREE,this.emitterMode=cc.ParticleSystem.MODE_GRAVITY,this._transformSystemDirty=this.autoRemoveOnFinish=!1,this.scheduleUpdateWithPriority(1),this._renderCmd._initWithTotalParticles(t),!0},destroyParticleSystem:function(){this.unscheduleUpdate()},addParticle:function(){var t;return!this.isFull()&&(t=this._renderCmd.addParticle(),this.initParticle(t),++this.particleCount,!0)},initParticle:function(t){var e,i=cc.randomMinus1To1,n=(t.timeToLive=this.life+this.lifeVar*i(),t.timeToLive=Math.max(0,t.timeToLive),t.pos.x=this._sourcePosition.x+this._posVar.x*i(),t.pos.y=this._sourcePosition.y+this._posVar.y*i(),o=this._startColor,this._startColorVar),s=this._endColor,r=this._endColorVar,o={r:cc.clampf(o.r+n.r*i(),0,255),g:cc.clampf(o.g+n.g*i(),0,255),b:cc.clampf(o.b+n.b*i(),0,255),a:cc.clampf(o.a+n.a*i(),0,255)};r={r:cc.clampf(s.r+r.r*i(),0,255),g:cc.clampf(s.g+r.g*i(),0,255),b:cc.clampf(s.b+r.b*i(),0,255),a:cc.clampf(s.a+r.a*i(),0,255)},t.color=o,n=t.deltaColor,s=t.timeToLive,n.r=(r.r-o.r)/s,n.g=(r.g-o.g)/s,n.b=(r.b-o.b)/s,n.a=(r.a-o.a)/s,o=this.startSize+this.startSizeVar*i(),o=Math.max(0,o),t.size=o,this.endSize===cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE?t.deltaSize=0:(r=this.endSize+this.endSizeVar*i(),r=Math.max(0,r),t.deltaSize=(r-o)/s),o=this.startSpin+this.startSpinVar*i(),r=this.endSpin+this.endSpinVar*i(),t.rotation=o,t.deltaRotation=(r-o)/s,this.positionType===cc.ParticleSystem.TYPE_FREE?t.startPos=this.convertToWorldSpace(this._pointZeroForParticle):this.positionType===cc.ParticleSystem.TYPE_RELATIVE&&(t.startPos.x=this._position.x,t.startPos.y=this._position.y),o=cc.degreesToRadians(this.angle+this.angleVar*i()),this.emitterMode===cc.ParticleSystem.MODE_GRAVITY?(s=this.modeA,r=t.modeA,n=s.speed+s.speedVar*i(),r.dir.x=Math.cos(o),r.dir.y=Math.sin(o),cc.pMultIn(r.dir,n),r.radialAccel=s.radialAccel+s.radialAccelVar*i(),r.tangentialAccel=s.tangentialAccel+s.tangentialAccelVar*i(),s.rotationIsDir&&(t.rotation=-cc.radiansToDegrees(cc.pToAngle(r.dir)))):(r=this.modeB,t=t.modeB,n=r.startRadius+r.startRadiusVar*i(),e=r.endRadius+r.endRadiusVar*i(),t.radius=n,t.deltaRadius=r.endRadius===cc.ParticleSystem.START_RADIUS_EQUAL_TO_END_RADIUS?0:(e-n)/s,t.angle=o,t.degreesPerSecond=cc.degreesToRadians(r.rotatePerSecond+r.rotatePerSecondVar*i()))},stopSystem:function(){this._isActive=!1,this._elapsed=this.duration,this._emitCounter=0},resetSystem:function(){this._isActive=!0,this._elapsed=0;var t=this._particles;for(this._particleIdx=0;this._particleIdx<this.particleCount;++this._particleIdx)t[this._particleIdx].timeToLive=0},isFull:function(){return this.particleCount>=this._totalParticles},updateQuadWithParticle:function(t,e){this._renderCmd.updateQuadWithParticle(t,e)},postStep:function(){this._renderCmd.postStep()},update:function(t){if(this._isActive&&this.emissionRate){var e=1/this.emissionRate;for(this.particleCount<this._totalParticles&&(this._emitCounter+=t);this.particleCount<this._totalParticles&&this._emitCounter>e;)this.addParticle(),this._emitCounter-=e;this._elapsed+=t,-1!==this.duration&&this.duration<this._elapsed&&this.stopSystem()}if(this._particleIdx=0,e=cc.Particle.TemporaryPoints[0],this.positionType===cc.ParticleSystem.TYPE_FREE?cc.pIn(e,this.convertToWorldSpace(this._pointZeroForParticle)):this.positionType===cc.ParticleSystem.TYPE_RELATIVE&&(e.x=this._position.x,e.y=this._position.y),this._visible){for(var i=cc.Particle.TemporaryPoints[1],n=cc.Particle.TemporaryPoints[2],s=cc.Particle.TemporaryPoints[3],r=this._particles;this._particleIdx<this.particleCount;){cc.pZeroIn(i),cc.pZeroIn(n),cc.pZeroIn(s);var o,a,c,h,l=r[this._particleIdx];if(l.timeToLive-=t,0<l.timeToLive)this.emitterMode===cc.ParticleSystem.MODE_GRAVITY?(o=s,a=i,c=n,l.pos.x||l.pos.y?(cc.pIn(a,l.pos),cc.pNormalizeIn(a)):cc.pZeroIn(a),cc.pIn(c,a),cc.pMultIn(a,l.modeA.radialAccel),h=c.x,c.x=-c.y,c.y=h,cc.pMultIn(c,l.modeA.tangentialAccel),cc.pIn(o,a),cc.pAddIn(o,c),cc.pAddIn(o,this.modeA.gravity),cc.pMultIn(o,t),cc.pAddIn(l.modeA.dir,o),cc.pIn(o,l.modeA.dir),cc.pMultIn(o,t),cc.pAddIn(l.pos,o)):((o=l.modeB).angle+=o.degreesPerSecond*t,o.radius+=o.deltaRadius*t,l.pos.x=-Math.cos(o.angle)*o.radius,l.pos.y=-Math.sin(o.angle)*o.radius),this._renderCmd._updateDeltaColor(l,t),l.size+=l.deltaSize*t,l.size=Math.max(0,l.size),l.rotation+=l.deltaRotation*t,o=i,this.positionType===cc.ParticleSystem.TYPE_FREE||this.positionType===cc.ParticleSystem.TYPE_RELATIVE?(cc.pIn(a=n,e),cc.pSubIn(a,l.startPos),cc.pIn(o,l.pos),cc.pSubIn(o,a)):cc.pIn(o,l.pos),this._batchNode&&(o.x+=this._position.x,o.y+=this._position.y),this._renderCmd.updateParticlePosition(l,o),++this._particleIdx;else if(l=l.atlasIndex,this._particleIdx!==this.particleCount-1&&(o=r[this._particleIdx],r[this._particleIdx]=r[this.particleCount-1],r[this.particleCount-1]=o),this._batchNode&&(this._batchNode.disableParticle(this.atlasIndex+l),r[this.particleCount-1].atlasIndex=l),--this.particleCount,0===this.particleCount&&this.autoRemoveOnFinish)return this.unscheduleUpdate(),void this._parent.removeChild(this,!0)}this._transformSystemDirty=!1}this._batchNode||this.postStep()},updateWithNoTime:function(){this.update(0)},_valueForKey:function(t,e){return e&&null!=(e=e[t])?e:""},_updateBlendFunc:function(){var t,e;this._batchNode?cc.log("Can't change blending functions when the particle is being batched"):(t=this._texture)&&t instanceof cc.Texture2D&&(this._opacityModifyRGB=!1,(e=this._blendFunc).src===cc.BLEND_SRC)&&e.dst===cc.BLEND_DST&&(t.hasPremultipliedAlpha()?this._opacityModifyRGB=!0:(e.src=cc.SRC_ALPHA,e.dst=cc.ONE_MINUS_SRC_ALPHA))},clone:function(){var t,e,i=new cc.ParticleSystem;return i.initWithTotalParticles(this.getTotalParticles())&&(i.setAngle(this.getAngle()),i.setAngleVar(this.getAngleVar()),i.setDuration(this.getDuration()),t=this.getBlendFunc(),i.setBlendFunc(t.src,t.dst),i.setStartColor(this.getStartColor()),i.setStartColorVar(this.getStartColorVar()),i.setEndColor(this.getEndColor()),i.setEndColorVar(this.getEndColorVar()),i.setStartSize(this.getStartSize()),i.setStartSizeVar(this.getStartSizeVar()),i.setEndSize(this.getEndSize()),i.setEndSizeVar(this.getEndSizeVar()),i.setPosition(cc.p(this.x,this.y)),i.setPosVar(cc.p(this.getPosVar().x,this.getPosVar().y)),i.setPositionType(this.getPositionType()),i.setStartSpin(this.getStartSpin()||0),i.setStartSpinVar(this.getStartSpinVar()||0),i.setEndSpin(this.getEndSpin()||0),i.setEndSpinVar(this.getEndSpinVar()||0),i.setEmitterMode(this.getEmitterMode()),this.getEmitterMode()===cc.ParticleSystem.MODE_GRAVITY?(t=this.getGravity(),i.setGravity(cc.p(t.x,t.y)),i.setSpeed(this.getSpeed()),i.setSpeedVar(this.getSpeedVar()),i.setRadialAccel(this.getRadialAccel()),i.setRadialAccelVar(this.getRadialAccelVar()),i.setTangentialAccel(this.getTangentialAccel()),i.setTangentialAccelVar(this.getTangentialAccelVar())):this.getEmitterMode()===cc.ParticleSystem.MODE_RADIUS&&(i.setStartRadius(this.getStartRadius()),i.setStartRadiusVar(this.getStartRadiusVar()),i.setEndRadius(this.getEndRadius()),i.setEndRadiusVar(this.getEndRadiusVar()),i.setRotatePerSecond(this.getRotatePerSecond()),i.setRotatePerSecondVar(this.getRotatePerSecondVar())),i.setLife(this.getLife()),i.setLifeVar(this.getLifeVar()),i.setEmissionRate(this.getEmissionRate()),!this.getBatchNode())&&(i.setOpacityModifyRGB(this.isOpacityModifyRGB()),t=this.getTexture())&&(e=t.getContentSize(),i.setTextureWithRect(t,cc.rect(0,0,e.width,e.height))),i},setDisplayFrame:function(t){var e;t&&(0===(e=t.getOffsetInPixels()).x&&0===e.y||cc.log("cc.ParticleSystem.setDisplayFrame(): QuadParticle only supports SpriteFrames with no offsets"),t=t.getTexture(),this._texture!==t)&&this.setTexture(t)},setTextureWithRect:function(t,e){this._texture!==t&&(this._texture=t,this._updateBlendFunc()),this.initTexCoordsWithRect(e)},listenBackToForeground:function(t){}}),_p=cc.ParticleSystem.prototype,cc.defineGetterSetter(_p,"opacityModifyRGB",_p.isOpacityModifyRGB,_p.setOpacityModifyRGB),cc.defineGetterSetter(_p,"batchNode",_p.getBatchNode,_p.setBatchNode),cc.defineGetterSetter(_p,"drawMode",_p.getDrawMode,_p.setDrawMode),cc.defineGetterSetter(_p,"shapeType",_p.getShapeType,_p.setShapeType),cc.defineGetterSetter(_p,"active",_p.isActive),cc.defineGetterSetter(_p,"sourcePos",_p.getSourcePosition,_p.setSourcePosition),cc.defineGetterSetter(_p,"posVar",_p.getPosVar,_p.setPosVar),cc.defineGetterSetter(_p,"gravity",_p.getGravity,_p.setGravity),cc.defineGetterSetter(_p,"speed",_p.getSpeed,_p.setSpeed),cc.defineGetterSetter(_p,"speedVar",_p.getSpeedVar,_p.setSpeedVar),cc.defineGetterSetter(_p,"tangentialAccel",_p.getTangentialAccel,_p.setTangentialAccel),cc.defineGetterSetter(_p,"tangentialAccelVar",_p.getTangentialAccelVar,_p.setTangentialAccelVar),cc.defineGetterSetter(_p,"radialAccel",_p.getRadialAccel,_p.setRadialAccel),cc.defineGetterSetter(_p,"radialAccelVar",_p.getRadialAccelVar,_p.setRadialAccelVar),cc.defineGetterSetter(_p,"rotationIsDir",_p.getRotationIsDir,_p.setRotationIsDir),cc.defineGetterSetter(_p,"startRadius",_p.getStartRadius,_p.setStartRadius),cc.defineGetterSetter(_p,"startRadiusVar",_p.getStartRadiusVar,_p.setStartRadiusVar),cc.defineGetterSetter(_p,"endRadius",_p.getEndRadius,_p.setEndRadius),cc.defineGetterSetter(_p,"endRadiusVar",_p.getEndRadiusVar,_p.setEndRadiusVar),cc.defineGetterSetter(_p,"rotatePerS",_p.getRotatePerSecond,_p.setRotatePerSecond),cc.defineGetterSetter(_p,"rotatePerSVar",_p.getRotatePerSecondVar,_p.setRotatePerSecondVar),cc.defineGetterSetter(_p,"startColor",_p.getStartColor,_p.setStartColor),cc.defineGetterSetter(_p,"startColorVar",_p.getStartColorVar,_p.setStartColorVar),cc.defineGetterSetter(_p,"endColor",_p.getEndColor,_p.setEndColor),cc.defineGetterSetter(_p,"endColorVar",_p.getEndColorVar,_p.setEndColorVar),cc.defineGetterSetter(_p,"totalParticles",_p.getTotalParticles,_p.setTotalParticles),cc.defineGetterSetter(_p,"texture",_p.getTexture,_p.setTexture),cc.ParticleSystem.create=function(t){return new cc.ParticleSystem(t)},cc.ParticleSystem.createWithTotalParticles=cc.ParticleSystem.create,cc.ParticleSystem.ModeA=function(t,e,i,n,s,r,o,a){this.gravity=t||cc.p(0,0),this.speed=e||0,this.speedVar=i||0,this.tangentialAccel=n||0,this.tangentialAccelVar=s||0,this.radialAccel=r||0,this.radialAccelVar=o||0,this.rotationIsDir=a||!1},cc.ParticleSystem.ModeB=function(t,e,i,n,s,r){this.startRadius=t||0,this.startRadiusVar=e||0,this.endRadius=i||0,this.endRadiusVar=n||0,this.rotatePerSecond=s||0,this.rotatePerSecondVar=r||0},cc.ParticleSystem.SHAPE_MODE=0,cc.ParticleSystem.TEXTURE_MODE=1,cc.ParticleSystem.STAR_SHAPE=0,cc.ParticleSystem.BALL_SHAPE=1,cc.ParticleSystem.DURATION_INFINITY=-1,cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE=-1,cc.ParticleSystem.START_RADIUS_EQUAL_TO_END_RADIUS=-1,cc.ParticleSystem.MODE_GRAVITY=0,cc.ParticleSystem.MODE_RADIUS=1,cc.ParticleSystem.TYPE_FREE=0,cc.ParticleSystem.TYPE_RELATIVE=1,cc.ParticleSystem.TYPE_GROUPED=2,!function(){cc.ParticleSystem.CanvasRenderCmd=function(t){this._rootCtor(t),this._needDraw=!0,this._drawMode=cc.ParticleSystem.TEXTURE_MODE,this._shapeType=cc.ParticleSystem.BALL_SHAPE,this._pointRect=cc.rect(0,0,0,0),this._tintCache=null};var t=cc.ParticleSystem.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);t.constructor=cc.ParticleSystem.CanvasRenderCmd,t.getDrawMode=function(){return this._drawMode},t.setDrawMode=function(t){this._drawMode=t},t.getShapeType=function(){return this._shapeType},t.setShapeType=function(t){this._shapeType=t},t.setBatchNode=function(t){this._batchNode!==t&&(this._node._batchNode=t)},t.updateQuadWithParticle=function(t,e){},t.updateParticlePosition=function(t,e){cc.pIn(t.drawPos,e)},t.rendering=function(t,e,i){var n=(t=t||cc._renderContext).getContext(),s=this._node,r=this._pointRect,o=(t.setTransform(this._worldTransform,e,i),t.save(),s.isBlendAdditive()?n.globalCompositeOperation="lighter":n.globalCompositeOperation="source-over",i=this._node.particleCount,this._node._particles);if(s.drawMode!==cc.ParticleSystem.SHAPE_MODE&&s._texture){if(!s._texture._textureLoaded)return void t.restore();var a,c,h,l,u=s._texture.getHtmlElementObj();if(!u.width||!u.height)return void t.restore();for(l=u,e=0;e<i;e++)0!==(c=(l=o[e]).color.a/255)&&(n.globalAlpha=c,n.save(),n.translate(0|l.drawPos.x,-(0|l.drawPos.y)),a=4*Math.floor(l.size/4),c=r.width,h=r.height,n.scale(Math.max(1/c*a,1e-6),Math.max(1/h*a,1e-6)),l.rotation&&n.rotate(cc.degreesToRadians(l.rotation)),l=l.isChangeColor?this._changeTextureColor(s._texture,l.color,this._pointRect):u,n.drawImage(l,-(0|c/2),-(0|h/2)),n.restore())}else for(u=cc._drawingUtil,e=0;e<i;e++)r=0|.5*(l=o[e]).size,0!==(c=l.color.a/255)&&(n.globalAlpha=c,n.save(),n.translate(0|l.drawPos.x,-(0|l.drawPos.y)),s.shapeType===cc.ParticleSystem.STAR_SHAPE?(l.rotation&&n.rotate(cc.degreesToRadians(l.rotation)),u.drawStar(t,r,l.color)):u.drawColorBall(t,r,l.color),n.restore());t.restore(),cc.g_NumberOfDraws++},t._changeTextureColor=function(t,e,i){this._tintCache||(this._tintCache=document.createElement("canvas"));var n=this._tintCache,s=t.getContentSize();return n.width=s.width,n.height=s.height,t._generateColorTexture(e.r,e.g,e.b,i,n)},t.initTexCoordsWithRect=function(t){this._pointRect=t},t.setTotalParticles=function(t){this._node._totalParticles=t<200?t:200},t.addParticle=function(){var t=this._node,e=t._particles;return t.particleCount<e.length?t=e[t.particleCount]:(t=new cc.Particle,e.push(t)),t},t._setupVBO=function(){},t._allocMemory=function(){return!0},t.postStep=function(){},t._setBlendAdditive=function(){var t=this._node._blendFunc;t.src=cc.BLEND_SRC,t.dst=cc.BLEND_DST},t._initWithTotalParticles=function(t){},t._updateDeltaColor=function(t,e){var i;this._node._dontTint||(i=t.deltaColor,t.color.r+=i.r*e,t.color.g+=i.g*e,t.color.b+=i.b*e,t.color.a+=i.a*e,t.isChangeColor=0!==i.r||0!==i.g||0!==i.b)}}(),!function(){cc.ParticleSystem.WebGLRenderCmd=function(t){this._rootCtor(t),this._needDraw=!0,this._matrix=null,this._buffersVBO=[0,0],this._quads=[],this._indices=[],this._quadsArrayBuffer=null};var t=cc.ParticleSystem.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype);t.constructor=cc.ParticleSystem.WebGLRenderCmd,t.getDrawMode=function(){},t.setDrawMode=function(t){},t.getShapeType=function(){},t.setShapeType=function(t){},t.setBatchNode=function(t){var e=this._node;if(e._batchNode!==t){var i=e._batchNode;if(e._batchNode=t)for(var n=e._particles,s=0;s<e._totalParticles;s++)n[s].atlasIndex=s;t?i||(e._batchNode.textureAtlas._copyQuadsToTextureAtlas(this._quads,e.atlasIndex),cc._renderContext.deleteBuffer(this._buffersVBO[1])):(this._allocMemory(),this.initIndices(e._totalParticles),e.setTexture(i.getTexture()),this._setupVBO())}},t.initIndices=function(t){for(var e=this._indices,i=0;i<t;++i){var n=6*i,s=4*i;e[0+n]=0+s,e[1+n]=1+s,e[2+n]=2+s,e[5+n]=1+s,e[4+n]=2+s,e[3+n]=3+s}},t.isDifferentTexture=function(t,e){return t===e},t.updateParticlePosition=function(t,e){this.updateQuadWithParticle(t,e)},t.updateQuadWithParticle=function(t,e){var i,n,s,r=null,o=this._node,a=(o._batchNode?(r=o._batchNode.textureAtlas.quads[o.atlasIndex+t.atlasIndex],o._batchNode.textureAtlas.dirty=!0):r=this._quads[o._particleIdx],n=o._opacityModifyRGB?(o=0|t.color.r*t.color.a/255,i=0|t.color.g*t.color.a/255,0|t.color.b*t.color.a/255):(o=0|t.color.r,i=0|t.color.g,0|t.color.b),s=0|t.color.a,r.bl.colors),c=r.br.colors,h=r.tl.colors,l=r.tr.colors;a.r=c.r=h.r=l.r=o,a.g=c.g=h.g=l.g=i,a.b=c.b=h.b=l.b=n,a.a=c.a=h.a=l.a=s,o=t.size/2,t.rotation?(n=i=-o,s=e.x,a=e.y,h=-cc.degreesToRadians(t.rotation),c=Math.cos(h),h=Math.sin(h),r.bl.vertices.x=i*c-n*h+s,r.bl.vertices.y=i*h+n*c+a,r.br.vertices.x=o*c-n*h+s,r.br.vertices.y=o*h+n*c+a,r.tl.vertices.x=i*c-o*h+s,r.tl.vertices.y=i*h+o*c+a,r.tr.vertices.x=o*c-o*h+s,r.tr.vertices.y=o*h+o*c+a):(r.bl.vertices.x=e.x-o,r.bl.vertices.y=e.y-o,r.br.vertices.x=e.x+o,r.br.vertices.y=e.y-o,r.tl.vertices.x=e.x-o,r.tl.vertices.y=e.y+o,r.tr.vertices.x=e.x+o,r.tr.vertices.y=e.y+o)},t.rendering=function(t){var e,i=this._node;i._texture&&(t=t||cc._renderContext,this._matrix||(this._matrix=new cc.math.Matrix4,this._matrix.identity()),e=this._worldTransform,this._matrix.mat[0]=e.a,this._matrix.mat[4]=e.c,this._matrix.mat[12]=e.tx,this._matrix.mat[1]=e.b,this._matrix.mat[5]=e.d,this._matrix.mat[13]=e.ty,this._glProgramState.apply(this._matrix),cc.glBindTexture2D(i._texture),cc.glBlendFuncForParticle(i._blendFunc.src,i._blendFunc.dst),t.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),t.enableVertexAttribArray(cc.VERTEX_ATTRIB_COLOR),t.enableVertexAttribArray(cc.VERTEX_ATTRIB_TEX_COORDS),t.bindBuffer(t.ARRAY_BUFFER,this._buffersVBO[0]),t.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,3,t.FLOAT,!1,24,0),t.vertexAttribPointer(cc.VERTEX_ATTRIB_COLOR,4,t.UNSIGNED_BYTE,!0,24,12),t.vertexAttribPointer(cc.VERTEX_ATTRIB_TEX_COORDS,2,t.FLOAT,!1,24,16),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this._buffersVBO[1]),t.drawElements(t.TRIANGLES,6*i._particleIdx,t.UNSIGNED_SHORT,0))},t.initTexCoordsWithRect=function(t){for(var e=(a=this._node).texture,i=cc.contentScaleFactor(),n=cc.rect(t.x*i,t.y*i,t.width*i,t.height*i),i=t.width,s=t.height,r=(e&&(i=e.pixelsWidth,s=e.pixelsHeight),s=n=cc.FIX_ARTIFACTS_BY_STRECHING_TEXEL?(e=(2*n.x+1)/(2*i),t=(2*n.y+1)/(2*s),i=e+(2*n.width-2)/(2*i),t+(2*n.height-2)/(2*s)):(e=n.x/i,t=n.y/s,i=e+n.width/i,t+n.height/s),n=t,t=s,0),o=0,o=a._batchNode?(s=a._batchNode.textureAtlas.quads,r=a.atlasIndex,a.atlasIndex+a._totalParticles):(s=this._quads,r=0,a._totalParticles),a=r;a<o;a++)s[a]||(s[a]=cc.V3F_C4B_T2F_QuadZero()),(r=s[a]).bl.texCoords.u=e,r.bl.texCoords.v=t,r.br.texCoords.u=i,r.br.texCoords.v=t,r.tl.texCoords.u=e,r.tl.texCoords.v=n,r.tr.texCoords.u=i,r.tr.texCoords.v=n},t.setTotalParticles=function(t){var e=this._node;if(t>e._allocatedParticles){var i=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,n=(this._indices=new Uint16Array(6*t),new ArrayBuffer(t*i)),s=e._particles;s.length=0;for(var r=this._quads,o=r.length=0;o<t;o++)s[o]=new cc.Particle,r[o]=new cc.V3F_C4B_T2F_Quad(null,null,null,null,n,o*i);if(e._allocatedParticles=t,e._totalParticles=t,e._batchNode)for(i=0;i<t;i++)s[i].atlasIndex=i;this._quadsArrayBuffer=n,this.initIndices(t),this._setupVBO(),e._texture&&this.initTexCoordsWithRect(cc.rect(0,0,e._texture.width,e._texture.height))}else e._totalParticles=t;e.resetSystem()},t.addParticle=function(){var t=this._node;return t._particles[t.particleCount]},t._setupVBO=function(){var t=cc._renderContext;this._buffersVBO[0]=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this._buffersVBO[0]),t.bufferData(t.ARRAY_BUFFER,this._quadsArrayBuffer,t.DYNAMIC_DRAW),this._buffersVBO[1]=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this._buffersVBO[1]),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this._indices,t.STATIC_DRAW)},t._allocMemory=function(){if((e=this._node)._batchNode)return cc.log("cc.ParticleSystem._allocMemory(): Memory should not be allocated when not using batchNode"),!1;var t=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,e=e._totalParticles,i=this._quads;i.length=0,this._indices=new Uint16Array(6*e);for(var n=new ArrayBuffer(t*e),s=0;s<e;s++)i[s]=new cc.V3F_C4B_T2F_Quad(null,null,null,null,n,s*t);return i&&this._indices?(this._quadsArrayBuffer=n,!0):(cc.log("cocos2d: Particle system: not enough memory"),!1)},t.postStep=function(){var t=cc._renderContext;t.bindBuffer(t.ARRAY_BUFFER,this._buffersVBO[0]),t.bufferSubData(t.ARRAY_BUFFER,0,this._quadsArrayBuffer)},t._setBlendAdditive=function(){var t=this._node._blendFunc;this._texture&&!this._texture.hasPremultipliedAlpha()?(t.src=cc.SRC_ALPHA,t.dst=cc.ONE_MINUS_SRC_ALPHA):(t.src=cc.BLEND_SRC,t.dst=cc.BLEND_DST)},t._initWithTotalParticles=function(t){if(!this._allocMemory())return!1;this.initIndices(t),this._setupVBO(),this._shaderProgram=cc.shaderCache.programForKey(cc.SHADER_POSITION_TEXTURECOLOR)},t._updateDeltaColor=function(t,e){t.color.r+=t.deltaColor.r*e,t.color.g+=t.deltaColor.g*e,t.color.b+=t.deltaColor.b*e,t.color.a+=t.deltaColor.a*e,t.isChangeColor=!0}}(),cc.ParticleFire=cc.ParticleSystem.extend({ctor:function(){cc.ParticleSystem.prototype.ctor.call(this,cc._renderType===cc.game.RENDER_TYPE_WEBGL?300:150)},initWithTotalParticles:function(t){return!!cc.ParticleSystem.prototype.initWithTotalParticles.call(this,t)&&(this.setDuration(cc.ParticleSystem.DURATION_INFINITY),this.setEmitterMode(cc.ParticleSystem.MODE_GRAVITY),this.setGravity(cc.p(0,0)),this.setRadialAccel(0),this.setRadialAccelVar(0),this.setSpeed(60),this.setSpeedVar(20),this.setAngle(90),this.setAngleVar(10),t=cc.director.getWinSize(),this.setPosition(t.width/2,60),this.setPosVar(cc.p(40,20)),this.setLife(3),this.setLifeVar(.25),this.setStartSize(54),this.setStartSizeVar(10),this.setEndSize(cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE),this.setEmissionRate(this.getTotalParticles()/this.getLife()),this.setStartColor(cc.color(194,64,31,255)),this.setStartColorVar(cc.color(0,0,0,0)),this.setEndColor(cc.color(0,0,0,255)),this.setEndColorVar(cc.color(0,0,0,0)),this.setBlendAdditive(!0),!0)}}),cc.ParticleFire.create=function(){return new cc.ParticleFire},cc.ParticleFireworks=cc.ParticleSystem.extend({ctor:function(){cc.ParticleSystem.prototype.ctor.call(this,cc._renderType===cc.game.RENDER_TYPE_WEBGL?1500:150)},initWithTotalParticles:function(t){return!!cc.ParticleSystem.prototype.initWithTotalParticles.call(this,t)&&(this.setDuration(cc.ParticleSystem.DURATION_INFINITY),this.setEmitterMode(cc.ParticleSystem.MODE_GRAVITY),this.setGravity(cc.p(0,-90)),this.setRadialAccel(0),this.setRadialAccelVar(0),this.setSpeed(180),this.setSpeedVar(50),t=cc.director.getWinSize(),this.setPosition(t.width/2,t.height/2),this.setAngle(90),this.setAngleVar(20),this.setLife(3.5),this.setLifeVar(1),this.setEmissionRate(this.getTotalParticles()/this.getLife()),this.setStartColor(cc.color(128,128,128,255)),this.setStartColorVar(cc.color(128,128,128,255)),this.setEndColor(cc.color(26,26,26,51)),this.setEndColorVar(cc.color(26,26,26,51)),this.setStartSize(8),this.setStartSizeVar(2),this.setEndSize(cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE),this.setBlendAdditive(!1),!0)}}),cc.ParticleFireworks.create=function(){return new cc.ParticleFireworks},cc.ParticleSun=cc.ParticleSystem.extend({ctor:function(){cc.ParticleSystem.prototype.ctor.call(this,cc._renderType===cc.game.RENDER_TYPE_WEBGL?350:150)},initWithTotalParticles:function(t){return!!cc.ParticleSystem.prototype.initWithTotalParticles.call(this,t)&&(this.setBlendAdditive(!0),this.setDuration(cc.ParticleSystem.DURATION_INFINITY),this.setEmitterMode(cc.ParticleSystem.MODE_GRAVITY),this.setGravity(cc.p(0,0)),this.setRadialAccel(0),this.setRadialAccelVar(0),this.setSpeed(20),this.setSpeedVar(5),this.setAngle(90),this.setAngleVar(360),t=cc.director.getWinSize(),this.setPosition(t.width/2,t.height/2),this.setPosVar(cc.p(0,0)),this.setLife(1),this.setLifeVar(.5),this.setStartSize(30),this.setStartSizeVar(10),this.setEndSize(cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE),this.setEmissionRate(this.getTotalParticles()/this.getLife()),this.setStartColor(cc.color(194,64,31,255)),this.setStartColorVar(cc.color(0,0,0,0)),this.setEndColor(cc.color(0,0,0,255)),this.setEndColorVar(cc.color(0,0,0,0)),!0)}}),cc.ParticleSun.create=function(){return new cc.ParticleSun},cc.ParticleGalaxy=cc.ParticleSystem.extend({ctor:function(){cc.ParticleSystem.prototype.ctor.call(this,cc._renderType===cc.game.RENDER_TYPE_WEBGL?200:100)},initWithTotalParticles:function(t){return!!cc.ParticleSystem.prototype.initWithTotalParticles.call(this,t)&&(this.setDuration(cc.ParticleSystem.DURATION_INFINITY),this.setEmitterMode(cc.ParticleSystem.MODE_GRAVITY),this.setGravity(cc.p(0,0)),this.setSpeed(60),this.setSpeedVar(10),this.setRadialAccel(-80),this.setRadialAccelVar(0),this.setTangentialAccel(80),this.setTangentialAccelVar(0),this.setAngle(90),this.setAngleVar(360),t=cc.director.getWinSize(),this.setPosition(t.width/2,t.height/2),this.setPosVar(cc.p(0,0)),this.setLife(4),this.setLifeVar(1),this.setStartSize(37),this.setStartSizeVar(10),this.setEndSize(cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE),this.setEmissionRate(this.getTotalParticles()/this.getLife()),this.setStartColor(cc.color(31,64,194,255)),this.setStartColorVar(cc.color(0,0,0,0)),this.setEndColor(cc.color(0,0,0,255)),this.setEndColorVar(cc.color(0,0,0,0)),this.setBlendAdditive(!0),!0)}}),cc.ParticleGalaxy.create=function(){return new cc.ParticleGalaxy},cc.ParticleFlower=cc.ParticleSystem.extend({ctor:function(){cc.ParticleSystem.prototype.ctor.call(this,cc._renderType===cc.game.RENDER_TYPE_WEBGL?250:100)},initWithTotalParticles:function(t){return!!cc.ParticleSystem.prototype.initWithTotalParticles.call(this,t)&&(this.setDuration(cc.ParticleSystem.DURATION_INFINITY),this.setEmitterMode(cc.ParticleSystem.MODE_GRAVITY),this.setGravity(cc.p(0,0)),this.setSpeed(80),this.setSpeedVar(10),this.setRadialAccel(-60),this.setRadialAccelVar(0),this.setTangentialAccel(15),this.setTangentialAccelVar(0),this.setAngle(90),this.setAngleVar(360),t=cc.director.getWinSize(),this.setPosition(t.width/2,t.height/2),this.setPosVar(cc.p(0,0)),this.setLife(4),this.setLifeVar(1),this.setStartSize(30),this.setStartSizeVar(10),this.setEndSize(cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE),this.setEmissionRate(this.getTotalParticles()/this.getLife()),this.setStartColor(cc.color(128,128,128,255)),this.setStartColorVar(cc.color(128,128,128,128)),this.setEndColor(cc.color(0,0,0,255)),this.setEndColorVar(cc.color(0,0,0,0)),this.setBlendAdditive(!0),!0)}}),cc.ParticleFlower.create=function(){return new cc.ParticleFlower},cc.ParticleMeteor=cc.ParticleSystem.extend({ctor:function(){cc.ParticleSystem.prototype.ctor.call(this,cc._renderType===cc.game.RENDER_TYPE_WEBGL?150:100)},initWithTotalParticles:function(t){return!!cc.ParticleSystem.prototype.initWithTotalParticles.call(this,t)&&(this.setDuration(cc.ParticleSystem.DURATION_INFINITY),this.setEmitterMode(cc.ParticleSystem.MODE_GRAVITY),this.setGravity(cc.p(-200,200)),this.setSpeed(15),this.setSpeedVar(5),this.setRadialAccel(0),this.setRadialAccelVar(0),this.setTangentialAccel(0),this.setTangentialAccelVar(0),this.setAngle(90),this.setAngleVar(360),t=cc.director.getWinSize(),this.setPosition(t.width/2,t.height/2),this.setPosVar(cc.p(0,0)),this.setLife(2),this.setLifeVar(1),this.setStartSize(60),this.setStartSizeVar(10),this.setEndSize(cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE),this.setEmissionRate(this.getTotalParticles()/this.getLife()),this.setStartColor(cc.color(51,102,179)),this.setStartColorVar(cc.color(0,0,51,26)),this.setEndColor(cc.color(0,0,0,255)),this.setEndColorVar(cc.color(0,0,0,0)),this.setBlendAdditive(!0),!0)}}),cc.ParticleMeteor.create=function(){return new cc.ParticleMeteor},cc.ParticleSpiral=cc.ParticleSystem.extend({ctor:function(){cc.ParticleSystem.prototype.ctor.call(this,cc._renderType===cc.game.RENDER_TYPE_WEBGL?500:100)},initWithTotalParticles:function(t){return!!cc.ParticleSystem.prototype.initWithTotalParticles.call(this,t)&&(this.setDuration(cc.ParticleSystem.DURATION_INFINITY),this.setEmitterMode(cc.ParticleSystem.MODE_GRAVITY),this.setGravity(cc.p(0,0)),this.setSpeed(150),this.setSpeedVar(0),this.setRadialAccel(-380),this.setRadialAccelVar(0),this.setTangentialAccel(45),this.setTangentialAccelVar(0),this.setAngle(90),this.setAngleVar(0),t=cc.director.getWinSize(),this.setPosition(t.width/2,t.height/2),this.setPosVar(cc.p(0,0)),this.setLife(12),this.setLifeVar(0),this.setStartSize(20),this.setStartSizeVar(0),this.setEndSize(cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE),this.setEmissionRate(this.getTotalParticles()/this.getLife()),this.setStartColor(cc.color(128,128,128,255)),this.setStartColorVar(cc.color(128,128,128,0)),this.setEndColor(cc.color(128,128,128,255)),this.setEndColorVar(cc.color(128,128,128,0)),this.setBlendAdditive(!1),!0)}}),cc.ParticleSpiral.create=function(){return new cc.ParticleSpiral},cc.ParticleExplosion=cc.ParticleSystem.extend({ctor:function(){cc.ParticleSystem.prototype.ctor.call(this,cc._renderType===cc.game.RENDER_TYPE_WEBGL?700:300)},initWithTotalParticles:function(t){return!!cc.ParticleSystem.prototype.initWithTotalParticles.call(this,t)&&(this.setDuration(.1),this.setEmitterMode(cc.ParticleSystem.MODE_GRAVITY),this.setGravity(cc.p(0,0)),this.setSpeed(70),this.setSpeedVar(40),this.setRadialAccel(0),this.setRadialAccelVar(0),this.setTangentialAccel(0),this.setTangentialAccelVar(0),this.setAngle(90),this.setAngleVar(360),t=cc.director.getWinSize(),this.setPosition(t.width/2,t.height/2),this.setPosVar(cc.p(0,0)),this.setLife(5),this.setLifeVar(2),this.setStartSize(15),this.setStartSizeVar(10),this.setEndSize(cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE),this.setEmissionRate(this.getTotalParticles()/this.getDuration()),this.setStartColor(cc.color(179,26,51,255)),this.setStartColorVar(cc.color(128,128,128,0)),this.setEndColor(cc.color(128,128,128,0)),this.setEndColorVar(cc.color(128,128,128,0)),this.setBlendAdditive(!1),!0)}}),cc.ParticleExplosion.create=function(){return new cc.ParticleExplosion},cc.ParticleSmoke=cc.ParticleSystem.extend({ctor:function(){cc.ParticleSystem.prototype.ctor.call(this,cc._renderType===cc.game.RENDER_TYPE_WEBGL?200:100)},initWithTotalParticles:function(t){return!!cc.ParticleSystem.prototype.initWithTotalParticles.call(this,t)&&(this.setDuration(cc.ParticleSystem.DURATION_INFINITY),this.setEmitterMode(cc.ParticleSystem.MODE_GRAVITY),this.setGravity(cc.p(0,0)),this.setRadialAccel(0),this.setRadialAccelVar(0),this.setSpeed(25),this.setSpeedVar(10),this.setAngle(90),this.setAngleVar(5),t=cc.director.getWinSize(),this.setPosition(t.width/2,0),this.setPosVar(cc.p(20,0)),this.setLife(4),this.setLifeVar(1),this.setStartSize(60),this.setStartSizeVar(10),this.setEndSize(cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE),this.setEmissionRate(this.getTotalParticles()/this.getLife()),this.setStartColor(cc.color(204,204,204,255)),this.setStartColorVar(cc.color(5,5,5,0)),this.setEndColor(cc.color(0,0,0,255)),this.setEndColorVar(cc.color(0,0,0,0)),this.setBlendAdditive(!1),!0)}}),cc.ParticleSmoke.create=function(){return new cc.ParticleSmoke},cc.ParticleSnow=cc.ParticleSystem.extend({ctor:function(){cc.ParticleSystem.prototype.ctor.call(this,cc._renderType===cc.game.RENDER_TYPE_WEBGL?700:250)},initWithTotalParticles:function(t){return!!cc.ParticleSystem.prototype.initWithTotalParticles.call(this,t)&&(this.setDuration(cc.ParticleSystem.DURATION_INFINITY),this.setEmitterMode(cc.ParticleSystem.MODE_GRAVITY),this.setGravity(cc.p(0,-1)),this.setSpeed(5),this.setSpeedVar(1),this.setRadialAccel(0),this.setRadialAccelVar(1),this.setTangentialAccel(0),this.setTangentialAccelVar(1),t=cc.director.getWinSize(),this.setPosition(t.width/2,t.height+10),this.setPosVar(cc.p(t.width/2,0)),this.setAngle(-90),this.setAngleVar(5),this.setLife(45),this.setLifeVar(15),this.setStartSize(10),this.setStartSizeVar(5),this.setEndSize(cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE),this.setEmissionRate(10),this.setStartColor(cc.color(255,255,255,255)),this.setStartColorVar(cc.color(0,0,0,0)),this.setEndColor(cc.color(255,255,255,0)),this.setEndColorVar(cc.color(0,0,0,0)),this.setBlendAdditive(!1),!0)}}),cc.ParticleSnow.create=function(){return new cc.ParticleSnow},cc.ParticleRain=cc.ParticleSystem.extend({ctor:function(){cc.ParticleSystem.prototype.ctor.call(this,cc._renderType===cc.game.RENDER_TYPE_WEBGL?1e3:300)},initWithTotalParticles:function(t){return!!cc.ParticleSystem.prototype.initWithTotalParticles.call(this,t)&&(this.setDuration(cc.ParticleSystem.DURATION_INFINITY),this.setEmitterMode(cc.ParticleSystem.MODE_GRAVITY),this.setGravity(cc.p(10,-10)),this.setRadialAccel(0),this.setRadialAccelVar(1),this.setTangentialAccel(0),this.setTangentialAccelVar(1),this.setSpeed(130),this.setSpeedVar(30),this.setAngle(-90),this.setAngleVar(5),t=cc.director.getWinSize(),this.setPosition(t.width/2,t.height),this.setPosVar(cc.p(t.width/2,0)),this.setLife(4.5),this.setLifeVar(0),this.setStartSize(4),this.setStartSizeVar(2),this.setEndSize(cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE),this.setEmissionRate(20),this.setStartColor(cc.color(179,204,255,255)),this.setStartColorVar(cc.color(0,0,0,0)),this.setEndColor(cc.color(179,204,255,128)),this.setEndColorVar(cc.color(0,0,0,0)),this.setBlendAdditive(!1),!0)}}),cc.ParticleRain.create=function(){return new cc.ParticleRain},cc.PARTICLE_DEFAULT_CAPACITY=500,cc.ParticleBatchNode=cc.Node.extend({textureAtlas:null,_blendFunc:null,_className:"ParticleBatchNode",ctor:function(t,e){cc.Node.prototype.ctor.call(this),this._blendFunc={src:cc.BLEND_SRC,dst:cc.BLEND_DST},cc.isString(t)?this.init(t,e):t instanceof cc.Texture2D&&this.initWithTexture(t,e)},_createRenderCmd:function(){return new(cc._renderType===cc.game.RENDER_TYPE_CANVAS?cc.ParticleBatchNode.CanvasRenderCmd:cc.ParticleBatchNode.WebGLRenderCmd)(this)},initWithTexture:function(t,e){return this.textureAtlas=new cc.TextureAtlas,this.textureAtlas.initWithTexture(t,e),this._children.length=0,this._renderCmd._initWithTexture(),!0},initWithFile:function(t,e){t=cc.textureCache.addImage(t);return this.initWithTexture(t,e)},init:function(t,e){t=cc.textureCache.addImage(t);return this.initWithTexture(t,e)},visit:function(t){var e=this._renderCmd;t=t?t._renderCmd:null,this._visible?(e.visit(t),cc.renderer.pushRenderCommand(e),e._dirtyFlag=0):e._propagateFlagsDown(t)},addChild:function(t,e,i){if(!t)throw Error("cc.ParticleBatchNode.addChild() : child should be non-null");if(!(t instanceof cc.ParticleSystem))throw Error("cc.ParticleBatchNode.addChild() : only supports cc.ParticleSystem as children");if(e=null==e?t.zIndex:e,i=null==i?t.tag:i,t.getTexture()!==this.textureAtlas.texture)throw Error("cc.ParticleSystem.addChild() : the child is not using the same texture id");var n=t.getBlendFunc();if(0===this._children.length)this.setBlendFunc(n);else if(n.src!==this._blendFunc.src||n.dst!==this._blendFunc.dst)return void cc.log("cc.ParticleSystem.addChild() : Can't add a ParticleSystem that uses a different blending function");e=this._addChildHelper(t,e,i),i=(i=0)!==e?(e=this._children[e-1]).getAtlasIndex()+e.getTotalParticles():0,this.insertChild(t,i),t.setBatchNode(this)},insertChild:function(t,e){var i=t.getTotalParticles(),n=this.textureAtlas,s=n.totalQuads;t.setAtlasIndex(e),s+i>n.getCapacity()&&(this._increaseAtlasCapacityTo(s+i),n.fillWithEmptyQuadsFromIndex(n.getCapacity()-i,i)),t.getAtlasIndex()+i!==s&&n.moveQuadsFromIndex(e,e+i),n.increaseTotalQuadsWith(i),this._updateAllAtlasIndexes()},removeChild:function(t,e){if(null!=t){if(!(t instanceof cc.ParticleSystem))throw Error("cc.ParticleBatchNode.removeChild(): only supports cc.ParticleSystem as children");-1===this._children.indexOf(t)?cc.log("cc.ParticleBatchNode.removeChild(): doesn't contain the sprite. Can't remove it"):(cc.Node.prototype.removeChild.call(this,t,e),(e=this.textureAtlas).removeQuadsAtIndex(t.getAtlasIndex(),t.getTotalParticles()),e.fillWithEmptyQuadsFromIndex(e.totalQuads,t.getTotalParticles()),t.setBatchNode(null),this._updateAllAtlasIndexes())}},reorderChild:function(t,e){if(!t)throw Error("cc.ParticleBatchNode.reorderChild(): child should be non-null");if(!(t instanceof cc.ParticleSystem))throw Error("cc.ParticleBatchNode.reorderChild(): only supports cc.QuadParticleSystems as children");if(-1===this._children.indexOf(t))cc.log("cc.ParticleBatchNode.reorderChild(): Child doesn't belong to batch");else{if(1<this._children.length){var i=this._getCurrentIndex(t,e);if(i.oldIndex!==i.newIndex){this._children.splice(i.oldIndex,1),this._children.splice(i.newIndex,0,t),i=t.getAtlasIndex(),this._updateAllAtlasIndexes();for(var n=0,s=this._children,r=0;r<s.length;r++)if(s[r]===t){n=t.getAtlasIndex();break}this.textureAtlas.moveQuadsFromIndex(i,t.getTotalParticles(),n),t.updateWithNoTime()}}t._setLocalZOrder(e)}},removeChildAtIndex:function(t,e){this.removeChild(this._children[i],e)},removeAllChildren:function(t){for(var e=this._children,i=0;i<e.length;i++)e[i].setBatchNode(null);cc.Node.prototype.removeAllChildren.call(this,t),this.textureAtlas.removeAllQuads()},disableParticle:function(t){(t=this.textureAtlas.quads[t]).br.vertices.x=t.br.vertices.y=t.tr.vertices.x=t.tr.vertices.y=t.tl.vertices.x=t.tl.vertices.y=t.bl.vertices.x=t.bl.vertices.y=0,this.textureAtlas._setDirty(!0)},getTexture:function(){return this.textureAtlas.texture},setTexture:function(t){this.textureAtlas.texture=t;var e=this._blendFunc;t&&!t.hasPremultipliedAlpha()&&e.src===cc.BLEND_SRC&&e.dst===cc.BLEND_DST&&(e.src=cc.SRC_ALPHA,e.dst=cc.ONE_MINUS_SRC_ALPHA)},setBlendFunc:function(t,e){void 0===e?(this._blendFunc.src=t.src,this._blendFunc.dst=t.dst):(this._blendFunc.src=t,this._blendFunc.src=e)},getBlendFunc:function(){return new cc.BlendFunc(this._blendFunc.src,this._blendFunc.dst)},_updateAllAtlasIndexes:function(){for(var t=0,e=this._children,i=0;i<e.length;i++){var n=e[i];n.setAtlasIndex(t),t+=n.getTotalParticles()}},_increaseAtlasCapacityTo:function(t){cc.log("cocos2d: cc.ParticleBatchNode: resizing TextureAtlas capacity from ["+this.textureAtlas.getCapacity()+"] to ["+t+"]."),this.textureAtlas.resizeCapacity(t)||cc.log("cc.ParticleBatchNode._increaseAtlasCapacityTo() : WARNING: Not enough memory to resize the atlas")},_searchNewPositionInChildrenForZ:function(t){for(var e=this._children,i=e.length,n=0;n<i;n++)if(e[n].zIndex>t)return n;return i},_getCurrentIndex:function(t,e){for(var i=!1,n=!1,s=0,r=0,o=0,a=this._children,c=a.length,h=0;h<c;h++){var l=a[h];if(l.zIndex>e&&!n&&(s=h,n=!0,i)&&n)break;if(t===l&&(r=h,n||(o=-1),i=!0)&&n)break}return{newIndex:(s=n?s:c)+o,oldIndex:r}},_addChildHelper:function(t,e,i){if(!t)throw Error("cc.ParticleBatchNode._addChildHelper(): child should be non-null");if(t.parent)return cc.log("cc.ParticleBatchNode._addChildHelper(): child already added. It can't be added again"),null;this._children||(this._children=[]);var n=this._searchNewPositionInChildrenForZ(e);return this._children.splice(n,0,t),t.tag=i,t._setLocalZOrder(e),(t.parent=this)._running&&(t._performRecursive(cc.Node._stateCallbackType.onEnter),t._performRecursive(cc.Node._stateCallbackType.onEnterTransitionDidFinish)),n},_updateBlendFunc:function(){this.textureAtlas.texture.hasPremultipliedAlpha()||(this._blendFunc.src=cc.SRC_ALPHA,this._blendFunc.dst=cc.ONE_MINUS_SRC_ALPHA)},getTextureAtlas:function(){return this.textureAtlas},setTextureAtlas:function(t){this.textureAtlas=t}}),_p=cc.ParticleBatchNode.prototype,cc.defineGetterSetter(_p,"texture",_p.getTexture,_p.setTexture),cc.ParticleBatchNode.create=function(t,e){return new cc.ParticleBatchNode(t,e)},!function(){cc.ParticleBatchNode.CanvasRenderCmd=function(t){this._rootCtor(t),this._needDraw=!1};var t=cc.ParticleBatchNode.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);t.constructor=cc.ParticleBatchNode.CanvasRenderCmd,t._initWithTexture=function(){}}(),!function(){cc.ParticleBatchNode.WebGLRenderCmd=function(t){this._rootCtor(t),this._needDraw=!0,this._matrix=new cc.math.Matrix4,this._matrix.identity()};var t=cc.ParticleBatchNode.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype);t.constructor=cc.ParticleBatchNode.WebGLRenderCmd,t.rendering=function(t){var e;0!==(t=this._node).textureAtlas.totalQuads&&(e=this._worldTransform,this._matrix.mat[0]=e.a,this._matrix.mat[4]=e.c,this._matrix.mat[12]=e.tx,this._matrix.mat[1]=e.b,this._matrix.mat[5]=e.d,this._matrix.mat[13]=e.ty,this._glProgramState.apply(this._matrix),cc.glBlendFuncForParticle(t._blendFunc.src,t._blendFunc.dst),t.textureAtlas.drawQuads())},t._initWithTexture=function(){this._shaderProgram=cc.shaderCache.programForKey(cc.SHADER_POSITION_TEXTURECOLOR)}}(),cc.IMEKeyboardNotificationInfo=function(t,e,i){this.begin=t||cc.rect(0,0,0,0),this.end=e||cc.rect(0,0,0,0),this.duration=i||0},cc.IMEDelegate=cc.Class.extend({ctor:function(){cc.imeDispatcher.addDelegate(this)},removeDelegate:function(){cc.imeDispatcher.removeDelegate(this)},attachWithIME:function(){return cc.imeDispatcher.attachDelegateWithIME(this)},detachWithIME:function(){return cc.imeDispatcher.detachDelegateWithIME(this)},canAttachWithIME:function(){return!1},didAttachWithIME:function(){},canDetachWithIME:function(){return!1},didDetachWithIME:function(){},insertText:function(t,e){},deleteBackward:function(){},getContentText:function(){return""},keyboardWillShow:function(t){},keyboardDidShow:function(t){},keyboardWillHide:function(t){},keyboardDidHide:function(t){}}),cc.IMEDispatcher=cc.Class.extend({_domInputControl:null,impl:null,_currentInputString:"",_lastClickPosition:null,ctor:function(){this.impl=new cc.IMEDispatcher.Impl,this._lastClickPosition=cc.p(0,0)},init:function(){var i;cc.sys.isMobile||(this._domInputControl=cc.$("#imeDispatcherInput"),this._domInputControl||(this._domInputControl=cc.$new("input"),this._domInputControl.setAttribute("type","text"),this._domInputControl.setAttribute("id","imeDispatcherInput"),this._domInputControl.resize(0,0),this._domInputControl.translates(0,0),this._domInputControl.style.opacity="0",this._domInputControl.style.fontSize="1px",this._domInputControl.setAttribute("tabindex",2),this._domInputControl.style.position="absolute",this._domInputControl.style.top=0,this._domInputControl.style.left=0,document.body.appendChild(this._domInputControl)),(i=this)._domInputControl.addEventListener("input",function(){i._processDomInputString(i._domInputControl.value)},!1),this._domInputControl.addEventListener("keydown",function(t){t.keyCode===cc.KEY.tab?(t.stopPropagation(),t.preventDefault()):t.keyCode===cc.KEY.enter&&(i.dispatchInsertText("\n",1),t.stopPropagation(),t.preventDefault())},!1),/msie/i.test(navigator.userAgent)&&this._domInputControl.addEventListener("keyup",function(t){t.keyCode===cc.KEY.backspace&&i._processDomInputString(i._domInputControl.value)},!1),window.addEventListener("mousedown",function(t){var e=t.pageY||0;i._lastClickPosition.x=t.pageX||0,i._lastClickPosition.y=e},!1))},_processDomInputString:function(t){for(var e=(this._currentInputString.length<t.length?this._currentInputString:t).length,i=0;i<e&&t[i]===this._currentInputString[i];i++);var n=this._currentInputString.length-i,s=t.length-i;for(e=0;e<n;e++)this.dispatchDeleteBackward();for(e=0;e<s;e++)this.dispatchInsertText(t[i+e],1);this._currentInputString=t},dispatchInsertText:function(t,e){!this.impl||!t||e<=0||this.impl._delegateWithIme&&this.impl._delegateWithIme.insertText(t,e)},dispatchDeleteBackward:function(){this.impl&&this.impl._delegateWithIme&&this.impl._delegateWithIme.deleteBackward()},getContentText:function(){return this.impl&&this.impl._delegateWithIme&&this.impl._delegateWithIme.getContentText()||""},dispatchKeyboardWillShow:function(t){if(this.impl)for(var e=0;e<this.impl._delegateList.length;e++){var i=this.impl._delegateList[e];i&&i.keyboardWillShow(t)}},dispatchKeyboardDidShow:function(t){if(this.impl)for(var e=0;e<this.impl._delegateList.length;e++){var i=this.impl._delegateList[e];i&&i.keyboardDidShow(t)}},dispatchKeyboardWillHide:function(t){if(this.impl)for(var e=0;e<this.impl._delegateList.length;e++){var i=this.impl._delegateList[e];i&&i.keyboardWillHide(t)}},dispatchKeyboardDidHide:function(t){if(this.impl)for(var e=0;e<this.impl._delegateList.length;e++){var i=this.impl._delegateList[e];i&&i.keyboardDidHide(t)}},addDelegate:function(t){t&&this.impl&&(-1<this.impl._delegateList.indexOf(t)||this.impl._delegateList.splice(0,0,t))},attachDelegateWithIME:function(t){var e;return!(!this.impl||!t||-1===this.impl._delegateList.indexOf(t)||(this.impl._delegateWithIme?!this.impl._delegateWithIme.canDetachWithIME()||!t.canAttachWithIME()||(e=this.impl._delegateWithIme,this.impl._delegateWithIme=null,e.didDetachWithIME(),this._focusDomInput(t),0):!t.canAttachWithIME()||(this._focusDomInput(t),0)))},_focusDomInput:function(t){var e;cc.sys.isMobile?((this.impl._delegateWithIme=t).didAttachWithIME(),this._currentInputString=t.string||"",t=t.getTipMessage?t.getTipMessage():"please enter your word:",null!=(t=(e=window.Window)&&e.prototype.prompt&&e.prototype.prompt!=prompt?e.prototype.prompt.call(window,t,this._currentInputString):prompt(t,this._currentInputString))&&this._processDomInputString(t),this.dispatchInsertText("\n",1)):(this.impl._delegateWithIme=t,this._currentInputString=t.string||"",t.didAttachWithIME(),this._domInputControl.focus(),this._domInputControl.value=this._currentInputString,this._domInputControlTranslate())},_domInputControlTranslate:function(){/msie/i.test(navigator.userAgent)?(this._domInputControl.style.left=this._lastClickPosition.x+"px",this._domInputControl.style.top=this._lastClickPosition.y+"px"):this._domInputControl.translates(this._lastClickPosition.x,this._lastClickPosition.y)},detachDelegateWithIME:function(t){return!!(this.impl&&t&&this.impl._delegateWithIme===t&&t.canDetachWithIME())&&(this.impl._delegateWithIme=null,t.didDetachWithIME(),cc._canvas.focus(),!0)},removeDelegate:function(t){this.impl&&t&&-1!==this.impl._delegateList.indexOf(t)&&(this.impl._delegateWithIme&&t===this.impl._delegateWithIme&&(this.impl._delegateWithIme=null),cc.arrayRemoveObject(this.impl._delegateList,t))},processKeycode:function(t){t<32?t===cc.KEY.backspace?this.dispatchDeleteBackward():t===cc.KEY.enter&&this.dispatchInsertText("\n",1):t<255&&this.dispatchInsertText(String.fromCharCode(t),1)}}),cc.IMEDispatcher.Impl=cc.Class.extend({_delegateWithIme:null,_delegateList:null,ctor:function(){this._delegateList=[]},findDelegate:function(t){for(var e=0;e<this._delegateList.length;e++)if(this._delegateList[e]===t)return e;return null}}),cc.imeDispatcher=new cc.IMEDispatcher,document.body?cc.imeDispatcher.init():window.addEventListener("load",function(){cc.imeDispatcher.init()},!1),cc.TextFieldDelegate=cc.Class.extend({onTextFieldAttachWithIME:function(t){return!1},onTextFieldDetachWithIME:function(t){return!1},onTextFieldInsertText:function(t,e,i){return!1},onTextFieldDeleteBackward:function(t,e,i){return!1},onDraw:function(t){return!1}}),cc.TextFieldTTF=cc.LabelTTF.extend({delegate:null,colorSpaceHolder:null,_colorText:null,_lens:null,_inputText:"",_placeHolder:"",_charCount:0,_className:"TextFieldTTF",ctor:function(t,e,i,n,s){this.colorSpaceHolder=cc.color(127,127,127),this._colorText=cc.color(255,255,255,255),cc.LabelTTF.prototype.ctor.call(this),void 0!==s?(this.initWithPlaceHolder("",e,i,n,s),t&&this.setPlaceHolder(t)):void 0===n&&void 0!==i&&(this.initWithString("",e,i),t)&&this.setPlaceHolder(t)},onEnter:function(){cc.LabelTTF.prototype.onEnter.call(this),cc.imeDispatcher.addDelegate(this)},onExit:function(){cc.LabelTTF.prototype.onExit.call(this),cc.imeDispatcher.removeDelegate(this)},getDelegate:function(){return this.delegate},setDelegate:function(t){this.delegate=t},getCharCount:function(){return this._charCount},getColorSpaceHolder:function(){return cc.color(this.colorSpaceHolder)},setColorSpaceHolder:function(t){this.colorSpaceHolder.r=t.r,this.colorSpaceHolder.g=t.g,this.colorSpaceHolder.b=t.b,this.colorSpaceHolder.a=cc.isUndefined(t.a)?255:t.a,this._inputText.length||this.setColor(this.colorSpaceHolder)},setTextColor:function(t){this._colorText.r=t.r,this._colorText.g=t.g,this._colorText.b=t.b,this._colorText.a=cc.isUndefined(t.a)?255:t.a,this._inputText.length&&this.setColor(this._colorText)},initWithPlaceHolder:function(t,e,i,n,s){switch(arguments.length){case 5:return t&&this.setPlaceHolder(t),this.initWithString(this._placeHolder,n,s,e,i);case 3:return t&&this.setPlaceHolder(t),this.initWithString(this._placeHolder,e,i);default:throw Error("Argument must be non-nil ")}},setString:function(t){this._inputText=(t=String(t))||"",this._inputText.length?(cc.LabelTTF.prototype.setString.call(this,this._inputText),this.setColor(this._colorText)):(cc.LabelTTF.prototype.setString.call(this,this._placeHolder),this.setColor(this.colorSpaceHolder)),cc._renderType===cc.game.RENDER_TYPE_CANVAS&&this._renderCmd._updateTexture(),this._charCount=this._inputText.length},getString:function(){return this._inputText},setPlaceHolder:function(t){this._placeHolder=t||"",this._inputText.length||(cc.LabelTTF.prototype.setString.call(this,this._placeHolder),this.setColor(this.colorSpaceHolder))},getPlaceHolder:function(){return this._placeHolder},draw:function(t){t=t||cc._renderContext,this.delegate&&this.delegate.onDraw(this)||cc.LabelTTF.prototype.draw.call(this,t)},attachWithIME:function(){return cc.imeDispatcher.attachDelegateWithIME(this)},detachWithIME:function(){return cc.imeDispatcher.detachDelegateWithIME(this)},canAttachWithIME:function(){return!this.delegate||!this.delegate.onTextFieldAttachWithIME(this)},didAttachWithIME:function(){},canDetachWithIME:function(){return!this.delegate||!this.delegate.onTextFieldDetachWithIME(this)},didDetachWithIME:function(){},deleteBackward:function(){var t=this._inputText.length;0===t||this.delegate&&this.delegate.onTextFieldDeleteBackward(this,this._inputText[t-1],1)||(t<=1?(this._inputText="",this._charCount=0,cc.LabelTTF.prototype.setString.call(this,this._placeHolder),this.setColor(this.colorSpaceHolder)):this.string=this._inputText.substring(0,t-1))},removeDelegate:function(){cc.imeDispatcher.removeDelegate(this)},_tipMessage:"please enter your word:",setTipMessage:function(t){null!=t&&(this._tipMessage=t)},getTipMessage:function(){return this._tipMessage},insertText:function(t,e){var i=t.indexOf("\n");if(0<(t=-1<i?t.substring(0,i):t).length){if(this.delegate&&this.delegate.onTextFieldInsertText(this,t,t.length))return;t=this._inputText+t,this._charCount=t.length,this.string=t}-1===i||this.delegate&&this.delegate.onTextFieldInsertText(this,"\n",1)||this.detachWithIME()},getContentText:function(){return this._inputText},keyboardWillShow:function(t){},keyboardDidShow:function(t){},keyboardWillHide:function(t){},keyboardDidHide:function(t){}}),_p=cc.TextFieldTTF.prototype,cc.defineGetterSetter(_p,"charCount",_p.getCharCount),cc.defineGetterSetter(_p,"placeHolder",_p.getPlaceHolder,_p.setPlaceHolder),cc.TextFieldTTF.create=function(t,e,i,n,s){return new cc.TextFieldTTF(t,e,i,n,s)},cc._globalFontSize=cc.ITEM_SIZE,cc._globalFontName="Arial",cc._globalFontNameRelease=!1,cc.MenuItem=cc.Node.extend({_enabled:!1,_target:null,_callback:null,_isSelected:!1,_className:"MenuItem",ctor:function(t,e){var i=cc.Node.prototype;i.ctor.call(this),this._callback=this._target=null,this._enabled=this._isSelected=!1,i.setAnchorPoint.call(this,.5,.5),this._target=e||null,(this._callback=t||null)&&(this._enabled=!0)},isSelected:function(){return this._isSelected},setOpacityModifyRGB:function(t){},isOpacityModifyRGB:function(){return!1},setTarget:function(t,e){this._target=e,this._callback=t},isEnabled:function(){return this._enabled},setEnabled:function(t){this._enabled=t},initWithCallback:function(t,e){return this.anchorY=this.anchorX=.5,this._target=e,this._callback=t,this._enabled=!0,!(this._isSelected=!1)},rect:function(){var t=this._position,e=this._contentSize,i=this._anchorPoint;return cc.rect(t.x-e.width*i.x,t.y-e.height*i.y,e.width,e.height)},selected:function(){this._isSelected=!0},unselected:function(){this._isSelected=!1},setCallback:function(t,e){this._target=e,this._callback=t},activate:function(){var t,e;this._enabled&&(t=this._target,e=this._callback)&&(t&&cc.isString(e)?t[e](this):t&&cc.isFunction(e)?e.call(t,this):e(this))}}),_p=cc.MenuItem.prototype,cc.defineGetterSetter(_p,"enabled",_p.isEnabled,_p.setEnabled),cc.MenuItem.create=function(t,e){return new cc.MenuItem(t,e)},cc.MenuItemLabel=cc.MenuItem.extend({_disabledColor:null,_label:null,_originalScale:0,_colorBackup:null,ctor:function(t,e,i){cc.MenuItem.prototype.ctor.call(this,e,i),this._colorBackup=this._label=this._disabledColor=null,t&&(this._originalScale=1,this._colorBackup=cc.color.WHITE,this._disabledColor=cc.color(126,126,126),this.setLabel(t),t.textureLoaded&&!t.textureLoaded()&&t.addEventListener("load",function(t){this.width=t.width,this.height=t.height,this.parent instanceof cc.Menu&&this.parent.updateAlign()},this),this.setCascadeColorEnabled(!0),this.setCascadeOpacityEnabled(!0))},getDisabledColor:function(){return this._disabledColor},setDisabledColor:function(t){this._disabledColor=t},getLabel:function(){return this._label},setLabel:function(t){t&&(this.addChild(t),t.anchorX=0,t.anchorY=0,this.width=t.width,this.height=t.height,t.setCascadeColorEnabled(!0)),this._label&&this.removeChild(this._label,!0),this._label=t},setEnabled:function(t){this._enabled!==t&&(t?this.setColor(this._colorBackup):(this._colorBackup=this.color,this.setColor(this._disabledColor))),cc.MenuItem.prototype.setEnabled.call(this,t)},initWithLabel:function(t,e,i){return this.initWithCallback(e,i),this._originalScale=1,this._colorBackup=cc.color.WHITE,this._disabledColor=cc.color(126,126,126),this.setLabel(t),this.setCascadeColorEnabled(!0),this.setCascadeOpacityEnabled(!0),!0},setString:function(t){this._label.string=t,this.width=this._label.width,this.height=this._label.height},getString:function(){return this._label.string},activate:function(){this._enabled&&(this.stopAllActions(),this.scale=this._originalScale,cc.MenuItem.prototype.activate.call(this))},selected:function(){var t;this._enabled&&(cc.MenuItem.prototype.selected.call(this),(t=this.getActionByTag(cc.ZOOM_ACTION_TAG))?this.stopAction(t):this._originalScale=this.scale,(t=cc.scaleTo(.1,1.2*this._originalScale)).setTag(cc.ZOOM_ACTION_TAG),this.runAction(t))},unselected:function(){var t;this._enabled&&(cc.MenuItem.prototype.unselected.call(this),this.stopActionByTag(cc.ZOOM_ACTION_TAG),(t=cc.scaleTo(.1,this._originalScale)).setTag(cc.ZOOM_ACTION_TAG),this.runAction(t))}}),_p=cc.MenuItemLabel.prototype,cc.defineGetterSetter(_p,"string",_p.getString,_p.setString),cc.defineGetterSetter(_p,"disabledColor",_p.getDisabledColor,_p.setDisabledColor),cc.defineGetterSetter(_p,"label",_p.getLabel,_p.setLabel),cc.MenuItemLabel.create=function(t,e,i){return new cc.MenuItemLabel(t,e,i)},cc.MenuItemAtlasFont=cc.MenuItemLabel.extend({ctor:function(t,e,i,n,s,r,o){var a;t&&0<t.length&&(a=new cc.LabelAtlas(t,e,i,n,s)),cc.MenuItemLabel.prototype.ctor.call(this,a,r,o)},initWithString:function(t,e,i,n,s,r,o){var a;if(t&&0!==t.length)return(a=new cc.LabelAtlas).initWithString(t,e,i,n,s),this.initWithLabel(a,r,o),!0;throw Error("cc.MenuItemAtlasFont.initWithString(): value should be non-null and its length should be greater than 0")}}),cc.MenuItemAtlasFont.create=function(t,e,i,n,s,r,o){return new cc.MenuItemAtlasFont(t,e,i,n,s,r,o)},cc.MenuItemFont=cc.MenuItemLabel.extend({_fontSize:null,_fontName:null,ctor:function(t,e,i){var n;t&&0<t.length?(this._fontName=cc._globalFontName,this._fontSize=cc._globalFontSize,n=new cc.LabelTTF(t,this._fontName,this._fontSize)):(this._fontSize=0,this._fontName=""),cc.MenuItemLabel.prototype.ctor.call(this,n,e,i)},initWithString:function(t,e,i){if(t&&0!==t.length)return this._fontName=cc._globalFontName,this._fontSize=cc._globalFontSize,t=new cc.LabelTTF(t,this._fontName,this._fontSize),this.initWithLabel(t,e,i),!0;throw Error("Value should be non-null and its length should be greater than 0")},setFontSize:function(t){this._fontSize=t,this._recreateLabel()},getFontSize:function(){return this._fontSize},setFontName:function(t){this._fontName=t,this._recreateLabel()},getFontName:function(){return this._fontName},_recreateLabel:function(){var t=new cc.LabelTTF(this._label.string,this._fontName,this._fontSize);this.setLabel(t)}}),cc.MenuItemFont.setFontSize=function(t){cc._globalFontSize=t},cc.MenuItemFont.fontSize=function(){return cc._globalFontSize},cc.MenuItemFont.setFontName=function(t){cc._globalFontNameRelease&&(cc._globalFontName=""),cc._globalFontName=t,cc._globalFontNameRelease=!0},_p=cc.MenuItemFont.prototype,cc.defineGetterSetter(_p,"fontSize",_p.getFontSize,_p.setFontSize),cc.defineGetterSetter(_p,"fontName",_p.getFontName,_p.setFontName),cc.MenuItemFont.fontName=function(){return cc._globalFontName},cc.MenuItemFont.create=function(t,e,i){return new cc.MenuItemFont(t,e,i)},cc.MenuItemSprite=cc.MenuItem.extend({_normalImage:null,_selectedImage:null,_disabledImage:null,ctor:function(t,e,i,n,s){var r,o,a;if(cc.MenuItem.prototype.ctor.call(this),this._disabledImage=this._selectedImage=this._normalImage=null,this._loader=new cc.Sprite.LoadManager,void 0!==t)return e=e||null,void 0!==s?(r=i,a=n,o=s):void 0!==n&&cc.isFunction(n)?(r=i,a=n):void 0!==n&&cc.isFunction(i)?(o=n,a=i,r=null):void 0===i&&(r=null),this._loader.clear(),t.textureLoaded&&!t.textureLoaded()?(this._loader.once(t,function(){this.initWithNormalSprite(t,e,r,a,o)},this),!1):(this.initWithNormalSprite(t,e,r,a,o),!0)},getNormalImage:function(){return this._normalImage},setNormalImage:function(t){this._normalImage!==t&&(t&&(this.addChild(t,0,cc.NORMAL_TAG),t.anchorX=0,t.anchorY=0),this._normalImage&&this.removeChild(this._normalImage,!0),this._normalImage=t)&&(this.width=this._normalImage.width,this.height=this._normalImage.height,this._updateImagesVisibility(),t.textureLoaded&&!t.textureLoaded()&&t.addEventListener("load",function(t){this.width=t.width,this.height=t.height,this.parent instanceof cc.Menu&&this.parent.updateAlign()},this))},getSelectedImage:function(){return this._selectedImage},setSelectedImage:function(t){this._selectedImage!==t&&(t&&(this.addChild(t,0,cc.SELECTED_TAG),t.anchorX=0,t.anchorY=0),this._selectedImage&&this.removeChild(this._selectedImage,!0),this._selectedImage=t,this._updateImagesVisibility())},getDisabledImage:function(){return this._disabledImage},setDisabledImage:function(t){this._disabledImage!==t&&(t&&(this.addChild(t,0,cc.DISABLE_TAG),t.anchorX=0,t.anchorY=0),this._disabledImage&&this.removeChild(this._disabledImage,!0),this._disabledImage=t,this._updateImagesVisibility())},initWithNormalSprite:function(t,e,i,n,s){if(this._loader.clear(),t.textureLoaded&&!t.textureLoaded())return this._loader.once(t,function(){this.initWithNormalSprite(t,e,i,n,s)},this),!1;this.initWithCallback(n,s),this.setNormalImage(t),this.setSelectedImage(e),this.setDisabledImage(i);var r=this._normalImage;return r&&(this.width=r.width,this.height=r.height),this.setCascadeColorEnabled(!0),this.setCascadeOpacityEnabled(!0),!0},selected:function(){cc.MenuItem.prototype.selected.call(this),this._normalImage&&(this._disabledImage&&(this._disabledImage.visible=!1),this._selectedImage?(this._normalImage.visible=!1,this._selectedImage.visible=!0):this._normalImage.visible=!0)},unselected:function(){cc.MenuItem.prototype.unselected.call(this),this._normalImage&&(this._normalImage.visible=!0,this._selectedImage&&(this._selectedImage.visible=!1),this._disabledImage)&&(this._disabledImage.visible=!1)},setEnabled:function(t){this._enabled!==t&&(cc.MenuItem.prototype.setEnabled.call(this,t),this._updateImagesVisibility())},_updateImagesVisibility:function(){var t=this._normalImage,e=this._selectedImage,i=this._disabledImage;this._enabled?(t&&(t.visible=!0),e&&(e.visible=!1),i&&(i.visible=!1)):i?(t&&(t.visible=!1),e&&(e.visible=!1),i&&(i.visible=!0)):(t&&(t.visible=!0),e&&(e.visible=!1))}}),_p=cc.MenuItemSprite.prototype,cc.defineGetterSetter(_p,"normalImage",_p.getNormalImage,_p.setNormalImage),cc.defineGetterSetter(_p,"selectedImage",_p.getSelectedImage,_p.setSelectedImage),cc.defineGetterSetter(_p,"disabledImage",_p.getDisabledImage,_p.setDisabledImage),cc.MenuItemSprite.create=function(t,e,i,n,s){return new cc.MenuItemSprite(t,e,i,n,s||void 0)},cc.MenuItemImage=cc.MenuItemSprite.extend({ctor:function(t,e,i,n,s){var r=null,o=null,a=null,c=null;null==t?cc.MenuItemSprite.prototype.ctor.call(this):(t=new cc.Sprite(t),e&&(r=new cc.Sprite(e)),void 0===n?a=i:void 0===s?(a=i,c=n):s&&(o=new cc.Sprite(i),a=n,c=s),cc.MenuItemSprite.prototype.ctor.call(this,t,r,o,a,c))},setNormalSpriteFrame:function(t){this.setNormalImage(new cc.Sprite(t))},setSelectedSpriteFrame:function(t){this.setSelectedImage(new cc.Sprite(t))},setDisabledSpriteFrame:function(t){this.setDisabledImage(new cc.Sprite(t))},initWithNormalImage:function(t,e,i,n,s){var r=null,o=null,a=null;return t&&(r=new cc.Sprite(t)),e&&(o=new cc.Sprite(e)),i&&(a=new cc.Sprite(i)),this.initWithNormalSprite(r,o,a,n,s)}}),cc.MenuItemImage.create=function(t,e,i,n,s){return new cc.MenuItemImage(t,e,i,n,s)},cc.MenuItemToggle=cc.MenuItem.extend({subItems:null,_selectedIndex:0,_opacity:null,_color:null,ctor:function(){cc.MenuItem.prototype.ctor.call(this),this._selectedIndex=0,this.subItems=[],this._opacity=0,this._color=cc.color.WHITE,0<arguments.length&&this.initWithItems(Array.prototype.slice.apply(arguments))},getOpacity:function(){return this._opacity},setOpacity:function(t){if(this._opacity=t,this.subItems&&0<this.subItems.length)for(var e=0;e<this.subItems.length;e++)this.subItems[e].opacity=t;this._color.a=t},getColor:function(){var t=this._color;return cc.color(t.r,t.g,t.b,t.a)},setColor:function(t){var e=this._color;if(e.r=t.r,e.g=t.g,e.b=t.b,this.subItems&&0<this.subItems.length)for(e=0;e<this.subItems.length;e++)this.subItems[e].setColor(t);void 0===t.a||t.a_undefined||this.setOpacity(t.a)},getSelectedIndex:function(){return this._selectedIndex},setSelectedIndex:function(t){var e,i;t!==this._selectedIndex&&(this._selectedIndex=t,(t=this.getChildByTag(cc.CURRENT_ITEM))&&t.removeFromParent(!1),t=this.subItems[this._selectedIndex],this.addChild(t,0,cc.CURRENT_ITEM),e=t.width,i=t.height,this.width=e,this.height=i,t.setPosition(e/2,i/2))},getSubItems:function(){return this.subItems},setSubItems:function(t){this.subItems=t},initWithItems:function(t){var e=t.length;cc.isFunction(t[t.length-2])?(this.initWithCallback(t[t.length-2],t[t.length-1]),e-=2):cc.isFunction(t[t.length-1])?(this.initWithCallback(t[t.length-1],null),--e):this.initWithCallback(null,null);for(var i=this.subItems,n=i.length=0;n<e;n++)t[n]&&i.push(t[n]);return this._selectedIndex=cc.UINT_MAX,this.setSelectedIndex(0),this.setCascadeColorEnabled(!0),this.setCascadeOpacityEnabled(!0),!0},addSubItem:function(t){this.subItems.push(t)},activate:function(){this._enabled&&this.setSelectedIndex((this._selectedIndex+1)%this.subItems.length),cc.MenuItem.prototype.activate.call(this)},selected:function(){cc.MenuItem.prototype.selected.call(this),this.subItems[this._selectedIndex].selected()},unselected:function(){cc.MenuItem.prototype.unselected.call(this),this.subItems[this._selectedIndex].unselected()},setEnabled:function(t){if(this._enabled!==t){cc.MenuItem.prototype.setEnabled.call(this,t);var e=this.subItems;if(e&&0<e.length)for(var i=0;i<e.length;i++)e[i].enabled=t}},selectedItem:function(){return this.subItems[this._selectedIndex]},getSelectedItem:function(){return this.subItems[this._selectedIndex]},onEnter:function(){cc.Node.prototype.onEnter.call(this),this.setSelectedIndex(this._selectedIndex)}}),_p=cc.MenuItemToggle.prototype,cc.defineGetterSetter(_p,"selectedIndex",_p.getSelectedIndex,_p.setSelectedIndex),cc.MenuItemToggle.create=function(){0<arguments.length&&null==arguments[arguments.length-1]&&cc.log("parameters should not be ending with null in Javascript");var t=new cc.MenuItemToggle;return t.initWithItems(Array.prototype.slice.apply(arguments)),t},cc.MENU_STATE_WAITING=0,cc.MENU_STATE_TRACKING_TOUCH=1,cc.MENU_HANDLER_PRIORITY=-128,cc.DEFAULT_PADDING=5,cc.Menu=cc.Layer.extend({enabled:!1,_selectedItem:null,_state:-1,_touchListener:null,_className:"Menu",ctor:function(t){cc.Layer.prototype.ctor.call(this),this._color=cc.color.WHITE,this.enabled=!1,this._opacity=255,this._selectedItem=null,this._state=-1,this._touchListener=cc.EventListener.create({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:this._onTouchBegan,onTouchMoved:this._onTouchMoved,onTouchEnded:this._onTouchEnded,onTouchCancelled:this._onTouchCancelled});var e=arguments.length;if(t instanceof Array)i=t;else if(0===e)i=[];else if(0<e)for(var i=[],n=0;n<e;n++)arguments[n]&&i.push(arguments[n]);this.initWithArray(i)},onEnter:function(){var t=this._touchListener;t._isRegistered()||cc.eventManager.addListener(t,this),cc.Node.prototype.onEnter.call(this)},isEnabled:function(){return this.enabled},setEnabled:function(t){this.enabled=t},initWithItems:function(t){var e=[];if(t)for(var i=0;i<t.length;i++)t[i]&&e.push(t[i]);return this.initWithArray(e)},initWithArray:function(t){if(cc.Layer.prototype.init.call(this)){this.enabled=!0;var e=cc.winSize;if(this.setPosition(e.width/2,e.height/2),this.setContentSize(e),this.setAnchorPoint(.5,.5),this.ignoreAnchorPointForPosition(!0),t)for(e=0;e<t.length;e++)this.addChild(t[e],e);return this._selectedItem=null,this._state=cc.MENU_STATE_WAITING,this.cascadeOpacity=this.cascadeColor=!0}return!1},addChild:function(t,e,i){if(!(t instanceof cc.MenuItem))throw Error("cc.Menu.addChild() : Menu only supports MenuItem objects as children");cc.Layer.prototype.addChild.call(this,t,e,i)},updateAlign:function(){switch(this._align){case"vertically":this.alignItemsVertically();break;case"horizontally":this.alignItemsHorizontally()}},alignItemsVertically:function(){this.alignItemsVerticallyWithPadding(cc.DEFAULT_PADDING)},alignItemsVerticallyWithPadding:function(t){this._align="vertically";var e,i,n=-t,s=this._children;if(s&&0<s.length){for(o=0,a=s.length;o<a;o++)n+=s[o].height*s[o].scaleY+t;for(var r=n/2,o=0,a=s.length;o<a;o++)e=(i=s[o]).height,n=i.scaleY,i.setPosition(0,r-e*n/2),r-=e*n+t}},alignItemsHorizontally:function(){this.alignItemsHorizontallyWithPadding(cc.DEFAULT_PADDING)},alignItemsHorizontallyWithPadding:function(t){this._align="horizontally";var e,i,n=-t,s=this._children;if(s&&0<s.length){for(o=0,a=s.length;o<a;o++)n+=s[o].width*s[o].scaleX+t;for(var r=-n/2,o=0,a=s.length;o<a;o++)n=(i=s[o]).scaleX,e=s[o].width,i.setPosition(r+e*n/2,0),r+=e*n+t}},alignItemsInColumns:function(){0<arguments.length&&null==arguments[arguments.length-1]&&cc.log("parameters should not be ending with null in Javascript");for(var t=[],e=0;e<arguments.length;e++)t.push(arguments[e]);var i,n,s,r=-5,o=0,a=0,c=0,h=this._children;if(h&&0<h.length)for(e=0,s=h.length;e<s;e++)t.length<=o||!(i=t[o])||(a=(n=h[e].height)<=a||isNaN(n)?a:n,i<=++c&&(r+=a+5,a=c=0,++o));var l=cc.director.getWinSize(),u=i=a=o=0,d=0,r=r/2;if(h&&0<h.length)for(e=0,s=h.length;e<s;e++){var _=h[e];0===i&&(d=u=l.width/(1+(i=t[o]))),a=(n=_._getHeight())<=a||isNaN(n)?a:n,_.setPosition(d-l.width/2,r-n/2),d+=u,i<=++c&&(r-=a+5,a=i=c=0,++o)}},alignItemsInRows:function(){0<arguments.length&&null==arguments[arguments.length-1]&&cc.log("parameters should not be ending with null in Javascript");for(var t=[],e=0;e<arguments.length;e++)t.push(arguments[e]);var i,n,s,r=[],o=[],a=-10,c=-5,h=0,l=0,u=0,d=this._children;if(d&&0<d.length)for(e=0,n=d.length;e<n;e++)i=d[e],t.length<=h||!(_=t[h])||(l=(s=i.width)<=l||isNaN(s)?l:s,c+=i.height+5,_<=++u&&(r.push(l),o.push(c),a+=l+10,l=u=0,c=-5,++h));var c=cc.director.getWinSize(),_=l=h=0,a=-a/2,p=0;if(d&&0<d.length)for(e=0,n=d.length;e<n;e++)i=d[e],0===_&&(_=t[h],p=o[h]),l=(s=i._getWidth())<=l||isNaN(s)?l:s,i.setPosition(a+r[h]/2,p-c.height/2),p-=i.height+10,_<=++u&&(a+=l+5,l=_=u=0,++h)},removeChild:function(t,e){null!=t&&(t instanceof cc.MenuItem?(this._selectedItem===t&&(this._selectedItem=null),cc.Node.prototype.removeChild.call(this,t,e)):cc.log("cc.Menu.removeChild():Menu only supports MenuItem objects as children"))},_onTouchBegan:function(t,e){e=e.getCurrentTarget();if(e._state!==cc.MENU_STATE_WAITING||!e._visible||!e.enabled)return!1;for(var i=e.parent;null!=i;i=i.parent)if(!i.isVisible())return!1;return e._selectedItem=e._itemForTouch(t),!!e._selectedItem&&(e._state=cc.MENU_STATE_TRACKING_TOUCH,e._selectedItem.selected(),e._selectedItem.setNodeDirty(),!0)},_onTouchEnded:function(t,e){e=e.getCurrentTarget();e._state!==cc.MENU_STATE_TRACKING_TOUCH?cc.log("cc.Menu.onTouchEnded(): invalid state"):(e._selectedItem&&(e._selectedItem.unselected(),e._selectedItem.setNodeDirty(),e._selectedItem.activate()),e._state=cc.MENU_STATE_WAITING)},_onTouchCancelled:function(t,e){e=e.getCurrentTarget();e._state!==cc.MENU_STATE_TRACKING_TOUCH?cc.log("cc.Menu.onTouchCancelled(): invalid state"):(e._selectedItem&&(e._selectedItem.unselected(),e._selectedItem.setNodeDirty()),e._state=cc.MENU_STATE_WAITING)},_onTouchMoved:function(t,e){e=e.getCurrentTarget();e._state!==cc.MENU_STATE_TRACKING_TOUCH?cc.log("cc.Menu.onTouchMoved(): invalid state"):(t=e._itemForTouch(t))!==e._selectedItem&&(e._selectedItem&&(e._selectedItem.unselected(),e._selectedItem.setNodeDirty()),e._selectedItem=t,e._selectedItem)&&(e._selectedItem.selected(),e._selectedItem.setNodeDirty())},onExit:function(){this._state===cc.MENU_STATE_TRACKING_TOUCH&&(this._selectedItem&&(this._selectedItem.unselected(),this._selectedItem=null),this._state=cc.MENU_STATE_WAITING),cc.Node.prototype.onExit.call(this)},setOpacityModifyRGB:function(t){},isOpacityModifyRGB:function(){return!1},_itemForTouch:function(t){t=t.getLocation();var e,i=this._children;if(i&&0<i.length)for(var n=i.length-1;0<=n;n--)if((e=i[n]).isVisible()&&e.isEnabled()){var s=e.convertToNodeSpace(t),r=e.rect();if(r.x=0,r.y=0,cc.rectContainsPoint(r,s))return e}return null}}),_p=cc.Menu.prototype,cc.Menu.create=function(t){var e=arguments.length;return 0<e&&null==arguments[e-1]&&cc.log("parameters should not be ending with null in Javascript"),0===e?new cc.Menu:1===e?new cc.Menu(t):new cc.Menu(Array.prototype.slice.call(arguments,0))},cc.Codec.GZip=function(t){this.data=t,this.debug=!1,this.gpflags=void 0,this.files=0,this.unzipped=[],this.buf32k=Array(32768),this.bIdx=0,this.modeZIP=!1,this.bytepos=0,this.bb=1,this.bits=0,this.nameBuf=[],this.fileout=void 0,this.literalTree=Array(cc.Codec.GZip.LITERALS),this.distanceTree=Array(32),this.treepos=0,this.Places=null,this.len=0,this.fpos=Array(17),this.fpos[0]=0,this.fmax=this.flens=void 0},cc.Codec.GZip.gunzip=function(t){return new cc.Codec.GZip(t).gunzip()[0][0]},cc.Codec.GZip.HufNode=function(){this.b1=this.b0=0,this.jump=null,this.jumppos=-1},cc.Codec.GZip.LITERALS=288,cc.Codec.GZip.NAMEMAX=256,cc.Codec.GZip.bitReverse=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,3,131,67,195,35,163,99,227,19,147,83,211,51,179,115,243,11,139,75,203,43,171,107,235,27,155,91,219,59,187,123,251,7,135,71,199,39,167,103,231,23,151,87,215,55,183,119,247,15,143,79,207,47,175,111,239,31,159,95,223,63,191,127,255],cc.Codec.GZip.cplens=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],cc.Codec.GZip.cplext=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99],cc.Codec.GZip.cpdist=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],cc.Codec.GZip.cpdext=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],cc.Codec.GZip.border=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],cc.Codec.GZip.prototype.gunzip=function(){return this.outputArr=[],this.nextFile(),this.unzipped},cc.Codec.GZip.prototype.readByte=function(){return this.bits+=8,this.bytepos<this.data.length?this.data.charCodeAt(this.bytepos++):-1},cc.Codec.GZip.prototype.byteAlign=function(){this.bb=1},cc.Codec.GZip.prototype.readBit=function(){var t;return this.bits++,t=1&this.bb,this.bb>>=1,0===this.bb&&(this.bb=this.readByte(),t=1&this.bb,this.bb=this.bb>>1|128),t},cc.Codec.GZip.prototype.readBits=function(t){for(var e=0,i=t;i--;)e=e<<1|this.readBit();return e=t?cc.Codec.GZip.bitReverse[e]>>8-t:e},cc.Codec.GZip.prototype.flushBuffer=function(){this.bIdx=0},cc.Codec.GZip.prototype.addBuffer=function(t){this.buf32k[this.bIdx++]=t,this.outputArr.push(String.fromCharCode(t)),32768===this.bIdx&&(this.bIdx=0)},cc.Codec.GZip.prototype.IsPat=function(){for(;;){if(this.fpos[this.len]>=this.fmax)return-1;if(this.flens[this.fpos[this.len]]===this.len)return this.fpos[this.len]++;this.fpos[this.len]++}},cc.Codec.GZip.prototype.Rec=function(){var t,e=this.Places[this.treepos];if(17===this.len)return-1;if(this.treepos++,this.len++,0<=(t=this.IsPat()))e.b0=t;else if(e.b0=32768,this.Rec())return-1;if(0<=(t=this.IsPat()))e.b1=t,e.jump=null;else if(e.b1=32768,e.jump=this.Places[this.treepos],e.jumppos=this.treepos,this.Rec())return-1;return this.len--,0},cc.Codec.GZip.prototype.CreateTree=function(t,e,i,n){for(this.Places=t,this.treepos=0,this.flens=i,this.fmax=e,t=0;t<17;t++)this.fpos[t]=0;return this.len=0,this.Rec()?-1:0},cc.Codec.GZip.prototype.DecodeValue=function(t){for(var e,i,n=0,s=t[n];;)if(this.readBit()){if(!(32768&s.b1))return s.b1;for(s=s.jump,e=t.length,i=0;i<e;i++)if(t[i]===s){n=i;break}}else{if(!(32768&s.b0))return s.b0;s=t[++n]}return-1},cc.Codec.GZip.prototype.DeflateLoop=function(){var t,e;do{if(t=this.readBit(),0===(a=this.readBits(2)))for(this.byteAlign(),a=this.readByte(),a|=this.readByte()<<8,n=this.readByte(),65535&(a^~(n|=this.readByte()<<8))&&document.write("BlockLen checksum mismatch\n");a--;)n=this.readByte(),this.addBuffer(n);else if(1===a)for(;;)if(23<(a=cc.Codec.GZip.bitReverse[this.readBits(7)]>>1)?199<(a=a<<1|this.readBit())?a=(a-=128)<<1|this.readBit():143<(a-=48)&&(a+=136):a+=256,a<256)this.addBuffer(a);else{if(256===a)break;for(a-=257,e=this.readBits(cc.Codec.GZip.cplext[a])+cc.Codec.GZip.cplens[a],a=cc.Codec.GZip.bitReverse[this.readBits(5)]>>3,8<cc.Codec.GZip.cpdext[a]?(s=this.readBits(8),s|=this.readBits(cc.Codec.GZip.cpdext[a]-8)<<8):s=this.readBits(cc.Codec.GZip.cpdext[a]),s+=cc.Codec.GZip.cpdist[a],a=0;a<e;a++)n=this.buf32k[this.bIdx-s&32767],this.addBuffer(n)}else if(2===a){var i=Array(320),n=257+this.readBits(5),s=1+this.readBits(5),r=4+this.readBits(4);for(a=0;a<19;a++)i[a]=0;for(a=0;a<r;a++)i[cc.Codec.GZip.border[a]]=this.readBits(3);for(e=this.distanceTree.length,r=0;r<e;r++)this.distanceTree[r]=new cc.Codec.GZip.HufNode;if(this.CreateTree(this.distanceTree,19,i,0))return this.flushBuffer(),1;e=n+s,r=0;for(var o,a;r<e;)if((a=this.DecodeValue(this.distanceTree))<16)i[r++]=a;else if(16===a){if(e<r+(a=3+this.readBits(2)))return this.flushBuffer(),1;for(o=r?i[r-1]:0;a--;)i[r++]=o}else{if(e<r+(a=17===a?3+this.readBits(3):11+this.readBits(7)))return this.flushBuffer(),1;for(;a--;)i[r++]=0}for(e=this.literalTree.length,r=0;r<e;r++)this.literalTree[r]=new cc.Codec.GZip.HufNode;if(this.CreateTree(this.literalTree,n,i,0))return this.flushBuffer(),1;for(e=this.literalTree.length,r=0;r<e;r++)this.distanceTree[r]=new cc.Codec.GZip.HufNode;for(a=[],r=n;r<i.length;r++)a[r-n]=i[r];if(this.CreateTree(this.distanceTree,s,a,0))return this.flushBuffer(),1;for(;;)if(256<=(a=this.DecodeValue(this.literalTree))){if(0===(a-=256))break;for(a--,e=this.readBits(cc.Codec.GZip.cplext[a])+cc.Codec.GZip.cplens[a],a=this.DecodeValue(this.distanceTree),8<cc.Codec.GZip.cpdext[a]?(s=this.readBits(8),s|=this.readBits(cc.Codec.GZip.cpdext[a]-8)<<8):s=this.readBits(cc.Codec.GZip.cpdext[a]),s+=cc.Codec.GZip.cpdist[a];e--;)n=this.buf32k[this.bIdx-s&32767],this.addBuffer(n)}else this.addBuffer(a)}}while(!t);return this.flushBuffer(),this.byteAlign(),0},cc.Codec.GZip.prototype.unzipFile=function(t){var e;for(this.gunzip(),e=0;e<this.unzipped.length;e++)if(this.unzipped[e][1]===t)return this.unzipped[e][0]},cc.Codec.GZip.prototype.nextFile=function(){this.outputArr=[],this.modeZIP=!1;var t=[];if(t[0]=this.readByte(),t[1]=this.readByte(),120===t[0]&&218===t[1]&&(this.DeflateLoop(),this.unzipped[this.files]=[this.outputArr.join(""),"geonext.gxt"],this.files++),31===t[0]&&139===t[1]&&(this.skipdir(),this.unzipped[this.files]=[this.outputArr.join(""),"file"],this.files++),80===t[0]&&75===t[1]&&(this.modeZIP=!0,t[2]=this.readByte(),t[3]=this.readByte(),3===t[2])&&4===t[3]){t[0]=this.readByte(),t[1]=this.readByte(),this.gpflags=this.readByte(),this.gpflags|=this.readByte()<<8,t=this.readByte(),t|=this.readByte()<<8,this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte();var e=(e=this.readByte())|this.readByte()<<8,i=this.readByte()|this.readByte()<<8,n=0;for(this.nameBuf=[];e--;){var s=this.readByte();"/"===s|":"===s?n=0:n<cc.Codec.GZip.NAMEMAX-1&&(this.nameBuf[n++]=String.fromCharCode(s))}this.fileout||(this.fileout=this.nameBuf);for(n=0;n<i;)this.readByte(),n++;8===t&&(this.DeflateLoop(),this.unzipped[this.files]=[this.outputArr.join(""),this.nameBuf.join("")],this.files++),this.skipdir()}},cc.Codec.GZip.prototype.skipdir=function(){var t,e=[];if(8&this.gpflags&&(e[0]=this.readByte(),e[1]=this.readByte(),e[2]=this.readByte(),e[3]=this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte()),this.modeZIP&&this.nextFile(),e[0]=this.readByte(),8!==e[0])return 0;if(this.gpflags=this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),4&this.gpflags)for(e[0]=this.readByte(),e[2]=this.readByte(),this.len=e[0]+256*e[1],e=0;e<this.len;e++)this.readByte();if(8&this.gpflags)for(e=0,this.nameBuf=[];t=this.readByte();)(e="7"!==t&&":"!==t?e:0)<cc.Codec.GZip.NAMEMAX-1&&(this.nameBuf[e++]=t);if(16&this.gpflags)for(;this.readByte(););2&this.gpflags&&(this.readByte(),this.readByte()),this.DeflateLoop(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.modeZIP&&this.nextFile()},!function(){function E(t){throw t}function t(t,e){var i,n=t.split("."),s=O;n[0]in s||!s.execScript||s.execScript("var "+n[0]);for(;n.length&&(i=n.shift());)n.length||e===F?s=s[i]||(s[i]={}):s[i]=e}function r(t){if("string"==typeof t)for(var e=0,i=(t=t.split("")).length;e<i;e++)t[e]=(255&t[e].charCodeAt(0))>>>0;e=1;for(var n,s=t.length,r=i=0;0<s;){for(s-=n=1024<s?1024:s;i+=e+=t[r++],--n;);e%=65521,i%=65521}return(i<<16|e)>>>0}function I(t,e){this.index="number"==typeof e?e:0,this.i=0,this.buffer=t instanceof(P?Uint8Array:Array)?t:new(P?Uint8Array:Array)(32768),2*this.buffer.length<=this.index&&E(Error("invalid index")),this.buffer.length<=this.index&&this.f()}function m(t){this.buffer=new(P?Uint16Array:Array)(2*t),this.length=0}function p(t){for(var e,i,n,s,r,o,a,c,h=t.length,l=0,u=Number.POSITIVE_INFINITY,d=0;d<h;++d)t[d]>l&&(l=t[d]),t[d]<u&&(u=t[d]);for(e=1<<l,i=new(P?Uint32Array:Array)(e),n=1,s=0,r=2;n<=l;){for(d=0;d<h;++d)if(t[d]===n){for(a=s,c=o=0;c<n;++c)o=o<<1|1&a,a>>=1;for(c=o;c<e;c+=r)i[c]=n<<16|d;++s}++n,s<<=1,r<<=1}return[i,l,u]}function s(t,e){this.h=R,this.w=0,this.input=t,this.b=0,e&&(e.lazy&&(this.w=e.lazy),"number"==typeof e.compressionType&&(this.h=e.compressionType),e.outputBuffer&&(this.a=P&&e.outputBuffer instanceof Array?new Uint8Array(e.outputBuffer):e.outputBuffer),"number"==typeof e.outputIndex)&&(this.b=e.outputIndex),this.a||(this.a=new(P?Uint8Array:Array)(32768))}function M(t,e){this.length=t,this.G=e}function v(t,e){function i(t,e){var i,n=t.G,s=[],r=0,o=G[t.length];switch(s[r++]=65535&o,s[r++]=o>>16&255,s[r++]=o>>24,x){case 1===n:i=[0,n-1,0];break;case 2===n:i=[1,n-2,0];break;case 3===n:i=[2,n-3,0];break;case 4===n:i=[3,n-4,0];break;case n<=6:i=[4,n-5,1];break;case n<=8:i=[5,n-7,1];break;case n<=12:i=[6,n-9,2];break;case n<=16:i=[7,n-13,2];break;case n<=24:i=[8,n-17,3];break;case n<=32:i=[9,n-25,3];break;case n<=48:i=[10,n-33,4];break;case n<=64:i=[11,n-49,4];break;case n<=96:i=[12,n-65,5];break;case n<=128:i=[13,n-97,5];break;case n<=192:i=[14,n-129,6];break;case n<=256:i=[15,n-193,6];break;case n<=384:i=[16,n-257,7];break;case n<=512:i=[17,n-385,7];break;case n<=768:i=[18,n-513,8];break;case n<=1024:i=[19,n-769,8];break;case n<=1536:i=[20,n-1025,9];break;case n<=2048:i=[21,n-1537,9];break;case n<=3072:i=[22,n-2049,10];break;case n<=4096:i=[23,n-3073,10];break;case n<=6144:i=[24,n-4097,11];break;case n<=8192:i=[25,n-6145,11];break;case n<=12288:i=[26,n-8193,12];break;case n<=16384:i=[27,n-12289,12];break;case n<=24576:i=[28,n-16385,13];break;case n<=32768:i=[29,n-24577,13];break;default:E("invalid distance")}for(o=i,s[r++]=o[0],s[r++]=o[1],s[+r]=o[2],n=0,r=s.length;n<r;++n)l[u++]=s[n];_[s[0]]++,p[s[3]]++,d=t.length+e-1,a=null}var n,s,r,o,a,c,h={},l=P?new Uint16Array(2*e.length):[],u=0,d=0,_=new(P?Uint32Array:Array)(286),p=new(P?Uint32Array:Array)(30),f=t.w;if(!P){for(r=0;r<=285;)_[r++]=0;for(r=0;r<=29;)p[r++]=0}for(_[256]=1,n=0,s=e.length;n<s;++n){for(r=g=0,o=3;r<o&&n+r!==s;++r)g=g<<8|e[n+r];if(h[g]===F&&(h[g]=[]),r=h[g],!(0<d--)){for(;0<r.length&&32768<n-r[0];)r.shift();if(s<=n+3){for(a&&i(a,-1),r=0,o=s-n;r<o;++r)c=e[n+r],l[u++]=c,++_[c];break}if(0<r.length){var g=o=F,m=0,y=F,T=F,S=(y=F,e.length),T=0,C=r.length;t:for(;T<C;T++){if(o=r[C-T-1],(y=3)<m){for(y=m;3<y;y--)if(e[o+y-1]!==e[n+y-1])continue t;y=m}for(;y<258&&n+y<S&&e[o+y]===e[n+y];)++y;if(m<y&&(g=o,m=y),258===y)break}o=new M(m,n-g),a?a.length<o.length?(c=e[n-1],l[u++]=c,++_[c],i(o,0)):i(a,-1):o.length<f?a=o:i(o,0)}else a?i(a,-1):(c=e[n],l[u++]=c,++_[c])}r.push(n)}return l[u++]=256,_[256]++,t.L=_,t.K=p,P?l.subarray(0,u):l}function b(t,e){var i,n=t.length,s=new m(572),r=new(P?Uint8Array:Array)(n);if(!P)for(l=0;l<n;l++)r[l]=0;for(l=0;l<n;++l)0<t[l]&&s.push(l,t[l]);if(n=Array(s.length/2),i=new(P?Uint32Array:Array)(s.length/2),1===n.length)r[s.pop().index]=1;else{for(l=0,d=s.length/2;l<d;++l)n[l]=s.pop(),i[l]=n[l].value;var o,a,c,h=i.length,l=new(P?Uint16Array:Array)(e),s=new(P?Uint8Array:Array)(e),u=new(P?Uint8Array:Array)(h),d=Array(e),_=Array(e),p=Array(e),f=(1<<e)-h,g=1<<e-1;for(l[e-1]=h,o=0;o<e;++o)f<g?s[o]=0:(s[o]=1,f-=g),f<<=1,l[e-2-o]=(l[e-1-o]/2|0)+h;for(l[0]=s[0],d[0]=Array(l[0]),_[0]=Array(l[0]),o=1;o<e;++o)l[o]>2*l[o-1]+s[o]&&(l[o]=2*l[o-1]+s[o]),d[o]=Array(l[o]),_[o]=Array(l[o]);for(f=0;f<h;++f)u[f]=e;for(g=0;g<l[e-1];++g)d[e-1][g]=i[g],_[e-1][g]=g;for(f=0;f<e;++f)p[f]=0;for(1===s[e-1]&&(--u[0],++p[e-1]),o=e-2;0<=o;--o){for(f=0,c=p[o+1],g=0;g<l[o];g++)(a=d[o+1][c]+d[o+1][c+1])>i[f]?(d[o][g]=a,_[o][g]=h,c+=2):(d[o][g]=i[f],_[o][g]=f,++f);p[o]=0,1===s[o]&&function t(e){var i=_[e][p[e]];i===h?(t(e+1),t(e+1)):--u[i],++p[e]}(o)}for(i=u,l=0,d=n.length;l<d;++l)r[n[l].index]=i[l]}return r}function A(t){for(var e,i=new(P?Uint16Array:Array)(t.length),n=[],s=[],r=0,o=0,a=t.length;o<a;o++)n[t[o]]=1+(0|n[t[o]]);for(o=1,a=16;o<=a;o++)s[o]=r,1<<o<(r+=0|n[o])&&E("overcommitted"),r<<=1;for(r<65536&&E("undercommitted"),o=0,a=t.length;o<a;o++)for(r=s[t[o]],s[t[o]]+=1,n=i[o]=0,e=t[o];n<e;n++)i[o]=i[o]<<1|1&r,r>>>=1;return i}function i(t,e){this.input=t,this.a=new(P?Uint8Array:Array)(32768),this.h=_.j;var i,n={};for(i in(e?"number"!=typeof e.compressionType:e={})||(this.h=e.compressionType),e)n[i]=e[i];n.outputBuffer=this.a,this.z=new s(this.input,n)}function o(t,e){switch(this.k=[],this.l=32768,this.e=this.g=this.c=this.q=0,this.input=P?new Uint8Array(t):t,this.s=!1,this.m=T,this.B=!1,(e?(e.index&&(this.c=e.index),e.bufferSize&&(this.l=e.bufferSize),e.bufferType&&(this.m=e.bufferType),e.resize):(e={},0))&&(this.B=e.resize),this.m){case y:this.b=32768,this.a=new(P?Uint8Array:Array)(32768+this.l+258);break;case T:this.b=0,this.a=new(P?Uint8Array:Array)(this.l),this.f=this.J,this.t=this.H,this.o=this.I;break;default:E(Error("invalid inflate mode"))}}function f(t,e){for(var i,n=t.g,s=t.e,r=t.input,o=t.c;s<e;)(i=r[o++])===F&&E(Error("input buffer is broken")),n|=i<<s,s+=8;return t.g=n>>>e,t.e=s-e,t.c=o,n&(1<<e)-1}function g(t,e){for(var i,n=t.g,s=t.e,r=t.input,o=t.c,a=e[0],c=e[1];s<c;)(i=r[o++])===F&&E(Error("input buffer is broken")),n|=i<<s,s+=8;return r=a[n&(1<<c)-1],t.g=n>>(a=r>>>16),t.e=s-a,t.c=o,65535&r}function e(t,e){var i,n;this.input=t,this.c=0,(e?(e.index&&(this.c=e.index),e.verify):(e={},0))&&(this.M=e.verify),i=t[this.c++],n=t[this.c++],(15&i)===N?this.method=N:E(Error("unsupported compression method")),0!=((i<<8)+n)%31&&E(Error("invalid fcheck flag:"+((i<<8)+n)%31)),32&n&&E(Error("fdict flag is not supported")),this.A=new o(t,{index:this.c,bufferSize:e.bufferSize,bufferType:e.bufferType,resize:e.resize})}for(var F=void 0,x=!0,O=this,P="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,n=(I.prototype.f=function(){var t,e=this.buffer,i=e.length,n=new(P?Uint8Array:Array)(i<<1);if(P)n.set(e);else for(t=0;t<i;++t)n[t]=e[t];return this.buffer=n},I.prototype.d=function(t,e,i){var n=this.buffer,s=this.index,r=this.i,o=n[s];if(i&&1<e&&(t=8<e?(d[255&t]<<24|d[t>>>8&255]<<16|d[t>>>16&255]<<8|d[t>>>24&255])>>32-e:d[t]>>8-e),e+r<8)o=o<<e|t,r+=e;else for(i=0;i<e;++i)o=o<<1|t>>e-i-1&1,8==++r&&(r=0,n[s++]=d[o],o=0,s===n.length)&&(n=this.f());n[s]=o,this.buffer=n,this.i=r,this.index=s},I.prototype.finish=function(){var t=this.buffer,e=this.index;return 0<this.i&&(t[e]<<=8-this.i,t[e]=d[t[e]],e++),P?t.subarray(0,e):(t.length=e,t)},new(P?Uint8Array:Array)(256)),a=0;a<256;++a){for(var c=l=a,h=7,l=l>>>1;l;l>>>=1)c=c<<1|1&l,--h;n[a]=(c<<h&255)>>>0}var u,d=n,n=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],R=(P&&new Uint32Array(n),m.prototype.getParent=function(t){return 2*((t-2)/4|0)},m.prototype.push=function(t,e){var i,n,s=this.buffer,r=this.length;for(s[this.length++]=e,s[this.length++]=t;0<r&&(i=this.getParent(r),s[r]>s[i]);)n=s[r],s[r]=s[i],s[i]=n,n=s[r+1],s[r+1]=s[i+1],s[i+1]=n,r=i;return this.length},m.prototype.pop=function(){var t,e,i,n=this.buffer,s=n[0],r=n[1];for(this.length-=2,n[0]=n[this.length],n[1]=n[this.length+1],i=0;!((e=2*i+2)>=this.length)&&(e+2<this.length&&n[e+2]>n[e]&&(e+=2),n[e]>n[i]);)t=n[i],n[i]=n[e],n[e]=t,t=n[i+1],n[i+1]=n[e+1],n[e+1]=t,i=e;return{index:r,value:s,length:this.length}},2),n={NONE:0,r:1,j:R,N:3},L=[];for(a=0;a<288;a++)switch(x){case a<=143:L.push([a+48,8]);break;case a<=255:L.push([a-144+400,9]);break;case a<=279:L.push([a-256,7]);break;case a<=287:L.push([a-280+192,8]);break;default:E("invalid literal: "+a)}for(s.prototype.n=function(){var t,e=this.input;switch(this.h){case 0:for(t=0,d=e.length;t<d;){var i,n=(t+=(i=P?e.subarray(t,t+65535):e.slice(t,t+65535)).length)===d,s=F,r=s=F,r=s=F,o=this.a,a=this.b;if(P){for(o=new Uint8Array(this.a.buffer);o.length<=a+i.length+5;)o=new Uint8Array(o.length<<1);o.set(this.a)}if(o[a++]=0|(s=n?1:0),r=65536+~(s=i.length)&65535,o[a++]=255&s,o[a++]=s>>>8&255,o[a++]=255&r,o[a++]=r>>>8&255,P)o.set(i,a),a+=i.length,o=o.subarray(0,a);else{for(s=0,r=i.length;s<r;++s)o[a++]=i[s];o.length=a}this.b=a,this.a=o}break;case 1:for((t=new I(new Uint8Array(this.a.buffer),this.b)).d(1,1,x),t.d(1,2,x),i=0,n=(e=v(this,e)).length;i<n;i++)if(d=e[i],I.prototype.d.apply(t,L[d]),256<d)t.d(e[++i],e[++i],x),t.d(e[++i],5),t.d(e[++i],e[++i],x);else if(256===d)break;this.a=t.finish(),this.b=this.a.length;break;case R:var c,h,l,u,d=new I(new Uint8Array(this.a),this.b),_=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],s=Array(19),o=R;for(d.d(1,1,x),d.d(o,2,x),e=v(this,e),u=A(r=b(this.L,15)),a=A(o=b(this.K,7)),c=286;257<c&&0===r[c-1];c--);for(h=30;1<h&&0===o[h-1];h--);for(var p,f,g=c,m=h,y=new(P?Uint32Array:Array)(g+m),T=new(P?Uint32Array:Array)(316),S=new(P?Uint8Array:Array)(19),C=l=0;C<g;C++)y[l++]=r[C];for(C=0;C<m;C++)y[l++]=o[C];if(!P)for(C=0,m=S.length;C<m;++C)S[C]=0;for(C=p=0,m=y.length;C<m;C+=l){for(l=1;C+l<m&&y[C+l]===y[C];++l);if(g=l,0===y[C])if(g<3)for(;0<g--;)S[T[p++]=0]++;else for(;0<g;)(f=g-3<(f=g<138?g:138)&&f<g?g-3:f)<=10?(T[p++]=17,T[p++]=f-3,S[17]++):(T[p++]=18,T[p++]=f-11,S[18]++),g-=f;else if(T[p++]=y[C],S[y[C]]++,--g<3)for(;0<g--;)T[p++]=y[C],S[y[C]]++;else for(;0<g;)g-3<(f=g<6?g:6)&&f<g&&(f=g-3),T[p++]=16,T[p++]=f-3,S[16]++,g-=f}for(y=P?T.subarray(0,p):T.slice(0,p),S=b(S,7),C=0;C<19;C++)s[C]=S[_[C]];for(l=19;4<l&&0===s[l-1];l--);for(_=A(S),d.d(c-257,5,x),d.d(h-1,5,x),d.d(l-4,4,x),C=0;C<l;C++)d.d(s[C],3,x);for(C=0,s=y.length;C<s;C++)if(i=y[C],d.d(_[i],S[i],x),16<=i){switch(C++,i){case 16:n=2;break;case 17:n=3;break;case 18:n=7;break;default:E("invalid code: "+i)}d.d(y[C],n,x)}for(i=(n=[u,r])[0],n=n[1],o=(a=[a,o])[0],u=a[1],a=0,s=e.length;a<s;++a)if(t=e[a],d.d(i[t],n[t],x),256<t)d.d(e[++a],e[++a],x),r=e[++a],d.d(o[r],u[r],x),d.d(e[++a],e[++a],x);else if(256===t)break;this.a=d.finish(),this.b=this.a.length;break;default:E("invalid compression type")}return this.a},a=[],u=3;u<=258;u++)l=function(){var t=u;switch(x){case 3===t:return[257,t-3,0];case 4===t:return[258,t-4,0];case 5===t:return[259,t-5,0];case 6===t:return[260,t-6,0];case 7===t:return[261,t-7,0];case 8===t:return[262,t-8,0];case 9===t:return[263,t-9,0];case 10===t:return[264,t-10,0];case t<=12:return[265,t-11,1];case t<=14:return[266,t-13,1];case t<=16:return[267,t-15,1];case t<=18:return[268,t-17,1];case t<=22:return[269,t-19,2];case t<=26:return[270,t-23,2];case t<=30:return[271,t-27,2];case t<=34:return[272,t-31,2];case t<=42:return[273,t-35,3];case t<=50:return[274,t-43,3];case t<=58:return[275,t-51,3];case t<=66:return[276,t-59,3];case t<=82:return[277,t-67,4];case t<=98:return[278,t-83,4];case t<=114:return[279,t-99,4];case t<=130:return[280,t-115,4];case t<=162:return[281,t-131,5];case t<=194:return[282,t-163,5];case t<=226:return[283,t-195,5];case t<=257:return[284,t-227,5];case 258===t:return[285,t-258,0];default:E("invalid length: "+t)}}(),a[u]=l[2]<<24|l[1]<<16|l[0];var G=P?new Uint32Array(a):a,_=n,y=(i.prototype.n=function(){var t,e,i=0,n=this.a,s=N;if(s===N?t=Math.LOG2E*Math.log(32768)-8:E(Error("invalid compression method")),n[i++]=t=t<<4|s,s===N)switch(this.h){case _.NONE:e=0;break;case _.r:e=1;break;case _.j:e=2;break;default:E(Error("unsupported compression type"))}else E(Error("invalid compression method"));return n[+i]=(s=e<<6|0)|31-(256*t+s)%31,s=r(this.input),this.z.b=2,i=(n=this.z.n()).length,P&&((n=new Uint8Array(n.buffer)).length<=i+4&&(this.a=new Uint8Array(n.length+4),this.a.set(n),n=this.a),n=n.subarray(0,i+4)),n[i++]=s>>24&255,n[i++]=s>>16&255,n[i++]=s>>8&255,n[+i]=255&s,n},t("Zlib.Deflate",i),t("Zlib.Deflate.compress",function(t,e){return new i(t,e).n()}),t("Zlib.Deflate.CompressionType",_),t("Zlib.Deflate.CompressionType.NONE",_.NONE),t("Zlib.Deflate.CompressionType.FIXED",_.r),t("Zlib.Deflate.CompressionType.DYNAMIC",_.j),0),T=1,n={D:y,C:T},S=(o.prototype.p=function(){for(;!this.s;)switch(1&(t=f(this,3))&&(this.s=x),t>>>=1){case 0:var t=this.input,e=this.c,i=this.a,n=this.b,s=F,r=F,o=i.length,s=F;switch(this.e=this.g=0,(s=t[e++])===F&&E(Error("invalid uncompressed block header: LEN (first byte)")),r=s,(s=t[e++])===F&&E(Error("invalid uncompressed block header: LEN (second byte)")),r|=s<<8,(s=t[e++])===F&&E(Error("invalid uncompressed block header: NLEN (first byte)")),h=s,(s=t[e++])===F&&E(Error("invalid uncompressed block header: NLEN (second byte)")),r===~(h|=s<<8)&&E(Error("invalid uncompressed block header: length verify")),e+r>t.length&&E(Error("input buffer is broken")),this.m){case y:for(;n+r>i.length;){if(r-=s=o-n,P)i.set(t.subarray(e,e+s),n),n+=s,e+=s;else for(;s--;)i[n++]=t[e++];this.b=n,i=this.f(),n=this.b}break;case T:for(;n+r>i.length;)i=this.f({v:2});break;default:E(Error("invalid inflate mode"))}if(P)i.set(t.subarray(e,e+r),n),n+=r,e+=r;else for(;r--;)i[n++]=t[e++];this.c=e,this.b=n,this.a=i;break;case 1:this.o(k,V);break;case 2:_=d=u=l=h=a=void 0;for(var a=this,c=function(t,e,i){for(var n,s,r,o=0;o<t;)switch(n=g(this,e),n){case 16:for(r=3+f(this,2);r--;)i[o++]=s;break;case 17:for(r=3+f(this,3);r--;)i[o++]=0;s=0;break;case 18:for(r=11+f(this,7);r--;)i[o++]=0;s=0;break;default:s=i[o++]=n}return i},h=f(a,5)+257,l=f(a,5)+1,u=f(a,4)+4,d=new(P?Uint8Array:Array)(S.length),_=0;_<u;++_)d[S[_]]=f(a,3);u=p(d),d=new(P?Uint8Array:Array)(h),_=new(P?Uint8Array:Array)(l),a.o(p(c.call(a,h,u,d)),p(c.call(a,l,u,_)));break;default:E(Error("unknown BTYPE: "+t))}return this.t()},a=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],P?new Uint16Array(a):a),C=(a=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258],P?new Uint16Array(a):a),B=(a=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0],P?new Uint8Array(a):a),D=(a=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],P?new Uint16Array(a):a),w=(a=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],P?new Uint8Array(a):a);for(l=0,c=(a=new(P?Uint8Array:Array)(288)).length;l<c;++l)a[l]=l<=143?8:l<=255?9:l<=279?7:8;var k=p(a);for(l=0,c=(a=new(P?Uint8Array:Array)(30)).length;l<c;++l)a[l]=5;var V=p(a);for(o.prototype.o=function(t,e){var i=this.a,n=this.b;this.u=t;for(var s,r,o,a=i.length-258;256!==(s=g(this,t));)if(s<256)a<=n&&(this.b=n,i=this.f(),n=this.b),i[n++]=s;else for(o=C[s-=257],0<B[s]&&(o+=f(this,B[s])),s=g(this,e),r=D[s],0<w[s]&&(r+=f(this,w[s])),a<=n&&(this.b=n,i=this.f(),n=this.b);o--;)i[n]=i[n++-r];for(;8<=this.e;)this.e-=8,this.c--;this.b=n},o.prototype.I=function(t,e){var i=this.a,n=this.b;this.u=t;for(var s,r,o,a=i.length;256!==(s=g(this,t));)if(s<256)a<=n&&(a=(i=this.f()).length),i[n++]=s;else for(o=C[s-=257],0<B[s]&&(o+=f(this,B[s])),s=g(this,e),r=D[s],0<w[s]&&(r+=f(this,w[s])),a<n+o&&(a=(i=this.f()).length);o--;)i[n]=i[n++-r];for(;8<=this.e;)this.e-=8,this.c--;this.b=n},o.prototype.f=function(){var t,e,i=new(P?Uint8Array:Array)(this.b-32768),n=this.b-32768,s=this.a;if(P)i.set(s.subarray(32768,i.length));else for(t=0,e=i.length;t<e;++t)i[t]=s[t+32768];if(this.k.push(i),this.q+=i.length,P)s.set(s.subarray(n,32768+n));else for(t=0;t<32768;++t)s[t]=s[n+t];return this.b=32768,s},o.prototype.J=function(t){var e,i=this.input.length/this.c+1|0,n=this.input,s=this.a;return t&&("number"==typeof t.v&&(i=t.v),"number"==typeof t.F)&&(i+=t.F),n=i<2?(t=(n.length-this.c)/this.u[2]/2*258|0)<s.length?s.length+t:s.length<<1:s.length*i,P?(e=new Uint8Array(n)).set(s):e=s,this.a=e},o.prototype.t=function(){var t,e,i,n,s,r=0,o=this.a,a=this.k,c=new(P?Uint8Array:Array)(this.q+(this.b-32768));if(0===a.length)return P?this.a.subarray(32768,this.b):this.a.slice(32768,this.b);for(e=0,i=a.length;e<i;++e)for(n=0,s=(t=a[e]).length;n<s;++n)c[r++]=t[n];for(e=32768,i=this.b;e<i;++e)c[r++]=o[e];return this.k=[],this.buffer=c},o.prototype.H=function(){var t,e=this.b;return P?this.B?(t=new Uint8Array(e)).set(this.a.subarray(0,e)):t=this.a.subarray(0,e):(this.a.length>e&&(this.a.length=e),t=this.a),this.buffer=t},e.prototype.p=function(){var t=this.input,e=this.A.p();return this.c=this.A.c,this.M&&(t[this.c++]<<24|t[this.c++]<<16|t[this.c++]<<8|t[this.c++])>>>0!==r(e)&&E(Error("invalid adler-32 checksum")),e},t("Zlib.Inflate",e),t("Zlib.Inflate.BufferType",n),n.ADAPTIVE=n.C,n.BLOCK=n.D,t("Zlib.Inflate.prototype.decompress",e.prototype.p),n=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],P&&new Uint16Array(n),n=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258],P&&new Uint16Array(n),n=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0],P&&new Uint8Array(n),n=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],P&&new Uint16Array(n),n=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],P&&new Uint8Array(n),a=0,l=(n=new(P?Uint8Array:Array)(288)).length;a<l;++a)n[a]=a<=143?8:a<=255?9:a<=279?7:8;for(p(n),a=0,l=(n=new(P?Uint8Array:Array)(30)).length;a<l;++a)n[a]=5;p(n);var N=8}.call(this),_p=window,_p=_p.Zlib=_p.Zlib,_p.Deflate=_p.Deflate,_p.Deflate.compress=_p.Deflate.compress,_p.Inflate=_p.Inflate,_p.Inflate.BufferType=_p.Inflate.BufferType,_p.Inflate.prototype.decompress=_p.Inflate.prototype.decompress,cc.TGA_OK=0,cc.TGA_ERROR_FILE_OPEN=1,cc.TGA_ERROR_READING_FILE=2,cc.TGA_ERROR_INDEXED_COLOR=3,cc.TGA_ERROR_MEMORY=4,cc.TGA_ERROR_COMPRESSED_FILE=5,cc.ImageTGA=function(t,e,i,n,s,r,o){this.status=t||0,this.type=e||0,this.pixelDepth=i||0,this.width=n||0,this.height=s||0,this.imageData=r||[],this.flipped=o||0},cc.tgaLoadHeader=function(t,e,i){return!(e<3||((t=new cc.BinaryStreamReader(t)).setOffset(2),i.type=t.readByte(),e<17)||(t.setOffset(12),i.width=t.readUnsignedShort(),i.height=t.readUnsignedInteger(),i.pixelDepth=t.readByte(),e<18)||(e=t.readByte(),i.flipped=0,32&e&&(i.flipped=1),0))},cc.tgaLoadImageData=function(t,e,i){var n=0|i.pixelDepth/2,s=i.height*i.width*n;if(e<18+s)return!1;if(i.imageData=cc.__getSubArray(t,18,18+s),3<=n)for(t=0;t<s;t+=n)e=i.imageData[t],i.imageData[t]=i.imageData[t+2],i.imageData[t+2]=e;return!0},cc.tgaRGBtogreyscale=function(t){var e,i;if(8!==t.pixelDepth){var n=t.pixelDepth/8,s=new Uint8Array(t.height*t.width);if(null!==s){for(i=e=0;i<t.width*t.height;e+=n,i++)s[i]=.3*t.imageData[e]+.59*t.imageData[e+1]+.11*t.imageData[e+2];t.pixelDepth=8,t.type=3,t.imageData=s}}},cc.tgaDestroy=function(t){t&&(t.imageData=null)},cc.tgaLoadRLEImageData=function(t,e,i){for(var n=0,s=0,r=0,o=[],a=0,c=18,h=i.pixelDepth/8,l=i.height*i.width,u=0;u<l;u++){if(0!==a)a--,s=0!==r;else{if(e<c+1)break;a=t[c],c+=1,(r=128&a)&&(a-=128),s=0}if(!s){if(e<c+h)break;o=cc.__getSubArray(t,c,c+h),c+=h,3<=h&&(s=o[0],o[0]=o[2],o[2]=s)}for(s=0;s<h;s++)i.imageData[n+s]=o[s];n+=h}return!0},cc.tgaFlipImage=function(t){for(var e=t.pixelDepth/8*t.width,i=0;i<t.height/2;i++){var n=cc.__getSubArray(t.imageData,i*e,i*e+e);cc.__setDataToArray(cc.__getSubArray(t.imageData,(t.height-(i+1))*e,e),t.imageData,i*e),cc.__setDataToArray(n,t.imageData,(t.height-(i+1))*e)}t.flipped=0},cc.__getSubArray=function(t,e,i){return t instanceof Array?t.slice(e,i):t.subarray(e,i)},cc.__setDataToArray=function(t,e,i){for(var n=0;n<t.length;n++)e[i+n]=t[n]},cc.BinaryStreamReader=cc.Class.extend({_binaryData:null,_offset:0,ctor:function(t){this._binaryData=t},setBinaryData:function(t){this._binaryData=t,this._offset=0},getBinaryData:function(){return this._binaryData},_checkSize:function(t){if(!(this._offset+Math.ceil(t/8)<this._data.length))throw Error("Index out of bound")},_decodeFloat:function(t,e){var i=(n=t+e+1)>>3,n=(this._checkSize(n),Math.pow(2,e-1)-1),s=this._readBits(t+e,1,i),e=this._readBits(t,e,i),r=0,o=2,a=0;do{for(var c=this._readByte(++a,i),h=t%8||8,l=1<<h;l>>=1;)c&l&&(r+=1/o),o*=2}while(t-=h);return this._offset+=i,e===1+(n<<1)?r?NaN:s?-1/0:1/0:(1+-2*s)*(e||r?e?Math.pow(2,e-n)*(1+r):Math.pow(2,1-n)*r:0)},_readByte:function(t,e){return this._data[this._offset+e-t-1]},_decodeInt:function(t,e){var i=this._readBits(0,t,t/8),n=Math.pow(2,t);return this._offset+=t/8,e&&n/2<=i?i-n:i},_shl:function(t,e){for(++e;--e;t=1073741824==(1073741824&(t%=2147483648))?2*t:2*(t-1073741824)+2147483648);return t},_readBits:function(t,e,i){var n=(t+e)%8,s=t%8,r=i-(t>>3)-1,o=r-(t=i+(-(t+e)>>3));for(e=this._readByte(r,i)>>s&(1<<(o?8-s:e))-1,o&&n&&(e+=(this._readByte(t++,i)&(1<<n)-1)<<(o--<<3)-s);o;)e+=this._shl(this._readByte(t++,i),(o--<<3)-s);return e},readInteger:function(){return this._decodeInt(32,!0)},readUnsignedInteger:function(){return this._decodeInt(32,!1)},readSingle:function(){return this._decodeFloat(23,8)},readShort:function(){return this._decodeInt(16,!0)},readUnsignedShort:function(){return this._decodeInt(16,!1)},readByte:function(){var t=this._data[this._offset];return this._offset+=1,t},readData:function(t,e){return this._binaryData instanceof Array?this._binaryData.slice(t,e):this._binaryData.subarray(t,e)},setOffset:function(t){this._offset=t},getOffset:function(){return this._offset}}),cc.TMX_ORIENTATION_ORTHO=0,cc.TMX_ORIENTATION_HEX=1,cc.TMX_ORIENTATION_ISO=2,cc.TMXTiledMap=cc.Node.extend({properties:null,mapOrientation:null,objectGroups:null,_mapSize:null,_tileSize:null,_tileProperties:null,_className:"TMXTiledMap",ctor:function(t,e){cc.Node.prototype.ctor.call(this),this._mapSize=cc.size(0,0),this._tileSize=cc.size(0,0),void 0!==e?this.initWithXML(t,e):void 0!==t&&this.initWithTMXFile(t)},getMapSize:function(){return cc.size(this._mapSize.width,this._mapSize.height)},setMapSize:function(t){this._mapSize.width=t.width,this._mapSize.height=t.height},_getMapWidth:function(){return this._mapSize.width},_setMapWidth:function(t){this._mapSize.width=t},_getMapHeight:function(){return this._mapSize.height},_setMapHeight:function(t){this._mapSize.height=t},getTileSize:function(){return cc.size(this._tileSize.width,this._tileSize.height)},setTileSize:function(t){this._tileSize.width=t.width,this._tileSize.height=t.height},_getTileWidth:function(){return this._tileSize.width},_setTileWidth:function(t){this._tileSize.width=t},_getTileHeight:function(){return this._tileSize.height},_setTileHeight:function(t){this._tileSize.height=t},getMapOrientation:function(){return this.mapOrientation},setMapOrientation:function(t){this.mapOrientation=t},getObjectGroups:function(){return this.objectGroups},setObjectGroups:function(t){this.objectGroups=t},getProperties:function(){return this.properties},setProperties:function(t){this.properties=t},initWithTMXFile:function(t){var e;if(t&&0!==t.length)return this.height=this.width=0,!!(t=new cc.TMXMapInfo(t))&&((e=t.getTilesets())&&0!==e.length||cc.log("cc.TMXTiledMap.initWithTMXFile(): Map not found. Please check the filename."),this._buildWithMapInfo(t),!0);throw Error("cc.TMXTiledMap.initWithTMXFile(): tmxFile should be non-null or non-empty string.")},initWithXML:function(t,e){this.height=this.width=0;t=new cc.TMXMapInfo(t,e),e=t.getTilesets();return e&&0!==e.length||cc.log("cc.TMXTiledMap.initWithXML(): Map not found. Please check the filename."),this._buildWithMapInfo(t),!0},_buildWithMapInfo:function(t){this._mapSize=t.getMapSize(),this._tileSize=t.getTileSize(),this.mapOrientation=t.orientation,this.objectGroups=t.getObjectGroups(),this.properties=t.properties,this._tileProperties=t.getTileProperties();var e=0,i=t.getLayers();if(i)for(var n,s=0,r=i.length;s<r;s++)(n=i[s])&&n.visible&&(n=this._parseLayer(n,t),this.addChild(n,e,e),this.width=Math.max(this.width,n.width),this.height=Math.max(this.height,n.height),e++)},allLayers:function(){for(var t=[],e=this._children,i=0,n=e.length;i<n;i++){var s=e[i];s&&s instanceof cc.TMXLayer&&t.push(s)}return t},getLayer:function(t){if(!t||0===t.length)throw Error("cc.TMXTiledMap.getLayer(): layerName should be non-null or non-empty string.");for(var e=this._children,i=0;i<e.length;i++){var n=e[i];if(n&&n.layerName===t)return n}return null},getObjectGroup:function(t){if(!t||0===t.length)throw Error("cc.TMXTiledMap.getObjectGroup(): groupName should be non-null or non-empty string.");if(this.objectGroups)for(var e=0;e<this.objectGroups.length;e++){var i=this.objectGroups[e];if(i&&i.groupName===t)return i}return null},getProperty:function(t){return this.properties[t.toString()]},propertiesForGID:function(t){return cc.log("propertiesForGID is deprecated. Please use getPropertiesForGID instead."),this.getPropertiesForGID[t]},getPropertiesForGID:function(t){return this._tileProperties[t]},_parseLayer:function(t,e){var i=this._tilesetForLayer(t,e),i=new cc.TMXLayer(i,t,e);return t.ownTiles=!1,i},_tilesetForLayer:function(t,e){var i=t._layerSize,n=e.getTilesets();if(n)for(var s=n.length-1;0<=s;s--){var r=n[s];if(r)for(var o=0;o<i.height;o++)for(var a=0;a<i.width;a++){var c=t._tiles[a+i.width*o];if(0!==c&&(c&cc.TMX_TILE_FLIPPED_MASK)>>>0>=r.firstGid)return r}}return cc.log("cocos2d: Warning: TMX Layer "+t.name+" has no tiles"),null}}),_p=cc.TMXTiledMap.prototype,cc.defineGetterSetter(_p,"mapWidth",_p._getMapWidth,_p._setMapWidth),cc.defineGetterSetter(_p,"mapHeight",_p._getMapHeight,_p._setMapHeight),cc.defineGetterSetter(_p,"tileWidth",_p._getTileWidth,_p._setTileWidth),cc.defineGetterSetter(_p,"tileHeight",_p._getTileHeight,_p._setTileHeight),cc.TMXTiledMap.create=function(t,e){return new cc.TMXTiledMap(t,e)},cc.TMX_PROPERTY_NONE=0,cc.TMX_PROPERTY_MAP=1,cc.TMX_PROPERTY_LAYER=2,cc.TMX_PROPERTY_OBJECTGROUP=3,cc.TMX_PROPERTY_OBJECT=4,cc.TMX_PROPERTY_TILE=5,cc.TMX_TILE_HORIZONTAL_FLAG=2147483648,cc.TMX_TILE_VERTICAL_FLAG=1073741824,cc.TMX_TILE_DIAGONAL_FLAG=536870912,cc.TMX_TILE_FLIPPED_ALL=(cc.TMX_TILE_HORIZONTAL_FLAG|cc.TMX_TILE_VERTICAL_FLAG|cc.TMX_TILE_DIAGONAL_FLAG)>>>0,cc.TMX_TILE_FLIPPED_MASK=~cc.TMX_TILE_FLIPPED_ALL>>>0,cc.TMXLayerInfo=cc.Class.extend({properties:null,name:"",_layerSize:null,_tiles:null,visible:null,_opacity:null,ownTiles:!0,_minGID:1e5,_maxGID:0,offset:null,ctor:function(){this.properties=[],this.name="",this._tiles=this._layerSize=null,this.visible=!0,this._opacity=0,this.ownTiles=!0,this._minGID=1e5,this._maxGID=0,this.offset=cc.p(0,0)},getProperties:function(){return this.properties},setProperties:function(t){this.properties=t}}),cc.TMXTilesetInfo=cc.Class.extend({name:"",firstGid:0,_tileSize:null,spacing:0,margin:0,sourceImage:"",imageSize:null,ctor:function(){this._tileSize=cc.size(0,0),this.imageSize=cc.size(0,0)},rectForGID:function(t,e){var e=e||cc.rect(0,0,0,0),i=(e.width=this._tileSize.width,e.height=this._tileSize.height,t=(t&=cc.TMX_TILE_FLIPPED_MASK)-parseInt(this.firstGid,10),parseInt((this.imageSize.width-2*this.margin+this.spacing)/(this._tileSize.width+this.spacing),10));return e.x=parseInt(t%i*(this._tileSize.width+this.spacing)+this.margin,10),e.y=parseInt(parseInt(t/i,10)*(this._tileSize.height+this.spacing)+this.margin,10),e}}),cc.TMXMapInfo=cc.SAXParser.extend({properties:null,orientation:null,parentElement:null,parentGID:null,layerAttrs:0,storingCharacters:!1,tmxFileName:null,currentString:null,_objectGroups:null,_mapSize:null,_tileSize:null,_layers:null,_tilesets:null,_tileProperties:null,_resources:"",_currentFirstGID:0,ctor:function(t,e){cc.SAXParser.prototype.ctor.apply(this),this._mapSize=cc.size(0,0),this._tileSize=cc.size(0,0),this._layers=[],this._tilesets=[],this._objectGroups=[],this.properties=[],this._tileProperties={},void(this._currentFirstGID=0)!==e?this.initWithXML(t,e):void 0!==t&&this.initWithTMXFile(t)},getOrientation:function(){return this.orientation},setOrientation:function(t){this.orientation=t},getMapSize:function(){return cc.size(this._mapSize.width,this._mapSize.height)},setMapSize:function(t){this._mapSize.width=t.width,this._mapSize.height=t.height},_getMapWidth:function(){return this._mapSize.width},_setMapWidth:function(t){this._mapSize.width=t},_getMapHeight:function(){return this._mapSize.height},_setMapHeight:function(t){this._mapSize.height=t},getTileSize:function(){return cc.size(this._tileSize.width,this._tileSize.height)},setTileSize:function(t){this._tileSize.width=t.width,this._tileSize.height=t.height},_getTileWidth:function(){return this._tileSize.width},_setTileWidth:function(t){this._tileSize.width=t},_getTileHeight:function(){return this._tileSize.height},_setTileHeight:function(t){this._tileSize.height=t},getLayers:function(){return this._layers},setLayers:function(t){this._layers.push(t)},getTilesets:function(){return this._tilesets},setTilesets:function(t){this._tilesets.push(t)},getObjectGroups:function(){return this._objectGroups},setObjectGroups:function(t){this._objectGroups.push(t)},getParentElement:function(){return this.parentElement},setParentElement:function(t){this.parentElement=t},getParentGID:function(){return this.parentGID},setParentGID:function(t){this.parentGID=t},getLayerAttribs:function(){return this.layerAttrs},setLayerAttribs:function(t){this.layerAttrs=t},getStoringCharacters:function(){return this.storingCharacters},setStoringCharacters:function(t){this.storingCharacters=t},getProperties:function(){return this.properties},setProperties:function(t){this.properties=t},initWithTMXFile:function(t){return this._internalInit(t,null),this.parseXMLFile(t)},initWithXML:function(t,e){return this._internalInit(null,e),this.parseXMLString(t)},parseXMLFile:function(t,e){var i=(e=e||!1)?t:cc.loader.getRes(t);if(!i)throw Error("Please load the resource first : "+t);if(s=(i=this._parseXML(i).documentElement).getAttribute("version"),l=i.getAttribute("orientation"),"map"===i.nodeName&&("1.0"!==s&&null!==s&&cc.log("cocos2d: TMXFormat: Unsupported TMX version:"+s),"orthogonal"===l?this.orientation=cc.TMX_ORIENTATION_ORTHO:"isometric"===l?this.orientation=cc.TMX_ORIENTATION_ISO:"hexagonal"===l?this.orientation=cc.TMX_ORIENTATION_HEX:null!==l&&cc.log("cocos2d: TMXFomat: Unsupported orientation:"+l),(s=cc.size(0,0)).width=parseFloat(i.getAttribute("width")),s.height=parseFloat(i.getAttribute("height")),this.setMapSize(s),(s=cc.size(0,0)).width=parseFloat(i.getAttribute("tilewidth")),s.height=parseFloat(i.getAttribute("tileheight")),this.setTileSize(s),l=i.querySelectorAll("map > properties >  property"))){for(var n={},s=0;s<l.length;s++)n[l[s].getAttribute("name")]=l[s].getAttribute("value");this.properties=n}for(n=i.getElementsByTagName("tileset"),"map"!==i.nodeName&&(n=[]).push(i),s=0;s<n.length;s++){var r=(l=n[s]).getAttribute("source");if(r)l=e?cc.path.join(this._resources,r):cc.path.changeBasename(t,r),this.parseXMLFile(l);else{(r=new cc.TMXTilesetInfo).name=l.getAttribute("name")||"",r.firstGid=parseInt(l.getAttribute("firstgid"))||0,r.spacing=parseInt(l.getAttribute("spacing"))||0,r.margin=parseInt(l.getAttribute("margin"))||0;(o=cc.size(0,0)).width=parseFloat(l.getAttribute("tilewidth")),o.height=parseFloat(l.getAttribute("tileheight")),r._tileSize=o;var o=l.getElementsByTagName("image")[0].getAttribute("source"),a=-1;if(-1!==(a=this.tmxFileName?this.tmxFileName.lastIndexOf("/"):a)?(a=this.tmxFileName.substr(0,a+1),r.sourceImage=a+o):r.sourceImage=this._resources+(this._resources?"/":"")+o,this.setTilesets(r),o=l.getElementsByTagName("tile"))for(a=0;a<o.length;a++){l=o[a],this.parentGID=parseInt(r.firstGid)+parseInt(l.getAttribute("id")||0);var c=l.querySelectorAll("properties > property");if(c){for(var h={},l=0;l<c.length;l++){var u=c[l].getAttribute("name");h[u]=c[l].getAttribute("value")}this._tileProperties[this.parentGID]=h}}}}if(n=i.getElementsByTagName("layer"))for(s=0;s<n.length;s++){for(c=(a=n[s]).getElementsByTagName("data")[0],(r=new cc.TMXLayerInfo).name=a.getAttribute("name"),(l=cc.size(0,0)).width=parseFloat(a.getAttribute("width")),l.height=parseFloat(a.getAttribute("height")),r._layerSize=l,l=a.getAttribute("visible"),r.visible="0"!=l,l=a.getAttribute("opacity")||1,r._opacity=l?parseInt(255*parseFloat(l)):255,r.offset=cc.p(parseFloat(a.getAttribute("x"))||0,parseFloat(a.getAttribute("y"))||0),h="",l=0;l<c.childNodes.length;l++)h+=c.childNodes[l].nodeValue;if(h=h.trim(),l=c.getAttribute("compression"),u=c.getAttribute("encoding"),l&&"gzip"!==l&&"zlib"!==l)return cc.log("cc.TMXMapInfo.parseXMLFile(): unsupported compression method"),null;switch(l){case"gzip":o=cc.unzipBase64AsArray(h,4);break;case"zlib":o=new Zlib.Inflate(cc.Codec.Base64.decodeAsArray(h,1)),o=cc.uint8ArrayToUint32Array(o.decompress());break;case null:case"":if("base64"===u)o=cc.Codec.Base64.decodeAsArray(h,4);else if("csv"===u)for(o=[],l=h.split(","),c=0;c<l.length;c++)o.push(parseInt(l[c]));else for(l=c.getElementsByTagName("tile"),o=[],c=0;c<l.length;c++)o.push(parseInt(l[c].getAttribute("gid")));break;default:this.layerAttrs===cc.TMXLayerInfo.ATTRIB_NONE&&cc.log("cc.TMXMapInfo.parseXMLFile(): Only base64 and/or gzip/zlib maps are supported")}if(o&&(r._tiles=new Uint32Array(o)),a=a.querySelectorAll("properties > property")){for(c={},l=0;l<a.length;l++)c[a[l].getAttribute("name")]=a[l].getAttribute("value");r.properties=c}this.setLayers(r)}if(o=i.getElementsByTagName("objectgroup"))for(s=0;s<o.length;s++){if(r=o[s],(n=new cc.TMXObjectGroup).groupName=r.getAttribute("name"),n.setPositionOffset(cc.p(parseFloat(r.getAttribute("x"))*this.getTileSize().width||0,parseFloat(r.getAttribute("y"))*this.getTileSize().height||0)),a=r.querySelectorAll("objectgroup > properties > property"))for(l=0;l<a.length;l++)(c={})[a[l].getAttribute("name")]=a[l].getAttribute("value"),n.properties=c;if(r=r.querySelectorAll("object"),a=cc.director.getContentScaleFactor(),r)for(l=0;l<r.length;l++){if(h=r[l],(c={}).name=h.getAttribute("name")||"",c.type=h.getAttribute("type")||"",c.width=parseInt(h.getAttribute("width"))||0,c.height=parseInt(h.getAttribute("height"))||0,c.x=((0|(h.getAttribute("x")||0))+n.getPositionOffset().x)/a,u=(0|(h.getAttribute("y")||0))+n.getPositionOffset().y/a,c.y=(parseInt(this.getMapSize().height*this.getTileSize().height)-u-c.height)/cc.director.getContentScaleFactor(),c.rotation=parseInt(h.getAttribute("rotation"))||0,u=h.querySelectorAll("properties > property"))for(var d=0;d<u.length;d++)c[u[d].getAttribute("name")]=u[d].getAttribute("value");(u=h.querySelectorAll("polygon"))&&0<u.length&&(u=u[0].getAttribute("points"))&&(c.points=this._parsePointsString(u)),(h=h.querySelectorAll("polyline"))&&0<h.length&&(h=h[0].getAttribute("points"))&&(c.polylinePoints=this._parsePointsString(h)),n.setObjects(c)}this.setObjectGroups(n)}return i},_parsePointsString:function(t){if(!t)return null;var e=[];t=t.split(" ");for(var i=0;i<t.length;i++){var n=t[i].split(",");e.push({x:n[0],y:n[1]})}return e},parseXMLString:function(t){return this.parseXMLFile(t,!0)},getTileProperties:function(){return this._tileProperties},setTileProperties:function(t){this._tileProperties.push(t)},getCurrentString:function(){return this.currentString},setCurrentString:function(t){this.currentString=t},getTMXFileName:function(){return this.tmxFileName},setTMXFileName:function(t){this.tmxFileName=t},_internalInit:function(t,e){this._tilesets.length=0,this._layers.length=0,this.tmxFileName=t,e&&(this._resources=e),this._objectGroups.length=0,this.properties.length=0,this._tileProperties.length=0,this.currentString="",this.storingCharacters=!1,this.layerAttrs=cc.TMXLayerInfo.ATTRIB_NONE,this.parentElement=cc.TMX_PROPERTY_NONE,this._currentFirstGID=0}}),_p=cc.TMXMapInfo.prototype,cc.defineGetterSetter(_p,"mapWidth",_p._getMapWidth,_p._setMapWidth),cc.defineGetterSetter(_p,"mapHeight",_p._getMapHeight,_p._setMapHeight),cc.defineGetterSetter(_p,"tileWidth",_p._getTileWidth,_p._setTileWidth),cc.defineGetterSetter(_p,"tileHeight",_p._getTileHeight,_p._setTileHeight),cc.TMXMapInfo.create=function(t,e){return new cc.TMXMapInfo(t,e)},cc.loader.register(["tmx","tsx"],cc._txtLoader),cc.TMXLayerInfo.ATTRIB_NONE=1,cc.TMXLayerInfo.ATTRIB_BASE64=2,cc.TMXLayerInfo.ATTRIB_GZIP=4,cc.TMXLayerInfo.ATTRIB_ZLIB=8,cc.TMXObjectGroup=cc.Class.extend({properties:null,groupName:"",_positionOffset:null,_objects:null,ctor:function(){this.groupName="",this._positionOffset=cc.p(0,0),this.properties=[],this._objects=[]},getPositionOffset:function(){return cc.p(this._positionOffset)},setPositionOffset:function(t){this._positionOffset.x=t.x,this._positionOffset.y=t.y},getProperties:function(){return this.properties},setProperties:function(t){this.properties.push(t)},getGroupName:function(){return this.groupName.toString()},setGroupName:function(t){this.groupName=t},propertyNamed:function(t){return this.properties[t]},objectNamed:function(t){return this.getObject(t)},getObject:function(t){if(this._objects&&0<this._objects.length)for(var e=this._objects,i=0,n=e.length;i<n;i++){var s=e[i].name;if(s&&s===t)return e[i]}return null},getObjects:function(){return this._objects},setObjects:function(t){this._objects.push(t)}}),cc.TMXLayer=cc.SpriteBatchNode.extend({tiles:null,tileset:null,layerOrientation:null,properties:null,layerName:"",_textures:null,_texGrids:null,_spriteTiles:null,_layerSize:null,_mapTileSize:null,_opacity:255,_minGID:null,_maxGID:null,_vertexZvalue:null,_useAutomaticVertexZ:null,_reusedTile:null,_atlasIndexArray:null,_contentScaleFactor:null,_className:"TMXLayer",ctor:function(t,e,i){cc.SpriteBatchNode.prototype.ctor.call(this),this._descendants=[],this._layerSize=cc.size(0,0),this._mapTileSize=cc.size(0,0),this._spriteTiles={},void 0!==i&&this.initWithTilesetInfo(t,e,i)},_createRenderCmd:function(){return new(cc._renderType===cc.game.RENDER_TYPE_CANVAS?cc.TMXLayer.CanvasRenderCmd:cc.TMXLayer.WebGLRenderCmd)(this)},_fillTextureGrids:function(t,e){if((r=this._textures[e]).isLoaded()){t.imageSize.width&&t.imageSize.height||(t.imageSize.width=r.width,t.imageSize.height=r.height);for(var i=t._tileSize.width,n=t._tileSize.height,s=r._contentSize.width,r=r._contentSize.height,o=t.spacing,a=t.margin,c=t.firstGid,o=t.firstGid+Math.floor((r-2*a+o)/(n+o))*Math.floor((s-2*a+o)/(i+o)),h=null,l=!!(a=this._texGrids)[c];c<o&&((l=l&&!a[c]?!1:l)||!a[c]);++c)t.rectForGID(c,h={texId:e,x:0,y:0,width:i,height:n,t:0,l:0,r:0,b:0}),h.t=h.y/r,h.l=h.x/s,h.r=(h.x+h.width)/s,h.b=(h.y+h.height)/r,a[c]=h}else r.addEventListener("load",function(){this._fillTextureGrids(t,e)},this)},initWithTilesetInfo:function(t,e,i){var n=e._layerSize;if(parseInt(n.width*n.height),this.layerName=e.name,this.tiles=e._tiles,this.properties=e.properties,this._layerSize=n,this._minGID=e._minGID,this._maxGID=e._maxGID,this._opacity=e._opacity,this.tileset=t,this.layerOrientation=i.orientation,this._mapTileSize=i.getTileSize(),i=i._tilesets){this._textures=[],this._texGrids=[];for(var s,r,o=i.length,n=0;n<o;++n)s=i[n],r=cc.textureCache.addImage(s.sourceImage),this._textures.push(r),this._fillTextureGrids(s,n),s===t&&(this._texture=r)}return t=this._calculateLayerOffset(e.offset),this.setPosition(cc.pointPixelsToPoints(t)),this._parseInternalProperties(),this.setContentSize(cc.sizePixelsToPoints(cc.size(this._layerSize.width*this._mapTileSize.width,this._layerSize.height*this._mapTileSize.height))),this._useAutomaticVertexZ=!1,!(this._vertexZvalue=0)},getLayerSize:function(){return cc.size(this._layerSize.width,this._layerSize.height)},setLayerSize:function(t){this._layerSize.width=t.width,this._layerSize.height=t.height},_getLayerWidth:function(){return this._layerSize.width},_setLayerWidth:function(t){this._layerSize.width=t},_getLayerHeight:function(){return this._layerSize.height},_setLayerHeight:function(t){this._layerSize.height=t},getMapTileSize:function(){return cc.size(this._mapTileSize.width,this._mapTileSize.height)},setMapTileSize:function(t){this._mapTileSize.width=t.width,this._mapTileSize.height=t.height},_getTileWidth:function(){return this._mapTileSize.width},_setTileWidth:function(t){this._mapTileSize.width=t},_getTileHeight:function(){return this._mapTileSize.height},_setTileHeight:function(t){this._mapTileSize.height=t},getTiles:function(){return this.tiles},setTiles:function(t){this.tiles=t},getTileset:function(){return this.tileset},setTileset:function(t){this.tileset=t},getLayerOrientation:function(){return this.layerOrientation},setLayerOrientation:function(t){this.layerOrientation=t},getProperties:function(){return this.properties},setProperties:function(t){this.properties=t},getProperty:function(t){return this.properties[t]},getLayerName:function(){return this.layerName},setLayerName:function(t){this.layerName=t},releaseMap:function(){this._spriteTiles={}},getTileAt:function(t,e){if(void 0===t)throw Error("cc.TMXLayer.getTileAt(): pos should be non-null");var i,n,s=t;if(void 0===e&&(s=t.x,e=t.y),s>=this._layerSize.width||e>=this._layerSize.height||s<0||e<0)throw Error("cc.TMXLayer.getTileAt(): invalid position");return this.tiles?(t=null,0===(i=this.getTileGIDAt(s,e))||(n=0|s+e*this._layerSize.width,t=this._spriteTiles[n])||(t=this._texGrids[i],i=this._textures[t.texId],t=cc.rectPixelsToPoints(t),(t=new cc.Sprite(i,t)).setPosition(this.getPositionAt(s,e)),s=this._vertexZForPos(s,e),t.setVertexZ(s),t.setAnchorPoint(0,0),t.setOpacity(this._opacity),this.addChild(t,s,n)),t):(cc.log("cc.TMXLayer.getTileAt(): TMXLayer: the tiles map has been released"),null)},getTileGIDAt:function(t,e){if(void 0===t)throw Error("cc.TMXLayer.getTileGIDAt(): pos should be non-null");var i=t;if(void 0===e&&(i=t.x,e=t.y),i>=this._layerSize.width||e>=this._layerSize.height||i<0||e<0)throw Error("cc.TMXLayer.getTileGIDAt(): invalid position");return this.tiles?(this.tiles[0|i+e*this._layerSize.width]&cc.TMX_TILE_FLIPPED_MASK)>>>0:(cc.log("cc.TMXLayer.getTileGIDAt(): TMXLayer: the tiles map has been released"),null)},setTileGID:function(t,e,i,n){if(void 0===e)throw Error("cc.TMXLayer.setTileGID(): pos should be non-null");if(void 0!==n?e=cc.p(e,i):n=i,e.x>=this._layerSize.width||e.y>=this._layerSize.height||e.x<0||e.y<0)throw Error("cc.TMXLayer.setTileGID(): invalid position");var s,r,o;this.tiles?0!==t&&t<this.tileset.firstGid?cc.log("cc.TMXLayer.setTileGID(): invalid gid:"+t):(n=n||0,i=this.getTileFlagsAt(e),(s=this.getTileGIDAt(e))===t&&i===n||(i=(t|n)>>>0,0===t?this.removeTileAt(e):0!==s&&(s=e.x+e.y*this._layerSize.width,r=this.getChildByTag(s))?(t=this._texGrids[t],o=this._textures[t.texId],t=cc.rectPixelsToPoints(t),r.setTexture(o),r.setTextureRect(t,!1),null!=n&&this._setupTileSprite(r,e,i),this.tiles[s]=i):this._updateTileForGID(i,e))):cc.log("cc.TMXLayer.setTileGID(): TMXLayer: the tiles map has been released")},addChild:function(t,e,i){cc.Node.prototype.addChild.call(this,t,e,i),void 0!==i&&((this._spriteTiles[i]=t)._vertexZ=this._vertexZ+cc.renderer.assignedZStep*i/this.tiles.length)},removeChild:function(t,e){this._spriteTiles[t.tag]&&(this._spriteTiles[t.tag]=null),cc.Node.prototype.removeChild.call(this,t,e)},getTileFlagsAt:function(t,e){if(!t)throw Error("cc.TMXLayer.getTileFlagsAt(): pos should be non-null");if((t=void 0!==e?cc.p(t,e):t).x>=this._layerSize.width||t.y>=this._layerSize.height||t.x<0||t.y<0)throw Error("cc.TMXLayer.getTileFlagsAt(): invalid position");return this.tiles?(this.tiles[0|t.x+t.y*this._layerSize.width]&cc.TMX_TILE_FLIPPED_ALL)>>>0:(cc.log("cc.TMXLayer.getTileFlagsAt(): TMXLayer: the tiles map has been released"),null)},removeTileAt:function(t,e){if(!t)throw Error("cc.TMXLayer.removeTileAt(): pos should be non-null");if((t=void 0!==e?cc.p(t,e):t).x>=this._layerSize.width||t.y>=this._layerSize.height||t.x<0||t.y<0)throw Error("cc.TMXLayer.removeTileAt(): invalid position");this.tiles?0!==this.getTileGIDAt(t)&&(e=0|t.x+t.y*this._layerSize.width,this.tiles[e]=0,e=this._spriteTiles[e])&&this.removeChild(e,!0):cc.log("cc.TMXLayer.removeTileAt(): TMXLayer: the tiles map has been released")},getPositionAt:function(t,e){void 0!==e&&(t=cc.p(t,e));var i=cc.p(0,0);switch(this.layerOrientation){case cc.TMX_ORIENTATION_ORTHO:i=this._positionForOrthoAt(t);break;case cc.TMX_ORIENTATION_ISO:i=this._positionForIsoAt(t);break;case cc.TMX_ORIENTATION_HEX:i=this._positionForHexAt(t)}return cc.pointPixelsToPoints(i)},_positionForIsoAt:function(t){return cc.p(this._mapTileSize.width/2*(this._layerSize.width+t.x-t.y-1),this._mapTileSize.height/2*(2*this._layerSize.height-t.x-t.y-2))},_positionForOrthoAt:function(t){return cc.p(t.x*this._mapTileSize.width,(this._layerSize.height-t.y-1)*this._mapTileSize.height)},_positionForHexAt:function(t){return cc.p(t.x*this._mapTileSize.width*3/4,(this._layerSize.height-t.y-1)*this._mapTileSize.height+(1==t.x%2?-this._mapTileSize.height/2:0))},_calculateLayerOffset:function(t){var e=cc.p(0,0);switch(this.layerOrientation){case cc.TMX_ORIENTATION_ORTHO:e=cc.p(t.x*this._mapTileSize.width,-t.y*this._mapTileSize.height);break;case cc.TMX_ORIENTATION_ISO:e=cc.p(this._mapTileSize.width/2*(t.x-t.y),this._mapTileSize.height/2*(-t.x-t.y));break;case cc.TMX_ORIENTATION_HEX:0===t.x&&0===t.y||cc.log("offset for hexagonal map not implemented yet")}return e},_updateTileForGID:function(t,e){this._texGrids[t]&&(e=0|e.x+e.y*this._layerSize.width)<this.tiles.length&&(this.tiles[e]=t)},_parseInternalProperties:function(){var t,e=this.getProperty("cc_vertexz");e&&("automatic"===e?(this._useAutomaticVertexZ=!0,t=0,(e=this.getProperty("cc_alpha_func"))&&(t=parseFloat(e)),cc._renderType===cc.game.RENDER_TYPE_WEBGL&&(this.shaderProgram=cc.shaderCache.programForKey(cc.SHADER_SPRITE_POSITION_TEXTURECOLORALPHATEST),this.shaderProgram.use(),this.shaderProgram.setUniformLocationWith1f(cc.UNIFORM_ALPHA_TEST_VALUE_S,t))):this._vertexZvalue=parseInt(e,10))},_setupTileSprite:function(t,e,i){var n=this.getPositionAt(e);t.setPosition(n),t.setVertexZ(this._vertexZForPos(e)),t.setAnchorPoint(0,0),t.setOpacity(this._opacity),t.setFlippedX(!1),t.setFlippedY(!1),t.setRotation(0),(i&cc.TMX_TILE_DIAGONAL_FLAG)>>>0?(t.setAnchorPoint(.5,.5),t.setPosition(n.x+t.width/2,n.y+t.height/2),(e=(i&(cc.TMX_TILE_HORIZONTAL_FLAG|cc.TMX_TILE_VERTICAL_FLAG)>>>0)>>>0)===cc.TMX_TILE_HORIZONTAL_FLAG?t.setRotation(90):e===cc.TMX_TILE_VERTICAL_FLAG?t.setRotation(270):(e===(cc.TMX_TILE_VERTICAL_FLAG|cc.TMX_TILE_HORIZONTAL_FLAG)>>>0?t.setRotation(90):t.setRotation(270),t.setFlippedX(!0))):((i&cc.TMX_TILE_HORIZONTAL_FLAG)>>>0&&t.setFlippedX(!0),(i&cc.TMX_TILE_VERTICAL_FLAG)>>>0&&t.setFlippedY(!0))},_vertexZForPos:function(t,e){void 0===e&&(e=t.y,t=t.x);var i=0;if(this._useAutomaticVertexZ)switch(this.layerOrientation){case cc.TMX_ORIENTATION_ISO:i=-(this._layerSize.width+this._layerSize.height-(t+e));break;case cc.TMX_ORIENTATION_ORTHO:i=-(this._layerSize.height-e);break;case cc.TMX_ORIENTATION_HEX:cc.log("TMX Hexa zOrder not supported");break;default:cc.log("TMX invalid value")}else i=this._vertexZvalue;return i}}),_p=cc.TMXLayer.prototype,cc.defineGetterSetter(_p,"layerWidth",_p._getLayerWidth,_p._setLayerWidth),cc.defineGetterSetter(_p,"layerHeight",_p._getLayerHeight,_p._setLayerHeight),cc.defineGetterSetter(_p,"tileWidth",_p._getTileWidth,_p._setTileWidth),cc.defineGetterSetter(_p,"tileHeight",_p._getTileHeight,_p._setTileHeight),cc.TMXLayer.create=function(t,e,i){return new cc.TMXLayer(t,e,i)},!function(){cc.TMXLayer.CanvasRenderCmd=function(t){this._rootCtor(t),this._needDraw=!0};var t=cc.TMXLayer.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);t.constructor=cc.TMXLayer.CanvasRenderCmd,t.visit=function(t){var e=this._node,i=cc.renderer;if((t=t||this.getParentRenderCmd())&&(this._curLevel=t._curLevel+1),e._visible){isNaN(e._customZ)&&(e._vertexZ=i.assignedZ,i.assignedZ+=i.assignedZStep),this._syncStatus(t),t=e._children;var n,s=e._spriteTiles,r=t.length;if(0<r){for(e.sortAllChildren(),n=0;n<r&&(e=t[n])._localZOrder<0;n++)e._renderCmd.visit(this);for(i.pushRenderCommand(this);n<r;n++)0===(e=t[n])._localZOrder&&s[e.tag]?(isNaN(e._customZ)&&(e._vertexZ=i.assignedZ,i.assignedZ+=i.assignedZStep),e._renderCmd.updateStatus()):e._renderCmd.visit(this)}else i.pushRenderCommand(this);this._dirtyFlag=0}},t.rendering=function(t,e,i){var n=this._node,M=n._rotationX||n._rotationY,s=n.layerOrientation,r=n._opacity/255;if(n.tiles&&!(r<=0)){var o=n._mapTileSize.width,a=n._mapTileSize.height,c=n.tileset._tileSize.width/cc.director._contentScaleFactor,h=n.tileset._tileSize.height/cc.director._contentScaleFactor,l=c-o,u=h-a,O=cc.winSize.width,d=cc.winSize.height,_=n._layerSize.height,p=n._layerSize.width,G=n._texGrids,f=n._spriteTiles,g=this._worldTransform,m=-n._contentSize.width*n._anchorPoint.x,y=-n._contentSize.height*n._anchorPoint.y,T=g.a,S=g.d,C=m*T+y*g.c+g.tx,m=m*g.b+y*S+g.ty,E=(y=t||cc._renderContext).getContext(),I=0,v=0,b=p,A=_;M||s!==cc.TMX_ORIENTATION_ORTHO||((I=Math.floor(-(C-l*T)/(o*T)))<0&&(I=0),(v=Math.floor((m-u*S+a*_*S-d)/(a*S)))<0&&(v=0),p<(b=Math.ceil((O-C+l*T)/(o*T)))&&(b=p),_<(A=_-Math.floor(-(m+u*S)/(a*S)))&&(A=_));var F,x,P,R,L,B,D,w,k,N,l=v*p,V=cc.TMX_TILE_FLIPPED_MASK,U=c*T,W=h*S,J=!1,z=!1,u=l+I;for(F in f)if(F<u&&f[F])P=f[F]._renderCmd,0===f[F]._localZOrder&&P.rendering&&P.rendering(t,e,i);else if(u<=F)break;for(y.setTransform(g,e,i),y.setGlobalAlpha(r);v<A;++v){for(x=I;x<b;++x)if(f[u=l+x])P=f[u]._renderCmd,0===f[u]._localZOrder&&P.rendering&&(P.rendering(t,e,i),y.setTransform(g,e,i),y.setGlobalAlpha(r));else if((R=G[((P=n.tiles[u])&V)>>>0])&&(L=n._textures[R.texId])&&L._htmlElementObj){switch(s){case cc.TMX_ORIENTATION_ORTHO:D=x*o,w=-(_-v-1)*a;break;case cc.TMX_ORIENTATION_ISO:D=o/2*(p+x-v-1),w=-a/2*(2*_-x-v-2);break;case cc.TMX_ORIENTATION_HEX:D=x*o*3/4,w=-(_-v-1)*a+(1==x%2?-a/2:0)}if(k=D+c,B=w-h,!M&&s===cc.TMX_ORIENTATION_ISO){if((N=w*S-m)<-d-W){x+=Math.floor(2*(-d-N)/W)-1;continue}if((N=C+k*T)<-U){x+=Math.floor(2*-N/U)-1;continue}if(O<C+D*T||0<B*S-m){x=b;continue}}P>cc.TMX_TILE_DIAGONAL_FLAG&&(J=(P&cc.TMX_TILE_HORIZONTAL_FLAG)>>>0,z=(P&cc.TMX_TILE_VERTICAL_FLAG)>>>0),J&&(D=-k,E.scale(-1,1)),z&&(B=-w,E.scale(1,-1)),E.drawImage(L._htmlElementObj,R.x,R.y,R.width,R.height,D,B,c,h),J&&E.scale(-1,1),z&&E.scale(1,-1),cc.g_NumberOfDraws++}l+=p}for(F in f)u<F&&f[F]&&(P=f[F]._renderCmd,0===f[F]._localZOrder)&&P.rendering&&P.rendering(t,e,i)}}}(),!function(){cc.TMXLayer.WebGLRenderCmd=function(t){this._rootCtor(t),this._needDraw=!0,this._vertices=[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}],this._color=new Uint32Array(1),this._shaderProgram=cc.shaderCache.programForKey(cc.SHADER_SPRITE_POSITION_TEXTURECOLORALPHATEST),t=90*Math.PI/180,this._sin90=Math.sin(t),this._cos90=Math.cos(t),t*=3,this._sin270=Math.sin(t),this._cos270=Math.cos(t)};var t=cc.TMXLayer.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype);t.constructor=cc.TMXLayer.WebGLRenderCmd,t.uploadData=function(t,M,e){var i=this._node,O=i._rotationX||i._rotationY,G=i.layerOrientation,k=i.tiles;if(!k)return 0;var n=i._mapTileSize.width,s=i._mapTileSize.height,V=i.tileset._tileSize.width/cc.director._contentScaleFactor,U=i.tileset._tileSize.height/cc.director._contentScaleFactor,r=V-n,o=U-s,W=cc.winSize.width,J=cc.winSize.height,a=i._layerSize.height,c=i._layerSize.width,z=i._texGrids,X=i._spriteTiles,h=(u=this._worldTransform).a,H=u.b,Y=u.c,l=u.d,j=u.tx,u=u.ty,d=(_=-i._contentSize.width*i._anchorPoint.x)*h+(p=-i._contentSize.height*i._anchorPoint.y)*Y+j,_=_*H+p*l+u,p=i._opacity,f=this._displayedColor.r,g=this._displayedColor.g,K=this._displayedColor.b,m=(i._opacityModifyRGB&&(f*=A=p/255,g*=A,K*=A),this._color[0]=p<<24|K<<16|g<<8|f,p=0),f=c,g=a;O||G!==cc.TMX_ORIENTATION_ORTHO||((p=Math.floor(-(d-r*h)/(n*h)))<0&&(p=0),(m=Math.floor((_-o*l+s*a*l-J)/(s*l)))<0&&(m=0),c<(f=Math.ceil((W-d+r*h)/(n*h)))&&(f=c),a<(g=a-Math.floor(-(_+o*l)/(s*l)))&&(g=a));for(var y,T,S,C,E,I,v,b,Q,r=e,o=m*c,K=cc.TMX_TILE_FLIPPED_MASK,A=V*h,Z=U*l,F=h,x=H,P=Y,R=l,L=j,B=u,q=!1,D=!1,w=!1,N=this._vertices;m<g;++m){for(y=p;y<f;++y)if(r+24>t.length&&(cc.renderer._increaseBatchingSize((r-e)/6),cc.renderer._batchRendering(),r=e=0),!X[T=o+y]&&(C=z[((S=i.tiles[T])&K)>>>0])){switch(G){case cc.TMX_ORIENTATION_ORTHO:I=y*n,v=(a-m-1)*s,T=i._vertexZ+cc.renderer.assignedZStep*T/k.length;break;case cc.TMX_ORIENTATION_ISO:I=n/2*(c+y-m-1),T=i._vertexZ+cc.renderer.assignedZStep*(i.height-(v=s/2*(2*a-y-m-2)))/i.height;break;case cc.TMX_ORIENTATION_HEX:I=y*n*3/4,T=i._vertexZ+cc.renderer.assignedZStep*(i.height-(v=(a-m-1)*s+(1==y%2?-s/2:0)))/i.height}if(b=I+V,E=v+U,!O&&G===cc.TMX_ORIENTATION_ISO){if(J+Z<(Q=_+v*l)){y+=Math.floor(2*(Q-J)/Z)-1;continue}if((Q=d+b*h)<-A){y+=Math.floor(2*-Q/A)-1;continue}if(W<d+I*h||_+E*l<0){y=f;continue}}for(S>cc.TMX_TILE_DIAGONAL_FLAG&&(q=!0,D=(S&cc.TMX_TILE_HORIZONTAL_FLAG)>>>0,w=(S&cc.TMX_TILE_VERTICAL_FLAG)>>>0),N[0].x=I*F+E*P+L,N[0].y=I*x+E*R+B,N[1].x=I*F+v*P+L,N[1].y=I*x+v*R+B,N[2].x=b*F+E*P+L,N[2].y=b*x+E*R+B,N[3].x=b*F+v*P+L,N[3].y=b*x+v*R+B,S=0;S<4;++S){switch(t[r]=N[S].x,t[r+1]=N[S].y,t[r+2]=T,M[r+3]=this._color[0],S){case 0:t[r+4]=D?C.r:C.l,t[r+5]=w?C.b:C.t;break;case 1:t[r+4]=D?C.r:C.l,t[r+5]=w?C.t:C.b;break;case 2:t[r+4]=D?C.l:C.r,t[r+5]=w?C.b:C.t;break;case 3:t[r+4]=D?C.l:C.r,t[r+5]=w?C.t:C.b}r+=6}q&&(F=h,x=H,P=Y,R=l,L=j,B=u,q=w=D=!1)}o+=c}return(r-e)/6}}(),cc.PointObject=cc.Class.extend({_ratio:null,_offset:null,_child:null,ctor:function(t,e){this.initWithCCPoint(t,e)},getRatio:function(){return this._ratio},setRatio:function(t){this._ratio=t},getOffset:function(){return this._offset},setOffset:function(t){this._offset=t},getChild:function(){return this._child},setChild:function(t){this._child=t},initWithCCPoint:function(t,e){return this._ratio=t,this._offset=e,!(this._child=null)}}),cc.PointObject.create=function(t,e){return new cc.PointObject(t,e)},cc.ParallaxNode=cc.Node.extend({parallaxArray:null,_lastPosition:null,_className:"ParallaxNode",getParallaxArray:function(){return this.parallaxArray},setParallaxArray:function(t){this.parallaxArray=t},ctor:function(){cc.Node.prototype.ctor.call(this),this.parallaxArray=[],this._lastPosition=cc.p(-100,-100)},addChild:function(t,e,i,n){if(3===arguments.length)cc.log("ParallaxNode: use addChild(child, z, ratio, offset) instead");else{if(!t)throw Error("cc.ParallaxNode.addChild(): child should be non-null");var s=new cc.PointObject(i,n);s.setChild(t),this.parallaxArray.push(s),t.setPosition(this._position.x*i.x+n.x,this._position.y*i.y+n.y),cc.Node.prototype.addChild.call(this,t,e,t.tag)}},removeChild:function(t,e){for(var i=this.parallaxArray,n=0;n<i.length;n++)if(i[n].getChild()===t){i.splice(n,1);break}cc.Node.prototype.removeChild.call(this,t,e)},removeAllChildren:function(t){this.parallaxArray.length=0,cc.Node.prototype.removeAllChildren.call(this,t)},_updateParallaxPosition:function(){var t=this._absolutePosition();if(!cc.pointEqualToPoint(t,this._lastPosition)){for(var e=this.parallaxArray,i=0,n=e.length;i<n;i++){var s=e[i];s.getChild().setPosition(-t.x+t.x*s.getRatio().x+s.getOffset().x,-t.y+t.y*s.getRatio().y+s.getOffset().y)}this._lastPosition=t}},_absolutePosition:function(){for(var t=this._position,e=this;null!==e.parent;)e=e.parent,t=cc.pAdd(t,e.getPosition());return t},_createRenderCmd:function(){return new(cc._renderType===cc.game.RENDER_TYPE_CANVAS?cc.ParallaxNode.CanvasRenderCmd:cc.ParallaxNode.WebGLRenderCmd)(this)}}),cc.ParallaxNode.create=function(){return new cc.ParallaxNode},!function(){cc.ParallaxNode.CanvasRenderCmd=function(t){this._rootCtor(t),this._needDraw=!1};var t=cc.ParallaxNode.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);t.constructor=cc.ParallaxNode.CanvasRenderCmd,t.updateStatus=function(){this._node._updateParallaxPosition(),this.originUpdateStatus()},t._syncStatus=function(t){this._node._updateParallaxPosition(),this._originSyncStatus(t)}}(),cc.game.addEventListener(cc.game.EVENT_RENDERER_INITED,function(){var t;cc._renderType===cc.game.RENDER_TYPE_WEBGL&&(cc.ParallaxNode.WebGLRenderCmd=function(t){this._rootCtor(t),this._needDraw=!1},(t=cc.ParallaxNode.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype)).constructor=cc.ParallaxNode.WebGLRenderCmd,t.updateStatus=function(){this._node._updateParallaxPosition(),this.originUpdateStatus()},t._syncStatus=function(t){this._node._updateParallaxPosition(),this._originSyncStatus(t)})}),!function(){var t=cc.sys,e={ONLY_ONE:!1,WEB_AUDIO:!!(window.AudioContext||window.webkitAudioContext||window.mozAudioContext),DELAY_CREATE_CTX:!1,ONE_SOURCE:!1};t.browserType===t.BROWSER_TYPE_FIREFOX&&(e.DELAY_CREATE_CTX=!0,e.USE_LOADER_EVENT="canplay"),t.os===t.OS_IOS&&(e.USE_LOADER_EVENT="loadedmetadata"),t.os===t.OS_ANDROID&&t.browserType===t.BROWSER_TYPE_UC&&(e.ONE_SOURCE=!0),window.__audioSupport=e}(),cc.Audio=cc.Class.extend({interruptPlay:!1,src:null,_element:null,_AUDIO_TYPE:"AUDIO",ctor:function(t){this.src=t},setBuffer:function(t){this._AUDIO_TYPE="WEBAUDIO",this._element=new cc.Audio.WebAudio(t)},setElement:function(t){this._AUDIO_TYPE="AUDIO",(this._element=t).addEventListener("ended",function(){t.loop||(t.paused=!0)})},play:function(t,e){this._element?(this._element.loop=e,this._element.play(),"AUDIO"===this._AUDIO_TYPE&&this._element.paused&&(this.stop(),cc.Audio.touchPlayList.push({loop:e,offset:t,audio:this._element})),!1===cc.Audio.bindTouch&&(cc.Audio.bindTouch=!0,cc.game.canvas.addEventListener("touchstart",cc.Audio.touchStart))):this.interruptPlay=!1},getPlaying:function(){return!this._element||!this._element.paused},stop:function(){if(this._element){this._element.pause();try{this._element.currentTime=0}catch(t){}}else this.interruptPlay=!0},pause:function(){this._element?this._element.pause():this.interruptPlay=!0},resume:function(){this._element?this._element.play():this.interruptPlay=!1},setVolume:function(t){this._element&&(this._element.volume=t)},getVolume:function(){if(this._element)return this._element.volume},cloneNode:function(){var t=new cc.Audio(this.src);if("AUDIO"===this._AUDIO_TYPE){for(var e=document.createElement("audio"),i=e.getElementsByTagName("source"),n=0;n<i.length;n++)e.appendChild(i[n]);e.src=this.src,t.setElement(e)}else t.setBuffer(this._element.buffer);return t}}),cc.Audio.touchPlayList=[],cc.Audio.bindTouch=!1,cc.Audio.touchStart=function(){for(var t=cc.Audio.touchPlayList,e=null;e=t.pop();)e.audio.loop=!!e.loop,e.audio.play(e.offset)},cc.Audio.WebAudio=function(t){this.buffer=t,this.context=cc.Audio._context,(t=this.context.createGain()).gain.value=1,t.connect(this.context.destination),this._volume=t,this._loop=!1,this._startTime=-1,this._currentSource=null,this.playedLength=0,this._currextTimer=null},cc.Audio.WebAudio.prototype={constructor:cc.Audio.WebAudio,get paused(){return(!this._currentSource||!this._currentSource.loop)&&(-1===this._startTime||this.context.currentTime-this._startTime>this.buffer.duration)},set paused(t){},get loop(){return this._loop},set loop(t){return this._loop=t},get volume(){return this._volume.gain.value},set volume(t){return this._volume.gain.value=t},get currentTime(){return this.playedLength},set currentTime(t){return this.playedLength=t},play:function(t){this._currentSource&&!this.paused&&(this._currentSource.stop(0),this.playedLength=0);var e,i=this.context.createBufferSource(),n=(i.buffer=this.buffer,i.connect(this._volume),i.loop=this._loop,this._startTime=this.context.currentTime,t=t||this.playedLength,this.buffer.duration);this._loop?i.start?i.start(0):i.notoGrainOn?i.noteGrainOn(0):i.noteOn(0):i.start?i.start(0,t,n-t):i.notoGrainOn?i.noteGrainOn(0,t,n-t):i.noteOn(0,t,n-t),this._currentSource=i,0===this.context.currentTime&&(e=this,clearTimeout(this._currextTimer),this._currextTimer=setTimeout(function(){0===e.context.currentTime&&cc.Audio.touchPlayList.push({offset:t,audio:e})},10))},pause:function(){this.playedLength=this.context.currentTime-this._startTime,this.playedLength%=this.buffer.duration;var t=this._currentSource;this._currentSource=null,this._startTime=-1,t&&t.stop(0)}},!function(d){var t,e,_=d.WEB_AUDIO,r=d.ONLY_ONE,p=[];(e=document.createElement("audio")).canPlayType&&((t=e.canPlayType('audio/ogg; codecs="vorbis"'))&&""!==t&&p.push(".ogg"),(t=e.canPlayType("audio/mpeg"))&&""!==t&&p.push(".mp3"),(t=e.canPlayType('audio/wav; codecs="1"'))&&""!==t&&p.push(".wav"),(t=e.canPlayType("audio/mp4"))&&""!==t&&p.push(".mp4"),e=e.canPlayType("audio/x-m4a"))&&""!==e&&p.push(".m4a");try{if(_){var n=new(window.AudioContext||window.webkitAudioContext||window.mozAudioContext);if(!((cc.Audio._context=n).createBufferSource&&n.createGain&&n.destination&&n.decodeAudioData))throw"context is incomplete";d.DELAY_CREATE_CTX&&setTimeout(function(){n=new(window.AudioContext||window.webkitAudioContext||window.mozAudioContext),cc.Audio._context=n},0)}}catch(t){_=!1,cc.log("browser don't support web audio")}var o={cache:{},useWebAudio:!0,loadBuffer:function(t,e){var i;_&&((i=cc.loader.getXMLHttpRequest()).open("GET",t,!0),i.responseType="arraybuffer",i.onload=function(){0<=i._timeoutId&&clearTimeout(i._timeoutId),n.decodeAudioData(i.response,function(t){e(null,t)},function(){e("decode error - "+t)})},i.onerror=function(){e("request error - "+t)},void 0===i.ontimeout&&(i._timeoutId=setTimeout(function(){i.ontimeout()},i.timeout)),i.ontimeout=function(){e("request timeout - "+t)},i.send())},load:function(t,e,i,n){if(0===p.length)return n("can not support audio!");var s=cc.loader.getRes(e);if(s)return n(null,s);cc.loader.audioPath&&(t=cc.path.join(cc.loader.audioPath,t)),i=[s=cc.path.extname(t)];for(var r=0;r<p.length;r++)s!==p[r]&&i.push(p[r]);return s=new cc.Audio(t),cc.loader.cache[e]=s,this.loadAudioFromExtList(t,i,s,n),s},loadAudioFromExtList:function(t,e,i,n){var s;if(0===e.length)return s=(s="can not found the resource of audio! Last match url is : ")+t.replace(/\.(.*)?$/,"("),p.forEach(function(t){s+=t+"|"}),s=s.replace(/\|$/,")"),n({status:520,errorMessage:s},null);if(_&&this.useWebAudio)this.loadBuffer(t,function(t,e){t&&cc.log(t),e&&i.setBuffer(e),n(null,i)});else{for(var r=d.ONE_SOURCE?1:e.length,o=document.createElement("audio"),a=0;a<r;a++){var c=document.createElement("source");c.src=cc.path.changeExtname(t,e[a]),o.appendChild(c)}i.setElement(o);var h=setTimeout(function(){(0===o.readyState?u:l)()},8e3),l=function(){o.removeEventListener("canplaythrough",l,!1),o.removeEventListener("error",u,!1),o.removeEventListener("emptied",l,!1),d.USE_LOADER_EVENT&&o.removeEventListener(d.USE_LOADER_EVENT,l,!1),clearTimeout(h),n(null,i)},u=function(){cc.log("load audio failure - "+t),l()};o.addEventListener("canplaythrough",l,!1),o.addEventListener("error",u,!1),d.USE_LOADER_EVENT&&o.addEventListener(d.USE_LOADER_EVENT,l,!1)}}};cc.loader.register(["mp3","ogg","wav","mp4","m4a"],o),cc.audioEngine={_currMusic:null,_musicVolume:1,features:d,willPlayMusic:function(){return!1},playMusic:function(t,e){var i=this._currMusic,n=(i&&i.getPlaying()&&i.stop(),this._musicVolume),s=cc.loader.getRes(t);s||(cc.loader.load(t,function(){s.getPlaying()||s.interruptPlay||(s.setVolume(n),s.play(0,e||!1))}),s=cc.loader.getRes(t)),s.setVolume(n),s.play(0,e||!1),this._currMusic=s},stopMusic:function(t){var e=this._currMusic;if(e){for(var i=cc.Audio.touchPlayList,n=i.length-1;0<=n;--n)this[n]&&this[n].audio===e._element&&i.splice(n,1);e.stop(),this._currMusic=null,t&&cc.loader.release(e.src)}},pauseMusic:function(){var t=this._currMusic;t&&t.pause()},resumeMusic:function(){var t=this._currMusic;t&&t.resume()},rewindMusic:function(){var t=this._currMusic;t&&(t.stop(),t.play())},getMusicVolume:function(){return this._musicVolume},setMusicVolume:function(t){t-=0,isNaN(t)&&(t=1),this._musicVolume=t=(t=1<t?1:t)<0?0:t;var e=this._currMusic;e&&e.setVolume(t)},isMusicPlaying:function(){var t=this._currMusic;return!!t&&t.getPlaying()},_audioPool:{},_maxAudioInstance:10,_effectVolume:1,playEffect:function(e,i){if(r&&this._currMusic&&this._currMusic.getPlaying())return cc.log("Browser is only allowed to play one audio"),null;for(var n,s=(s=this._audioPool[e])||(this._audioPool[e]=[]),t=0;t<s.length&&s[t].getPlaying();t++);if(!_&&t>this._maxAudioInstance&&((t=s.shift()).stop(),s.push(t),t=s.length-1),s[t])(n=s[t]).setVolume(this._effectVolume),n.play(0,i||!1);else{if((n=cc.loader.getRes(e))&&_&&"AUDIO"===n._AUDIO_TYPE&&(cc.loader.release(e),n=null),n){if(!_||"AUDIO"!==n._AUDIO_TYPE)return(n=n.cloneNode()).setVolume(this._effectVolume),n.play(0,i||!1),s.push(n),n;o.loadBuffer(e,function(t,e){n.setBuffer(e),n.setVolume(cc.audioEngine._effectVolume),n.getPlaying()||n.play(0,i||!1)})}t=o.useWebAudio,o.useWebAudio=!0,cc.loader.load(e,function(t){(t=(t=cc.loader.getRes(e)).cloneNode()).setVolume(cc.audioEngine._effectVolume),t.play(0,i||!1),s.push(t)}),o.useWebAudio=t}return n},setEffectsVolume:function(t){t-=0,isNaN(t)&&(t=1),this._effectVolume=t=(t=1<t?1:t)<0?0:t;var e,i=this._audioPool;for(e in i){var n=i[e];if(Array.isArray(n))for(var s=0;s<n.length;s++)n[s].setVolume(t)}},getEffectsVolume:function(){return this._effectVolume},pauseEffect:function(t){t&&t.pause()},pauseAllEffects:function(){var t,e=this._audioPool;for(t in e)for(var i=e[t],n=0;n<e[t].length;n++)i[n].getPlaying()&&i[n].pause()},resumeEffect:function(t){t&&t.resume()},resumeAllEffects:function(){var t,e=this._audioPool;for(t in e)for(var i=e[t],n=0;n<e[t].length;n++)i[n].resume()},stopEffect:function(t){t&&t.stop()},stopAllEffects:function(){var t,e=this._audioPool;for(t in e){for(var i=e[t],n=0;n<i.length;n++)i[n].stop();i.length=0}e.length=0},unloadEffect:function(t){if(t){cc.loader.release(t);var e=this._audioPool[t];if(e){for(var i=0;i<e.length;i++)e[i].stop();e.length=0}delete this._audioPool[t]}},end:function(){this.stopMusic(),this.stopAllEffects()},_pauseCache:[],_pausePlaying:function(){var t,e=this._currMusic;for(t in e&&e.getPlaying()&&(e.pause(),this._pauseCache.push(e)),e=this._audioPool)for(var i=e[t],n=0;n<e[t].length;n++)i[n].getPlaying()&&(i[n].pause(),this._pauseCache.push(i[n]))},_resumePlaying:function(){for(var t=this._pauseCache,e=0;e<t.length;e++)t[e].resume();t.length=0}}}(window.__audioSupport),cc.ProtectedNode=cc.Node.extend({_protectedChildren:null,_reorderProtectedChildDirty:!1,_insertProtectedChild:function(t,e){this._reorderProtectedChildDirty=!0,this._protectedChildren.push(t),t._setLocalZOrder(e)},ctor:function(){cc.Node.prototype.ctor.call(this),this._protectedChildren=[]},visit:function(t){var e=this._renderCmd,i=t?t._renderCmd:null;if(this._visible){t=cc.renderer;var n,s,r=this._children,o=r.length,a=this._protectedChildren,c=a.length,h=(e.visit(i),this.grid);for(h&&h._active&&h.beforeDraw(),this._reorderChildDirty&&this.sortAllChildren(),this._reorderProtectedChildDirty&&this.sortAllProtectedChildren(),i=0;i<o&&(n=r[i])._localZOrder<0;i++)n.visit(this);for(n=0;n<c&&((s=a[n])&&s._localZOrder<0);n++)e._changeProtectedChild(s),s.visit(this);for(t.pushRenderCommand(e);i<o;i++)r[i].visit(this);for(;n<c;n++)(s=a[n])&&(e._changeProtectedChild(s),s.visit(this));h&&h._active&&h.afterDraw(this),e._dirtyFlag=0}else e._propagateFlagsDown(i)},addProtectedChild:function(t,e,i){cc.assert(null!=t,"child must be non-nil"),cc.assert(!t.parent,"child already added. It can't be added again"),e=e||t.getLocalZOrder(),i&&t.setTag(i),this._insertProtectedChild(t,e),t.setParent(this),t.setOrderOfArrival(cc.s_globalOrderOfArrival),this._running&&(t._performRecursive(cc.Node._stateCallbackType.onEnter),this._isTransitionFinished)&&t._performRecursive(cc.Node._stateCallbackType.onEnterTransitionDidFinish),this._cascadeColorEnabled&&this._renderCmd.setCascadeColorEnabledDirty(),this._cascadeOpacityEnabled&&this._renderCmd.setCascadeOpacityEnabledDirty()},getProtectedChildByTag:function(t){cc.assert(t!==cc.NODE_TAG_INVALID,"Invalid tag");for(var e=this._protectedChildren,i=0,n=e.length;i<n;i++)if(e.getTag()===t)return e[i];return null},removeProtectedChild:function(t,e){null==e&&(e=!0);var i,n=this._protectedChildren;0!==n.length&&-1<(i=n.indexOf(t))&&(this._running&&(t._performRecursive(cc.Node._stateCallbackType.onExitTransitionDidStart),t._performRecursive(cc.Node._stateCallbackType.onExit)),e&&t._performRecursive(cc.Node._stateCallbackType.cleanup),t.setParent(null),n.splice(i,1))},removeProtectedChildByTag:function(t,e){cc.assert(t!==cc.NODE_TAG_INVALID,"Invalid tag"),null==e&&(e=!0);var i=this.getProtectedChildByTag(t);null==i?cc.log("cocos2d: removeChildByTag(tag = %d): child not found!",t):this.removeProtectedChild(i,e)},removeAllProtectedChildren:function(){this.removeAllProtectedChildrenWithCleanup(!0)},removeAllProtectedChildrenWithCleanup:function(t){null==t&&(t=!0);for(var e=this._protectedChildren,i=0,n=e.length;i<n;i++){var s=e[i];this._running&&(s._performRecursive(cc.Node._stateCallbackType.onExitTransitionDidStart),s._performRecursive(cc.Node._stateCallbackType.onExit)),t&&s._performRecursive(cc.Node._stateCallbackType.cleanup),s.setParent(null)}e.length=0},reorderProtectedChild:function(t,e){cc.assert(null!=t,"Child must be non-nil"),this._reorderProtectedChildDirty=!0,t.setOrderOfArrival(cc.s_globalOrderOfArrival++),t._setLocalZOrder(e)},sortAllProtectedChildren:function(){if(this._reorderProtectedChildDirty){for(var t,e,i=this._protectedChildren,n=i.length,s=1;s<n;s++){for(e=i[s],t=s-1;0<=t&&(e._localZOrder<i[t]._localZOrder||e._localZOrder===i[t]._localZOrder&&e.arrivalOrder<i[t].arrivalOrder);)i[t+1]=i[t],t--;i[t+1]=e}this._reorderProtectedChildDirty=!1}},_changePosition:function(){},_createRenderCmd:function(){return new(cc._renderType===cc.game.RENDER_TYPE_CANVAS?cc.ProtectedNode.CanvasRenderCmd:cc.ProtectedNode.WebGLRenderCmd)(this)}}),cc.ProtectedNode.create=function(){return new cc.ProtectedNode},!function(){cc.ProtectedNode.RenderCmd={_updateDisplayColor:function(t){var e,i,n=this._node,s=this._displayedColor,r=n._realColor;if(this._cascadeColorEnabledDirty&&!n._cascadeColorEnabled){for(s.r=r.r,s.g=r.g,s.b=r.b,s=new cc.Color(255,255,255,255),r=0,t=(e=n._children).length;r<t;r++)(i=e[r])&&i._renderCmd&&i._renderCmd._updateDisplayColor(s);this._cascadeColorEnabledDirty=!1}else{if(void 0===t&&(t=(t=n._parent)&&t._cascadeColorEnabled?t.getDisplayedColor():cc.color.WHITE),s.r=0|r.r*t.r/255,s.g=0|r.g*t.g/255,s.b=0|r.b*t.b/255,n._cascadeColorEnabled)for(r=0,t=(e=n._children).length;r<t;r++)(i=e[r])&&i._renderCmd&&(i._renderCmd._updateDisplayColor(s),i._renderCmd._updateColor());for(r=0,t=(e=n._protectedChildren).length;r<t;r++)(i=e[r])&&i._renderCmd&&(i._renderCmd._updateDisplayColor(s),i._renderCmd._updateColor())}this._dirtyFlag^=this._dirtyFlag&cc.Node._dirtyFlags.colorDirty},_updateDisplayOpacity:function(t){var e,i,n,s=this._node;if(this._cascadeOpacityEnabledDirty&&!s._cascadeOpacityEnabled){for(this._displayedOpacity=s._realOpacity,t=0,e=(i=s._children).length;t<e;t++)(n=i[t])&&n._renderCmd&&n._renderCmd._updateDisplayOpacity(255);this._cascadeOpacityEnabledDirty=!1}else{if(void 0===t&&(t=255,e=s._parent)&&e._cascadeOpacityEnabled&&(t=e.getDisplayedOpacity()),this._displayedOpacity=s._realOpacity*t/255,s._cascadeOpacityEnabled)for(t=0,e=(i=s._children).length;t<e;t++)(n=i[t])&&n._renderCmd&&(n._renderCmd._updateDisplayOpacity(this._displayedOpacity),n._renderCmd._updateColor());for(t=0,e=(i=s._protectedChildren).length;t<e;t++)(n=i[t])&&n._renderCmd&&(n._renderCmd._updateDisplayOpacity(this._displayedOpacity),n._renderCmd._updateColor())}this._dirtyFlag^=this._dirtyFlag&cc.Node._dirtyFlags.opacityDirty},_changeProtectedChild:function(t){var e=(t=t._renderCmd)._dirtyFlag,i=cc.Node._dirtyFlags,n=(this._dirtyFlag&i.colorDirty&&(e|=i.colorDirty),this._dirtyFlag&i.opacityDirty&&(e|=i.opacityDirty),e&i.colorDirty),e=e&i.opacityDirty;n&&t._updateDisplayColor(this._displayedColor),e&&t._updateDisplayOpacity(this._displayedOpacity),(n||e)&&t._updateColor()}},cc.ProtectedNode.CanvasRenderCmd=function(t){this._rootCtor(t),this._cachedParent=null,this._cacheDirty=!1};var t=cc.ProtectedNode.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);cc.inject(cc.ProtectedNode.RenderCmd,t),t.constructor=cc.ProtectedNode.CanvasRenderCmd,t._pNodeCmdCtor=cc.ProtectedNode.CanvasRenderCmd,t.transform=function(t,e){var i=this._node;i._changePosition&&i._changePosition(),this.originTransform(t,e);var n,s=i._protectedChildren;if(e&&s&&0!==s.length)for(i=0,n=s.length;i<n;i++)s[i]._renderCmd.transform(this,e)},t.pNodeTransform=t.transform}(),!function(){var t;cc.Node.WebGLRenderCmd&&(cc.ProtectedNode.WebGLRenderCmd=function(t){this._rootCtor(t)},t=cc.ProtectedNode.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype),cc.inject(cc.ProtectedNode.RenderCmd,t),t.constructor=cc.ProtectedNode.WebGLRenderCmd,t._pNodeCmdCtor=cc.ProtectedNode.WebGLRenderCmd,t.transform=function(t,e){this.originTransform(t,e);var i,n,s=this._node._protectedChildren;if(e&&s&&0!==s.length)for(i=0,n=s.length;i<n;i++)s[i]._renderCmd.transform(this,e)},t.pNodeTransform=t.transform)}();var ccui=ccui||{},ccs=(ccui.Class=ccui.Class||cc.Class,ccui.Class.extend=ccui.Class.extend||cc.Class.extend,ccui.Node=ccui.Node||cc.Node,ccui.Node.extend=ccui.Node.extend||cc.Node.extend,ccui.ProtectedNode=ccui.ProtectedNode||cc.ProtectedNode,ccui.ProtectedNode.extend=ccui.ProtectedNode.extend||cc.ProtectedNode.extend,ccui.cocosGUIVersion="CocosGUI v1.0.0.0",ccui._FocusNavigationController=cc.Class.extend({_keyboardListener:null,_firstFocusedWidget:null,_enableFocusNavigation:!1,_keyboardEventPriority:1,enableFocusNavigation:function(t){this._enableFocusNavigation!==t&&((this._enableFocusNavigation=t)?this._addKeyboardEventListener():this._removeKeyboardEventListener())},_setFirstFocsuedWidget:function(t){this._firstFocusedWidget=t},_onKeyPressed:function(t,e){this._enableFocusNavigation&&this._firstFocusedWidget&&(t===cc.KEY.dpadDown&&(this._firstFocusedWidget=this._firstFocusedWidget.findNextFocusedWidget(ccui.Widget.DOWN,this._firstFocusedWidget)),t===cc.KEY.dpadUp&&(this._firstFocusedWidget=this._firstFocusedWidget.findNextFocusedWidget(ccui.Widget.UP,this._firstFocusedWidget)),t===cc.KEY.dpadLeft&&(this._firstFocusedWidget=this._firstFocusedWidget.findNextFocusedWidget(ccui.Widget.LEFT,this._firstFocusedWidget)),t===cc.KEY.dpadRight)&&(this._firstFocusedWidget=this._firstFocusedWidget.findNextFocusedWidget(ccui.Widget.RIGHT,this._firstFocusedWidget))},_addKeyboardEventListener:function(){this._keyboardListener||(this._keyboardListener=cc.EventListener.create({event:cc.EventListener.KEYBOARD,onKeyReleased:this._onKeyPressed.bind(this)}),cc.eventManager.addListener(this._keyboardListener,this._keyboardEventPriority))},_removeKeyboardEventListener:function(){this._keyboardListener&&(cc.eventManager.removeEventListener(this._keyboardListener),this._keyboardListener=null)}}),ccui.__LAYOUT_COMPONENT_NAME="__ui_layout",ccui.Widget=ccui.ProtectedNode.extend({_enabled:!0,_bright:!0,_touchEnabled:!1,_brightStyle:null,_touchBeganPosition:null,_touchMovePosition:null,_touchEndPosition:null,_touchEventListener:null,_touchEventSelector:null,_name:"default",_widgetType:null,_actionTag:0,_customSize:null,_layoutParameterDictionary:null,_layoutParameterType:0,_focused:!1,_focusEnabled:!0,_ignoreSize:!1,_affectByClipping:!1,_sizeType:null,_sizePercent:null,_positionType:null,_positionPercent:null,_hit:!1,_nodes:null,_touchListener:null,_className:"Widget",_flippedX:!1,_flippedY:!1,_opacity:255,_highlight:!1,_touchEventCallback:null,_clickEventListener:null,_propagateTouchEvents:!0,_unifySize:!1,_callbackName:null,_callbackType:null,_usingLayoutComponent:!1,_inViewRect:!0,ctor:function(){cc.ProtectedNode.prototype.ctor.call(this),this._brightStyle=ccui.Widget.BRIGHT_STYLE_NONE,this._touchBeganPosition=cc.p(0,0),this._touchMovePosition=cc.p(0,0),this._touchEndPosition=cc.p(0,0),this._widgetType=ccui.Widget.TYPE_WIDGET,this._customSize=cc.size(0,0),this._layoutParameterDictionary={},this._sizeType=ccui.Widget.SIZE_ABSOLUTE,this._sizePercent=cc.p(0,0),this._positionType=ccui.Widget.POSITION_ABSOLUTE,this._positionPercent=cc.p(0,0),this._nodes=[],this._layoutParameterType=ccui.LayoutParameter.NONE,ccui.Widget.prototype.init.call(this)},init:function(){return this._layoutParameterDictionary={},this._initRenderer(),this.setBright(!0),this.onFocusChanged=this.onFocusChange,this.onNextFocusedWidget=null,this.setAnchorPoint(cc.p(.5,.5)),this.ignoreContentAdaptWithSize(!0),!0},onEnter:function(){var t=this._touchListener;t&&!t._isRegistered()&&this._touchEnabled&&cc.eventManager.addListener(t,this),this._usingLayoutComponent||this.updateSizeAndPosition(),this._sizeDirty&&this._onSizeChanged(),cc.ProtectedNode.prototype.onEnter.call(this)},onExit:function(){this.unscheduleUpdate(),cc.ProtectedNode.prototype.onExit.call(this)},_getOrCreateLayoutComponent:function(){var t=this.getComponent(ccui.__LAYOUT_COMPONENT_NAME);return null==t&&(t=new ccui.LayoutComponent,this.addComponent(t)),t},getWidgetParent:function(){var t=this.getParent();return t instanceof ccui.Widget?t:null},_updateContentSizeWithTextureSize:function(t){this._unifySize?this.setContentSize(t):this.setContentSize(this._ignoreSize?t:this._customSize)},_isAncestorsEnabled:function(){var t=this._getAncensterWidget(this);return null==t||!(t&&!t.isEnabled())&&t._isAncestorsEnabled()},setPropagateTouchEvents:function(t){this._propagateTouchEvents=t},isPropagateTouchEvents:function(){return this._propagateTouchEvents},setSwallowTouches:function(t){this._touchListener&&this._touchListener.setSwallowTouches(t)},isSwallowTouches:function(){return!!this._touchListener&&this._touchListener.isSwallowTouches()},_getAncensterWidget:function(t){return null==t||null==(t=t.getParent())?null:t instanceof ccui.Widget?t:this._getAncensterWidget(t.getParent())},_isAncestorsVisible:function(t){return null==t||!((t=t.getParent())&&!t.isVisible())&&this._isAncestorsVisible(t)},setEnabled:function(t){this._enabled=t,this.setBright(t)},_initRenderer:function(){},setContentSize:function(t,e){cc.Node.prototype.setContentSize.call(this,t,e);var i,t=this._contentSize.width,e=this._contentSize.height;this._customSize.width=t,this._customSize.height=e,!this._unifySize&&this._ignoreSize&&(this._contentSize=this.getVirtualRendererSize()),!this._usingLayoutComponent&&this._running&&(i=((i=this.getWidgetParent())||this._parent).getContentSize(),this._sizePercent.x=0<i.width?t/i.width:0,this._sizePercent.y=0<i.height?e/i.height:0),this._running?this._onSizeChanged():this._sizeDirty=!0},_setWidth:function(t){t!==this._contentSize.width&&(cc.Node.prototype._setWidth.call(this,t),this._customSize.width=t,!this._unifySize&&this._ignoreSize&&(this._contentSize=this.getVirtualRendererSize()),!this._usingLayoutComponent&&this._running&&(t=((t=this.getWidgetParent())||this._parent).width,this._sizePercent.x=0<t?this._customSize.width/t:0),this._running?this._onSizeChanged():this._sizeDirty=!0)},_setHeight:function(t){t!==this._contentSize.height&&(cc.Node.prototype._setHeight.call(this,t),this._customSize.height=t,!this._unifySize&&this._ignoreSize&&(this._contentSize=this.getVirtualRendererSize()),!this._usingLayoutComponent&&this._running&&(t=((t=this.getWidgetParent())||this._parent).height,this._sizePercent.y=0<t?this._customSize.height/t:0),this._running?this._onSizeChanged():this._sizeDirty=!0)},setSizePercent:function(t){var e,i;this._usingLayoutComponent?((e=this._getOrCreateLayoutComponent()).setUsingPercentContentSize(!0),e.setPercentContentSize(t),e.refreshLayout()):(this._sizePercent.x=t.x,this._sizePercent.y=t.y,e=this._customSize.width,i=this._customSize.height,this._running&&(i=(i=this.getWidgetParent())?(e=i.width*t.x,i.height*t.y):(e=this._parent.width*t.x,this._parent.height*t.y)),this._ignoreSize?this.setContentSize(this.getVirtualRendererSize()):this.setContentSize(e,i),this._customSize.width=e,this._customSize.height=i)},_setWidthPercent:function(t){this._sizePercent.x=t;var e=this._customSize.width;this._running&&(e=((e=this.getWidgetParent())||this._parent).width*t),this._ignoreSize?this._setWidth(this.getVirtualRendererSize().width):this._setWidth(e),this._customSize.width=e},_setHeightPercent:function(t){this._sizePercent.y=t;var e=this._customSize.height;this._running&&(e=((e=this.getWidgetParent())||this._parent).height*t),this._ignoreSize?this._setHeight(this.getVirtualRendererSize().height):this._setHeight(e),this._customSize.height=e},updateSizeAndPosition:function(t){switch(t=t||((t=this.getWidgetParent())?t.getLayoutSize():this._parent.getContentSize()),this._sizeType){case ccui.Widget.SIZE_ABSOLUTE:this._ignoreSize?this.setContentSize(this.getVirtualRendererSize()):this.setContentSize(this._customSize),this._sizePercent.x=0<t.width?this._customSize.width/t.width:0,this._sizePercent.y=0<t.height?this._customSize.height/t.height:0;break;case ccui.Widget.SIZE_PERCENT:var e=cc.size(t.width*this._sizePercent.x,t.height*this._sizePercent.y);this._ignoreSize?this.setContentSize(this.getVirtualRendererSize()):this.setContentSize(e),this._customSize.width=e.width,this._customSize.height=e.height}switch(this._onSizeChanged(),e=this.getPosition(),this._positionType){case ccui.Widget.POSITION_ABSOLUTE:t.width<=0||t.height<=0?this._positionPercent.x=this._positionPercent.y=0:(this._positionPercent.x=e.x/t.width,this._positionPercent.y=e.y/t.height);break;case ccui.Widget.POSITION_PERCENT:e=cc.p(t.width*this._positionPercent.x,t.height*this._positionPercent.y)}this._parent instanceof ccui.ImageView&&(t=this._parent._imageRenderer)&&!t._textureLoaded||this.setPosition(e)},setSizeType:function(t){this._sizeType=t,this._usingLayoutComponent&&this._getOrCreateLayoutComponent().setUsingPercentContentSize(this._sizeType===ccui.SIZE_PERCENT)},getSizeType:function(){return this._sizeType},ignoreContentAdaptWithSize:function(t){this._unifySize?this.setContentSize(this._customSize):this._ignoreSize!==t&&(this._ignoreSize=t,this.setContentSize(t?this.getVirtualRendererSize():this._customSize))},isIgnoreContentAdaptWithSize:function(){return this._ignoreSize},getCustomSize:function(){return cc.size(this._customSize)},getLayoutSize:function(){return cc.size(this._contentSize)},getSizePercent:function(){return this._usingLayoutComponent&&(this._sizePercent=this._getOrCreateLayoutComponent().getPercentContentSize()),this._sizePercent},_getWidthPercent:function(){return this._sizePercent.x},_getHeightPercent:function(){return this._sizePercent.y},getWorldPosition:function(){return this.convertToWorldSpace(cc.p(this._anchorPoint.x*this._contentSize.width,this._anchorPoint.y*this._contentSize.height))},getVirtualRenderer:function(){return this},getVirtualRendererSize:function(){return cc.size(this._contentSize)},_onSizeChanged:function(){if(!this._usingLayoutComponent){for(var t=this.getChildren(),e=0,i=t.length;e<i;e++){var n=t[e];n instanceof ccui.Widget&&n.updateSizeAndPosition()}this._sizeDirty=!1}},setTouchEnabled:function(t){this._touchEnabled!==t&&((this._touchEnabled=t)?(this._touchListener||(this._touchListener=cc.EventListener.create({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:this.onTouchBegan.bind(this),onTouchMoved:this.onTouchMoved.bind(this),onTouchEnded:this.onTouchEnded.bind(this)})),cc.eventManager.addListener(this._touchListener,this)):cc.eventManager.removeListener(this._touchListener))},isTouchEnabled:function(){return this._touchEnabled},isHighlighted:function(){return this._highlight},setHighlighted:function(t){t!==this._highlight&&(this._highlight=t,this._bright?this._highlight?this.setBrightStyle(ccui.Widget.BRIGHT_STYLE_HIGH_LIGHT):this.setBrightStyle(ccui.Widget.BRIGHT_STYLE_NORMAL):this._onPressStateChangedToDisabled())},isFocused:function(){return this._focused},setFocused:function(t){(this._focused=t)&&(ccui.Widget._focusedWidget=this,ccui.Widget._focusNavigationController)&&ccui.Widget._focusNavigationController._setFirstFocsuedWidget(this)},isFocusEnabled:function(){return this._focusEnabled},setFocusEnabled:function(t){this._focusEnabled=t},findNextFocusedWidget:function(t,e){var i,n;return null===this.onNextFocusedWidget||null==this.onNextFocusedWidget(t)?(i=e instanceof ccui.Layout,this.isFocused()||i?null!==(n=this.getParent())&&n instanceof ccui.Layout?n.findNextFocusedWidget(t,e):i?e.findNextFocusedWidget(t,e):e:e):(i=this.onNextFocusedWidget(t),this.dispatchFocusEvent(this,i),i)},requestFocus:function(){this!==ccui.Widget._focusedWidget&&this.dispatchFocusEvent(ccui.Widget._focusedWidget,this)},getCurrentFocusedWidget:function(){return ccui.Widget._focusedWidget},onFocusChanged:null,onNextFocusedWidget:null,interceptTouchEvent:function(t,e,i){var n=this.getWidgetParent();n&&n.interceptTouchEvent(t,e,i)},onFocusChange:function(t,e){t&&t.setFocused(!1),e&&e.setFocused(!0)},dispatchFocusEvent:function(t,e){e!==(t=t&&!t.isFocused()?ccui.Widget._focusedWidget:t)&&(e&&e.onFocusChanged&&e.onFocusChanged(t,e),t&&e.onFocusChanged&&t.onFocusChanged(t,e),cc.eventManager.dispatchEvent(new cc.EventFocus(t,e)))},setBright:function(t){(this._bright=t)?(this._brightStyle=ccui.Widget.BRIGHT_STYLE_NONE,this.setBrightStyle(ccui.Widget.BRIGHT_STYLE_NORMAL)):this._onPressStateChangedToDisabled()},setBrightStyle:function(t){if(this._brightStyle!==t)switch(this._brightStyle=t=t||ccui.Widget.BRIGHT_STYLE_NORMAL,this._brightStyle){case ccui.Widget.BRIGHT_STYLE_NORMAL:this._onPressStateChangedToNormal();break;case ccui.Widget.BRIGHT_STYLE_HIGH_LIGHT:this._onPressStateChangedToPressed()}},_onPressStateChangedToNormal:function(){},_onPressStateChangedToPressed:function(){},_onPressStateChangedToDisabled:function(){},_updateChildrenDisplayedRGBA:function(){this.setColor(this.getColor()),this.setOpacity(this.getOpacity())},didNotSelectSelf:function(){},onTouchBegan:function(t,e){var i;return this._hit=!1,this.isVisible()&&this.isEnabled()&&this._isAncestorsEnabled()&&this._isAncestorsVisible(this)&&(i=t.getLocation(),this._touchBeganPosition.x=i.x,this._touchBeganPosition.y=i.y,this.hitTest(this._touchBeganPosition))&&this.isClippingParentContainsPoint(this._touchBeganPosition)&&(this._hit=!0),!!this._hit&&(this.setHighlighted(!0),this._propagateTouchEvents&&this.propagateTouchEvent(ccui.Widget.TOUCH_BEGAN,this,t),this._pushDownEvent(),!0)},propagateTouchEvent:function(t,e,i){var n=this.getWidgetParent();n&&n.interceptTouchEvent(t,e,i)},onTouchMoved:function(t,e){var i=t.getLocation();this._touchMovePosition.x=i.x,this._touchMovePosition.y=i.y,this.setHighlighted(this.hitTest(i)),this._propagateTouchEvents&&this.propagateTouchEvent(ccui.Widget.TOUCH_MOVED,this,t),this._moveEvent()},onTouchEnded:function(t,e){var i=t.getLocation();this._touchEndPosition.x=i.x,this._touchEndPosition.y=i.y,this._propagateTouchEvents&&this.propagateTouchEvent(ccui.Widget.TOUCH_ENDED,this,t),i=this._highlight,this.setHighlighted(!1),i?this._releaseUpEvent():this._cancelUpEvent()},onTouchCancelled:function(t){this.setHighlighted(!1),this._cancelUpEvent()},onTouchLongClicked:function(t){this.longClickEvent()},_pushDownEvent:function(){this._touchEventCallback&&this._touchEventCallback(this,ccui.Widget.TOUCH_BEGAN),this._touchEventListener&&this._touchEventSelector&&this._touchEventSelector.call(this._touchEventListener,this,ccui.Widget.TOUCH_BEGAN)},_moveEvent:function(){this._touchEventCallback&&this._touchEventCallback(this,ccui.Widget.TOUCH_MOVED),this._touchEventListener&&this._touchEventSelector&&this._touchEventSelector.call(this._touchEventListener,this,ccui.Widget.TOUCH_MOVED)},_releaseUpEvent:function(){this._touchEventCallback&&this._touchEventCallback(this,ccui.Widget.TOUCH_ENDED),this._touchEventListener&&this._touchEventSelector&&this._touchEventSelector.call(this._touchEventListener,this,ccui.Widget.TOUCH_ENDED),this._clickEventListener&&this._clickEventListener(this)},_cancelUpEvent:function(){this._touchEventCallback&&this._touchEventCallback(this,ccui.Widget.TOUCH_CANCELED),this._touchEventListener&&this._touchEventSelector&&this._touchEventSelector.call(this._touchEventListener,this,ccui.Widget.TOUCH_CANCELED)},longClickEvent:function(){},addTouchEventListener:function(t,e){void 0===e?this._touchEventCallback=t:(this._touchEventSelector=t,this._touchEventListener=e)},addClickEventListener:function(t){this._clickEventListener=t},hitTest:function(t){var e=cc.rect(0,0,this._contentSize.width,this._contentSize.height);return cc.rectContainsPoint(e,this.convertToNodeSpace(t))},isClippingParentContainsPoint:function(t){this._affectByClipping=!1;for(var e=this.getParent(),i=null;e;){if(e instanceof ccui.Layout&&e.isClippingEnabled()){this._affectByClipping=!0,i=e;break}e=e.getParent()}return!this._affectByClipping||!i||!!i.hitTest(t)&&i.isClippingParentContainsPoint(t)},checkChildInfo:function(t,e,i){var n=this.getWidgetParent();n&&n.checkChildInfo(t,e,i)},setPosition:function(t,e){var i;!this._usingLayoutComponent&&this._running&&(i=this.getWidgetParent())&&((i=i.getContentSize()).width<=0||i.height<=0?(this._positionPercent.x=0,this._positionPercent.y=0):void 0===e?(this._positionPercent.x=t.x/i.width,this._positionPercent.y=t.y/i.height):(this._positionPercent.x=t/i.width,this._positionPercent.y=e/i.height)),cc.Node.prototype.setPosition.call(this,t,e)},setPositionX:function(t){var e;this._running&&(e=this.getWidgetParent())&&(e=e.width,this._positionPercent.x=e<=0?0:t/e),cc.Node.prototype.setPositionX.call(this,t)},setPositionY:function(t){var e;this._running&&(e=this.getWidgetParent())&&(e=e.height,this._positionPercent.y=e<=0?0:t/e),cc.Node.prototype.setPositionY.call(this,t)},setPositionPercent:function(t){var e;this._usingLayoutComponent?((e=this._getOrCreateLayoutComponent()).setPositionPercentX(t.x),e.setPositionPercentY(t.y),e.refreshLayout()):(this._setXPercent(t.x),this._setYPercent(t.y),this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty))},_setXPercent:function(t){var e;this._usingLayoutComponent?((e=this._getOrCreateLayoutComponent()).setPositionPercentX(t.x),e.refreshLayout()):(this._positionPercent.x=t,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty))},_setYPercent:function(t){var e;this._usingLayoutComponent?((e=this._getOrCreateLayoutComponent()).setPositionPercentY(t.x),e.refreshLayout()):(this._positionPercent.y=t,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty))},getPositionPercent:function(){var t;return this._usingLayoutComponent&&(t=this._getOrCreateLayoutComponent(),this._positionPercent.x=t.getPositionPercentX(),this._positionPercent.y=t.getPositionPercentY()),cc.p(this._positionPercent)},_getXPercent:function(){var t;return this._usingLayoutComponent&&(t=this._getOrCreateLayoutComponent(),this._positionPercent.x=t.getPositionPercentX(),this._positionPercent.y=t.getPositionPercentY()),this._positionPercent.x},_getYPercent:function(){var t;return this._usingLayoutComponent&&(t=this._getOrCreateLayoutComponent(),this._positionPercent.x=t.getPositionPercentX(),this._positionPercent.y=t.getPositionPercentY()),this._positionPercent.y},setPositionType:function(t){var e;this._positionType=t,this._usingLayoutComponent&&(e=this._getOrCreateLayoutComponent(),t===ccui.POSITION_ABSOLUTE?(e.setPositionPercentXEnabled(!1),e.setPositionPercentYEnabled(!1)):(e.setPositionPercentXEnabled(!0),e.setPositionPercentYEnabled(!0))),this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getPositionType:function(){return this._positionType},setFlippedX:function(t){var e=this.getScaleX();this._flippedX=t,this.setScaleX(e)},isFlippedX:function(){return this._flippedX},setFlippedY:function(t){var e=this.getScaleY();this._flippedY=t,this.setScaleY(e)},isFlippedY:function(){return this._flippedY},_adaptRenderers:function(){},isBright:function(){return this._bright},isEnabled:function(){return this._enabled},getLeftBoundary:function(){return this.getPositionX()-this._getAnchorX()*this._contentSize.width},getBottomBoundary:function(){return this.getPositionY()-this._getAnchorY()*this._contentSize.height},getRightBoundary:function(){return this.getLeftBoundary()+this._contentSize.width},getTopBoundary:function(){return this.getBottomBoundary()+this._contentSize.height},getTouchBeganPosition:function(){return cc.p(this._touchBeganPosition)},getTouchMovePosition:function(){return cc.p(this._touchMovePosition)},getTouchEndPosition:function(){return cc.p(this._touchEndPosition)},getWidgetType:function(){return this._widgetType},setLayoutParameter:function(t){t&&(this._layoutParameterDictionary[t.getLayoutType()]=t,this._layoutParameterType=t.getLayoutType())},getLayoutParameter:function(t){return t=t||this._layoutParameterType,this._layoutParameterDictionary[t]},getDescription:function(){return"Widget"},clone:function(){var t=this._createCloneInstance();return t._copyProperties(this),t._copyClonedWidgetChildren(this),t},_createCloneInstance:function(){return new ccui.Widget},_copyClonedWidgetChildren:function(t){t=t.getChildren();for(var e=0;e<t.length;e++){var i=t[e];i instanceof ccui.Widget&&this.addChild(i.clone())}},_copySpecialProperties:function(t){},_copyProperties:function(t){for(var e in this.setEnabled(t.isEnabled()),this.setVisible(t.isVisible()),this.setBright(t.isBright()),this.setTouchEnabled(t.isTouchEnabled()),this.setLocalZOrder(t.getLocalZOrder()),this.setTag(t.getTag()),this.setName(t.getName()),this.setActionTag(t.getActionTag()),this._ignoreSize=t._ignoreSize,this.setContentSize(t._contentSize),this._customSize.width=t._customSize.width,this._customSize.height=t._customSize.height,this._copySpecialProperties(t),this._sizeType=t.getSizeType(),this._sizePercent.x=t._sizePercent.x,this._sizePercent.y=t._sizePercent.y,this._positionType=t._positionType,this._positionPercent.x=t._positionPercent.x,this._positionPercent.y=t._positionPercent.y,this.setPosition(t.getPosition()),this.setAnchorPoint(t.getAnchorPoint()),this.setScaleX(t.getScaleX()),this.setScaleY(t.getScaleY()),this.setRotation(t.getRotation()),this.setRotationX(t.getRotationX()),this.setRotationY(t.getRotationY()),this.setFlippedX(t.isFlippedX()),this.setFlippedY(t.isFlippedY()),this.setColor(t.getColor()),this.setOpacity(t.getOpacity()),this._touchEventCallback=t._touchEventCallback,this._touchEventListener=t._touchEventListener,this._touchEventSelector=t._touchEventSelector,this._clickEventListener=t._clickEventListener,this._focused=t._focused,this._focusEnabled=t._focusEnabled,this._propagateTouchEvents=t._propagateTouchEvents,t._layoutParameterDictionary){e=t._layoutParameterDictionary[e];e&&this.setLayoutParameter(e.clone())}},setActionTag:function(t){this._actionTag=t},getActionTag:function(){return this._actionTag},getLeftInParent:function(){return cc.log("getLeftInParent is deprecated. Please use getLeftBoundary instead."),this.getLeftBoundary()},getBottomInParent:function(){return cc.log("getBottomInParent is deprecated. Please use getBottomBoundary instead."),this.getBottomBoundary()},getRightInParent:function(){return cc.log("getRightInParent is deprecated. Please use getRightBoundary instead."),this.getRightBoundary()},getTopInParent:function(){return cc.log("getTopInParent is deprecated. Please use getTopBoundary instead."),this.getTopBoundary()},getTouchEndPos:function(){return cc.log("getTouchEndPos is deprecated. Please use getTouchEndPosition instead."),this.getTouchEndPosition()},getTouchMovePos:function(){return cc.log("getTouchMovePos is deprecated. Please use getTouchMovePosition instead."),this.getTouchMovePosition()},clippingParentAreaContainPoint:function(t){cc.log("clippingParentAreaContainPoint is deprecated. Please use isClippingParentContainsPoint instead."),this.isClippingParentContainsPoint(t)},getTouchStartPos:function(){return cc.log("getTouchStartPos is deprecated. Please use getTouchBeganPosition instead."),this.getTouchBeganPosition()},setSize:function(t){this.setContentSize(t)},getSize:function(){return this.getContentSize()},addNode:function(t,e,i){t instanceof ccui.Widget?cc.log("Please use addChild to add a Widget."):(cc.Node.prototype.addChild.call(this,t,e,i),this._nodes.push(t))},getNodeByTag:function(t){for(var e=this._nodes,i=0;i<e.length;i++){var n=e[i];if(n&&n.getTag()===t)return n}return null},getNodes:function(){return this._nodes},removeNode:function(t,e){cc.Node.prototype.removeChild.call(this,t,e),cc.arrayRemoveObject(this._nodes,t)},_getNormalGLProgram:function(){return cc.shaderCache.programForKey(cc.SHADER_SPRITE_POSITION_TEXTURECOLOR)},_getGrayGLProgram:function(){return cc.shaderCache.programForKey(cc.SHADER_SPRITE_POSITION_TEXTURECOLOR_GRAY)},removeNodeByTag:function(t,e){var i=this.getChildByTag(t);i?this.removeChild(i,e):cc.log("cocos2d: removeNodeByTag(tag = %d): child not found!",t)},removeAllNodes:function(){for(var t=0;t<this._nodes.length;t++)cc.Node.prototype.removeChild.call(this,this._nodes[t]);this._nodes.length=0},_findLayout:function(){cc.renderer.childrenOrderDirty=!0;for(var t=this._parent;t;){if(t._doLayout){t._doLayoutDirty=!0;break}t=t._parent}},isUnifySizeEnabled:function(){return this._unifySize},setUnifySizeEnabled:function(t){this._unifySize=t},_ccEventCallback:null,addCCSEventListener:function(t){this._ccEventCallback=t},setScaleX:function(t){this._flippedX&&(t*=-1),cc.Node.prototype.setScaleX.call(this,t)},setScaleY:function(t){this._flippedY&&(t*=-1),cc.Node.prototype.setScaleY.call(this,t)},setScale:function(t,e){void 0===e&&(e=t),this.setScaleX(t),this.setScaleY(e)},getScaleX:function(){var t=cc.Node.prototype.getScaleX.call(this);return this._flippedX&&(t*=-1),t},getScaleY:function(){var t=cc.Node.prototype.getScaleY.call(this);return this._flippedY&&(t*=-1),t},getScale:function(){return this.getScaleX()!==this.getScaleY()&&cc.log("Widget#scale. ScaleX != ScaleY. Don't know which one to return"),this.getScaleX()},setCallbackName:function(t){this._callbackName=t},getCallbackName:function(){return this._callbackName},setCallbackType:function(t){this._callbackType=t},getCallbackType:function(){return this._callbackType},setLayoutComponentEnabled:function(t){this._usingLayoutComponent=t},isLayoutComponentEnabled:function(){return this._usingLayoutComponent},_createRenderCmd:function(){return new(cc._renderType===cc.game.RENDER_TYPE_WEBGL?ccui.Widget.WebGLRenderCmd:ccui.Widget.CanvasRenderCmd)(this)}}),_p=ccui.Widget.prototype,cc.defineGetterSetter(_p,"xPercent",_p._getXPercent,_p._setXPercent),cc.defineGetterSetter(_p,"yPercent",_p._getYPercent,_p._setYPercent),cc.defineGetterSetter(_p,"widthPercent",_p._getWidthPercent,_p._setWidthPercent),cc.defineGetterSetter(_p,"heightPercent",_p._getHeightPercent,_p._setHeightPercent),cc.defineGetterSetter(_p,"widgetParent",_p.getWidgetParent),cc.defineGetterSetter(_p,"enabled",_p.isEnabled,_p.setEnabled),cc.defineGetterSetter(_p,"focused",_p.isFocused,_p.setFocused),cc.defineGetterSetter(_p,"sizeType",_p.getSizeType,_p.setSizeType),cc.defineGetterSetter(_p,"widgetType",_p.getWidgetType),cc.defineGetterSetter(_p,"touchEnabled",_p.isTouchEnabled,_p.setTouchEnabled),cc.defineGetterSetter(_p,"updateEnabled",_p.isUpdateEnabled,_p.setUpdateEnabled),cc.defineGetterSetter(_p,"bright",_p.isBright,_p.setBright),cc.defineGetterSetter(_p,"name",_p.getName,_p.setName),cc.defineGetterSetter(_p,"actionTag",_p.getActionTag,_p.setActionTag),cc.defineGetterSetter(_p,"opacity",_p.getOpacity,_p.setOpacity),_p=null,ccui.Widget.create=function(){return new ccui.Widget},ccui.Widget._focusedWidget=null,ccui.Widget._focusNavigationController=null,ccui.Widget.enableDpadNavigation=function(t){t?(null==ccui.Widget._focusNavigationController&&(ccui.Widget._focusNavigationController=new ccui._FocusNavigationController,ccui.Widget._focusedWidget)&&ccui.Widget._focusNavigationController._setFirstFocsuedWidget(ccui.Widget._focusedWidget),ccui.Widget._focusNavigationController.enableFocusNavigation(!0)):ccui.Widget._focusNavigationController&&(ccui.Widget._focusNavigationController.enableFocusNavigation(!1),ccui.Widget._focusNavigationController=null)},ccui.Widget.getCurrentFocusedWidget=function(){return ccui.Widget._focusedWidget},ccui.Widget.BRIGHT_STYLE_NONE=-1,ccui.Widget.BRIGHT_STYLE_NORMAL=0,ccui.Widget.BRIGHT_STYLE_HIGH_LIGHT=1,ccui.Widget.TYPE_WIDGET=0,ccui.Widget.TYPE_CONTAINER=1,ccui.Widget.LEFT=0,ccui.Widget.RIGHT=1,ccui.Widget.UP=2,ccui.Widget.DOWN=3,ccui.Widget.LOCAL_TEXTURE=0,ccui.Widget.PLIST_TEXTURE=1,ccui.Widget.TOUCH_BEGAN=0,ccui.Widget.TOUCH_MOVED=1,ccui.Widget.TOUCH_ENDED=2,ccui.Widget.TOUCH_CANCELED=3,ccui.Widget.SIZE_ABSOLUTE=0,ccui.Widget.SIZE_PERCENT=1,ccui.Widget.POSITION_ABSOLUTE=0,ccui.Widget.POSITION_PERCENT=1,cc.game.addEventListener(cc.game.EVENT_RENDERER_INITED,function(){var t;cc._renderType===cc.game.RENDER_TYPE_CANVAS?(ccui.Widget.CanvasRenderCmd=function(t){this._pNodeCmdCtor(t),this._needDraw=!1},(t=ccui.Widget.CanvasRenderCmd.prototype=Object.create(cc.ProtectedNode.CanvasRenderCmd.prototype)).constructor=ccui.Widget.CanvasRenderCmd,t.visit=function(t){var e=this._node,i=cc.renderer;(t=t||this.getParentRenderCmd())&&(this._curLevel=t._curLevel+1),isNaN(e._customZ)&&(e._vertexZ=i.assignedZ,i.assignedZ+=i.assignedZStep),e._adaptRenderers(),this._syncStatus(t)},t.transform=function(t,e){this._transform||(this._transform={a:1,b:0,c:0,d:1,tx:0,ty:0},this._worldTransform={a:1,b:0,c:0,d:1,tx:0,ty:0});var i,n=this._node;n._visible&&n._running&&(n._adaptRenderers(),this._usingLayoutComponent||(i=n.getWidgetParent())&&0!==(i=i.getContentSize()).width&&0!==i.height&&(n._position.x=i.width*n._positionPercent.x,n._position.y=i.height*n._positionPercent.y),this.pNodeTransform(t,e))}):(ccui.Widget.WebGLRenderCmd=function(t){this._pNodeCmdCtor(t),this._needDraw=!1},(t=ccui.Widget.WebGLRenderCmd.prototype=Object.create(cc.ProtectedNode.WebGLRenderCmd.prototype)).constructor=ccui.Widget.WebGLRenderCmd,t.visit=function(t){var e=this._node,i=cc.renderer;(t=t||this.getParentRenderCmd())&&(this._curLevel=t._curLevel+1),isNaN(e._customZ)&&(e._vertexZ=i.assignedZ,i.assignedZ+=i.assignedZStep),e._adaptRenderers(),this._syncStatus(t)},t.transform=function(t,e){this._transform||(this._transform={a:1,b:0,c:0,d:1,tx:0,ty:0},this._worldTransform={a:1,b:0,c:0,d:1,tx:0,ty:0});var i,n=this._node;n._visible&&n._running&&(n._adaptRenderers(),this._usingLayoutComponent||(i=n.getWidgetParent())&&0!==(i=i.getContentSize()).width&&0!==i.height&&(n._position.x=i.width*n._positionPercent.x,n._position.y=i.height*n._positionPercent.y),this.pNodeTransform(t,e))}),t.widgetTransform=t.transform}),!function(){var f,g={_pool:{},_lengths:[],put:function(t){var e=t.length;this._pool[e]?this._pool[e].push(t):(this._pool[e]=[t],this._lengths.push(e),this._lengths.sort())},get:function(t){for(var e,i=0;i<this._lengths.length;i++)if(this._lengths[i]>=t){e=this._lengths[i];break}if(e)return this._pool[e].pop()}},p=cc.FIX_ARTIFACTS_BY_STRECHING_TEXEL,t={_rebuildQuads_base:function(t,e,i,n){var s,r,o,a,c,h,l,u=t._vertices,d=t._renderCmd._worldTransform;i=n?(h=s=0,a=i.width,i.height):(s=e._originalSize,r=e._rect,o=e._offset,a=i.width/s.width,n=i.height/s.height,c=o.x-(s.width-r.width)/2,h=o.y+(s.height-r.height)/2,l=o.y-(s.height-r.height)/2,s=(o.x+(s.width-r.width)/2)*a,h*=n,a=i.width+c*a,i.height+l*n),u.length<8&&(g.put(u),u=g.get(8)||new Float32Array(8),t._vertices=u),f?(u[0]=s*d.a+h*d.c+d.tx,u[1]=s*d.b+h*d.d+d.ty,u[2]=a*d.a+h*d.c+d.tx,u[3]=a*d.b+h*d.d+d.ty,u[4]=s*d.a+i*d.c+d.tx,u[5]=s*d.b+i*d.d+d.ty,u[6]=a*d.a+i*d.c+d.tx,u[7]=a*d.b+i*d.d+d.ty):(u[0]=s,u[1]=h,u[2]=a,u[3]=h,u[4]=s,u[5]=i,u[6]=a,u[7]=i),t._uvsDirty&&this._calculateUVs(t,e),t._vertCount=4},_calculateUVs:function(t,e){var i=t._uvs,n=e._texture._pixelsWide,s=e._texture._pixelsHigh,r=e._rect,r=cc.rectPointsToPixels(r);i.length<8&&(g.put(i),i=g.get(8)||new Float32Array(8),t._uvs=i);var o,a,t=p?.5:0;e._rotated?(o=(r.x+t)/n,a=(r.y+r.width-t)/s,n=(r.x+r.height-t)/n,s=(r.y+t)/s,i[0]=o,i[1]=s,i[2]=o,i[3]=a,i[4]=n,i[5]=s,i[6]=n,i[7]=a):(o=(r.x+t)/n,a=(r.y+r.height-t)/s,n=(r.x+r.width-t)/n,s=(r.y+t)/s,i[0]=o,i[1]=a,i[2]=n,i[3]=a,i[4]=o,i[5]=s,i[6]=n,i[7]=s)}},e={x:Array(4),y:Array(4),_rebuildQuads_base:function(t,e,i,n,s,r,o){var a=t._vertices,c=t._renderCmd._worldTransform,h=i.width-n-s,l=i.height-r-o,u=i.width/(n+s),d=i.height/(r+o),_=this.x,p=this.y;if(_[0]=0,_[1]=n*(1<u?1:u),_[2]=_[1]+(h<0?0:h),_[3]=i.width,p[0]=0,p[1]=o*(1<d?1:d),p[2]=p[1]+(l<0?0:l),p[3]=i.height,a.length<32&&(g.put(a),a=g.get(32)||new Float32Array(32),t._vertices=a),i=0,f)for(h=0;h<4;h++)for(l=0;l<4;l++)a[i]=_[l]*c.a+p[h]*c.c+c.tx,a[i+1]=_[l]*c.b+p[h]*c.d+c.ty,i+=2;else for(h=0;h<4;h++)for(l=0;l<4;l++)a[i]=_[l],a[i+1]=p[h],i+=2;t._uvsDirty&&this._calculateUVs(t,e,n,s,r,o)},_calculateUVs:function(t,e,i,n,s,r){var o,a=t._uvs,c=e._rect,h=e._texture._pixelsWide,l=e._texture._pixelsHigh,u=e._rect,u=cc.rectPointsToPixels(u),c=cc.rectPointsToPixels(c),d=cc.contentScaleFactor(),c=(n=c.width-(i*=d)-n*d,o=c.height-(s*=d)-(r*=d),a.length<32&&(g.put(a),a=g.get(32)||new Float32Array(32),t._uvs=a),t=this.x,this.y),_=p?.5:0,d=0;if(e._rotated)for(t[0]=(u.x+_)/h,t[1]=(r+u.x)/h,t[2]=(r+o+u.x)/h,t[3]=(u.x+u.height-_)/h,c[3]=(u.y+_)/l,c[2]=(i+u.y)/l,c[1]=(i+n+u.y)/l,c[0]=(u.y+u.width-_)/l,e=0;e<4;e++)for(h=0;h<4;h++)a[d]=t[e],a[d+1]=c[3-h],d+=2;else for(t[0]=(u.x+_)/h,t[1]=(i+u.x)/h,t[2]=(i+n+u.x)/h,t[3]=(u.x+u.width-_)/h,c[3]=(u.y+_)/l,c[2]=(s+u.y)/l,c[1]=(s+o+u.y)/l,c[0]=(u.y+u.height-_)/l,e=0;e<4;e++)for(h=0;h<4;h++)a[d]=t[h],a[d+1]=c[e],d+=2}},i=(ccui.Scale9Sprite=cc.Scale9Sprite=cc.Node.extend({_spriteFrame:null,_scale9Image:null,_insetLeft:0,_insetRight:0,_insetTop:0,_insetBottom:0,_blendFunc:null,_renderingType:1,_brightState:0,_opacityModifyRGB:!1,_rawVerts:null,_rawUvs:null,_vertices:null,_uvs:null,_vertCount:0,_quadsDirty:!0,_uvsDirty:!0,_isTriangle:!1,_isTrimmedContentSize:!1,_textureLoaded:!1,_flippedX:!1,_flippedY:!1,_className:"Scale9Sprite",ctor:function(t,e,i){var n;cc.Node.prototype.ctor.call(this),this._loader=new cc.Sprite.LoadManager,this._renderCmd.setState(this._brightState),this._blendFunc=cc.BlendFunc._alphaPremultiplied(),this.setAnchorPoint(cc.p(.5,.5)),this._rawUvs=this._rawVerts=null,this._vertices=g.get(8)||new Float32Array(8),this._uvs=g.get(8)||new Float32Array(8),void 0!==t&&(t instanceof cc.SpriteFrame?this.initWithSpriteFrame(t,e):(n=cc.spriteFrameCache.getSpriteFrame(t))?this.initWithSpriteFrame(n,e):this.initWithFile(t,e,i)),void 0===f&&(f=cc._renderType===cc.game.RENDER_TYPE_WEBGL)},textureLoaded:function(){return this._textureLoaded},getCapInsets:function(){return cc.rect(this._capInsetsInternal)},_asyncSetCapInsets:function(){this.removeEventListener("load",this._asyncSetCapInsets,this),this.setCapInsets(this._cacheCapInsets),this._cacheCapInsets=null},setCapInsets:function(t){if(!this.loaded())return this._cacheCapInsets=t,this.removeEventListener("load",this._asyncSetCapInsets,this),this.addEventListener("load",this._asyncSetCapInsets,this),!1;this._capInsetsInternal=t,this._updateCapInsets(this._spriteFrame._rect,this._capInsetsInternal)},_updateCapInsets:function(t,e){e&&t&&!cc._rectEqualToZero(e)?this._capInsetsInternal=e:(t=t||{x:0,y:0,width:this._contentSize.width,height:this._contentSize.height},this._capInsetsInternal=cc.rect(t.width/3,t.height/3,t.width/3,t.height/3)),cc._rectEqualToZero(t)||(this._insetLeft=this._capInsetsInternal.x,this._insetTop=this._capInsetsInternal.y,this._insetRight=t.width-this._insetLeft-this._capInsetsInternal.width,this._insetBottom=t.height-this._insetTop-this._capInsetsInternal.height)},initWithFile:function(t,e,i){var n,s;if(t instanceof cc.Rect?(i=t=e,e=cc.rect(0,0,0,0)):(e=e||cc.rect(0,0,0,0),i=i||cc.rect(0,0,0,0)),t)return s=(n=(n=cc.textureCache.getTextureForKey(t))||cc.textureCache.addImage(t)).isLoaded(),this._textureLoaded=s,this._loader.clear(),s?(cc._rectEqualToZero(e)&&(s=n.getContentSize(),e=cc.rect(0,0,s.width,s.height)),this.setTexture(n,e),this._updateCapInsets(e,i),!0):(this._loader.once(n,function(){this.initWithFile(t,e,i),this.dispatchEvent("load")},this),!1);throw Error("ccui.Scale9Sprite.initWithFile(): file should be non-null")},updateWithBatchNode:function(t,e,i,n){var s;return!!t&&(s=t.getTexture(),this._loader.clear(),s.isLoaded()?(this.setTexture(s,e),this._updateCapInsets(e,n),!0):(this._loader.once(s,function(){this.updateWithBatchNode(t,e,i,n),this.dispatchEvent("load")},this),!1))},initWithSpriteFrame:function(t,e){this.setSpriteFrame(t),e=e||cc.rect(0,0,0,0),this._updateCapInsets(t._rect,e)},initWithSpriteFrameName:function(t,e){if(!t)throw Error("ccui.Scale9Sprite.initWithSpriteFrameName(): spriteFrameName should be non-null");e=e||cc.rect(0,0,0,0);t=cc.spriteFrameCache.getSpriteFrame(t);if(null==t)return cc.log("ccui.Scale9Sprite.initWithSpriteFrameName(): can't find the sprite frame by spriteFrameName"),!1;this.setSpriteFrame(t),e=e||cc.rect(0,0,0,0),this._updateCapInsets(t._rect,e)},loaded:function(){return null!==this._spriteFrame&&this._spriteFrame.textureLoaded()},setTexture:function(t,e){t=new cc.SpriteFrame(t,e);this.setSpriteFrame(t)},_updateBlendFunc:function(){var t=this._blendFunc;this._spriteFrame&&this._spriteFrame._texture.hasPremultipliedAlpha()?(t.src===cc.SRC_ALPHA&&t.dst===cc.BLEND_DST&&(t.src=cc.ONE),this._opacityModifyRGB=!0):(t.src===cc.ONE&&t.dst===cc.BLEND_DST&&(t.src=cc.SRC_ALPHA),this._opacityModifyRGB=!1)},setOpacityModifyRGB:function(t){this._opacityModifyRGB!==t&&(this._opacityModifyRGB=t,this._renderCmd._setColorDirty())},isOpacityModifyRGB:function(){return this._opacityModifyRGB},setSpriteFrame:function(t){var e,i;t&&(this._spriteFrame=t,this._uvsDirty=this._quadsDirty=!0,i=function(){cc.sizeEqualToSize(e._contentSize,cc.size(0,0))&&e.setContentSize(e._spriteFrame._rect),e._textureLoaded=!0,e._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.contentDirty),cc.renderer.childrenOrderDirty=!0},(e=this)._textureLoaded=t.textureLoaded(),e._textureLoaded?i():(this._loader.clear(),this._loader.once(t,function(){i(),this.dispatchEvent("load")},this)))},setBlendFunc:function(t,e){void 0===e?(this._blendFunc.src=t.src||cc.BLEND_SRC,this._blendFunc.dst=t.dst||cc.BLEND_DST):(this._blendFunc.src=t||cc.BLEND_SRC,this._blendFunc.dst=e||cc.BLEND_DST),this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.contentDirty)},getBlendFunc:function(){return new cc.BlendFunc(this._blendFunc.src,this._blendFunc.dst)},setPreferredSize:function(t){t&&!cc.sizeEqualToSize(this._contentSize,t)&&this.setContentSize(t)},getPreferredSize:function(){return this.getContentSize()},setContentSize:function(t,e){void 0===e&&(e=t.height,t=t.width),t===this._contentSize.width&&e===this._contentSize.height||(cc.Node.prototype.setContentSize.call(this,t,e),this._quadsDirty=!0)},getContentSize:function(){return this._renderingType===ccui.Scale9Sprite.RenderingType.SIMPLE&&this._spriteFrame?this._spriteFrame._originalSize:cc.size(this._contentSize)},_setWidth:function(t){cc.Node.prototype._setWidth.call(this,t),this._quadsDirty=!0},_setHeight:function(t){cc.Node.prototype._setHeight.call(this,t),this._quadsDirty=!0},setState:function(t){this._brightState=t,this._renderCmd.setState(t),this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.contentDirty)},getState:function(){return this._brightState},setRenderingType:function(t){this._renderingType!==t&&(this._renderingType=t,this._uvsDirty=this._quadsDirty=!0,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.contentDirty))},getRenderingType:function(){return this._renderingType},setInsetLeft:function(t){this._insetLeft=t,this._uvsDirty=this._quadsDirty=!0,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.contentDirty)},getInsetLeft:function(){return this._insetLeft},setInsetTop:function(t){this._insetTop=t,this._uvsDirty=this._quadsDirty=!0,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.contentDirty)},getInsetTop:function(){return this._insetTop},setInsetRight:function(t){this._insetRight=t,this._uvsDirty=this._quadsDirty=!0,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.contentDirty)},getInsetRight:function(){return this._insetRight},setInsetBottom:function(t){this._insetBottom=t,this._uvsDirty=this._quadsDirty=!0,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.contentDirty)},getInsetBottom:function(){return this._insetBottom},_rebuildQuads:function(){if(this._spriteFrame&&this._spriteFrame._textureLoaded){switch(this._updateBlendFunc(),this._isTriangle=!1,this._renderingType){case n.SIMPLE:t._rebuildQuads_base(this,this._spriteFrame,this._contentSize,this._isTrimmedContentSize);break;case n.SLICED:e._rebuildQuads_base(this,this._spriteFrame,this._contentSize,this._insetLeft,this._insetRight,this._insetTop,this._insetBottom);break;default:return this._uvsDirty=this._quadsDirty=!1,void cc.error("Can not generate quad")}this._uvsDirty=this._quadsDirty=!1}},_createRenderCmd:function(){return new(cc._renderType===cc.game.RENDER_TYPE_CANVAS?ccui.Scale9Sprite.CanvasRenderCmd:ccui.Scale9Sprite.WebGLRenderCmd)(this)}}),ccui.Scale9Sprite.prototype),n=(cc.EventHelper.prototype.apply(i),cc.defineGetterSetter(i,"preferredSize",i.getPreferredSize,i.setPreferredSize),cc.defineGetterSetter(i,"capInsets",i.getCapInsets,i.setCapInsets),cc.defineGetterSetter(i,"insetLeft",i.getInsetLeft,i.setInsetLeft),cc.defineGetterSetter(i,"insetTop",i.getInsetTop,i.setInsetTop),cc.defineGetterSetter(i,"insetRight",i.getInsetRight,i.setInsetRight),cc.defineGetterSetter(i,"insetBottom",i.getInsetBottom,i.setInsetBottom),ccui.Scale9Sprite.create=function(t,e,i){return new ccui.Scale9Sprite(t,e,i)},ccui.Scale9Sprite.createWithSpriteFrame=function(t,e){return new ccui.Scale9Sprite(t,e)},ccui.Scale9Sprite.createWithSpriteFrameName=function(t,e){return new ccui.Scale9Sprite(t,e)},ccui.Scale9Sprite.POSITIONS_CENTRE=0,ccui.Scale9Sprite.POSITIONS_TOP=1,ccui.Scale9Sprite.POSITIONS_LEFT=2,ccui.Scale9Sprite.POSITIONS_RIGHT=3,ccui.Scale9Sprite.POSITIONS_BOTTOM=4,ccui.Scale9Sprite.POSITIONS_TOPRIGHT=5,ccui.Scale9Sprite.POSITIONS_TOPLEFT=6,ccui.Scale9Sprite.POSITIONS_BOTTOMRIGHT=7,ccui.Scale9Sprite.state={NORMAL:0,GRAY:1},ccui.Scale9Sprite.RenderingType={SIMPLE:0,SLICED:1})}(),!function(){ccui.Scale9Sprite.CanvasRenderCmd=function(t){cc.Node.CanvasRenderCmd.call(this,t),this._needDraw=!0,this._state=ccui.Scale9Sprite.state.NORMAL,this._originalTexture=this._textureToRender=null};var t=ccui.Scale9Sprite.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);t.constructor=ccui.Scale9Sprite.CanvasRenderCmd,t.transform=function(t,e){this.originTransform(t,e),this._node._rebuildQuads()},t.needDraw=function(){return this._needDraw&&this._node.loaded()},t._updateDisplayColor=function(t){cc.Node.RenderCmd.prototype._updateDisplayColor.call(this,t),this._originalTexture=this._textureToRender=null},t.setState=function(t){this._state!==t&&(this._state=t,this._originalTexture=this._textureToRender=null)},t._setColorDirty=function(){this.setDirtyFlag(cc.Node._dirtyFlags.colorDirty|cc.Node._dirtyFlags.opacityDirty)},t.rendering=function(t,e,i){var n=this._node,s=(_=this._displayedOpacity)/255,r=null;if(n._spriteFrame&&(r=n._spriteFrame._texture),n.loaded()&&0!==_&&(null!==this._textureToRender&&this._originalTexture===r||(this._textureToRender=this._originalTexture=r,cc.Scale9Sprite.state.GRAY===this._state&&(this._textureToRender=this._textureToRender._generateGrayTexture()),_=n.getDisplayedColor(),!r)||255===_.r&&255===_.g&&255===_.b||(this._textureToRender=this._textureToRender._generateColorTexture(_.r,_.g,_.b)),t=(r=t||cc._renderContext).getContext(),r.setTransform(this._worldTransform,e,i),r.setCompositeOperation(cc.Node.CanvasRenderCmd._getCompositeOperationByBlendFunc(n._blendFunc)),r.setGlobalAlpha(s),this._textureToRender)){n._quadsDirty&&n._rebuildQuads(),e=this._textureToRender._pixelsWide,i=this._textureToRender._pixelsHigh;var o,a,c,h,l,u,d,s=this._textureToRender._htmlElementObj,_=n._vertices,p=n._uvs,f=0,g=0;if(n._renderingType===cc.Scale9Sprite.RenderingType.SLICED){for(r=0;r<3;++r)for(f=0;f<3;++f)h=_[g=8*r+2*f],l=_[g+1],u=_[g+10]-h,l=-l-(d=_[g+11]-l),n=p[g]*e,o=p[g+11]*i,a=(p[g+10]-p[g])*e,c=(p[g+1]-p[g+11])*i,0<a&&0<c&&0<u&&0<d&&t.drawImage(s,n,o,a,c,h,l,u,d);cc.g_NumberOfDraws+=9}else{for(var m=Math.floor(n._vertCount/4),g=f=0;f<m;f++)h=_[g],l=_[g+1],u=_[g+6]-h,l=-l-(d=_[g+7]-l),n=p[g]*e,o=p[g+7]*i,a=(p[g+6]-p[g])*e,c=(p[g+1]-p[g+7])*i,""!==this._textureToRender._pattern?(r.setFillStyle(t.createPattern(s,this._textureToRender._pattern)),t.fillRect(h,l,u,d)):0<a&&0<c&&0<u&&0<d&&t.drawImage(s,n,o,a,c,h,l,u,d),g+=8;cc.g_NumberOfDraws+=m}}}}(),!function(){var h,t;cc.Node.WebGLRenderCmd&&(ccui.Scale9Sprite.WebGLRenderCmd=function(t){cc.Node.WebGLRenderCmd.call(this,t),this._needDraw=!0,this._color=new Uint32Array(1),this._dirty=!1,this._shaderProgram=cc.shaderCache.programForKey(cc.SHADER_SPRITE_POSITION_TEXTURECOLOR)},h=ccui.Scale9Sprite,(t=ccui.Scale9Sprite.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype)).constructor=ccui.Scale9Sprite.WebGLRenderCmd,t.needDraw=function(){return this._needDraw&&this._node.loaded()},t._uploadSliced=function(t,e,i,n,s,r,o){for(var a,c=0;c<3;++c)for(var h=0;h<3;++h)s[o]=t[a=8*c+2*h],s[o+1]=t[1+a],s[o+2]=n,r[o+3]=i[0],s[o+4]=e[a],s[o+5]=e[1+a],s[o+=6]=t[2+a],s[o+1]=t[3+a],s[o+2]=n,r[o+3]=i[0],s[o+4]=e[2+a],s[o+5]=e[3+a],s[o+=6]=t[8+a],s[o+1]=t[9+a],s[o+2]=n,r[o+3]=i[0],s[o+4]=e[8+a],s[o+5]=e[9+a],s[o+=6]=t[10+a],s[o+1]=t[11+a],s[o+2]=n,r[o+3]=i[0],s[o+4]=e[10+a],s[o+5]=e[11+a],o+=6;return 36},t.transform=function(t,e){this.originTransform(t,e),this._node._rebuildQuads()},t._setColorDirty=function(){},t.uploadData=function(t,e,i){var n=this._node;if(0===this._displayedOpacity)return 0;n._quadsDirty&&n._rebuildQuads();var s,r=this._displayedOpacity,o=this._displayedColor.r,a=this._displayedColor.g,c=this._displayedColor.b;switch(n._opacityModifyRGB&&(o*=s=r/255,a*=s,c*=s),this._color[0]=r<<24|c<<16|a<<8|o,r=n._vertexZ,o=n._vertices,a=n._uvs,s=h.RenderingType,c=0,n._renderingType){case s.SIMPLE:for(c=this._node._vertCount,s=n=0;n<c;n++,s+=2)t[i]=o[s],t[i+1]=o[s+1],t[i+2]=r,e[i+3]=this._color[0],t[i+4]=a[s],t[i+5]=a[s+1],i+=6;break;case s.SLICED:c=this._uploadSliced(o,a,this._color,r,t,e,i)}return c},t.setState=function(t){t===h.state.NORMAL?this._shaderProgram=cc.shaderCache.programForKey(cc.SHADER_SPRITE_POSITION_TEXTURECOLOR):t===h.state.GRAY&&(this._shaderProgram=cc.shaderCache.programForKey(cc.SHADER_SPRITE_POSITION_TEXTURECOLOR_GRAY))})}(),ccui.Layout=ccui.Widget.extend({_clippingEnabled:!1,_backGroundScale9Enabled:null,_backGroundImage:null,_backGroundImageFileName:null,_backGroundImageCapInsets:null,_colorType:null,_bgImageTexType:ccui.Widget.LOCAL_TEXTURE,_colorRender:null,_gradientRender:null,_color:null,_startColor:null,_endColor:null,_alongVector:null,_opacity:255,_backGroundImageTextureSize:null,_layoutType:null,_doLayoutDirty:!0,_clippingRectDirty:!0,_clippingType:null,_clippingStencil:null,_scissorRectDirty:!1,_clippingRect:null,_clippingParent:null,_className:"Layout",_backGroundImageColor:null,_finalPositionX:0,_finalPositionY:0,_backGroundImageOpacity:0,_loopFocus:!1,__passFocusToChild:!0,_isFocusPassing:!1,_isInterceptTouch:!1,ctor:function(){this._layoutType=ccui.Layout.ABSOLUTE,this._widgetType=ccui.Widget.TYPE_CONTAINER,this._clippingType=ccui.Layout.CLIPPING_SCISSOR,this._colorType=ccui.Layout.BG_COLOR_NONE,ccui.Widget.prototype.ctor.call(this),this.ignoreContentAdaptWithSize(!1),this.setContentSize(cc.size(0,0)),this.setAnchorPoint(0,0),this.onPassFocusToChild=this._findNearestChildWidgetIndex.bind(this),this._backGroundImageCapInsets=cc.rect(0,0,0,0),this._color=cc.color(255,255,255,255),this._startColor=cc.color(255,255,255,255),this._endColor=cc.color(255,255,255,255),this._alongVector=cc.p(0,-1),this._backGroundImageTextureSize=cc.size(0,0),this._clippingRect=cc.rect(0,0,0,0),this._backGroundImageColor=cc.color(255,255,255,255)},onEnter:function(){ccui.Widget.prototype.onEnter.call(this),this._clippingStencil&&this._clippingStencil._performRecursive(cc.Node._stateCallbackType.onEnter),this._clippingRectDirty=this._doLayoutDirty=!0},onExit:function(){ccui.Widget.prototype.onExit.call(this),this._clippingStencil&&this._clippingStencil._performRecursive(cc.Node._stateCallbackType.onExit)},visit:function(t){var e=this._renderCmd,i=t?t._renderCmd:null;if(this._visible){this._adaptRenderers(),this._doLayout(),e.visit(i),t=this._clippingEnabled&&this._clippingType===ccui.Layout.CLIPPING_STENCIL;var n,s,r=this._clippingEnabled&&this._clippingType===ccui.Layout.CLIPPING_SCISSOR,o=(t?e.stencilClippingVisit(i):r&&e.scissorClippingVisit(i),this._children),a=o.length,c=this._protectedChildren,h=c.length;for(this._reorderChildDirty&&this.sortAllChildren(),this._reorderProtectedChildDirty&&this.sortAllProtectedChildren(),i=0;i<a&&(n=o[i])._localZOrder<0;i++)n.visit(this);for(n=0;n<h&&(s=c[n])._localZOrder<0;n++)e._changeProtectedChild(s),s.visit(this);for(;i<a;i++)o[i].visit(this);for(;n<h;n++)s=c[n],e._changeProtectedChild(s),s.visit(this);t?e.postStencilVisit():r&&e.postScissorVisit(),e._dirtyFlag=0}else e._propagateFlagsDown(i)},setLoopFocus:function(t){this._loopFocus=t},isLoopFocus:function(){return this._loopFocus},setPassFocusToChild:function(t){this.__passFocusToChild=t},isPassFocusToChild:function(){return this.__passFocusToChild},findNextFocusedWidget:function(t,e){var i,n;if(this._isFocusPassing||this.isFocused())return i=this.getParent(),this._isFocusPassing=!1,this.__passFocusToChild?(n=this._passFocusToChild(t,e))instanceof ccui.Layout&&i?(i._isFocusPassing=!0,i.findNextFocusedWidget(t,this)):n:null!=i&&i instanceof ccui.Layout?(i._isFocusPassing=!0,i.findNextFocusedWidget(t,this)):this;if(!(e.isFocused()||e instanceof ccui.Layout))return e;if(this._layoutType===ccui.Layout.LINEAR_HORIZONTAL)switch(t){case ccui.Widget.LEFT:return this._getPreviousFocusedWidget(t,e);case ccui.Widget.RIGHT:return this._getNextFocusedWidget(t,e);case ccui.Widget.DOWN:case ccui.Widget.UP:return!this._isLastWidgetInContainer(this,t)||this._isWidgetAncestorSupportLoopFocus(e,t)?ccui.Widget.prototype.findNextFocusedWidget.call(this,t,this):e;default:return cc.assert(0,"Invalid Focus Direction"),e}else{if(this._layoutType!==ccui.Layout.LINEAR_VERTICAL)return cc.assert(0,"Un Supported Layout type, please use VBox and HBox instead!!!"),e;switch(t){case ccui.Widget.LEFT:case ccui.Widget.RIGHT:return!this._isLastWidgetInContainer(this,t)||this._isWidgetAncestorSupportLoopFocus(e,t)?ccui.Widget.prototype.findNextFocusedWidget.call(this,t,this):e;case ccui.Widget.DOWN:return this._getNextFocusedWidget(t,e);case ccui.Widget.UP:return this._getPreviousFocusedWidget(t,e);default:return cc.assert(0,"Invalid Focus Direction"),e}}},onPassFocusToChild:null,addChild:function(t,e,i){t instanceof ccui.Widget&&this._supplyTheLayoutParameterLackToChild(t),ccui.Widget.prototype.addChild.call(this,t,e,i),this._doLayoutDirty=!0},removeChild:function(t,e){ccui.Widget.prototype.removeChild.call(this,t,e),this._doLayoutDirty=!0},removeAllChildren:function(t){ccui.Widget.prototype.removeAllChildren.call(this,t),this._doLayoutDirty=!0},removeAllChildrenWithCleanup:function(t){ccui.Widget.prototype.removeAllChildrenWithCleanup.call(this,t),this._doLayoutDirty=!0},isClippingEnabled:function(){return this._clippingEnabled},setClippingEnabled:function(t){if(t!==this._clippingEnabled)switch(this._clippingEnabled=t,this._clippingType){case ccui.Layout.CLIPPING_SCISSOR:case ccui.Layout.CLIPPING_STENCIL:t?(this._clippingStencil=new cc.DrawNode,this._renderCmd.rebindStencilRendering(this._clippingStencil),this._running&&this._clippingStencil._performRecursive(cc.Node._stateCallbackType.onEnter),this._setStencilClippingSize(this._contentSize)):(this._running&&this._clippingStencil&&this._clippingStencil._performRecursive(cc.Node._stateCallbackType.onExit),this._clippingStencil=null)}},setClippingType:function(t){var e;t!==this._clippingType&&(e=this.isClippingEnabled(),this.setClippingEnabled(!1),this._clippingType=t,this.setClippingEnabled(e))},getClippingType:function(){return this._clippingType},_setStencilClippingSize:function(t){var e,i;this._clippingEnabled&&((e=[])[0]=cc.p(0,0),e[1]=cc.p(t.width,0),e[2]=cc.p(t.width,t.height),e[3]=cc.p(0,t.height),i=cc.color.GREEN,this._clippingStencil.clear(),this._clippingStencil.setLocalBB&&this._clippingStencil.setLocalBB(0,0,t.width,t.height),this._clippingStencil.drawPoly(e,4,i,0,i))},_getClippingRect:function(){if(this._clippingRectDirty){for(var t=this.convertToWorldSpace(cc.p(0,0)),e=this.getNodeToWorldTransform(),i=this._contentSize.width*e.a,e=this._contentSize.height*e.d,n=this;n;)if((n=n.getParent())&&n instanceof ccui.Layout&&n.isClippingEnabled()){this._clippingParent=n;break}this._clippingParent?(n=this._clippingParent._getClippingRect(),this._clippingRect.x=Math.max(t.x,n.x),this._clippingRect.y=Math.max(t.y,n.y),i=Math.min(t.x+i,n.x+n.width),t=Math.min(t.y+e,n.y+n.height),this._clippingRect.width=Math.max(0,i-this._clippingRect.x),this._clippingRect.height=Math.max(0,t-this._clippingRect.y)):(this._clippingRect.x=t.x,this._clippingRect.y=t.y,this._clippingRect.width=i,this._clippingRect.height=e),this._clippingRectDirty=!1}return this._clippingRect},_onSizeChanged:function(){ccui.Widget.prototype._onSizeChanged.call(this);var t=this._contentSize;this._setStencilClippingSize(t),this._clippingRectDirty=this._doLayoutDirty=!0,this._backGroundImage&&(this._backGroundImage.setPosition(.5*t.width,.5*t.height),this._backGroundScale9Enabled)&&this._backGroundImage instanceof ccui.Scale9Sprite&&this._backGroundImage.setPreferredSize(t),this._colorRender&&this._colorRender.setContentSize(t),this._gradientRender&&this._gradientRender.setContentSize(t)},setBackGroundImageScale9Enabled:function(t){this._backGroundScale9Enabled!==t&&(this.removeProtectedChild(this._backGroundImage),this._backGroundImage=null,this._backGroundScale9Enabled=t,this._addBackGroundImage(),this.setBackGroundImage(this._backGroundImageFileName,this._bgImageTexType),this.setBackGroundImageCapInsets(this._backGroundImageCapInsets))},isBackGroundImageScale9Enabled:function(){return this._backGroundScale9Enabled},setBackGroundImage:function(t,e){if(t){e=e||ccui.Widget.LOCAL_TEXTURE,null===this._backGroundImage&&(this._addBackGroundImage(),this.setBackGroundImageScale9Enabled(this._backGroundScale9Enabled)),this._backGroundImageFileName=t,this._bgImageTexType=e;var i=this._backGroundImage;switch(this._bgImageTexType){case ccui.Widget.LOCAL_TEXTURE:i.initWithFile(t);break;case ccui.Widget.PLIST_TEXTURE:i.initWithSpriteFrameName(t)}this._backGroundScale9Enabled&&i.setPreferredSize(this._contentSize),this._backGroundImageTextureSize=i.getContentSize(),i.setPosition(.5*this._contentSize.width,.5*this._contentSize.height),this._updateBackGroundImageColor()}},setBackGroundImageCapInsets:function(t){var e;t&&((e=this._backGroundImageCapInsets).x=t.x,e.y=t.y,e.width=t.width,e.height=t.height,this._backGroundScale9Enabled)&&this._backGroundImage.setCapInsets(t)},getBackGroundImageCapInsets:function(){return cc.rect(this._backGroundImageCapInsets)},_supplyTheLayoutParameterLackToChild:function(t){if(t)switch(this._layoutType){case ccui.Layout.LINEAR_HORIZONTAL:case ccui.Layout.LINEAR_VERTICAL:var e=t.getLayoutParameter(ccui.LayoutParameter.LINEAR);e||t.setLayoutParameter(new ccui.LinearLayoutParameter);break;case ccui.Layout.RELATIVE:(e=t.getLayoutParameter(ccui.LayoutParameter.RELATIVE))||t.setLayoutParameter(new ccui.RelativeLayoutParameter)}},_addBackGroundImage:function(){var t=this._contentSize;this._backGroundScale9Enabled?(this._backGroundImage=new ccui.Scale9Sprite,this._backGroundImage.setPreferredSize(t)):this._backGroundImage=new cc.Sprite,this.addProtectedChild(this._backGroundImage,ccui.Layout.BACKGROUND_IMAGE_ZORDER,-1),this._backGroundImage.setPosition(.5*t.width,.5*t.height)},removeBackGroundImage:function(){this._backGroundImage&&(this.removeProtectedChild(this._backGroundImage),this._backGroundImage=null,this._backGroundImageFileName="",this._backGroundImageTextureSize.width=0,this._backGroundImageTextureSize.height=0)},setBackGroundColorType:function(t){if(this._colorType!==t){switch(this._colorType){case ccui.Layout.BG_COLOR_NONE:this._colorRender&&(this.removeProtectedChild(this._colorRender),this._colorRender=null),this._gradientRender&&(this.removeProtectedChild(this._gradientRender),this._gradientRender=null);break;case ccui.Layout.BG_COLOR_SOLID:this._colorRender&&(this.removeProtectedChild(this._colorRender),this._colorRender=null);break;case ccui.Layout.BG_COLOR_GRADIENT:this._gradientRender&&(this.removeProtectedChild(this._gradientRender),this._gradientRender=null)}switch(this._colorType=t,this._colorType){case ccui.Layout.BG_COLOR_SOLID:this._colorRender=new cc.LayerColor,this._colorRender.setContentSize(this._contentSize),this._colorRender.setOpacity(this._opacity),this._colorRender.setColor(this._color),this.addProtectedChild(this._colorRender,ccui.Layout.BACKGROUND_RENDERER_ZORDER,-1);break;case ccui.Layout.BG_COLOR_GRADIENT:this._gradientRender=new cc.LayerGradient(cc.color(255,0,0,255),cc.color(0,255,0,255)),this._gradientRender.setContentSize(this._contentSize),this._gradientRender.setOpacity(this._opacity),this._gradientRender.setStartColor(this._startColor),this._gradientRender.setEndColor(this._endColor),this._gradientRender.setVector(this._alongVector),this.addProtectedChild(this._gradientRender,ccui.Layout.BACKGROUND_RENDERER_ZORDER,-1)}}},getBackGroundColorType:function(){return this._colorType},setBackGroundColor:function(t,e){e?(this._startColor.r=t.r,this._startColor.g=t.g,this._startColor.b=t.b,this._gradientRender&&this._gradientRender.setStartColor(t),this._endColor.r=e.r,this._endColor.g=e.g,this._endColor.b=e.b,this._gradientRender&&this._gradientRender.setEndColor(e)):(this._color.r=t.r,this._color.g=t.g,this._color.b=t.b,this._colorRender&&this._colorRender.setColor(t))},getBackGroundColor:function(){var t=this._color;return cc.color(t.r,t.g,t.b,t.a)},getBackGroundStartColor:function(){var t=this._startColor;return cc.color(t.r,t.g,t.b,t.a)},getBackGroundEndColor:function(){var t=this._endColor;return cc.color(t.r,t.g,t.b,t.a)},setBackGroundColorOpacity:function(t){switch(this._opacity=t,this._colorType){case ccui.Layout.BG_COLOR_SOLID:this._colorRender.setOpacity(t);break;case ccui.Layout.BG_COLOR_GRADIENT:this._gradientRender.setOpacity(t)}},getBackGroundColorOpacity:function(){return this._opacity},setBackGroundColorVector:function(t){this._alongVector.x=t.x,this._alongVector.y=t.y,this._gradientRender&&this._gradientRender.setVector(t)},getBackGroundColorVector:function(){return this._alongVector},setBackGroundImageColor:function(t){this._backGroundImageColor.r=t.r,this._backGroundImageColor.g=t.g,this._backGroundImageColor.b=t.b,this._updateBackGroundImageColor()},setBackGroundImageOpacity:function(t){this._backGroundImageColor.a=t,this.getBackGroundImageColor()},getBackGroundImageColor:function(){var t=this._backGroundImageColor;return cc.color(t.r,t.g,t.b,t.a)},getBackGroundImageOpacity:function(){return this._backGroundImageColor.a},_updateBackGroundImageColor:function(){this._backGroundImage&&this._backGroundImage.setColor(this._backGroundImageColor)},getBackGroundImageTextureSize:function(){return this._backGroundImageTextureSize},setLayoutType:function(t){this._layoutType=t,t=this._children;for(var e,i=0;i<t.length;i++)(e=t[i])instanceof ccui.Widget&&this._supplyTheLayoutParameterLackToChild(e);this._doLayoutDirty=!0},getLayoutType:function(){return this._layoutType},requestDoLayout:function(){this._doLayoutDirty=!0},_doLayout:function(){var t;this._doLayoutDirty&&(this.sortAllChildren(),(t=ccui.getLayoutManager(this._layoutType))&&t._doLayout(this),this._doLayoutDirty=!1)},_getLayoutContentSize:function(){return this.getContentSize()},_getLayoutElements:function(){return this.getChildren()},_updateBackGroundImageOpacity:function(){this._backGroundImage&&this._backGroundImage.setOpacity(this._backGroundImageOpacity)},_updateBackGroundImageRGBA:function(){this._backGroundImage&&(this._backGroundImage.setColor(this._backGroundImageColor),this._backGroundImage.setOpacity(this._backGroundImageOpacity))},_getLayoutAccumulatedSize:function(){for(var t,e,i=this.getChildren(),n=cc.size(0,0),s=0,r=0,o=i.length;r<o;r++)null!==(e=i[r])&&e instanceof ccui.Layout?(e=e._getLayoutAccumulatedSize(),n.width+=e.width,n.height+=e.height):e instanceof ccui.Widget&&(s++,t=e.getLayoutParameter().getMargin(),e=e.getContentSize(),n.width+=e.width+.5*(t.right+t.left),n.height+=e.height+.5*(t.top+t.bottom));return(i=this.getLayoutType())===ccui.Layout.LINEAR_HORIZONTAL&&(n.height-=n.height/s*(s-1)),i===ccui.Layout.LINEAR_VERTICAL&&(n.width-=n.width/s*(s-1)),n},_findNearestChildWidgetIndex:function(t,e){if(null==e||e===this)return this._findFirstFocusEnabledWidgetIndex();var i,n=0,s=this.getChildren(),r=s.length,o=cc.FLT_MAX,a=0;if(t!==ccui.Widget.LEFT&&t!==ccui.Widget.RIGHT&&t!==ccui.Widget.DOWN&&t!==ccui.Widget.UP)return cc.log("invalid focus direction!"),0;for(i=this._getWorldCenterPoint(e);n<r;){var c=s[n];c&&c instanceof ccui.Widget&&c.isFocusEnabled()&&(c=c instanceof ccui.Layout?c._calculateNearestDistance(e):cc.pLength(cc.pSub(this._getWorldCenterPoint(c),i)))<o&&(a=n,o=c),n++}return a},_findFarthestChildWidgetIndex:function(t,e){if(null==e||e===this)return this._findFirstFocusEnabledWidgetIndex();var i=0,n=this.getChildren(),s=n.length,r=-cc.FLT_MAX,o=0;if(t!==ccui.Widget.LEFT&&t!==ccui.Widget.RIGHT&&t!==ccui.Widget.DOWN&&t!==ccui.Widget.UP)return cc.log("invalid focus direction!!!"),0;for(var a=this._getWorldCenterPoint(e);i<s;){var c=n[i];c&&c instanceof ccui.Widget&&c.isFocusEnabled()&&r<(c=c instanceof ccui.Layout?c._calculateFarthestDistance(e):cc.pLength(cc.pSub(this._getWorldCenterPoint(c),a)))&&(o=i,r=c),i++}return o},_calculateNearestDistance:function(t){for(var e=cc.FLT_MAX,i=this._getWorldCenterPoint(t),n=this._children,s=0,r=n.length;s<r;s++){var o=n[s];if(o instanceof ccui.Layout)o=o._calculateNearestDistance(t);else{if(!(o instanceof ccui.Widget&&o.isFocusEnabled()))continue;o=cc.pLength(cc.pSub(this._getWorldCenterPoint(o),i))}o<e&&(e=o)}return e},_calculateFarthestDistance:function(t){for(var e=-cc.FLT_MAX,i=this._getWorldCenterPoint(t),n=this._children,s=0,r=n.length;s<r;s++){var o=n[s];if(o instanceof ccui.Layout)o=o._calculateFarthestDistance(t);else{if(!(o instanceof ccui.Widget&&o.isFocusEnabled()))continue;o=this._getWorldCenterPoint(o),o=cc.pLength(cc.pSub(o,i))}e<o&&(e=o)}return e},_findProperSearchingFunctor:function(t,e){var i;void 0!==e&&(e=this._getWorldCenterPoint(e),i=this._getWorldCenterPoint(this._findFirstNonLayoutWidget()),t===ccui.Widget.LEFT?this.onPassFocusToChild=e.x>i.x?this._findNearestChildWidgetIndex:this._findFarthestChildWidgetIndex:t===ccui.Widget.RIGHT?this.onPassFocusToChild=e.x>i.x?this._findFarthestChildWidgetIndex:this._findNearestChildWidgetIndex:t===ccui.Widget.DOWN?this.onPassFocusToChild=e.y>i.y?this._findNearestChildWidgetIndex:this._findFarthestChildWidgetIndex:t===ccui.Widget.UP?this.onPassFocusToChild=e.y<i.y?this._findNearestChildWidgetIndex:this._findFarthestChildWidgetIndex:cc.log("invalid direction!"))},_findFirstNonLayoutWidget:function(){for(var t=this._children,e=0,i=t.length;e<i;e++){var n=t[e];if(n instanceof ccui.Layout){if(n=n._findFirstNonLayoutWidget())return n}else if(n instanceof ccui.Widget)return n}return null},_findFirstFocusEnabledWidgetIndex:function(){for(var t=0,e=this.getChildren(),i=e.length;t<i;){var n=e[t];if(n&&n instanceof ccui.Widget&&n.isFocusEnabled())return t;t++}return 0},_findFocusEnabledChildWidgetByIndex:function(t){var e=this._getChildWidgetByIndex(t);return e?e.isFocusEnabled()?e:this._findFocusEnabledChildWidgetByIndex(t+1):null},_getWorldCenterPoint:function(t){var e=t instanceof ccui.Layout?t._getLayoutAccumulatedSize():t.getContentSize();return t.convertToWorldSpace(cc.p(e.width/2,e.height/2))},_getNextFocusedWidget:function(t,e){var i,n=null;return(i=(n=this._children).indexOf(e)+1)<n.length?(n=this._getChildWidgetByIndex(i))?n.isFocusEnabled()?n instanceof ccui.Layout?(n._isFocusPassing=!0,n.findNextFocusedWidget(t,n)):(this.dispatchFocusEvent(e,n),n):this._getNextFocusedWidget(t,n):e:this._loopFocus?this._checkFocusEnabledChild()?(n=this._getChildWidgetByIndex(0)).isFocusEnabled()?n instanceof ccui.Layout?(n._isFocusPassing=!0,n.findNextFocusedWidget(t,n)):(this.dispatchFocusEvent(e,n),n):this._getNextFocusedWidget(t,n):e instanceof ccui.Layout?e:ccui.Widget._focusedWidget:!this._isLastWidgetInContainer(e,t)||this._isWidgetAncestorSupportLoopFocus(this,t)?ccui.Widget.prototype.findNextFocusedWidget.call(this,t,this):e instanceof ccui.Layout?e:ccui.Widget._focusedWidget},_getPreviousFocusedWidget:function(t,e){var i,n=null;return 0<=(i=(n=this._children).indexOf(e)-1)?(n=this._getChildWidgetByIndex(i)).isFocusEnabled()?n instanceof ccui.Layout?(n._isFocusPassing=!0,n.findNextFocusedWidget(t,n)):(this.dispatchFocusEvent(e,n),n):this._getPreviousFocusedWidget(t,n):this._loopFocus?this._checkFocusEnabledChild()?(i=n.length-1,(n=this._getChildWidgetByIndex(i)).isFocusEnabled()?n instanceof ccui.Layout?(n._isFocusPassing=!0,n.findNextFocusedWidget(t,n)):(this.dispatchFocusEvent(e,n),n):this._getPreviousFocusedWidget(t,n)):e instanceof ccui.Layout?e:ccui.Widget._focusedWidget:!this._isLastWidgetInContainer(e,t)||this._isWidgetAncestorSupportLoopFocus(this,t)?ccui.Widget.prototype.findNextFocusedWidget.call(this,t,this):e instanceof ccui.Layout?e:ccui.Widget._focusedWidget},_getChildWidgetByIndex:function(t){for(var e=this._children,i=e.length,n=t;t<i;){var s=e[t];if(s&&s instanceof ccui.Widget)return s;t++}for(t=0;t<n;){if((i=e[t])&&i instanceof ccui.Widget)return i;t++}return null},_isLastWidgetInContainer:function(t,e){var i,n=t.getParent();return!(null!=n&&n instanceof ccui.Layout)||(t=(i=n.getChildren()).indexOf(t),n.getLayoutType()===ccui.Layout.LINEAR_HORIZONTAL?e===ccui.Widget.LEFT?0===t&&this._isLastWidgetInContainer(n,e):e===ccui.Widget.RIGHT?t===i.length-1&&this._isLastWidgetInContainer(n,e):e===ccui.Widget.DOWN||e===ccui.Widget.UP?this._isLastWidgetInContainer(n,e):void 0:n.getLayoutType()===ccui.Layout.LINEAR_VERTICAL?e===ccui.Widget.UP?0===t&&this._isLastWidgetInContainer(n,e):e===ccui.Widget.DOWN?t===i.length-1&&this._isLastWidgetInContainer(n,e):e===ccui.Widget.LEFT||e===ccui.Widget.RIGHT?this._isLastWidgetInContainer(n,e):void 0:(cc.log("invalid layout Type"),!1))},_isWidgetAncestorSupportLoopFocus:function(t,e){var i,t=t.getParent();return null!=t&&t instanceof ccui.Layout&&(t.isLoopFocus()?(i=t.getLayoutType())===ccui.Layout.LINEAR_HORIZONTAL?e===ccui.Widget.LEFT||e===ccui.Widget.RIGHT||this._isWidgetAncestorSupportLoopFocus(t,e):i===ccui.Layout.LINEAR_VERTICAL?e===ccui.Widget.DOWN||e===ccui.Widget.UP||this._isWidgetAncestorSupportLoopFocus(t,e):(cc.assert(0,"invalid layout type"),!1):this._isWidgetAncestorSupportLoopFocus(t,e))},_passFocusToChild:function(t,e){var i;return this._checkFocusEnabledChild()?(i=ccui.Widget.getCurrentFocusedWidget(),this._findProperSearchingFunctor(t,i),i=this.onPassFocusToChild(t,i),(i=this._getChildWidgetByIndex(i))instanceof ccui.Layout?(i._isFocusPassing=!0,i.findNextFocusedWidget(t,i)):(this.dispatchFocusEvent(e,i),i)):this},_checkFocusEnabledChild:function(){for(var t=this._children,e=0,i=t.length;e<i;e++){var n=t[e];if(n&&n instanceof ccui.Widget&&n.isFocusEnabled())return!0}return!1},getDescription:function(){return"Layout"},_createCloneInstance:function(){return new ccui.Layout},_copyClonedWidgetChildren:function(t){ccui.Widget.prototype._copyClonedWidgetChildren.call(this,t)},_copySpecialProperties:function(t){t instanceof ccui.Layout&&(this.setBackGroundImageScale9Enabled(t._backGroundScale9Enabled),this.setBackGroundImage(t._backGroundImageFileName,t._bgImageTexType),this.setBackGroundImageCapInsets(t._backGroundImageCapInsets),this.setBackGroundColorType(t._colorType),this.setBackGroundColor(t._color),this.setBackGroundColor(t._startColor,t._endColor),this.setBackGroundColorOpacity(t._opacity),this.setBackGroundColorVector(t._alongVector),this.setLayoutType(t._layoutType),this.setClippingEnabled(t._clippingEnabled),this.setClippingType(t._clippingType),this._loopFocus=t._loopFocus,this.__passFocusToChild=t.__passFocusToChild,this._isInterceptTouch=t._isInterceptTouch)},forceDoLayout:function(){this.requestDoLayout(),this._doLayout()},_createRenderCmd:function(){return new(cc._renderType===cc.game.RENDER_TYPE_WEBGL?ccui.Layout.WebGLRenderCmd:ccui.Layout.CanvasRenderCmd)(this)}}),_p=ccui.Layout.prototype,cc.defineGetterSetter(_p,"clippingEnabled",_p.isClippingEnabled,_p.setClippingEnabled),cc.defineGetterSetter(_p,"clippingType",null,_p.setClippingType),cc.defineGetterSetter(_p,"layoutType",_p.getLayoutType,_p.setLayoutType),_p=null,ccui.Layout.create=function(){return new ccui.Layout},ccui.Layout.BG_COLOR_NONE=0,ccui.Layout.BG_COLOR_SOLID=1,ccui.Layout.BG_COLOR_GRADIENT=2,ccui.Layout.ABSOLUTE=0,ccui.Layout.LINEAR_VERTICAL=1,ccui.Layout.LINEAR_HORIZONTAL=2,ccui.Layout.RELATIVE=3,ccui.Layout.CLIPPING_STENCIL=0,ccui.Layout.CLIPPING_SCISSOR=1,ccui.Layout.BACKGROUND_IMAGE_ZORDER=-1,ccui.Layout.BACKGROUND_RENDERER_ZORDER=-2,!function(){ccui.Layout.CanvasRenderCmd=function(t){this._pNodeCmdCtor(t),this._needDraw=!1,this._rendererRestoreCmd=this._rendererClipCmd=this._rendererSaveCmd=null};var t=ccui.Layout.CanvasRenderCmd.prototype=Object.create(ccui.ProtectedNode.CanvasRenderCmd.prototype);t.constructor=ccui.Layout.CanvasRenderCmd,t._layoutCmdCtor=ccui.Layout.CanvasRenderCmd,t._onRenderSaveCmd=function(t,e,i){var n=t||cc._renderContext;for(t=n.getContext(),n.save(),n.save(),n.setTransform(this._worldTransform,e,i),i=0,n=(e=this._node._clippingStencil._renderCmd._buffer).length;i<n;i++){var s=e[i].verts,r=s[0];t.beginPath(),t.moveTo(r.x,-r.y);for(var r=1,o=s.length;r<o;r++)t.lineTo(s[r].x,-s[r].y);t.closePath()}},t._onRenderClipCmd=function(t){var e=(t=t||cc._renderContext).getContext();t.restore(),e.clip()},t._onRenderRestoreCmd=function(t){(t=t||cc._renderContext).getContext(),t.restore()},t.rebindStencilRendering=function(t){t._renderCmd.rendering=this.__stencilDraw,t._renderCmd._canUseDirtyRegion=!0},t.__stencilDraw=function(t,e,i){},t.stencilClippingVisit=t.scissorClippingVisit=function(t){(t=this._node)._clippingStencil&&t._clippingStencil.isVisible()&&(this._rendererSaveCmd||(this._rendererSaveCmd=new cc.CustomRenderCmd(this,this._onRenderSaveCmd),this._rendererClipCmd=new cc.CustomRenderCmd(this,this._onRenderClipCmd),this._rendererRestoreCmd=new cc.CustomRenderCmd(this,this._onRenderRestoreCmd)),cc.renderer.pushRenderCommand(this._rendererSaveCmd),t._clippingStencil.visit(this),cc.renderer.pushRenderCommand(this._rendererClipCmd))},t.postStencilVisit=t.postScissorVisit=function(){cc.renderer.pushRenderCommand(this._rendererRestoreCmd)},ccui.Layout.CanvasRenderCmd._getSharedCache=function(){return cc.ClippingNode._sharedCache||(cc.ClippingNode._sharedCache=document.createElement("canvas"))}}(),!function(){var t;ccui.ProtectedNode.WebGLRenderCmd&&(ccui.Layout.WebGLRenderCmd=function(t){this._pNodeCmdCtor(t),this._needDraw=!1,this._currentStencilEnabled=0,this._scissorOldState=!1,this._clippingOldRect=null,this._mask_layer_le=0,this._afterVisitCmdScissor=this._beforeVisitCmdScissor=this._afterVisitCmdStencil=this._afterDrawStencilCmd=this._beforeVisitCmdStencil=null},(t=ccui.Layout.WebGLRenderCmd.prototype=Object.create(ccui.ProtectedNode.WebGLRenderCmd.prototype)).constructor=ccui.Layout.WebGLRenderCmd,t._layoutCmdCtor=ccui.Layout.CanvasRenderCmd,t._syncStatus=function(t){this._originSyncStatus(t),t&&t._dirtyFlag&cc.Node._dirtyFlags.transformDirty&&(this._node._clippingRectDirty=!0)},t._onBeforeVisitStencil=function(t){t=t||cc._renderContext,ccui.Layout.WebGLRenderCmd._layer++;var e=1<<ccui.Layout.WebGLRenderCmd._layer;this._mask_layer_le=e|e-1,this._currentStencilEnabled=t.isEnabled(t.STENCIL_TEST),t.clear(t.DEPTH_BUFFER_BIT),t.enable(t.STENCIL_TEST),t.depthMask(!1),t.stencilFunc(t.NEVER,e,e),t.stencilOp(t.REPLACE,t.KEEP,t.KEEP),t.stencilMask(e),t.clear(t.STENCIL_BUFFER_BIT)},t._onAfterDrawStencil=function(t){(t=t||cc._renderContext).depthMask(!0),t.stencilFunc(t.EQUAL,this._mask_layer_le,this._mask_layer_le),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},t._onAfterVisitStencil=function(t){var e,i;t=t||cc._renderContext,ccui.Layout.WebGLRenderCmd._layer--,this._currentStencilEnabled?(i=(e=1<<ccui.Layout.WebGLRenderCmd._layer)|e-1,t.stencilMask(e),t.stencilFunc(t.EQUAL,i,i)):t.disable(t.STENCIL_TEST)},t._onBeforeVisitScissor=function(t){this._node._clippingRectDirty=!0;var e=this._node._getClippingRect();t=t||cc._renderContext,(this._scissorOldState=t.isEnabled(t.SCISSOR_TEST))?(this._clippingOldRect=cc.view.getScissorRect(),cc.rectEqualToRect(this._clippingOldRect,e)||cc.view.setScissorInPoints(e.x,e.y,e.width,e.height)):(t.enable(t.SCISSOR_TEST),cc.view.setScissorInPoints(e.x,e.y,e.width,e.height))},t._onAfterVisitScissor=function(t){t=t||cc._renderContext,this._scissorOldState?cc.rectEqualToRect(this._clippingOldRect,this._node._clippingRect)||cc.view.setScissorInPoints(this._clippingOldRect.x,this._clippingOldRect.y,this._clippingOldRect.width,this._clippingOldRect.height):t.disable(t.SCISSOR_TEST)},t.rebindStencilRendering=function(t){},t.transform=function(t,e){var i=this._node;this.pNodeTransform(t,e),i._clippingStencil&&i._clippingStencil._renderCmd.transform(this,e)},t.stencilClippingVisit=function(t){var e;(t=this._node)._clippingStencil&&t._clippingStencil.isVisible()&&(ccui.Layout.WebGLRenderCmd._layer+1===cc.stencilBits?(ccui.Layout.WebGLRenderCmd._visit_once=!0,ccui.Layout.WebGLRenderCmd._visit_once&&(cc.log("Nesting more than "+cc.stencilBits+"stencils is not supported. Everything will be drawn without stencil for this node and its childs."),ccui.Layout.WebGLRenderCmd._visit_once=!1)):(this._beforeVisitCmdStencil||(this._beforeVisitCmdStencil=new cc.CustomRenderCmd(this,this._onBeforeVisitStencil),this._afterDrawStencilCmd=new cc.CustomRenderCmd(this,this._onAfterDrawStencil),this._afterVisitCmdStencil=new cc.CustomRenderCmd(this,this._onAfterVisitStencil)),cc.renderer.pushRenderCommand(this._beforeVisitCmdStencil),(e=cc.current_stack).stack.push(e.top),e.top=this._stackMatrix,t._clippingStencil.visit(this),cc.renderer.pushRenderCommand(this._afterDrawStencilCmd)))},t.postStencilVisit=function(){renderer.pushRenderCommand(cmd._afterVisitCmdStencil),cc.current_stack.top=cc.current_stack.stack.pop()},t.scissorClippingVisit=function(t){this._beforeVisitCmdScissor||(this._beforeVisitCmdScissor=new cc.CustomRenderCmd(this,this._onBeforeVisitScissor),this._afterVisitCmdScissor=new cc.CustomRenderCmd(this,this._onAfterVisitScissor)),cc.renderer.pushRenderCommand(this._beforeVisitCmdScissor)},t.postScissorVisit=function(){cc.renderer.pushRenderCommand(this._afterVisitCmdScissor)},ccui.Layout.WebGLRenderCmd._layer=-1,ccui.Layout.WebGLRenderCmd._visit_once=null)}(),ccui.Margin=ccui.Class.extend({left:0,top:0,right:0,bottom:0,ctor:function(t,e,i,n){void 0!==t&&void 0===e&&(this.left=t.left,this.top=t.top,this.right=t.right,this.bottom=t.bottom),void 0!==n&&(this.left=t,this.top=e,this.right=i,this.bottom=n)},setMargin:function(t,e,i,n){this.left=t,this.top=e,this.right=i,this.bottom=n},equals:function(t){return this.left===t.left&&this.top===t.top&&this.right===t.right&&this.bottom===t.bottom}}),ccui.MarginZero=function(){return new ccui.Margin(0,0,0,0)},ccui.LayoutParameter=ccui.Class.extend({_margin:null,_layoutParameterType:null,ctor:function(){this._margin=new ccui.Margin,this._layoutParameterType=ccui.LayoutParameter.NONE},setMargin:function(t,e,i,n){cc.isObject(t)?(this._margin.left=t.left,this._margin.top=t.top,this._margin.right=t.right,this._margin.bottom=t.bottom):(this._margin.left=t,this._margin.top=e,this._margin.right=i,this._margin.bottom=n)},getMargin:function(){return this._margin},getLayoutType:function(){return this._layoutParameterType},clone:function(){var t=this._createCloneInstance();return t._copyProperties(this),t},_createCloneInstance:function(){return new ccui.LayoutParameter},_copyProperties:function(t){this._margin.bottom=t._margin.bottom,this._margin.left=t._margin.left,this._margin.right=t._margin.right,this._margin.top=t._margin.top}}),ccui.LayoutParameter.create=function(){return new ccui.LayoutParameter},ccui.LayoutParameter.NONE=0,ccui.LayoutParameter.LINEAR=1,ccui.LayoutParameter.RELATIVE=2,ccui.LinearLayoutParameter=ccui.LayoutParameter.extend({_linearGravity:null,ctor:function(){ccui.LayoutParameter.prototype.ctor.call(this),this._linearGravity=ccui.LinearLayoutParameter.NONE,this._layoutParameterType=ccui.LayoutParameter.LINEAR},setGravity:function(t){this._linearGravity=t},getGravity:function(){return this._linearGravity},_createCloneInstance:function(){return new ccui.LinearLayoutParameter},_copyProperties:function(t){ccui.LayoutParameter.prototype._copyProperties.call(this,t),t instanceof ccui.LinearLayoutParameter&&this.setGravity(t._linearGravity)}}),ccui.LinearLayoutParameter.create=function(){return new ccui.LinearLayoutParameter},ccui.LinearLayoutParameter.NONE=0,ccui.LinearLayoutParameter.LEFT=1,ccui.LinearLayoutParameter.TOP=2,ccui.LinearLayoutParameter.RIGHT=3,ccui.LinearLayoutParameter.BOTTOM=4,ccui.LinearLayoutParameter.CENTER_VERTICAL=5,ccui.LinearLayoutParameter.CENTER_HORIZONTAL=6,ccui.RelativeLayoutParameter=ccui.LayoutParameter.extend({_relativeAlign:null,_relativeWidgetName:"",_relativeLayoutName:"",_put:!1,ctor:function(){ccui.LayoutParameter.prototype.ctor.call(this),this._relativeAlign=ccui.RelativeLayoutParameter.NONE,this._relativeLayoutName=this._relativeWidgetName="",this._put=!1,this._layoutParameterType=ccui.LayoutParameter.RELATIVE},setAlign:function(t){this._relativeAlign=t},getAlign:function(){return this._relativeAlign},setRelativeToWidgetName:function(t){this._relativeWidgetName=t},getRelativeToWidgetName:function(){return this._relativeWidgetName},setRelativeName:function(t){this._relativeLayoutName=t},getRelativeName:function(){return this._relativeLayoutName},_createCloneInstance:function(){return new ccui.RelativeLayoutParameter},_copyProperties:function(t){ccui.LayoutParameter.prototype._copyProperties.call(this,t),t instanceof ccui.RelativeLayoutParameter&&(this.setAlign(t._relativeAlign),this.setRelativeToWidgetName(t._relativeWidgetName),this.setRelativeName(t._relativeLayoutName))}}),ccui.RelativeLayoutParameter.create=function(){return new ccui.RelativeLayoutParameter},ccui.RelativeLayoutParameter.NONE=0,ccui.RelativeLayoutParameter.PARENT_TOP_LEFT=1,ccui.RelativeLayoutParameter.PARENT_TOP_CENTER_HORIZONTAL=2,ccui.RelativeLayoutParameter.PARENT_TOP_RIGHT=3,ccui.RelativeLayoutParameter.PARENT_LEFT_CENTER_VERTICAL=4,ccui.RelativeLayoutParameter.CENTER_IN_PARENT=5,ccui.RelativeLayoutParameter.PARENT_RIGHT_CENTER_VERTICAL=6,ccui.RelativeLayoutParameter.PARENT_LEFT_BOTTOM=7,ccui.RelativeLayoutParameter.PARENT_BOTTOM_CENTER_HORIZONTAL=8,ccui.RelativeLayoutParameter.PARENT_RIGHT_BOTTOM=9,ccui.RelativeLayoutParameter.LOCATION_ABOVE_LEFTALIGN=10,ccui.RelativeLayoutParameter.LOCATION_ABOVE_CENTER=11,ccui.RelativeLayoutParameter.LOCATION_ABOVE_RIGHTALIGN=12,ccui.RelativeLayoutParameter.LOCATION_LEFT_OF_TOPALIGN=13,ccui.RelativeLayoutParameter.LOCATION_LEFT_OF_CENTER=14,ccui.RelativeLayoutParameter.LOCATION_LEFT_OF_BOTTOMALIGN=15,ccui.RelativeLayoutParameter.LOCATION_RIGHT_OF_TOPALIGN=16,ccui.RelativeLayoutParameter.LOCATION_RIGHT_OF_CENTER=17,ccui.RelativeLayoutParameter.LOCATION_RIGHT_OF_BOTTOMALIGN=18,ccui.RelativeLayoutParameter.LOCATION_BELOW_LEFTALIGN=19,ccui.RelativeLayoutParameter.LOCATION_BELOW_CENTER=20,ccui.RelativeLayoutParameter.LOCATION_BELOW_RIGHTALIGN=21,ccui.LINEAR_GRAVITY_NONE=0,ccui.LINEAR_GRAVITY_LEFT=1,ccui.LINEAR_GRAVITY_TOP=2,ccui.LINEAR_GRAVITY_RIGHT=3,ccui.LINEAR_GRAVITY_BOTTOM=4,ccui.LINEAR_GRAVITY_CENTER_VERTICAL=5,ccui.LINEAR_GRAVITY_CENTER_HORIZONTAL=6,ccui.RELATIVE_ALIGN_NONE=0,ccui.RELATIVE_ALIGN_PARENT_TOP_LEFT=1,ccui.RELATIVE_ALIGN_PARENT_TOP_CENTER_HORIZONTAL=2,ccui.RELATIVE_ALIGN_PARENT_TOP_RIGHT=3,ccui.RELATIVE_ALIGN_PARENT_LEFT_CENTER_VERTICAL=4,ccui.RELATIVE_ALIGN_PARENT_CENTER=5,ccui.RELATIVE_ALIGN_PARENT_RIGHT_CENTER_VERTICAL=6,ccui.RELATIVE_ALIGN_PARENT_LEFT_BOTTOM=7,ccui.RELATIVE_ALIGN_PARENT_BOTTOM_CENTER_HORIZONTAL=8,ccui.RELATIVE_ALIGN_PARENT_RIGHT_BOTTOM=9,ccui.RELATIVE_ALIGN_LOCATION_ABOVE_LEFT=10,ccui.RELATIVE_ALIGN_LOCATION_ABOVE_CENTER=11,ccui.RELATIVE_ALIGN_LOCATION_ABOVE_RIGHT=12,ccui.RELATIVE_ALIGN_LOCATION_LEFT_TOP=13,ccui.RELATIVE_ALIGN_LOCATION_LEFT_CENTER=14,ccui.RELATIVE_ALIGN_LOCATION_LEFT_BOTTOM=15,ccui.RELATIVE_ALIGN_LOCATION_RIGHT_TOP=16,ccui.RELATIVE_ALIGN_LOCATION_RIGHT_CENTER=17,ccui.RELATIVE_ALIGN_LOCATION_RIGHT_BOTTOM=18,ccui.RELATIVE_ALIGN_LOCATION_BELOW_TOP=19,ccui.RELATIVE_ALIGN_LOCATION_BELOW_CENTER=20,ccui.RELATIVE_ALIGN_LOCATION_BELOW_BOTTOM=21,ccui.getLayoutManager=function(t){switch(t){case ccui.Layout.LINEAR_VERTICAL:return ccui.linearVerticalLayoutManager;case ccui.Layout.LINEAR_HORIZONTAL:return ccui.linearHorizontalLayoutManager;case ccui.Layout.RELATIVE:return ccui.relativeLayoutManager}return null},ccui.linearVerticalLayoutManager={_doLayout:function(t){var e=t._getLayoutContentSize();t=t._getLayoutElements();for(var i=e.height,n=0,s=t.length;n<s;n++){var r=t[n];if(r){var o=r.getLayoutParameter();if(o){var a=o.getGravity(),c=r.getAnchorPoint(),h=r.getContentSize(),l=c.x*h.width,i=i-(1-c.y)*h.height;switch(a){case ccui.LinearLayoutParameter.RIGHT:l=e.width-(1-c.x)*h.width;break;case ccui.LinearLayoutParameter.CENTER_HORIZONTAL:l=e.width/2-h.width*(.5-c.x)}l+=(o=o.getMargin()).left,i-=o.top,r.setPosition(l,i),i=r.getPositionY()-c.y*h.height-o.bottom}}}}},ccui.linearHorizontalLayoutManager={_doLayout:function(t){for(var e=t._getLayoutContentSize(),i=0,n=0,s=(t=t._getLayoutElements()).length;n<s;n++){var r=t[n];if(r){var o=r.getLayoutParameter();if(o){var a=o.getGravity(),c=r.getAnchorPoint(),h=r.getContentSize(),i=i+c.x*h.width,l=e.height-(1-c.y)*h.height;switch(a){case ccui.LinearLayoutParameter.BOTTOM:l=c.y*h.height;break;case ccui.LinearLayoutParameter.CENTER_VERTICAL:l=e.height/2-h.height*(.5-c.y)}i+=(o=o.getMargin()).left,l-=o.top,r.setPosition(i,l),i=r.getRightBoundary()+o.right}}}}},ccui.relativeLayoutManager={_unlayoutChildCount:0,_widgetChildren:[],_widget:null,_finalPositionX:0,_finalPositionY:0,_relativeWidgetLP:null,_doLayout:function(t){for(var e=this._widgetChildren=this._getAllWidgets(t);0<this._unlayoutChildCount;){for(var i=0,n=e.length;i<n;i++){this._widget=e[i];var s=this._widget.getLayoutParameter();s&&!s._put&&this._calculateFinalPositionWithRelativeWidget(t)&&(this._calculateFinalPositionWithRelativeAlign(),this._widget.setPosition(this._finalPositionX,this._finalPositionY),s._put=!0)}this._unlayoutChildCount--}this._widgetChildren.length=0},_getAllWidgets:function(t){t=t._getLayoutElements();for(var e=this._widgetChildren,i=e.length=0,n=t.length;i<n;i++){var s=t[i];s&&s instanceof ccui.Widget&&(s.getLayoutParameter()._put=!1,this._unlayoutChildCount++,e.push(s))}return e},_getRelativeWidget:function(t){var e=null;if((t=t.getLayoutParameter().getRelativeToWidgetName())&&0!==t.length)for(var i=this._widgetChildren,n=0,s=i.length;n<s;n++){var r=i[n];if(r){var o=r.getLayoutParameter();if(o&&o.getRelativeName()===t){e=r,this._relativeWidgetLP=o;break}}}return e},_calculateFinalPositionWithRelativeWidget:function(t){var e=(s=this._widget).getAnchorPoint(),i=s.getContentSize(),n=(this._finalPositionY=this._finalPositionX=0,this._getRelativeWidget(s)),s=s.getLayoutParameter().getAlign();switch(t=t._getLayoutContentSize(),s){case ccui.RelativeLayoutParameter.NONE:case ccui.RelativeLayoutParameter.PARENT_TOP_LEFT:this._finalPositionX=e.x*i.width,this._finalPositionY=t.height-(1-e.y)*i.height;break;case ccui.RelativeLayoutParameter.PARENT_TOP_CENTER_HORIZONTAL:this._finalPositionX=.5*t.width-i.width*(.5-e.x),this._finalPositionY=t.height-(1-e.y)*i.height;break;case ccui.RelativeLayoutParameter.PARENT_TOP_RIGHT:this._finalPositionX=t.width-(1-e.x)*i.width,this._finalPositionY=t.height-(1-e.y)*i.height;break;case ccui.RelativeLayoutParameter.PARENT_LEFT_CENTER_VERTICAL:this._finalPositionX=e.x*i.width,this._finalPositionY=.5*t.height-i.height*(.5-e.y);break;case ccui.RelativeLayoutParameter.CENTER_IN_PARENT:this._finalPositionX=.5*t.width-i.width*(.5-e.x),this._finalPositionY=.5*t.height-i.height*(.5-e.y);break;case ccui.RelativeLayoutParameter.PARENT_RIGHT_CENTER_VERTICAL:this._finalPositionX=t.width-(1-e.x)*i.width,this._finalPositionY=.5*t.height-i.height*(.5-e.y);break;case ccui.RelativeLayoutParameter.PARENT_LEFT_BOTTOM:this._finalPositionX=e.x*i.width,this._finalPositionY=e.y*i.height;break;case ccui.RelativeLayoutParameter.PARENT_BOTTOM_CENTER_HORIZONTAL:this._finalPositionX=.5*t.width-i.width*(.5-e.x),this._finalPositionY=e.y*i.height;break;case ccui.RelativeLayoutParameter.PARENT_RIGHT_BOTTOM:this._finalPositionX=t.width-(1-e.x)*i.width,this._finalPositionY=e.y*i.height;break;case ccui.RelativeLayoutParameter.LOCATION_ABOVE_LEFTALIGN:if(n){if(this._relativeWidgetLP&&!this._relativeWidgetLP._put)return!1;this._finalPositionY=n.getTopBoundary()+e.y*i.height,this._finalPositionX=n.getLeftBoundary()+e.x*i.width}break;case ccui.RelativeLayoutParameter.LOCATION_ABOVE_CENTER:if(n){if(this._relativeWidgetLP&&!this._relativeWidgetLP._put)return!1;t=n.getContentSize(),this._finalPositionY=n.getTopBoundary()+e.y*i.height,this._finalPositionX=n.getLeftBoundary()+.5*t.width+e.x*i.width-.5*i.width}break;case ccui.RelativeLayoutParameter.LOCATION_ABOVE_RIGHTALIGN:if(n){if(this._relativeWidgetLP&&!this._relativeWidgetLP._put)return!1;this._finalPositionY=n.getTopBoundary()+e.y*i.height,this._finalPositionX=n.getRightBoundary()-(1-e.x)*i.width}break;case ccui.RelativeLayoutParameter.LOCATION_LEFT_OF_TOPALIGN:if(n){if(this._relativeWidgetLP&&!this._relativeWidgetLP._put)return!1;this._finalPositionY=n.getTopBoundary()-(1-e.y)*i.height,this._finalPositionX=n.getLeftBoundary()-(1-e.x)*i.width}break;case ccui.RelativeLayoutParameter.LOCATION_LEFT_OF_CENTER:if(n){if(this._relativeWidgetLP&&!this._relativeWidgetLP._put)return!1;t=n.getContentSize(),this._finalPositionX=n.getLeftBoundary()-(1-e.x)*i.width,this._finalPositionY=n.getBottomBoundary()+.5*t.height+e.y*i.height-.5*i.height}break;case ccui.RelativeLayoutParameter.LOCATION_LEFT_OF_BOTTOMALIGN:if(n){if(this._relativeWidgetLP&&!this._relativeWidgetLP._put)return!1;this._finalPositionY=n.getBottomBoundary()+e.y*i.height,this._finalPositionX=n.getLeftBoundary()-(1-e.x)*i.width}break;case ccui.RelativeLayoutParameter.LOCATION_RIGHT_OF_TOPALIGN:if(n){if(this._relativeWidgetLP&&!this._relativeWidgetLP._put)return!1;this._finalPositionY=n.getTopBoundary()-(1-e.y)*i.height,this._finalPositionX=n.getRightBoundary()+e.x*i.width}break;case ccui.RelativeLayoutParameter.LOCATION_RIGHT_OF_CENTER:if(n){if(this._relativeWidgetLP&&!this._relativeWidgetLP._put)return!1;t=n.getContentSize(),this._finalPositionX=n.getRightBoundary()+e.x*i.width,this._finalPositionY=n.getBottomBoundary()+.5*t.height+e.y*i.height-.5*i.height}break;case ccui.RelativeLayoutParameter.LOCATION_RIGHT_OF_BOTTOMALIGN:if(n){if(this._relativeWidgetLP&&!this._relativeWidgetLP._put)return!1;this._finalPositionY=n.getBottomBoundary()+e.y*i.height,this._finalPositionX=n.getRightBoundary()+e.x*i.width}break;case ccui.RelativeLayoutParameter.LOCATION_BELOW_LEFTALIGN:if(n){if(this._relativeWidgetLP&&!this._relativeWidgetLP._put)return!1;this._finalPositionY=n.getBottomBoundary()-(1-e.y)*i.height,this._finalPositionX=n.getLeftBoundary()+e.x*i.width}break;case ccui.RelativeLayoutParameter.LOCATION_BELOW_CENTER:if(n){if(this._relativeWidgetLP&&!this._relativeWidgetLP._put)return!1;t=n.getContentSize(),this._finalPositionY=n.getBottomBoundary()-(1-e.y)*i.height,this._finalPositionX=n.getLeftBoundary()+.5*t.width+e.x*i.width-.5*i.width}break;case ccui.RelativeLayoutParameter.LOCATION_BELOW_RIGHTALIGN:if(n){if(this._relativeWidgetLP&&!this._relativeWidgetLP._put)return!1;this._finalPositionY=n.getBottomBoundary()-(1-e.y)*i.height,this._finalPositionX=n.getRightBoundary()-(1-e.x)*i.width}}return!0},_calculateFinalPositionWithRelativeAlign:function(){var t=this._widget.getLayoutParameter(),e=t.getMargin();switch(t.getAlign()){case ccui.RelativeLayoutParameter.NONE:case ccui.RelativeLayoutParameter.PARENT_TOP_LEFT:this._finalPositionX+=e.left,this._finalPositionY-=e.top;break;case ccui.RelativeLayoutParameter.PARENT_TOP_CENTER_HORIZONTAL:this._finalPositionY-=e.top;break;case ccui.RelativeLayoutParameter.PARENT_TOP_RIGHT:this._finalPositionX-=e.right,this._finalPositionY-=e.top;break;case ccui.RelativeLayoutParameter.PARENT_LEFT_CENTER_VERTICAL:this._finalPositionX+=e.left;break;case ccui.RelativeLayoutParameter.PARENT_RIGHT_CENTER_VERTICAL:this._finalPositionX-=e.right;break;case ccui.RelativeLayoutParameter.PARENT_LEFT_BOTTOM:this._finalPositionX+=e.left,this._finalPositionY+=e.bottom;break;case ccui.RelativeLayoutParameter.PARENT_BOTTOM_CENTER_HORIZONTAL:this._finalPositionY+=e.bottom;break;case ccui.RelativeLayoutParameter.PARENT_RIGHT_BOTTOM:this._finalPositionX-=e.right,this._finalPositionY+=e.bottom;break;case ccui.RelativeLayoutParameter.LOCATION_ABOVE_LEFTALIGN:this._finalPositionY+=e.bottom,this._finalPositionX+=e.left;break;case ccui.RelativeLayoutParameter.LOCATION_ABOVE_RIGHTALIGN:this._finalPositionY+=e.bottom,this._finalPositionX-=e.right;break;case ccui.RelativeLayoutParameter.LOCATION_ABOVE_CENTER:this._finalPositionY+=e.bottom;break;case ccui.RelativeLayoutParameter.LOCATION_LEFT_OF_TOPALIGN:this._finalPositionX-=e.right,this._finalPositionY-=e.top;break;case ccui.RelativeLayoutParameter.LOCATION_LEFT_OF_BOTTOMALIGN:this._finalPositionX-=e.right,this._finalPositionY+=e.bottom;break;case ccui.RelativeLayoutParameter.LOCATION_LEFT_OF_CENTER:this._finalPositionX-=e.right;break;case ccui.RelativeLayoutParameter.LOCATION_RIGHT_OF_TOPALIGN:this._finalPositionX+=e.left,this._finalPositionY-=e.top;break;case ccui.RelativeLayoutParameter.LOCATION_RIGHT_OF_BOTTOMALIGN:this._finalPositionX+=e.left,this._finalPositionY+=e.bottom;break;case ccui.RelativeLayoutParameter.LOCATION_RIGHT_OF_CENTER:this._finalPositionX+=e.left;break;case ccui.RelativeLayoutParameter.LOCATION_BELOW_LEFTALIGN:this._finalPositionY-=e.top,this._finalPositionX+=e.left;break;case ccui.RelativeLayoutParameter.LOCATION_BELOW_RIGHTALIGN:this._finalPositionY-=e.top,this._finalPositionX-=e.right;break;case ccui.RelativeLayoutParameter.LOCATION_BELOW_CENTER:this._finalPositionY-=e.top}}},ccui.HBox=ccui.Layout.extend({ctor:function(t){ccui.Layout.prototype.ctor.call(this),this.setLayoutType(ccui.Layout.LINEAR_HORIZONTAL),t&&this.setContentSize(t)}}),ccui.HBox.create=function(t){return new ccui.HBox(t)},ccui.RelativeBox=ccui.Layout.extend({ctor:function(t){ccui.Layout.prototype.ctor.call(this),this.setLayoutType(ccui.Layout.RELATIVE),t&&this.setContentSize(t)}}),ccui.RelativeBox.create=function(t){return new ccui.RelativeBox(t)},ccui.VBox=ccui.Layout.extend({ctor:function(t){ccui.Layout.prototype.ctor.call(this),this.setLayoutType(ccui.Layout.LINEAR_VERTICAL),t&&this.setContentSize(t)},initWithSize:function(t){return!!this.init()}}),ccui.VBox.create=function(t){return new ccui.VBox(t)},ccui.helper={seekWidgetByTag:function(t,e){if(t){if(t.getTag()===e)return t;for(var i=t.getChildren(),n=i.length,s=0;s<n;s++){var r=ccui.helper.seekWidgetByTag(i[s],e);if(null!==r)return r}}return null},seekWidgetByName:function(t,e){if(t){if(t.getName()===e)return t;for(var i=t.getChildren(),n=i.length,s=0;s<n;s++){var r=ccui.helper.seekWidgetByName(i[s],e);if(null!==r)return r}}return null},seekWidgetByRelativeName:function(t,e){if(t)for(var i=t.getChildren(),n=i.length,s=0;s<n;s++){var r=i[s],o=r.getLayoutParameter(ccui.LayoutParameter.RELATIVE);if(o&&o.getRelativeName()===e)return r}return null},seekActionWidgetByActionTag:function(t,e){if(t){if(t.getActionTag()===e)return t;for(var i=t.getChildren(),n=0;n<i.length;n++){var s=ccui.helper.seekActionWidgetByActionTag(i[n],e);if(null!==s)return s}}return null},_activeLayout:!0,doLayout:function(t){if(this._activeLayout)for(var e=0,i=(t=t.getChildren()).length;e<i;e++){var n,s=(n=t[e]).getComponent(ccui.LayoutComponent.NAME);n=n.getParent(),null!=s&&null!==n&&s.refreshLayout&&s.refreshLayout()}},changeLayoutSystemActiveState:function(t){this._activeLayout=t},restrictCapInsetRect:function(t,e){var i=t.x,n=t.y,s=t.width,t=t.height;return e.width<s&&(s=i=0),e.height<t&&(t=n=0),cc.rect(i,n,s,t)},_createSpriteFromBase64:function(t,e){var i=cc.textureCache.getTextureForKey(e);return i||((i=new Image).src=t,cc.textureCache.cacheImage(e,i),i=cc.textureCache.getTextureForKey(e)),new cc.Sprite(i)}},ccui.Button=ccui.Widget.extend({_buttonScale9Renderer:null,_buttonNormalSpriteFrame:null,_buttonClickedSpriteFrame:null,_buttonDisableSpriteFrame:null,_titleRenderer:null,_normalFileName:"",_clickedFileName:"",_disabledFileName:"",_prevIgnoreSize:!0,_scale9Enabled:!1,_capInsetsNormal:null,_normalTexType:ccui.Widget.LOCAL_TEXTURE,_pressedTexType:ccui.Widget.LOCAL_TEXTURE,_disabledTexType:ccui.Widget.LOCAL_TEXTURE,_normalTextureSize:null,pressedActionEnabled:!1,_titleColor:null,_zoomScale:.1,_normalTextureLoaded:!1,_pressedTextureLoaded:!1,_disabledTextureLoaded:!1,_className:"Button",_normalTextureAdaptDirty:!0,_fontName:"Thonburi",_fontSize:12,_type:0,ctor:function(t,e,i,n){this._capInsetsNormal=cc.rect(0,0,0,0),this._normalTextureSize=cc.size(0,0),ccui.Widget.prototype.ctor.call(this),this.setTouchEnabled(!0),this._normalLoader=new cc.Sprite.LoadManager,this._clickedLoader=new cc.Sprite.LoadManager,this._disabledLoader=new cc.Sprite.LoadManager,t&&this.loadTextures(t,e,i,n)},_createTitleRendererIfNeeded:function(){this._titleRenderer||(this._titleRenderer=new cc.LabelTTF(""),this._titleRenderer.setAnchorPoint(.5,.5),this._titleColor=cc.color.WHITE,this._titleRenderer.setVerticalAlignment(cc.VERTICAL_TEXT_ALIGNMENT_CENTER),this.addProtectedChild(this._titleRenderer,ccui.Button.TITLE_RENDERER_ZORDER,-1))},_initRenderer:function(){this._buttonScale9Renderer=new ccui.Scale9Sprite,this._buttonScale9Renderer.setRenderingType(ccui.Scale9Sprite.RenderingType.SIMPLE),this.addProtectedChild(this._buttonScale9Renderer,ccui.Button.DISABLED_RENDERER_ZORDER,-1)},setScale9Enabled:function(t){this._scale9Enabled!==t&&(this._brightStyle=ccui.Widget.BRIGHT_STYLE_NONE,(this._scale9Enabled=t)?this._buttonScale9Renderer.setRenderingType(ccui.Scale9Sprite.RenderingType.SLICED):this._buttonScale9Renderer.setRenderingType(ccui.Scale9Sprite.RenderingType.SIMPLE),this._scale9Enabled?(t=this._ignoreSize,this.ignoreContentAdaptWithSize(!1),this._prevIgnoreSize=t):this.ignoreContentAdaptWithSize(this._prevIgnoreSize),this.setCapInsets(this._capInsetsNormal),this.setBright(this._bright),this._normalTextureAdaptDirty=!0)},isScale9Enabled:function(){return this._scale9Enabled},ignoreContentAdaptWithSize:function(t){this._unifySize?this._updateContentSize():this._scale9Enabled&&(!this._scale9Enabled||t)||(ccui.Widget.prototype.ignoreContentAdaptWithSize.call(this,t),this._prevIgnoreSize=t)},getVirtualRendererSize:function(){return this._unifySize?this._getNormalSize():!this._normalTextureLoaded&&this._titleRenderer&&0<this._titleRenderer.getString().length?this._titleRenderer.getContentSize():cc.size(this._normalTextureSize)},loadTextures:function(t,e,i,n){this.loadTextureNormal(t,n),this.loadTexturePressed(e,n),this.loadTextureDisabled(i,n)},_createSpriteFrameWithFile:function(t){var e=cc.textureCache.getTextureForKey(t);return(e=e||cc.textureCache.addImage(t))._textureLoaded?(t=e.getContentSize(),t=cc.rect(0,0,t.width,t.height),new cc.SpriteFrame(e,t)):e},_createSpriteFrameWithName:function(t){return null==(t=cc.spriteFrameCache.getSpriteFrame(t))?(cc.log("ccui.Scale9Sprite.initWithSpriteFrameName(): can't find the sprite frame by spriteFrameName"),null):t},loadTextureNormal:function(t,e){if(t){var i;switch(e=e||ccui.Widget.LOCAL_TEXTURE,this._normalFileName=t,this._normalTexType=e,this._normalTexType){case ccui.Widget.LOCAL_TEXTURE:i=this._createSpriteFrameWithFile(t);break;case ccui.Widget.PLIST_TEXTURE:"#"===t[0]&&(t=t.substr(1,t.length-1)),i=this._createSpriteFrameWithName(t)}i&&(i._textureLoaded?(this._normalTextureLoaded=i._textureLoaded,this._buttonNormalSpriteFrame=i,this._buttonScale9Renderer.setSpriteFrame(i),this._scale9Enabled&&this._buttonScale9Renderer.setCapInsets(this._capInsetsNormal),!this._ignoreSize&&cc.sizeEqualToSize(this._customSize,cc.size(0,0))&&(this._customSize=this._buttonScale9Renderer.getContentSize()),this._normalTextureSize=this._buttonScale9Renderer.getContentSize(),this._updateChildrenDisplayedRGBA(),this._unifySize?this._scale9Enabled&&(this._buttonScale9Renderer.setCapInsets(this._capInsetsNormal),this._updateContentSizeWithTextureSize(this._getNormalSize())):this._updateContentSizeWithTextureSize(this._normalTextureSize),this._normalTextureAdaptDirty=!0,this._findLayout()):(this._normalLoader.clear(),this._normalLoader.once(i,function(){this.loadTextureNormal(this._normalFileName,this._normalTexType)},this)))}},loadTexturePressed:function(t,e){if(t){var i;switch(e=e||ccui.Widget.LOCAL_TEXTURE,this._clickedFileName=t,this._pressedTexType=e,this._pressedTexType){case ccui.Widget.LOCAL_TEXTURE:i=this._createSpriteFrameWithFile(t);break;case ccui.Widget.PLIST_TEXTURE:"#"===t[0]&&(t=t.substr(1,t.length-1)),i=this._createSpriteFrameWithName(t)}i&&(i._textureLoaded?(this._buttonClickedSpriteFrame=i,this._updateChildrenDisplayedRGBA(),this._pressedTextureLoaded=!0):(this._clickedLoader.clear(),this._clickedLoader.once(i,function(){this.loadTexturePressed(this._clickedFileName,this._pressedTexType)},this)))}},loadTextureDisabled:function(t,e){if(t){var i;switch(e=e||ccui.Widget.LOCAL_TEXTURE,this._disabledFileName=t,this._disabledTexType=e,this._disabledTexType){case ccui.Widget.LOCAL_TEXTURE:i=this._createSpriteFrameWithFile(t);break;case ccui.Widget.PLIST_TEXTURE:"#"===t[0]&&(t=t.substr(1,t.length-1)),i=this._createSpriteFrameWithName(t)}i&&(i._textureLoaded?(this._buttonDisableSpriteFrame=i,this._updateChildrenDisplayedRGBA(),this._disabledTextureLoaded=!0,this._findLayout()):(this._disabledLoader.clear(),this._disabledLoader.once(i,function(){this.loadTextureDisabled(this._disabledFileName,this._disabledTexType)},this)))}},setCapInsets:function(t){this.setCapInsetsNormalRenderer(t)},setCapInsetsNormalRenderer:function(t){var e,i,n,s;t&&this._scale9Enabled&&(e=t.x,i=t.y,n=t.width,t=t.height,this._normalTextureSize.width<n&&(n=e=0),this._normalTextureSize.height<t&&(t=i=0),(s=this._capInsetsNormal).x=e,s.y=i,s.width=n,s.height=t,this._capInsetsNormal=s,this._buttonScale9Renderer.setCapInsets(s))},getCapInsetsNormalRenderer:function(){return cc.rect(this._capInsetsNormal)},setCapInsetsPressedRenderer:function(t){this.setCapInsetsNormalRenderer(t)},getCapInsetsPressedRenderer:function(){return cc.rect(this._capInsetsNormal)},setCapInsetsDisabledRenderer:function(t){this.setCapInsetsNormalRenderer(t)},getCapInsetsDisabledRenderer:function(){return cc.rect(this._capInsetsNormal)},_onPressStateChangedToNormal:function(){var t;this._buttonScale9Renderer.setSpriteFrame(this._buttonNormalSpriteFrame),this._buttonScale9Renderer.setState(ccui.Scale9Sprite.state.NORMAL),this._pressedTextureLoaded?this.pressedActionEnabled&&(this._buttonScale9Renderer.stopAllActions(),this._buttonScale9Renderer.setScale(1),this._titleRenderer)&&(this._titleRenderer.stopAllActions(),this._unifySize?(t=cc.scaleTo(ccui.Button.ZOOM_ACTION_TIME_STEP,1,1),this._titleRenderer.runAction(t)):(this._titleRenderer.setScaleX(1),this._titleRenderer.setScaleY(1))):(this._buttonScale9Renderer.stopAllActions(),this._buttonScale9Renderer.setScale(1),this._scale9Enabled&&this._buttonScale9Renderer.setColor(cc.color.WHITE),this._titleRenderer&&(this._titleRenderer.stopAllActions(),this._titleRenderer.setScaleX(1),this._titleRenderer.setScaleY(1)))},_onPressStateChangedToPressed:function(){var t;this._buttonScale9Renderer.setState(ccui.Scale9Sprite.state.NORMAL),this._pressedTextureLoaded?(this._buttonScale9Renderer.setSpriteFrame(this._buttonClickedSpriteFrame),this.pressedActionEnabled&&(this._buttonScale9Renderer.stopAllActions(),t=cc.scaleTo(ccui.Button.ZOOM_ACTION_TIME_STEP,1+this._zoomScale,1+this._zoomScale),this._buttonScale9Renderer.runAction(t),this._titleRenderer)&&(this._titleRenderer.stopAllActions(),this._titleRenderer.runAction(cc.scaleTo(ccui.Button.ZOOM_ACTION_TIME_STEP,1+this._zoomScale,1+this._zoomScale)))):(this._buttonScale9Renderer.setSpriteFrame(this._buttonClickedSpriteFrame),this._buttonScale9Renderer.stopAllActions(),this._buttonScale9Renderer.setScale(1+this._zoomScale,1+this._zoomScale),this._titleRenderer&&(this._titleRenderer.stopAllActions(),this._titleRenderer.setScaleX(1+this._zoomScale),this._titleRenderer.setScaleY(1+this._zoomScale)))},_onPressStateChangedToDisabled:function(){this._disabledTextureLoaded?this._buttonScale9Renderer.setSpriteFrame(this._buttonDisableSpriteFrame):this._normalTextureLoaded&&this._buttonScale9Renderer.setState(ccui.Scale9Sprite.state.GRAY),this._buttonScale9Renderer.setScale(1)},_updateContentSize:function(){var t;this._unifySize?(this._scale9Enabled?ccui.ProtectedNode.setContentSize(this._customSize):(t=this._getNormalSize(),ccui.ProtectedNode.setContentSize(t)),this._onSizeChanged()):this._ignoreSize&&this.setContentSize(this.getVirtualRendererSize())},_onSizeChanged:function(){ccui.Widget.prototype._onSizeChanged.call(this),this._titleRenderer&&this._updateTitleLocation(),this._normalTextureAdaptDirty=!0},getVirtualRenderer:function(){return this._buttonScale9Renderer},_normalTextureScaleChangedWithSize:function(){this._buttonScale9Renderer.setContentSize(this._contentSize),this._buttonScale9Renderer.setPosition(this._contentSize.width/2,this._contentSize.height/2)},_adaptRenderers:function(){this._normalTextureAdaptDirty&&(this._normalTextureScaleChangedWithSize(),this._normalTextureAdaptDirty=!1)},_updateTitleLocation:function(){this._titleRenderer.setPosition(.5*this._contentSize.width,.5*this._contentSize.height)},setPressedActionEnabled:function(t){this.pressedActionEnabled=t},setTitleText:function(t){t!==this.getTitleText()&&(this._createTitleRendererIfNeeded(),this._titleRenderer.setString(t),this._ignoreSize?(t=this.getVirtualRendererSize(),this.setContentSize(t)):this._titleRenderer._renderCmd._updateTTF())},getTitleText:function(){return this._titleRenderer?this._titleRenderer.getString():""},setTitleColor:function(t){this._createTitleRendererIfNeeded(),this._titleRenderer.setFontFillColor(t)},getTitleColor:function(){return this._titleRenderer?this._titleRenderer._getFillStyle():cc.color.WHITE},setTitleFontSize:function(t){this._createTitleRendererIfNeeded(),this._titleRenderer.setFontSize(t),this._fontSize=t},getTitleFontSize:function(){return this._titleRenderer?this._titleRenderer.getFontSize():this._fontSize},setZoomScale:function(t){this._zoomScale=t},getZoomScale:function(){return this._zoomScale},getNormalTextureSize:function(){return this._normalTextureSize},setTitleFontName:function(t){this._createTitleRendererIfNeeded(),this._titleRenderer.setFontName(t),this._fontName=t},getTitleRenderer:function(){return this._titleRenderer},getTitleFontName:function(){return this._titleRenderer?this._titleRenderer.getFontName():this._fontName},_setTitleFont:function(t){this._titleRenderer.font=t},_getTitleFont:function(){return this._titleRenderer.font},getDescription:function(){return"Button"},_createCloneInstance:function(){return new ccui.Button},_copySpecialProperties:function(t){this._prevIgnoreSize=t._prevIgnoreSize,this._capInsetsNormal=t._capInsetsNormal,this.setScale9Enabled(t._scale9Enabled),this.loadTextureNormal(t._normalFileName,t._normalTexType),this.loadTexturePressed(t._clickedFileName,t._pressedTexType),this.loadTextureDisabled(t._disabledFileName,t._disabledTexType),t._titleRenderer&&t._titleRenderer._string&&(this.setTitleText(t.getTitleText()),this.setTitleFontName(t.getTitleFontName()),this.setTitleFontSize(t.getTitleFontSize()),this.setTitleColor(t.getTitleColor())),this.setPressedActionEnabled(t.pressedActionEnabled),this.setZoomScale(t._zoomScale)},_getNormalSize:function(){null!==this._titleRenderer&&(t=this._titleRenderer.getContentSize());var t,e=this._buttonScale9Renderer.getContentSize();return cc.size((t.width>e.width?t:e).width,(t.height>e.height?t:e).height)}}),_p=ccui.Button.prototype,cc.defineGetterSetter(_p,"titleText",_p.getTitleText,_p.setTitleText),cc.defineGetterSetter(_p,"titleFont",_p._getTitleFont,_p._setTitleFont),cc.defineGetterSetter(_p,"titleFontSize",_p.getTitleFontSize,_p.setTitleFontSize),cc.defineGetterSetter(_p,"titleFontName",_p.getTitleFontName,_p.setTitleFontName),cc.defineGetterSetter(_p,"titleColor",_p.getTitleColor,_p.setTitleColor),_p=null,ccui.Button.create=function(t,e,i,n){return new ccui.Button(t,e,i,n)},ccui.Button.NORMAL_RENDERER_ZORDER=-2,ccui.Button.PRESSED_RENDERER_ZORDER=-2,ccui.Button.DISABLED_RENDERER_ZORDER=-2,ccui.Button.TITLE_RENDERER_ZORDER=-1,ccui.Button.ZOOM_ACTION_TIME_STEP=.05,ccui.Button.SYSTEM=0,ccui.Button.TTF=1,ccui.CheckBox=ccui.Widget.extend({_backGroundBoxRenderer:null,_backGroundSelectedBoxRenderer:null,_frontCrossRenderer:null,_backGroundBoxDisabledRenderer:null,_frontCrossDisabledRenderer:null,_isSelected:!0,_checkBoxEventListener:null,_checkBoxEventSelector:null,_backGroundTexType:ccui.Widget.LOCAL_TEXTURE,_backGroundSelectedTexType:ccui.Widget.LOCAL_TEXTURE,_frontCrossTexType:ccui.Widget.LOCAL_TEXTURE,_backGroundDisabledTexType:ccui.Widget.LOCAL_TEXTURE,_frontCrossDisabledTexType:ccui.Widget.LOCAL_TEXTURE,_backGroundFileName:"",_backGroundSelectedFileName:"",_frontCrossFileName:"",_backGroundDisabledFileName:"",_frontCrossDisabledFileName:"",_className:"CheckBox",_zoomScale:.1,_backgroundTextureScaleX:.1,_backgroundTextureScaleY:.1,_backGroundBoxRendererAdaptDirty:!0,_backGroundSelectedBoxRendererAdaptDirty:!0,_frontCrossRendererAdaptDirty:!0,_backGroundBoxDisabledRendererAdaptDirty:!0,_frontCrossDisabledRendererAdaptDirty:!0,ctor:function(t,e,i,n,s,r){ccui.Widget.prototype.ctor.call(this),this.setTouchEnabled(!0);for(var o=0,a=0;a<arguments.length;a++){var c=typeof arguments[a];"string"==c?isNaN(+arguments[a])?o++:(r=arguments[a],arguments[a]=void 0):"number"==c&&o++}2===o&&(r=i,i=e,e=void 0),r=void 0===r?0:r,this._isSelected=!0,this.setSelected(!1),this.loadTextures(t,e,i,n,s,r)},_initRenderer:function(){this._backGroundBoxRenderer=new cc.Sprite,this._backGroundSelectedBoxRenderer=new cc.Sprite,this._frontCrossRenderer=new cc.Sprite,this._backGroundBoxDisabledRenderer=new cc.Sprite,this._frontCrossDisabledRenderer=new cc.Sprite,this.addProtectedChild(this._backGroundBoxRenderer,ccui.CheckBox.BOX_RENDERER_ZORDER,-1),this.addProtectedChild(this._backGroundSelectedBoxRenderer,ccui.CheckBox.BOX_SELECTED_RENDERER_ZORDER,-1),this.addProtectedChild(this._frontCrossRenderer,ccui.CheckBox.FRONT_CROSS_RENDERER_ZORDER,-1),this.addProtectedChild(this._backGroundBoxDisabledRenderer,ccui.CheckBox.BOX_DISABLED_RENDERER_ZORDER,-1),this.addProtectedChild(this._frontCrossDisabledRenderer,ccui.CheckBox.FRONT_CROSS_DISABLED_RENDERER_ZORDER,-1)},loadTextures:function(t,e,i,n,s,r){t&&this.loadTextureBackGround(t,r),e&&this.loadTextureBackGroundSelected(e,r),i&&this.loadTextureFrontCross(i,r),n&&this.loadTextureBackGroundDisabled(n,r),s&&this.loadTextureFrontCrossDisabled(s,r)},loadTextureBackGround:function(t,e){if(t){e=e||ccui.Widget.LOCAL_TEXTURE,this._backGroundFileName=t,this._backGroundTexType=e;var i=this._backGroundBoxRenderer;switch(i._textureLoaded?this._backGroundBoxRenderer.setContentSize(this._customSize):i.addEventListener("load",function(){this._updateContentSizeWithTextureSize(this._backGroundBoxRenderer.getContentSize()),this.loadTextureBackGround(this._backGroundFileName,this._backGroundTexType)},this),this._backGroundTexType){case ccui.Widget.LOCAL_TEXTURE:i.initWithFile(t);break;case ccui.Widget.PLIST_TEXTURE:i.initWithSpriteFrameName(t)}this._updateChildrenDisplayedRGBA(),this._updateContentSizeWithTextureSize(this._backGroundBoxRenderer.getContentSize()),this._backGroundBoxRendererAdaptDirty=!0,this._findLayout()}},loadTextureBackGroundSelected:function(t,e){if(t){e=e||ccui.Widget.LOCAL_TEXTURE,this._backGroundSelectedFileName=t,this._backGroundSelectedTexType=e;var i=this._backGroundSelectedBoxRenderer;switch(i._textureLoaded||i.addEventListener("load",function(){this.loadTextureBackGroundSelected(this._backGroundSelectedFileName,this._backGroundSelectedTexType)},this),this._backGroundSelectedTexType){case ccui.Widget.LOCAL_TEXTURE:i.initWithFile(t);break;case ccui.Widget.PLIST_TEXTURE:i.initWithSpriteFrameName(t)}this._updateChildrenDisplayedRGBA(),this._backGroundSelectedBoxRendererAdaptDirty=!0,this._findLayout()}},loadTextureFrontCross:function(t,e){if(t){e=e||ccui.Widget.LOCAL_TEXTURE,this._frontCrossFileName=t,this._frontCrossTexType=e;var i=this._frontCrossRenderer;switch(i._textureLoaded||i.addEventListener("load",function(){this.loadTextureFrontCross(this._frontCrossFileName,this._frontCrossTexType)},this),this._frontCrossTexType){case ccui.Widget.LOCAL_TEXTURE:i.initWithFile(t);break;case ccui.Widget.PLIST_TEXTURE:i.initWithSpriteFrameName(t)}this._updateChildrenDisplayedRGBA(),this._frontCrossRendererAdaptDirty=!0,this._findLayout()}},loadTextureBackGroundDisabled:function(t,e){if(t){e=e||ccui.Widget.LOCAL_TEXTURE,this._backGroundDisabledFileName=t,this._backGroundDisabledTexType=e;var i=this._backGroundBoxDisabledRenderer;switch(i._textureLoaded||i.addEventListener("load",function(){this.loadTextureBackGroundDisabled(this._backGroundDisabledFileName,this._backGroundDisabledTexType)},this),this._backGroundDisabledTexType){case ccui.Widget.LOCAL_TEXTURE:i.initWithFile(t);break;case ccui.Widget.PLIST_TEXTURE:i.initWithSpriteFrameName(t)}this._updateChildrenDisplayedRGBA(),this._backGroundBoxDisabledRendererAdaptDirty=!0,this._findLayout()}},loadTextureFrontCrossDisabled:function(t,e){if(t){e=e||ccui.Widget.LOCAL_TEXTURE,this._frontCrossDisabledFileName=t,this._frontCrossDisabledTexType=e;var i=this._frontCrossDisabledRenderer;switch(i._textureLoaded||i.addEventListener("load",function(){this.loadTextureFrontCrossDisabled(this._frontCrossDisabledFileName,this._frontCrossDisabledTexType)},this),this._frontCrossDisabledTexType){case ccui.Widget.LOCAL_TEXTURE:i.initWithFile(t);break;case ccui.Widget.PLIST_TEXTURE:i.initWithSpriteFrameName(t)}this._updateChildrenDisplayedRGBA(),this._frontCrossDisabledRendererAdaptDirty=!0,this._findLayout()}},_onPressStateChangedToNormal:function(){this._backGroundBoxRenderer.setVisible(!0),this._backGroundSelectedBoxRenderer.setVisible(!1),this._backGroundBoxDisabledRenderer.setVisible(!1),this._frontCrossDisabledRenderer.setVisible(!1),this._backGroundBoxRenderer.setScale(this._backgroundTextureScaleX,this._backgroundTextureScaleY),this._frontCrossRenderer.setScale(this._backgroundTextureScaleX,this._backgroundTextureScaleY),this._isSelected&&(this._frontCrossRenderer.setVisible(!0),this._frontCrossRendererAdaptDirty=!0)},_onPressStateChangedToPressed:function(){this._backGroundSelectedFileName?(this._backGroundBoxRenderer.setVisible(!1),this._backGroundSelectedBoxRenderer.setVisible(!0),this._backGroundBoxDisabledRenderer.setVisible(!1),this._frontCrossDisabledRenderer.setVisible(!1)):(this._backGroundBoxRenderer.setScale(this._backgroundTextureScaleX+this._zoomScale,this._backgroundTextureScaleY+this._zoomScale),this._frontCrossRenderer.setScale(this._backgroundTextureScaleX+this._zoomScale,this._backgroundTextureScaleY+this._zoomScale))},_onPressStateChangedToDisabled:function(){this._backGroundDisabledFileName&&this._frontCrossDisabledFileName&&(this._backGroundBoxRenderer.setVisible(!1),this._backGroundBoxDisabledRenderer.setVisible(!0)),this._backGroundSelectedBoxRenderer.setVisible(!1),this._frontCrossRenderer.setVisible(!1),this._backGroundBoxRenderer.setScale(this._backgroundTextureScaleX,this._backgroundTextureScaleY),this._frontCrossRenderer.setScale(this._backgroundTextureScaleX,this._backgroundTextureScaleY),this._isSelected&&(this._frontCrossDisabledRenderer.setVisible(!0),this._frontCrossDisabledRendererAdaptDirty=!0)},setZoomScale:function(t){this._zoomScale=t},getZoomScale:function(){return this._zoomScale},setSelectedState:function(t){this.setSelected(t)},setSelected:function(t){t!==this._isSelected&&(this._isSelected=t,this._frontCrossRenderer.setVisible(this._isSelected))},getSelectedState:function(){return this.isSelected()},isSelected:function(){return this._isSelected},_selectedEvent:function(){this._checkBoxEventSelector&&(this._checkBoxEventListener?this._checkBoxEventSelector.call(this._checkBoxEventListener,this,ccui.CheckBox.EVENT_SELECTED):this._checkBoxEventSelector(this,ccui.CheckBox.EVENT_SELECTED))},_unSelectedEvent:function(){this._checkBoxEventSelector&&(this._checkBoxEventListener?this._checkBoxEventSelector.call(this._checkBoxEventListener,this,ccui.CheckBox.EVENT_UNSELECTED):this._checkBoxEventSelector(this,ccui.CheckBox.EVENT_UNSELECTED))},_releaseUpEvent:function(){ccui.Widget.prototype._releaseUpEvent.call(this),this._isSelected?(this.setSelected(!1),this._unSelectedEvent()):(this.setSelected(!0),this._selectedEvent())},addEventListenerCheckBox:function(t,e){this.addEventListener(t,e)},addEventListener:function(t,e){this._checkBoxEventSelector=t,this._checkBoxEventListener=e},getVirtualRendererSize:function(){return this._backGroundBoxRenderer.getContentSize()},_onSizeChanged:function(){ccui.Widget.prototype._onSizeChanged.call(this),this._frontCrossDisabledRendererAdaptDirty=this._backGroundBoxDisabledRendererAdaptDirty=this._frontCrossRendererAdaptDirty=this._backGroundSelectedBoxRendererAdaptDirty=this._backGroundBoxRendererAdaptDirty=!0},getVirtualRenderer:function(){return this._backGroundBoxRenderer},_backGroundTextureScaleChangedWithSize:function(){var t=this._backGroundBoxRenderer,e=this._contentSize;if(this._ignoreSize)t.setScale(1),this._backgroundTextureScaleX=this._backgroundTextureScaleY=1;else{if((n=t.getContentSize()).width<=0||n.height<=0)return t.setScale(1),void(this._backgroundTextureScaleX=this._backgroundTextureScaleY=1);var i=e.width/n.width,n=e.height/n.height;this._backgroundTextureScaleX=i,this._backgroundTextureScaleY=n,t.setScaleX(i),t.setScaleY(n)}t.setPosition(.5*e.width,.5*e.height)},_backGroundSelectedTextureScaleChangedWithSize:function(){var t=this._backGroundSelectedBoxRenderer,e=this._contentSize;if(this._ignoreSize)t.setScale(1);else{var i=t.getContentSize();if(i.width<=0||i.height<=0)return void t.setScale(1);var n=e.height/i.height;t.setScaleX(e.width/i.width),t.setScaleY(n)}t.setPosition(.5*e.width,.5*e.height)},_frontCrossTextureScaleChangedWithSize:function(){var t=this._frontCrossRenderer,e=this._contentSize;if(this._ignoreSize)t.setScale(1);else{var i=t.getContentSize();if(i.width<=0||i.height<=0)return void t.setScale(1);var n=e.height/i.height;t.setScaleX(e.width/i.width),t.setScaleY(n)}t.setPosition(.5*e.width,.5*e.height)},_backGroundDisabledTextureScaleChangedWithSize:function(){var t=this._backGroundBoxDisabledRenderer,e=this._contentSize;if(this._ignoreSize)t.setScale(1);else{var i=t.getContentSize();if(i.width<=0||i.height<=0)return void t.setScale(1);var n=e.height/i.height;t.setScaleX(e.width/i.width),t.setScaleY(n)}t.setPosition(.5*e.width,.5*e.height)},_frontCrossDisabledTextureScaleChangedWithSize:function(){var t=this._frontCrossDisabledRenderer,e=this._contentSize;if(this._ignoreSize)t.setScale(1);else{var i=t.getContentSize();if(i.width<=0||i.height<=0)return void t.setScale(1);var n=e.height/i.height;t.setScaleX(e.width/i.width),t.setScaleY(n)}t.setPosition(.5*e.width,.5*e.height)},getDescription:function(){return"CheckBox"},_createCloneInstance:function(){return new ccui.CheckBox},_copySpecialProperties:function(t){t instanceof ccui.CheckBox&&(this.loadTextureBackGround(t._backGroundFileName,t._backGroundTexType),this.loadTextureBackGroundSelected(t._backGroundSelectedFileName,t._backGroundSelectedTexType),this.loadTextureFrontCross(t._frontCrossFileName,t._frontCrossTexType),this.loadTextureBackGroundDisabled(t._backGroundDisabledFileName,t._backGroundDisabledTexType),this.loadTextureFrontCrossDisabled(t._frontCrossDisabledFileName,t._frontCrossDisabledTexType),this.setSelected(t._isSelected),this._checkBoxEventListener=t._checkBoxEventListener,this._checkBoxEventSelector=t._checkBoxEventSelector,this._ccEventCallback=t._ccEventCallback,this._zoomScale=t._zoomScale,this._backgroundTextureScaleX=t._backgroundTextureScaleX,this._backgroundTextureScaleY=t._backgroundTextureScaleY)},_adaptRenderers:function(){this._backGroundBoxRendererAdaptDirty&&(this._backGroundTextureScaleChangedWithSize(),this._backGroundBoxRendererAdaptDirty=!1),this._backGroundSelectedBoxRendererAdaptDirty&&(this._backGroundSelectedTextureScaleChangedWithSize(),this._backGroundSelectedBoxRendererAdaptDirty=!1),this._frontCrossRendererAdaptDirty&&(this._frontCrossTextureScaleChangedWithSize(),this._frontCrossRendererAdaptDirty=!1),this._backGroundBoxDisabledRendererAdaptDirty&&(this._backGroundDisabledTextureScaleChangedWithSize(),this._backGroundBoxDisabledRendererAdaptDirty=!1),this._frontCrossDisabledRendererAdaptDirty&&(this._frontCrossDisabledTextureScaleChangedWithSize(),this._frontCrossDisabledRendererAdaptDirty=!1)}}),_p=ccui.CheckBox.prototype,cc.defineGetterSetter(_p,"selected",_p.isSelected,_p.setSelected),_p=null,ccui.CheckBox.create=function(t,e,i,n,s,r){return new ccui.CheckBox(t,e,i,n,s,r)},ccui.CheckBox.EVENT_SELECTED=0,ccui.CheckBox.EVENT_UNSELECTED=1,ccui.CheckBox.BOX_RENDERER_ZORDER=-1,ccui.CheckBox.BOX_SELECTED_RENDERER_ZORDER=-1,ccui.CheckBox.BOX_DISABLED_RENDERER_ZORDER=-1,ccui.CheckBox.FRONT_CROSS_RENDERER_ZORDER=-1,ccui.CheckBox.FRONT_CROSS_DISABLED_RENDERER_ZORDER=-1,ccui.ImageView=ccui.Widget.extend({_scale9Enabled:!1,_prevIgnoreSize:!0,_capInsets:null,_imageRenderer:null,_textureFile:"",_imageTexType:ccui.Widget.LOCAL_TEXTURE,_imageTextureSize:null,_className:"ImageView",_imageRendererAdaptDirty:!0,ctor:function(t,e){this._capInsets=cc.rect(0,0,0,0),this._imageTextureSize=cc.size(this._capInsets.width,this._capInsets.height),ccui.Widget.prototype.ctor.call(this),t?this.loadTexture(t,void 0===e?0:e):this._imageTexType=ccui.Widget.LOCAL_TEXTURE},_initRenderer:function(){this._imageRenderer=new ccui.Scale9Sprite,this._imageRenderer.setRenderingType(ccui.Scale9Sprite.RenderingType.SIMPLE),this.addProtectedChild(this._imageRenderer,ccui.ImageView.RENDERER_ZORDER,-1)},loadTexture:function(t,e){if(t&&(this._textureFile!=t||this._imageTexType!=e)){var i,n=this,s=(e=e||ccui.Widget.LOCAL_TEXTURE,this._textureFile=t,this._imageTexType=e,n._imageRenderer);switch(n._imageTexType){case ccui.Widget.LOCAL_TEXTURE:n._scale9Enabled?(s.initWithFile(t),s.setCapInsets(n._capInsets)):s.initWithFile(t);break;case ccui.Widget.PLIST_TEXTURE:n._scale9Enabled?(s.initWithSpriteFrameName(t),s.setCapInsets(n._capInsets)):s.initWithSpriteFrameName(t)}s._textureLoaded||(i=function(){s.removeEventListener("load",i),!n._ignoreSize&&cc.sizeEqualToSize(n._customSize,cc.size(0,0))&&(n._customSize=n._imageRenderer.getContentSize()),n._imageTextureSize=s.getContentSize(),n._updateChildrenDisplayedRGBA(),n._updateContentSizeWithTextureSize(n._imageTextureSize)},s.addEventListener("load",i)),!this._ignoreSize&&cc.sizeEqualToSize(this._customSize,cc.size(0,0))&&(this._customSize=this._imageRenderer.getContentSize()),n._imageTextureSize=s.getContentSize(),this._updateChildrenDisplayedRGBA(),n._updateContentSizeWithTextureSize(n._imageTextureSize),n._imageRendererAdaptDirty=!0,n._findLayout()}},setTextureRect:function(){cc.warn("ImageView.setTextureRect  is deprecated!")},setScale9Enabled:function(t){this._scale9Enabled!==t&&((this._scale9Enabled=t)?this._imageRenderer.setRenderingType(ccui.Scale9Sprite.RenderingType.SLICED):this._imageRenderer.setRenderingType(ccui.Scale9Sprite.RenderingType.SIMPLE),this._scale9Enabled?(t=this._ignoreSize,this.ignoreContentAdaptWithSize(!1),this._prevIgnoreSize=t):this.ignoreContentAdaptWithSize(this._prevIgnoreSize),this.setCapInsets(this._capInsets),this._imageRendererAdaptDirty=!0)},isScale9Enabled:function(){return this._scale9Enabled},ignoreContentAdaptWithSize:function(t){this._scale9Enabled&&(!this._scale9Enabled||t)||(ccui.Widget.prototype.ignoreContentAdaptWithSize.call(this,t),this._prevIgnoreSize=t)},setCapInsets:function(t){var e;t&&((e=this._capInsets).x=t.x,e.y=t.y,e.width=t.width,e.height=t.height,this._scale9Enabled)&&this._imageRenderer.setCapInsets(t)},getCapInsets:function(){return cc.rect(this._capInsets)},_onSizeChanged:function(){ccui.Widget.prototype._onSizeChanged.call(this),this._imageRendererAdaptDirty=!0},_adaptRenderers:function(){this._imageRendererAdaptDirty&&(this._imageTextureScaleChangedWithSize(),this._imageRendererAdaptDirty=!1)},getVirtualRendererSize:function(){return cc.size(this._imageTextureSize)},getVirtualRenderer:function(){return this._imageRenderer},_imageTextureScaleChangedWithSize:function(){this._imageRenderer.setContentSize(this._contentSize),this._imageRenderer.setPosition(this._contentSize.width/2,this._contentSize.height/2)},getDescription:function(){return"ImageView"},_createCloneInstance:function(){return new ccui.ImageView},_copySpecialProperties:function(t){t instanceof ccui.ImageView&&(this._prevIgnoreSize=t._prevIgnoreSize,this._capInsets=t._capInsets,this.loadTexture(t._textureFile,t._imageTexType),this.setScale9Enabled(t._scale9Enabled))},setContentSize:function(t,e){e&&(t=cc.size(t,e)),ccui.Widget.prototype.setContentSize.call(this,t),this._imageRenderer.setContentSize(t)}}),ccui.ImageView.create=function(t,e){return new ccui.ImageView(t,e)},ccui.ImageView.RENDERER_ZORDER=-1,ccui.LoadingBar=ccui.Widget.extend({_direction:null,_percent:100,_totalLength:0,_barRenderer:null,_renderBarTexType:ccui.Widget.LOCAL_TEXTURE,_barRendererTextureSize:null,_scale9Enabled:!1,_prevIgnoreSize:!0,_capInsets:null,_textureFile:"",_isTextureLoaded:!1,_className:"LoadingBar",_barRendererAdaptDirty:!0,ctor:function(t,e){this._direction=ccui.LoadingBar.TYPE_LEFT,this._barRendererTextureSize=cc.size(0,0),this._capInsets=cc.rect(0,0,0,0),ccui.Widget.prototype.ctor.call(this),void 0!==t&&this.loadTexture(t),void 0!==e&&this.setPercent(e)},_initRenderer:function(){this._barRenderer=new cc.Sprite,this.addProtectedChild(this._barRenderer,ccui.LoadingBar.RENDERER_ZORDER,-1),this._barRenderer.setAnchorPoint(0,.5)},setDirection:function(t){if(this._direction!==t)switch(this._direction=t,this._direction){case ccui.LoadingBar.TYPE_LEFT:this._barRenderer.setAnchorPoint(0,.5),this._barRenderer.setPosition(0,.5*this._contentSize.height),this._scale9Enabled||this._barRenderer.setFlippedX(!1);break;case ccui.LoadingBar.TYPE_RIGHT:this._barRenderer.setAnchorPoint(1,.5),this._barRenderer.setPosition(this._totalLength,.5*this._contentSize.height),this._scale9Enabled||this._barRenderer.setFlippedX(!0)}},getDirection:function(){return this._direction},loadTexture:function(t,e){if(t){this._renderBarTexType=e=e||ccui.Widget.LOCAL_TEXTURE,this._textureFile=t;var i=this._barRenderer,n=this;switch(i._textureLoaded||i.addEventListener("load",function(){n.loadTexture(n._textureFile,n._renderBarTexType),n._setPercent(n._percent)}),this._renderBarTexType){case ccui.Widget.LOCAL_TEXTURE:i.initWithFile(t);break;case ccui.Widget.PLIST_TEXTURE:i.initWithSpriteFrameName(t)}e=i.getContentSize();switch(this._barRendererTextureSize.width=e.width,this._barRendererTextureSize.height=e.height,this._direction){case ccui.LoadingBar.TYPE_LEFT:i.setAnchorPoint(0,.5),this._scale9Enabled||i.setFlippedX(!1);break;case ccui.LoadingBar.TYPE_RIGHT:i.setAnchorPoint(1,.5),this._scale9Enabled||i.setFlippedX(!0)}this._scale9Enabled&&i.setCapInsets(this._capInsets),this._updateChildrenDisplayedRGBA(),this._barRendererScaleChangedWithSize(),this._updateContentSizeWithTextureSize(this._barRendererTextureSize),this._barRendererAdaptDirty=!0,this._findLayout()}},setScale9Enabled:function(t){this._scale9Enabled!==t&&(this._scale9Enabled=t,this.removeProtectedChild(this._barRenderer),this._barRenderer=new(this._scale9Enabled?ccui.Scale9Sprite:cc.Sprite),this.loadTexture(this._textureFile,this._renderBarTexType),this.addProtectedChild(this._barRenderer,ccui.LoadingBar.RENDERER_ZORDER,-1),this._scale9Enabled?(t=this._ignoreSize,this.ignoreContentAdaptWithSize(!1),this._prevIgnoreSize=t):this.ignoreContentAdaptWithSize(this._prevIgnoreSize),this.setCapInsets(this._capInsets),this.setPercent(this._percent),this._barRendererAdaptDirty=!0)},isScale9Enabled:function(){return this._scale9Enabled},setCapInsets:function(t){var e;t&&((e=this._capInsets).x=t.x,e.y=t.y,e.width=t.width,e.height=t.height,this._scale9Enabled)&&this._barRenderer.setCapInsets(t)},getCapInsets:function(){return cc.rect(this._capInsets)},setPercent:function(t){(t=(t=100<t?100:t)<0?0:t)!==this._percent&&(this._percent=t,this._setPercent(t))},_setPercent:function(){var t,e,i,n;this._totalLength<=0||(t=this._percent/100,this._scale9Enabled?this._setScale9Scale():(i=this._barRenderer,n=this._barRendererTextureSize,(e=i.getTextureRect()).width=n.width*t,i.setTextureRect(cc.rect(e.x,e.y,n.width*t,n.height),i._rectRotated)))},setContentSize:function(t,e){ccui.Widget.prototype.setContentSize.call(this,t,e),this._totalLength=void 0===e?t.width:t},getPercent:function(){return this._percent},_onSizeChanged:function(){ccui.Widget.prototype._onSizeChanged.call(this),this._barRendererAdaptDirty=!0},_adaptRenderers:function(){this._barRendererAdaptDirty&&(this._barRendererScaleChangedWithSize(),this._barRendererAdaptDirty=!1)},ignoreContentAdaptWithSize:function(t){this._scale9Enabled&&(!this._scale9Enabled||t)||(ccui.Widget.prototype.ignoreContentAdaptWithSize.call(this,t),this._prevIgnoreSize=t)},getVirtualRendererSize:function(){return cc.size(this._barRendererTextureSize)},getVirtualRenderer:function(){return this._barRenderer},_barRendererScaleChangedWithSize:function(){var t=this._barRenderer,e=this._contentSize;if(this._unifySize)this._totalLength=this._contentSize.width,this.setPercent(this._percent);else if(this._ignoreSize)this._scale9Enabled||(this._totalLength=this._barRendererTextureSize.width,t.setScale(1));else if(this._totalLength=e.width,this._scale9Enabled)this._setScale9Scale(),t.setScale(1);else{var i=this._barRendererTextureSize;if(i.width<=0||i.height<=0)return void t.setScale(1);var n=e.height/i.height;t.setScaleX(e.width/i.width),t.setScaleY(n)}switch(this._direction){case ccui.LoadingBar.TYPE_LEFT:t.setPosition(0,.5*e.height);break;case ccui.LoadingBar.TYPE_RIGHT:t.setPosition(this._totalLength,.5*e.height)}},_setScale9Scale:function(){this._barRenderer.setPreferredSize(cc.size(this._percent/100*this._totalLength,this._contentSize.height))},getDescription:function(){return"LoadingBar"},_createCloneInstance:function(){return new ccui.LoadingBar},_copySpecialProperties:function(t){t instanceof ccui.LoadingBar&&(this._prevIgnoreSize=t._prevIgnoreSize,this.setScale9Enabled(t._scale9Enabled),this.loadTexture(t._textureFile,t._renderBarTexType),this.setCapInsets(t._capInsets),this.setPercent(t._percent),this.setDirection(t._direction))}}),_p=ccui.LoadingBar.prototype,cc.defineGetterSetter(_p,"direction",_p.getDirection,_p.setDirection),cc.defineGetterSetter(_p,"percent",_p.getPercent,_p.setPercent),_p=null,ccui.LoadingBar.create=function(t,e){return new ccui.LoadingBar(t,e)},ccui.LoadingBar.TYPE_LEFT=0,ccui.LoadingBar.TYPE_RIGHT=1,ccui.LoadingBar.RENDERER_ZORDER=-1,ccui.Slider=ccui.Widget.extend({_barRenderer:null,_progressBarRenderer:null,_barTextureSize:null,_progressBarTextureSize:null,_slidBallNormalRenderer:null,_slidBallPressedRenderer:null,_slidBallDisabledRenderer:null,_slidBallRenderer:null,_barLength:0,_percent:0,_scale9Enabled:!1,_prevIgnoreSize:!0,_textureFile:"",_progressBarTextureFile:"",_slidBallNormalTextureFile:"",_slidBallPressedTextureFile:"",_slidBallDisabledTextureFile:"",_capInsetsBarRenderer:null,_capInsetsProgressBarRenderer:null,_sliderEventListener:null,_sliderEventSelector:null,_barTexType:ccui.Widget.LOCAL_TEXTURE,_progressBarTexType:ccui.Widget.LOCAL_TEXTURE,_ballNTexType:ccui.Widget.LOCAL_TEXTURE,_ballPTexType:ccui.Widget.LOCAL_TEXTURE,_ballDTexType:ccui.Widget.LOCAL_TEXTURE,_isTextureLoaded:!1,_className:"Slider",_barRendererAdaptDirty:!0,_progressBarRendererDirty:!0,_unifySize:!1,_zoomScale:.1,_sliderBallNormalTextureScaleX:1,_sliderBallNormalTextureScaleY:1,ctor:function(t,e,i){this._barTextureSize=cc.size(0,0),this._progressBarTextureSize=cc.size(0,0),this._capInsetsBarRenderer=cc.rect(0,0,0,0),this._capInsetsProgressBarRenderer=cc.rect(0,0,0,0),ccui.Widget.prototype.ctor.call(this),i=i||0,this.setTouchEnabled(!0),t&&this.loadBarTexture(t,i),e&&this.loadSlidBallTextures(e,i)},_initRenderer:function(){this._barRenderer=new cc.Sprite,this._progressBarRenderer=new cc.Sprite,this._progressBarRenderer.setAnchorPoint(0,.5),this.addProtectedChild(this._barRenderer,ccui.Slider.BASEBAR_RENDERER_ZORDER,-1),this.addProtectedChild(this._progressBarRenderer,ccui.Slider.PROGRESSBAR_RENDERER_ZORDER,-1),this._slidBallNormalRenderer=new cc.Sprite,this._slidBallPressedRenderer=new cc.Sprite,this._slidBallPressedRenderer.setVisible(!1),this._slidBallDisabledRenderer=new cc.Sprite,this._slidBallDisabledRenderer.setVisible(!1),this._slidBallRenderer=new cc.Node,this._slidBallRenderer.addChild(this._slidBallNormalRenderer),this._slidBallRenderer.addChild(this._slidBallPressedRenderer),this._slidBallRenderer.addChild(this._slidBallDisabledRenderer),this._slidBallRenderer.setCascadeColorEnabled(!0),this._slidBallRenderer.setCascadeOpacityEnabled(!0),this.addProtectedChild(this._slidBallRenderer,ccui.Slider.BALL_RENDERER_ZORDER,-1)},loadBarTexture:function(t,e){if(t){e=e||ccui.Widget.LOCAL_TEXTURE,this._textureFile=t,this._barTexType=e;var i=this._barRenderer,n=this;switch(i._textureLoaded||i.addEventListener("load",function(){n.loadBarTexture(n._textureFile,n._barTexType)}),this._barTexType){case ccui.Widget.LOCAL_TEXTURE:i.initWithFile(t);break;case ccui.Widget.PLIST_TEXTURE:i.initWithSpriteFrameName(t)}this._updateChildrenDisplayedRGBA(),this._progressBarRendererDirty=this._barRendererAdaptDirty=!0,this._updateContentSizeWithTextureSize(this._barRenderer.getContentSize()),this._findLayout(),this._barTextureSize=this._barRenderer.getContentSize()}},loadProgressBarTexture:function(t,e){if(t){e=e||ccui.Widget.LOCAL_TEXTURE,this._progressBarTextureFile=t,this._progressBarTexType=e;var i=this._progressBarRenderer,n=this;switch(i._textureLoaded||i.addEventListener("load",function(){n.loadProgressBarTexture(n._progressBarTextureFile,n._progressBarTexType)}),this._progressBarTexType){case ccui.Widget.LOCAL_TEXTURE:i.initWithFile(t);break;case ccui.Widget.PLIST_TEXTURE:i.initWithSpriteFrameName(t)}this._updateChildrenDisplayedRGBA(),this._progressBarRenderer.setAnchorPoint(cc.p(0,.5)),i=this._progressBarRenderer.getContentSize(),this._progressBarTextureSize={width:i.width,height:i.height},this._progressBarRendererDirty=!0,this._findLayout()}},setScale9Enabled:function(t){this._scale9Enabled!==t&&(this._scale9Enabled=t,this.removeProtectedChild(this._barRenderer,!0),this.removeProtectedChild(this._progressBarRenderer,!0),this._progressBarRenderer=this._barRenderer=null,this._scale9Enabled?(this._barRenderer=new ccui.Scale9Sprite,this._progressBarRenderer=new ccui.Scale9Sprite):(this._barRenderer=new cc.Sprite,this._progressBarRenderer=new cc.Sprite),this.loadBarTexture(this._textureFile,this._barTexType),this.loadProgressBarTexture(this._progressBarTextureFile,this._progressBarTexType),this.addProtectedChild(this._barRenderer,ccui.Slider.BASEBAR_RENDERER_ZORDER,-1),this.addProtectedChild(this._progressBarRenderer,ccui.Slider.PROGRESSBAR_RENDERER_ZORDER,-1),this._scale9Enabled?(t=this._ignoreSize,this.ignoreContentAdaptWithSize(!1),this._prevIgnoreSize=t):this.ignoreContentAdaptWithSize(this._prevIgnoreSize),this.setCapInsetsBarRenderer(this._capInsetsBarRenderer),this.setCapInsetProgressBarRenderer(this._capInsetsProgressBarRenderer),this._progressBarRendererDirty=this._barRendererAdaptDirty=!0)},isScale9Enabled:function(){return this._scale9Enabled},ignoreContentAdaptWithSize:function(t){this._scale9Enabled&&(!this._scale9Enabled||t)||(ccui.Widget.prototype.ignoreContentAdaptWithSize.call(this,t),this._prevIgnoreSize=t)},setCapInsets:function(t){this.setCapInsetsBarRenderer(t),this.setCapInsetProgressBarRenderer(t)},setCapInsetsBarRenderer:function(t){var e;t&&((e=this._capInsetsBarRenderer).x=t.x,e.y=t.y,e.width=t.width,e.height=t.height,this._scale9Enabled)&&this._barRenderer.setCapInsets(t)},getCapInsetsBarRenderer:function(){return cc.rect(this._capInsetsBarRenderer)},setCapInsetProgressBarRenderer:function(t){var e;t&&((e=this._capInsetsProgressBarRenderer).x=t.x,e.y=t.y,e.width=t.width,e.height=t.height,this._scale9Enabled)&&this._progressBarRenderer.setCapInsets(t)},getCapInsetsProgressBarRenderer:function(){return cc.rect(this._capInsetsProgressBarRenderer)},loadSlidBallTextures:function(t,e,i,n){this.loadSlidBallTextureNormal(t,n),this.loadSlidBallTexturePressed(e,n),this.loadSlidBallTextureDisabled(i,n)},loadSlidBallTextureNormal:function(t,e){if(t){e=e||ccui.Widget.LOCAL_TEXTURE,this._slidBallNormalTextureFile=t,this._ballNTexType=e;var i=this;switch(this._slidBallNormalRenderer._textureLoaded||this._slidBallNormalRenderer.addEventListener("load",function(){i.loadSlidBallTextureNormal(i._slidBallNormalTextureFile,i._ballNTexType)}),this._ballNTexType){case ccui.Widget.LOCAL_TEXTURE:this._slidBallNormalRenderer.initWithFile(t);break;case ccui.Widget.PLIST_TEXTURE:this._slidBallNormalRenderer.initWithSpriteFrameName(t)}this._updateChildrenDisplayedRGBA(),this._findLayout()}},loadSlidBallTexturePressed:function(t,e){if(t){e=e||ccui.Widget.LOCAL_TEXTURE,this._slidBallPressedTextureFile=t,this._ballPTexType=e;var i=this;switch(this._slidBallPressedRenderer._textureLoaded||this._slidBallPressedRenderer.addEventListener("load",function(){i.loadSlidBallTexturePressed(i._slidBallPressedTextureFile,i._ballPTexType)}),this._ballPTexType){case ccui.Widget.LOCAL_TEXTURE:this._slidBallPressedRenderer.initWithFile(t);break;case ccui.Widget.PLIST_TEXTURE:this._slidBallPressedRenderer.initWithSpriteFrameName(t)}this._updateChildrenDisplayedRGBA(),this._findLayout()}},loadSlidBallTextureDisabled:function(t,e){if(t){e=e||ccui.Widget.LOCAL_TEXTURE,this._slidBallDisabledTextureFile=t,this._ballDTexType=e;var i=this;switch(this._slidBallDisabledRenderer._textureLoaded||this._slidBallDisabledRenderer.addEventListener("load",function(){i.loadSlidBallTextureDisabled(i._slidBallDisabledTextureFile,i._ballDTexType)}),this._ballDTexType){case ccui.Widget.LOCAL_TEXTURE:this._slidBallDisabledRenderer.initWithFile(t);break;case ccui.Widget.PLIST_TEXTURE:this._slidBallDisabledRenderer.initWithSpriteFrameName(t)}this._updateChildrenDisplayedRGBA(),this._findLayout()}},setPercent:function(t){var e,i;t=(this._percent=t=(t=100<t?100:t)<0?0:t)/100*this._barLength,this._slidBallRenderer.setPosition(t,this._contentSize.height/2),this._scale9Enabled?this._progressBarRenderer.setPreferredSize(cc.size(t,this._contentSize.height)):(i=(e=this._progressBarRenderer).getTextureRect(),e.setTextureRect(cc.rect(i.x,i.y,t/e._scaleX,i.height),e.isTextureRectRotated()))},hitTest:function(t){t=this._slidBallNormalRenderer.convertToNodeSpace(t);var e=this._slidBallNormalRenderer.getContentSize(),e=cc.rect(0,0,e.width,e.height);return t.x>=e.x&&t.x<=e.x+e.width&&t.y>=e.y&&t.y<=e.y+e.height},onTouchBegan:function(t,e){t=ccui.Widget.prototype.onTouchBegan.call(this,t,e);return this._hit&&(e=this.convertToNodeSpace(this._touchBeganPosition),this.setPercent(this._getPercentWithBallPos(e.x)),this._percentChangedEvent()),t},onTouchMoved:function(t,e){t=t.getLocation(),t=this.convertToNodeSpace(t);this.setPercent(this._getPercentWithBallPos(t.x)),this._percentChangedEvent()},onTouchEnded:function(t,e){ccui.Widget.prototype.onTouchEnded.call(this,t,e)},onTouchCancelled:function(t,e){ccui.Widget.prototype.onTouchCancelled.call(this,t,e)},_getPercentWithBallPos:function(t){return t/this._barLength*100},addEventListenerSlider:function(t,e){this.addEventListener(t,e)},addEventListener:function(t,e){this._sliderEventSelector=t,this._sliderEventListener=e},_percentChangedEvent:function(){this._sliderEventSelector&&(this._sliderEventListener?this._sliderEventSelector.call(this._sliderEventListener,this,ccui.Slider.EVENT_PERCENT_CHANGED):this._sliderEventSelector(this,ccui.Slider.EVENT_PERCENT_CHANGED)),this._ccEventCallback&&this._ccEventCallback(this,ccui.Slider.EVENT_PERCENT_CHANGED)},getPercent:function(){return this._percent},_onSizeChanged:function(){ccui.Widget.prototype._onSizeChanged.call(this),this._progressBarRendererDirty=this._barRendererAdaptDirty=!0},_adaptRenderers:function(){this._barRendererAdaptDirty&&(this._barRendererScaleChangedWithSize(),this._barRendererAdaptDirty=!1),this._progressBarRendererDirty&&(this._progressBarRendererScaleChangedWithSize(),this._progressBarRendererDirty=!1)},getVirtualRendererSize:function(){return this._barRenderer.getContentSize()},getVirtualRenderer:function(){return this._barRenderer},_barRendererScaleChangedWithSize:function(){var t,e;this._unifySize?(this._barLength=this._contentSize.width,this._barRenderer.setPreferredSize(this._contentSize)):this._ignoreSize?(this._barRenderer.setScale(1),this._barLength=this._contentSize.width):(this._barLength=this._contentSize.width,this._scale9Enabled?(this._barRenderer.setPreferredSize(this._contentSize),this._barRenderer.setScale(1)):(t=this._barTextureSize).width<=0||t.height<=0?this._barRenderer.setScale(1):(e=this._contentSize.height/t.height,this._barRenderer.setScaleX(this._contentSize.width/t.width),this._barRenderer.setScaleY(e))),this._barRenderer.setPosition(this._contentSize.width/2,this._contentSize.height/2),this.setPercent(this._percent)},_progressBarRendererScaleChangedWithSize:function(){if(this._unifySize)this._progressBarRenderer.setPreferredSize(this._contentSize);else if(this._ignoreSize){var t,e;this._scale9Enabled||(e=this._progressBarTextureSize,t=this._contentSize.width/e.width,e=this._contentSize.height/e.height,this._progressBarRenderer.setScaleX(t),this._progressBarRenderer.setScaleY(e))}else if(this._scale9Enabled)this._progressBarRenderer.setPreferredSize(this._contentSize),this._progressBarRenderer.setScale(1);else{if((e=this._progressBarTextureSize).width<=0||e.height<=0)return void this._progressBarRenderer.setScale(1);t=this._contentSize.width/e.width,e=this._contentSize.height/e.height,this._progressBarRenderer.setScaleX(t),this._progressBarRenderer.setScaleY(e)}this._progressBarRenderer.setPosition(0,this._contentSize.height/2),this.setPercent(this._percent)},_onPressStateChangedToNormal:function(){this._slidBallNormalRenderer.setVisible(!0),this._slidBallPressedRenderer.setVisible(!1),this._slidBallDisabledRenderer.setVisible(!1),this._slidBallNormalRenderer.setScale(this._sliderBallNormalTextureScaleX,this._sliderBallNormalTextureScaleY),cc._renderType===cc.game.RENDER_TYPE_WEBGL&&(this._slidBallNormalRenderer._renderCmd._shaderProgram=this._getNormalGLProgram())},_onPressStateChangedToPressed:function(){this._slidBallPressedTextureFile?(this._slidBallNormalRenderer.setVisible(!1),this._slidBallPressedRenderer.setVisible(!0),this._slidBallDisabledRenderer.setVisible(!1)):this._slidBallNormalRenderer.setScale(this._sliderBallNormalTextureScaleX+this._zoomScale,this._sliderBallNormalTextureScaleY+this._zoomScale),cc._renderType===cc.game.RENDER_TYPE_WEBGL&&(this._slidBallNormalRenderer._renderCmd._shaderProgram=this._getNormalGLProgram())},_onPressStateChangedToDisabled:function(){this._slidBallDisabledTextureFile?(this._slidBallNormalRenderer.setVisible(!1),this._slidBallDisabledRenderer.setVisible(!0)):(this._slidBallNormalRenderer.setVisible(!0),cc._renderType===cc.game.RENDER_TYPE_WEBGL&&(this._slidBallNormalRenderer._renderCmd._shaderProgram=this._getGrayGLProgram())),this._slidBallNormalRenderer.setScale(this._sliderBallNormalTextureScaleX,this._sliderBallNormalTextureScaleY),this._slidBallPressedRenderer.setVisible(!1)},setZoomScale:function(t){this._zoomScale=t},getZoomScale:function(){return this._zoomScale},getSlidBallNormalRenderer:function(){return this._slidBallNormalRenderer},getSlidBallPressedRenderer:function(){return this._slidBallPressedRenderer},getSlidBallDisabledRenderer:function(){return this._slidBallDisabledRenderer},getSlidBallRenderer:function(){return this._slidBallRenderer},getDescription:function(){return"Slider"},_createCloneInstance:function(){return new ccui.Slider},_copySpecialProperties:function(t){this._prevIgnoreSize=t._prevIgnoreSize,this.setScale9Enabled(t._scale9Enabled),this.loadBarTexture(t._textureFile,t._barTexType),this.loadProgressBarTexture(t._progressBarTextureFile,t._progressBarTexType),this.loadSlidBallTextureNormal(t._slidBallNormalTextureFile,t._ballNTexType),this.loadSlidBallTexturePressed(t._slidBallPressedTextureFile,t._ballPTexType),this.loadSlidBallTextureDisabled(t._slidBallDisabledTextureFile,t._ballDTexType),this.setPercent(t.getPercent()),this._sliderEventListener=t._sliderEventListener,this._sliderEventSelector=t._sliderEventSelector,this._zoomScale=t._zoomScale,this._ccEventCallback=t._ccEventCallback}}),_p=ccui.Slider.prototype,cc.defineGetterSetter(_p,"percent",_p.getPercent,_p.setPercent),_p=null,ccui.Slider.create=function(t,e,i){return new ccui.Slider(t,e,i)},ccui.Slider.EVENT_PERCENT_CHANGED=0,ccui.Slider.BASEBAR_RENDERER_ZORDER=-3,ccui.Slider.PROGRESSBAR_RENDERER_ZORDER=-2,ccui.Slider.BALL_RENDERER_ZORDER=-1,ccui.Text=ccui.Widget.extend({_touchScaleChangeEnabled:!1,_normalScaleValueX:1,_normalScaleValueY:1,_fontName:"Arial",_fontSize:16,_onSelectedScaleOffset:.5,_labelRenderer:null,_textAreaSize:null,_textVerticalAlignment:0,_textHorizontalAlignment:0,_className:"Text",_type:null,_labelRendererAdaptDirty:!0,ctor:function(t,e,i){this._type=ccui.Text.Type.SYSTEM,this._textAreaSize=cc.size(0,0),ccui.Widget.prototype.ctor.call(this),void 0!==i?(this.setFontName(e),this.setFontSize(i),this.setString(t)):this.setFontName(this._fontName)},_initRenderer:function(){this._labelRenderer=new cc.LabelTTF,this.addProtectedChild(this._labelRenderer,ccui.Text.RENDERER_ZORDER,-1)},setText:function(t){cc.log("Please use the setString"),this.setString(t)},setString:function(t){t!==this._labelRenderer.getString()&&(this._setString(t),this._updateContentSizeWithTextureSize(this._labelRenderer.getContentSize()))},_setString:function(t){this._labelRenderer.setString(t),this._labelRendererAdaptDirty=!0},getStringValue:function(){return cc.log("Please use the getString"),this._labelRenderer.getString()},getString:function(){return this._labelRenderer.getString()},getStringLength:function(){return this._labelRenderer.getStringLength()},setFontSize:function(t){this._setFontSize(t),this._updateContentSizeWithTextureSize(this._labelRenderer.getContentSize())},_setFontSize:function(t){this._labelRenderer.setFontSize(t),this._fontSize=t,this._labelRendererAdaptDirty=!0},getFontSize:function(){return this._fontSize},setFontName:function(t){this._setFontName(t),this._updateContentSizeWithTextureSize(this._labelRenderer.getContentSize())},_setFontName:function(t){this._fontName=t,this._labelRenderer.setFontName(t),this._labelRendererAdaptDirty=!0},_updateUITextContentSize:function(){this._updateContentSizeWithTextureSize(this._labelRenderer.getContentSize())},getFontName:function(){return this._fontName},_setFont:function(t){var e=cc.LabelTTF._fontStyleRE.exec(t);e&&(this._fontSize=parseInt(e[1]),this._fontName=e[2],this._labelRenderer._setFont(t),this._labelScaleChangedWithSize())},_getFont:function(){return this._labelRenderer._getFont()},getType:function(){return this._type},setTextAreaSize:function(t){this._setTextAreaSize(t),this._updateContentSizeWithTextureSize(this._labelRenderer.getContentSize())},_setTextAreaSize:function(t){this._labelRenderer.setDimensions(t),this._ignoreSize||(this._customSize=t),this._labelRendererAdaptDirty=!0},getTextAreaSize:function(){return this._labelRenderer.getDimensions()},setTextHorizontalAlignment:function(t){this._setTextHorizontalAlignment(t),this._updateContentSizeWithTextureSize(this._labelRenderer.getContentSize())},_setTextHorizontalAlignment:function(t){this._labelRenderer.setHorizontalAlignment(t),this._labelRendererAdaptDirty=!0},getTextHorizontalAlignment:function(){return this._labelRenderer.getHorizontalAlignment()},setTextVerticalAlignment:function(t){this._setTextVerticalAlignment(t),this._updateContentSizeWithTextureSize(this._labelRenderer.getContentSize())},_setTextVerticalAlignment:function(t){this._labelRenderer.setVerticalAlignment(t),this._labelRendererAdaptDirty=!0},getTextVerticalAlignment:function(){return this._labelRenderer.getVerticalAlignment()},setTouchScaleChangeEnabled:function(t){this._touchScaleChangeEnabled=t},isTouchScaleChangeEnabled:function(){return this._touchScaleChangeEnabled},_onPressStateChangedToNormal:function(){this._touchScaleChangeEnabled&&(this._labelRenderer.setScaleX(this._normalScaleValueX),this._labelRenderer.setScaleY(this._normalScaleValueY))},_onPressStateChangedToPressed:function(){this._touchScaleChangeEnabled&&(this._labelRenderer.setScaleX(this._normalScaleValueX+this._onSelectedScaleOffset),this._labelRenderer.setScaleY(this._normalScaleValueY+this._onSelectedScaleOffset))},_onPressStateChangedToDisabled:function(){},_onSizeChanged:function(){ccui.Widget.prototype._onSizeChanged.call(this),this._labelRendererAdaptDirty=!0},_adaptRenderers:function(){this._labelRendererAdaptDirty&&(this._labelScaleChangedWithSize(),this._labelRendererAdaptDirty=!1)},getVirtualRendererSize:function(){return this._labelRenderer.getContentSize()},getVirtualRenderer:function(){return this._labelRenderer},getAutoRenderSize:function(){var t=this._labelRenderer.getContentSize();return this._ignoreSize||(this._labelRenderer.setDimensions(0,0),t=this._labelRenderer.getContentSize(),this._labelRenderer.setDimensions(this._contentSize.width,this._contentSize.height)),t},_labelScaleChangedWithSize:function(){var t=this._contentSize;if(this._ignoreSize)this._labelRenderer.setScale(1),this._normalScaleValueX=this._normalScaleValueY=1;else{if(this._labelRenderer.setDimensions(cc.size(t.width,t.height)),(i=this._labelRenderer.getContentSize()).width<=0||i.height<=0)return void this._labelRenderer.setScale(1);var e=t.width/i.width,i=t.height/i.height;this._labelRenderer.setScaleX(e),this._labelRenderer.setScaleY(i),this._normalScaleValueX=e,this._normalScaleValueY=i}this._labelRenderer.setPosition(t.width/2,t.height/2)},getDescription:function(){return"Label"},enableShadow:function(t,e,i){this._labelRenderer.enableShadow(t,e,i)},enableOutline:function(t,e){this._labelRenderer.enableStroke(t,e)},enableGlow:function(t){this._type===ccui.Text.Type.TTF&&this._labelRenderer.enableGlow(t)},disableEffect:function(){this._labelRenderer.disableEffect&&this._labelRenderer.disableEffect()},_createCloneInstance:function(){return new ccui.Text},_copySpecialProperties:function(t){t instanceof ccui.Text&&(this.setFontName(t._fontName),this.setFontSize(t.getFontSize()),this.setString(t.getString()),this.setTouchScaleChangeEnabled(t.touchScaleEnabled),this.setTextAreaSize(t._textAreaSize),this.setTextHorizontalAlignment(t._labelRenderer.getHorizontalAlignment()),this.setTextVerticalAlignment(t._labelRenderer.getVerticalAlignment()),this.setContentSize(t.getContentSize()),this.setTextColor(t.getTextColor()))},_setBoundingWidth:function(t){this._textAreaSize.width=t,this._labelRenderer._setBoundingWidth(t),this._labelScaleChangedWithSize()},_setBoundingHeight:function(t){this._textAreaSize.height=t,this._labelRenderer._setBoundingHeight(t),this._labelScaleChangedWithSize()},_getBoundingWidth:function(){return this._textAreaSize.width},_getBoundingHeight:function(){return this._textAreaSize.height},_changePosition:function(){this._adaptRenderers()},setColor:function(t){cc.ProtectedNode.prototype.setColor.call(this,t),this._labelRenderer.setColor(t)},setTextColor:function(t){this._labelRenderer.setFontFillColor(t)},getTextColor:function(){return this._labelRenderer._getFillStyle()}}),_p=ccui.Text.prototype,cc.defineGetterSetter(_p,"boundingWidth",_p._getBoundingWidth,_p._setBoundingWidth),cc.defineGetterSetter(_p,"boundingHeight",_p._getBoundingHeight,_p._setBoundingHeight),cc.defineGetterSetter(_p,"string",_p.getString,_p.setString),cc.defineGetterSetter(_p,"stringLength",_p.getStringLength),cc.defineGetterSetter(_p,"font",_p._getFont,_p._setFont),cc.defineGetterSetter(_p,"fontSize",_p.getFontSize,_p.setFontSize),cc.defineGetterSetter(_p,"fontName",_p.getFontName,_p.setFontName),cc.defineGetterSetter(_p,"textAlign",_p.getTextHorizontalAlignment,_p.setTextHorizontalAlignment),cc.defineGetterSetter(_p,"verticalAlign",_p.getTextVerticalAlignment,_p.setTextVerticalAlignment),_p=null,ccui.Label=ccui.Text.create=function(t,e,i){return new ccui.Text(t,e,i)},ccui.Text.RENDERER_ZORDER=-1,ccui.Text.Type={SYSTEM:0,TTF:1},ccui.TextAtlas=ccui.Widget.extend({_labelAtlasRenderer:null,_stringValue:"",_charMapFileName:"",_itemWidth:0,_itemHeight:0,_startCharMap:"",_className:"TextAtlas",_labelAtlasRendererAdaptDirty:null,ctor:function(t,e,i,n,s){ccui.Widget.prototype.ctor.call(this),void 0!==s&&this.setProperty(t,e,i,n,s)},_initRenderer:function(){this._labelAtlasRenderer=new cc.LabelAtlas,this._labelAtlasRenderer.setAnchorPoint(cc.p(.5,.5)),this.addProtectedChild(this._labelAtlasRenderer,ccui.TextAtlas.RENDERER_ZORDER,-1),this._labelAtlasRenderer.addEventListener("load",function(){this._updateContentSizeWithTextureSize(this._labelAtlasRenderer.getContentSize()),this._findLayout()},this)},setProperty:function(t,e,i,n,s){this._stringValue=t,this._charMapFileName=e,this._itemWidth=i,this._itemHeight=n,this._startCharMap=s,this._labelAtlasRenderer.initWithString(t,this._charMapFileName,this._itemWidth,this._itemHeight,this._startCharMap[0]),this._updateContentSizeWithTextureSize(this._labelAtlasRenderer.getContentSize()),this._labelAtlasRendererAdaptDirty=!0},setString:function(t){t!==this._labelAtlasRenderer.getString()&&(this._stringValue=t,this._labelAtlasRenderer.setString(t),this._updateContentSizeWithTextureSize(this._labelAtlasRenderer.getContentSize()),this._labelAtlasRendererAdaptDirty=!0)},setStringValue:function(t){cc.log("Please use the setString"),this.setString(t)},getStringValue:function(){return cc.log("Please use the getString"),this.getString()},getString:function(){return this._labelAtlasRenderer.getString()},getStringLength:function(){return this._labelAtlasRenderer.getStringLength()},_onSizeChanged:function(){ccui.Widget.prototype._onSizeChanged.call(this),this._labelAtlasRendererAdaptDirty=!0},_adaptRenderers:function(){this._labelAtlasRendererAdaptDirty&&(this._labelAtlasScaleChangedWithSize(),this._labelAtlasRendererAdaptDirty=!1)},getVirtualRendererSize:function(){return this._labelAtlasRenderer.getContentSize()},getVirtualRenderer:function(){return this._labelAtlasRenderer},_labelAtlasScaleChangedWithSize:function(){var t=this._labelAtlasRenderer;if(this._ignoreSize)t.setScale(1);else{var e=t.getContentSize();if(e.width<=0||e.height<=0)return void t.setScale(1);t.setScaleX(this._contentSize.width/e.width),t.setScaleY(this._contentSize.height/e.height)}t.setPosition(this._contentSize.width/2,this._contentSize.height/2)},getDescription:function(){return"LabelAtlas"},_copySpecialProperties:function(t){t&&this.setProperty(t._stringValue,t._charMapFileName,t._itemWidth,t._itemHeight,t._startCharMap)},_createCloneInstance:function(){return new ccui.TextAtlas}}),_p=ccui.TextAtlas.prototype,cc.defineGetterSetter(_p,"string",_p.getString,_p.setString),_p=null,ccui.TextAtlas.create=function(t,e,i,n,s){return new ccui.TextAtlas(t,e,i,n,s)},ccui.TextAtlas.RENDERER_ZORDER=-1,ccui.LabelBMFont=ccui.TextBMFont=ccui.Widget.extend({_labelBMFontRenderer:null,_fntFileHasInit:!1,_fntFileName:"",_stringValue:"",_className:"TextBMFont",_labelBMFontRendererAdaptDirty:!0,ctor:function(t,e){ccui.Widget.prototype.ctor.call(this),this._loader=new cc.Sprite.LoadManager,void 0!==e&&(this.setFntFile(e),this.setString(t))},_initRenderer:function(){this._labelBMFontRenderer=new cc.LabelBMFont,this.addProtectedChild(this._labelBMFontRenderer,ccui.TextBMFont.RENDERER_ZORDER,-1)},setFntFile:function(t){var e;t&&(this._fntFileName=t,this._fntFileHasInit=!0,this._labelBMFontRenderer.initWithString(this._stringValue,t),this._updateContentSizeWithTextureSize(this._labelBMFontRenderer.getContentSize()),this._labelBMFontRendererAdaptDirty=!0,(t=(e=this)._labelBMFontRenderer)._textureLoaded||t.addEventListener("load",function(){e.setFntFile(e._fntFileName)}))},setText:function(t){cc.log("Please use the setString"),this.setString(t)},setString:function(t){this._loader.clear(),this._labelBMFontRenderer._textureLoaded?t!==this._labelBMFontRenderer.getString()&&(this._stringValue=t,this._labelBMFontRenderer.setString(t),this._fntFileHasInit)&&(this._updateContentSizeWithTextureSize(this._labelBMFontRenderer.getContentSize()),this._labelBMFontRendererAdaptDirty=!0):this._loader.add(this._labelBMFontRenderer,function(){this.setString(t)},this)},getString:function(){return this._stringValue},getStringLength:function(){return this._labelBMFontRenderer.getStringLength()},_onSizeChanged:function(){ccui.Widget.prototype._onSizeChanged.call(this),this._labelBMFontRendererAdaptDirty=!0},_adaptRenderers:function(){this._labelBMFontRendererAdaptDirty&&(this._labelBMFontScaleChangedWithSize(),this._labelBMFontRendererAdaptDirty=!1)},getVirtualRendererSize:function(){return this._labelBMFontRenderer.getContentSize()},getVirtualRenderer:function(){return this._labelBMFontRenderer},_labelBMFontScaleChangedWithSize:function(){var t=this._labelBMFontRenderer;if(this._ignoreSize)t.setScale(1);else{var e=t.getContentSize();if(e.width<=0||e.height<=0)return void t.setScale(1);t.setScaleX(this._contentSize.width/e.width),t.setScaleY(this._contentSize.height/e.height)}t.setPosition(this._contentSize.width/2,this._contentSize.height/2)},getDescription:function(){return"TextBMFont"},_createCloneInstance:function(){return new ccui.TextBMFont},_copySpecialProperties:function(t){this.setFntFile(t._fntFileName),this.setString(t._stringValue)}}),_p=ccui.TextBMFont.prototype,cc.defineGetterSetter(_p,"string",_p.getString,_p.setString),_p=null,ccui.TextBMFont.create=function(t,e){return new ccui.TextBMFont(t,e)},ccui.TextBMFont.RENDERER_ZORDER=-1,ccui._TextFieldRenderer=cc.TextFieldTTF.extend({_maxLengthEnabled:!1,_maxLength:0,_passwordEnabled:!1,_passwordStyleText:"",_attachWithIME:!1,_detachWithIME:!1,_insertText:!1,_deleteBackward:!1,_className:"_TextFieldRenderer",ctor:function(){cc.TextFieldTTF.prototype.ctor.call(this),this._maxLengthEnabled=!1,this._maxLength=0,this._passwordEnabled=!1,this._passwordStyleText="*",this._deleteBackward=this._insertText=this._detachWithIME=this._attachWithIME=!1},onEnter:function(){cc.TextFieldTTF.prototype.onEnter.call(this),cc.TextFieldTTF.prototype.setDelegate.call(this,this)},onTextFieldAttachWithIME:function(t){return this.setAttachWithIME(!0),!1},onTextFieldInsertText:function(t,e,i){return(1!==i||"\n"!==e)&&(this.setInsertText(!0),this._maxLengthEnabled)&&cc.TextFieldTTF.prototype.getCharCount.call(this)>=this._maxLength},onTextFieldDeleteBackward:function(t,e,i){return this.setDeleteBackward(!0),!1},onTextFieldDetachWithIME:function(t){return this.setDetachWithIME(!0),!1},insertText:function(t,e){"\n"!==t&&this._maxLengthEnabled&&this.getString().length>=this._maxLength?this._passwordEnabled&&this.setPasswordText(this.getString()):(cc.TextFieldTTF.prototype.insertText.call(this,t,e),this._passwordEnabled&&0<cc.TextFieldTTF.prototype.getCharCount.call(this)&&this.setPasswordText(this.getString()))},deleteBackward:function(){cc.TextFieldTTF.prototype.deleteBackward.call(this),0<cc.TextFieldTTF.prototype.getCharCount.call(this)&&this._passwordEnabled&&this.setPasswordText(this._inputText)},openIME:function(){cc.TextFieldTTF.prototype.attachWithIME.call(this)},closeIME:function(){cc.TextFieldTTF.prototype.detachWithIME.call(this)},setMaxLengthEnabled:function(t){this._maxLengthEnabled=t},isMaxLengthEnabled:function(){return this._maxLengthEnabled},setMaxLength:function(t){this._maxLength=t},getMaxLength:function(){return this._maxLength},getCharCount:function(){return cc.TextFieldTTF.prototype.getCharCount.call(this)},setPasswordEnabled:function(t){this._passwordEnabled=t},isPasswordEnabled:function(){return this._passwordEnabled},setPasswordStyleText:function(t){var e;1<t.length||(e=t.charCodeAt(0))<33||126<e||(this._passwordStyleText=t)},setPasswordText:function(t){var e="",i=t.length;for(t=i,this._maxLengthEnabled&&i>this._maxLength&&(t=this._maxLength),i=0;i<t;++i)e+=this._passwordStyleText;cc.LabelTTF.prototype.setString.call(this,e)},setAttachWithIME:function(t){this._attachWithIME=t},getAttachWithIME:function(){return this._attachWithIME},setDetachWithIME:function(t){this._detachWithIME=t},getDetachWithIME:function(){return this._detachWithIME},setInsertText:function(t){this._insertText=t},getInsertText:function(){return this._insertText},setDeleteBackward:function(t){this._deleteBackward=t},getDeleteBackward:function(){return this._deleteBackward},onDraw:function(t){return!1}}),ccui._TextFieldRenderer.create=function(t,e,i){var n=new ccui._TextFieldRenderer;return n&&n.initWithString("",e,i)?(t&&n.setPlaceHolder(t),n):null},ccui.TextField=ccui.Widget.extend({_textFieldRenderer:null,_touchWidth:0,_touchHeight:0,_useTouchArea:!1,_textFieldEventListener:null,_textFieldEventSelector:null,_passwordStyleText:"",_textFieldRendererAdaptDirty:!0,_fontName:"",_fontSize:12,_ccEventCallback:null,ctor:function(t,e,i){ccui.Widget.prototype.ctor.call(this),this.setTouchEnabled(!0),e&&this.setFontName(e),i&&this.setFontSize(i),t&&this.setPlaceHolder(t)},onEnter:function(){ccui.Widget.prototype.onEnter.call(this),this.scheduleUpdate()},_initRenderer:function(){this._textFieldRenderer=ccui._TextFieldRenderer.create("input words here","Thonburi",20),this.addProtectedChild(this._textFieldRenderer,ccui.TextField.RENDERER_ZORDER,-1)},setTouchSize:function(t){this._touchWidth=t.width,this._touchHeight=t.height},setTouchAreaEnabled:function(t){this._useTouchArea=t},hitTest:function(t){var e;return this._useTouchArea?(t=this.convertToNodeSpace(t),e=cc.rect(-this._touchWidth*this._anchorPoint.x,-this._touchHeight*this._anchorPoint.y,this._touchWidth,this._touchHeight),t.x>=e.x&&t.x<=e.x+e.width&&t.y>=e.y&&t.y<=e.y+e.height):ccui.Widget.prototype.hitTest.call(this,t)},getTouchSize:function(){return cc.size(this._touchWidth,this._touchHeight)},setText:function(t){cc.log("Please use the setString"),this.setString(t)},setString:function(t){null!=t&&(t=String(t),this.isMaxLengthEnabled()&&(t=t.substr(0,this.getMaxLength())),this.isPasswordEnabled()?(this._textFieldRenderer.setPasswordText(t),this._textFieldRenderer.setString(""),this._textFieldRenderer.insertText(t,t.length)):this._textFieldRenderer.setString(t),this._textFieldRendererAdaptDirty=!0,this._updateContentSizeWithTextureSize(this._textFieldRenderer.getContentSize()))},setPlaceHolder:function(t){this._textFieldRenderer.setPlaceHolder(t),this._textFieldRendererAdaptDirty=!0,this._updateContentSizeWithTextureSize(this._textFieldRenderer.getContentSize())},getPlaceHolder:function(){return this._textFieldRenderer.getPlaceHolder()},getPlaceHolderColor:function(){return this._textFieldRenderer.getPlaceHolderColor()},setPlaceHolderColor:function(t){this._textFieldRenderer.setColorSpaceHolder(t)},setTextColor:function(t){this._textFieldRenderer.setTextColor(t)},setFontSize:function(t){this._textFieldRenderer.setFontSize(t),this._fontSize=t,this._textFieldRendererAdaptDirty=!0,this._updateContentSizeWithTextureSize(this._textFieldRenderer.getContentSize())},getFontSize:function(){return this._fontSize},setFontName:function(t){this._textFieldRenderer.setFontName(t),this._fontName=t,this._textFieldRendererAdaptDirty=!0,this._updateContentSizeWithTextureSize(this._textFieldRenderer.getContentSize())},getFontName:function(){return this._fontName},didNotSelectSelf:function(){this._textFieldRenderer.detachWithIME()},getStringValue:function(){return cc.log("Please use the getString"),this.getString()},getString:function(){return this._textFieldRenderer.getString()},getStringLength:function(){return this._textFieldRenderer.getStringLength()},onTouchBegan:function(t,e){var i=this,t=ccui.Widget.prototype.onTouchBegan.call(i,t,e);return i._hit?setTimeout(function(){i._textFieldRenderer.attachWithIME()},0):setTimeout(function(){i._textFieldRenderer.detachWithIME()},0),t},setMaxLengthEnabled:function(t){this._textFieldRenderer.setMaxLengthEnabled(t)},isMaxLengthEnabled:function(){return this._textFieldRenderer.isMaxLengthEnabled()},setMaxLength:function(t){this._textFieldRenderer.setMaxLength(t),this.setString(this.getString())},getMaxLength:function(){return this._textFieldRenderer.getMaxLength()},setPasswordEnabled:function(t){this._textFieldRenderer.setPasswordEnabled(t)},isPasswordEnabled:function(){return this._textFieldRenderer.isPasswordEnabled()},setPasswordStyleText:function(t){this._textFieldRenderer.setPasswordStyleText(t),this._passwordStyleText=t,this.setString(this.getString())},getPasswordStyleText:function(){return this._passwordStyleText},update:function(t){this.getDetachWithIME()&&(this._detachWithIMEEvent(),this.setDetachWithIME(!1)),this.getAttachWithIME()&&(this._attachWithIMEEvent(),this.setAttachWithIME(!1)),this.getInsertText()&&(this._textFieldRendererAdaptDirty=!0,this._updateContentSizeWithTextureSize(this._textFieldRenderer.getContentSize()),this._insertTextEvent(),this.setInsertText(!1)),this.getDeleteBackward()&&(this._textFieldRendererAdaptDirty=!0,this._updateContentSizeWithTextureSize(this._textFieldRenderer.getContentSize()),this._deleteBackwardEvent(),this.setDeleteBackward(!1))},getAttachWithIME:function(){return this._textFieldRenderer.getAttachWithIME()},setAttachWithIME:function(t){this._textFieldRenderer.setAttachWithIME(t)},getDetachWithIME:function(){return this._textFieldRenderer.getDetachWithIME()},setDetachWithIME:function(t){this._textFieldRenderer.setDetachWithIME(t)},getInsertText:function(){return this._textFieldRenderer.getInsertText()},setInsertText:function(t){this._textFieldRenderer.setInsertText(t)},getDeleteBackward:function(){return this._textFieldRenderer.getDeleteBackward()},setDeleteBackward:function(t){this._textFieldRenderer.setDeleteBackward(t)},_attachWithIMEEvent:function(){this._textFieldEventSelector&&(this._textFieldEventListener?this._textFieldEventSelector.call(this._textFieldEventListener,this,ccui.TextField.EVENT_ATTACH_WITH_IME):this._textFieldEventSelector(this,ccui.TextField.EVENT_ATTACH_WITH_IME)),this._ccEventCallback&&this._ccEventCallback(this,ccui.TextField.EVENT_ATTACH_WITH_IME)},_detachWithIMEEvent:function(){this._textFieldEventSelector&&(this._textFieldEventListener?this._textFieldEventSelector.call(this._textFieldEventListener,this,ccui.TextField.EVENT_DETACH_WITH_IME):this._textFieldEventSelector(this,ccui.TextField.EVENT_DETACH_WITH_IME)),this._ccEventCallback&&this._ccEventCallback(this,ccui.TextField.EVENT_DETACH_WITH_IME)},_insertTextEvent:function(){this._textFieldEventSelector&&(this._textFieldEventListener?this._textFieldEventSelector.call(this._textFieldEventListener,this,ccui.TextField.EVENT_INSERT_TEXT):this._textFieldEventSelector(this,ccui.TextField.EVENT_INSERT_TEXT)),this._ccEventCallback&&this._ccEventCallback(this,ccui.TextField.EVENT_INSERT_TEXT)},_deleteBackwardEvent:function(){this._textFieldEventSelector&&(this._textFieldEventListener?this._textFieldEventSelector.call(this._textFieldEventListener,this,ccui.TextField.EVENT_DELETE_BACKWARD):this._textFieldEventSelector(this,ccui.TextField.EVENT_DELETE_BACKWARD)),this._ccEventCallback&&this._ccEventCallback(this,ccui.TextField.EVENT_DELETE_BACKWARD)},addEventListenerTextField:function(t,e){this.addEventListener(t,e)},addEventListener:function(t,e){this._textFieldEventSelector=t,this._textFieldEventListener=e},_onSizeChanged:function(){ccui.Widget.prototype._onSizeChanged.call(this),this._textFieldRendererAdaptDirty=!0},_adaptRenderers:function(){this._textFieldRendererAdaptDirty&&(this._textfieldRendererScaleChangedWithSize(),this._textFieldRendererAdaptDirty=!1)},_textfieldRendererScaleChangedWithSize:function(){this._ignoreSize||this._textFieldRenderer.setDimensions(this._contentSize),this._textFieldRenderer.setPosition(this._contentSize.width/2,this._contentSize.height/2)},getAutoRenderSize:function(){var t=this._textFieldRenderer.getContentSize();return this._ignoreSize||(this._textFieldRenderer.setDimensions(0,0),t=this._textFieldRenderer.getContentSize(),this._textFieldRenderer.setDimensions(this._contentSize.width,this._contentSize.height)),t},getVirtualRendererSize:function(){return this._textFieldRenderer.getContentSize()},getVirtualRenderer:function(){return this._textFieldRenderer},getDescription:function(){return"TextField"},attachWithIME:function(){this._textFieldRenderer.attachWithIME()},_createCloneInstance:function(){return new ccui.TextField},_copySpecialProperties:function(t){this.setString(t._textFieldRenderer.getString()),this.setPlaceHolder(t.getString()),this.setFontSize(t._textFieldRenderer.getFontSize()),this.setFontName(t._textFieldRenderer.getFontName()),this.setMaxLengthEnabled(t.isMaxLengthEnabled()),this.setMaxLength(t.getMaxLength()),this.setPasswordEnabled(t.isPasswordEnabled()),this.setPasswordStyleText(t._passwordStyleText),this.setAttachWithIME(t.getAttachWithIME()),this.setDetachWithIME(t.getDetachWithIME()),this.setInsertText(t.getInsertText()),this.setDeleteBackward(t.getDeleteBackward()),this._ccEventCallback=t._ccEventCallback,this._textFieldEventListener=t._textFieldEventListener,this._textFieldEventSelector=t._textFieldEventSelector},setTextAreaSize:function(t){this.setContentSize(t)},setTextHorizontalAlignment:function(t){this._textFieldRenderer.setHorizontalAlignment(t)},setTextVerticalAlignment:function(t){this._textFieldRenderer.setVerticalAlignment(t)},_setFont:function(t){this._textFieldRenderer._setFont(t),this._textFieldRendererAdaptDirty=!0},_getFont:function(){return this._textFieldRenderer._getFont()},_changePosition:function(){this._adaptRenderers()}}),ccui.TextField.create=function(t,e,i){return new ccui.TextField(t,e,i)},_p=ccui.TextField.prototype,cc.defineGetterSetter(_p,"string",_p.getString,_p.setString),cc.defineGetterSetter(_p,"placeHolder",_p.getPlaceHolder,_p.setPlaceHolder),cc.defineGetterSetter(_p,"font",_p._getFont,_p._setFont),cc.defineGetterSetter(_p,"fontSize",_p.getFontSize,_p.setFontSize),cc.defineGetterSetter(_p,"fontName",_p.getFontName,_p.setFontName),cc.defineGetterSetter(_p,"maxLengthEnabled",_p.isMaxLengthEnabled,_p.setMaxLengthEnabled),cc.defineGetterSetter(_p,"maxLength",_p.getMaxLength,_p.setMaxLength),cc.defineGetterSetter(_p,"passwordEnabled",_p.isPasswordEnabled,_p.setPasswordEnabled),_p=null,ccui.TextField.EVENT_ATTACH_WITH_IME=0,ccui.TextField.EVENT_DETACH_WITH_IME=1,ccui.TextField.EVENT_INSERT_TEXT=2,ccui.TextField.EVENT_DELETE_BACKWARD=3,ccui.TextField.RENDERER_ZORDER=-1,ccui.VideoPlayer=ccui.Widget.extend({_played:!1,_playing:!1,_stopped:!0,ctor:function(t){ccui.Widget.prototype.ctor.call(this),this._EventList={},t&&this.setURL(t)},_createRenderCmd:function(){return new ccui.VideoPlayer.RenderCmd(this)},visit:function(){var t=this._renderCmd,e=cc.container,i=cc.eventManager;this._visible?(e.appendChild(t._video),null===this._listener&&(this._listener=cc.eventManager.addCustomListener(cc.game.EVENT_RESIZE,function(){t.resize()}))):(("contains"in e?e.contains(t._video):e.compareDocumentPosition(t._video)%16)&&e.removeChild(t._video),i.removeListener(t._listener),t._listener=null),t.updateStatus(),t.resize()},setURL:function(t){this._renderCmd.updateURL(t)},getURL:function(){return this._renderCmd._url},play:function(){var t=this,e=this._renderCmd._video;e&&(this._played=!0,e.pause(),!1===this._stopped&&!1===this._playing&&!0===this._played||(e.currentTime=0),ccui.VideoPlayer._polyfill.autoplayAfterOperation?setTimeout(function(){e.play(),t._playing=!0,t._stopped=!1},20):(e.play(),this._playing=!0,this._stopped=!1))},pause:function(){var t=this._renderCmd._video;t&&!0===this._playing&&!1===this._stopped&&(t.pause(),this._playing=!1)},resume:function(){!1===this._stopped&&!1===this._playing&&!0===this._played&&this.play()},stop:function(){var t=this,e=this._renderCmd._video;e&&(e.pause(),e.currentTime=0,this._playing=!1,this._stopped=!0),setTimeout(function(){t._dispatchEvent(ccui.VideoPlayer.EventType.STOPPED)},0)},seekTo:function(t){var e=this._renderCmd._video;e&&(e.currentTime=t,ccui.VideoPlayer._polyfill.autoplayAfterOperation)&&this.isPlaying()&&setTimeout(function(){e.play()},20)},isPlaying:function(){return ccui.VideoPlayer._polyfill.autoplayAfterOperation&&this._playing&&setTimeout(function(){video.play()},20),this._playing},setKeepAspectRatioEnabled:function(t){cc.log("On the web is always keep the aspect ratio")},isKeepAspectRatioEnabled:function(){return!1},setFullScreenEnabled:function(t){var e=this._renderCmd._video;e&&(t?cc.screen.requestFullScreen(e):cc.screen.exitFullScreen(e))},isFullScreenEnabled:function(){cc.log("Can't know status")},setEventListener:function(t,e){this._EventList[t]=e},removeEventListener:function(t){this._EventList[t]=null},_dispatchEvent:function(t){(t=this._EventList[t])&&t.call(this,this,this._renderCmd._video.src)},onPlayEvent:function(){var t=this._EventList[ccui.VideoPlayer.EventType.PLAYING];if(t)for(var e=0;e<t.length;e++)t[e].call(this,this,this._renderCmd._video.src)},setContentSize:function(t,e){ccui.Widget.prototype.setContentSize.call(this,t,e),void 0===e&&(e=t.height,t=t.width),this._renderCmd.changeSize(t,e)},cleanup:function(){this._renderCmd.removeDom(),this.stopAllActions(),this.unscheduleAllCallbacks()},onEnter:function(){ccui.Widget.prototype.onEnter.call(this);var t=ccui.VideoPlayer.elements;-1===t.indexOf(this)&&t.push(this)},onExit:function(){ccui.Widget.prototype.onExit.call(this);var t=ccui.VideoPlayer.elements,e=t.indexOf(this);-1!==e&&t.splice(e,1)}}),ccui.VideoPlayer.elements=[],ccui.VideoPlayer.pauseElements=[],cc.eventManager.addCustomListener(cc.game.EVENT_HIDE,function(){for(var t,e=ccui.VideoPlayer.elements,i=0;i<e.length;i++)t=e[i],e[i]._playing&&(t.pause(),ccui.VideoPlayer.pauseElements.push(t))}),cc.eventManager.addCustomListener(cc.game.EVENT_SHOW,function(){for(var t=ccui.VideoPlayer.pauseElements,e=t.pop();e;)e.play(),e=t.pop()}),ccui.VideoPlayer.EventType={PLAYING:"play",PAUSED:"pause",STOPPED:"stop",COMPLETED:"complete"},!function(t){t._polyfill={devicePixelRatio:!1,event:"canplay",canPlayType:[]};var e=document.createElement("video");e.canPlayType("video/ogg")&&(t._polyfill.canPlayType.push(".ogg"),t._polyfill.canPlayType.push(".ogv")),e.canPlayType("video/mp4")&&t._polyfill.canPlayType.push(".mp4"),e.canPlayType("video/webm")&&t._polyfill.canPlayType.push(".webm"),cc.sys.OS_IOS===cc.sys.os&&(t._polyfill.devicePixelRatio=!0,t._polyfill.event="progress"),cc.sys.browserType===cc.sys.BROWSER_TYPE_FIREFOX&&(t._polyfill.autoplayAfterOperation=!0),(t=document.createElement("style")).innerHTML=".cocosVideo:-moz-full-screen{transform:matrix(1,0,0,1,0,0) !important;}.cocosVideo:full-screen{transform:matrix(1,0,0,1,0,0) !important;}.cocosVideo:-webkit-full-screen{transform:matrix(1,0,0,1,0,0) !important;}",document.head.appendChild(t)}(ccui.VideoPlayer),!function(c){var t=null,t=cc._renderType===cc.game.RENDER_TYPE_WEBGL?cc.Node.WebGLRenderCmd:cc.Node.CanvasRenderCmd;ccui.VideoPlayer.RenderCmd=function(t){this._rootCtor(t),this._listener=null,this._url="",this.initStyle()},(t=ccui.VideoPlayer.RenderCmd.prototype=Object.create(t.prototype)).constructor=ccui.VideoPlayer.RenderCmd,t.transform=function(t,e){this.originTransform(t,e),this.updateMatrix(this._worldTransform,cc.view._scaleX,cc.view._scaleY)},t.updateStatus=function(){c.devicePixelRatio=cc.view.isRetinaEnabled();var t=cc.Node._dirtyFlags,e=this._dirtyFlag;e&t.transformDirty&&(this.transform(this.getParentRenderCmd(),!0),this.updateMatrix(this._worldTransform,cc.view._scaleX,cc.view._scaleY),this._dirtyFlag^=this._dirtyFlag&cc.Node._dirtyFlags.transformDirty),e&t.orderDirty&&(this._dirtyFlag^=this._dirtyFlag&t.orderDirty)},t.resize=function(t){t=t||cc.view;var e=this._node,i=cc.eventManager;e._parent&&e._visible?this.updateMatrix(this._worldTransform,t._scaleX,t._scaleY):(i.removeListener(this._listener),this._listener=null)},t.updateMatrix=function(t,e,i){var n,s,r,o,a=this._node;c.devicePixelRatio&&(e/=n=cc.view.getDevicePixelRatio(),i/=n),!1!==this._loaded&&(s=cc.game.container.style,n=parseInt(s.paddingLeft),s=parseInt(s.paddingBottom),r=a._contentSize.width,o=a._contentSize.height,t="matrix("+t.a*e+","+t.b+","+t.c+","+t.d*i+","+(n+t.tx*e-r/2+r*a._scaleX/2*e)+","+-(s+t.ty*i-o/2+o*a._scaleY/2*i)+")",this._video.style.transform=t,this._video.style["-webkit-transform"]=t)},t.updateURL=function(t){var e,i,n=this._node;if(this._url!=t){this._url=t,cc.loader.resPath&&!/^http/.test(t)&&(t=cc.path.join(cc.loader.resPath,t)),e=!1,(e="contains"in(o=cc.container)?o.contains(this._video):o.compareDocumentPosition(this._video)%16)&&o.removeChild(this._video),i=this._video=document.createElement("video"),this.bindEvent();var s=this,r=function(){1!=s._loaded&&(s._loaded=!0,s.changeSize(),s.setDirtyFlag(cc.Node._dirtyFlags.transformDirty),i.removeEventListener(c.event,r),i.currentTime=0,i.style.visibility="visible",i.play(),n._played||(i.pause(),i.currentTime=0))};i.addEventListener(c.event,r),i.preload="metadata",i.style.visibility="hidden",this._loaded=!1,n._played=!1,n._playing=!1,n._stopped=!0,this.initStyle(),this._node.visit(),(e=document.createElement("source")).src=t,i.appendChild(e);for(var o=cc.path.extname(t),a=0;a<c.canPlayType.length;a++)o!==c.canPlayType[a]&&((e=document.createElement("source")).src=t.replace(o,c.canPlayType[a]),i.appendChild(e))}},t.bindEvent=function(){var t=this,e=this._node,i=this._video;i.addEventListener("ended",function(){e._renderCmd.updateMatrix(t._worldTransform,cc.view._scaleX,cc.view._scaleY),e._playing=!1,e._dispatchEvent(ccui.VideoPlayer.EventType.COMPLETED)}),i.addEventListener("play",function(){e._dispatchEvent(ccui.VideoPlayer.EventType.PLAYING)}),i.addEventListener("pause",function(){e._dispatchEvent(ccui.VideoPlayer.EventType.PAUSED)})},t.initStyle=function(){var t;this._video&&((t=this._video).style.position="absolute",t.style.bottom="0px",t.style.left="0px",t.className="cocosVideo")},t.changeSize=function(t,e){var i=this._node._contentSize;t=t||i.width,e=e||i.height,(i=this._video)&&(0!==t&&(i.width=t),0!==e)&&(i.height=e)},t.removeDom=function(){var t=this._video;t&&("contains"in cc.container?cc.container.contains(t):cc.container.compareDocumentPosition(t)%16)&&cc.container.removeChild(t)}}(ccui.VideoPlayer._polyfill),ccui.RichElement=ccui.Class.extend({_type:0,_tag:0,_color:null,_opacity:0,ctor:function(t,e,i){this._type=0,this._tag=t||0,this._color=cc.color(255,255,255,255),e&&(this._color.r=e.r,this._color.g=e.g,this._color.b=e.b),this._opacity=i||0,this._color.a=void 0===i?e.a:i}}),ccui.RichElementText=ccui.RichElement.extend({_text:"",_fontName:"",_fontSize:0,_fontDefinition:null,ctor:function(t,e,i,n,s,r){var o=e;e&&e instanceof cc.FontDefinition&&(o=e.fillStyle,s=e.fontName,r=e.fontSize,this._fontDefinition=e),ccui.RichElement.prototype.ctor.call(this,t,o,i),this._type=ccui.RichElement.TEXT,this._text=n,this._fontName=s,this._fontSize=r}}),ccui.RichElementText.create=function(t,e,i,n,s,r){return new ccui.RichElementText(t,e,i,n,s,r)},ccui.RichElementImage=ccui.RichElement.extend({_filePath:"",_textureRect:null,_textureType:0,ctor:function(t,e,i,n){ccui.RichElement.prototype.ctor.call(this,t,e,i),this._type=ccui.RichElement.IMAGE,this._filePath=n||"",this._textureRect=cc.rect(0,0,0,0),this._textureType=0}}),ccui.RichElementImage.create=function(t,e,i,n){return new ccui.RichElementImage(t,e,i,n)},ccui.RichElementCustomNode=ccui.RichElement.extend({_customNode:null,ctor:function(t,e,i,n){ccui.RichElement.prototype.ctor.call(this,t,e,i),this._type=ccui.RichElement.CUSTOM,this._customNode=n||null}}),ccui.RichElementCustomNode.create=function(t,e,i,n){return new ccui.RichElementCustomNode(t,e,i,n)},ccui.RichText=ccui.Widget.extend({_formatTextDirty:!1,_richElements:null,_elementRenders:null,_leftSpaceWidth:0,_verticalSpace:0,_elementRenderersContainer:null,_lineBreakOnSpace:!1,_textHorizontalAlignment:null,_textVerticalAlignment:null,ctor:function(){ccui.Widget.prototype.ctor.call(this),this._formatTextDirty=!1,this._richElements=[],this._elementRenders=[],this._verticalSpace=this._leftSpaceWidth=0,this._textHorizontalAlignment=cc.TEXT_ALIGNMENT_LEFT,this._textVerticalAlignment=cc.VERTICAL_TEXT_ALIGNMENT_TOP},_initRenderer:function(){this._elementRenderersContainer=new cc.Node,this._elementRenderersContainer.setAnchorPoint(.5,.5),this.addProtectedChild(this._elementRenderersContainer,0,-1)},insertElement:function(t,e){this._richElements.splice(e,0,t),this._formatTextDirty=!0},pushBackElement:function(t){this._richElements.push(t),this._formatTextDirty=!0},removeElement:function(t){cc.isNumber(t)?this._richElements.splice(t,1):cc.arrayRemoveObject(this._richElements,t),this._formatTextDirty=!0},formatText:function(){if(this._formatTextDirty){this._elementRenderersContainer.removeAllChildren(),this._elementRenders.length=0;var t,e=this._richElements;if(this._ignoreSize)for(this._addNewLine(),t=0;t<e.length;t++){var i,n=null;switch((i=e[t])._type){case ccui.RichElement.TEXT:n=i._fontDefinition?new cc.LabelTTF(i._text,i._fontDefinition):new cc.LabelTTF(i._text,i._fontName,i._fontSize);break;case ccui.RichElement.IMAGE:n=new cc.Sprite(i._filePath);break;case ccui.RichElement.CUSTOM:n=i._customNode}n.setColor(i._color),n.setOpacity(i._color.a),this._pushToContainer(n)}else for(this._addNewLine(),t=0;t<e.length;t++)switch(i=e[t],i._type){case ccui.RichElement.TEXT:i._fontDefinition?this._handleTextRenderer(i._text,i._fontDefinition,i._fontDefinition.fontSize,i._fontDefinition.fillStyle):this._handleTextRenderer(i._text,i._fontName,i._fontSize,i._color);break;case ccui.RichElement.IMAGE:this._handleImageRenderer(i._filePath,i._color,i._color.a);break;case ccui.RichElement.CUSTOM:this._handleCustomRenderer(i._customNode)}this.formatRenderers(),this._formatTextDirty=!1}},_handleTextRenderer:function(t,e,i,n){var s,r,o,a;""!==t&&("\n"===t?this._addNewLine():(r=(s=e instanceof cc.FontDefinition?new cc.LabelTTF(t,e):new cc.LabelTTF(t,e,i)).getContentSize().width,this._leftSpaceWidth-=r,this._leftSpaceWidth<0?(s=t.length*(1- -this._leftSpaceWidth/r),r=t.substr(0,s),o=t.substr(s,t.length-1),a=0<s,this._lineBreakOnSpace&&(o=r.lastIndexOf(" "),o=t.substr(s=-1===o?s:o+1,t.length-1),a=0<s&&" "!==o),a&&(t=null,e instanceof cc.FontDefinition?(t=new cc.LabelTTF(r.substr(0,s),e)).setOpacity(e.fillStyle.a):((t=new cc.LabelTTF(r.substr(0,s),e,i)).setColor(n),t.setOpacity(n.a)),this._pushToContainer(t)),this._addNewLine(),this._handleTextRenderer(o,e,i,n)):(e instanceof cc.FontDefinition?s.setOpacity(e.fillStyle.a):(s.setColor(n),s.setOpacity(n.a)),this._pushToContainer(s))))},_handleImageRenderer:function(t,e,i){t=new cc.Sprite(t),this._handleCustomRenderer(t)},_handleCustomRenderer:function(t){var e=t.getContentSize();this._leftSpaceWidth-=e.width,this._leftSpaceWidth<0?(this._addNewLine(),this._pushToContainer(t),this._leftSpaceWidth-=e.width):this._pushToContainer(t)},_addNewLine:function(){this._leftSpaceWidth=this._customSize.width,this._elementRenders.push([])},formatRenderers:function(){var t,e,i,n,s,r=0,o=this._elementRenderersContainer,a=this._elementRenders;if(this._ignoreSize){for(e=a[h=0],t=i=0;t<e.length;t++)(n=e[t]).setAnchorPoint(cc.p(0,0)),n.setPosition(i,0),o.addChild(n,1,t),s=n.getLineHeight?n.getLineHeight():r,h+=(n=n.getContentSize()).width,r=Math.max(Math.min(r,s),n.height),i+=n.width;if(this._textHorizontalAlignment!==cc.TEXT_ALIGNMENT_LEFT)for(s=0,this._textHorizontalAlignment===cc.TEXT_ALIGNMENT_RIGHT?s=this._contentSize.width-i:this._textHorizontalAlignment===cc.TEXT_ALIGNMENT_CENTER&&(s=(this._contentSize.width-i)/2),t=0;t<e.length;t++)e[t].x+=s;o.setContentSize(h,r)}else{for(var c=[],h=0;h<a.length;h++){for(e=a[h],t=i=0;t<e.length;t++)s=(n=e[t]).getLineHeight?n.getLineHeight():n.getContentSize().height,i=Math.max(Math.min(n.getContentSize().height,s),i);c[h]=i,r+=c[h]}var l=this._customSize.height;for(h=0;h<a.length;h++){for(e=a[h],l-=c[h]+this._verticalSpace,t=i=0;t<e.length;t++)(n=e[t]).setAnchorPoint(cc.p(0,0)),n.setPosition(cc.p(i,l)),o.addChild(n,1),i+=n.getContentSize().width;if(this._textHorizontalAlignment!==cc.TEXT_ALIGNMENT_LEFT||this._textVerticalAlignment!==cc.VERTICAL_TEXT_ALIGNMENT_TOP)for(s=0,this._textHorizontalAlignment===cc.TEXT_ALIGNMENT_RIGHT?s=this._contentSize.width-i:this._textHorizontalAlignment===cc.TEXT_ALIGNMENT_CENTER&&(s=(this._contentSize.width-i)/2),i=0,this._textVerticalAlignment===cc.VERTICAL_TEXT_ALIGNMENT_BOTTOM?i=this._customSize.height-r:this._textVerticalAlignment===cc.VERTICAL_TEXT_ALIGNMENT_CENTER&&(i=(this._customSize.height-r)/2),t=0;t<e.length;t++)(n=e[t]).x+=s,n.y-=i}o.setContentSize(this._contentSize)}for(r=a.length,h=0;h<r;h++)a[h].length=0;this._elementRenders.length=0,this.setContentSize(this._ignoreSize?this.getVirtualRendererSize():this._customSize),this._updateContentSizeWithTextureSize(this._contentSize),o.setPosition(.5*this._contentSize.width,.5*this._contentSize.height)},_pushToContainer:function(t){this._elementRenders.length<=0||this._elementRenders[this._elementRenders.length-1].push(t)},_adaptRenderers:function(){this.formatText()},setVerticalSpace:function(t){this._verticalSpace=t},setAnchorPoint:function(t){ccui.Widget.prototype.setAnchorPoint.call(this,t),this._elementRenderersContainer.setAnchorPoint(t)},_setAnchorX:function(t){ccui.Widget.prototype._setAnchorX.call(this,t),this._elementRenderersContainer._setAnchorX(t)},_setAnchorY:function(t){ccui.Widget.prototype._setAnchorY.call(this,t),this._elementRenderersContainer._setAnchorY(t)},getVirtualRendererSize:function(){return this._elementRenderersContainer.getContentSize()},ignoreContentAdaptWithSize:function(t){this._ignoreSize!==t&&(this._formatTextDirty=!0,ccui.Widget.prototype.ignoreContentAdaptWithSize.call(this,t))},getContentSize:function(){return this.formatText(),cc.Node.prototype.getContentSize.call(this)},_getWidth:function(){return this.formatText(),cc.Node.prototype._getWidth.call(this)},_getHeight:function(){return this.formatText(),cc.Node.prototype._getHeight.call(this)},setContentSize:function(t,e){ccui.Widget.prototype.setContentSize.call(this,void 0===e?t.width:t,void 0===e?t.height:e),this._formatTextDirty=!0},getDescription:function(){return"RichText"},setCascadeOpacityEnabled:function(t){ccui.Widget.prototype.setCascadeOpacityEnabled.call(this,t),this._elementRenderersContainer.setCascadeOpacityEnabled(t)},setLineBreakOnSpace:function(t){this._lineBreakOnSpace=t,this._formatTextDirty=!0,this.formatText()},setTextHorizontalAlignment:function(t){t!==this._textHorizontalAlignment&&(this._textHorizontalAlignment=t,this.formatText())},setTextVerticalAlignment:function(t){t!==this._textVerticalAlignment&&(this._textVerticalAlignment=t,this.formatText())}}),ccui.RichText.create=function(){return new ccui.RichText},ccui.RichElement.TEXT=0,ccui.RichElement.IMAGE=1,ccui.RichElement.CUSTOM=2,ccui.WebView=ccui.Widget.extend({ctor:function(t){ccui.Widget.prototype.ctor.call(this),this._EventList={},t&&this.loadURL(t)},visit:function(){var t=this._renderCmd,e=t._div,i=cc.container,n=cc.eventManager;this._visible?(i.appendChild(e),null===this._listener&&(this._listener=n.addCustomListener(cc.game.EVENT_RESIZE,function(){t.resize()}))):(("contains"in i?i.contains(e):i.compareDocumentPosition(e)%16)&&i.removeChild(e),e=n._listenersMap[cc.game.EVENT_RESIZE].getFixedPriorityListeners(),n._removeListenerInVector(e,t._listener),t._listener=null),t.updateStatus(),t.resize(cc.view)},setJavascriptInterfaceScheme:function(t){},loadData:function(t,e,i,n){},loadHTMLString:function(t,e){},loadURL:function(t){this._renderCmd.updateURL(t),this._dispatchEvent(ccui.WebView.EventType.LOADING)},stopLoading:function(){cc.log("Web does not support loading")},reload:function(){var t=this._renderCmd._iframe;(t=t&&t.contentWindow)&&t.location&&t.location.reload()},canGoBack:function(){return cc.log("Web does not support query history"),!0},canGoForward:function(){return cc.log("Web does not support query history"),!0},goBack:function(){try{if(ccui.WebView._polyfill.closeHistory)return cc.log("The current browser does not support the GoBack");var t=this._renderCmd._iframe;if(t){var e=t.contentWindow;if(e&&e.location)try{e.history.back.call(e)}catch(t){e.history.back()}}}catch(t){cc.log(t)}},goForward:function(){try{if(ccui.WebView._polyfill.closeHistory)return cc.log("The current browser does not support the GoForward");var t=this._renderCmd._iframe;if(t){var e=t.contentWindow;if(e&&e.location)try{e.history.forward.call(e)}catch(t){e.history.forward()}}}catch(t){cc.log(t)}},evaluateJS:function(t){var e=this._renderCmd._iframe;if(e){e=e.contentWindow;try{e.eval(t),this._dispatchEvent(ccui.WebView.EventType.JS_EVALUATED)}catch(t){console.error(t)}}},setScalesPageToFit:function(){cc.log("Web does not support zoom")},setEventListener:function(t,e){this._EventList[t]=e},removeEventListener:function(t){this._EventList[t]=null},_dispatchEvent:function(t){(t=this._EventList[t])&&t.call(this,this,this._renderCmd._iframe.src)},_createRenderCmd:function(){return new ccui.WebView.RenderCmd(this)},setContentSize:function(t,e){ccui.Widget.prototype.setContentSize.call(this,t,e),void 0===e&&(e=t.height,t=t.width),this._renderCmd.changeSize(t,e)},cleanup:function(){this._renderCmd.removeDom(),this.stopAllActions(),this.unscheduleAllCallbacks()}}),ccui.WebView.EventType={LOADING:"loading",LOADED:"load",ERROR:"error",JS_EVALUATED:"js"},!function(){var t=ccui.WebView._polyfill={devicePixelRatio:!1,enableDiv:!1};cc.sys.os===cc.sys.OS_IOS&&(t.enableDiv=!0),cc.sys.isMobile?cc.sys.browserType===cc.sys.BROWSER_TYPE_FIREFOX&&(t.enableBG=!0):cc.sys.browserType===cc.sys.BROWSER_TYPE_IE&&(t.closeHistory=!0)}(),!function(c){var t=null,t=cc._renderType===cc.game.RENDER_TYPE_WEBGL?cc.Node.WebGLRenderCmd:cc.Node.CanvasRenderCmd;ccui.WebView.RenderCmd=function(t){this._rootCtor(t),this._iframe=this._div=null,c.enableDiv?(this._div=document.createElement("div"),this._div.style["-webkit-overflow"]="auto",this._div.style["-webkit-overflow-scrolling"]="touch",this._iframe=document.createElement("iframe"),this._iframe.style.width="100%",this._iframe.style.height="100%",this._div.appendChild(this._iframe)):this._div=this._iframe=document.createElement("iframe"),c.enableBG&&(this._div.style.background="#FFF"),this._iframe.addEventListener("load",function(){t._dispatchEvent(ccui.WebView.EventType.LOADED)}),this._iframe.addEventListener("error",function(){t._dispatchEvent(ccui.WebView.EventType.ERROR)}),this._div.style.background="#FFF",this._div.style.height="200px",this._div.style.width="300px",this._div.style.overflow="scroll",this._div.style.border="none",this._listener=null,this.initStyle()},(t=ccui.WebView.RenderCmd.prototype=Object.create(t.prototype)).constructor=ccui.WebView.RenderCmd,t.transform=function(t,e){this.originTransform(t,e),this.updateMatrix(this._worldTransform,cc.view._scaleX,cc.view._scaleY)},t.updateStatus=function(){c.devicePixelRatio=cc.view.isRetinaEnabled();var t=cc.Node._dirtyFlags,e=this._dirtyFlag;e&t.transformDirty&&(this.transform(this.getParentRenderCmd(),!0),this.updateMatrix(this._worldTransform,cc.view._scaleX,cc.view._scaleY),this._dirtyFlag^=this._dirtyFlag&cc.Node._dirtyFlags.transformDirty),e&t.orderDirty&&(this._dirtyFlag^=this._dirtyFlag&t.orderDirty)},t.resize=function(t){t=t||cc.view;var e=this._node,i=cc.eventManager;e._parent&&e._visible?this.updateMatrix(this._worldTransform,t._scaleX,t._scaleY):(t=i._listenersMap[cc.game.EVENT_RESIZE].getFixedPriorityListeners(),i._removeListenerInVector(t,this._listener),this._listener=null)},t.updateMatrix=function(t,e,i){var n,s,r,o,a=this._node;c.devicePixelRatio&&(e/=n=cc.view.getDevicePixelRatio(),i/=n),!1!==this._loaded&&(s=cc.game.container.style,n=parseInt(s.paddingLeft),s=parseInt(s.paddingBottom),r=a._contentSize.width,o=a._contentSize.height,t="matrix("+t.a*e+","+t.b+","+t.c+","+t.d*i+","+(n+t.tx*e-r/2+r*a._scaleX/2*e)+","+-(s+t.ty*i-o/2+o*a._scaleY/2*i)+")",this._div.style.transform=t,this._div.style["-webkit-transform"]=t)},t.initStyle=function(){var t;this._div&&((t=this._div).style.position="absolute",t.style.bottom="0px",t.style.left="0px")},t.updateURL=function(t){function e(){n._loaded=!0,i.removeEventListener("load",e)}var i=this._iframe,n=(i.src=t,this);i.addEventListener("load",e)},t.changeSize=function(t,e){var i=this._div;i&&(i.style.width=t+"px",i.style.height=e+"px")},t.removeDom=function(){var t=this._div;t&&("contains"in cc.container?cc.container.contains(t):cc.container.compareDocumentPosition(t)%16)&&cc.container.removeChild(t)}}(ccui.WebView._polyfill),ccui.ScrollViewBar=ccui.ProtectedNode.extend({_parentScroll:null,_direction:null,_upperHalfCircle:null,_lowerHalfCircle:null,_body:null,_opacity:255,_marginFromBoundary:0,_marginForLength:0,_touching:!1,_autoHideEnabled:!0,autoHideTime:0,_autoHideRemainingTime:0,_className:"ScrollViewBar",ctor:function(t,e){cc.ProtectedNode.prototype.ctor.call(this),this._direction=e,this._parentScroll=t,this._marginForLength=this._marginFromBoundary=ccui.ScrollViewBar.DEFAULT_MARGIN,this.opacity=255*ccui.ScrollViewBar.DEFAULT_SCROLLBAR_OPACITY,this.autoHideTime=ccui.ScrollViewBar.DEFAULT_AUTO_HIDE_TIME,this._autoHideEnabled=!0,ccui.ScrollViewBar.prototype.init.call(this),this.setCascadeColorEnabled(!0),this.setCascadeOpacityEnabled(!0)},init:function(){this._upperHalfCircle=ccui.helper._createSpriteFromBase64(ccui.ScrollViewBar.HALF_CIRCLE_IMAGE,ccui.ScrollViewBar.HALF_CIRCLE_IMAGE_KEY),this._upperHalfCircle.setAnchorPoint(cc.p(.5,0)),this._lowerHalfCircle=ccui.helper._createSpriteFromBase64(ccui.ScrollViewBar.HALF_CIRCLE_IMAGE,ccui.ScrollViewBar.HALF_CIRCLE_IMAGE_KEY),this._lowerHalfCircle.setAnchorPoint(cc.p(.5,0)),this._lowerHalfCircle.setScaleY(-1),this.addProtectedChild(this._upperHalfCircle),this.addProtectedChild(this._lowerHalfCircle),this._body=ccui.helper._createSpriteFromBase64(ccui.ScrollViewBar.BODY_IMAGE_1_PIXEL_HEIGHT,ccui.ScrollViewBar.BODY_IMAGE_1_PIXEL_HEIGHT_KEY),this._body.setAnchorPoint(cc.p(.5,0)),this.addProtectedChild(this._body),this.setColor(ccui.ScrollViewBar.DEFAULT_COLOR),this.onScrolled(cc.p(0,0)),cc.ProtectedNode.prototype.setOpacity.call(this,0),this._autoHideRemainingTime=0,this._direction===ccui.ScrollView.DIR_HORIZONTAL&&this.setRotation(90)},setPositionFromCorner:function(t){this._direction===ccui.ScrollView.DIR_VERTICAL?(this._marginForLength=t.y,this._marginFromBoundary=t.x):(this._marginForLength=t.x,this._marginFromBoundary=t.y)},onEnter:function(){cc.ProtectedNode.prototype.onEnter.call(this),this.scheduleUpdate()},getPositionFromCorner:function(){return this._direction===ccui.ScrollView.DIR_VERTICAL?cc.p(this._marginFromBoundary,this._marginForLength):cc.p(this._marginForLength,this._marginFromBoundary)},setWidth:function(t){t/=this._body.width,this._body.setScaleX(t),this._upperHalfCircle.setScale(t),this._lowerHalfCircle.setScale(-t)},getWidth:function(){return this._body.getBoundingBox().width},setAutoHideEnabled:function(t){this._autoHideEnabled=t,!this._autoHideEnabled&&!this._touching&&this._autoHideRemainingTime<=0?cc.ProtectedNode.prototype.setOpacity.call(this,this.opacity):cc.ProtectedNode.prototype.setOpacity.call(this,0)},isAutoHideEnabled:function(){return this._autoHideEnabled},setOpacity:function(t){this._opacity=t},getOpacity:function(){return this._opacity},_updateLength:function(t){var e=t/this._body.getTextureRect().height;this._body.setScaleY(e),this._upperHalfCircle.setPositionY(this._body.getPositionY()+t)},_processAutoHide:function(t){!this._autoHideEnabled||this._autoHideRemainingTime<=0||this._touching||(this._autoHideRemainingTime-=t,this._autoHideRemainingTime<=this.autoHideTime&&(this._autoHideRemainingTime=Math.max(0,this._autoHideRemainingTime),cc.ProtectedNode.prototype.setOpacity.call(this,this._autoHideRemainingTime/this.autoHideTime*this._opacity)))},update:function(t){this._processAutoHide(t)},onTouchBegan:function(){this._autoHideEnabled&&(this._touching=!0)},onTouchEnded:function(){this._autoHideEnabled&&(this._touching=!1,this._autoHideRemainingTime<=0||(this._autoHideRemainingTime=this.autoHideTime))},onScrolled:function(t){this._autoHideEnabled&&(this._autoHideRemainingTime=this.autoHideTime,cc.ProtectedNode.prototype.setOpacity.call(this,this.opacity));var e=this._parentScroll.getInnerContainer(),i=0,n=0,s=0,r=0;this._direction===ccui.ScrollView.DIR_VERTICAL?(i=e.height,n=this._parentScroll.height,s=t.y,r=-e.getPositionY()):this._direction===ccui.ScrollView.DIR_HORIZONTAL&&(i=e.width,n=this._parentScroll.width,s=t.x,r=-e.getPositionX()),t=this._calculateLength(i,n,s),i=this._calculatePosition(i,n,r,s,t),this._updateLength(t),this.setPosition(i)},_calculateLength:function(t,e,i){return 0!==i&&(t+=20*(0<i?i:-i)),i=e/t,Math.abs(e-2*this._marginForLength)*i},_calculatePosition:function(t,e,i,n,s){return t-=e,0!==n&&(t+=Math.abs(n)),(n=0)!==t&&(n=Math.max(i/t,0),n=Math.min(n,1)),e=(e-s-2*this._marginForLength)*n+this._marginForLength,this._direction===ccui.ScrollView.DIR_VERTICAL?cc.p(this._parentScroll.width-this._marginFromBoundary,e):cc.p(e,this._marginFromBoundary)}}),_p=ccui.ScrollViewBar.prototype,cc.defineGetterSetter(_p,"opacity",_p.getOpacity,_p.setOpacity),cc.defineGetterSetter(_p,"autoHideEnabled",_p.isAutoHideEnabled,_p.setAutoHideEnabled),ccui.ScrollViewBar.DEFAULT_COLOR=cc.color(52,65,87),ccui.ScrollViewBar.DEFAULT_MARGIN=20,ccui.ScrollViewBar.DEFAULT_AUTO_HIDE_TIME=.2,ccui.ScrollViewBar.DEFAULT_SCROLLBAR_OPACITY=.4,ccui.ScrollViewBar.HALF_CIRCLE_IMAGE_KEY="/__half_circle_image",ccui.ScrollViewBar.HALF_CIRCLE_IMAGE="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAGCAMAAADAMI+zAAAAJ1BMVEX///////////////////////////////////////////////////9Ruv0SAAAADHRSTlMABgcbbW7Hz9Dz+PmlcJP5AAAAMElEQVR4AUXHwQ2AQAhFwYcLH1H6r1djzDK3ASxUpTBeK/uTCyz7dx54b44m4p5cD1MwAooEJyk3AAAAAElFTkSuQmCC",ccui.ScrollViewBar.BODY_IMAGE_1_PIXEL_HEIGHT_KEY="/__body_image_height",ccui.ScrollViewBar.BODY_IMAGE_1_PIXEL_HEIGHT="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAABCAMAAADdNb8LAAAAA1BMVEX///+nxBvIAAAACklEQVR4AWNABgAADQABYc2cpAAAAABJRU5ErkJggg==",ccui.ScrollView=ccui.Layout.extend({_innerContainer:null,_direction:null,_topBoundary:0,_bottomBoundary:0,_leftBoundary:0,_rightBoundary:0,_touchMoveDisplacements:null,_touchMoveTimeDeltas:null,_touchMovePreviousTimestamp:0,_touchTotalTimeThreshold:.5,_autoScrolling:!1,_autoScrollTargetDelta:null,_autoScrollAttenuate:!0,_autoScrollStartPosition:null,_autoScrollTotalTime:0,_autoScrollAccumulatedTime:0,_autoScrollCurrentlyOutOfBoundary:!1,_autoScrollBraking:!1,_autoScrollBrakingStartPosition:null,_bePressed:!1,_childFocusCancelOffset:0,bounceEnabled:!1,_outOfBoundaryAmount:null,_outOfBoundaryAmountDirty:!0,inertiaScrollEnabled:!1,_scrollBarEnabled:!0,_verticalScrollBar:null,_horizontalScrollBar:null,_scrollViewEventListener:null,_scrollViewEventSelector:null,_className:"ScrollView",ctor:function(){ccui.Layout.prototype.ctor.call(this),this.setClippingEnabled(!0),this._innerContainer.setTouchEnabled(!1),this._direction=ccui.ScrollView.DIR_NONE,this._childFocusCancelOffset=5,this.inertiaScrollEnabled=!0,this._outOfBoundaryAmount=cc.p(0,0),this._autoScrollTargetDelta=cc.p(0,0),this._autoScrollStartPosition=cc.p(0,0),this._autoScrollBrakingStartPosition=cc.p(0,0),this._touchMoveDisplacements=[],this._touchMoveTimeDeltas=[],this._touchMovePreviousTimestamp=0,this._scrollBarEnabled=!0,this._initScrollBar(),this.setTouchEnabled(!0)},onEnter:function(){ccui.Layout.prototype.onEnter.call(this),this.scheduleUpdate()},onExit:function(){cc.renderer._removeCache(this.__instanceId),ccui.Layout.prototype.onExit.call(this)},visit:function(t){var e=this._renderCmd,i=t?t._renderCmd:null;if(this._visible){this._adaptRenderers(),this._doLayout(),t=cc.renderer,e.visit(i),t.pushRenderCommand(e),e instanceof ccui.ScrollView.WebGLRenderCmd&&t._turnToCacheMode(this.__instanceId);var n=this._clippingEnabled&&this._clippingType===ccui.Layout.CLIPPING_STENCIL,s=this._clippingEnabled&&this._clippingType===ccui.Layout.CLIPPING_SCISSOR;n?e.stencilClippingVisit(i):s&&e.scissorClippingVisit(i);var r,o,a=this._children,c=a.length,h=(i=this._protectedChildren).length;for(this._reorderChildDirty&&this.sortAllChildren(),this._reorderProtectedChildDirty&&this.sortAllProtectedChildren(),r=0;r<c;r++)(o=a[r])&&o._visible&&o.visit(this);for(r=0;r<h;r++)(a=i[r])&&a._visible&&(e._changeProtectedChild(a),a.visit(this));n?e.postStencilVisit():s&&e.postScissorVisit(),e instanceof ccui.ScrollView.WebGLRenderCmd&&t._turnToNormalMode(),this.updateChildren(),e._dirtyFlag=0}else e._propagateFlagsDown(i)},findNextFocusedWidget:function(t,e){return this.getLayoutType()===ccui.Layout.LINEAR_VERTICAL||this.getLayoutType()===ccui.Layout.LINEAR_HORIZONTAL?this._innerContainer.findNextFocusedWidget(t,e):ccui.Widget.prototype.findNextFocusedWidget.call(this,t,e)},_initRenderer:function(){ccui.Layout.prototype._initRenderer.call(this),this._innerContainer=new ccui.Layout,this._innerContainer.setColor(cc.color(255,255,255)),this._innerContainer.setOpacity(255),this._innerContainer.setCascadeColorEnabled(!0),this._innerContainer.setCascadeOpacityEnabled(!0),this.addProtectedChild(this._innerContainer,1,1)},_createRenderCmd:function(){return new(cc._renderType===cc.game.RENDER_TYPE_WEBGL?ccui.ScrollView.WebGLRenderCmd:ccui.ScrollView.CanvasRenderCmd)(this)},_onSizeChanged:function(){ccui.Layout.prototype._onSizeChanged.call(this);var t=this._contentSize,e=(this._topBoundary=t.height,this._rightBoundary=t.width,this._innerContainer.getContentSize());this._innerContainer.setContentSize(cc.size(Math.max(e.width,t.width),Math.max(e.height,t.height))),this._innerContainer.setPosition(0,t.height-this._innerContainer.getContentSize().height),this._verticalScrollBar&&this._verticalScrollBar.onScrolled(this._getHowMuchOutOfBoundary()),this._horizontalScrollBar&&this._horizontalScrollBar.onScrolled(this._getHowMuchOutOfBoundary())},setInnerContainerSize:function(t){var e=this._innerContainer,i=this._contentSize,n=i.width,s=i.height;t.width<i.width?cc.log("Inner width <= ScrollView width, it will be force sized!"):n=t.width,t.height<i.height?cc.log("Inner height <= ScrollView height, it will be force sized!"):s=t.height,e.setContentSize(cc.size(n,s)),t=this._innerContainer.getPosition(),e=this._innerContainer.getAnchorPoint(),0!=this._innerContainer.getLeftBoundary()&&(t.x=e.x*n),this._innerContainer.getTopBoundary()!=this._contentSize.height&&(t.y=this._contentSize.height-(1-e.y)*s),this.setInnerContainerPosition(t),this._updateScrollBar(cc.p(0,0))},_setInnerWidth:function(t){var e=this._contentSize.width,i=e,n=this._innerContainer,s=n.width;switch(t<e?cc.log("Inner width <= scrollview width, it will be force sized!"):i=t,n.width=i,this._direction){case ccui.ScrollView.DIR_HORIZONTAL:case ccui.ScrollView.DIR_BOTH:n.getRightBoundary()<=e&&this._scrollChildren(s-n.width,0)}t=n.anchorX,0<n.getLeftBoundary()&&(n.x=t*i),n.getRightBoundary()<e&&(n.x=e-(1-t)*i)},_setInnerHeight:function(t){var e=this._contentSize.height,i=e,n=this._innerContainer,s=n.height;switch(t<e?cc.log("Inner height <= scrollview height, it will be force sized!"):i=t,n.height=i,this._direction){case ccui.ScrollView.DIR_VERTICAL:case ccui.ScrollView.DIR_BOTH:this._scrollChildren(0,s-i)}t=n.anchorY,0<n.getLeftBoundary()&&(n.y=t*i),n.getRightBoundary()<e&&(n.y=e-(1-t)*i)},setInnerContainerPosition:function(t){if(t.x!==this._innerContainer.getPositionX()||t.y!==this._innerContainer.getPositionY()){if(this._innerContainer.setPosition(t),this._outOfBoundaryAmountDirty=!0,this.bounceEnabled)for(t=ccui.ScrollView.MOVEDIR_TOP;t<ccui.ScrollView.MOVEDIR_RIGHT;++t)this._isOutOfBoundary(t)&&this._processScrollEvent(t,!0);this._dispatchEvent(ccui.ScrollView.EVENT_CONTAINER_MOVED)}},getInnerContainerPosition:function(){return this._innerContainer.getPosition()},getInnerContainerSize:function(){return this._innerContainer.getContentSize()},_getInnerWidth:function(){return this._innerContainer.width},_getInnerHeight:function(){return this._innerContainer.height},_isInContainer:function(t){var e,i,n,s,r,o;return!(this._clippingEnabled&&(e=t._position,i=t._contentSize,t=t._anchorPoint,n=this._customSize,s=this._innerContainer._position,o=r=0,(r=e.y-t.y*i.height)>=n.height-s.y||r+i.height<=-s.y||(o=e.x-t.x*i.width)>=n.width-s.x||o+i.width<=-s.x))},updateChildren:function(){for(var t,e=this._innerContainer._children,i=0,n=e.length;i<n;i++)!0===(t=e[i])._inViewRect&&!1===this._isInContainer(t)?t._inViewRect=!1:!1===t._inViewRect&&!0===this._isInContainer(t)&&(t._inViewRect=!0)},addChild:function(t,e,i){return!!t&&(!1===this._isInContainer(t)&&(t._inViewRect=!1),e=e||t.getLocalZOrder(),i=i||t.getTag(),this._innerContainer.addChild(t,e,i))},removeAllChildren:function(){this.removeAllChildrenWithCleanup(!0)},removeAllChildrenWithCleanup:function(t){this._innerContainer.removeAllChildrenWithCleanup(t)},removeChild:function(t,e){return this._innerContainer.removeChild(t,e)},getChildren:function(){return this._innerContainer.getChildren()},getChildrenCount:function(){return this._innerContainer.getChildrenCount()},getChildByTag:function(t){return this._innerContainer.getChildByTag(t)},getChildByName:function(t){return this._innerContainer.getChildByName(t)},_flattenVectorByDirection:function(t){var e=cc.p(0,0);return e.x=this._direction===ccui.ScrollView.DIR_VERTICAL?0:t.x,e.y=this._direction===ccui.ScrollView.DIR_HORIZONTAL?0:t.y,e},_getHowMuchOutOfBoundary:function(t){var e;return 0!==(t=void 0===t?cc.p(0,0):t).x||0!==t.y||this._outOfBoundaryAmountDirty?(e=cc.p(0,0),this._innerContainer.getLeftBoundary()+t.x>this._leftBoundary?e.x=this._leftBoundary-(this._innerContainer.getLeftBoundary()+t.x):this._innerContainer.getRightBoundary()+t.x<this._rightBoundary&&(e.x=this._rightBoundary-(this._innerContainer.getRightBoundary()+t.x)),this._innerContainer.getTopBoundary()+t.y<this._topBoundary?e.y=this._topBoundary-(this._innerContainer.getTopBoundary()+t.y):this._innerContainer.getBottomBoundary()+t.y>this._bottomBoundary&&(e.y=this._bottomBoundary-(this._innerContainer.getBottomBoundary()+t.y)),0===t.x&&0===t.y&&(this._outOfBoundaryAmount=e,this._outOfBoundaryAmountDirty=!1),e):this._outOfBoundaryAmount},_isOutOfBoundary:function(t){var e=this._getHowMuchOutOfBoundary();if(void 0===t)return!this._fltEqualZero(e);switch(t){case ccui.ScrollView.MOVEDIR_TOP:return 0<e.y;case ccui.ScrollView.MOVEDIR_BOTTOM:return e.y<0;case ccui.ScrollView.MOVEDIR_LEFT:return e.x<0;case ccui.ScrollView.MOVEDIR_RIGHT:return 0<e.x}return!1},_moveInnerContainer:function(t,e){t=this._flattenVectorByDirection(t);this.setInnerContainerPosition(cc.pAdd(this.getInnerContainerPosition(),t)),t=this._getHowMuchOutOfBoundary(),this._updateScrollBar(t),this.bounceEnabled&&e&&this._startBounceBackIfNeeded()},_updateScrollBar:function(t){this._verticalScrollBar&&this._verticalScrollBar.onScrolled(t),this._horizontalScrollBar&&this._horizontalScrollBar.onScrolled(t)},_calculateTouchMoveVelocity:function(){for(var t=0,e=0;e<this._touchMoveTimeDeltas.length;++e)t+=this._touchMoveTimeDeltas[e];if(0==t||t>=this._touchTotalTimeThreshold)return cc.p(0,0);for(var i=cc.p(0,0),e=0;e<this._touchMoveDisplacements.length;++e)i.x+=this._touchMoveDisplacements[e].x,i.y+=this._touchMoveDisplacements[e].y;return cc.pMult(i,1/t)},setTouchTotalTimeThreshold:function(t){this._touchTotalTimeThreshold=t},getTouchTotalTimeThreshold:function(){return this._touchTotalTimeThreshold},_startInertiaScroll:function(t){var e=cc.pMult(t,.7);this._startAttenuatingAutoScroll(e,t)},_startBounceBackIfNeeded:function(){var t;return!!this.bounceEnabled&&(t=this._getHowMuchOutOfBoundary(),!this._fltEqualZero(t))&&(this._startAutoScroll(t,1,!0),!0)},_startAutoScrollToDestination:function(t,e,i){this._startAutoScroll(cc.pSub(t,this._innerContainer.getPosition()),e,i)},_calculateAutoScrollTimeByInitialSpeed:function(t){return Math.sqrt(Math.sqrt(t/5))},_startAttenuatingAutoScroll:function(t,e){e=this._calculateAutoScrollTimeByInitialSpeed(cc.pLength(e));this._startAutoScroll(t,e,!0)},_startAutoScroll:function(t,e,i){t=this._flattenVectorByDirection(t),this._autoScrolling=!0,this._autoScrollTargetDelta=t,this._autoScrollAttenuate=i,this._autoScrollStartPosition=this._innerContainer.getPosition(),this._autoScrollTotalTime=e,this._autoScrollAccumulatedTime=0,this._autoScrollBraking=!1,this._autoScrollBrakingStartPosition=cc.p(0,0),e=this._getHowMuchOutOfBoundary(),!this._fltEqualZero(e)&&(this._autoScrollCurrentlyOutOfBoundary=!0,i=this._getHowMuchOutOfBoundary(t),0<e.x*i.x||0<e.y*i.y)&&(this._autoScrollBraking=!0)},stopAutoScroll:function(){this._autoScrolling=!1,this._autoScrollAttenuate=!0,this._autoScrollAccumulatedTime=this._autoScrollTotalTime=0},_isNecessaryAutoScrollBrake:function(){if(this._autoScrollBraking)return!0;if(this._isOutOfBoundary()){if(!this._autoScrollCurrentlyOutOfBoundary)return this._autoScrollBraking=this._autoScrollCurrentlyOutOfBoundary=!0,this._autoScrollBrakingStartPosition=this.getInnerContainerPosition(),!0}else this._autoScrollCurrentlyOutOfBoundary=!1;return!1},_getAutoScrollStopEpsilon:function(){return 1e-4},_fltEqualZero:function(t){return Math.abs(t.x)<=1e-4&&Math.abs(t.y)<=1e-4},_processAutoScrolling:function(t){var e=this._isNecessaryAutoScrollBrake()?.05:1,i=(this._autoScrollAccumulatedTime+=1/e*t,Math.min(1,this._autoScrollAccumulatedTime/this._autoScrollTotalTime));this._autoScrollAttenuate&&(i=--i*i*i*i*i+1),t=cc.pAdd(this._autoScrollStartPosition,cc.pMult(this._autoScrollTargetDelta,i)),i=Math.abs(i-1)<=this._getAutoScrollStopEpsilon(),this.bounceEnabled?t=cc.pAdd(this._autoScrollBrakingStartPosition,cc.pMult(cc.pSub(t,this._autoScrollBrakingStartPosition),e)):(e=cc.pSub(t,this.getInnerContainerPosition()),e=this._getHowMuchOutOfBoundary(e),this._fltEqualZero(e)||(t.x+=e.x,t.y+=e.y,i=!0)),i&&(this._autoScrolling=!1,this._dispatchEvent(ccui.ScrollView.EVENT_AUTOSCROLL_ENDED)),this._moveInnerContainer(cc.pSub(t,this.getInnerContainerPosition()),i)},_jumpToDestination:function(t,e){void 0===t.x&&(t=cc.p(t,e)),this._autoScrolling=!1,this._moveInnerContainer(cc.pSub(t,this.getInnerContainerPosition()),!0)},_scrollChildren:function(t){this.bounceEnabled&&(e=this._getHowMuchOutOfBoundary(),t.x*=0==e.x?1:.5,t.y*=0==e.y?1:.5),this.bounceEnabled||(e=this._getHowMuchOutOfBoundary(t),t.x+=e.x,t.y+=e.y);var e,i=e=!1,n=!1,s=!1;0<t.y?this._innerContainer.getBottomBoundary()+t.y>=this._bottomBoundary&&(s=!0):t.y<0&&this._innerContainer.getTopBoundary()+t.y<=this._topBoundary&&(n=!0),t.x<0?this._innerContainer.getRightBoundary()+t.x<=this._rightBoundary&&(i=!0):0<t.x&&this._innerContainer.getLeftBoundary()+t.x>=this._leftBoundary&&(e=!0),this._moveInnerContainer(t,!1),0==t.x&&0==t.y||this._processScrollingEvent(),s&&this._processScrollEvent(ccui.ScrollView.MOVEDIR_BOTTOM,!1),n&&this._processScrollEvent(ccui.ScrollView.MOVEDIR_TOP,!1),e&&this._processScrollEvent(ccui.ScrollView.MOVEDIR_LEFT,!1),i&&this._processScrollEvent(ccui.ScrollView.MOVEDIR_RIGHT,!1)},scrollToBottom:function(t,e){this._startAutoScrollToDestination(cc.p(this._innerContainer.getPositionX(),0),t,e)},scrollToTop:function(t,e){this._startAutoScrollToDestination(cc.p(this._innerContainer.getPositionX(),this._contentSize.height-this._innerContainer.getContentSize().height),t,e)},scrollToLeft:function(t,e){this._startAutoScrollToDestination(cc.p(0,this._innerContainer.getPositionY()),t,e)},scrollToRight:function(t,e){this._startAutoScrollToDestination(cc.p(this._contentSize.width-this._innerContainer.getContentSize().width,this._innerContainer.getPositionY()),t,e)},scrollToTopLeft:function(t,e){this._direction!==ccui.ScrollView.DIR_BOTH?cc.log("Scroll direction is not both!"):this._startAutoScrollToDestination(cc.p(0,this._contentSize.height-this._innerContainer.getContentSize().height),t,e)},scrollToTopRight:function(t,e){var i;this._direction!==ccui.ScrollView.DIR_BOTH?cc.log("Scroll direction is not both!"):(i=this._innerContainer.getContentSize(),this._startAutoScrollToDestination(cc.p(this._contentSize.width-i.width,this._contentSize.height-i.height),t,e))},scrollToBottomLeft:function(t,e){this._direction!==ccui.ScrollView.DIR_BOTH?cc.log("Scroll direction is not both!"):this._startAutoScrollToDestination(cc.p(0,0),t,e)},scrollToBottomRight:function(t,e){this._direction!==ccui.ScrollView.DIR_BOTH?cc.log("Scroll direction is not both!"):this._startAutoScrollToDestination(cc.p(this._contentSize.width-this._innerContainer.getContentSize().width,0),t,e)},scrollToPercentVertical:function(t,e,i){var n=this._contentSize.height-this._innerContainer.getContentSize().height,s=-n;this._startAutoScrollToDestination(cc.p(this._innerContainer.getPositionX(),n+t*s/100),e,i)},scrollToPercentHorizontal:function(t,e,i){var n=this._innerContainer.getContentSize().width-this._contentSize.width;this._startAutoScrollToDestination(cc.p(-t*n/100,this._innerContainer.getPositionY()),e,i)},scrollToPercentBothDirection:function(t,e,i){var n,s,r;this._direction===ccui.ScrollView.DIR_BOTH&&(s=-(n=this._contentSize.height-this._innerContainer.getContentSize().height),r=this._innerContainer.getContentSize().width-this._contentSize.width,this._startAutoScrollToDestination(cc.p(-t.x*r/100,n+t.y*s/100),e,i))},jumpToBottom:function(){this._jumpToDestination(this._innerContainer.getPositionX(),0)},jumpToTop:function(){this._jumpToDestination(this._innerContainer.getPositionX(),this._contentSize.height-this._innerContainer.getContentSize().height)},jumpToLeft:function(){this._jumpToDestination(0,this._innerContainer.getPositionY())},jumpToRight:function(){this._jumpToDestination(this._contentSize.width-this._innerContainer.getContentSize().width,this._innerContainer.getPositionY())},jumpToTopLeft:function(){this._direction!==ccui.ScrollView.DIR_BOTH?cc.log("Scroll _direction is not both!"):this._jumpToDestination(0,this._contentSize.height-this._innerContainer.getContentSize().height)},jumpToTopRight:function(){var t;this._direction!==ccui.ScrollView.DIR_BOTH?cc.log("Scroll _direction is not both!"):(t=this._innerContainer.getContentSize(),this._jumpToDestination(this._contentSize.width-t.width,this._contentSize.height-t.height))},jumpToBottomLeft:function(){this._direction!==ccui.ScrollView.DIR_BOTH?cc.log("Scroll _direction is not both!"):this._jumpToDestination(0,0)},jumpToBottomRight:function(){this._direction!==ccui.ScrollView.DIR_BOTH?cc.log("Scroll _direction is not both!"):this._jumpToDestination(this._contentSize.width-this._innerContainer.getContentSize().width,0)},jumpToPercentVertical:function(t){var e=this._contentSize.height-this._innerContainer.getContentSize().height,i=-e;this._jumpToDestination(this._innerContainer.getPositionX(),e+t*i/100)},jumpToPercentHorizontal:function(t){var e=this._innerContainer.getContentSize().width-this._contentSize.width;this._jumpToDestination(-t*e/100,this._innerContainer.getPositionY())},jumpToPercentBothDirection:function(t){var e,i;this._direction===ccui.ScrollView.DIR_BOTH&&(e=this._innerContainer.getContentSize(),i=this._contentSize.height-e.height,this._jumpToDestination(-(t.x*(e.width-this._contentSize.width))/100,i+t.y*-i/100))},_gatherTouchMove:function(t){for(;5<=this._touchMoveDisplacements.length;)this._touchMoveDisplacements.splice(0,1),this._touchMoveTimeDeltas.splice(0,1);this._touchMoveDisplacements.push(t),t=(new Date).getTime(),this._touchMoveTimeDeltas.push((t-this._touchMovePreviousTimestamp)/1e3),this._touchMovePreviousTimestamp=t},_handlePressLogic:function(t){this._bePressed=!0,this._autoScrolling=!1,this._touchMovePreviousTimestamp=(new Date).getTime(),this._touchMoveDisplacements.length=0,this._touchMoveTimeDeltas.length=0,this._verticalScrollBar&&this._verticalScrollBar.onTouchBegan(),this._horizontalScrollBar&&this._horizontalScrollBar.onTouchBegan()},_handleMoveLogic:function(t){var e=this.convertToNodeSpace(t.getLocation());t=this.convertToNodeSpace(t.getPreviousLocation()),e=cc.pSub(e,t),this._scrollChildren(e),this._gatherTouchMove(e)},_handleReleaseLogic:function(t){var e=this.convertToNodeSpace(t.getLocation());t=this.convertToNodeSpace(t.getPreviousLocation()),e=cc.pSub(e,t),this._gatherTouchMove(e),this._bePressed=!1,this._startBounceBackIfNeeded()||!this.inertiaScrollEnabled||0===(e=this._calculateTouchMoveVelocity()).x&&0===e.y||this._startInertiaScroll(e),this._verticalScrollBar&&this._verticalScrollBar.onTouchEnded(),this._horizontalScrollBar&&this._horizontalScrollBar.onTouchEnded()},onTouchBegan:function(t,e){e=ccui.Layout.prototype.onTouchBegan.call(this,t,e);return this._isInterceptTouch||this._hit&&this._handlePressLogic(t),e},onTouchMoved:function(t,e){ccui.Layout.prototype.onTouchMoved.call(this,t,e),this._isInterceptTouch||this._handleMoveLogic(t)},onTouchEnded:function(t,e){ccui.Layout.prototype.onTouchEnded.call(this,t,e),this._isInterceptTouch||this._handleReleaseLogic(t),this._isInterceptTouch=!1},onTouchCancelled:function(t,e){ccui.Layout.prototype.onTouchCancelled.call(this,t,e),this._isInterceptTouch||this._handleReleaseLogic(t),this._isInterceptTouch=!1},update:function(t){this._autoScrolling&&this._processAutoScrolling(t)},interceptTouchEvent:function(t,e,i){if(this._touchEnabled){if(this._direction!==ccui.ScrollView.DIR_NONE){var n=i.getLocation();switch(t){case ccui.Widget.TOUCH_BEGAN:this._isInterceptTouch=!0,this._touchBeganPosition.x=n.x,this._touchBeganPosition.y=n.y,this._handlePressLogic(i);break;case ccui.Widget.TOUCH_MOVED:t=cc.pLength(cc.pSub(e.getTouchBeganPosition(),n)),this._touchMovePosition.x=n.x,this._touchMovePosition.y=n.y,t>this._childFocusCancelOffset&&(e.setHighlighted(!1),this._handleMoveLogic(i));break;case ccui.Widget.TOUCH_CANCELED:case ccui.Widget.TOUCH_ENDED:this._touchEndPosition.x=n.x,this._touchEndPosition.y=n.y,this._handleReleaseLogic(i),e.isSwallowTouches()&&(this._isInterceptTouch=!1)}}}else ccui.Layout.prototype.interceptTouchEvent.call(this,t,e,i)},_processScrollEvent:function(t,e){var i=0;switch(t){case ccui.ScrollView.MOVEDIR_TOP:i=e?ccui.ScrollView.EVENT_BOUNCE_TOP:ccui.ScrollView.EVENT_SCROLL_TO_TOP;break;case ccui.ScrollView.MOVEDIR_BOTTOM:i=e?ccui.ScrollView.EVENT_BOUNCE_BOTTOM:ccui.ScrollView.EVENT_SCROLL_TO_BOTTOM;break;case ccui.ScrollView.MOVEDIR_LEFT:i=e?ccui.ScrollView.EVENT_BOUNCE_LEFT:ccui.ScrollView.EVENT_SCROLL_TO_LEFT;break;case ccui.ScrollView.MOVEDIR_RIGHT:i=e?ccui.ScrollView.EVENT_BOUNCE_RIGHT:ccui.ScrollView.EVENT_SCROLL_TO_RIGHT}this._dispatchEvent(i)},_processScrollingEvent:function(){this._dispatchEvent(ccui.ScrollView.EVENT_SCROLLING)},_dispatchEvent:function(t){this._scrollViewEventSelector&&(this._scrollViewEventListener?this._scrollViewEventSelector.call(this._scrollViewEventListener,this,t):this._scrollViewEventSelector(this,t)),this._ccEventCallback&&this._ccEventCallback(this,t)},addEventListenerScrollView:function(t,e){this._scrollViewEventSelector=t,this._scrollViewEventListener=e},addEventListener:function(t){this._ccEventCallback=t},setDirection:function(t){this._direction=t,this._scrollBarEnabled&&(this._removeScrollBar(),this._initScrollBar())},getDirection:function(){return this._direction},setBounceEnabled:function(t){this.bounceEnabled=t},isBounceEnabled:function(){return this.bounceEnabled},setInertiaScrollEnabled:function(t){this.inertiaScrollEnabled=t},isInertiaScrollEnabled:function(){return this.inertiaScrollEnabled},setScrollBarEnabled:function(t){this._scrollBarEnabled!==t&&(this._scrollBarEnabled&&this._removeScrollBar(),this._scrollBarEnabled=t)&&this._initScrollBar()},isScrollBarEnabled:function(){return this._scrollBarEnabled},setScrollBarPositionFromCorner:function(t){this._direction!==ccui.ScrollView.DIR_HORIZONTAL&&this.setScrollBarPositionFromCornerForVertical(t),this._direction!==ccui.ScrollView.DIR_VERTICAL&&this.setScrollBarPositionFromCornerForHorizontal(t)},setScrollBarPositionFromCornerForVertical:function(t){cc.assert(this._scrollBarEnabled,"Scroll bar should be enabled!"),cc.assert(this._direction!==ccui.ScrollView.DIR_HORIZONTAL,"Scroll view doesn't have a vertical scroll bar!"),this._verticalScrollBar.setPositionFromCorner(t)},getScrollBarPositionFromCornerForVertical:function(){return cc.assert(this._scrollBarEnabled,"Scroll bar should be enabled!"),cc.assert(this._direction!==ccui.ScrollView.DIR_HORIZONTAL,"Scroll view doesn't have a vertical scroll bar!"),this._verticalScrollBar.getPositionFromCorner()},setScrollBarPositionFromCornerForHorizontal:function(t){cc.assert(this._scrollBarEnabled,"Scroll bar should be enabled!"),cc.assert(this._direction!==ccui.ScrollView.DIR_VERTICAL,"Scroll view doesn't have a horizontal scroll bar!"),this._horizontalScrollBar.setPositionFromCorner(t)},getScrollBarPositionFromCornerForHorizontal:function(){return cc.assert(this._scrollBarEnabled,"Scroll bar should be enabled!"),cc.assert(this._direction!==ccui.ScrollView.DIR_VERTICAL,"Scroll view doesn't have a horizontal scroll bar!"),this._horizontalScrollBar.getPositionFromCorner()},setScrollBarWidth:function(t){cc.assert(this._scrollBarEnabled,"Scroll bar should be enabled!"),this._verticalScrollBar&&this._verticalScrollBar.setWidth(t),this._horizontalScrollBar&&this._horizontalScrollBar.setWidth(t)},getScrollBarWidth:function(){return cc.assert(this._scrollBarEnabled,"Scroll bar should be enabled!"),this._verticalScrollBar?this._verticalScrollBar.getWidth():this._horizontalScrollBar?this._horizontalScrollBar.getWidth():0},setScrollBarColor:function(t){cc.assert(this._scrollBarEnabled,"Scroll bar should be enabled!"),this._verticalScrollBar&&this._verticalScrollBar.setColor(t),this._horizontalScrollBar&&this._horizontalScrollBar.setColor(t)},getScrollBarColor:function(){return cc.assert(this._scrollBarEnabled,"Scroll bar should be enabled!"),this._verticalScrollBar&&this._verticalScrollBar.getColor(),this._horizontalScrollBar&&this._horizontalScrollBar.getColor(),cc.color.WHITE},setScrollBarOpacity:function(t){cc.assert(this._scrollBarEnabled,"Scroll bar should be enabled!"),this._verticalScrollBar&&(this._verticalScrollBar.opacity=t),this._horizontalScrollBar&&(this._horizontalScrollBar.opacity=t)},getScrollBarOpacity:function(){return cc.assert(this._scrollBarEnabled,"Scroll bar should be enabled!"),this._verticalScrollBar?this._verticalScrollBar.opacity:this._horizontalScrollBar?this._horizontalScrollBar.opacity:-1},setScrollBarAutoHideEnabled:function(t){cc.assert(this._scrollBarEnabled,"Scroll bar should be enabled!"),this._verticalScrollBar&&(this._verticalScrollBar.autoHideEnabled=t),this._horizontalScrollBar&&(this._horizontalScrollBar.autoHideEnabled=t)},isScrollBarAutoHideEnabled:function(){return cc.assert(this._scrollBarEnabled,"Scroll bar should be enabled!"),this._verticalScrollBar?this._verticalScrollBar.autoHideEnabled:!!this._horizontalScrollBar&&this._horizontalScrollBar.autoHideEnabled},setScrollBarAutoHideTime:function(t){cc.assert(this._scrollBarEnabled,"Scroll bar should be enabled!"),this._verticalScrollBar&&(this._verticalScrollBar.autoHideTime=t),this._horizontalScrollBar&&(this._horizontalScrollBar.autoHideTime=t)},getScrollBarAutoHideTime:function(){return cc.assert(this._scrollBarEnabled,"Scroll bar should be enabled!"),this._verticalScrollBar?this._verticalScrollBar.autoHideTime:this._horizontalScrollBar?this._horizontalScrollBar.autoHideTime:0},getInnerContainer:function(){return this._innerContainer},setLayoutType:function(t){this._innerContainer.setLayoutType(t)},getLayoutType:function(){return this._innerContainer.getLayoutType()},_doLayout:function(){this._doLayoutDirty&&(this._doLayoutDirty=!1)},getDescription:function(){return"ScrollView"},_createCloneInstance:function(){return new ccui.ScrollView},_copyClonedWidgetChildren:function(t){ccui.Layout.prototype._copyClonedWidgetChildren.call(this,t)},_copySpecialProperties:function(t){t instanceof ccui.ScrollView&&(ccui.Layout.prototype._copySpecialProperties.call(this,t),this.setInnerContainerSize(t.getInnerContainerSize()),this.setInnerContainerPosition(t.getInnerContainerPosition()),this.setDirection(t._direction),this._topBoundary=t._topBoundary,this._bottomBoundary=t._bottomBoundary,this._leftBoundary=t._leftBoundary,this._rightBoundary=t._rightBoundary,this._bePressed=t._bePressed,this._childFocusCancelOffset=t._childFocusCancelOffset,this._touchMoveDisplacements=t._touchMoveDisplacements,this._touchMoveTimeDeltas=t._touchMoveTimeDeltas,this._touchMovePreviousTimestamp=t._touchMovePreviousTimestamp,this._autoScrolling=t._autoScrolling,this._autoScrollAttenuate=t._autoScrollAttenuate,this._autoScrollStartPosition=t._autoScrollStartPosition,this._autoScrollTargetDelta=t._autoScrollTargetDelta,this._autoScrollTotalTime=t._autoScrollTotalTime,this._autoScrollAccumulatedTime=t._autoScrollAccumulatedTime,this._autoScrollCurrentlyOutOfBoundary=t._autoScrollCurrentlyOutOfBoundary,this._autoScrollBraking=t._autoScrollBraking,this._autoScrollBrakingStartPosition=t._autoScrollBrakingStartPosition,this.setBounceEnabled(t.bounceEnabled),this.setInertiaScrollEnabled(t.inertiaScrollEnabled),this._scrollViewEventListener=t._scrollViewEventListener,this._scrollViewEventSelector=t._scrollViewEventSelector,this._ccEventCallback=t._ccEventCallback,this.setScrollBarEnabled(t.isScrollBarEnabled()),this.isScrollBarEnabled())&&(this._direction!==ccui.ScrollView.DIR_HORIZONTAL&&this.setScrollBarPositionFromCornerForVertical(t.getScrollBarPositionFromCornerForVertical()),this._direction!==ccui.ScrollView.DIR_VERTICAL&&this.setScrollBarPositionFromCornerForHorizontal(t.getScrollBarPositionFromCornerForHorizontal()),this.setScrollBarWidth(t.getScrollBarWidth()),this.setScrollBarColor(t.getScrollBarColor()),this.setScrollBarAutoHideEnabled(t.isScrollBarAutoHideEnabled()),this.setScrollBarAutoHideTime(t.getScrollBarAutoHideTime()))},_initScrollBar:function(){this._direction===ccui.ScrollView.DIR_HORIZONTAL||this._verticalScrollBar||(this._verticalScrollBar=new ccui.ScrollViewBar(this,ccui.ScrollView.DIR_VERTICAL),this.addProtectedChild(this._verticalScrollBar,2)),this._direction===ccui.ScrollView.DIR_VERTICAL||this._horizontalScrollBar||(this._horizontalScrollBar=new ccui.ScrollViewBar(this,ccui.ScrollView.DIR_HORIZONTAL),this.addProtectedChild(this._horizontalScrollBar,2))},_removeScrollBar:function(){this._verticalScrollBar&&(this.removeProtectedChild(this._verticalScrollBar),this._verticalScrollBar=null),this._horizontalScrollBar&&(this.removeProtectedChild(this._horizontalScrollBar),this._horizontalScrollBar=null)},getNodeByTag:function(t){return this._innerContainer.getNodeByTag(t)},getNodes:function(){return this._innerContainer.getNodes()},removeNode:function(t){this._innerContainer.removeNode(t)},removeNodeByTag:function(t){this._innerContainer.removeNodeByTag(t)},removeAllNodes:function(){this._innerContainer.removeAllNodes()},addNode:function(t,e,i){this._innerContainer.addNode(t,e,i)}}),_p=ccui.ScrollView.prototype,cc.defineGetterSetter(_p,"innerWidth",_p._getInnerWidth,_p._setInnerWidth),cc.defineGetterSetter(_p,"innerHeight",_p._getInnerHeight,_p._setInnerHeight),cc.defineGetterSetter(_p,"direction",_p.getDirection,_p.setDirection),cc.defineGetterSetter(_p,"touchTotalTimeThreshold",_p.getTouchTotalTimeThreshold,_p.setTouchTotalTimeThreshold),_p=null,ccui.ScrollView.create=function(){return new ccui.ScrollView},ccui.ScrollView.DIR_NONE=0,ccui.ScrollView.DIR_VERTICAL=1,ccui.ScrollView.DIR_HORIZONTAL=2,ccui.ScrollView.DIR_BOTH=3,ccui.ScrollView.EVENT_SCROLL_TO_TOP=0,ccui.ScrollView.EVENT_SCROLL_TO_BOTTOM=1,ccui.ScrollView.EVENT_SCROLL_TO_LEFT=2,ccui.ScrollView.EVENT_SCROLL_TO_RIGHT=3,ccui.ScrollView.EVENT_SCROLLING=4,ccui.ScrollView.EVENT_BOUNCE_TOP=5,ccui.ScrollView.EVENT_BOUNCE_BOTTOM=6,ccui.ScrollView.EVENT_BOUNCE_LEFT=7,ccui.ScrollView.EVENT_BOUNCE_RIGHT=8,ccui.ScrollView.EVENT_CONTAINER_MOVED=9,ccui.ScrollView.EVENT_AUTOSCROLL_ENDED=10,ccui.ScrollView.MOVEDIR_TOP=0,ccui.ScrollView.MOVEDIR_BOTTOM=1,ccui.ScrollView.MOVEDIR_LEFT=2,ccui.ScrollView.MOVEDIR_RIGHT=3,ccui.ListView=ccui.ScrollView.extend({_model:null,_items:null,_gravity:null,_itemsMargin:0,_curSelectedIndex:0,_refreshViewDirty:!0,_listViewEventListener:null,_listViewEventSelector:null,_ccListViewEventCallback:null,_magneticAllowedOutOfBoundary:!0,_magneticType:0,_className:"ListView",ctor:function(){this._items=[],ccui.ScrollView.prototype.ctor.call(this),this._gravity=ccui.ListView.GRAVITY_CENTER_VERTICAL,this.setTouchEnabled(!0),this.setDirection(ccui.ScrollView.DIR_VERTICAL)},setItemModel:function(t){t?this._model=t:cc.log("Can't set a null to item model!")},_handleReleaseLogic:function(t){ccui.ScrollView.prototype._handleReleaseLogic.call(this,t),this._autoScrolling||this._startMagneticScroll()},_onItemListChanged:function(){this._outOfBoundaryAmountDirty=!0},_updateInnerContainerSize:function(){var t=this._items;switch(this.direction){case ccui.ScrollView.DIR_VERTICAL:for(var e,i=((e=t.length)-1)*this._itemsMargin,n=0;n<e;n++)i+=t[n].getContentSize().height;this.setInnerContainerSize(cc.size(this._contentSize.width,i));break;case ccui.ScrollView.DIR_HORIZONTAL:for(i=((e=t.length)-1)*this._itemsMargin,n=0;n<e;n++)i+=t[n].getContentSize().width;this.setInnerContainerSize(cc.size(i,this._contentSize.height))}},_remedyLayoutParameter:function(t){cc.assert(null!=t,"ListView Item can't be nil!");var e=t.getLayoutParameter(ccui.LayoutParameter.LINEAR),i=!0,n=(e||(e=new ccui.LinearLayoutParameter,i=!1),this.getIndex(t));switch(this.direction){case ccui.ScrollView.DIR_VERTICAL:this._remedyVerticalLayoutParameter(e,n);break;case ccui.ScrollView.DIR_HORIZONTAL:this._remedyHorizontalLayoutParameter(e,n)}i||t.setLayoutParameter(e)},_remedyVerticalLayoutParameter:function(t,e){switch(cc.assert(null!=t,"Layout parameter can't be nil!"),this._gravity){case ccui.ListView.GRAVITY_LEFT:t.setGravity(ccui.LinearLayoutParameter.LEFT);break;case ccui.ListView.GRAVITY_RIGHT:t.setGravity(ccui.LinearLayoutParameter.RIGHT);break;case ccui.ListView.GRAVITY_CENTER_HORIZONTAL:t.setGravity(ccui.LinearLayoutParameter.CENTER_HORIZONTAL)}0===e?t.setMargin(ccui.MarginZero()):t.setMargin(new ccui.Margin(0,this._itemsMargin,0,0))},_remedyHorizontalLayoutParameter:function(t,e){switch(cc.assert(null!=t,"Layout parameter can't be nil!"),this._gravity){case ccui.ListView.GRAVITY_TOP:t.setGravity(ccui.LinearLayoutParameter.TOP);break;case ccui.ListView.GRAVITY_BOTTOM:t.setGravity(ccui.LinearLayoutParameter.BOTTOM);break;case ccui.ListView.GRAVITY_CENTER_VERTICAL:t.setGravity(ccui.LinearLayoutParameter.CENTER_VERTICAL)}0===e?t.setMargin(ccui.MarginZero()):t.setMargin(new ccui.Margin(this._itemsMargin,0,0,0))},pushBackDefaultItem:function(){var t;null!=this._model&&(t=this._model.clone(),this._remedyLayoutParameter(t),this.addChild(t),this._refreshViewDirty=!0)},insertDefaultItem:function(t){var e;null!=this._model&&(e=this._model.clone(),this._items.splice(t,0,e),ccui.ScrollView.prototype.addChild.call(this,e),this._remedyLayoutParameter(e),this._refreshViewDirty=!0)},pushBackCustomItem:function(t){this._remedyLayoutParameter(t),this.addChild(t),this._refreshViewDirty=!0},addChild:function(t,e,i){t&&(e=e||t.getLocalZOrder(),i=i||t.getName(),ccui.ScrollView.prototype.addChild.call(this,t,e,i),t instanceof ccui.Widget)&&(this._items.push(t),this._onItemListChanged())},removeChild:function(t,e){var i;t&&(-1<(i=this._items.indexOf(t))&&this._items.splice(i,1),this._onItemListChanged(),ccui.ScrollView.prototype.removeChild.call(this,t,e))},removeAllChildren:function(){this.removeAllChildrenWithCleanup(!0)},removeAllChildrenWithCleanup:function(t){ccui.ScrollView.prototype.removeAllChildrenWithCleanup.call(this,t),this._items=[],this._onItemListChanged()},insertCustomItem:function(t,e){this._items.splice(e,0,t),this._onItemListChanged(),ccui.ScrollView.prototype.addChild.call(this,t),this._remedyLayoutParameter(t),this._refreshViewDirty=!0},removeItem:function(t){null!=(t=this.getItem(t))&&(this.removeChild(t,!0),this._refreshViewDirty=!0)},removeLastItem:function(){this.removeItem(this._items.length-1)},removeAllItems:function(){this.removeAllChildren()},getItem:function(t){return t<0||t>=this._items.length?null:this._items[t]},getItems:function(){return this._items},getIndex:function(t){return null==t?-1:this._items.indexOf(t)},setGravity:function(t){this._gravity!==t&&(this._gravity=t,this._refreshViewDirty=!0)},setMagneticType:function(t){this._magneticType=t,this._onItemListChanged(),this._startMagneticScroll()},getMagneticType:function(){return this._magneticType},setMagneticAllowedOutOfBoundary:function(t){this._magneticAllowedOutOfBoundary=t},getMagneticAllowedOutOfBoundary:function(){return this._magneticAllowedOutOfBoundary},setItemsMargin:function(t){this._itemsMargin!==t&&(this._itemsMargin=t,this._refreshViewDirty=!0)},getItemsMargin:function(){return this._itemsMargin},setDirection:function(t){switch(t){case ccui.ScrollView.DIR_VERTICAL:this.setLayoutType(ccui.Layout.LINEAR_VERTICAL);break;case ccui.ScrollView.DIR_HORIZONTAL:this.setLayoutType(ccui.Layout.LINEAR_HORIZONTAL);break;default:ccui.ScrollView.DIR_BOTH;return}ccui.ScrollView.prototype.setDirection.call(this,t)},_getHowMuchOutOfBoundary:function(t){if(void 0===t&&(t=cc.p(0,0)),!this._magneticAllowedOutOfBoundary||0===this._items.length)return ccui.ScrollView.prototype._getHowMuchOutOfBoundary.call(this,t);if(this._magneticType===ccui.ListView.MAGNETIC_NONE||this._magneticType===ccui.ListView.MAGNETIC_BOTH_END)return ccui.ScrollView.prototype._getHowMuchOutOfBoundary.call(this,t);if(0===t.x&&0===t.y&&!this._outOfBoundaryAmountDirty)return this._outOfBoundaryAmount;var e=this._leftBoundary,i=this._rightBoundary,n=this._topBoundary,s=this._bottomBoundary,r=this._items.length-1,o=this.getContentSize(),a=cc.p(0,0),c=cc.p(0,0);switch(this._magneticType){case ccui.ListView.MAGNETIC_CENTER:a.x=(o.width-this._items[0].width)/2,a.y=(o.height-this._items[0].height)/2,c.x=(o.width-this._items[r].width)/2,c.y=(o.height-this._items[r].height)/2;break;case ccui.ListView.MAGNETIC_LEFT:case ccui.ListView.MAGNETIC_TOP:c.x=o.width-this._items[r].width,c.y=o.height-this._items[r].height;break;case ccui.ListView.MAGNETIC_RIGHT:case ccui.ListView.MAGNETIC_BOTTOM:a.x=o.width-this._items[0].width,a.y=o.height-this._items[0].height}return e+=a.x,i-=c.x,n-=a.y,s+=c.y,r=cc.p(0,0),this._innerContainer.getLeftBoundary()+t.x>e?r.x=e-(this._innerContainer.getLeftBoundary()+t.x):this._innerContainer.getRightBoundary()+t.x<i&&(r.x=i-(this._innerContainer.getRightBoundary()+t.x)),this._innerContainer.getTopBoundary()+t.y<n?r.y=n-(this._innerContainer.getTopBoundary()+t.y):this._innerContainer.getBottomBoundary()+t.y>s&&(r.y=s-(this._innerContainer.getBottomBoundary()+t.y)),0===t.x&&0===t.y&&(this._outOfBoundaryAmount=r,this._outOfBoundaryAmountDirty=!1),r},_calculateItemPositionWithAnchor:function(t,e){var i=cc.p(t.getLeftBoundary(),t.getBottomBoundary()),t=t.getContentSize();return cc.p(i.x+t.width*e.x,i.y+t.height*e.y)},_findClosestItem:function(t,e,i,n,s,r,o){var a,c;return cc.assert(0<=n&&r<e.length&&n<=r,""),n===r?e[n]:1==r-n?s<=o?e[n]:e[r]:(a=Math.floor((n+r)/2),c=this._calculateItemPositionWithAnchor(e[a],i),c=cc.pLength(cc.pSub(t,c)),s<=o?this._findClosestItem(t,e,i,n,s,a,c):this._findClosestItem(t,e,i,a,c,r,o))},getClosestItemToPosition:function(t,e){var i,n,s;return 0===this._items.length?null:(i=this._calculateItemPositionWithAnchor(this._items[0],e),i=cc.pLength(cc.pSub(t,i)),n=this._items.length-1,s=this._calculateItemPositionWithAnchor(this._items[n],e),s=cc.pLength(cc.pSub(t,s)),this._findClosestItem(t,this._items,e,0,i,n,s))},getClosestItemToPositionInCurrentView:function(t,e){var i=this.getContentSize(),n=cc.pMult(this._innerContainer.getPosition(),-1);return n.x+=i.width*t.x,n.y+=i.height*t.y,this.getClosestItemToPosition(n,e)},getCenterItemInCurrentView:function(){return this.getClosestItemToPositionInCurrentView(cc.p(.5,.5),cc.p(.5,.5))},getLeftmostItemInCurrentView:function(){return this._direction===ccui.ScrollView.DIR_HORIZONTAL?this.getClosestItemToPositionInCurrentView(cc.p(0,.5),cc.p(.5,.5)):null},getRightmostItemInCurrentView:function(){return this._direction===ccui.ScrollView.DIR_HORIZONTAL?this.getClosestItemToPositionInCurrentView(cc.p(1,.5),cc.p(.5,.5)):null},getTopmostItemInCurrentView:function(){return this._direction===ccui.ScrollView.DIR_VERTICAL?this.getClosestItemToPositionInCurrentView(cc.p(.5,1),cc.p(.5,.5)):null},getBottommostItemInCurrentView:function(){return this._direction===ccui.ScrollView.DIR_VERTICAL?this.getClosestItemToPositionInCurrentView(cc.p(.5,0),cc.p(.5,.5)):null},_calculateItemDestination:function(t,e,i){var n=this.getContentSize(),s=cc.p(0,0);return s.x+=n.width*t.x,s.y+=n.height*t.y,t=this._calculateItemPositionWithAnchor(e,i),cc.pMult(cc.pSub(t,s),-1)},jumpToBottom:function(){this.doLayout(),ccui.ScrollView.prototype.jumpToBottom.call(this)},jumpToTop:function(){this.doLayout(),ccui.ScrollView.prototype.jumpToTop.call(this)},jumpToLeft:function(){this.doLayout(),ccui.ScrollView.prototype.jumpToLeft.call(this)},jumpToRight:function(){this.doLayout(),ccui.ScrollView.prototype.jumpToRight.call(this)},jumpToTopLeft:function(){this.doLayout(),ccui.ScrollView.prototype.jumpToTopLeft.call(this)},jumpToTopRight:function(){this.doLayout(),ccui.ScrollView.prototype.jumpToTopRight.call(this)},jumpToBottomLeft:function(){this.doLayout(),ccui.ScrollView.prototype.jumpToBottomLeft.call(this)},jumpToBottomRight:function(){this.doLayout(),ccui.ScrollView.prototype.jumpToBottomRight.call(this)},jumpToPercentVertical:function(t){this.doLayout(),ccui.ScrollView.prototype.jumpToPercentVertical.call(this,t)},jumpToPercentHorizontal:function(t){this.doLayout(),ccui.ScrollView.prototype.jumpToPercentHorizontal.call(this,t)},jumpToPercentBothDirection:function(t){this.doLayout(),ccui.ScrollView.prototype.jumpToPercentBothDirection.call(this,t)},jumpToItem:function(t,e,i){(t=this.getItem(t))&&(this.doLayout(),e=this._calculateItemDestination(e,t,i),this.bounceEnabled||(i=cc.pSub(e,this._innerContainer.getPosition()),i=this._getHowMuchOutOfBoundary(i),e.x+=i.x,e.y+=i.y),this._jumpToDestination(e))},scrollToItem:function(t,e,i,n){void 0===n&&(n=1),(t=this.getItem(t))&&(e=this._calculateItemDestination(e,t,i),this._startAutoScrollToDestination(e,n,!0))},requestRefreshView:function(){this._refreshViewDirty=!0},refreshView:function(){this.forceDoLayout()},doLayout:function(){this._doLayout()},requestDoLayout:function(){this._refreshViewDirty=!0},_doLayout:function(){if(this._refreshViewDirty){for(var t=this._items,e=0;e<t.length;e++){var i=t[e];i.setLocalZOrder(e),this._remedyLayoutParameter(i)}this._updateInnerContainerSize(),this._innerContainer.forceDoLayout(),this._refreshViewDirty=!1}},addEventListenerListView:function(t,e){this._listViewEventListener=e,this._listViewEventSelector=t},addEventListener:function(t){this._ccListViewEventCallback=t},_selectedItemEvent:function(t){t=t===ccui.Widget.TOUCH_BEGAN?ccui.ListView.ON_SELECTED_ITEM_START:ccui.ListView.ON_SELECTED_ITEM_END,this._listViewEventSelector&&(this._listViewEventListener?this._listViewEventSelector.call(this._listViewEventListener,this,t):this._listViewEventSelector(this,t)),this._ccListViewEventCallback&&this._ccListViewEventCallback(this,t)},interceptTouchEvent:function(t,e,i){if(ccui.ScrollView.prototype.interceptTouchEvent.call(this,t,e,i),this._touchEnabled&&t!==ccui.Widget.TOUCH_MOVED){for(i=e;i;){if(i&&i.getParent()===this._innerContainer){this._curSelectedIndex=this.getIndex(i);break}i=i.getParent()}e.isHighlighted()&&this._selectedItemEvent(t)}},getCurSelectedIndex:function(){return this._curSelectedIndex},_onSizeChanged:function(){ccui.ScrollView.prototype._onSizeChanged.call(this),this._refreshViewDirty=!0},getDescription:function(){return"ListView"},_createCloneInstance:function(){return new ccui.ListView},_copyClonedWidgetChildren:function(t){t=t.getItems();for(var e=0;e<t.length;e++)this.pushBackCustomItem(t[e].clone())},_copySpecialProperties:function(t){t instanceof ccui.ListView&&(ccui.ScrollView.prototype._copySpecialProperties.call(this,t),this.setItemModel(t._model),this.setItemsMargin(t._itemsMargin),this.setGravity(t._gravity),this._listViewEventListener=t._listViewEventListener,this._listViewEventSelector=t._listViewEventSelector)},_startAttenuatingAutoScroll:function(t,e){var i,n;0!==this._items.length&&this._magneticType!==ccui.ListView.MAGNETIC_NONE&&(t=this._flattenVectorByDirection(t),0===(n=this._getHowMuchOutOfBoundary(t)).x)&&0===n.y&&((n=this._magneticType)===ccui.ListView.MAGNETIC_BOTH_END&&(this._direction===ccui.ScrollView.DIR_HORIZONTAL?n=0<t.x?ccui.ListView.MAGNETIC_LEFT:ccui.ListView.MAGNETIC_RIGHT:this._direction===ccui.ScrollView.DIR_VERTICAL&&(n=0<t.y?ccui.ListView.MAGNETIC_BOTTOM:ccui.ListView.MAGNETIC_TOP)),i=this._getAnchorPointByMagneticType(n),(n=cc.pMult(this._innerContainer.getPosition(),-1)).x+=this.width*i.x,n.y+=this.height*i.y,t=this.getClosestItemToPosition(cc.pSub(n,t),i),t=this._calculateItemPositionWithAnchor(t,i),t=cc.pSub(n,t)),ccui.ScrollView.prototype._startAttenuatingAutoScroll.call(this,t,e)},_getAnchorPointByMagneticType:function(t){switch(t){case ccui.ListView.MAGNETIC_BOTH_END:return cc.p(0,1);case ccui.ListView.MAGNETIC_CENTER:return cc.p(.5,.5);case ccui.ListView.MAGNETIC_LEFT:return cc.p(0,.5);case ccui.ListView.MAGNETIC_RIGHT:return cc.p(1,.5);case ccui.ListView.MAGNETIC_TOP:return cc.p(.5,1);case ccui.ListView.MAGNETIC_BOTTOM:return cc.p(.5,0)}return cc.p(0,0)},_startMagneticScroll:function(){var t,e;0!==this._items.length&&this._magneticType!==ccui.ListView.MAGNETIC_NONE&&(t=this._getAnchorPointByMagneticType(this._magneticType),(e=cc.pMult(this._innerContainer.getPosition(),-1)).x+=this.width*t.x,e.y+=this.height*t.y,e=this.getClosestItemToPosition(e,t),this.scrollToItem(this.getIndex(e),t,t))}}),ccui.ListView.create=function(){return new ccui.ListView},ccui.ListView.EVENT_SELECTED_ITEM=0,ccui.ListView.ON_SELECTED_ITEM_START=0,ccui.ListView.ON_SELECTED_ITEM_END=1,ccui.ListView.GRAVITY_LEFT=0,ccui.ListView.GRAVITY_RIGHT=1,ccui.ListView.GRAVITY_CENTER_HORIZONTAL=2,ccui.ListView.GRAVITY_TOP=3,ccui.ListView.GRAVITY_BOTTOM=4,ccui.ListView.GRAVITY_CENTER_VERTICAL=5,ccui.ListView.MAGNETIC_NONE=0,ccui.ListView.MAGNETIC_CENTER=1,ccui.ListView.MAGNETIC_BOTH_END=2,ccui.ListView.MAGNETIC_LEFT=3,ccui.ListView.MAGNETIC_RIGHT=4,ccui.ListView.MAGNETIC_TOP=5,ccui.ListView.MAGNETIC_BOTTOM=6,ccui.PageView=ccui.ListView.extend({_curPageIdx:0,_childFocusCancelOffset:0,_pageViewEventListener:null,_pageViewEventSelector:null,_className:"PageView",_indicator:null,_indicatorPositionAsAnchorPoint:null,ctor:function(){ccui.ListView.prototype.ctor.call(this),this._childFocusCancelOffset=5,this._indicatorPositionAsAnchorPoint=cc.p(.5,.1),this._pageViewEventSelector=this._pageViewEventListener=null,this.setDirection(ccui.ScrollView.DIR_HORIZONTAL),this.setMagneticType(ccui.ListView.MAGNETIC_CENTER),this.setScrollBarEnabled(!1)},addWidgetToPage:function(t,e,i){this.insertCustomItem(t,e)},addPage:function(t){this.pushBackCustomItem(t)},insertPage:function(t,e){this.insertCustomItem(t,e)},removePage:function(t){this.removeItem(this.getIndex(t))},removePageAtIndex:function(t){this.removeItem(t)},removeAllPages:function(){this.removeAllItems()},scrollToItem:function(t){ccui.ListView.prototype.scrollToItem.call(this,t,cc.p(.5,.5),cc.p(.5,.5))},scrollToPage:function(t){this.scrollToItem(t)},_doLayout:function(){var t;this._refreshViewDirty&&(ccui.ListView.prototype._doLayout.call(this),this._indicator&&(t=this.getIndex(this.getCenterItemInCurrentView()),this._indicator.indicate(t)),this._refreshViewDirty=!1)},setDirection:function(t){ccui.ListView.prototype.setDirection.call(this,t),t===ccui.ScrollView.DIR_HORIZONTAL?this._indicatorPositionAsAnchorPoint=cc.p(.5,.1):t===ccui.ScrollView.DIR_VERTICAL&&(this._indicatorPositionAsAnchorPoint=cc.p(.1,.5)),this._indicator&&(this._indicator.setDirection(t),this._refreshIndicatorPosition())},setCustomScrollThreshold:function(t){},getCustomScrollThreshold:function(){return 0},setUsingCustomScrollThreshold:function(t){},isUsingCustomScrollThreshold:function(){return!1},_moveInnerContainer:function(t,e){ccui.ListView.prototype._moveInnerContainer.call(this,t,e),this._curPageIdx=this.getIndex(this.getCenterItemInCurrentView()),this._indicator&&this._indicator.indicate(this._curPageIdx)},_onItemListChanged:function(){ccui.ListView.prototype._onItemListChanged.call(this),this._indicator&&this._indicator.reset(this._items.length)},_onSizeChanged:function(){ccui.ListView.prototype._onSizeChanged.call(this),this._refreshIndicatorPosition()},_remedyLayoutParameter:function(t){t.setContentSize(this.getContentSize()),ccui.ListView.prototype._remedyLayoutParameter.call(this,t)},_refreshIndicatorPosition:function(){var t;this._indicator&&(t=this.getContentSize(),this._indicator.setPosition(cc.p(t.width*this._indicatorPositionAsAnchorPoint.x,t.height*this._indicatorPositionAsAnchorPoint.y)))},_handleReleaseLogic:function(t){var e;ccui.ScrollView.prototype._handleReleaseLogic.call(this,t),this._items.length<=0||(t=this._flattenVectorByDirection(this._calculateTouchMoveVelocity()),cc.pLength(t)<500||(e=this.getItem(this._curPageIdx),e=this._calculateItemDestination(cc.p(.5,.5),e,cc.p(.5,.5)),e=cc.pSub(e,this.getInnerContainerPosition()),e=this._flattenVectorByDirection(e),0<t.x*e.x)||0<t.y*e.y?this._startMagneticScroll():(t.x<0||0<t.y?++this._curPageIdx:--this._curPageIdx,this._curPageIdx=Math.min(this._curPageIdx,this._items.length),this._curPageIdx=Math.max(this._curPageIdx,0),this.scrollToItem(this._curPageIdx)))},_getAutoScrollStopEpsilon:function(){return.001},_pageTurningEvent:function(){this._pageViewEventSelector&&(this._pageViewEventListener?this._pageViewEventSelector.call(this._pageViewEventListener,this,ccui.PageView.EVENT_TURNING):this._pageViewEventSelector(this,ccui.PageView.EVENT_TURNING)),this._ccEventCallback&&this._ccEventCallback(this,ccui.PageView.EVENT_TURNING)},addEventListenerPageView:function(t,e){this._pageViewEventSelector=t,this._pageViewEventListener=e},addEventListener:function(i){this._ccEventCallback=function(t,e){e==ccui.ScrollView.EVENT_AUTOSCROLL_ENDED&&i(this,e)}},setCurrentPageIndex:function(t){this.jumpToItem(t,cc.p(.5,.5),cc.p(.5,.5))},setCurPageIndex:function(t){this.setCurrentPageIndex(t)},getCurrentPageIndex:function(){return this._curPageIdx},getCurPageIndex:function(){var t=this.getCenterItemInCurrentView();return this.getIndex(t)},getPages:function(){return this.getItems()},getPage:function(t){return this.getItem(t)},getDescription:function(){return"PageView"},_createCloneInstance:function(){return new ccui.PageView},_copyClonedWidgetChildren:function(t){t=t.getPages();for(var e=0;e<t.length;e++)this.addPage(t[e].clone())},_copySpecialProperties:function(t){ccui.ListView.prototype._copySpecialProperties.call(this,t),this._ccEventCallback=t._ccEventCallback,this._pageViewEventListener=t._pageViewEventListener,this._pageViewEventSelector=t._pageViewEventSelector,this._customScrollThreshold=t._customScrollThreshold},setIndicatorEnabled:function(t){t!=(null!==this._indicator)&&(t?(this._indicator=new ccui.PageViewIndicator,this._indicator.setDirection(this.getDirection()),this.addProtectedChild(this._indicator,1e4),this.setIndicatorSelectedIndexColor(cc.color(100,100,255)),this._refreshIndicatorPosition()):(this.removeProtectedChild(this._indicator),this._indicator=null))},getIndicatorEnabled:function(){return null!==this._indicator},setIndicatorPositionAsAnchorPoint:function(t){this._indicatorPositionAsAnchorPoint=t,this._refreshIndicatorPosition()},getIndicatorPositionAsAnchorPoint:function(){return this._indicatorPositionAsAnchorPoint},setIndicatorPosition:function(t){var e;this._indicator&&(e=this.getContentSize(),this._indicatorPositionAsAnchorPoint.x=t.x/e.width,this._indicatorPositionAsAnchorPoint.y=t.y/e.height,this._indicator.setPosition(t))},getIndicatorPosition:function(){return cc.assert(null!==this._indicator,""),this._indicator.getPosition()},setIndicatorSpaceBetweenIndexNodes:function(t){this._indicator&&this._indicator.setSpaceBetweenIndexNodes(t)},getIndicatorSpaceBetweenIndexNodes:function(){return cc.assert(null!==this._indicator,""),this._indicator.getSpaceBetweenIndexNodes()},setIndicatorSelectedIndexColor:function(t){this._indicator&&this._indicator.setSelectedIndexColor(t)},getIndicatorSelectedIndexColor:function(){return cc.assert(null!==this._indicator,""),this._indicator.getSelectedIndexColor()},setIndicatorIndexNodesColor:function(t){this._indicator&&this._indicator.setIndexNodesColor(t)},getIndicatorIndexNodesColor:function(){return cc.assert(null!==this._indicator,""),this._indicator.getIndexNodesColor()},setIndicatorIndexNodesScale:function(t){this._indicator&&(this._indicator.setIndexNodesScale(t),this._indicator.indicate(this._curPageIdx))},getIndicatorIndexNodesScale:function(){return cc.assert(null!==this._indicator,""),this._indicator.getIndexNodesScale()},setIndicatorIndexNodesTexture:function(t,e){this._indicator&&(this._indicator.setIndexNodesTexture(t,e),this._indicator.indicate(this._curPageIdx))}}),ccui.PageView.create=function(){return new ccui.PageView},ccui.PageView.EVENT_TURNING=0,ccui.PageView.TOUCH_DIR_LEFT=0,ccui.PageView.TOUCH_DIR_RIGHT=1,ccui.PageView.DIRECTION_LEFT=0,ccui.PageView.DIRECTION_RIGHT=1,ccui.PageViewIndicator=ccui.ProtectedNode.extend({_direction:null,_indexNodes:null,_currentIndexNode:null,_spaceBetweenIndexNodes:0,_indexNodesScale:1,_indexNodesColor:null,_useDefaultTexture:!0,_indexNodesTextureFile:"",_indexNodesTexType:ccui.Widget.LOCAL_TEXTURE,_className:"PageViewIndicator",ctor:function(){cc.ProtectedNode.prototype.ctor.call(this),this._direction=ccui.ScrollView.DIR_HORIZONTAL,this._indexNodes=[],this._spaceBetweenIndexNodes=ccui.PageViewIndicator.SPACE_BETWEEN_INDEX_NODES_DEFAULT,this._indexNodesColor=cc.color.WHITE,this._currentIndexNode=ccui.helper._createSpriteFromBase64(ccui.PageViewIndicator.CIRCLE_IMAGE,ccui.PageViewIndicator.CIRCLE_IMAGE_KEY),this._currentIndexNode.setVisible(!1),this.addProtectedChild(this._currentIndexNode,1)},setDirection:function(t){this._direction=t,this._rearrange()},reset:function(t){for(;this._indexNodes.length<t;)this._increaseNumberOfPages();for(;this._indexNodes.length>t;)this._decreaseNumberOfPages();this._rearrange(),this._currentIndexNode.setVisible(0<this._indexNodes.length)},indicate:function(t){t<0||t>=this._indexNodes.length||this._currentIndexNode.setPosition(this._indexNodes[t].getPosition())},_rearrange:function(){if(0!==this._indexNodes.length)for(var t=this._direction===ccui.ScrollView.DIR_HORIZONTAL,e=this._indexNodes[0].getContentSize(),i=t?e.width:e.height,n=-(i*(n=this._indexNodes.length)+this._spaceBetweenIndexNodes*(n-1))/2+i/2,s=0;s<this._indexNodes.length;++s){var r=t?cc.p(n,e.height/2):cc.p(e.width/2,-n);this._indexNodes[s].setPosition(r),n+=i+this._spaceBetweenIndexNodes}},setSpaceBetweenIndexNodes:function(t){this._spaceBetweenIndexNodes!==t&&(this._spaceBetweenIndexNodes=t,this._rearrange())},getSpaceBetweenIndexNodes:function(){return this._spaceBetweenIndexNodes},setSelectedIndexColor:function(t){this._currentIndexNode.setColor(t)},getSelectedIndexColor:function(){return this._currentIndexNode.getColor()},setIndexNodesColor:function(t){this._indexNodesColor=t;for(var e=0;e<this._indexNodes.length;++e)this._indexNodes[e].setColor(t)},getIndexNodesColor:function(){var t=this._indexNodesColor;return cc.color(t.r,t.g,t.b,t.a)},setIndexNodesScale:function(t){if(this._indexNodesScale!==t){for(this._indexNodesScale=t,this._currentIndexNode.setScale(t),t=0;t<this._indexNodes.length;++t)this._indexNodes[t].setScale(this,_indexNodesScale);this._rearrange()}},getIndexNodesScale:function(){return this._indexNodesScale},setIndexNodesTexture:function(t,e){switch(void 0===e&&(e=ccui.Widget.LOCAL_TEXTURE),this._useDefaultTexture=!1,this._indexNodesTextureFile=t,this._indexNodesTexType=e){case ccui.Widget.LOCAL_TEXTURE:this._currentIndexNode.setTexture(t);for(var i=0;i<this._indexNodes.length;++i)this._indexNodes[i].setTexture(t);break;case ccui.Widget.PLIST_TEXTURE:for(this._currentIndexNode.setSpriteFrame(t),i=0;i<this._indexNodes.length;++i)this._indexNodes[i].setSpriteFrame(t)}this._rearrange()},_increaseNumberOfPages:function(){var t;if(this._useDefaultTexture)t=ccui.helper._createSpriteFromBase64(ccui.PageViewIndicator.CIRCLE_IMAGE,ccui.PageViewIndicator.CIRCLE_IMAGE_KEY);else switch(t=new cc.Sprite,this._indexNodesTexType){case ccui.Widget.LOCAL_TEXTURE:t.initWithFile(this._indexNodesTextureFile);break;case ccui.Widget.PLIST_TEXTURE:t.initWithSpriteFrameName(this._indexNodesTextureFile)}t.setColor(this._indexNodesColor),t.setScale(this._indexNodesScale),this.addProtectedChild(t),this._indexNodes.push(t)},_decreaseNumberOfPages:function(){0!==this._indexNodes.length&&(this.removeProtectedChild(this._indexNodes[0]),this._indexNodes.splice(0,1))},clear:function(){for(var t=0;t<this._indexNodes.length;++t)this.removeProtectedChild(this._indexNodes[t]);this._indexNodes.length=0,this._currentIndexNode.setVisible(!1)}}),_p=ccui.PageViewIndicator.prototype,cc.defineGetterSetter(_p,"spaceBetweenIndexNodes",_p.getSpaceBetweenIndexNodes,_p.setSpaceBetweenIndexNodes),ccui.PageViewIndicator.SPACE_BETWEEN_INDEX_NODES_DEFAULT=23,ccui.PageViewIndicator.CIRCLE_IMAGE_KEY="/__circle_image",ccui.PageViewIndicator.CIRCLE_IMAGE="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAQAAADZc7J/AAAA8ElEQVRIx62VyRGCQBBF+6gWRCEmYDIQkhiBCgHhSclC8YqWzOV5oVzKAYZp3r1/9fpbxAIBMTsKrjx5cqVgR0wgLhCRUWOjJiPqD56xoaGPhpRZV/iSEy6crHmw5oIrF9b/lVeMofrJgjlnxlIy/wik+JB+mme8BExbBhm+5CJC2LE2LtSEQoyGWDioBA5CoRIohJtK4CYDxzNEM4GAugR1E9VjVC+SZpXvhCJCrjomESLvc17pDGX7bWmlh6UtpjPVCWy9zaJ0TD7qfm3pwERMz2trRVZk3K3BD/L34AY+dEDCniMVBkPFkT2J/b2/AIV+dRpFLOYoAAAAAElFTkSuQmCC",!function(){var t;ccui.ProtectedNode.CanvasRenderCmd&&(ccui.ScrollView.CanvasRenderCmd=function(t){this._layoutCmdCtor(t),this._dirty=!1},(t=ccui.ScrollView.CanvasRenderCmd.prototype=Object.create(ccui.Layout.CanvasRenderCmd.prototype)).constructor=ccui.ScrollView.CanvasRenderCmd,t.rendering=function(t){var e,i=cc.renderer._cacheToCanvasCmds[this._node.__instanceId],n=cc.view.getScaleX(),s=cc.view.getScaleY(),r=t||cc._renderContext;for(r.computeRealOffsetY(),this._node.updateChildren(),t=0,e=i.length;t<e;t++){var o=i[t]._node;o instanceof ccui.ScrollView||o&&o._parent&&!1===o._parent._inViewRect||i[t].rendering(r,n,s)}})}(),!function(){var t;ccui.ProtectedNode.WebGLRenderCmd&&(ccui.ScrollView.WebGLRenderCmd=function(t){this._layoutCmdCtor(t),this._needDraw=!0,this._dirty=!1},(t=ccui.ScrollView.WebGLRenderCmd.prototype=Object.create(ccui.Layout.WebGLRenderCmd.prototype)).constructor=ccui.ScrollView.WebGLRenderCmd,t.rendering=function(t){var e,i,n,s=cc.renderer._cacheToBufferCmds[this._node.__instanceId],r=t||cc._renderContext;if(s)for(this._node.updateChildren(),r.bindBuffer(gl.ARRAY_BUFFER,null),t=0,e=s.length;t<e;t++)(i=(n=s[t])._node)&&i._parent&&!1===i._parent._inViewRect||(n.uploadData?cc.renderer._uploadBufferData(n):(0<n._batchingSize&&cc.renderer._batchRendering(),n.rendering(r)),cc.renderer._batchRendering())})}(),cc.Component=cc.Class.extend({_owner:null,_name:"",_enabled:!0,ctor:function(){this._owner=null,this._name="",this._enabled=!0},init:function(){return!0},onEnter:function(){},onExit:function(){},update:function(t){},serialize:function(t){},isEnabled:function(){return this._enabled},setEnabled:function(t){this._enabled=t},getName:function(){return this._name},setName:function(t){this._name=t},setOwner:function(t){this._owner=t},getOwner:function(){return this._owner}}),cc.Component.create=function(){return new cc.Component},cc.ComponentContainer=cc.Class.extend({_components:null,_owner:null,ctor:function(t){this._components=null,this._owner=t},getComponent:function(t){if(t)return t=t.trim(),this._components||(this._components={}),this._components[t];throw Error("cc.ComponentContainer.getComponent(): name should be non-null")},add:function(t){if(t)return t.getOwner()||(null==this._components&&(this._components={},this._owner.scheduleUpdate()),this._components[t.getName()])?(cc.log("cc.ComponentContainer.add(): Component already added. It can't be added again"),!1):(t.setOwner(this._owner),(this._components[t.getName()]=t).onEnter(),!0);throw Error("cc.ComponentContainer.add(): component should be non-null")},remove:function(t){if(t)return!!this._components&&(t instanceof cc.Component?this._removeByComponent(t):(t=t.trim(),this._removeByComponent(this._components[t])));throw Error("cc.ComponentContainer.remove(): name should be non-null")},_removeByComponent:function(t){return!!t&&(t.onExit(),t.setOwner(null),delete this._components[t.getName()],!0)},removeAll:function(){if(this._components){var t,e=this._components;for(t in e){var i=e[t];i.onExit(),i.setOwner(null),delete e[t]}this._owner.unscheduleUpdate(),this._components=null}},_alloc:function(){this._components={}},visit:function(t){if(this._components){var e,i=this._components;for(e in i)i[e].update(t)}},isEmpty:function(){return!this._components||0===this._components.length}}),ccui.LayoutComponent_ReferencePoint={BOTTOM_LEFT:0,TOP_LEFT:1,BOTTOM_RIGHT:2,TOP_RIGHT:3},ccui.LayoutComponent_PositionType={Position:0,RelativePosition:1,PreRelativePosition:2,PreRelativePositionEnable:3},ccui.LayoutComponent_SizeType={Size:0,PreSize:1,PreSizeEnable:2},ccui.LayoutComponent=cc.Component.extend({_horizontalEdge:0,_verticalEdge:0,_leftMargin:0,_rightMargin:0,_bottomMargin:0,_topMargin:0,_usingPositionPercentX:!1,_positionPercentX:0,_usingPositionPercentY:!1,_positionPercentY:0,_usingStretchWidth:!1,_usingStretchHeight:!1,_percentWidth:0,_usingPercentWidth:!1,_percentHeight:0,_usingPercentHeight:!1,_actived:!0,_isPercentOnly:!1,ctor:function(){this._name=ccui.LayoutComponent.NAME},init:function(){return!!cc.Component.prototype.init.call(this)},getPercentContentSize:function(){return cc.p(this._percentWidth,this._percentHeight)},setPercentContentSize:function(t){this.setPercentWidth(t.x),this.setPercentHeight(t.y)},setUsingPercentContentSize:function(t){this._usingPercentWidth=this._usingPercentHeight=t},SetActiveEnable:function(t){this._actived=t},getUsingPercentContentSize:function(){return this._usingPercentWidth&&this._usingPercentHeight},getAnchorPosition:function(){return this._owner.getAnchorPoint()},setAnchorPosition:function(t,e){var i=this._owner.getBoundingBox(),t=(this._owner.setAnchorPoint(t,e),this._owner.getBoundingBox()),e=i.x-t.x,i=i.y-t.y;(t=this._owner.getPosition()).x+=e,t.y+=i,this.setPosition(t)},getPosition:function(){return this._owner.getPosition()},setPosition:function(t,e){var i,n=this._getOwnerParent();null!=n?(void 0===e?(i=t.x,e=t.y):i=t,0!==(n=n.getContentSize()).width?this._positionPercentX=i/n.width:(this._positionPercentX=0,this._usingPositionPercentX&&(i=0)),0!==n.height?this._positionPercentY=e/n.height:(this._positionPercentY=0,this._usingPositionPercentY&&(e=0)),this._owner.setPosition(i,e),this._refreshHorizontalMargin(),this._refreshVerticalMargin()):this._owner.setPosition(t,e)},isPositionPercentXEnabled:function(){return this._usingPositionPercentX},setPositionPercentXEnabled:function(t){(this._usingPositionPercentX=t)&&(this._horizontalEdge=ccui.LayoutComponent.horizontalEdge.NONE)},getPositionPercentX:function(){return this._positionPercentX},setPositionPercentX:function(t){this._positionPercentX=t,null!==(t=this._getOwnerParent())&&(this._owner.setPositionX(t.width*this._positionPercentX),this._refreshHorizontalMargin())},isPositionPercentYEnabled:function(){return this._usingPositionPercentY},setPositionPercentYEnabled:function(t){(this._usingPositionPercentY=t)&&(this._verticalEdge=ccui.LayoutComponent.verticalEdge.NONE)},getPositionPercentY:function(){return this._positionPercentY},setPositionPercentY:function(t){this._positionPercentY=t,null!==(t=this._getOwnerParent())&&(this._owner.setPositionY(t.height*this._positionPercentY),this._refreshVerticalMargin())},getHorizontalEdge:function(){return this._horizontalEdge},setHorizontalEdge:function(t){this._horizontalEdge=t,this._horizontalEdge!==ccui.LayoutComponent.horizontalEdge.NONE&&(this._usingPositionPercentX=!1);var e=this._getOwnerParent();null!==e&&(t=this._owner.getPosition(),0!==(e=e.getContentSize()).width?this._positionPercentX=t.x/e.width:(this._positionPercentX=0,t.x=0,this._usingPositionPercentX&&this._owner.setPosition(t)),this._refreshHorizontalMargin())},getVerticalEdge:function(){return this._verticalEdge},setVerticalEdge:function(t){this._verticalEdge=t,this._verticalEdge!==ccui.LayoutComponent.verticalEdge.NONE&&(this._usingPositionPercentY=!1);var e=this._getOwnerParent();null!==e&&(t=this._owner.getPosition(),0!==(e=e.getContentSize()).height?this._positionPercentY=t.y/e.height:(this._positionPercentY=0,t.y=0,this._usingPositionPercentY&&this._owner.setPosition(t)),this._refreshVerticalMargin())},getLeftMargin:function(){return this._leftMargin},setLeftMargin:function(t){this._leftMargin=t},getRightMargin:function(){return this._rightMargin},setRightMargin:function(t){this._rightMargin=t},getTopMargin:function(){return this._topMargin},setTopMargin:function(t){this._topMargin=t},getBottomMargin:function(){return this._bottomMargin},setBottomMargin:function(t){this._bottomMargin=t},getSize:function(){return this.getOwner().getContentSize()},setSize:function(t){var e=this._getOwnerParent();null!==e?(0!==(e=e.getContentSize()).width?this._percentWidth=t.width/e.width:(this._percentWidth=0,this._usingPercentWidth&&(t.width=0)),0!==e.height?this._percentHeight=t.height/e.height:(this._percentHeight=0,this._usingPercentHeight&&(t.height=0)),this._owner.setContentSize(t),this._refreshHorizontalMargin(),this._refreshVerticalMargin()):this._owner.setContentSize(t)},isPercentWidthEnabled:function(){return this._usingPercentWidth},setPercentWidthEnabled:function(t){(this._usingPercentWidth=t)&&(this._usingStretchWidth=!1)},getSizeWidth:function(){return this._owner.width},setSizeWidth:function(t){var e=this._owner.getContentSize();e.width=t,null!==(t=this._getOwnerParent())?(0!==(t=t.getContentSize()).width?this._percentWidth=e.width/t.width:(this._percentWidth=0,this._usingPercentWidth&&(e.width=0)),this._owner.setContentSize(e),this._refreshHorizontalMargin()):this._owner.setContentSize(e)},getPercentWidth:function(){return this._percentWidth},setPercentWidth:function(t){var e;this._percentWidth=t,null!==(t=this._getOwnerParent())&&((e=this._owner.getContentSize()).width=t.width*this._percentWidth,this._owner.setContentSize(e),this._refreshHorizontalMargin())},isPercentHeightEnabled:function(){return this._usingPercentHeight},setPercentHeightEnabled:function(t){(this._usingPercentHeight=t)&&(this._usingStretchHeight=!1)},getSizeHeight:function(){return this._owner.height},setSizeHeight:function(t){var e=this._owner.getContentSize();e.height=t,null!==(t=this._getOwnerParent())?(0!==(t=t.getContentSize()).height?this._percentHeight=e.height/t.height:(this._percentHeight=0,this._usingPercentHeight&&(e.height=0)),this._owner.setContentSize(e),this._refreshVerticalMargin()):this._owner.setContentSize(e)},getPercentHeight:function(){return this._percentHeight},setPercentHeight:function(t){var e;this._percentHeight=t,null!==(t=this._getOwnerParent())&&((e=this._owner.getContentSize()).height=t.height*this._percentHeight,this._owner.setContentSize(e),this._refreshVerticalMargin())},isStretchWidthEnabled:function(){return this._usingStretchWidth},setStretchWidthEnabled:function(t){(this._usingStretchWidth=t)&&(this._usingPercentWidth=!1)},isStretchHeightEnabled:function(){return this._usingStretchHeight},setStretchHeightEnabled:function(t){(this._usingStretchHeight=t)&&(this._usingPercentHeight=!1)},setPercentOnlyEnabled:function(t){this._isPercentOnly=t},setActiveEnabled:function(t){this._actived=t},refreshLayout:function(){if(this._actived&&null!==(t=this._getOwnerParent())){var t=t.getContentSize(),e=this._owner,i=e.getAnchorPoint(),n=e.getContentSize(),s=e.getPosition();switch(this._horizontalEdge){case ccui.LayoutComponent.horizontalEdge.NONE:this._usingStretchWidth&&!this._isPercentOnly?(n.width=t.width*this._percentWidth,s.x=this._leftMargin+i.x*n.width):(this._usingPositionPercentX&&(s.x=t.width*this._positionPercentX),this._usingPercentWidth&&(n.width=t.width*this._percentWidth));break;case ccui.LayoutComponent.horizontalEdge.LEFT:this._isPercentOnly||((this._usingPercentWidth||this._usingStretchWidth)&&(n.width=t.width*this._percentWidth),s.x=this._leftMargin+i.x*n.width);break;case ccui.LayoutComponent.horizontalEdge.RIGHT:this._isPercentOnly||((this._usingPercentWidth||this._usingStretchWidth)&&(n.width=t.width*this._percentWidth),s.x=t.width-(this._rightMargin+(1-i.x)*n.width));break;case ccui.LayoutComponent.horizontalEdge.CENTER:this._isPercentOnly||(this._usingStretchWidth?(n.width=t.width-this._leftMargin-this._rightMargin,n.width<0&&(n.width=0),s.x=this._leftMargin+i.x*n.width):(this._usingPercentWidth&&(n.width=t.width*this._percentWidth),s.x=t.width*this._positionPercentX))}switch(this._verticalEdge){case ccui.LayoutComponent.verticalEdge.NONE:this._usingStretchHeight&&!this._isPercentOnly?(n.height=t.height*this._percentHeight,s.y=this._bottomMargin+i.y*n.height):(this._usingPositionPercentY&&(s.y=t.height*this._positionPercentY),this._usingPercentHeight&&(n.height=t.height*this._percentHeight));break;case ccui.LayoutComponent.verticalEdge.BOTTOM:this._isPercentOnly||((this._usingPercentHeight||this._usingStretchHeight)&&(n.height=t.height*this._percentHeight),s.y=this._bottomMargin+i.y*n.height);break;case ccui.LayoutComponent.verticalEdge.TOP:this._isPercentOnly||((this._usingPercentHeight||this._usingStretchHeight)&&(n.height=t.height*this._percentHeight),s.y=t.height-(this._topMargin+(1-i.y)*n.height));break;case ccui.LayoutComponent.verticalEdge.CENTER:this._isPercentOnly||(this._usingStretchHeight?(n.height=t.height-this._topMargin-this._bottomMargin,n.height<0&&(n.height=0),s.y=this._bottomMargin+i.y*n.height):(this._usingPercentHeight&&(n.height=t.height*this._percentHeight),s.y=t.height*this._positionPercentY))}if(e.setPosition(s),e.setContentSize(n),e instanceof ccui.PageView)for(e.forceDoLayout(),t=e.getPages(),e=0;e<t.length;e++)ccui.helper.doLayout(t[e]);else ccui.helper.doLayout(e)}},_getOwnerParent:function(){return this._owner?this._owner.getParent():null},_refreshHorizontalMargin:function(){var t,e,i,n=this._getOwnerParent();null!==n&&(t=this._owner.getPosition(),e=this._owner.getAnchorPoint(),i=this._owner.getContentSize(),n=n.getContentSize(),this._leftMargin=t.x-e.x*i.width,this._rightMargin=n.width-(t.x+(1-e.x)*i.width))},_refreshVerticalMargin:function(){var t,e,i,n=this._getOwnerParent();null!==n&&(t=this._owner.getPosition(),e=this._owner.getAnchorPoint(),i=this._owner.getContentSize(),n=n.getContentSize(),this._bottomMargin=t.y-e.y*i.height,this._topMargin=n.height-(t.y+(1-e.y)*i.height))}}),ccui.LayoutComponent.horizontalEdge={NONE:0,LEFT:1,RIGHT:2,CENTER:3},ccui.LayoutComponent.verticalEdge={NONE:0,BOTTOM:1,TOP:2,CENTER:3},ccui.LayoutComponent.NAME="__ui_layout",ccui.LayoutComponent.bindLayoutComponent=function(t){var e=t.getComponent(ccui.LayoutComponent.NAME);return void 0!==e||((e=new ccui.LayoutComponent).init(),t.addComponent(e),t instanceof ccui.Widget)||t.addEventListener&&t.addEventListener("load",function(){e.refreshLayout()},this),e},ccs||{}),ENABLE_PHYSICS_DETECT=(ccs.Class=ccs.Class||cc.Class,ccs.Class.extend=ccs.Class.extend||cc.Class.extend,ccs.Node=ccs.Node||cc.Node,ccs.Node.extend=ccs.Node.extend||cc.Node.extend,ccs.Sprite=ccs.Sprite||cc.Sprite,ccs.Sprite.extend=ccs.Sprite.extend||cc.Sprite.extend,ccs.Component=ccs.Component||cc.Component,ccs.Component.extend=ccs.Component.extend||cc.Component.extend,ccs.cocostudioVersion="v1.3.0.0",ccs.VERSION_COMBINED=.3,ccs.VERSION_CHANGE_ROTATION_RANGE=1,ccs.VERSION_COLOR_READING=1.1,ccs.MAX_VERTEXZ_VALUE=5e6,ccs.ARMATURE_MAX_CHILD=50,ccs.ARMATURE_MAX_ZORDER=100,ccs.ARMATURE_MAX_COUNT=ccs.MAX_VERTEXZ_VALUE/ccs.ARMATURE_MAX_CHILD/ccs.ARMATURE_MAX_ZORDER,ccs.AUTO_ADD_SPRITE_FRAME_NAME_PREFIX=!1,ccs.ENABLE_PHYSICS_CHIPMUNK_DETECT=!1,ccs.ENABLE_PHYSICS_SAVE_CALCULATED_VERTEX=!1,ccs.armatureVersion=function(){return"v1.1.0.0"},ccs.CONST_VERSION="version",ccs.CONST_VERSION_2_0=2,ccs.CONST_VERSION_COMBINED=.3,ccs.CONST_ARMATURES="armatures",ccs.CONST_ARMATURE="armature",ccs.CONST_BONE="b",ccs.CONST_DISPLAY="d",ccs.CONST_ANIMATIONS="animations",ccs.CONST_ANIMATION="animation",ccs.CONST_MOVEMENT="mov",ccs.CONST_FRAME="f",ccs.CONST_TEXTURE_ATLAS="TextureAtlas",ccs.CONST_SUB_TEXTURE="SubTexture",ccs.CONST_SKELETON="skeleton",ccs.CONST_A_NAME="name",ccs.CONST_A_DURATION="dr",ccs.CONST_A_FRAME_INDEX="fi",ccs.CONST_A_DURATION_TO="to",ccs.CONST_A_DURATION_TWEEN="drTW",ccs.CONST_A_LOOP="lp",ccs.CONST_A_MOVEMENT_SCALE="sc",ccs.CONST_A_MOVEMENT_DELAY="dl",ccs.CONST_A_DISPLAY_INDEX="dI",ccs.CONST_A_PLIST="plist",ccs.CONST_A_PARENT="parent",ccs.CONST_A_SKEW_X="kX",ccs.CONST_A_SKEW_Y="kY",ccs.CONST_A_SCALE_X="cX",ccs.CONST_A_SCALE_Y="cY",ccs.CONST_A_Z="z",ccs.CONST_A_EVENT="evt",ccs.CONST_A_SOUND="sd",ccs.CONST_A_SOUND_EFFECT="sdE",ccs.CONST_A_TWEEN_EASING="twE",ccs.CONST_A_EASING_PARAM="twEP",ccs.CONST_A_TWEEN_ROTATE="twR",ccs.CONST_A_IS_ARMATURE="isArmature",ccs.CONST_A_DISPLAY_TYPE="displayType",ccs.CONST_A_MOVEMENT="mov",ccs.CONST_A_X="x",ccs.CONST_A_Y="y",ccs.CONST_A_COCOS2DX_X="cocos2d_x",ccs.CONST_A_COCOS2DX_Y="cocos2d_y",ccs.CONST_A_WIDTH="width",ccs.CONST_A_HEIGHT="height",ccs.CONST_A_PIVOT_X="pX",ccs.CONST_A_PIVOT_Y="pY",ccs.CONST_A_COCOS2D_PIVOT_X="cocos2d_pX",ccs.CONST_A_COCOS2D_PIVOT_Y="cocos2d_pY",ccs.CONST_A_BLEND_TYPE="bd",ccs.CONST_A_BLEND_SRC="bd_src",ccs.CONST_A_BLEND_DST="bd_dst",ccs.CONST_A_ALPHA="a",ccs.CONST_A_RED="r",ccs.CONST_A_GREEN="g",ccs.CONST_A_BLUE="b",ccs.CONST_A_ALPHA_OFFSET="aM",ccs.CONST_A_RED_OFFSET="rM",ccs.CONST_A_GREEN_OFFSET="gM",ccs.CONST_A_BLUE_OFFSET="bM",ccs.CONST_A_COLOR_TRANSFORM="colorTransform",ccs.CONST_A_TWEEN_FRAME="tweenFrame",ccs.CONST_CONTOUR="con",ccs.CONST_CONTOUR_VERTEX="con_vt",ccs.CONST_FL_NAN="NaN",ccs.CONST_FRAME_DATA="frame_data",ccs.CONST_MOVEMENT_BONE_DATA="mov_bone_data",ccs.CONST_MOVEMENT_DATA="mov_data",ccs.CONST_ANIMATION_DATA="animation_data",ccs.CONST_DISPLAY_DATA="display_data",ccs.CONST_SKIN_DATA="skin_data",ccs.CONST_BONE_DATA="bone_data",ccs.CONST_ARMATURE_DATA="armature_data",ccs.CONST_CONTOUR_DATA="contour_data",ccs.CONST_TEXTURE_DATA="texture_data",ccs.CONST_VERTEX_POINT="vertex",ccs.CONST_COLOR_INFO="color",ccs.CONST_CONFIG_FILE_PATH="config_file_path",ccs.CONST_CONTENT_SCALE="content_scale",ccs.DataInfo=function(){this.asyncStruct=null,this.configFileQueue=[],this.contentScale=1,this.baseFilePath=this.filename="",this.cocoStudioVersion=this.flashToolVersion=0},ccs.dataReaderHelper={ConfigType:{DragonBone_XML:0,CocoStudio_JSON:1,CocoStudio_Binary:2},_configFileList:[],_flashToolVersion:ccs.CONST_VERSION_2_0,_positionReadScale:1,_asyncRefCount:0,_asyncRefTotalCount:0,_dataQueue:null,setPositionReadScale:function(t){this._positionReadScale=t},getPositionReadScale:function(){return this._positionReadScale},addDataFromFile:function(t){var e,i,n;-1===this._configFileList.indexOf(t)&&(this._configFileList.push(t),e=this._initBaseFilePath(t),i=cc.path.extname(t).toLowerCase(),(n=new ccs.DataInfo).filename=t,n.basefilePath=e,".xml"===i?ccs.dataReaderHelper.addDataFromXML(t,n):".json"===i||".exportjson"===i?ccs.dataReaderHelper.addDataFromJson(t,n):".csb"===i&&ccs.dataReaderHelper.addDataFromBinaryCache(t,n))},addDataFromFileAsync:function(t,e,i,n,s){var r;-1!==this._configFileList.indexOf(i)?s&&n&&(0===this._asyncRefTotalCount&&0===this._asyncRefCount?this._asyncCallBack(n,s,1):this._asyncCallBack(n,s,(this._asyncRefTotalCount-this._asyncRefCount)/this._asyncRefTotalCount)):(this._asyncRefTotalCount++,this._asyncRefCount++,r=this,cc.director.getScheduler().schedule(function(){r.addDataFromFile(i),r._asyncRefCount--,r._asyncCallBack(n,s,(r._asyncRefTotalCount-r._asyncRefCount)/r._asyncRefTotalCount)},this,.1,!1,0,!1,"armatrueDataHelper"))},removeConfigFile:function(t){for(var e=this._configFileList,i=e.length,n=e[i],s=0;s<i;s++)e[s]===t&&(n=s);n!==e[i]&&cc.arrayRemoveObject(e,t)},addDataFromCache:function(t,e){if(t){e.flashToolVersion=parseFloat(t.getAttribute(ccs.CONST_VERSION));for(var i=t.querySelectorAll(ccs.CONST_SKELETON+" > "+ccs.CONST_ARMATURES+" >  "+ccs.CONST_ARMATURE),n=ccs.armatureDataManager,s=0;s<i.length;s++){var r=this.decodeArmature(i[s],e);n.addArmatureData(r.name,r,e.filename)}for(i=t.querySelectorAll(ccs.CONST_SKELETON+" > "+ccs.CONST_ANIMATIONS+" >  "+ccs.CONST_ANIMATION),s=0;s<i.length;s++)r=this.decodeAnimation(i[s],e),n.addAnimationData(r.name,r,e.filename);for(i=t.querySelectorAll(ccs.CONST_SKELETON+" > "+ccs.CONST_TEXTURE_ATLAS+" >  "+ccs.CONST_SUB_TEXTURE),s=0;s<i.length;s++)r=this.decodeTexture(i[s],e),n.addTextureData(r.name,r,e.filename)}else cc.log("XML error  or  XML is empty.")},decodeArmature:function(t,e){var i=new ccs.ArmatureData;i.init(),i.name=t.getAttribute(ccs.CONST_A_NAME);for(var n=t.querySelectorAll(ccs.CONST_ARMATURE+" > "+ccs.CONST_BONE),s=0;s<n.length;s++){var r=n[s],o=r.getAttribute(ccs.CONST_A_PARENT),a=null;if(o)for(var c=0;c<n.length&&(a=n[c],o!=n[c].getAttribute(ccs.CONST_A_NAME));c++);r=this.decodeBone(r,a,e),i.addBoneData(r)}return i},decodeArmatureFromJSON:function(t,e){var i=new ccs.ArmatureData;i.init(),(n=t[ccs.CONST_A_NAME])&&(i.name=n),e.cocoStudioVersion=i.dataVersion=t[ccs.CONST_VERSION]||.1;for(var n=t[ccs.CONST_BONE_DATA],s=0;s<n.length;s++){var r=this.decodeBoneFromJson(n[s],e);i.addBoneData(r)}return i},decodeBone:function(t,e,i){(e=new ccs.BoneData).init(),e.name=t.getAttribute(ccs.CONST_A_NAME),e.parentName=t.getAttribute(ccs.CONST_A_PARENT)||"",e.zOrder=parseInt(t.getAttribute(ccs.CONST_A_Z))||0,t=t.querySelectorAll(ccs.CONST_BONE+" > "+ccs.CONST_DISPLAY);for(var n=0;n<t.length;n++){var s=this.decodeBoneDisplay(t[n],i);e.addDisplayData(s)}return e},decodeBoneFromJson:function(t,e){var i=new ccs.BoneData;i.init(),this.decodeNodeFromJson(i,t,e),i.name=t[ccs.CONST_A_NAME]||"",i.parentName=t[ccs.CONST_A_PARENT]||"";for(var n=t[ccs.CONST_DISPLAY_DATA]||[],s=0;s<n.length;s++){var r=this.decodeBoneDisplayFromJson(n[s],e);i.addDisplayData(r)}return i},decodeBoneDisplay:function(t,e){var i=null,t=(1===(parseFloat(t.getAttribute(ccs.CONST_A_IS_ARMATURE))||0)?(i=new ccs.ArmatureDisplayData).displayType=ccs.DISPLAY_TYPE_ARMATURE:(i=new ccs.SpriteDisplayData).displayType=ccs.DISPLAY_TYPE_SPRITE,t.getAttribute(ccs.CONST_A_NAME)||"");return t&&(i.displayName=t),i},decodeBoneDisplayFromJson:function(t,e){var i=t[ccs.CONST_A_DISPLAY_TYPE]||ccs.DISPLAY_TYPE_SPRITE,n=null;switch(i){case ccs.DISPLAY_TYPE_SPRITE:var s,n=new ccs.SpriteDisplayData,r=t[ccs.CONST_A_NAME];null!=r&&(n.displayName=r),(r=(t[ccs.CONST_SKIN_DATA]||[])[0])&&((s=n.skinData).x=r[ccs.CONST_A_X]*this._positionReadScale,s.y=r[ccs.CONST_A_Y]*this._positionReadScale,s.scaleX=null==r[ccs.CONST_A_SCALE_X]?1:r[ccs.CONST_A_SCALE_X],s.scaleY=null==r[ccs.CONST_A_SCALE_Y]?1:r[ccs.CONST_A_SCALE_Y],s.skewX=null==r[ccs.CONST_A_SKEW_X]?1:r[ccs.CONST_A_SKEW_X],s.skewY=null==r[ccs.CONST_A_SKEW_Y]?1:r[ccs.CONST_A_SKEW_Y],s.x*=e.contentScale,s.y*=e.contentScale);break;case ccs.DISPLAY_TYPE_ARMATURE:n=new ccs.ArmatureDisplayData,null!=(r=t[ccs.CONST_A_NAME])&&(n.displayName=t[ccs.CONST_A_NAME]);break;case ccs.DISPLAY_TYPE_PARTICLE:n=new ccs.ParticleDisplayData,null!=(r=t[ccs.CONST_A_PLIST])&&(n.displayName=e.asyncStruct?e.asyncStruct.basefilePath+r:e.basefilePath+r);break;default:n=new ccs.SpriteDisplayData}return n.displayType=i,n},decodeAnimation:function(t,e){var i=new ccs.AnimationData,n=t.getAttribute(ccs.CONST_A_NAME),s=ccs.armatureDataManager.getArmatureData(n);i.name=n;for(var r,n=t.querySelectorAll(ccs.CONST_ANIMATION+" > "+ccs.CONST_MOVEMENT),o=0;o<n.length;o++)r=n[o],r=this.decodeMovement(r,s,e),i.addMovement(r);return i},decodeAnimationFromJson:function(t,e){var i=new ccs.AnimationData;t[ccs.CONST_A_NAME]&&(i.name=t[ccs.CONST_A_NAME]);for(var n=t[ccs.CONST_MOVEMENT_DATA]||[],s=0;s<n.length;s++){var r=this.decodeMovementFromJson(n[s],e);i.addMovement(r)}return i},decodeMovement:function(t,e,i){for(var n=new ccs.MovementData,s=(n.name=t.getAttribute(ccs.CONST_A_NAME),r=0,r=t.getAttribute(ccs.CONST_A_DURATION),n.duration=null==r?0:parseFloat(r),r=t.getAttribute(ccs.CONST_A_DURATION_TO),n.durationTo=null==r?0:parseFloat(r),r=t.getAttribute(ccs.CONST_A_DURATION_TWEEN),n.durationTween=null==r?0:parseFloat(r),r=t.getAttribute(ccs.CONST_A_LOOP),n.loop=!r||Boolean(parseFloat(r)),(r=t.getAttribute(ccs.CONST_A_TWEEN_EASING))&&(r!=ccs.CONST_FL_NAN?(r=null==r?0:parseFloat(r),n.tweenEasing=2===r?ccs.TweenType.SINE_EASEINOUT:r):n.tweenEasing=ccs.TweenType.LINEAR),t=t.querySelectorAll(ccs.CONST_MOVEMENT+" > "+ccs.CONST_BONE),null),r=0;r<t.length;r++){var o=(s=t[r]).getAttribute(ccs.CONST_A_NAME);if(!n.getMovementBoneData(o)){var a=(o=e.getBoneData(o)).parentName,c=null;if(""!==a)for(var h=0;h<t.length&&a!==(c=t[h]).getAttribute(ccs.CONST_A_NAME);h++);s=this.decodeMovementBone(s,c,o,i),n.addMovementBoneData(s)}}return n},decodeMovementFromJson:function(t,e){var i=new ccs.MovementData;i.loop=null!=t[ccs.CONST_A_LOOP]&&t[ccs.CONST_A_LOOP],i.durationTween=t[ccs.CONST_A_DURATION_TWEEN]||0,i.durationTo=t[ccs.CONST_A_DURATION_TO]||0,i.duration=t[ccs.CONST_A_DURATION]||0,i.scale=null==t[ccs.CONST_A_DURATION]||null==t[ccs.CONST_A_MOVEMENT_SCALE]?1:t[ccs.CONST_A_MOVEMENT_SCALE],i.tweenEasing=null==t[ccs.CONST_A_TWEEN_EASING]?ccs.TweenType.LINEAR:t[ccs.CONST_A_TWEEN_EASING],(n=t[ccs.CONST_A_NAME])&&(i.name=n);for(var n=t[ccs.CONST_MOVEMENT_BONE_DATA]||[],s=0;s<n.length;s++){var r=this.decodeMovementBoneFromJson(n[s],e);i.addMovementBoneData(r)}return i},decodeMovementBone:function(t,e,i,n){var s,r=new ccs.MovementBoneData,o=(r.init(),t&&(s=parseFloat(t.getAttribute(ccs.CONST_A_MOVEMENT_SCALE))||0,r.scale=s,0<(s=parseFloat(t.getAttribute(ccs.CONST_A_MOVEMENT_DELAY))||0)&&--s,r.delay=s),0),a=s=0,c=null,h=[];if(null!=e){for(var l=e.querySelectorAll(ccs.CONST_BONE+" > "+ccs.CONST_FRAME),o=0;o<l.length;o++)h.push(l[o]);o=h.length}r.name=t.getAttribute(ccs.CONST_A_NAME),t=t.querySelectorAll(ccs.CONST_BONE+" > "+ccs.CONST_FRAME);for(var u=l=0,d=0;d<t.length;d++){var _=t[d];if(e)for(;l<o&&(!c||u<s||s+a<=u);)c=h[l],s+=a,a=parseFloat(c.getAttribute(ccs.CONST_A_DURATION)),l++;_=this.decodeFrame(_,c,i,n),r.addFrameData(_),_.frameID=u,u+=_.duration,r.duration=u}for(e=r.frameList,i=Math.PI,o=e.length-1;0<=o;o--)0<o&&(n=e[o].skewX-e[o-1].skewX,s=e[o].skewY-e[o-1].skewY,(n<-i||i<n)&&(e[o-1].skewX=n<0?e[o-1].skewX-2*i:e[o-1].skewX+2*i),s<-i||i<s)&&(e[o-1].skewY=s<0?e[o-1].skewY-2*i:e[o-1].skewY+2*i);return(e=new ccs.FrameData).copy(r.frameList[r.frameList.length-1]),e.frameID=r.duration,r.addFrameData(e),r},decodeMovementBoneFromJson:function(t,e){var i=new ccs.MovementBoneData;i.init(),i.delay=t[ccs.CONST_A_MOVEMENT_DELAY]||0,(o=t[ccs.CONST_A_NAME])&&(i.name=o);for(var n,s,r=(t[ccs.CONST_FRAME_DATA]||[]).length,o=0;o<r;o++){var a=this.decodeFrameFromJson(t[ccs.CONST_FRAME_DATA][o],e);i.addFrameData(a),e.cocoStudioVersion<ccs.CONST_VERSION_COMBINED&&(a.frameID=i.duration,i.duration+=a.duration)}if(e.cocoStudioVersion<ccs.VERSION_CHANGE_ROTATION_RANGE)for(r=i.frameList,a=Math.PI,o=r.length-1;0<=o;o--)0<o&&(n=r[o].skewX-r[o-1].skewX,s=r[o].skewY-r[o-1].skewY,(n<-a||a<n)&&(r[o-1].skewX=n<0?r[o-1].skewX-2*a:r[o-1].skewX+2*a),s<-a||a<s)&&(r[o-1].skewY=s<0?r[o-1].skewY-2*a:r[o-1].skewY+2*a);return e.cocoStudioVersion<ccs.CONST_VERSION_COMBINED&&0<i.frameList.length&&((a=new ccs.FrameData).copy(i.frameList[i.frameList.length-1]),i.addFrameData(a),a.frameID=i.duration),i},decodeFrame:function(t,e,i,n){var s=0,s=0;if((i=new ccs.FrameData).strMovement=t.getAttribute(ccs.CONST_A_MOVEMENT)||"",i.movement=i.strMovement,i.strEvent=t.getAttribute(ccs.CONST_A_EVENT)||"",i.event=i.strEvent,i.strSound=t.getAttribute(ccs.CONST_A_SOUND)||"",i.sound=i.strSound,i.strSoundEffect=t.getAttribute(ccs.CONST_A_SOUND_EFFECT)||"",i.soundEffect=i.strSoundEffect,s=t.getAttribute(ccs.CONST_A_TWEEN_FRAME),i.isTween=!(void 0!==s&&("false"===s||"0"===s)),(s=n.flashToolVersion>=ccs.CONST_VERSION_2_0?((s=t.getAttribute(ccs.CONST_A_COCOS2DX_X))&&(i.x=parseFloat(s),i.x*=this._positionReadScale),t.getAttribute(ccs.CONST_A_COCOS2DX_Y)):((s=t.getAttribute(ccs.CONST_A_X))&&(i.x=parseFloat(s),i.x*=this._positionReadScale),t.getAttribute(ccs.CONST_A_Y)))&&(i.y=-parseFloat(s),i.y*=this._positionReadScale),null!=(s=t.getAttribute(ccs.CONST_A_SCALE_X))&&(i.scaleX=parseFloat(s)),null!=(s=t.getAttribute(ccs.CONST_A_SCALE_Y))&&(i.scaleY=parseFloat(s)),null!=(s=t.getAttribute(ccs.CONST_A_SKEW_X))&&(i.skewX=cc.degreesToRadians(parseFloat(s))),null!=(s=t.getAttribute(ccs.CONST_A_SKEW_Y))&&(i.skewY=cc.degreesToRadians(-parseFloat(s))),null!=(s=t.getAttribute(ccs.CONST_A_DURATION))&&(i.duration=parseFloat(s)),null!=(s=t.getAttribute(ccs.CONST_A_DISPLAY_INDEX))&&(i.displayIndex=parseFloat(s)),null!=(s=t.getAttribute(ccs.CONST_A_Z))&&(i.zOrder=parseInt(s)),null!=(s=t.getAttribute(ccs.CONST_A_TWEEN_ROTATE))&&(i.tweenRotate=parseFloat(s)),null!=(s=t.getAttribute(ccs.CONST_A_BLEND_TYPE))){var r=i.blendFunc;switch(s){case ccs.BLEND_TYPE_NORMAL:r.src=cc.BLEND_SRC,r.dst=cc.BLEND_DST;break;case ccs.BLEND_TYPE_ADD:r.src=cc.SRC_ALPHA,r.dst=cc.ONE;break;case ccs.BLEND_TYPE_MULTIPLY:r.src=cc.DST_COLOR,r.dst=cc.ONE_MINUS_SRC_ALPHA;break;case ccs.BLEND_TYPE_SCREEN:r.src=cc.ONE,r.dst=cc.ONE_MINUS_DST_COLOR;break;default:i.blendFunc.src=cc.BLEND_SRC,i.blendFunc.dst=cc.BLEND_DST}}var o,a,c,h,l,u=t.querySelectorAll(ccs.CONST_FRAME+" > "+ccs.CONST_A_COLOR_TRANSFORM);return u&&0<u.length&&(u=u[0],s=parseFloat(u.getAttribute(ccs.CONST_A_ALPHA))||0,r=parseFloat(u.getAttribute(ccs.CONST_A_RED))||0,o=parseFloat(u.getAttribute(ccs.CONST_A_GREEN))||0,a=parseFloat(u.getAttribute(ccs.CONST_A_BLUE))||0,c=parseFloat(u.getAttribute(ccs.CONST_A_ALPHA_OFFSET))||0,h=parseFloat(u.getAttribute(ccs.CONST_A_RED_OFFSET))||0,l=parseFloat(u.getAttribute(ccs.CONST_A_GREEN_OFFSET))||0,u=parseFloat(u.getAttribute(ccs.CONST_A_BLUE_OFFSET))||0,i.a=2.55*c+s,i.r=2.55*h+r,i.g=2.55*l+o,i.b=2.55*u+a,i.isUseColorInfo=!0),null!=(s=t.getAttribute(ccs.CONST_A_TWEEN_EASING))&&(s!=ccs.CONST_FL_NAN?(s=t.getAttribute(ccs.CONST_A_TWEEN_EASING))&&(i.tweenEasing=2===s?ccs.TweenType.SINE_EASEINOUT:s):i.tweenEasing=ccs.TweenType.LINEAR),e&&(t=new ccs.BaseData,n.flashToolVersion>=ccs.CONST_VERSION_2_0?(t.x=parseFloat(e.getAttribute(ccs.CONST_A_COCOS2DX_X)),t.y=parseFloat(e.getAttribute(ccs.CONST_A_COCOS2DX_Y))):(t.x=parseFloat(e.getAttribute(ccs.CONST_A_X)),t.y=parseFloat(e.getAttribute(ccs.CONST_A_Y))),t.skewX=parseFloat(e.getAttribute(ccs.CONST_A_SKEW_X)),t.skewY=parseFloat(e.getAttribute(ccs.CONST_A_SKEW_Y)),t.y=-t.y,t.skewX=cc.degreesToRadians(t.skewX),t.skewY=cc.degreesToRadians(-t.skewY),ccs.TransformHelp.transformFromParent(i,t)),i},decodeFrameFromJson:function(t,e){var i=new ccs.FrameData,n=(this.decodeNodeFromJson(i,t,e),i.tweenEasing=t[ccs.CONST_A_TWEEN_EASING]||ccs.TweenType.LINEAR,i.displayIndex=t[ccs.CONST_A_DISPLAY_INDEX],null==t[ccs.CONST_A_BLEND_DST]?cc.BLEND_DST:t[ccs.CONST_A_BLEND_DST]);i.blendFunc.src=null==t[ccs.CONST_A_BLEND_SRC]?cc.BLEND_SRC:t[ccs.CONST_A_BLEND_SRC],i.blendFunc.dst=n,i.isTween=null==t[ccs.CONST_A_TWEEN_FRAME]||t[ccs.CONST_A_TWEEN_FRAME],null!=(n=t[ccs.CONST_A_EVENT])&&(i.strEvent=n,i.event=n),e.cocoStudioVersion<ccs.CONST_VERSION_COMBINED?i.duration=null==t[ccs.CONST_A_DURATION]?1:t[ccs.CONST_A_DURATION]:i.frameID=t[ccs.CONST_A_FRAME_INDEX];for(var n=t[ccs.CONST_A_EASING_PARAM]||[],s=0;s<n.length;s++)i.easingParams[s]=n[s];return i},decodeTexture:function(t,e){var i,n,s=new ccs.TextureData,r=(s.init(),t.getAttribute(ccs.CONST_A_NAME)&&(s.name=t.getAttribute(ccs.CONST_A_NAME)),n=e.flashToolVersion>=ccs.CONST_VERSION_2_0?(i=parseFloat(t.getAttribute(ccs.CONST_A_COCOS2D_PIVOT_X))||0,parseFloat(t.getAttribute(ccs.CONST_A_COCOS2D_PIVOT_Y))||0):(i=parseFloat(t.getAttribute(ccs.CONST_A_PIVOT_X))||0,parseFloat(t.getAttribute(ccs.CONST_A_PIVOT_Y))||0),parseFloat(t.getAttribute(ccs.CONST_A_WIDTH))||0),o=parseFloat(t.getAttribute(ccs.CONST_A_HEIGHT))||0;for(s.pivotX=i/r,s.pivotY=(o-n)/o,i=t.querySelectorAll(ccs.CONST_SUB_TEXTURE+" > "+ccs.CONST_CONTOUR),n=0;n<i.length;n++)s.addContourData(this.decodeContour(i[n],e));return s},decodeTextureFromJson:function(t){var e=new ccs.TextureData,i=(e.init(),t[ccs.CONST_A_NAME]);for(null!=i&&(e.name=i),e.width=t[ccs.CONST_A_WIDTH]||0,e.height=t[ccs.CONST_A_HEIGHT]||0,e.pivotX=t[ccs.CONST_A_PIVOT_X]||0,e.pivotY=t[ccs.CONST_A_PIVOT_Y]||0,t=t[ccs.CONST_CONTOUR_DATA]||[],i=0;i<t.length;i++)e.contourDataList.push(this.decodeContourFromJson(t[i]));return e},decodeContour:function(t,e){var i=new ccs.ContourData;i.init();for(var n=t.querySelectorAll(ccs.CONST_CONTOUR+" > "+ccs.CONST_CONTOUR_VERTEX),s=0;s<n.length;s++){var r=n[s],o=cc.p(0,0);o.x=parseFloat(r.getAttribute(ccs.CONST_A_X))||0,o.y=parseFloat(r.getAttribute(ccs.CONST_A_Y))||0,o.y=-o.y,i.vertexList.push(o)}return i},decodeContourFromJson:function(t){var e=new ccs.ContourData;e.init();for(var i=(t=t[ccs.CONST_VERTEX_POINT]||[]).length,n=0;n<i;n++){var s=t[n],r=cc.p(0,0);r.x=s[ccs.CONST_A_X]||0,r.y=s[ccs.CONST_A_Y]||0,e.vertexList.push(r)}return e},addDataFromJsonCache:function(t,e){e.contentScale=null==t[ccs.CONST_CONTENT_SCALE]?1:t[ccs.CONST_CONTENT_SCALE];var i,n=t[ccs.CONST_ARMATURE_DATA]||[];for(r=0;r<n.length;r++)i=this.decodeArmatureFromJSON(n[r],e),ccs.armatureDataManager.addArmatureData(i.name,i,e.filename);for(n=t[ccs.CONST_ANIMATION_DATA]||[],r=0;r<n.length;r++)i=this.decodeAnimationFromJson(n[r],e),ccs.armatureDataManager.addAnimationData(i.name,i,e.filename);for(n=t[ccs.CONST_TEXTURE_DATA]||[],r=0;r<n.length;r++)i=this.decodeTextureFromJson(n[r],e),ccs.armatureDataManager.addTextureData(i.name,i,e.filename);if(null==e.asyncStruct?ccs.armatureDataManager.isAutoLoadSpriteFile():e.asyncStruct.autoLoadSpriteFile)for(var s,n=t[ccs.CONST_CONFIG_FILE_PATH]||[],r=0;r<n.length;r++)s=(i=n[r]).lastIndexOf("."),i=i.substring(0,s),s=e.basefilePath+i+".plist",i=e.basefilePath+i+".png",ccs.armatureDataManager.addSpriteFrameFromFile(s,i,e.filename)},decodeNodeFromJson:function(t,e,i){t.x=e[ccs.CONST_A_X]*this._positionReadScale,t.y=e[ccs.CONST_A_Y]*this._positionReadScale,t.x*=i.contentScale,t.y*=i.contentScale,t.zOrder=e[ccs.CONST_A_Z],t.skewX=e[ccs.CONST_A_SKEW_X]||0,t.skewY=e[ccs.CONST_A_SKEW_Y]||0,t.scaleX=null==e[ccs.CONST_A_SCALE_X]?1:e[ccs.CONST_A_SCALE_X],t.scaleY=null==e[ccs.CONST_A_SCALE_Y]?1:e[ccs.CONST_A_SCALE_Y],(e=i.cocoStudioVersion<ccs.VERSION_COLOR_READING?e[0]:e[ccs.CONST_COLOR_INFO]||null)&&(t.a=null==e[ccs.CONST_A_ALPHA]?255:e[ccs.CONST_A_ALPHA],t.r=null==e[ccs.CONST_A_RED]?255:e[ccs.CONST_A_RED],t.g=null==e[ccs.CONST_A_GREEN]?255:e[ccs.CONST_A_GREEN],t.b=null==e[ccs.CONST_A_BLUE]?255:e[ccs.CONST_A_BLUE],t.isUseColorInfo=!0)},clear:function(){this._configFileList=[],this._asyncRefTotalCount=this._asyncRefCount=0},_asyncCallBack:function(t,e,i){t&&cc.isFunction(t)&&t.call(e,i),e&&t&&"string"==typeof t&&e[t](i)},_initBaseFilePath:function(t){var e=t.lastIndexOf("/");return-1<e?t.substr(0,e+1):""},addDataFromXML:function(t,e){var i=cc.loader.getRes(t);if(!i)throw Error("Please load the resource first : "+t);(i=cc.saxParser.parse(i).documentElement)&&this.addDataFromCache(i,e)},addDataFromJson:function(t,e){t=cc.loader.getRes(t);this.addDataFromJsonCache(t,e)}},ccs.spriteFrameCacheHelper={_textureAtlasDic:{},_imagePaths:[],addSpriteFrameFromFile:function(t,e){cc.spriteFrameCache.addSpriteFrames(t,e)},getTextureAtlasWithTexture:function(t){return null},clear:function(){this._textureAtlasDic={},this._imagePaths=[]}},ccs.TransformHelp=ccs.TransformHelp||ccs.Class.extend({}),ccs.TransformHelp.helpMatrix1=cc.affineTransformMake(1,0,0,1,0,0),ccs.TransformHelp.helpMatrix2=cc.affineTransformMake(1,0,0,1,0,0),ccs.TransformHelp.helpPoint1=cc.p(0,0),ccs.TransformHelp.helpPoint2=cc.p(0,0),ccs.TransformHelp.helpParentNode={},ccs.TransformHelp.transformFromParent=function(t,e){this.nodeToMatrix(t,this.helpMatrix1),this.nodeToMatrix(e,this.helpMatrix2),this.helpMatrix2=cc.affineTransformInvert(this.helpMatrix2),this.helpMatrix1=cc.affineTransformConcat(this.helpMatrix1,this.helpMatrix2),this.matrixToNode(this.helpMatrix1,t)},ccs.TransformHelp.transformToParent=function(t,e){this.nodeToMatrix(t,this.helpMatrix1),this.nodeToMatrix(e,this.helpMatrix2),this.helpMatrix1=cc.affineTransformConcat(this.helpMatrix1,this.helpMatrix2),this.matrixToNode(this.helpMatrix1,t)},ccs.TransformHelp.transformFromParentWithoutScale=function(t,e){for(var i in e)this.helpParentNode[i]=e[i];this.helpParentNode.scaleX=1,this.helpParentNode.scaleY=1,this.nodeToMatrix(t,this.helpMatrix1),this.nodeToMatrix(this.helpParentNode,this.helpMatrix2),this.helpMatrix2=cc.affineTransformInvert(this.helpMatrix2),this.helpMatrix1=cc.affineTransformConcat(this.helpMatrix1,this.helpMatrix2),this.matrixToNode(this.helpMatrix1,t)},ccs.TransformHelp.transformToParentWithoutScale=function(t,e){for(var i in e)this.helpParentNode[i]=e[i];this.helpParentNode.scaleX=1,this.helpParentNode.scaleY=1,this.nodeToMatrix(t,this.helpMatrix1),this.nodeToMatrix(this.helpParentNode,this.helpMatrix2),this.helpMatrix1=cc.affineTransformConcat(this.helpMatrix1,this.helpMatrix2),this.matrixToNode(this.helpMatrix1,t)},ccs.TransformHelp.nodeToMatrix=function(t,e){var i,n;t.skewX===-t.skewY?(i=Math.sin(t.skewX),n=Math.cos(t.skewX),e.a=t.scaleX*n,e.b=t.scaleX*-i,e.c=t.scaleY*i,e.d=t.scaleY*n):(e.a=t.scaleX*Math.cos(t.skewY),e.b=t.scaleX*Math.sin(t.skewY),e.c=t.scaleY*Math.sin(t.skewX),e.d=t.scaleY*Math.cos(t.skewX)),e.tx=t.x,e.ty=t.y},ccs.TransformHelp.matrixToNode=function(t,e){this.helpPoint1.x=0,this.helpPoint1.y=1,this.helpPoint1=cc.pointApplyAffineTransform(this.helpPoint1,t),this.helpPoint1.x-=t.tx,this.helpPoint1.y-=t.ty,this.helpPoint2.x=1,this.helpPoint2.y=0,this.helpPoint2=cc.pointApplyAffineTransform(this.helpPoint2,t),this.helpPoint2.x-=t.tx,this.helpPoint2.y-=t.ty,e.skewX=-(Math.atan2(this.helpPoint1.y,this.helpPoint1.x)-1.5707964),e.skewY=Math.atan2(this.helpPoint2.y,this.helpPoint2.x),e.scaleX=Math.sqrt(t.a*t.a+t.b*t.b),e.scaleY=Math.sqrt(t.c*t.c+t.d*t.d),e.x=t.tx,e.y=t.ty},ccs.TransformHelp.nodeConcat=function(t,e){t.x+=e.x,t.y+=e.y,t.skewX+=e.skewX,t.skewY+=e.skewY,t.scaleX+=e.scaleX,t.scaleY+=e.scaleY},ccs.TransformHelp.nodeSub=function(t,e){t.x-=e.x,t.y-=e.y,t.skewX-=e.skewX,t.skewY-=e.skewY,t.scaleX-=e.scaleX,t.scaleY-=e.scaleY},ccs.TweenType={CUSTOM_EASING:-1,LINEAR:0,SINE_EASEIN:1,SINE_EASEOUT:2,SINE_EASEINOUT:3,QUAD_EASEIN:4,QUAD_EASEOUT:5,QUAD_EASEINOUT:6,CUBIC_EASEIN:7,CUBIC_EASEOUT:8,CUBIC_EASEINOUT:9,QUART_EASEIN:10,QUART_EASEOUT:11,QUART_EASEINOUT:12,QUINT_EASEIN:13,QUINT_EASEOUT:14,QUINT_EASEINOUT:15,EXPO_EASEIN:16,EXPO_EASEOUT:17,EXPO_EASEINOUT:18,CIRC_EASEIN:19,CIRC_EASEOUT:20,CIRC_EASEINOUT:21,ELASTIC_EASEIN:22,ELASTIC_EASEOUT:23,ELASTIC_EASEINOUT:24,BACK_EASEIN:25,BACK_EASEOUT:26,BACK_EASEINOUT:27,BOUNCE_EASEIN:28,BOUNCE_EASEOUT:29,BOUNCE_EASEINOUT:30,TWEEN_EASING_MAX:1e4},ccs.TweenFunction=ccs.TweenFunction||ccs.Class.extend({}),ccs.DOUBLE_PI=ccs.M_PI_X_2=2*Math.PI,ccs.HALF_PI=ccs.M_PI_2=Math.PI/2,ccs.M_PI=Math.PI,ccs.TweenFunction.tweenTo=function(t,e,i){var n=0;switch(e){case ccs.TweenType.CUSTOM_EASING:n=this.customEase(t,i);break;case ccs.TweenType.LINEAR:n=this.linear(t);break;case ccs.TweenType.SINE_EASEIN:n=this.sineEaseIn(t);break;case ccs.TweenType.SINE_EASEOUT:n=this.sineEaseOut(t);break;case ccs.TweenType.SINE_EASEINOUT:n=this.sineEaseInOut(t);break;case ccs.TweenType.QUAD_EASEIN:n=this.quadEaseIn(t);break;case ccs.TweenType.QUAD_EASEOUT:n=this.quadEaseOut(t);break;case ccs.TweenType.QUAD_EASEINOUT:n=this.quadEaseInOut(t);break;case ccs.TweenType.CUBIC_EASEIN:n=this.cubicEaseIn(t);break;case ccs.TweenType.CUBIC_EASEOUT:n=this.cubicEaseOut(t);break;case ccs.TweenType.CUBIC_EASEINOUT:n=this.cubicEaseInOut(t);break;case ccs.TweenType.QUART_EASEIN:n=this.quartEaseIn(t);break;case ccs.TweenType.QUART_EASEOUT:n=this.quartEaseOut(t);break;case ccs.TweenType.QUART_EASEINOUT:n=this.quartEaseInOut(t);break;case ccs.TweenType.QUINT_EASEIN:n=this.quintEaseIn(t);break;case ccs.TweenType.QUINT_EASEOUT:n=this.quintEaseOut(t);break;case ccs.TweenType.QUINT_EASEINOUT:n=this.quintEaseInOut(t);break;case ccs.TweenType.EXPO_EASEIN:n=this.expoEaseIn(t);break;case ccs.TweenType.EXPO_EASEOUT:n=this.expoEaseOut(t);break;case ccs.TweenType.EXPO_EASEINOUT:n=this.expoEaseInOut(t);break;case ccs.TweenType.CIRC_EASEIN:n=this.circEaseIn(t);break;case ccs.TweenType.CIRC_EASEOUT:n=this.circEaseOut(t);break;case ccs.TweenType.CIRC_EASEINOUT:n=this.circEaseInOut(t);break;case ccs.TweenType.ELASTIC_EASEIN:e=.3,null!=i&&0<i.length&&(e=i[0]),n=this.elasticEaseIn(t,e);break;case ccs.TweenType.ELASTIC_EASEOUT:e=.3,null!=i&&0<i.length&&(e=i[0]),n=this.elasticEaseOut(t,e);break;case ccs.TweenType.ELASTIC_EASEINOUT:e=.3,null!=i&&0<i.length&&(e=i[0]),n=this.elasticEaseInOut(t,e);break;case ccs.TweenType.BACK_EASEIN:n=this.backEaseIn(t);break;case ccs.TweenType.BACK_EASEOUT:n=this.backEaseOut(t);break;case ccs.TweenType.BACK_EASEINOUT:n=this.backEaseInOut(t);break;case ccs.TweenType.BOUNCE_EASEIN:n=this.bounceEaseIn(t);break;case ccs.TweenType.BOUNCE_EASEOUT:n=this.bounceEaseOut(t);break;case ccs.TweenType.BOUNCE_EASEINOUT:n=this.bounceEaseInOut(t);break;default:n=this.sineEaseInOut(t)}return n},ccs.TweenFunction.linear=function(t){return t},ccs.TweenFunction.sineEaseIn=function(t){return-1*Math.cos(t*ccs.HALF_PI)+1},ccs.TweenFunction.sineEaseOut=function(t){return Math.sin(t*ccs.HALF_PI)},ccs.TweenFunction.sineEaseInOut=function(t){return-.5*(Math.cos(ccs.M_PI*t)-1)},ccs.TweenFunction.quadEaseIn=function(t){return t*t},ccs.TweenFunction.quadEaseOut=function(t){return-1*t*(t-2)},ccs.TweenFunction.quadEaseInOut=function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)},ccs.TweenFunction.cubicEaseIn=function(t){return t*t*t},ccs.TweenFunction.cubicEaseOut=function(t){return--t*t*t+1},ccs.TweenFunction.cubicEaseInOut=function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},ccs.TweenFunction.quartEaseIn=function(t){return t*t*t*t},ccs.TweenFunction.quartEaseOut=function(t){return-(--t*t*t*t-1)},ccs.TweenFunction.quartEaseInOut=function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},ccs.TweenFunction.quintEaseIn=function(t){return t*t*t*t*t},ccs.TweenFunction.quintEaseOut=function(t){return--t*t*t*t*t+1},ccs.TweenFunction.quintEaseInOut=function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},ccs.TweenFunction.expoEaseIn=function(t){return 0===t?0:Math.pow(2,10*(t-1))-.001},ccs.TweenFunction.expoEaseOut=function(t){return 1===t?1:1-Math.pow(2,-10*t)},ccs.TweenFunction.expoEaseInOut=function(t){return(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*(t-1)))},ccs.TweenFunction.circEaseIn=function(t){return-1*(Math.sqrt(1-t*t)-1)},ccs.TweenFunction.circEaseOut=function(t){return--t,Math.sqrt(1-t*t)},ccs.TweenFunction.circEaseInOut=function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):(t-=2,.5*(Math.sqrt(1-t*t)+1))},ccs.TweenFunction.elasticEaseIn=function(t,e){var i=.3,e=(0<e.length&&(i=e[0]),0);return e=0===t||1===t?t:(e=i/4,--t,-Math.pow(2,10*t)*Math.sin((t-e)*ccs.DOUBLE_PI/i))},ccs.TweenFunction.elasticEaseOut=function(t,e){var i=.3,e=(0<e.length&&(i=e[0]),0);return e=0===t||1===t?t:(e=i/4,Math.pow(2,-10*t)*Math.sin((t-e)*ccs.DOUBLE_PI/i)+1)},ccs.TweenFunction.elasticEaseInOut=function(t,e){var i=.3,e=(0<e.length&&(i=e[0]),0);return e=0===t||1===t?t:(e=(i=i||.3*1.5)/4,(t=2*t-1)<0?-.5*Math.pow(2,10*t)*Math.sin((t-e)*ccs.DOUBLE_PI/i):Math.pow(2,-10*t)*Math.sin((t-e)*ccs.DOUBLE_PI/i)*.5+1)},ccs.TweenFunction.backEaseIn=function(t){return t*t*(2.70158*t-1.70158)},ccs.TweenFunction.backEaseOut=function(t){return--t*t*(2.70158*t+1.70158)+1},ccs.TweenFunction.backEaseInOut=function(t){return(t*=2)<1?t*t*(3.5949095*t-2.5949095)/2:(t-=2)*t*(3.5949095*t+2.5949095)/2+1},ccs.bounceTime=function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},ccs.TweenFunction.bounceEaseIn=function(t){return 1-ccs.bounceTime(1-t)},ccs.TweenFunction.bounceEaseOut=function(t){return ccs.bounceTime(t)},ccs.TweenFunction.bounceEaseInOut=function(t){return t<.5?.5*(1-ccs.bounceTime(1-2*t)):.5*ccs.bounceTime(2*t-1)+.5},ccs.TweenFunction.customEase=function(t,e){var i;return 0<e.length?e[1]*(i=1-t)*i*i+3*e[3]*t*i*i+3*e[5]*t*t*i+e[7]*t*t*t:t},ccs.TweenFunction.easeIn=function(t,e){return Math.pow(t,e)},ccs.TweenFunction.easeOut=function(t,e){return Math.pow(t,1/e)},ccs.TweenFunction.easeInOut=function(t,e){return(t*=2)<1?.5*Math.pow(t,e):1-.5*Math.pow(2-t,e)},ccs.TweenFunction.quadraticIn=function(t){return Math.pow(t,2)},ccs.TweenFunction.quadraticOut=function(t){return-t*(t-2)},ccs.TweenFunction.bezieratFunction=function(t,e,i,n,s){return Math.pow(1-s,3)*t+3*s*Math.pow(1-s,2)*e+3*Math.pow(s,2)*(1-s)*i+Math.pow(s,3)*n},!1),CC_SAFE_RELEASE=(ccs.fmodf=function(t,e){for(;e<t;)t-=e;return t},function(t){t&&t.release&&t.release()}),__extends=(ccs.isSpriteContainPoint=function(t,e,i){return e=t.convertToNodeSpace(e),i&&(i.x=e.x,i.y=e.y),t=t.getContentSize(),cc.rectContainsPoint(cc.rect(0,0,t.width,t.height),e)},ccs.SPRITE_CONTAIN_POINT=ccs.isSpriteContainPoint,ccs.SPRITE_CONTAIN_POINT_WITH_RETURN=ccs.isSpriteContainPoint,ccs.extBezierTo=function(t,e,i,n,s){var r=cc.p(0,0);return n&&!s&&(r.x=Math.pow(1-t,2)*e.x+2*t*(1-t)*i.x+Math.pow(t,2)*n.x,r.y=Math.pow(1-t,2)*e.y+2*t*(1-t)*i.y+Math.pow(t,2)*n.y),s&&(r.x=e.x*Math.pow(1-t,3)+3*t*i.x*Math.pow(1-t,2)+3*n.x*Math.pow(t,2)*(1-t)+s.x*Math.pow(t,3),r.y=e.y*Math.pow(1-t,3)+3*t*i.y*Math.pow(1-t,2)+3*n.y*Math.pow(t,2)*(1-t)+s.y*Math.pow(t,3)),r},ccs.extCircleTo=function(t,e,i,n,s){var r=cc.p(0,0);return r.x=e.x+i*Math.cos(n+s*t),r.y=e.y+i*Math.sin(n+s*t),r},ccs.RelativeData=function(){this.plistFiles=[],this.armatures=[],this.animations=[],this.textures=[]},ccs.armatureDataManager={_animationDatas:{},_armatureDatas:{},_textureDatas:{},_autoLoadSpriteFile:!1,_relativeDatas:{},s_sharedArmatureDataManager:null,removeArmatureFileInfo:function(t){var e=this.getRelativeData(t);if(e){for(var i,n=0;n<e.armatures.length;n++)i=e.armatures[n],this.removeArmatureData(i);for(n=0;n<e.animations.length;n++)i=e.animations[n],this.removeAnimationData(i);for(n=0;n<e.textures.length;n++)i=e.textures[n],this.removeTextureData(i);for(n=0;n<e.plistFiles.length;n++)i=e.plistFiles[n],cc.spriteFrameCache.removeSpriteFramesFromFile(i);delete this._relativeDatas[t],ccs.dataReaderHelper.removeConfigFile(t)}},addArmatureData:function(t,e,i){(i=this.getRelativeData(i))&&i.armatures.push(t),this._armatureDatas[t]=e},getArmatureData:function(t){var e=null;return e=this._armatureDatas?this._armatureDatas[t]:e},removeArmatureData:function(t){this._armatureDatas[t]&&delete this._armatureDatas[t]},addAnimationData:function(t,e,i){(i=this.getRelativeData(i))&&i.animations.push(t),this._animationDatas[t]=e},getAnimationData:function(t){var e=null;return e=this._animationDatas[t]?this._animationDatas[t]:e},removeAnimationData:function(t){this._animationDatas[t]&&delete this._animationDatas[t]},addTextureData:function(t,e,i){(i=this.getRelativeData(i))&&i.textures.push(t),this._textureDatas[t]=e},getTextureData:function(t){var e=null;return e=this._textureDatas?this._textureDatas[t]:e},removeTextureData:function(t){this._textureDatas[t]&&delete this._textureDatas[t]},addArmatureFileInfo:function(){var t,e,i;switch(arguments.length){case 1:this.addRelativeData(i=arguments[0]),this._autoLoadSpriteFile=!0,ccs.dataReaderHelper.addDataFromFile(i);break;case 3:t=arguments[0],e=arguments[1],this.addRelativeData(i=arguments[2]),this._autoLoadSpriteFile=!1,ccs.dataReaderHelper.addDataFromFile(i),this.addSpriteFrameFromFile(e,t)}},addArmatureFileInfoAsync:function(){var t,e,i,n,s;switch(arguments.length){case 3:i=arguments[0],n=arguments[2],s=arguments[1],this.addRelativeData(i),this._autoLoadSpriteFile=!0,ccs.dataReaderHelper.addDataFromFileAsync("","",i,s,n);break;case 5:t=arguments[0],e=arguments[1],i=arguments[2],n=arguments[4],s=arguments[3],this.addRelativeData(i),this._autoLoadSpriteFile=!1,ccs.dataReaderHelper.addDataFromFileAsync(t,e,i,s,n),this.addSpriteFrameFromFile(e,t)}},addSpriteFrameFromFile:function(t,e,i){(i=this.getRelativeData(i))&&i.plistFiles.push(t),ccs.spriteFrameCacheHelper.addSpriteFrameFromFile(t,e)},isAutoLoadSpriteFile:function(){return this._autoLoadSpriteFile},getArmatureDatas:function(){return this._armatureDatas},getAnimationDatas:function(){return this._animationDatas},getTextureDatas:function(){return this._textureDatas},addRelativeData:function(t){this._relativeDatas[t]||(this._relativeDatas[t]=new ccs.RelativeData)},getRelativeData:function(t){return this._relativeDatas[t]},clear:function(){for(var t in this._relativeDatas)this.removeArmatureFileInfo(t);this._animationDatas={},this._armatureDatas={},this._textureDatas={},this._relativeDatas={},ccs.spriteFrameCacheHelper.clear(),ccs.dataReaderHelper.clear()}},ccs.BLEND_TYPE_NORMAL=0,ccs.BLEND_TYPE_LAYER=1,ccs.BLEND_TYPE_DARKEN=2,ccs.BLEND_TYPE_MULTIPLY=3,ccs.BLEND_TYPE_LIGHTEN=4,ccs.BLEND_TYPE_SCREEN=5,ccs.BLEND_TYPE_OVERLAY=6,ccs.BLEND_TYPE_HIGHLIGHT=7,ccs.BLEND_TYPE_ADD=8,ccs.BLEND_TYPE_SUBTRACT=9,ccs.BLEND_TYPE_DIFFERENCE=10,ccs.BLEND_TYPE_INVERT=11,ccs.BLEND_TYPE_ALPHA=12,ccs.BLEND_TYPE_ERASE=13,ccs.DISPLAY_TYPE_SPRITE=0,ccs.DISPLAY_TYPE_ARMATURE=1,ccs.DISPLAY_TYPE_PARTICLE=2,ccs.DISPLAY_TYPE_MAX=3,ccs.BaseData=ccs.Class.extend({x:0,y:0,zOrder:0,skewX:0,skewY:0,scaleX:1,scaleY:1,tweenRotate:0,isUseColorInfo:!1,r:255,g:255,b:255,a:255,ctor:function(){this.skewY=this.skewX=this.zOrder=this.y=this.x=0,this.scaleY=this.scaleX=1,this.tweenRotate=0,this.isUseColorInfo=!1,this.a=this.b=this.g=this.r=255},copy:function(t){this.x=t.x,this.y=t.y,this.zOrder=t.zOrder,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.skewX=t.skewX,this.skewY=t.skewY,this.tweenRotate=t.tweenRotate,this.isUseColorInfo=t.isUseColorInfo,this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a},setColor:function(t){this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a},getColor:function(){return cc.color(this.r,this.g,this.b,this.a)},subtract:function(t,e,i){this.x=e.x-t.x,this.y=e.y-t.y,this.scaleX=e.scaleX-t.scaleX,this.scaleY=e.scaleY-t.scaleY,this.skewX=e.skewX-t.skewX,this.skewY=e.skewY-t.skewY,this.isUseColorInfo||t.isUseColorInfo||e.isUseColorInfo?(this.a=e.a-t.a,this.r=e.r-t.r,this.g=e.g-t.g,this.b=e.b-t.b,this.isUseColorInfo=!0):(this.a=this.r=this.g=this.b=0,this.isUseColorInfo=!1),i&&(this.skewX>ccs.M_PI&&(this.skewX-=ccs.DOUBLE_PI),this.skewX<-ccs.M_PI&&(this.skewX+=ccs.DOUBLE_PI),this.skewY>ccs.M_PI&&(this.skewY-=ccs.DOUBLE_PI),this.skewY<-ccs.M_PI)&&(this.skewY+=ccs.DOUBLE_PI),e.tweenRotate&&(this.skewX+=e.tweenRotate*ccs.PI*2,this.skewY-=e.tweenRotate*ccs.PI*2)}}),ccs.DisplayData=ccs.Class.extend({displayType:ccs.DISPLAY_TYPE_MAX,displayName:"",ctor:function(){this.displayType=ccs.DISPLAY_TYPE_MAX},changeDisplayToTexture:function(t){var e=t.lastIndexOf(".");return t=-1!==e?t.substring(0,e):t},copy:function(t){this.displayName=t.displayName,this.displayType=t.displayType}}),ccs.SpriteDisplayData=ccs.DisplayData.extend({skinData:null,ctor:function(){this.skinData=new ccs.BaseData,this.displayType=ccs.DISPLAY_TYPE_SPRITE},copy:function(t){ccs.DisplayData.prototype.copy.call(this,t),this.skinData=t.skinData}}),ccs.ArmatureDisplayData=ccs.DisplayData.extend({ctor:function(){this.displayName="",this.displayType=ccs.DISPLAY_TYPE_ARMATURE}}),ccs.ParticleDisplayData=ccs.DisplayData.extend({ctor:function(){this.displayType=ccs.DISPLAY_TYPE_PARTICLE}}),ccs.BoneData=ccs.BaseData.extend({displayDataList:null,name:"",parentName:"",boneDataTransform:null,ctor:function(){this.displayDataList=[],this.parentName=this.name="",this.boneDataTransform=null},init:function(){return!(this.displayDataList.length=0)},addDisplayData:function(t){this.displayDataList.push(t)},getDisplayData:function(t){return this.displayDataList[t]}}),ccs.ArmatureData=ccs.Class.extend({boneDataDic:null,name:"",dataVersion:.1,ctor:function(){this.boneDataDic={},this.name="",this.dataVersion=.1},init:function(){return!0},addBoneData:function(t){this.boneDataDic[t.name]=t},getBoneDataDic:function(){return this.boneDataDic},getBoneData:function(t){return this.boneDataDic[t]}}),ccs.FrameData=ccs.BaseData.extend({duration:0,tweenEasing:0,easingParamNumber:0,easingParams:null,displayIndex:-1,movement:"",event:"",sound:"",soundEffect:"",blendFunc:null,frameID:0,isTween:!0,ctor:function(){ccs.BaseData.prototype.ctor.call(this),this.duration=1,this.tweenEasing=ccs.TweenType.LINEAR,this.easingParamNumber=0,this.easingParams=[],this.displayIndex=0,this.soundEffect=this.sound=this.event=this.movement="",this.blendFunc=new cc.BlendFunc(cc.BLEND_SRC,cc.BLEND_DST),this.frameID=0,this.isTween=!0},copy:function(t){if(ccs.BaseData.prototype.copy.call(this,t),this.duration=t.duration,this.displayIndex=t.displayIndex,this.tweenEasing=t.tweenEasing,this.easingParamNumber=t.easingParamNumber,0!==this.easingParamNumber)for(var e=this.easingParams.length=0;e<this.easingParamNumber;e++)this.easingParams[e]=t.easingParams[e];this.blendFunc=t.blendFunc,this.isTween=t.isTween}}),ccs.MovementBoneData=ccs.Class.extend({delay:0,scale:1,duration:0,frameList:null,name:"",ctor:function(){this.delay=0,this.scale=1,this.duration=0,this.frameList=[],this.name=""},init:function(){return!0},addFrameData:function(t){this.frameList.push(t)},getFrameData:function(t){return this.frameList[t]}}),ccs.MovementData=function(){this.name="",this.duration=0,this.scale=1,this.durationTween=this.durationTo=0,this.loop=!0,this.tweenEasing=ccs.TweenType.LINEAR,this.movBoneDataDic={}},ccs.MovementData.prototype.addMovementBoneData=function(t){this.movBoneDataDic[t.name]=t},ccs.MovementData.prototype.getMovementBoneData=function(t){return this.movBoneDataDic[t]},ccs.AnimationData=function(){this.movementDataDic={},this.movementNames=[],this.name=""},ccs.AnimationData.prototype.addMovement=function(t){this.movementDataDic[t.name]=t,this.movementNames.push(t.name)},ccs.AnimationData.prototype.getMovement=function(t){return this.movementDataDic[t]},ccs.AnimationData.prototype.getMovementCount=function(){return Object.keys(this.movementDataDic).length},ccs.ContourVertex2=function(t,e){this.x=t||0,this.y=e||0},ccs.ContourData=function(){this.vertexList=[]},ccs.ContourData.prototype.init=function(){return!(this.vertexList.length=0)},ccs.ContourData.prototype.addVertex=function(t){this.vertexList.push(t)},ccs.TextureData=function(){this.width=this.height=0,this.pivotY=this.pivotX=.5,this.name="",this.contourDataList=[]},ccs.TextureData.prototype.init=function(){this.contourDataList.length=0},ccs.TextureData.prototype.addContourData=function(t){this.contourDataList.push(t)},ccs.TextureData.prototype.getContourData=function(t){return this.contourDataList[t]},ccs.DecorativeDisplay=ccs.Class.extend({_display:null,_colliderDetector:null,_displayData:null,ctor:function(){this._displayData=this._colliderDetector=this._display=null},init:function(){return!0},setDisplay:function(t){t._parent&&(t._parent.removeChild(t),delete t._parent),this._display=t},getDisplay:function(){return this._display},setColliderDetector:function(t){this._colliderDetector=t},getColliderDetector:function(){return this._colliderDetector},setDisplayData:function(t){this._displayData=t},getDisplayData:function(){return this._displayData},release:function(){this._colliderDetector=this._displayData=this._display=null}}),ccs.DecorativeDisplay.create=function(){return new ccs.DecorativeDisplay},ccs.displayFactory={addDisplay:function(t,e,i){switch(i.displayType){case ccs.DISPLAY_TYPE_SPRITE:this.addSpriteDisplay(t,e,i);break;case ccs.DISPLAY_TYPE_PARTICLE:this.addParticleDisplay(t,e,i);break;case ccs.DISPLAY_TYPE_ARMATURE:this.addArmatureDisplay(t,e,i)}},createDisplay:function(t,e){switch(e.getDisplayData().displayType){case ccs.DISPLAY_TYPE_SPRITE:this.createSpriteDisplay(t,e);break;case ccs.DISPLAY_TYPE_PARTICLE:this.createParticleDisplay(t,e);break;case ccs.DISPLAY_TYPE_ARMATURE:this.createArmatureDisplay(t,e)}},_helpTransform:{a:1,b:0,c:0,d:1,tx:0,ty:0},updateDisplay:function(t,e,i){var n,s=t.getDisplayRenderNode();if(s){switch(t.getDisplayRenderNodeType()){case ccs.DISPLAY_TYPE_SPRITE:i&&(s._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty),s.updateArmatureTransform());break;case ccs.DISPLAY_TYPE_PARTICLE:this.updateParticleDisplay(t,s,e);break;case ccs.DISPLAY_TYPE_ARMATURE:this.updateArmatureDisplay(t,s,e);break;default:e=t.getNodeToArmatureTransform(),s.setAdditionalTransform(e)}(ccs.ENABLE_PHYSICS_CHIPMUNK_DETECT||ccs.ENABLE_PHYSICS_SAVE_CALCULATED_VERTEX)&&i&&(i=(s=t.getDisplayManager().getCurrentDecorativeDisplay()).getColliderDetector())&&(n=(e=s.getDisplay()).getNodeToParentTransform(),(s=this._helpTransform).a=n.a,s.b=n.b,s.c=n.c,s.d=n.d,s.tx=n.tx,s.ty=n.ty,e=cc.pointApplyAffineTransform(e.getAnchorPointInPoints(),s),s.tx=e.x,s.ty=e.y,t=cc.affineTransformConcat(s,t.getArmature().getNodeToParentTransform()),i.updateTransform(t))}},addSpriteDisplay:function(t,e,i){var n=new ccs.SpriteDisplayData;n.copy(i),e.setDisplayData(n),this.createSpriteDisplay(t,e)},createSpriteDisplay:function(t,e){var i=null,n=e.getDisplayData(),s=(i=n.displayName).lastIndexOf(".");i=""===(i=-1!==s?i.substring(0,s):i)?new ccs.Skin:new ccs.Skin("#"+i+".png"),e.setDisplay(i),i.setBone(t),this.initSpriteDisplay(t,e,n.displayName,i),(s=t.getArmature())&&(s.getArmatureData().dataVersion>=ccs.CONST_VERSION_COMBINED?i.setSkinData(n.skinData):i.setSkinData(t.boneData))},initSpriteDisplay:function(t,e,i,n){var s=i.lastIndexOf(".");-1!==s&&(i=i.substring(0,s)),(i=ccs.armatureDataManager.getTextureData(i))&&n.setAnchorPoint(cc.p(i.pivotX,i.pivotY)),(ccs.ENABLE_PHYSICS_CHIPMUNK_DETECT||ccs.ENABLE_PHYSICS_SAVE_CALCULATED_VERTEX)&&i&&0<i.contourDataList.length&&((t=new ccs.ColliderDetector(t)).addContourDataList(i.contourDataList),e.setColliderDetector(t))},addArmatureDisplay:function(t,e,i){var n=new ccs.ArmatureDisplayData;n.copy(i),e.setDisplayData(n),this.createArmatureDisplay(t,e)},createArmatureDisplay:function(t,e){var i=e.getDisplayData(),i=new ccs.Armature(i.displayName,t);e.setDisplay(i)},updateArmatureDisplay:function(t,e,i){e&&(e.sortAllChildren(),e.update(i))},addParticleDisplay:function(t,e,i){var n=new ccs.ParticleDisplayData;n.copy(i),e.setDisplayData(n),this.createParticleDisplay(t,e)},createParticleDisplay:function(t,e){var i=e.getDisplayData();(i=new cc.ParticleSystem(i.displayName)).removeFromParent(),i.cleanup(),t.getArmature()&&i.setParent(t.getArmature()),e.setDisplay(i)},updateParticleDisplay:function(t,e,i){var n=new ccs.BaseData;ccs.TransformHelp.matrixToNode(t.nodeToArmatureTransform(),n),e.setPosition(n.x,n.y),e.setScaleX(n.scaleX),e.setScaleY(n.scaleY),e.update(i)}},ccs.DisplayManager=ccs.Class.extend({_decoDisplayList:null,_currentDecoDisplay:null,_displayRenderNode:null,_displayIndex:null,_forceChangeDisplay:!1,_bone:null,_visible:!0,_displayType:null,ctor:function(t){this._decoDisplayList=[],this._displayIndex=this._displayRenderNode=this._currentDecoDisplay=null,this._forceChangeDisplay=!1,this._bone=null,this._visible=!0,this._displayType=ccs.DISPLAY_TYPE_MAX,t&&ccs.DisplayManager.prototype.init.call(this,t)},init:function(t){return this._bone=t,this.initDisplayList(t.getBoneData()),!0},addDisplay:function(t,e){var i,n=this._decoDisplayList;if(0<=e&&e<n.length?i=n[e]:(i=new ccs.DecorativeDisplay,n.push(i)),t instanceof ccs.DisplayData)ccs.displayFactory.addDisplay(this._bone,i,t);else{var s=null;if(t instanceof ccs.Skin)if(t.setBone(this._bone),s=new ccs.SpriteDisplayData,ccs.displayFactory.initSpriteDisplay(this._bone,i,t.getDisplayName(),t),(r=i.getDisplayData())instanceof ccs.SpriteDisplayData)t.setSkinData(r.skinData),s.skinData=r.skinData;else{for(var r=!1,o=n.length-2;0<=o;o--){var a=n[o].getDisplayData();if(a instanceof ccs.SpriteDisplayData){r=!0,t.setSkinData(a.skinData),s.skinData=a.skinData;break}}r||t.setSkinData(new ccs.BaseData)}else t instanceof cc.ParticleSystem?(s=new ccs.ParticleDisplayData,t.removeFromParent(),t._performRecursive(cc.Node._stateCallbackType.cleanup),(n=this._bone.getArmature())&&t.setParent(n)):t instanceof ccs.Armature?((s=new ccs.ArmatureDisplayData).displayName=t.getName(),t.setParentBone(this._bone)):s=new ccs.DisplayData;i.setDisplay(t),i.setDisplayData(s)}e===this._displayIndex&&(this._displayIndex=-1,this.changeDisplayWithIndex(e,!1))},_addDisplayOther:function(t,e){var i=null;if(e instanceof ccs.Skin)if(e.setBone(this._bone),(i=new ccs.SpriteDisplayData).displayName=e.getDisplayName(),ccs.displayFactory.initSpriteDisplay(this._bone,t,e.getDisplayName(),e),(n=t.getDisplayData())instanceof ccs.SpriteDisplayData)e.setSkinData(n.skinData);else{for(var n=!1,s=this._decoDisplayList.length-2;0<=s;s--){var r=this._decoDisplayList[s].getDisplayData();if(r){n=!0,e.setSkinData(r.skinData),i.skinData=r.skinData;break}}n||e.setSkinData(new ccs.BaseData),e.setSkinData(new ccs.BaseData)}else e instanceof cc.ParticleSystem?(i=new ccs.ParticleDisplayData).displayName=e._plistFile:e instanceof ccs.Armature?((i=new ccs.ArmatureDisplayData).displayName=e.getName(),e.setParentBone(this._bone)):i=new ccs.DisplayData;t.setDisplay(e),t.setDisplayData(i)},removeDisplay:function(t){this._decoDisplayList.splice(t,1),t===this._displayIndex&&(this.setCurrentDecorativeDisplay(null),this._displayIndex=-1)},getDecorativeDisplayList:function(){return this._decoDisplayList},changeDisplayWithIndex:function(t,e){t>=this._decoDisplayList.length?cc.log("the index value is out of range"):(this._forceChangeDisplay=e,this._displayIndex!==t&&((this._displayIndex=t)<0?this._displayRenderNode&&(this._displayRenderNode.removeFromParent(!0),this.setCurrentDecorativeDisplay(null)):this.setCurrentDecorativeDisplay(this._decoDisplayList[t])))},changeDisplayWithName:function(t,e){for(var i=this._decoDisplayList,n=0;n<i.length;n++)if(i[n].getDisplayData().displayName===t){this.changeDisplayWithIndex(n,e);break}},setCurrentDecorativeDisplay:function(t){var e=this._currentDecoDisplay,e=((ccs.ENABLE_PHYSICS_CHIPMUNK_DETECT||ccs.ENABLE_PHYSICS_SAVE_CALCULATED_VERTEX)&&e&&e.getColliderDetector()&&e.getColliderDetector().setActive(!1),e=this._currentDecoDisplay=t,(ccs.ENABLE_PHYSICS_CHIPMUNK_DETECT||ccs.ENABLE_PHYSICS_SAVE_CALCULATED_VERTEX)&&e&&e.getColliderDetector()&&e.getColliderDetector().setActive(!0),t=e?e.getDisplay():null,this._displayRenderNode),i=this._bone;e&&(e instanceof ccs.Armature&&i.setChildArmature(null),e.removeFromParent(!0)),(this._displayRenderNode=t)?(t instanceof ccs.Armature?(this._bone.setChildArmature(t),t.setParentBone(this._bone)):t instanceof cc.ParticleSystem&&(t instanceof ccs.Armature?(i.setChildArmature(t),t.setParentBone(i)):t instanceof cc.ParticleSystem&&t.resetSystem()),t.setColor(i.getDisplayedColor()),t.setOpacity(i.getDisplayedOpacity()),this._displayRenderNode.setVisible(this._visible),this._displayType=this._currentDecoDisplay.getDisplayData().displayType):this._displayType=ccs.DISPLAY_TYPE_MAX,cc.renderer.childrenOrderDirty=!0},getDisplayRenderNode:function(){return this._displayRenderNode},getDisplayRenderNodeType:function(){return this._displayType},getCurrentDisplayIndex:function(){return this._displayIndex},getCurrentDecorativeDisplay:function(){return this._currentDecoDisplay},getDecorativeDisplayByIndex:function(t){return this._decoDisplayList[t]},initDisplayList:function(t){if(this._decoDisplayList.length=0,t){t=t.displayDataList;for(var e=this._decoDisplayList,i=this._bone,n=0;n<t.length;n++){var s=t[n],r=new ccs.DecorativeDisplay;r.setDisplayData(s),ccs.displayFactory.createDisplay(i,r),e.push(r)}}},containPoint:function(t,e){return!(!this._visible||this._displayIndex<0)&&(void 0!==e&&(t=cc.p(t,e)),this._currentDecoDisplay.getDisplayData().displayType===ccs.DISPLAY_TYPE_SPRITE)&&(e=(e=this._currentDecoDisplay.getDisplay()).getChildByTag(0),ccs.SPRITE_CONTAIN_POINT_WITH_RETURN(e,t))},setVisible:function(t){this._displayRenderNode&&(this._visible=t,this._displayRenderNode.setVisible(t))},isVisible:function(){return this._visible},getContentSize:function(){return this._displayRenderNode?this._displayRenderNode.getContentSize():cc.size(0,0)},getBoundingBox:function(){return this._displayRenderNode?this._displayRenderNode.getBoundingBox():cc.rect(0,0,0,0)},getAnchorPoint:function(){return this._displayRenderNode?this._displayRenderNode.getAnchorPoint():cc.p(0,0)},getAnchorPointInPoints:function(){return this._displayRenderNode?this._displayRenderNode.getAnchorPointInPoints():cc.p(0,0)},getForceChangeDisplay:function(){return this._forceChangeDisplay},release:function(){this._decoDisplayList=null,this._displayRenderNode&&(this._displayRenderNode.removeFromParent(!0),this._displayRenderNode=null)}}),ccs.DisplayManager.create=function(t){return new ccs.DisplayManager(t)},ccs.Skin=ccs.Sprite.extend({_skinData:null,bone:null,_skinTransform:null,_displayName:"",_armature:null,_className:"Skin",ctor:function(t,e){cc.Sprite.prototype.ctor.call(this),this.bone=this._skinData=null,this._displayName="",this._skinTransform=cc.affineTransformIdentity(),(this._armature=null)==t||""===t?ccs.Skin.prototype.init.call(this):"#"===t[0]?ccs.Skin.prototype.initWithSpriteFrameName.call(this,t.substr(1)):ccs.Skin.prototype.initWithFile.call(this,t,e)},initWithSpriteFrameName:function(t){var e,i;return""!==t&&(i=!0,(e=cc.spriteFrameCache.getSpriteFrame(t))?this.initWithSpriteFrame(e):(cc.log("Can't find CCSpriteFrame with %s. Please check your .plist file",t),i=!1),this._displayName=t,i)},initWithFile:function(t,e){e=e?cc.Sprite.prototype.initWithFile.call(this,t,e):cc.Sprite.prototype.initWithFile.call(this,t);return this._displayName=t,e},setSkinData:function(t){this._skinData=t,this.setScaleX(t.scaleX),this.setScaleY(t.scaleY),this.setRotationX(cc.radiansToDegrees(t.skewX)),this.setRotationY(cc.radiansToDegrees(-t.skewY)),this.setPosition(t.x,t.y),this._renderCmd.transform()},getSkinData:function(){return this._skinData},updateArmatureTransform:function(){this._renderCmd.transform()},getNodeToWorldTransform:function(){return this._renderCmd.getNodeToWorldTransform()},getNodeToWorldTransformAR:function(){return this._renderCmd.getNodeToWorldTransformAR()},setBone:function(t){this.bone=t,(t=this.bone.getArmature())&&(this._armature=t)},getBone:function(){return this.bone},getDisplayName:function(){return this._displayName},_createRenderCmd:function(){return new(cc._renderType===cc.game.RENDER_TYPE_CANVAS?ccs.Skin.CanvasRenderCmd:ccs.Skin.WebGLRenderCmd)(this)}}),_p=ccs.Skin.prototype,cc.defineGetterSetter(_p,"skinData",_p.getSkinData,_p.setSkinData),cc.defineGetterSetter(_p,"displayName",_p.getDisplayName),_p=null,ccs.Skin.create=function(t,e){return new ccs.Skin(t,e)},ccs.Skin.createWithSpriteFrameName=function(t){return new ccs.Skin("#"+t)},!function(){ccs.Skin.RenderCmd={_realWorldTM:null,transform:function(t,e){this._transform||(this._transform={a:1,b:0,c:0,d:1,tx:0,ty:0},this._worldTransform={a:1,b:0,c:0,d:1,tx:0,ty:0});var i,n,s,r=this._node,t=t?t._worldTransform:null,o=this._transform,a=this._worldTransform;(this._dirtyFlag&cc.Node._dirtyFlags.transformDirty||t)&&(this.originTransform(),cc.affineTransformConcatIn(this._transform,r.bone.getNodeToArmatureTransform()),this._dirtyFlag&=~cc.Node._dirtyFlags.transformDirty),t?(a.a=o.a*t.a+o.b*t.c,a.b=o.a*t.b+o.b*t.d,a.c=o.c*t.a+o.d*t.c,a.d=o.c*t.b+o.d*t.d,a.tx=o.tx*t.a+o.ty*t.c+t.tx,a.ty=o.tx*t.b+o.ty*t.d+t.ty,(t=this._vertices)&&(n=(i=r._offsetPosition.x)+r._rect.width,r=(s=r._offsetPosition.y)+r._rect.height,t[0].x=i*a.a+r*a.c+a.tx,t[0].y=i*a.b+r*a.d+a.ty,t[1].x=i*a.a+s*a.c+a.tx,t[1].y=i*a.b+s*a.d+a.ty,t[2].x=n*a.a+r*a.c+a.tx,t[2].y=n*a.b+r*a.d+a.ty,t[3].x=n*a.a+s*a.c+a.tx,t[3].y=n*a.b+s*a.d+a.ty)):(a.a=o.a,a.b=o.b,a.c=o.c,a.d=o.d,a.tx=o.tx,a.ty=o.ty),(a=this._realWorldTM)&&(a.a=o.a,a.b=o.b,a.c=o.c,a.d=o.d,a.tx=o.tx,a.ty=o.ty,cc.affineTransformConcatIn(a,this._node.bone.getArmature()._renderCmd._worldTransform))},getNodeToWorldTransform:function(){return cc.affineTransformConcat(this._transform,this._node.bone.getArmature().getNodeToWorldTransform())},getNodeToWorldTransformAR:function(){var t=this._transform,e=this._node;return this._anchorPointInPoints=cc.pointApplyAffineTransform(this._anchorPointInPoints,t),t.tx=this._anchorPointInPoints.x,t.ty=this._anchorPointInPoints.y,cc.affineTransformConcat(t,e.bone.getArmature().getNodeToWorldTransform())}},ccs.Skin.CanvasRenderCmd=function(t){this._spriteCmdCtor(t),this._realWorldTM={a:1,b:0,c:0,d:1,tx:0,ty:0}};var t=ccs.Skin.CanvasRenderCmd.prototype=Object.create(cc.Sprite.CanvasRenderCmd.prototype);cc.inject(ccs.Skin.RenderCmd,t),t.constructor=ccs.Skin.CanvasRenderCmd,t._updateCurrentRegions=function(){var t=this._currentRegion;this._currentRegion=this._oldRegion,this._oldRegion=t,cc.Node.CanvasRenderCmd.RegionStatus.DirtyDouble!==this._regionFlag||this._currentRegion.isEmpty()||this._oldRegion.union(this._currentRegion),this._currentRegion.updateRegion(this.getLocalBB(),this._realWorldTM)},ccs.Skin.WebGLRenderCmd=function(t){this._spriteCmdCtor(t)},t=ccs.Skin.WebGLRenderCmd.prototype=Object.create(cc.Sprite.WebGLRenderCmd.prototype),cc.inject(ccs.Skin.RenderCmd,t),t.constructor=ccs.Skin.WebGLRenderCmd}(),ccs.ANIMATION_TYPE_SINGLE_FRAME=-4,ccs.ANIMATION_TYPE_NO_LOOP=-3,ccs.ANIMATION_TYPE_TO_LOOP_FRONT=-2,ccs.ANIMATION_TYPE_TO_LOOP_BACK=-1,ccs.ANIMATION_TYPE_LOOP_FRONT=0,ccs.ANIMATION_TYPE_LOOP_BACK=1,ccs.ANIMATION_TYPE_MAX=2,ccs.ProcessBase=ccs.Class.extend({_processScale:1,_isComplete:!0,_isPause:!0,_isPlaying:!1,_currentPercent:0,_rawDuration:0,_loopType:0,_tweenEasing:0,animationInternal:null,_currentFrame:0,_durationTween:0,_nextFrameIndex:0,_curFrameIndex:null,_isLoopBack:!1,ctor:function(){this._processScale=1,this._isPause=this._isComplete=!0,this._isPlaying=!1,this._rawDuration=this._durationTween=this._currentPercent=this._currentFrame=0,this._loopType=ccs.ANIMATION_TYPE_LOOP_BACK,this._tweenEasing=ccs.TweenType.LINEAR,this.animationInternal=1/60,this._durationTween=this._curFrameIndex=0,this._isLoopBack=!1},pause:function(){this._isPause=!0,this._isPlaying=!1},resume:function(){this._isPause=!1,this._isPlaying=!0},stop:function(){this._isComplete=!0,this._isPlaying=!1},play:function(t,e,i,n){this._isPause=this._isComplete=!1,this._isPlaying=!0,this._currentFrame=0,this._nextFrameIndex=t,this._tweenEasing=n},update:function(t){var e,i;this._isComplete||this._isPause||this._rawDuration<=0||1<t||(e=void 0===this._nextFrameIndex?0:this._nextFrameIndex,i=this._currentFrame,i=e<=0?(this._currentPercent=1,0):(i+=t/this.animationInternal*this._processScale,this._currentPercent=i/e,ccs.fmodf(i,e)),this._currentFrame=i,this.updateHandler())},gotoFrame:function(t){var e=this._loopType;e===ccs.ANIMATION_TYPE_NO_LOOP?e=ccs.ANIMATION_TYPE_MAX:e===ccs.ANIMATION_TYPE_TO_LOOP_FRONT&&(e=ccs.ANIMATION_TYPE_LOOP_FRONT),this._loopType=e,this._curFrameIndex=t,this._nextFrameIndex=this._durationTween},getCurrentFrameIndex:function(){return this._curFrameIndex=(this._rawDuration-1)*this._currentPercent},updateHandler:function(){},isPause:function(){return this._isPause},isComplete:function(){return this._isComplete},getCurrentPercent:function(){return this._currentPercent},getRawDuration:function(){return this._rawDuration},getLoop:function(){return this._loopType},getTweenEasing:function(){return this._tweenEasing},getAnimationInternal:function(){return this.animationInternal},setAnimationInternal:function(t){this.animationInternal=t},getProcessScale:function(){return this._processScale},setProcessScale:function(t){this._processScale=t},isPlaying:function(){return this._isPlaying}}),_p=ccs.ProcessBase.prototype,cc.defineGetterSetter(_p,"currentFrameIndex",_p.getCurrentFrameIndex),cc.defineGetterSetter(_p,"paused",_p.isPause),cc.defineGetterSetter(_p,"completed",_p.isComplete),cc.defineGetterSetter(_p,"currentPercent",_p.getCurrentPercent),cc.defineGetterSetter(_p,"rawDuration",_p.getRawDuration),cc.defineGetterSetter(_p,"loop",_p.getLoop),cc.defineGetterSetter(_p,"tweenEasing",_p.getTweenEasing),cc.defineGetterSetter(_p,"playing",_p.isPlaying),_p=null,ccs.MovementEventType={start:0,complete:1,loopComplete:2},ccs.AnimationEvent=ccs.Class.extend({_arguments:null,_callFunc:null,_selectorTarget:null,ctor:function(t,e,i){this._data=i,this._callFunc=t,this._selectorTarget=e},call:function(){this._callFunc&&this._callFunc.apply(this._selectorTarget,this._arguments)},setArguments:function(t){this._arguments=t}}),ccs.MovementEvent=function(){this.armature=null,this.movementType=ccs.MovementEventType.start,this.movementID=""},ccs.FrameEvent=function(){this.bone=null,this.frameEventName="",this.currentFrameIndex=this.originFrameIndex=0},ccs.ArmatureAnimation=ccs.ProcessBase.extend({_animationData:null,_movementData:null,_armature:null,_movementID:"",_toIndex:0,_tweenList:null,_speedScale:1,_ignoreFrameEvent:!1,_frameEventQueue:null,_movementEventQueue:null,_movementList:null,_onMovementList:!1,_movementListLoop:!1,_movementIndex:0,_movementListDurationTo:-1,_movementEventCallFunc:null,_frameEventCallFunc:null,_movementEventTarget:null,_frameEventTarget:null,_movementEventListener:null,_frameEventListener:null,ctor:function(t){ccs.ProcessBase.prototype.ctor.call(this),this._tweenList=[],this._movementList=[],this._frameEventQueue=[],this._movementEventQueue=[],this._armature=null,t&&ccs.ArmatureAnimation.prototype.init.call(this,t)},init:function(t){return this._armature=t,!(this._tweenList.length=0)},pause:function(){for(var t=this._tweenList,e=0;e<t.length;e++)t[e].pause();ccs.ProcessBase.prototype.pause.call(this)},resume:function(){for(var t=this._tweenList,e=0;e<t.length;e++)t[e].resume();ccs.ProcessBase.prototype.resume.call(this)},stop:function(){for(var t=this._tweenList,e=0;e<t.length;e++)t[e].stop();t.length=0,ccs.ProcessBase.prototype.stop.call(this)},setAnimationScale:function(t){this.setSpeedScale(t)},getAnimationScale:function(){return this.getSpeedScale()},setSpeedScale:function(t){if(t!==this._speedScale)for(var e in this._speedScale=t,this._processScale=this._movementData?this._speedScale*this._movementData.scale:this._speedScale,t=this._armature.getBoneDic()){e=t[e];e.getTween().setProcessScale(this._processScale),e.getChildArmature()&&e.getChildArmature().getAnimation().setSpeedScale(this._processScale)}},getSpeedScale:function(){return this._speedScale},play:function(t,e,i){cc.assert(this._animationData,"this.animationData can not be null"),this._movementData=this._animationData.getMovement(t),cc.assert(this._movementData,"this._movementData can not be null"),e=void 0===e?-1:e,i=void 0===i?-1:i,this._rawDuration=this._movementData.duration,this._movementID=t,this._processScale=this._speedScale*this._movementData.scale,e=-1===e?this._movementData.durationTo:e,t=0===this._movementData.durationTween?this._rawDuration:this._movementData.durationTween;var n=this._movementData.tweenEasing;i=i<0?this._movementData.loop:i,this._onMovementList=!1,ccs.ProcessBase.prototype.play.call(this,e,t,i,n),0===this._rawDuration?this._loopType=ccs.ANIMATION_TYPE_SINGLE_FRAME:(this._loopType=i?ccs.ANIMATION_TYPE_TO_LOOP_FRONT:ccs.ANIMATION_TYPE_NO_LOOP,this._durationTween=t),this._tweenList.length=0;var s,r=this._armature.getBoneDic();for(s in r){var o=r[s],a=this._movementData.movBoneDataDic[o.getName()],c=o.getTween();a&&0<a.frameList.length?(this._tweenList.push(c),a.duration=this._movementData.duration,c.play(a,e,t,i,n),c.setProcessScale(this._processScale),o.getChildArmature()&&(o.getChildArmature().getAnimation().setSpeedScale(this._processScale),o.getChildArmature().getAnimation().isPlaying()||o.getChildArmature().getAnimation().playWithIndex(0))):o.isIgnoreMovementBoneData()||(o.getDisplayManager().changeDisplayWithIndex(-1,!1),c.stop())}this._armature.update(0)},playByIndex:function(t,e,i,n,s){cc.log("playByIndex is deprecated. Use playWithIndex instead."),this.playWithIndex(t,e,n)},playWithIndex:function(t,e,i){var n=this._animationData.movementNames;cc.assert(-1<t&&t<n.length),this.play(n[t],e,i)},playWithNames:function(t,e,i){this._movementListLoop=void 0===i||i,this._movementListDurationTo=void 0===e?-1:e,this._onMovementList=!0,this._movementIndex=0,t instanceof Array?this._movementList=t:this._movementList.length=0,this.updateMovementList()},playWithIndexes:function(t,e,i){for(this._movementList.length=0,this._movementListLoop=void 0===i||i,this._movementListDurationTo=void 0===e?-1:e,this._onMovementList=!0,this._movementIndex=0,e=this._animationData.movementNames,i=0;i<t.length;i++)this._movementList.push(e[t[i]]);this.updateMovementList()},gotoAndPlay:function(t){if(!this._movementData||t<0||t>=this._movementData.duration)cc.log("Please ensure you have played a movement, and the frameIndex is in the range.");else{var e=this._ignoreFrameEvent;this._isPlaying=this._ignoreFrameEvent=!0,this._isComplete=this._isPause=!1,ccs.ProcessBase.prototype.gotoFrame.call(this,t),this._currentPercent=this._curFrameIndex/(this._movementData.duration-1),this._currentFrame=this._nextFrameIndex*this._currentPercent;for(var i=this._tweenList,n=0;n<i.length;n++)i[n].gotoAndPlay(t);this._armature.update(0),this._ignoreFrameEvent=e}},gotoAndPause:function(t){this.gotoAndPlay(t),this.pause()},getMovementCount:function(){return this._animationData.getMovementCount()},update:function(t){ccs.ProcessBase.prototype.update.call(this,t);for(var e=this._tweenList,i=0;i<e.length;i++)e[i].update(t);for(e=this._frameEventQueue;0<e.length;)t=e.shift(),this._ignoreFrameEvent=!0,this._frameEventCallFunc&&this._frameEventCallFunc.call(this._frameEventTarget,t.bone,t.frameEventName,t.originFrameIndex,t.currentFrameIndex),this._frameEventListener&&this._frameEventListener(t.bone,t.frameEventName,t.originFrameIndex,t.currentFrameIndex),this._ignoreFrameEvent=!1;for(e=this._movementEventQueue;0<e.length;)t=e.shift(),this._movementEventCallFunc&&this._movementEventCallFunc.call(this._movementEventTarget,t.armature,t.movementType,t.movementID),this._movementEventListener&&this._movementEventListener(t.armature,t.movementType,t.movementID)},updateHandler:function(){var t=this._currentPercent;if(1<=t){switch(this._loopType){case ccs.ANIMATION_TYPE_NO_LOOP:this._loopType=ccs.ANIMATION_TYPE_MAX,this._currentFrame=(t-1)*this._nextFrameIndex,(t=this._currentFrame/this._durationTween)<1&&(this._nextFrameIndex=this._durationTween,this.movementEvent(this._armature,ccs.MovementEventType.start,this._movementID));break;case ccs.ANIMATION_TYPE_MAX:case ccs.ANIMATION_TYPE_SINGLE_FRAME:t=1,this._isComplete=!0,this._isPlaying=!1,this.movementEvent(this._armature,ccs.MovementEventType.complete,this._movementID),this.updateMovementList();break;case ccs.ANIMATION_TYPE_TO_LOOP_FRONT:this._loopType=ccs.ANIMATION_TYPE_LOOP_FRONT,t=ccs.fmodf(t,1),this._currentFrame=0===this._nextFrameIndex?0:ccs.fmodf(this._currentFrame,this._nextFrameIndex),this._nextFrameIndex=0<this._durationTween?this._durationTween:1,this.movementEvent(this,ccs.MovementEventType.start,this._movementID);break;default:this._currentFrame=ccs.fmodf(this._currentFrame,this._nextFrameIndex),this._toIndex=0,this.movementEvent(this._armature,ccs.MovementEventType.loopComplete,this._movementID)}this._currentPercent=t}},getCurrentMovementID:function(){return this._isComplete?"":this._movementID},setMovementEventCallFunc:function(t,e){1===arguments.length?this._movementEventListener=t:2===arguments.length&&(this._movementEventTarget=e,this._movementEventCallFunc=t)},setFrameEventCallFunc:function(t,e){1===arguments.length?this._frameEventListener=t:2===arguments.length&&(this._frameEventTarget=e,this._frameEventCallFunc=t)},setUserObject:function(t){this._userObject=t},frameEvent:function(t,e,i,n){var s;(this._frameEventTarget&&this._frameEventCallFunc||this._frameEventListener)&&((s=new ccs.FrameEvent).bone=t,s.frameEventName=e,s.originFrameIndex=i,s.currentFrameIndex=n,this._frameEventQueue.push(s))},movementEvent:function(t,e,i){var n;(this._movementEventTarget&&this._movementEventCallFunc||this._movementEventListener)&&((n=new ccs.MovementEvent).armature=t,n.movementType=e,n.movementID=i,this._movementEventQueue.push(n))},updateMovementList:function(){var t,e;this._onMovementList&&(e=this._movementList,this._movementListLoop?(t=e[this._movementIndex],this.play(t,t.durationTo,0),this._movementIndex++,this._movementIndex>=e.length&&(this._movementIndex=0)):this._movementIndex<e.length?(t=e[this._movementIndex],this.play(t,t.durationTo,0),this._movementIndex++):this._onMovementList=!1,this._onMovementList=!0)},setAnimationData:function(t){this._animationData!==t&&(this._animationData=t)},getAnimationData:function(){return this._animationData},getUserObject:function(){return this._userObject},isIgnoreFrameEvent:function(){return this._ignoreFrameEvent}}),_p=ccs.ArmatureAnimation.prototype,cc.defineGetterSetter(_p,"speedScale",_p.getSpeedScale,_p.setSpeedScale),cc.defineGetterSetter(_p,"animationScale",_p.getAnimationScale,_p.setAnimationScale),_p=null,ccs.ArmatureAnimation.create=function(t){return new ccs.ArmatureAnimation(t)},ccs.Tween=ccs.ProcessBase.extend({_tweenData:null,_to:null,_from:null,_between:null,_movementBoneData:null,_bone:null,_frameTweenEasing:0,_betweenDuration:0,_totalDuration:0,_toIndex:0,_fromIndex:0,_animation:null,_passLastFrame:!1,ctor:function(t){ccs.ProcessBase.prototype.ctor.call(this),this._frameTweenEasing=ccs.TweenType.LINEAR,ccs.Tween.prototype.init.call(this,t)},init:function(t){return this._from=new ccs.FrameData,this._between=new ccs.FrameData,this._bone=t,this._tweenData=this._bone.getTweenData(),this._tweenData.displayIndex=-1,this._animation=null!==this._bone&&null!==this._bone.getArmature()?this._bone.getArmature().getAnimation():null,!0},play:function(t,e,i,n,s){ccs.ProcessBase.prototype.play.call(this,e,i,n,s),this._loopType=n?ccs.ANIMATION_TYPE_TO_LOOP_FRONT:ccs.ANIMATION_TYPE_NO_LOOP,this._fromIndex=this._toIndex=this._betweenDuration=this._totalDuration=0,s=t!==this._movementBoneData,this.setMovementBoneData(t),this._rawDuration=this._movementBoneData.duration,t=this._movementBoneData.getFrameData(0),this._tweenData.displayIndex=t.displayIndex,this._bone.getArmature().getArmatureData().dataVersion>=ccs.CONST_VERSION_COMBINED&&(ccs.TransformHelp.nodeSub(this._tweenData,this._bone.getBoneData()),this._tweenData.scaleX+=1,this._tweenData.scaleY+=1),0===this._rawDuration?(this._loopType=ccs.ANIMATION_TYPE_SINGLE_FRAME,0===e?this.setBetween(t,t):this.setBetween(this._tweenData,t),this._frameTweenEasing=ccs.TweenType.LINEAR):1<this._movementBoneData.frameList.length&&(this._durationTween=i*this._movementBoneData.scale,n&&0!==this._movementBoneData.delay?this.setBetween(this._tweenData,this.tweenNodeTo(this.updateFrameData(1-this._movementBoneData.delay),this._between)):s&&0!==e?this.setBetween(this._tweenData,t):this.setBetween(t,t)),this.tweenNodeTo(0)},gotoAndPlay:function(t){ccs.ProcessBase.prototype.gotoFrame.call(this,t),this._fromIndex=this._toIndex=this._betweenDuration=this._totalDuration=0,this._isPlaying=!0,this._isComplete=this._isPause=!1,this._currentPercent=this._curFrameIndex/(this._rawDuration-1),this._currentFrame=this._nextFrameIndex*this._currentPercent},gotoAndPause:function(t){this.gotoAndPlay(t),this.pause()},updateHandler:function(){var t=null==this._currentPercent?1:this._currentPercent,e=this._loopType;if(1<=t)switch(e){case ccs.ANIMATION_TYPE_SINGLE_FRAME:t=1,this._isComplete=!0,this._isPlaying=!1;break;case ccs.ANIMATION_TYPE_NO_LOOP:e=ccs.ANIMATION_TYPE_MAX,1<=(t=this._durationTween<=0?1:(t-1)*this._nextFrameIndex/this._durationTween)?(t=1,this._isComplete=!0,this._isPlaying=!1):(this._nextFrameIndex=this._durationTween,this._currentFrame=t*this._nextFrameIndex,this._fromIndex=this._toIndex=this._betweenDuration=this._totalDuration=0);break;case ccs.ANIMATION_TYPE_TO_LOOP_FRONT:e=ccs.ANIMATION_TYPE_LOOP_FRONT,this._nextFrameIndex=0<this._durationTween?this._durationTween:1,0!==this._movementBoneData.delay?(this._currentFrame=(1-this._movementBoneData.delay)*this._nextFrameIndex,t=this._currentFrame/this._nextFrameIndex):this._currentFrame=t=0,this._fromIndex=this._toIndex=this._betweenDuration=this._totalDuration=0;break;case ccs.ANIMATION_TYPE_MAX:t=1,this._isComplete=!0,this._isPlaying=!1;break;default:this._currentFrame=ccs.fmodf(this._currentFrame,this._nextFrameIndex)}t<1&&e<ccs.ANIMATION_TYPE_TO_LOOP_BACK&&(t=Math.sin(t*cc.PI/2)),this._currentPercent=t,(this._loopType=e)>ccs.ANIMATION_TYPE_TO_LOOP_BACK&&(t=this.updateFrameData(t)),this._frameTweenEasing!==ccs.TweenType.TWEEN_EASING_MAX&&this.tweenNodeTo(t)},setBetween:function(t,e,i){void 0===i&&(i=!0),t.displayIndex<0&&0<=e.displayIndex?(this._from.copy(e),this._between.subtract(e,e,i)):e.displayIndex<0&&0<=t.displayIndex?(this._from.copy(t),this._between.subtract(e,e,i)):(this._from.copy(t),this._between.subtract(t,e,i)),t.isTween||(this._tweenData.copy(t),this._tweenData.isTween=!0),this.arriveKeyFrame(t)},arriveKeyFrame:function(t){var e,i,n;t&&(i=(e=this._bone).getDisplayManager(),n=t.displayIndex,i.getForceChangeDisplay()||i.changeDisplayWithIndex(n,!1),this._tweenData.zOrder=t.zOrder,e.updateZOrder(),this._bone.setBlendFunc(t.blendFunc),e=e.getChildArmature())&&""!==t.movement&&e.getAnimation().play(t.movement)},tweenNodeTo:function(t,e){e=e||this._tweenData;var i=this._from,n=this._between;return i.isTween||(t=0),e.x=i.x+t*n.x,e.y=i.y+t*n.y,e.scaleX=i.scaleX+t*n.scaleX,e.scaleY=i.scaleY+t*n.scaleY,e.skewX=i.skewX+t*n.skewX,e.skewY=i.skewY+t*n.skewY,this._bone.setTransformDirty(!0),e&&n.isUseColorInfo&&this.tweenColorTo(t,e),e},tweenColorTo:function(t,e){var i=this._from,n=this._between;e.a=i.a+t*n.a,e.r=i.r+t*n.r,e.g=i.g+t*n.g,e.b=i.b+t*n.b,this._bone.updateColor()},updateFrameData:function(t){1<t&&0!==this._movementBoneData.delay&&(t=ccs.fmodf(t,1)),t*=this._rawDuration-1;var e,i,n=this._totalDuration,s=this._betweenDuration,r=this._toIndex;if(t<n||n+s<=t){var o=(s=this._movementBoneData.frameList).length;if(t<s[0].frameID)return e=i=s[0],this.setBetween(e,i),this._currentPercent;if(t>=s[o-1].frameID){if(this._passLastFrame)return e=i=s[o-1],this.setBetween(e,i),this._currentPercent;this._passLastFrame=!0}else this._passLastFrame=!1;do{if(this._fromIndex=r,n=(e=s[this._fromIndex]).frameID,i=s[r=o<=(r=this._fromIndex+1)?0:r],e.strEvent&&!this._animation.isIgnoreFrameEvent()&&this._animation.frameEvent(this._bone,e.strEvent,e.frameID,t),t===e.frameID||this._passLastFrame&&this._fromIndex===o-1)break}while(t<e.frameID||t>=i.frameID);s=i.frameID-e.frameID,this._frameTweenEasing=e.tweenEasing,this.setBetween(e,i,!1),this._totalDuration=n,this._betweenDuration=s,this._toIndex=r}return t=0===s?0:(t-this._totalDuration)/this._betweenDuration,t=(e=this._frameTweenEasing!==ccs.TweenType.LINEAR?this._frameTweenEasing:this._tweenEasing)===ccs.TweenType.TWEEN_EASING_MAX||e===ccs.TweenType.LINEAR||this._passLastFrame?t:ccs.TweenFunction.tweenTo(t,e,this._from.easingParams)},setAnimation:function(t){this._animation=t},getAnimation:function(){return this._animation},setMovementBoneData:function(t){this._movementBoneData=t}}),_p=ccs.Tween.prototype,cc.defineGetterSetter(_p,"animation",_p.getAnimation,_p.setAnimation),_p=null,ccs.Tween.create=function(t){return new ccs.Tween(t)},ccs.PT_RATIO=32,ccs.ColliderFilter=ccs.Class.extend({_collisionType:0,_group:0,_categoryBits:0,_groupIndex:0,_maskBits:0,ctor:function(t,e){this._collisionType=t||0,this._group=e||0},updateShape:function(t){var e;t instanceof cp.Shape?(t.collision_type=this._collisionType,t.group=this._group):t instanceof Box2D.b2FilterData&&((e=new Box2D.b2FilterData).categoryBits=this._categoryBits,e.groupIndex=this._groupIndex,e.maskBits=this._maskBits,t.SetFilterData(e))}}),ccs.ColliderBody=ccs.Class.extend({shape:null,coutourData:null,colliderFilter:null,_calculatedVertexList:null,ctor:function(t){this.shape=null,this.coutourData=t,this.colliderFilter=new ccs.ColliderFilter,ccs.ENABLE_PHYSICS_SAVE_CALCULATED_VERTEX&&(this._calculatedVertexList=[])},getContourData:function(){return this.coutourData},setColliderFilter:function(t){this.colliderFilter=t},getCalculatedVertexList:function(){return this._calculatedVertexList},setB2Fixture:function(t){this._fixture=t},getB2Fixture:function(){return this._fixture},setShape:function(t){this.shape=t},getShape:function(){return this.shape},setContourData:function(t){this.coutourData=t},getColliderFilter:function(){return this.colliderFilter}}),ccs.ColliderDetector=ccs.Class.extend({_colliderBodyList:null,_bone:null,_body:null,_active:!1,_filter:null,helpPoint:cc.p(0,0),ctor:function(t){this._colliderBodyList=[],this._body=this._bone=null,this._active=!1,this._filter=null,ccs.ColliderDetector.prototype.init.call(this,t)},init:function(t){return this._colliderBodyList.length=0,t&&(this._bone=t),this._filter=new ccs.ColliderFilter,!0},addContourData:function(t){var e=new ccs.ColliderBody(t);if(this._colliderBodyList.push(e),ccs.ENABLE_PHYSICS_SAVE_CALCULATED_VERTEX){e=e.getCalculatedVertexList(),t=t.vertexList;for(var i=0;i<t.length;i++){var n=new ccs.ContourVertex2(0,0);e.push(n)}}},addContourDataList:function(t){for(var e=0;e<t.length;e++)this.addContourData(t[e])},removeContourData:function(t){for(var e=[],i=this._colliderBodyList,n=0;n<i.length;n++){var s=i[n];s&&s.getContourData()===t&&e.push(s)}for(n=0;n<e.length;n++)cc.arrayRemoveObject(i,e[n])},removeAll:function(){this._colliderBodyList.length=0},setActive:function(t){var e;if(this._active!==t&&(this._active=t,t=this._body))if(e=null,this._active)for(var i=0;i<this._colliderBodyList.length;i++)e=(e=this._colliderBodyList[i]).getShape(),t.space.addShape(e);else for(i=0;i<this._colliderBodyList.length;i++)e=(e=this._colliderBodyList[i]).getShape(),t.space.removeShape(e)},getActive:function(){return this._active},getColliderBodyList:function(){return this._colliderBodyList},setColliderFilter:function(t){this._filter=t;for(var e=this._colliderBodyList,i=0;i<e.length;i++){var n=e[i];n.setColliderFilter(t),n.getShape()&&n.getColliderFilter().updateShape(n.getShape())}},getColliderFilter:function(){return this._filter},updateTransform:function(t){if(this._active)for(var e=null,i=this._body,n=this.helpPoint,s=0;s<this._colliderBodyList.length;s++){var r=(e=this._colliderBodyList[s]).getContourData(),o=null;i&&(o=e.getShape());for(var a,r=r.vertexList,c=e.getCalculatedVertexList(),e=0;e<r.length;e++)n.x=r[e].x,n.y=r[e].y,n=cc.pointApplyAffineTransform(n,t),ccs.ENABLE_PHYSICS_SAVE_CALCULATED_VERTEX&&((a=cc.p(0,0)).x=n.x,a.y=n.y,c[e]=a),o&&(o.verts[2*e]=n.x,o.verts[2*e+1]=n.y);if(o)for(e=0;e<r.length;e++)c=cp.v.normalize(cp.v.perp(cp.v.sub(o.verts[(e+1)%o.verts.length],o.verts[e]))),o.planes&&(o.planes[e].n=c,o.planes[e].d=cp.v.dot(c,o.verts[e]))}},setBody:function(t){this._body=t;for(var e=this._colliderBodyList,i=0;i<e.length;i++){for(var n=[],s=(t=e[i]).getContourData().vertexList,r=0;r<s.length;r++){var o=s[r];n.push(o.x),n.push(o.y)}(n=new cp.PolyShape(this._body,n,cp.vzero)).sensor=!0,n.data=this._bone,this._active&&this._body.space.addShape(n),t.setShape(n),t.getColliderFilter().updateShape(n)}},getBody:function(){return this._body}}),_p=ccs.ColliderDetector.prototype,cc.defineGetterSetter(_p,"colliderFilter",_p.getColliderFilter,_p.setColliderFilter),cc.defineGetterSetter(_p,"active",_p.getActive,_p.setActive),cc.defineGetterSetter(_p,"body",_p.getBody,_p.setBody),_p=null,ccs.ColliderDetector.create=function(t){return new ccs.ColliderDetector(t)},ccs.Armature=ccs.Node.extend({animation:null,armatureData:null,batchNode:null,_parentBone:null,_boneDic:null,_topBoneList:null,_armatureIndexDic:null,_offsetPoint:null,version:0,_armatureTransformDirty:!0,_body:null,_blendFunc:null,_className:"Armature",ctor:function(t,e){cc.Node.prototype.ctor.call(this),this._name="",this._topBoneList=[],this._armatureIndexDic={},this._offsetPoint=cc.p(0,0),this._armatureTransformDirty=!0,this._blendFunc={src:cc.BLEND_SRC,dst:cc.BLEND_DST},t&&ccs.Armature.prototype.init.call(this,t,e),this._texture={}},init:function(t,e){e&&(this._parentBone=e),this.removeAllChildren(),this.animation=new ccs.ArmatureAnimation,this.animation.init(this),this._boneDic={},this._topBoneList.length=0;var i=ccs.armatureDataManager;if(""!==t){var n,s=i.getAnimationData(t);for(n in cc.assert(s,"AnimationData not exist!"),this.animation.setAnimationData(s),i=i.getArmatureData(t),cc.assert(i,"ArmatureData not exist!"),i=(this.armatureData=i).getBoneDataDic()){var i=this.createBone(String(n)),r=s.getMovement(s.movementNames[0]);!(r=r&&r.getMovementBoneData(i.getName()))||r.frameList.length<=0||!(r=r.getFrameData(0))||(i.getTweenData().copy(r),i.changeDisplayWithIndex(r.displayIndex,!1))}this.update(0),this.updateOffsetPoint()}else t="new_armature",this.armatureData=new ccs.ArmatureData,this.armatureData.name=t,(s=new ccs.AnimationData).name=t,i.addArmatureData(t,this.armatureData),i.addAnimationData(t,s),this.animation.setAnimationData(s);return this._renderCmd.initShaderCache(),this.setCascadeOpacityEnabled(!0),this.setCascadeColorEnabled(!0),!0},visit:function(t){var e=this._renderCmd;t=t?t._renderCmd:null,this._visible?(e.visit(t),e._dirtyFlag=0):e._propagateFlagsDown(t)},addChild:function(t,e,i){t instanceof ccui.Widget?cc.log("Armature doesn't support to add Widget as its child, it will be fix soon."):cc.Node.prototype.addChild.call(this,t,e,i)},createBone:function(t){var e,i,n=this.getBone(t);return n||(i=null,(e=(n=this.armatureData.getBoneData(t)).parentName)?(this.createBone(e),i=new ccs.Bone(t),this.addBone(i,e)):(i=new ccs.Bone(t),this.addBone(i,"")),i.setBoneData(n),i.getDisplayManager().changeDisplayWithIndex(-1,!1),i)},addBone:function(t,e){cc.assert(t,"Argument must be non-nil");var i=this._boneDic;t.getName()&&cc.assert(!i[t.getName()],"bone already added. It can't be added again"),e&&(e=i[e])?e.addChildBone(t):this._topBoneList.push(t),t.setArmature(this),i[t.getName()]=t,this.addChild(t)},removeBone:function(t,e){cc.assert(t,"bone must be added to the bone dictionary!"),t.setArmature(null),t.removeFromParent(e),cc.arrayRemoveObject(this._topBoneList,t),delete this._boneDic[t.getName()],this.removeChild(t,!0)},getBone:function(t){return this._boneDic[t]},changeBoneParent:function(t,e){cc.assert(t,"bone must be added to the bone dictionary!");var i=t.getParentBone();i&&(cc.arrayRemoveObject(i.getChildren(),t),t.setParentBone(null)),e&&((i=this._boneDic[e])?(i.addChildBone(t),cc.arrayRemoveObject(this._topBoneList,t)):this._topBoneList.push(t))},getBoneDic:function(){return this._boneDic},updateOffsetPoint:function(){var t=this.getBoundingBox(),e=(this.setContentSize(t),this._offsetPoint);e.x=-t.x,e.y=-t.y,0!==t.width&&0!==t.height&&this.setAnchorPoint(e.x/t.width,e.y/t.height)},getOffsetPoints:function(){return{x:this._offsetPoint.x,y:this._offsetPoint.y}},setAnimation:function(t){this.animation=t},getAnimation:function(){return this.animation},getArmatureTransformDirty:function(){return this._armatureTransformDirty},update:function(t){this.animation.update(t);for(var e=this._topBoneList,i=0;i<e.length;i++)e[i].update(t);this._armatureTransformDirty=!1},onEnter:function(){cc.Node.prototype.onEnter.call(this),this.scheduleUpdate()},onExit:function(){cc.Node.prototype.onExit.call(this),this.unscheduleUpdate()},getBoundingBox:function(){for(var t,e,i,n=0,s=!0,r=cc.rect(0,0,0,0),o=this._children,a=o.length,c=0;c<a;c++)!(t=o[c])||0===(n=t.getDisplayManager().getBoundingBox()).x&&0===n.y&&0===n.width&&0===n.height||(s?(t=n.x,e=n.y,i=n.x+n.width,n=n.y+n.height,s=!1):(t=(n.x<r.x?n:r).x,e=(n.y<r.y?n:r).y,i=n.x+n.width>r.x+r.width?n.x+n.width:r.x+r.width,n=n.y+n.height>r.y+r.height?n.y+n.height:r.y+r.height),r.x=t,r.y=e,r.width=i-t,r.height=n-e);return cc.rectApplyAffineTransform(r,this.getNodeToParentTransform())},getBoneAtPoint:function(t,e){for(var i=this._children,n=i.length-1;0<=n;n--){var s=i[n];if(s instanceof ccs.Bone&&s.getDisplayManager().containPoint(t,e))return s}return null},setParentBone:function(t){for(var e in this._parentBone=t,t=this._boneDic)t[e].setArmature(this)},getParentBone:function(){return this._parentBone},drawContour:function(){cc._drawingUtil.setDrawColor(255,255,255,255),cc._drawingUtil.setLineWidth(1);var t,e=this._boneDic;for(t in e)if(i=e[t].getColliderDetector())for(var i=i.getColliderBodyList(),n=0;n<i.length;n++){var s=i[n].getCalculatedVertexList();cc._drawingUtil.drawPoly(s,s.length,!0)}},setBody:function(t){if(this._body!==t){var e;this._body=t,t=(this._body.data=this)._children;for(var i=0;i<t.length;i++)if((n=t[i])instanceof ccs.Bone)for(var n=n.getDisplayManager().getDecorativeDisplayList(),s=0;s<n.length;s++)(e=(e=n[s]).getColliderDetector())&&e.setBody(this._body)}},getShapeList:function(){return this._body?this._body.shapeList:null},getBody:function(){return this._body},setBlendFunc:function(t,e){void 0===e?(this._blendFunc.src=t.src,this._blendFunc.dst=t.dst):(this._blendFunc.src=t,this._blendFunc.dst=e)},getBlendFunc:function(){return new cc.BlendFunc(this._blendFunc.src,this._blendFunc.dst)},setColliderFilter:function(t){var e,i=this._boneDic;for(e in i)i[e].setColliderFilter(t)},getArmatureData:function(){return this.armatureData},setArmatureData:function(t){this.armatureData=t},getBatchNode:function(){return this.batchNode},setBatchNode:function(t){this.batchNode=t},getVersion:function(){return this.version},setVersion:function(t){this.version=t},_createRenderCmd:function(){return new(cc._renderType===cc.game.RENDER_TYPE_CANVAS?ccs.Armature.CanvasRenderCmd:ccs.Armature.WebGLRenderCmd)(this)}}),_p=ccs.Armature.prototype,cc.defineGetterSetter(_p,"parentBone",_p.getParentBone,_p.setParentBone),cc.defineGetterSetter(_p,"body",_p.getBody,_p.setBody),cc.defineGetterSetter(_p,"colliderFilter",null,_p.setColliderFilter),_p=null,ccs.Armature.create=function(t,e){return new ccs.Armature(t,e)},ccs.Armature.RenderCmd={_updateAnchorPointInPoint:function(){var t=(i=this._node)._contentSize,e=i._anchorPoint,i=i._offsetPoint;this._anchorPointInPoints.x=t.width*e.x-i.x,this._anchorPointInPoints.y=t.height*e.y-i.y,this._realAnchorPointInPoints.x=t.width*e.x,this._realAnchorPointInPoints.y=t.height*e.y,this.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getAnchorPointInPoints:function(){return cc.p(this._realAnchorPointInPoints)}},!function(){ccs.Armature.CanvasRenderCmd=function(t){this._rootCtor(t),this._needDraw=!0,this._realAnchorPointInPoints=new cc.Point(0,0),this._canUseDirtyRegion=!0,this._startRenderCmd=new cc.CustomRenderCmd(this,this._startCmdCallback),this._RestoreRenderCmd=new cc.CustomRenderCmd(this,this._RestoreCmdCallback),this._startRenderCmd._canUseDirtyRegion=!0,this._RestoreRenderCmd._canUseDirtyRegion=!0,this._transform={a:1,b:0,c:0,d:1,tx:0,ty:0},this._worldTransform={a:1,b:0,c:0,d:1,tx:0,ty:0}};var t=ccs.Armature.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);cc.inject(ccs.Armature.RenderCmd,t),t.constructor=ccs.Armature.CanvasRenderCmd,t._startCmdCallback=function(t,e,i){var n=this._node._parent;this.transform(n?n._renderCmd:null),(t=t||cc._renderContext).save(),t._switchToArmatureMode(!0,this._worldTransform,e,i)},t.transform=function(t,e){this.originTransform(t,e);for(var i=this._node._children,n=0,s=i.length;n<s;n++){var r,o,a,c,h,l=i[n],u=l._renderCmd;l&&l.getDisplayRenderNode&&(o=l.getDisplayRenderNodeType(),r=l.getDisplayRenderNode())&&r._renderCmd&&((r=r._renderCmd).transform(null),o!==ccs.DISPLAY_TYPE_ARMATURE&&o!==ccs.DISPLAY_TYPE_SPRITE&&cc.affineTransformConcatIn(r._worldTransform,l._worldTransform),o=cc.Node._dirtyFlags,a=r._dirtyFlag,c=(h=u._dirtyFlag)&o.colorDirty,h&=o.opacityDirty,c&&u._updateDisplayColor(this._displayedColor),h&&u._updateDisplayOpacity(this._displayedOpacity),(c||h)&&u._updateColor(),u=l._renderCmd._displayedColor,l=l._renderCmd._displayedOpacity,c=a&o.colorDirty,h=a&o.opacityDirty,c&&r._updateDisplayColor(u),h&&r._updateDisplayOpacity(l),c||h)&&r._updateColor()}},t._RestoreCmdCallback=function(t){this._cacheDirty=!1,t._switchToArmatureMode(!1),t.restore()},t.initShaderCache=function(){},t.setShaderProgram=function(){},t.updateChildPosition=function(t,e){t.visit()},t.rendering=function(t,e,i){for(var n=this._node._children,s=0,r=n.length;s<r;s++){var o=n[s];if(o&&o.getDisplayRenderNode){var a=o.getDisplayRenderNode();if(null!==a)switch(o._renderCmd._syncStatus(this),o.getDisplayRenderNodeType()){case ccs.DISPLAY_TYPE_SPRITE:a.visit(o);break;case ccs.DISPLAY_TYPE_ARMATURE:a._renderCmd.rendering(t,e,i);break;default:a.visit(o)}}else o instanceof cc.Node&&this._visitNormalChild(o)}},t._visitNormalChild=function(t){if(t){var e=t._renderCmd;if(t._visible){e._curLevel=this._curLevel+1;var i,n,s=t._children,r=(e._syncStatus(this),e.transform(null),s.length);if(0<r){for(t.sortAllChildren(),i=0;i<r&&(n=s[i])._localZOrder<0;i++)n.visit(t);for(cc.renderer.pushRenderCommand(e);i<r;i++)s[i].visit(t)}else cc.renderer.pushRenderCommand(e);this._dirtyFlag=0}}},t.visit=function(t){var e=this._node;e._visible&&(this._syncStatus(t),e.sortAllChildren(),cc.renderer.pushRenderCommand(this._startRenderCmd),this.rendering(),cc.renderer.pushRenderCommand(this._RestoreRenderCmd),this._cacheDirty=!1)}}(),!function(){ccs.Armature.WebGLRenderCmd=function(t){this._rootCtor(t),this._needDraw=!0,this._parentCmd=null,this._realAnchorPointInPoints=new cc.Point(0,0),this._transform={a:1,b:0,c:0,d:1,tx:0,ty:0},this._worldTransform={a:1,b:0,c:0,d:1,tx:0,ty:0}};var t=ccs.Armature.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype);cc.inject(ccs.Armature.RenderCmd,t),t.constructor=ccs.Armature.WebGLRenderCmd,t.uploadData=function(t,e,i){t=this._node,i=this._parentCmd||this;for(var n=t._children,s=cc.BlendFunc.ALPHA_PREMULTIPLIED,r=cc.BlendFunc.ALPHA_NON_PREMULTIPLIED,o=0,a=n.length;o<a;o++){var c=n[o],h=c._renderCmd;if(c&&c.getDisplayRenderNode){var l=c.getDisplayRenderNode();if(null!==l)switch(e=l._renderCmd,c.getDisplayRenderNodeType()){case ccs.DISPLAY_TYPE_SPRITE:l instanceof ccs.Skin&&(l.setShaderProgram(this._shaderProgram),this._updateColorAndOpacity(e,c),e.transform(i),(h=c.getBlendFunc()).src!==s.src||h.dst!==s.dst?l.setBlendFunc(c.getBlendFunc()):(c=l.getTexture(),t._blendFunc.src===s.src&&t._blendFunc.dst===s.dst&&c&&!c.hasPremultipliedAlpha()?l.setBlendFunc(r):l.setBlendFunc(t._blendFunc)),cc.renderer._uploadBufferData(e));break;case ccs.DISPLAY_TYPE_ARMATURE:l.setShaderProgram(this._shaderProgram),this._updateColorAndOpacity(e,c),e._parentCmd=this;default:h._syncStatus(i),e._syncStatus(h),e.uploadData?cc.renderer._uploadBufferData(e):e.rendering&&(cc.renderer._batchRendering(),e.rendering(cc._renderContext))}}else c instanceof cc.Node&&(c.setShaderProgram(this._shaderProgram),h._syncStatus(i),h.uploadData?cc.renderer._uploadBufferData(h):h.rendering&&(cc.renderer._batchRendering(),h.rendering(cc._renderContext)))}return this._parentCmd=null,0},t.initShaderCache=function(){this._shaderProgram=cc.shaderCache.programForKey(cc.SHADER_SPRITE_POSITION_TEXTURECOLOR)},t.setShaderProgram=function(t){this._glProgramState=cc.GLProgramState.getOrCreateWithGLProgram(t)},t._updateColorAndOpacity=function(t,e){var i=e._renderCmd._displayedColor,e=e._renderCmd._displayedOpacity,n=cc.Node._dirtyFlags,s=t._dirtyFlag,r=s&n.colorDirty,n=s&n.opacityDirty;r&&t._updateDisplayColor(i),n&&t._updateDisplayOpacity(e),(r||n)&&t._updateColor()},t.visit=function(t){var e=this._node;if(e._visible){(t=t||this.getParentRenderCmd())&&(this._curLevel=t._curLevel+1),this._syncStatus(t),e.sortAllChildren(),t=cc.renderer;var i,n=e._children,s=n.length;for(isNaN(e._customZ)&&(e._vertexZ=t.assignedZ,t.assignedZ+=t.assignedZStep),i=0;i<s&&(e=n[i])._localZOrder<0;i++)isNaN(e._customZ)&&(e._vertexZ=t.assignedZ,t.assignedZ+=t.assignedZStep);for(t.pushRenderCommand(this);i<s;i++)e=n[i],isNaN(e._customZ)&&(e._vertexZ=t.assignedZ,t.assignedZ+=t.assignedZStep);this._dirtyFlag=0}}}(),ccs.Bone=ccs.Node.extend({_boneData:null,_armature:null,_childArmature:null,_displayManager:null,ignoreMovementBoneData:!1,_tween:null,_tweenData:null,_parentBone:null,_boneTransformDirty:!1,_worldTransform:null,_blendFunc:null,blendDirty:!1,_worldInfo:null,_armatureParentBone:null,_dataVersion:0,_className:"Bone",ctor:function(t){cc.Node.prototype.ctor.call(this),this._displayManager=this._tween=this._boneData=this._childArmature=this._armature=this._parentBone=this._tweenData=null,this.ignoreMovementBoneData=!1,this._worldTransform=cc.affineTransformMake(1,0,0,1,0,0),this._boneTransformDirty=!0,this._blendFunc=new cc.BlendFunc(cc.BLEND_SRC,cc.BLEND_DST),this.blendDirty=!1,this._armatureParentBone=this._worldInfo=null,this._dataVersion=0,ccs.Bone.prototype.init.call(this,t)},init:function(t){return t&&(this._name=t),this._tweenData=new ccs.FrameData,this._tween=new ccs.Tween(this),this._displayManager=new ccs.DisplayManager(this),this._worldInfo=new ccs.BaseData,this._boneData=new ccs.BaseData,!0},setBoneData:function(t){cc.assert(t,"_boneData must not be null"),this._boneData!==t&&(this._boneData=t),this.setName(this._boneData.name),this._localZOrder=this._boneData.zOrder,this._displayManager.initDisplayList(t)},getBoneData:function(){return this._boneData},setArmature:function(t){(this._armature=t)?(this._tween.setAnimation(this._armature.getAnimation()),this._dataVersion=this._armature.getArmatureData().dataVersion,this._armatureParentBone=this._armature.getParentBone()):this._armatureParentBone=null},getArmature:function(){return this._armature},update:function(t){var e,i;for(this._parentBone&&(this._boneTransformDirty=this._boneTransformDirty||this._parentBone.isTransformDirty()),this._armatureParentBone&&!this._boneTransformDirty&&(this._boneTransformDirty=this._armatureParentBone.isTransformDirty()),this._boneTransformDirty&&(e=this._tweenData,this._dataVersion>=ccs.CONST_VERSION_COMBINED&&(ccs.TransformHelp.nodeConcat(e,this._boneData),--e.scaleX,--e.scaleY),(i=this._worldInfo).copy(e),i.x=e.x+this._position.x,i.y=e.y+this._position.y,i.scaleX=e.scaleX*this._scaleX,i.scaleY=e.scaleY*this._scaleY,i.skewX=e.skewX+this._skewX+cc.degreesToRadians(this._rotationX),i.skewY=e.skewY+this._skewY-cc.degreesToRadians(this._rotationY),this._parentBone?this._applyParentTransform(this._parentBone):this._armatureParentBone&&this._applyParentTransform(this._armatureParentBone),ccs.TransformHelp.nodeToMatrix(i,this._worldTransform),this._armatureParentBone)&&cc.affineTransformConcatIn(this._worldTransform,this._armature.getNodeToParentTransform()),ccs.displayFactory.updateDisplay(this,t,this._boneTransformDirty||this._armature.getArmatureTransformDirty()),e=0;e<this._children.length;e++)this._children[e].update(t);this._boneTransformDirty=!1},_applyParentTransform:function(t){var e=this._worldInfo,i=t._worldTransform,n=(t=t._worldInfo,e.x),s=e.y;e.x=n*i.a+s*i.c+t.x,e.y=n*i.b+s*i.d+t.y,e.scaleX*=t.scaleX,e.scaleY*=t.scaleY,e.skewX+=t.skewX,e.skewY+=t.skewY},setBlendFunc:function(t,e){var i,n=this._blendFunc,t=void 0===e?(i=t.src,t.dst):(i=t,e);n.src===i&&n.dst===t||(n.src=i,n.dst=t,this.blendDirty=!0)},updateColor:function(){var t,e=this._displayManager.getDisplayRenderNode();null!==e&&(t=this._renderCmd,e.setColor(cc.color(t._displayedColor.r*this._tweenData.r/255,t._displayedColor.g*this._tweenData.g/255,t._displayedColor.b*this._tweenData.b/255)),e.setOpacity(t._displayedOpacity*this._tweenData.a/255))},updateZOrder:function(){this._armature.getArmatureData().dataVersion>=ccs.CONST_VERSION_COMBINED?this.setLocalZOrder(this._tweenData.zOrder+this._boneData.zOrder):this.setLocalZOrder(this._tweenData.zOrder)},addChildBone:function(t){cc.assert(t,"Argument must be non-nil"),cc.assert(!t.parentBone,"child already added. It can't be added again"),this._children.indexOf(t)<0&&(this._children.push(t),t.setParentBone(this))},removeChildBone:function(t,e){if(0<this._children.length&&-1!==this._children.getIndex(t)){if(e)for(var i=t._children,n=0;n<i.length;n++)t.removeChildBone(i[n],e);t.setParentBone(null),t.getDisplayManager().setCurrentDecorativeDisplay(null),cc.arrayRemoveObject(this._children,t)}},removeFromParent:function(t){this._parentBone&&this._parentBone.removeChildBone(this,t)},setParentBone:function(t){this._parentBone=t},getParentBone:function(){return this._parentBone},setChildArmature:function(t){this._childArmature!==t&&(null==t&&this._childArmature&&this._childArmature.setParentBone(null),this._childArmature=t)},getChildArmature:function(){return this._childArmature},getTween:function(){return this._tween},setLocalZOrder:function(t){this._localZOrder!==t&&cc.Node.prototype.setLocalZOrder.call(this,t)},getNodeToArmatureTransform:function(){return this._worldTransform},getNodeToWorldTransform:function(){return cc.affineTransformConcat(this._worldTransform,this._armature.getNodeToWorldTransform())},getDisplayRenderNode:function(){return this._displayManager.getDisplayRenderNode()},getDisplayRenderNodeType:function(){return this._displayManager.getDisplayRenderNodeType()},addDisplay:function(t,e){return this._displayManager.addDisplay(t,e||0)},removeDisplay:function(t){this._displayManager.removeDisplay(t)},changeDisplayByIndex:function(t,e){cc.log("changeDisplayByIndex is deprecated. Use changeDisplayWithIndex instead."),this.changeDisplayWithIndex(t,e)},changeDisplayByName:function(t,e){cc.log("changeDisplayByName is deprecated. Use changeDisplayWithName instead."),this.changeDisplayWithName(t,e)},changeDisplayWithIndex:function(t,e){this._displayManager.changeDisplayWithIndex(t,e)},changeDisplayWithName:function(t,e){this._displayManager.changeDisplayWithName(t,e)},getColliderDetector:function(){var t=this._displayManager.getCurrentDecorativeDisplay();return(t=t&&t.getColliderDetector())||null},setColliderFilter:function(t){for(var e=this._displayManager.getDecorativeDisplayList(),i=0;i<e.length;i++){var n=e[i].getColliderDetector();n&&n.setColliderFilter(t)}},getColliderFilter:function(){var t=this.displayManager.getCurrentDecorativeDisplay();return(t=t&&t.getColliderDetector())?t.getColliderFilter():null},setTransformDirty:function(t){this._boneTransformDirty=t},isTransformDirty:function(){return this._boneTransformDirty},getDisplayManager:function(){return this._displayManager},setIgnoreMovementBoneData:function(t){this._ignoreMovementBoneData=t},isIgnoreMovementBoneData:function(){return this._ignoreMovementBoneData},getBlendFunc:function(){return new cc.BlendFunc(this._blendFunc.src,this._blendFunc.dst)},setBlendDirty:function(t){this._blendDirty=t},isBlendDirty:function(){return this._blendDirty},getTweenData:function(){return this._tweenData},getWorldInfo:function(){return this._worldInfo},getChildrenBone:function(){return this._children},nodeToArmatureTransform:function(){return this.getNodeToArmatureTransform()},nodeToWorldTransform:function(){return this.getNodeToWorldTransform()},getColliderBodyList:function(){var t=this.getColliderDetector();return t?t.getColliderBodyList():null},getIgnoreMovementBoneData:function(){return this.isIgnoreMovementBoneData()},_createRenderCmd:function(){return new(cc._renderType===cc.game.RENDER_TYPE_CANVAS?ccs.Bone.CanvasRenderCmd:ccs.Bone.WebGLRenderCmd)(this)}}),_p=ccs.Bone.prototype,cc.defineGetterSetter(_p,"boneData",_p.getBoneData,_p.setBoneData),cc.defineGetterSetter(_p,"armature",_p.getArmature,_p.setArmature),cc.defineGetterSetter(_p,"childArmature",_p.getChildArmature,_p.setChildArmature),cc.defineGetterSetter(_p,"childrenBone",_p.getChildrenBone),cc.defineGetterSetter(_p,"tween",_p.getTween),cc.defineGetterSetter(_p,"tweenData",_p.getTweenData),cc.defineGetterSetter(_p,"colliderFilter",_p.getColliderFilter,_p.setColliderFilter),_p=null,ccs.Bone.create=function(t){return new ccs.Bone(t)},ccs.Bone.RenderCmd={_updateColor:function(){var t,e=this._node,i=e._displayManager.getDisplayRenderNode();null!==i&&(t=i._renderCmd,i.setColor(this._displayedColor),i.setOpacity(this._displayedOpacity),t._syncDisplayColor(e._tweenData),t._syncDisplayOpacity(e._tweenData.a),t._updateColor())},transform:function(t,e){this._transform||(this._transform={a:1,b:0,c:0,d:1,tx:0,ty:0},this._worldTransform={a:1,b:0,c:0,d:1,tx:0,ty:0});var i=this._node,n=this._transform,s=this._worldTransform,t=t?t._worldTransform:null;t&&(this.originTransform(),cc.affineTransformConcatIn(n,i._worldTransform)),t?(s.a=n.a*t.a+n.b*t.c,s.b=n.a*t.b+n.b*t.d,s.c=n.c*t.a+n.d*t.c,s.d=n.c*t.b+n.d*t.d,s.tx=n.tx*t.a+n.ty*t.c+t.tx,s.ty=n.tx*t.b+n.ty*t.d+t.ty):(s.a=n.a,s.b=n.b,s.c=n.c,s.d=n.d,s.tx=n.tx,s.ty=n.ty)}},!function(){ccs.Bone.CanvasRenderCmd=function(t){this._rootCtor(t),this._needDraw=!1};var t=ccs.Bone.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);cc.inject(ccs.Bone.RenderCmd,t),t.constructor=ccs.Bone.CanvasRenderCmd}(),!function(){var t;cc.Node.WebGLRenderCmd&&(ccs.Bone.WebGLRenderCmd=function(t){this._rootCtor(t),this._needDraw=!1},t=ccs.Bone.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype),cc.inject(ccs.Bone.RenderCmd,t),t.constructor=ccs.Bone.WebGLRenderCmd)}(),ccs.FRAME_TYPE_MOVE=0,ccs.FRAME_TYPE_SCALE=1,ccs.FRAME_TYPE_ROTATE=2,ccs.FRAME_TYPE_TINT=3,ccs.FRAME_TYPE_FADE=4,ccs.FRAME_TYPE_MAX=5,ccs.FrameEaseType={CUSTOM:-1,LINEAR:0,SINE_EASEIN:1,SINE_EASEOUT:2,SINE_EASEINOUT:3,QUAD_EASEIN:4,QUAD_EASEOUT:5,QUAD_EASEINOUT:6,CUBIC_EASEIN:7,CUBIC_EASEOUT:8,CUBIC_EASEINOUT:9,QUART_EASEIN:10,QUART_EASEOUT:11,QUART_EASEINOUT:12,QUINT_EASEIN:13,QUINT_EASEOUT:14,QUINT_EASEINOUT:15,EXPO_EASEIN:16,EXPO_EASEOUT:17,EXPO_EASEINOUT:18,CIRC_EASEIN:19,CIRC_EASEOUT:20,CIRC_EASEINOUT:21,ELASTIC_EASEIN:22,ELASTIC_EASEOUT:23,ELASTIC_EASEINOUT:24,BACK_EASEIN:25,BACK_EASEOUT:26,BACK_EASEINOUT:27,BOUNCE_EASEIN:28,BOUNCE_EASEOUT:29,BOUNCE_EASEINOUT:30,TWEEN_EASING_MAX:1e3},ccs.ActionFrame=ccs.Class.extend({frameType:0,easingType:0,frameIndex:0,_Parameter:null,time:0,ctor:function(){this.frameType=0,this.easingType=ccs.FrameEaseType.LINEAR,this.time=this.frameIndex=0},getAction:function(t,e){return cc.log("Need a definition of <getAction> for ActionFrame"),null},_getEasingAction:function(t){if(null===t)return console.error("Action cannot be null!"),null;var e;switch(this.easingType){case ccs.FrameEaseType.LINEAR:e=t;break;case ccs.FrameEaseType.SINE_EASEIN:e=t.easing(cc.easeSineIn());break;case ccs.FrameEaseType.SINE_EASEOUT:e=t.easing(cc.easeSineOut());break;case ccs.FrameEaseType.SINE_EASEINOUT:e=t.easing(cc.easeSineInOut());break;case ccs.FrameEaseType.QUAD_EASEIN:e=t.easing(cc.easeQuadraticActionIn());break;case ccs.FrameEaseType.QUAD_EASEOUT:e=t.easing(cc.easeQuadraticActionOut());break;case ccs.FrameEaseType.QUAD_EASEINOUT:e=t.easing(cc.easeQuadraticActionInOut());break;case ccs.FrameEaseType.CUBIC_EASEIN:e=t.easing(cc.easeCubicActionIn());break;case ccs.FrameEaseType.CUBIC_EASEOUT:e=t.easing(cc.easeCubicActionOut());break;case ccs.FrameEaseType.CUBIC_EASEINOUT:e=t.easing(cc.easeCubicActionInOut());break;case ccs.FrameEaseType.QUART_EASEIN:e=t.easing(cc.easeQuarticActionIn());break;case ccs.FrameEaseType.QUART_EASEOUT:e=t.easing(cc.easeQuarticActionOut());break;case ccs.FrameEaseType.QUART_EASEINOUT:e=t.easing(cc.easeQuarticActionInOut());break;case ccs.FrameEaseType.QUINT_EASEIN:e=t.easing(cc.easeQuinticActionIn());break;case ccs.FrameEaseType.QUINT_EASEOUT:e=t.easing(cc.easeQuinticActionOut());break;case ccs.FrameEaseType.QUINT_EASEINOUT:e=t.easing(cc.easeQuinticActionInOut());break;case ccs.FrameEaseType.EXPO_EASEIN:e=t.easing(cc.easeExponentialIn());break;case ccs.FrameEaseType.EXPO_EASEOUT:e=t.easing(cc.easeExponentialOut());break;case ccs.FrameEaseType.EXPO_EASEINOUT:e=t.easing(cc.easeExponentialInOut());break;case ccs.FrameEaseType.CIRC_EASEIN:e=t.easing(cc.easeCircleActionIn());break;case ccs.FrameEaseType.CIRC_EASEOUT:e=t.easing(cc.easeCircleActionOut());break;case ccs.FrameEaseType.CIRC_EASEINOUT:e=t.easing(cc.easeCircleActionInOut());break;case ccs.FrameEaseType.ELASTIC_EASEIN:e=t.easing(cc.easeElasticIn());break;case ccs.FrameEaseType.ELASTIC_EASEOUT:e=t.easing(cc.easeElasticOut());break;case ccs.FrameEaseType.ELASTIC_EASEINOUT:e=t.easing(cc.easeElasticInOut());break;case ccs.FrameEaseType.BACK_EASEIN:e=t.easing(cc.easeBackIn());break;case ccs.FrameEaseType.BACK_EASEOUT:e=t.easing(cc.easeBackOut());break;case ccs.FrameEaseType.BACK_EASEINOUT:e=t.easing(cc.easeBackInOut());break;case ccs.FrameEaseType.BOUNCE_EASEIN:e=t.easing(cc.easeBounceIn());break;case ccs.FrameEaseType.BOUNCE_EASEOUT:e=t.easing(cc.easeBounceOut());break;case ccs.FrameEaseType.BOUNCE_EASEINOUT:e=t.easing(cc.easeBounceInOut())}return e},setEasingParameter:function(t){this._Parameter=[];for(var e=0;e<t.length;e++)this._Parameter.push(t[e])},setEasingType:function(t){this.easingType=t}}),ccs.ActionMoveFrame=ccs.ActionFrame.extend({_position:null,ctor:function(){ccs.ActionFrame.prototype.ctor.call(this),this._position=cc.p(0,0),this.frameType=ccs.FRAME_TYPE_MOVE},setPosition:function(t,e){void 0===e?(this._position.x=t.x,this._position.y=t.y):(this._position.x=t,this._position.y=e)},getPosition:function(){return this._position},getAction:function(t){return this._getEasingAction(cc.moveTo(t,this._position))}}),ccs.ActionScaleFrame=ccs.ActionFrame.extend({_scaleX:1,_scaleY:1,ctor:function(){ccs.ActionFrame.prototype.ctor.call(this),this._scaleY=this._scaleX=1,this.frameType=ccs.FRAME_TYPE_SCALE},setScaleX:function(t){this._scaleX=t},getScaleX:function(){return this._scaleX},setScaleY:function(t){this._scaleY=t},getScaleY:function(){return this._scaleY},getAction:function(t){return this._getEasingAction(cc.scaleTo(t,this._scaleX,this._scaleY))}}),ccs.ActionRotationFrame=ccs.ActionFrame.extend({_rotation:0,ctor:function(){ccs.ActionFrame.prototype.ctor.call(this),this._rotation=0,this.frameType=ccs.FRAME_TYPE_ROTATE},setRotation:function(t){this._rotation=t},getRotation:function(){return this._rotation},getAction:function(t,e){return void 0===e?this._getEasingAction(cc.rotateTo(t,this._rotation)):e instanceof cc.ActionRotationFrame?this._getEasingAction(cc.rotateBy(t,this._rotation-e._rotation)):this.getAction(t)}}),ccs.ActionFadeFrame=ccs.ActionFrame.extend({_opacity:255,ctor:function(){ccs.ActionFrame.prototype.ctor.call(this),this._opacity=255,this.frameType=ccs.FRAME_TYPE_FADE},setOpacity:function(t){this._opacity=t},getOpacity:function(){return this._opacity},getAction:function(t){return this._getEasingAction(cc.fadeTo(t,this._opacity))}}),ccs.ActionTintFrame=ccs.ActionFrame.extend({_color:null,ctor:function(){ccs.ActionFrame.prototype.ctor.call(this),this._color=cc.color(255,255,255,255),this.frameType=ccs.FRAME_TYPE_TINT},setColor:function(t){var e=this._color;e.r=t.r,e.g=t.g,e.b=t.b},getColor:function(){var t=this._color;return cc.color(t.r,t.g,t.b,t.a)},getAction:function(t){return this._getEasingAction(cc.tintTo(t,this._color.r,this._color.g,this._color.b))}}),ccs.actionManager={_actionDic:{},initWithDictionary:function(t,e,i){var n=t.lastIndexOf("/");t=t.substr(n+1,t.length),e=e.actionlist;for(var n=[],s=0;s<e.length;s++){var r=new ccs.ActionObject;r.initWithDictionary(e[s],i),n.push(r)}this._actionDic[t]=n},getActionByName:function(t,e){var i=t.lastIndexOf("/"),i=t.substr(i+1,t.length);if(i=this._actionDic[i])for(var n=0;n<i.length;n++){var s=i[n];if(e===s.getName())return s}return null},playActionByName:function(t,e,i){(t=this.getActionByName(t,e))&&t.play(i)},stopActionByName:function(t,e){t=this.getActionByName(t,e);t&&t.stop()},releaseActions:function(){this._actionDic={}},clear:function(){this._actionDic={}}},ccs.ActionNode=ccs.Class.extend({_currentFrameIndex:0,_destFrameIndex:0,_unitTime:0,_actionTag:0,_object:null,_actionSpawn:null,_action:null,_frameArray:null,_frameArrayNum:0,ctor:function(){this._destFrameIndex=this._currentFrameIndex=0,this._unitTime=.1,this._actionTag=0,this._action=this._actionSpawn=this._object=null,this._frameArray=[],this._frameArrayNum=ccs.FRAME_TYPE_MAX;for(var t=0;t<this._frameArrayNum;t++)this._frameArray.push([])},initWithDictionary:function(t,e){this.setActionTag(t.ActionTag);for(var i=t.actionframelist,n=ccui.helper.seekActionWidgetByActionTag(e,t.ActionTag),s=n instanceof ccui.Widget&&!(n instanceof ccui.Layout),r=0;r<i.length;r++){var o=i[r],a=o.frameid,c=o.tweenType;null==c&&(c=0);for(var h,l=o.tweenParameter,u=[],d=0;d<l;d++)u.push(o.tweenParameter[d]);void 0!==o.positionx&&(d=o.positionx,h=o.positiony,s&&n.parent&&(d+=(l=n.parent.getAnchorPointInPoints()).x,h+=l.y),(l=new ccs.ActionMoveFrame).frameIndex=a,l.setEasingType(c),l.setEasingParameter(u),l.setPosition(d,h),(d=this._frameArray[ccs.FRAME_TYPE_MOVE]).push(l)),void 0!==o.scalex&&(d=o.scalex,h=o.scaley,(l=new ccs.ActionScaleFrame).frameIndex=a,l.setEasingType(c),l.setEasingParameter(u),l.setScaleX(d),l.setScaleY(h),(d=this._frameArray[ccs.FRAME_TYPE_SCALE]).push(l)),void 0!==o.rotation&&(d=o.rotation,(l=new ccs.ActionRotationFrame).frameIndex=a,l.setEasingType(c),l.setEasingParameter(u),l.setRotation(d),(d=this._frameArray[ccs.FRAME_TYPE_ROTATE]).push(l)),void 0!==o.opacity&&(d=o.opacity,(l=new ccs.ActionFadeFrame).frameIndex=a,l.setEasingType(c),l.setEasingParameter(u),l.setOpacity(d),(d=this._frameArray[ccs.FRAME_TYPE_FADE]).push(l)),void 0!==o.colorr&&(d=o.colorr,h=o.colorg,o=o.colorb,(l=new ccs.ActionTintFrame).frameIndex=a,l.setEasingType(c),l.setEasingParameter(u),l.setColor(cc.color(d,h,o)),(d=this._frameArray[ccs.FRAME_TYPE_TINT]).push(l))}this._initActionNodeFromRoot(e)},_initActionNodeFromRoot:function(t){t instanceof ccui.Widget&&(t=ccui.helper.seekActionWidgetByActionTag(t,this.getActionTag()))&&this.setObject(t)},setUnitTime:function(t){this._unitTime=t,this._refreshActionProperty()},getUnitTime:function(){return this._unitTime},setActionTag:function(t){this._actionTag=t},getActionTag:function(){return this._actionTag},setObject:function(t){this._object=t},getObject:function(){return this._object},getActionNode:function(){return this._object instanceof cc.Node?this._object:null},insertFrame:function(t,e){null!=e&&this._frameArray[e.frameType].splice(t,0,e)},addFrame:function(t){t&&this._frameArray[t.frameType].push(t)},deleteFrame:function(t){void 0!==t&&cc.arrayRemoveObject(this._frameArray[t.frameType],t)},clearAllFrame:function(){for(var t=0;t<this._frameArrayNum;t++)this._frameArray[t].length=0},_refreshActionProperty:function(){if(!this._object)return null;for(var t=[],e=0;e<this._frameArrayNum;e++){var i=this._frameArray[e];if(!(i.length<=0)){for(var n=[],s=0;s<i.length;s++){var r=i[s],o=null;(o=0!==s?(o=(r.frameIndex-i[s-1].frameIndex)*this.getUnitTime(),r.getAction(o)):r.getAction(0))&&n.push(o)}n&&null!==(i=cc.sequence(n))&&t.push(i)}}return this._action=null,this._actionSpawn=cc.spawn(t)},playAction:function(t){this._object&&this._actionSpawn&&(this._action=t?cc.sequence(this._actionSpawn,t):cc.sequence(this._actionSpawn),this._runAction())},_runAction:function(){var t=this.getActionNode();null!==t&&null!==this._action&&t.runAction(this._action)},stopAction:function(){var t=this.getActionNode();null===t||null===this._action||this._action.isDone()||t.stopAction(this._action)},getFirstFrameIndex:function(){for(var t=99999,e=!1,i=this._frameArray,n=0,s=this._frameArrayNum;n<s;n++){var r=i[n];r.length<=0||(e=!0,t=(r=r[0].frameIndex)<t?r:t)}return t=e?t:0},getLastFrameIndex:function(){for(var t=-1,e=!1,i=this._frameArray,n=0,s=this._frameArrayNum;n<s;n++){var r=i[n];r.length<=0||(e=!0,t=t<(r=r[r.length-1].frameIndex)?r:t)}return t=e?t:0},updateActionToTimeLine:function(t){for(var e=!1,i=this.getUnitTime(),n=0;n<this._frameArrayNum;n++){var s=this._frameArray[n];if(s)for(var r=0;r<s.length;r++){var o=s[r];if(o.frameIndex*i===t){this._easingToFrame(1,1,o),e=!0;break}if(o.frameIndex*i>t){e=0===r?(this._easingToFrame(1,1,o),!1):(e=s[r-1],s=(o.frameIndex-e.frameIndex)*i,r=t-e.frameIndex*i,this._easingToFrame(s,1,e),this._easingToFrame(s,r/s,o),!0);break}}}return e},_easingToFrame:function(t,e,i){t=i.getAction(t),i=this.getActionNode(),null!=t&&null!=i&&(t.startWithTarget(i),t.update(e))},isActionDoneOnce:function(){return!this._action||this._action.isDone()}}),ccs.ActionObject=ccs.Class.extend({_actionNodeList:null,_name:"",_loop:!1,_pause:!1,_playing:!1,_unitTime:0,_currentTime:0,_scheduler:null,_callback:null,_fTotalTime:0,ctor:function(){this._actionNodeList=[],this._name="",this._playing=this._pause=this._loop=!1,this._unitTime=.1,this._fTotalTime=this._currentTime=0,this._scheduler=cc.director.getScheduler()},setName:function(t){this._name=t},getName:function(){return this._name},setLoop:function(t){this._loop=t},getLoop:function(){return this._loop},setUnitTime:function(t){this._unitTime=t,t=this._actionNodeList.length;for(var e=0;e<t;e++)this._actionNodeList[e].setUnitTime(this._unitTime)},getUnitTime:function(){return this._unitTime},getCurrentTime:function(){return this._currentTime},setCurrentTime:function(t){this._currentTime=t},getTotalTime:function(){return this._fTotalTime},isPlaying:function(){return this._playing},initWithDictionary:function(t,e){this.setName(t.name),this.setLoop(t.loop),this.setUnitTime(t.unittime);for(var i=t.actionnodelist,n=0,s=0;s<i.length;s++){var r=new ccs.ActionNode;r.initWithDictionary(i[s],e),r.setUnitTime(this.getUnitTime()),this._actionNodeList.push(r),n<(r=r.getLastFrameIndex()-r.getFirstFrameIndex())&&(n=r)}this._fTotalTime=n*this._unitTime},addActionNode:function(t){t&&(this._actionNodeList.push(t),t.setUnitTime(this._unitTime))},removeActionNode:function(t){null!=t&&cc.arrayRemoveObject(this._actionNodeList,t)},play:function(t){this.stop(),this.updateToFrameByTime(0);for(var e=this._actionNodeList,i=e.length,n=0;n<i;n++)e[n].playAction(t);this._loop&&this._scheduler.schedule(this.simulationActionUpdate,this,0,cc.REPEAT_FOREVER,0,!1,this.__instanceId+""),void 0!==t&&(this._callback=t)},pause:function(){this._pause=!0,this._playing=!1},stop:function(){for(var t=this._actionNodeList,e=0;e<t.length;e++)t[e].stopAction();this._scheduler.unschedule(this.simulationActionUpdate,this),this._playing=this._pause=!1},updateToFrameByTime:function(t){this._currentTime=t;for(var e=0;e<this._actionNodeList.length;e++)this._actionNodeList[e].updateActionToTimeLine(t)},simulationActionUpdate:function(t){t=!0;for(var e=this._actionNodeList,i=0,n=e.length;i<n;i++)if(!e[i].isActionDoneOnce()){t=!1;break}t&&(null!==this._callback&&this._callback.execute(),this._loop?this.play():(this._playing=!1,this._scheduler.unschedule(this.simulationActionUpdate,this)))}}),ccs.ComAttribute=ccs.Component.extend({_jsonDict:null,_filePath:"",ctor:function(){cc.Component.prototype.ctor.call(this),this._jsonDict={},this._filePath="",this._name="CCComAttribute",ccs.ComAttribute.prototype.init.call(this)},init:function(){return this._jsonDict={},!0},setInt:function(t,e){t?this._jsonDict[t]=e:cc.log("Argument must be non-nil")},setDouble:function(t,e){t?this._jsonDict[t]=e:cc.log("Argument must be non-nil")},setFloat:function(t,e){t?this._jsonDict[t]=e:cc.log("Argument must be non-nil")},setBool:function(t,e){t?this._jsonDict[t]=e:cc.log("Argument must be non-nil")},setString:function(t,e){t?this._jsonDict[t]=e:cc.log("Argument must be non-nil")},setObject:function(t,e){t?this._jsonDict[t]=e:cc.log("Argument must be non-nil")},getInt:function(t){return parseInt(this._jsonDict[t]||0)},getDouble:function(t){return parseFloat(this._jsonDict[t]||0)},getFloat:function(t){return parseFloat(this._jsonDict[t]||0)},getBool:function(t){return Boolean(this._jsonDict[t]||!1)},getString:function(t){return this._jsonDict[t]||""},getObject:function(t){return this._jsonDict[t]},parse:function(t){this._jsonDict=cc.loader.getRes(t)}}),ccs.ComAttribute.create=function(){return new ccs.ComAttribute},ccs.ComAudio=ccs.Component.extend({_filePath:"",_loop:!1,ctor:function(){cc.Component.prototype.ctor.call(this),this._name="Audio",ccs.ComAudio.prototype.init.call(this)},init:function(){return!0},onExit:function(){this.stopBackgroundMusic(!0),this.stopAllEffects()},end:function(){cc.audioEngine.end()},preloadBackgroundMusic:function(t){cc.loader.load(t)},playBackgroundMusic:function(t,e){t?cc.audioEngine.playMusic(t,e):cc.audioEngine.playMusic(this._filePath,this._loop)},stopBackgroundMusic:function(t){cc.audioEngine.stopMusic(t)},pauseBackgroundMusic:function(){cc.audioEngine.pauseMusic()},resumeBackgroundMusic:function(){cc.audioEngine.resumeMusic()},rewindBackgroundMusic:function(){cc.audioEngine.rewindMusic()},willPlayBackgroundMusic:function(){return cc.audioEngine.willPlayMusic()},isBackgroundMusicPlaying:function(){return cc.audioEngine.isMusicPlaying()},getBackgroundMusicVolume:function(){return cc.audioEngine.getMusicVolume()},setBackgroundMusicVolume:function(t){cc.audioEngine.setMusicVolume(t)},getEffectsVolume:function(){return cc.audioEngine.getEffectsVolume()},setEffectsVolume:function(t){cc.audioEngine.setEffectsVolume(t)},playEffect:function(t,e){return t?cc.audioEngine.playEffect(t,e):cc.audioEngine.playEffect(this._filePath,this._loop)},pauseEffect:function(t){cc.audioEngine.pauseEffect(t)},pauseAllEffects:function(){cc.audioEngine.pauseAllEffects()},resumeEffect:function(t){cc.audioEngine.resumeEffect(t)},resumeAllEffects:function(){cc.audioEngine.resumeAllEffects()},stopEffect:function(t){cc.audioEngine.stopEffect(t)},stopAllEffects:function(){cc.audioEngine.stopAllEffects()},preloadEffect:function(t){cc.loader.getRes(t),this.setFile(t),this.setLoop(!1)},unloadEffect:function(t){cc.audioEngine.unloadEffect(t)},setFile:function(t){this._filePath=t},setLoop:function(t){this._loop=t},getFile:function(){return this._filePath},isLoop:function(){return this._loop}}),ccs.ComAudio.create=function(){return new ccs.ComAudio},ccs.ComController=ccs.Component.extend({ctor:function(){cc.Component.prototype.ctor.call(this),this._name="ComController",ccs.ComController.prototype.init.call(this)},onEnter:function(){null!==this._owner&&this._owner.scheduleUpdate()},isEnabled:function(){return this._enabled},setEnabled:function(t){this._enabled=t}}),ccs.ComController.create=function(){return new ccs.ComController},ccs.ComRender=ccs.Component.extend({_render:null,ctor:function(t,e){cc.Component.prototype.ctor.call(this),this._render=t,this._name=e,this.isRenderer=!0,ccs.ComRender.prototype.init.call(this)},onEnter:function(){this._owner&&this._owner.addChild(this._render)},onExit:function(){this._owner&&(this._owner.removeChild(this._render,!0),this._render=null)},getNode:function(){return this._render},setNode:function(t){this._render=t}}),ccs.ComRender.create=function(t,e){return new ccs.ComRender(t,e)},ccs.objectFactory={_typeMap:{},createObject:function(t){var e=null;return e=(t=this._typeMap[t])?cc.isFunction(t._fun)?new t._fun:t._fun:e},registerType:function(t){this._typeMap[t._className]=t},createGUI:function(t){var e=null;return"Panel"===t?t="Layout":"TextArea"===t?t="Label":"TextButton"===t&&(t="Button"),e=(t=this._typeMap[t])&&t._fun?t._fun:e},removeAll:function(){this._typeMap={}}},ccs.TInfo=ccs.Class.extend({_className:"",_fun:null,ctor:function(t,e){e?(this._className=t,this._fun=e):(this._className=t._className,this._fun=t._fun),ccs.objectFactory.registerType(this)}}),ccs.sendEvent=function(t){if(null!=(t=ccs.triggerManager.get(t)))for(var e=0;e<t.length;e++){var i=t[e];null!=i&&i.detect()&&i.done()}},ccs.registerTriggerClass=function(t,e){new ccs.TInfo(t,e)},ccs.triggerManager={_eventTriggers:{},_triggerObjs:{},_movementDispatches:[],parse:function(t){for(var e=0;e<t.length;++e){var i=t[e],n=new ccs.TriggerObj;n.serialize(i);for(var i=n.getEvents(),s=0;s<i.length;s++)this.add(i[s],n);this._triggerObjs[n.getId()]=n}},get:function(t){return this._eventTriggers[t]},getTriggerObj:function(t){return this._triggerObjs[t]},add:function(t,e){var i=this._eventTriggers[t];-1===(i=i||[]).indexOf(e)&&(i.push(e),this._eventTriggers[t]=i)},removeAll:function(){for(var t in this._eventTriggers)for(var e=this._eventTriggers[t],i=0;i<e.length;i++)e[i].removeAll();this._eventTriggers={}},remove:function(t,e){if(e)return this._removeObj(t,e);var i=!1,n=this._eventTriggers[t];if(n){for(i=0;i<n.length;i++){var s=n[i];s&&s.removeAll()}delete this._eventTriggers[t],i=!0}return i},_removeObj:function(t,e){var i=!1,n=this._eventTriggers[t];if(n){for(i=0;i<n.length;i++){var s=n[i];if(s&&s==e){s.removeAll(),n.splice(i,1);break}}i=!0}return i},removeTriggerObj:function(t){if(!(t=this.getTriggerObj(t)))return!1;for(var e=t.getEvents(),i=0;i<e.length;i++)this.remove(e[i],t);return!0},isEmpty:function(){return!this._eventTriggers||this._eventTriggers.length<=0},addArmatureMovementCallBack:function(t,e,i){if(null!=t&&null!=i&&null!=e){for(var n,s=!1,r=0;r<this._movementDispatches.length;r++)(n=this._movementDispatches[r])&&n[0]===t&&(n.addAnimationEventCallBack(e,i),s=!0);s||(n=new ccs.ArmatureMovementDispatcher,t.getAnimation().setMovementEventCallFunc(n.animationEvent,n),n.addAnimationEventCallBack(e,i),this._movementDispatches.push([t,n]))}},removeArmatureMovementCallBack:function(t,e,i){if(null!=t&&null!=e&&null!=i)for(var n,s=0;s<this._movementDispatches.length;s++)(n=this._movementDispatches[s])&&n[0]===t&&n.removeAnimationEventCallBack(i,e)},removeArmatureAllMovementCallBack:function(t){if(null!=t)for(var e,i=0;i<this._movementDispatches.length;i++)if((e=this._movementDispatches[i])&&e[0]===t){this._movementDispatches.splice(i,1);break}},removeAllArmatureMovementCallBack:function(){this._movementDispatches.length=0},version:function(){return"1.2.0.0"}},ccs.ArmatureMovementDispatcher=ccs.Class.extend({_mapEventAnimation:null,ctor:function(){this._mapEventAnimation=[]},animationEvent:function(t,e,i){for(var n,s,r=0;r<this._mapEventAnimation.length;r++)s=(n=this._mapEventAnimation[r])[0],(n=n[1])&&n.call(s,t,e,i)},addAnimationEventCallBack:function(t,e){this._mapEventAnimation.push([e,t])},removeAnimationEventCallBack:function(t,e){for(var i=0;i<this._mapEventAnimation.length;i++)this._mapEventAnimation[i][0]===e&&this._mapEventAnimation.splice(i,1)}}),ccs.BaseTriggerCondition=ccs.Class.extend({ctor:function(){},init:function(){return!0},detect:function(){return!0},serialize:function(t){},removeAll:function(){}}),ccs.BaseTriggerAction=ccs.Class.extend({ctor:function(){},init:function(){return!0},done:function(){},serialize:function(t){},removeAll:function(){}}),ccs.TriggerObj=ccs.Class.extend({_cons:null,_acts:null,_id:0,_enable:!0,_vInt:null,ctor:function(){this._id=0,this._enable=!0,ccs.TriggerObj.prototype.init.call(this)},init:function(){return this._cons=[],this._acts=[],this._vInt=[],!0},detect:function(){if(!this._enable||0===this._cons.length)return!0;for(var t=!0,e=null,i=0;i<this._cons.length;i++)(e=this._cons[i])&&e.detect&&(t=t&&e.detect());return t},done:function(){if(this._enable&&0!==this._acts.length)for(var t,e=0;e<this._acts.length;e++)(t=this._acts[e])&&t.done&&t.done()},removeAll:function(){for(var t=null,e=0;e<this._cons.length;e++)(t=this._cons[e])&&t.removeAll();for(this._cons=[],e=0;e<this._acts.length;e++)(t=this._acts[e])&&t.removeAll();this._acts=[]},serialize:function(t){this._id=t.id||0;for(var e=t.conditions||[],i=0;i<e.length;i++){var n=e[i],s=n.classname,r=ccs.objectFactory.createObject(s);r?(r.serialize(n),r.init(),this._cons.push(r)):cc.log("class named classname("+s+") can not implement!")}for(e=t.actions||[],i=0;i<e.length;i++)s=(n=e[i]).classname,(r=ccs.objectFactory.createObject(s))?(r.serialize(n),r.init(),this._acts.push(r)):cc.log("class named classname("+s+") can not implement!");for(t=t.events||[],i=0;i<t.length;i++)(n=(n=t[i]).id)<0||this._vInt.push(n)},getId:function(){return this._id},setEnable:function(t){this._enable=t},getEvents:function(){return this._vInt}}),ccs.TriggerObj.create=function(){return new ccs.TriggerObj},ccs.ActionTimelineData=ccs.Class.extend({_actionTag:0,ctor:function(t){this._init(t)},_init:function(t){return this._actionTag=t,!0},setActionTag:function(t){this._actionTag=t},getActionTag:function(){return this._actionTag}}),ccs.AnimationInfo=function(t,e,i){this.name=t,this.startIndex=e,this.endIndex=i},ccs.ComExtensionData=ccs.Component.extend({_customProperty:null,_timelineData:null,_name:"ComExtensionData",ctor:function(){return this._customProperty="",this._timelineData=new ccs.ActionTimelineData(0),!0},setActionTag:function(t){this._timelineData.setActionTag(t)},getActionTag:function(){return this._timelineData.getActionTag()},setCustomProperty:function(t){this._customProperty=t},getCustomProperty:function(){return this._customProperty}}),ccs.ComExtensionData.create=function(){return new ccs.ComExtensionData},ccs.ActionTimelineData.create=function(t){return new ccs.ActionTimelineData(t)},ccs.ActionTimeline=cc.Action.extend({_timelineMap:null,_timelineList:null,_duration:0,_time:null,_timeSpeed:1,_frameInternal:1/60,_playing:!1,_currentFrame:0,_startFrame:0,_endFrame:0,_loop:null,_frameEventListener:null,_animationInfos:null,_lastFrameListener:null,ctor:function(){cc.Action.prototype.ctor.call(this),this._timelineMap={},this._timelineList=[],this._animationInfos={},this.init()},_gotoFrame:function(t){for(var e=this._timelineList.length,i=0;i<e;i++)this._timelineList[i]._gotoFrame(t)},_stepToFrame:function(t){for(var e=this._timelineList.length,i=0;i<e;i++)this._timelineList[i]._stepToFrame(t)},_emitFrameEvent:function(t){this._frameEventListener&&this._frameEventListener(t)},init:function(){return!0},gotoFrameAndPlay:function(t,e,i,n){for(var s,r=0,o=arguments.length,a=[];r<o;r++)"boolean"==typeof arguments[r]?s=arguments[r]:a.push(arguments[r]);t=a[0],e=void 0!==a[1]?a[1]:this._duration,i=a[2]||t,this._startFrame=t,this._endFrame=e,this._currentFrame=i,this._loop=null==s||s,this._time=this._currentFrame*this._frameInternal,this.resume(),this._gotoFrame(this._currentFrame)},gotoFrameAndPause:function(t){this._startFrame=this._currentFrame=t,this._time=this._currentFrame*this._frameInternal,this.pause(),this._gotoFrame(this._currentFrame)},pause:function(){this._playing=!1},resume:function(){this._playing=!0},isPlaying:function(){return this._playing},setTimeSpeed:function(t){this._timeSpeed=t},getTimeSpeed:function(){return this._timeSpeed},setDuration:function(t){this._duration=t},getDuration:function(){return this._duration},getStartFrame:function(){return this._startFrame},getEndFrame:function(){return this._endFrame},setCurrentFrame:function(t){t>=this._startFrame&&t<=this._endFrame?(this._currentFrame=t,this._time=this._currentFrame*this._frameInternal):cc.log("frame index is not between start frame and end frame")},getCurrentFrame:function(){return this._currentFrame},addTimeline:function(t){var e=t.getActionTag();this._timelineMap[e]||(this._timelineMap[e]=[]),-1===this._timelineMap[e].indexOf(t)&&(this._timelineList.push(t),this._timelineMap[e].push(t),t.setActionTimeline(this))},removeTimeline:function(e){var t=e.getActionTag();this._timelineMap[t]&&this._timelineMap[t].some(function(t){if(t===e)return!0})&&(cc.arrayRemoveObject(this._timelineMap[t],e),cc.arrayRemoveObject(this._timelineList,e),e.setActionTimeline(null))},getTimelines:function(){return this._timelineList},setFrameEventCallFunc:function(t){this._frameEventListener=t},clearFrameEventCallFunc:function(){this._frameEventListener=null},clone:function(){var t,e=new ccs.ActionTimeline;for(t in e.setDuration(this._duration),e.setTimeSpeed(this._timeSpeed),this._timelineMap){var i,n=this._timelineMap[t];for(i in n){var s=n[i].clone();e.addTimeline(s)}}return e},reverse:function(){return null},step:function(t){this._playing&&0!==this._timelineMap.length&&0!==this._duration&&(this._time+=t*this._timeSpeed,(t=this._time-this._endFrame*this._frameInternal)<this._frameInternal?(this._currentFrame=Math.floor(this._time/this._frameInternal),this._stepToFrame(this._currentFrame),0<=t&&this._lastFrameListener&&this._lastFrameListener()):(this._playing=this._loop)?this.gotoFrameAndPlay(this._startFrame,this._endFrame,this._loop):(this._time=this._endFrame*this._frameInternal,this._currentFrame!=this._endFrame&&(this._currentFrame=this._endFrame,this._stepToFrame(this._currentFrame),this._lastFrameListener)&&this._lastFrameListener()))},_foreachNodeDescendant:function(t,e){e(t);for(var i=t.getChildren(),n=0;n<i.length;n++)this._foreachNodeDescendant(i[n],e)},startWithTarget:function(t){cc.Action.prototype.startWithTarget.call(this,t);var n=this;this._foreachNodeDescendant(t,function(t){if((e=t.getComponent("ComExtensionData"))&&(e=e.getActionTag(),n._timelineMap[e]))for(var e=n._timelineMap[e],i=0;i<e.length;i++)e[i].setNode(t)})},isDone:function(){return!1},play:function(t,e){var i=this._animationInfos[t];if(!i)return cc.log("Can't find animation info for %s",t);this.gotoFrameAndPlay(i.startIndex,i.endIndex,e)},addAnimationInfo:function(t){this._animationInfos[t.name]=t},removeAnimationInfo:function(t){delete this._animationInfos[t]},isAnimationInfoExists:function(t){return this._animationInfos[t]},getAnimationInfo:function(t){return this._animationInfos[t]},setLastFrameCallFunc:function(t){this._lastFrameListener=t},clearLastFrameCallFunc:function(){this._lastFrameListener=null}}),ccs.ActionTimeline.create=function(){return new ccs.ActionTimeline},ccs.Frame=ccs.Class.extend({_frameIndex:null,_tween:null,_timeline:null,_node:null,_tweenType:null,_easingParam:null,_enterWhenPassed:null,ctor:function(){this._frameIndex=0,this._tween=!0,this._node=this._timeline=null,this._enterWhenPassed=!1,this._easingParam=[]},_emitEvent:function(){this._timeline&&this._timeline.getActionTimeline()._emitFrameEvent(this)},_cloneProperty:function(t){this._frameIndex=t.getFrameIndex(),this._tween=t.isTween(),this._tweenType=t.getTweenType(),this.setEasingParams(t.getEasingParams())},setFrameIndex:function(t){this._frameIndex=t},getFrameIndex:function(){return this._frameIndex},setTimeline:function(t){this._timeline=t},getTimeline:function(t){return this._timeline},setNode:function(t){this._node=t},getNode:function(){return this._node},setTween:function(t){this._tween=t},isTween:function(){return this._tween},onEnter:function(t){},apply:function(t){this._tween&&(this._tweenType!==ccs.FrameEaseType.TWEEN_EASING_MAX&&this._tweenType!==ccs.FrameEaseType.LINEAR&&(t=this.tweenPercent(t)),this._onApply(t))},_onApply:function(t){},clone:function(){},tweenPercent:function(t){var e=ccs.Frame.tweenToMap[this._tweenType];return e?e(t,this._easingParam):t},setEasingParams:function(t){if(t)for(var e=this._easingParam.length=0;e<t.length;e++)this._easingParam[e]=t[e]},getEasingParams:function(){return this._easingParam},setTweenType:function(t){this._tweenType=t},getTweenType:function(){return this._tweenType},isEnterWhenPassed:function(){return this._enterWhenPassed}}),ccs.Frame.tweenToMap={"-1":function(t,e){var i;return e?e[1]*(i=1-t)*i*i+3*e[3]*t*i*i+3*e[5]*t*t*i+e[7]*t*t*t:t},1:cc._easeSineInObj.easing,2:cc._easeSineOutObj.easing,3:cc._easeSineInOutObj.easing,4:cc._easeQuadraticActionIn.easing,5:cc._easeQuadraticActionOut.easing,6:cc._easeQuadraticActionInOut.easing,7:cc._easeCubicActionIn.easing,8:cc._easeCubicActionOut.easing,9:cc._easeCubicActionInOut.easing,10:cc._easeCubicActionIn.easing,11:cc._easeCubicActionOut.easing,12:cc._easeCubicActionInOut.easing,13:cc._easeQuinticActionIn.easing,14:cc._easeQuinticActionOut.easing,15:cc._easeQuinticActionInOut.easing,16:cc._easeExponentialInObj.easing,17:cc._easeExponentialOutObj.easing,18:cc._easeExponentialInOutObj.easing,19:cc._easeCircleActionIn.easing,20:cc._easeCircleActionOut.easing,21:cc._easeCircleActionInOut.easing,22:function(t,e){var i=.3;return null!=e&&(i=e[0]),cc.easeElasticIn(i).easing(t)},23:function(t,e){var i=.3;return null!=e&&(i=e[0]),cc.easeElasticOut(i).easing(t)},24:function(t,e){var i=.3;return null!=e&&(i=e[0]),cc.easeElasticInOut(i).easing(t)},25:cc._easeBackInObj.easing,26:cc._easeBackOutObj.easing,27:cc._easeBackInOutObj.easing,28:cc._easeBounceInObj.easing,29:cc._easeBounceOutObj.easing,30:cc._easeBounceInOutObj.easing},ccs.VisibleFrame=ccs.Frame.extend({_visible:!0,ctor:function(){ccs.Frame.prototype.ctor.call(this),this._visible=!0},onEnter:function(t){this._node&&this._node.setVisible(this._visible)},clone:function(){var t=new ccs.VisibleFrame;return t.setVisible(this._visible),t._cloneProperty(this),t},setVisible:function(t){this._visible=t},isVisible:function(){return this._visible}}),ccs.VisibleFrame.create=function(){return new ccs.VisibleFrame},ccs.TextureFrame=ccs.Frame.extend({_sprite:null,_textureName:null,ctor:function(){ccs.Frame.prototype.ctor.call(this),this._textureName=""},setNode:function(t){ccs.Frame.prototype.setNode.call(this,t),this._sprite=t},onEnter:function(t){var e;this._sprite&&(t=this._sprite.getBlendFunc(),null!=(e=cc.spriteFrameCache._spriteFrames[this._textureName])?this._sprite.setSpriteFrame(e):this._sprite.setTexture(this._textureName),this._sprite.getBlendFunc()!==t)&&this._sprite.setBlendFunc(t)},clone:function(){var t=new ccs.TextureFrame;return t.setTextureName(this._textureName),t._cloneProperty(this),t},setTextureName:function(t){this._textureName=t},getTextureName:function(){return this._textureName}}),ccs.TextureFrame.create=function(){return new ccs.TextureFrame},ccs.RotationFrame=ccs.Frame.extend({_rotation:null,_betwennRotation:null,ctor:function(){ccs.Frame.prototype.ctor.call(this),this._rotation=0},onEnter:function(t){this._node&&(this._node.setRotation(this._rotation),this._tween)&&(this._betwennRotation=t._rotation-this._rotation)},_onApply:function(t){0!==this._betwennRotation&&this._node.setRotation(this._rotation+t*this._betwennRotation)},clone:function(){var t=new ccs.RotationFrame;return t.setRotation(this._rotation),t._cloneProperty(this),t},setRotation:function(t){this._rotation=t},getRotation:function(){return this._rotation}}),ccs.RotationFrame.create=function(){return new ccs.RotationFrame},ccs.SkewFrame=ccs.Frame.extend({_skewX:null,_skewY:null,_betweenSkewX:null,_betweenSkewY:null,ctor:function(){ccs.Frame.prototype.ctor.call(this),this._skewY=this._skewX=0},onEnter:function(t){this._node&&(this._node.setSkewX(this._skewX),this._node.setSkewY(this._skewY),this._tween)&&(this._betweenSkewX=t._skewX-this._skewX,this._betweenSkewY=t._skewY-this._skewY)},_onApply:function(t){var e;0===this._betweenSkewX&&0===this._betweenSkewY||(e=this._skewY+t*this._betweenSkewY,this._node.setSkewX(this._skewX+t*this._betweenSkewX),this._node.setSkewY(e))},clone:function(){var t=new ccs.SkewFrame;return t.setSkewX(this._skewX),t.setSkewY(this._skewY),t._cloneProperty(this),t},setSkewX:function(t){this._skewX=t},getSkewX:function(){return this._skewX},setSkewY:function(t){this._skewY=t},getSkewY:function(){return this._skewY}}),ccs.SkewFrame.create=function(){return new ccs.SkewFrame},ccs.RotationSkewFrame=ccs.SkewFrame.extend({onEnter:function(t){this._node&&(this._node.setRotationX(this._skewX),this._node.setRotationY(this._skewY),this._tween)&&(this._betweenSkewX=t._skewX-this._skewX,this._betweenSkewY=t._skewY-this._skewY)},_onApply:function(t){var e;!this._node||0===this._betweenSkewX&&0===this._betweenSkewY||(e=this._skewY+t*this._betweenSkewY,this._node.setRotationX(this._skewX+t*this._betweenSkewX),this._node.setRotationY(e))},clone:function(){var t=new ccs.RotationSkewFrame;return t.setSkewX(this._skewX),t.setSkewY(this._skewY),t._cloneProperty(this),t}}),ccs.RotationSkewFrame.create=function(){return new ccs.RotationSkewFrame},ccs.PositionFrame=ccs.Frame.extend({_position:null,_betweenX:null,_betweenY:null,ctor:function(){ccs.Frame.prototype.ctor.call(this),this._position=cc.p(0,0)},onEnter:function(t){this._node&&(this._node.setPosition(this._position),this._tween)&&(this._betweenX=t._position.x-this._position.x,this._betweenY=t._position.y-this._position.y)},_onApply:function(t){var e;!this._node||0===this._betweenX&&0===this._betweenY||((e=cc.p(0,0)).x=this._position.x+this._betweenX*t,e.y=this._position.y+this._betweenY*t,this._node.setPosition(e))},clone:function(){var t=new ccs.PositionFrame;return t.setPosition(this._position),t._cloneProperty(this),t},setPosition:function(t){this._position=t},getPosition:function(){return this._position},setX:function(t){this._position.x=t},getX:function(){return this._position.x},setY:function(t){this._position.y=t},getY:function(){return this._position.y}}),ccs.PositionFrame.create=function(){return new ccs.PositionFrame},ccs.ScaleFrame=ccs.Frame.extend({_scaleX:null,_scaleY:null,_betweenScaleX:null,_betweenScaleY:null,ctor:function(){ccs.Frame.prototype.ctor.call(this),this._scaleY=this._scaleX=1},onEnter:function(t){this._node&&(this._node.setScaleX(this._scaleX),this._node.setScaleY(this._scaleY),this._tween)&&(this._betweenScaleX=t._scaleX-this._scaleX,this._betweenScaleY=t._scaleY-this._scaleY)},_onApply:function(t){var e;!this._node||0===this._betweenScaleX&&0===this._betweenScaleY||(e=this._scaleY+this._betweenScaleY*t,this._node.setScaleX(this._scaleX+this._betweenScaleX*t),this._node.setScaleY(e))},clone:function(){var t=new ccs.ScaleFrame;return t.setScaleX(this._scaleX),t.setScaleY(this._scaleY),t._cloneProperty(this),t},setScale:function(t){this._scaleY=this._scaleX=t},setScaleX:function(t){this._scaleX=t},getScaleX:function(){return this._scaleX},setScaleY:function(t){this._scaleY=t},getScaleY:function(){return this._scaleY}}),ccs.ScaleFrame.create=function(){return new ccs.ScaleFrame},ccs.AnchorPointFrame=ccs.Frame.extend({_anchorPoint:null,ctor:function(){ccs.Frame.prototype.ctor.call(this),this._anchorPoint=cc.p(0,0)},onEnter:function(t){this._node&&this._node.setAnchorPoint(this._anchorPoint)},clone:function(){var t=new ccs.AnchorPointFrame;return t.setAnchorPoint(this._anchorPoint),t._cloneProperty(this),t},setAnchorPoint:function(t){this._anchorPoint=t},getAnchorPoint:function(){return this._anchorPoint}}),ccs.AnchorPointFrame.create=function(){return new ccs.AnchorPointFrame},ccs.InnerActionType={LoopAction:0,NoLoopAction:1,SingleFrame:2},ccs.InnerActionFrame=ccs.Frame.extend({_innerActionType:null,_startFrameIndex:null,_endFrameIndex:0,_singleFrameIndex:0,_enterWithName:null,_animationName:"",ctor:function(){ccs.Frame.prototype.ctor.call(this),this._enterWithName=!1,this._innerActionType=ccs.InnerActionType.LoopAction,this._startFrameIndex=0},onEnter:function(t){var e,i,n;this._node&&(t=this._node.getActionByTag(this._node.getTag()))&&(ccs.InnerActionType.SingleFrame===this._innerActionType?t.gotoFrameAndPause(this._singleFrameIndex):(e=this._startFrameIndex,i=this._endFrameIndex,this._enterWithName&&("-- ALL --"===this._animationName?(e=0,i=t.getDuration()):t.isAnimationInfoExists(this._animationName)?(e=(i=t.getAnimationInfo(this._animationName)).startIndex,i=i.endIndex):cc.log("Animation %s not exists!",this._animationName)),(n=this._timeline.getActionTimeline().getDuration()-this._frameIndex-i+e)<0&&(i+=n),ccs.InnerActionType.NoLoopAction===this._innerActionType?t.gotoFrameAndPlay(e,i,!1):ccs.InnerActionType.LoopAction===this._innerActionType&&t.gotoFrameAndPlay(e,i,!0)))},setAnimationName:function(t){this._animationName=t},setSingleFrameIndex:function(t){this._singleFrameIndex=t},getSingleFrameIndex:function(){return this._startFrameIndex},setEnterWithName:function(t){this._enterWithName=t},getEnterWithName:function(){return this._enterWithName},clone:function(){var t=new ccs.InnerActionFrame;return t.setInnerActionType(this._innerActionType),t.setStartFrameIndex(this._startFrameIndex),t.setEnterWithName(this._enterWithName),t.setAnimationName(this._animationName),t.setSingleFrameIndex(this._singleFrameIndex),t._cloneProperty(this),t},setInnerActionType:function(t){this._innerActionType=t},getInnerActionType:function(){return this._innerActionType},setStartFrameIndex:function(t){this._startFrameIndex=t},getStartFrameIndex:function(){return this._startFrameIndex}}),ccs.InnerActionFrame.create=function(){return new ccs.InnerActionFrame},ccs.ColorFrame=ccs.Frame.extend({_alpha:null,_color:null,_betweenAlpha:null,_betweenRed:null,_betweenGreen:null,_betweenBlue:null,ctor:function(){ccs.Frame.prototype.ctor.call(this),this._color=cc.color(255,255,255)},onEnter:function(t){this._node&&(this._node.setColor(this._color),this._tween)&&(t=t._color,this._betweenRed=t.r-this._color.r,this._betweenGreen=t.g-this._color.g,this._betweenBlue=t.b-this._color.b)},_onApply:function(t){var e;this._node&&this._tween&&(0!==this._betweenAlpha||0!==this._betweenRed||0!==this._betweenGreen||0!==this._betweenBlue)&&((e=cc.color(255,255,255)).r=this._color.r+this._betweenRed*t,e.g=this._color.g+this._betweenGreen*t,e.b=this._color.b+this._betweenBlue*t,this._node.setColor(e),null!==this._alpha)&&this._node.setOpacity(this._alpha+this._betweenAlpha*t)},clone:function(){var t=new ccs.ColorFrame;return t.setColor(this._color),t._cloneProperty(this),t},setColor:function(t){this._color=t},getColor:function(){return this._color}}),ccs.ColorFrame.create=function(){return new ccs.ColorFrame},ccs.AlphaFrame=ccs.Frame.extend({_alpha:null,_betweenAlpha:null,ctor:function(){ccs.Frame.prototype.ctor.call(this),this._alpha=255},onEnter:function(t){this._node&&(this._node.setOpacity(this._alpha),this._tween)&&(this._betweenAlpha=t._alpha-this._alpha)},_onApply:function(t){this._node&&this._node.setOpacity(this._alpha+this._betweenAlpha*t)},setAlpha:function(t){this._alpha=t},getAlpha:function(){return this._alpha},clone:function(){var t=new ccs.AlphaFrame;return t.setAlpha(this._alpha),t._cloneProperty(this),t}}),ccs.EventFrame=ccs.Frame.extend({_event:null,ctor:function(){ccs.Frame.prototype.ctor.call(this),this._event="",this._enterWhenPassed=!0},onEnter:function(t){this._emitEvent()},clone:function(){var t=new ccs.EventFrame;return t.setEvent(this._event),t._cloneProperty(this),t},setEvent:function(t){this._event=t},getEvent:function(){return this._event}}),ccs.EventFrame.create=function(){return new ccs.EventFrame},ccs.ZOrderFrame=ccs.Frame.extend({_zorder:0,onEnter:function(t){this._node&&this._node.setLocalZOrder(this._zorder)},clone:function(){var t=new ccs.ZOrderFrame;return t.setZOrder(this._zorder),t._cloneProperty(this),t},setZOrder:function(t){this._zorder=t},getZOrder:function(){return this._zorder}}),ccs.ZOrderFrame.create=function(){return new ccs.ZOrderFrame},ccs.BlendFuncFrame=ccs.Frame.extend({ctor:function(){this._super(),this._blendFunc=null},onEnter:function(t,e){this._node&&this._blendFunc&&this._node.setBlendFunc(this._blendFunc)},clone:function(){var t=new ccs.BlendFuncFrame;return t.setBlendFunc(this._blendFunc),t._cloneProperty(this),t},setBlendFunc:function(t){t&&t.src&&t.dst&&(this._blendFunc=t)},getBlendFunc:function(){return this._blendFunc}}),ccs.BlendFuncFrame.create=function(){return new ccs.BlendFuncFrame},ccs.Timeline=ccs.Class.extend({_frames:null,_currentKeyFrame:null,_currentKeyFrameIndex:null,_fromIndex:null,_toIndex:null,_betweenDuration:null,_actionTag:null,_ActionTimeline:null,_node:null,ctor:function(){this._frames=[],this._currentKeyFrame=null,this._actionTag=this._betweenDuration=this._toIndex=this._fromIndex=this._currentKeyFrameIndex=0,this._node=this._ActionTimeline=null},_gotoFrame:function(t){0!==this._frames.length&&(this._binarySearchKeyFrame(t),this._apply(t))},_stepToFrame:function(t){0!==this._frames.length&&(this._updateCurrentKeyFrame(t),this._apply(t))},getFrames:function(){return this._frames},addFrame:function(t){this._frames.push(t),t.setTimeline(this)},insertFrame:function(t,e){this._frames.splice(e,0,t),t.setTimeline(this)},removeFrame:function(t){cc.arrayRemoveObject(this._frames,t),t.setTimeline(null)},setActionTag:function(t){this._actionTag=t},getActionTag:function(){return this._actionTag},setNode:function(t){for(var e=0;e<this._frames.length;e++)this._frames[e].setNode(t)},getNode:function(){return this._node},setActionTimeline:function(t){this._ActionTimeline=t},getActionTimeline:function(){return this._ActionTimeline},clone:function(){var t=new ccs.Timeline;t._actionTag=this._actionTag;for(var e=0;e<this._frames.length;e++){var i=this._frames[e].clone();t.addFrame(i)}return t},_apply:function(t){this._currentKeyFrame&&this._currentKeyFrame.apply(this._betweenDuration<=0?0:(t-this._currentKeyFrameIndex)/this._betweenDuration)},_binarySearchKeyFrame:function(t){var e=null,i=null,n=this._frames.length,s=!1;if(t<this._frames[0].getFrameIndex())this._currentKeyFrameIndex>=this._frames[0].getFrameIndex()&&(s=!0),this._toIndex=this._fromIndex=0,e=i=this._frames[0],this._currentKeyFrameIndex=0,this._betweenDuration=this._frames[0].getFrameIndex();else if(t>=this._frames[n-1].getFrameIndex())this._fromIndex=n-1,this._toIndex=0,e=i=this._frames[n-1],this._currentKeyFrameIndex=this._frames[n-1].getFrameIndex(),this._betweenDuration=0;else{for(var r,o=-1,e=0,i=n-1;e<=i;){if(r=Math.ceil((e+i)/2),t>=this._frames[r].getFrameIndex()&&t<this._frames[r+1].getFrameIndex()){o=r;break}this._frames[r].getFrameIndex()>t?i=r-1:e=r+1}this._fromIndex=o,this._toIndex=1<n?o+1|0:0|o,e=this._frames[o],i=this._frames[o+1],0===o&&this._currentKeyFrameIndex<e.getFrameIndex()&&(s=!0),this._currentKeyFrameIndex=e.getFrameIndex(),this._betweenDuration=i.getFrameIndex()-e.getFrameIndex()}!s&&this._currentKeyFrame==e||(this._currentKeyFrame=e,this._currentKeyFrame.onEnter(i))},_updateCurrentKeyFrame:function(t){if(t<this._currentKeyFrameIndex||t>=this._currentKeyFrameIndex+this._betweenDuration){var e=null,i=null,n=this._frames.length;if(t<this._frames[0].getFrameIndex())e=i=this._frames[0],this._currentKeyFrameIndex=0,this._betweenDuration=this._frames[0].getFrameIndex();else{if(t>=this._frames[n-1].getFrameIndex()&&(t=this._frames[n-1].getFrameIndex(),this._currentKeyFrameIndex>=t))return;for(;;){if(this._fromIndex=this._toIndex,e=this._frames[this._fromIndex],this._currentKeyFrameIndex=e.getFrameIndex(),this._toIndex=this._fromIndex+1,this._toIndex>=n&&(this._toIndex=0),i=this._frames[this._toIndex],t===e.getFrameIndex())break;if(t>e.getFrameIndex()&&t<i.getFrameIndex())break;e.isEnterWhenPassed()&&e.onEnter(i)}this._betweenDuration=i.getFrameIndex()-e.getFrameIndex()}this._currentKeyFrame=e,this._currentKeyFrame.onEnter(i)}}}),ccs.Timeline.create=function(){return new ccs.Timeline},ccs.SkinNode=function(){var t=cc.Node.extend({});return t.create=function(){},t}(),ccs.BoneNode=function(){var t,s=cc.Node,r=ccs.SkinNode,e=cc.BlendFunc,l={p:cc.p,size:cc.size,rect:cc.rect},o={log:cc.log,assert:cc.assert},i=s.extend({_customCommand:null,_blendFunc:null,_rackColor:null,_rackLength:null,_rackWidth:null,_childBones:null,_boneSkins:null,_rootSkeleton:null,_squareVertices:null,_squareColors:null,_noMVPVertices:null,ctor:function(t){s.prototype.ctor.call(this),null===this._squareVertices&&(this._squareVertices=[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}]),this._rackColor=cc.color.WHITE,this._blendFunc=e.ALPHA_NON_PREMULTIPLIED,this._childBones=[],this._boneSkins=[],this._rackLength=void 0===t?50:t,this._rackWidth=20,this._updateVertices()},visit:function(t){this._visit&&this._visit(t&&t._renderCmd)},addSkin:function(t,e,i){var n=this._boneSkins;if(o.assert(null!=t,"Argument must be non-nil"),i)for(i=0;i<n.length;i++)n[i].setVisible(!1);s.prototype.addChild.call(this,t),this._boneSkins.push(t),t.setVisible(e)},getChildBones:function(){return this._childBones},getSkins:function(){return this._boneSkins},displaySkin:function(t,e){var i,n,s=this._boneSkins;if("string"==typeof t)for(n=0;n<s.length;n++)t==(i=s[n]).getName()?i.setVisible(!0):e&&i.setVisible(!1);else for(n=0;n<s.length;n++)(i=s[n])==t?i.setVisible(!0):e&&i.setVisible(!1)},getVisibleSkins:function(){for(var t,e=[],i=this._boneSkins,n=0;n<i.length;n++)(t=i[n]).isVisible()&&e.push(t);return e},getRootSkeletonNode:function(){return this._rootSkeleton},getAllSubBones:function(){for(var t=[],e=[],i=this._childBones,n=0;n<i.length;n++)e.push(i[n]);for(;0<e.length;)for(i=e.pop(),t.push(i),i=i.getChildBones(),n=0;n<i;n++)e.push(i[n]);return t},getAllSubSkins:function(){for(var t=this.getAllSubBones(),e=[],i=0;i<t.length;i++)for(var n=t[i].getSkins(),s=0;s<n.length;s++)e.push(n[i]);return e},addChild:function(t,e,i){s.prototype.addChild.call(this,t,e,i),this._addToChildrenListHelper(t)},removeChild:function(t,e){-1!==this._children.indexOf(t)&&(s.prototype.removeChild.call(this,t,e),this._removeFromChildrenListHelper(t))},setBlendFunc:function(t){var e=this._blendFunc;if(t&&e.src!==t.src&&e.dst!==t.dst){this._blendFunc=t;for(var e=this._boneSkins,i=0;i<e.length;i++)e[i].setBlendFunc(t)}},getBlendFunc:function(){return this._blendFunc},setDebugDrawLength:function(t){this._rackLength=t,this._updateVertices()},getDebugDrawLength:function(){return this._rackLength},setDebugDrawWidth:function(t){this._rackWidth=t,this._updateVertices()},getDebugDrawWidth:function(){return this._rackWidth},setDebugDrawEnabled:function(t){var e=this._renderCmd;e._debug!==t&&(e._debug=t,cc.renderer.childrenOrderDirty=!0,this._visible)&&null!=this._rootSkeleton&&(this._rootSkeleton._subBonesDirty=!0,this._rootSkeleton._subBonesOrderDirty=!0)},isDebugDrawEnabled:function(){return this._renderCmd._debug},setDebugDrawColor:function(t){this._rackColor=t},getDebugDrawColor:function(){return this._rackColor},getVisibleSkinsRect:function(){var t,e,i=0,n=t=e=i,s=!0,r=l.rect(0,0,0,0);this._renderCmd._debug&&null!=this._rootSkeleton&&this._rootSkeleton._renderCmd._debug&&(e=this._rackWidth,i=this._rackLength,s=!1);for(var o=this._boneSkins,a=0;a<o.length;a++){var c,h=(c=o[a]).getBoundingBox();!c.isVisible()||0===h.x&&0===h.y&&0===h.width&&0===h.height||(s?(n=cc.rectGetMinX(h),t=cc.rectGetMinY(h),e=cc.rectGetMaxX(h),i=cc.rectGetMaxY(h),s=!1):(n=Math.min(cc.rectGetMinX(h),n),t=Math.min(cc.rectGetMinY(h),t),e=Math.max(cc.rectGetMaxX(h),e),i=Math.max(cc.rectGetMaxY(h),i)),r.setRect(n,t,e-n,i-t))}return r},getBoundingBox:function(){var t=this.getVisibleSkinsRect();return cc.rectApplyAffineTransform(t,this.getNodeToParentAffineTransform())},batchBoneDrawToSkeleton:function(t){},setLocalZOrder:function(t){s.prototype.setLocalZOrder.call(this,t),null!=this._rootSkeleton&&(this._rootSkeleton._subBonesOrderDirty=!0)},setName:function(t){var e,i=this._rootSkeleton,n=this.getName();s.prototype.setName.call(this,t),null!=i&&(n=i._subBonesMap[n],e=i._subBonesMap[t],n)&&!e&&(delete i._subBonesMap[n],i._subBonesMap[t]=n)},setContentSize:function(t){s.prototype.setContentSize.call(this,t),this._updateVertices()},setAnchorPoint:function(t){s.prototype.setAnchorPoint.call(this,t),this._updateVertices()},setVisible:function(t){this._visible!=t&&(s.prototype.setVisible.call(this,t),null!=this._rootSkeleton)&&(this._rootSkeleton._subBonesDirty=!0,this._rootSkeleton._subBonesOrderDirty=!0)},_addToChildrenListHelper:function(t){t instanceof i?this._addToBoneList(t):this._addToSkinList(t)},_removeFromChildrenListHelper:function(t){t instanceof i?this._removeFromBoneList(t):t instanceof r&&this._removeFromSkinList(skin)},_removeFromBoneList:function(t){if(null!=this._rootSkeleton&&t instanceof ccs.SkeletonNode&&t._rootSkeleton===this._rootSkeleton){t._rootSkeleton=null;var e=t.getAllSubBones();e.push(t);for(var i,n=0;n<e.length;n++)(i=e[n])._rootSkeleton=null,delete this._rootSkeleton._subBonesMap[i.getName()],this._rootSkeleton._subBonesDirty=!0,this._rootSkeleton._subBonesOrderDirty=!0}else this._rootSkeleton._subBonesDirty=!0,this._rootSkeleton._subBonesOrderDirty=!0;cc.arrayRemoveObject(this._childBones,t)},_setRootSkeleton:function(t){this._rootSkeleton=t,t=this.getAllSubBones();for(var e=0;e<t.length;e++)this._addToBoneList(t[e])},_addToBoneList:function(t){if(-1===this._childBones.indexOf(t)&&this._childBones.push(t),null!=this._rootSkeleton&&!(t instanceof r||t._rootSkeleton)){var e=t.getAllSubBones();e.push(t);for(var i=0;i<e.length;i++){(t=e[i])._setRootSkeleton(this._rootSkeleton);var n=t.getName();this._rootSkeleton._subBonesMap[n]?cc.log("already has a bone named %s in skeleton %s",n,this._rootSkeleton.getName()):this._rootSkeleton._subBonesMap[t.getName()]=t,this._rootSkeleton._subBonesDirty=!0,this._rootSkeleton._subBonesOrderDirty=!0}}},_visitSkins:function(){var t=this._renderCmd;if(this._visible){var e,i=t.getParentRenderCmd(),n=(i&&(t._curLevel=i._curLevel+1),this._boneSkins),s=(t._syncStatus(i),n.length);if(0<s){for(this.sortAllChildren(),i=0;i<s&&(e=n[i])._localZOrder<0;i++)e.visit(this);for(;i<s;i++)n[i].visit(this)}t._dirtyFlag=0}},_addToSkinList:function(t){var e;this._boneSkins.push(t),t.getBlendFunc&&(e=t.getBlendFunc(),this._blendFunc.src!==e.src)&&this._blendFunc.dst!==e.dst&&t.setBlendFunc(this._blendFunc)},_removeFromSkinList:function(t){cc.arrayRemoveObject(this._boneSkins,t)},sortAllChildren:function(){this._sortArray(this._childBones),this._sortArray(this._boneSkins),s.prototype.sortAllChildren.call(this)},_sortArray:function(t){if(t)for(var e,i,n=t.length,s=1;s<n;s++){for(i=t[s],e=s-1;0<=e&&(i._localZOrder<t[e]._localZOrder||i._localZOrder===t[e]._localZOrder&&i.arrivalOrder<t[e].arrivalOrder);)t[e+1]=t[e],e--;t[e+1]=i}},_updateVertices:function(){var t=this._squareVertices,e=this._renderCmd._anchorPointInPoints;if(this._rackLength!=t[2].x-e.x||t[3].y!=this._rackWidth/2-e.y){t[1].x=t[1].y=t[3].y=0,t[0].x=t[2].x=.1*this._rackLength,t[2].y=.5*this._rackWidth,t[0].y=-t[2].y,t[3].x=this._rackLength;for(var i=0;i<t.length;i++)t[i].x+=e.x,t[i].y+=e.y;this._renderCmd.updateDebugPoint(t)}},_createRenderCmd:function(){return new(cc._renderType===cc.game.RENDER_TYPE_CANVAS?n:a)(this)}}),n=(i.create=function(t,e){return new ccui.BoneNode(t,e)},(t=h.prototype=Object.create(s.CanvasRenderCmd.prototype)).constructor=h,t.updateDebugPoint=function(t){this._drawNode.clear(),this._drawNode.drawPoly(t,this._color,0,this._color)},t.transform=function(t,e){var i=this._node._rootSkeleton;this.originTransform(t,e),i&&i._renderCmd._debug&&this._drawNode._renderCmd.transform(this)},h),a=((t=c.prototype=Object.create(s.WebGLRenderCmd.prototype)).constructor=c,t.updateDebugPoint=function(t){this._drawNode.clear(),this._drawNode.drawPoly(t,this._color,0,this._color)},t.transform=function(t,e){var i=this._node._rootSkeleton;this.originTransform(t,e),i&&i._renderCmd._debug&&this._drawNode._renderCmd.transform(this)},c);function c(t){this._rootCtor(t),this._debug=!1,this._color=cc.color.WHITE,this._drawNode=new cc.DrawNode}function h(t){this._rootCtor(t),this._debug=!1,this._color=cc.color.WHITE,this._drawNode=new cc.DrawNode}return i}(),ccs.SkeletonNode=function(){var t=ccs.BoneNode,e=t.extend({_subBonesMap:null,_squareVertices:null,_squareColors:null,_noMVPVertices:null,_skinGroupMap:null,_sortedAllBonesDirty:!1,_sortedAllBones:null,_batchedBoneVetices:null,_batchedBoneColors:null,_batchedVeticesCount:null,_batchBoneCommand:null,_subOrderedAllBones:null,ctor:function(){this._squareVertices=[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}],this._rootSkeleton=this,t.prototype.ctor.call(this),this._subBonesMap={},this._subOrderedAllBones=[],this._skinGroupMap={},this._rackLength=this._rackWidth=20,this._updateVertices()},getBoneNode:function(t){return(t=this._subBonesMap[t])||null},getAllSubBonesMap:function(){return this._subBonesMap},changeSkins:function(t){if("object"==typeof t)for(var e in t){var i=t[e],e=this.getBoneNode(e);null!==e&&e.displaySkin(i,!0)}else(t=this._suitMap[t])&&this.changeSkins(t,!0)},addSkinGroup:function(t,e){this._skinGroupMap[t]=e},getBoundingBox:function(){var t,e,i=0,n=t=e=i,s=this.getVisibleSkinsRect(),r=!0;0===s.x&&0===s.y&&0===s.width&&0===s.height||(n=cc.rectGetMinX(s),t=cc.rectGetMinY(s),e=cc.rectGetMaxX(s),i=cc.rectGetMaxY(s),r=!1);for(var o,a=this.getAllSubBones(),c=0;c<a.length;c++)o=a[c],0===(o=cc.rectApplyAffineTransform(o.getVisibleSkinsRect(),o.getNodeToParentTransform(o.getRootSkeletonNode()))).x&&0===o.y&&0===o.width&&0===o.height||(r?(n=cc.rectGetMinX(o),t=cc.rectGetMinY(o),e=cc.rectGetMaxX(o),i=cc.rectGetMaxY(o),r=!1):(n=Math.min(cc.rectGetMinX(o),n),t=Math.min(cc.rectGetMinY(o),t),e=Math.max(cc.rectGetMaxX(o),e),i=Math.max(cc.rectGetMaxY(o),i)));return s.x=n,s.y=t,s.width=e-n,s.height=i-t,cc.rectApplyAffineTransform(s,this.getNodeToParentTransform())},_visit:function(t){var e,i,n=this._renderCmd;if(t=t||n.getParentRenderCmd(),this._visible){if(n._syncStatus(t),0!==this._children.length)for(t=0;t<this._children.length;t++)(e=this._children[t]).visit(this);for(this._checkSubBonesDirty(),e=this._subOrderedAllBones,t=0;t<e.length;t++)(i=e[t])._visitSkins();if(n._debug)for(t=0;t<e.length;t++)i=e[t]._renderCmd,cc.renderer.pushRenderCommand(i._drawNode._renderCmd);n._dirtyFlag=0}else n._propagateFlagsDown(t)},_checkSubBonesDirty:function(){this._subBonesDirty&&(this._updateOrderedAllbones(),this._subBonesDirty=!1),this._subBonesOrderDirty&&(this._sortOrderedAllBones(),this._subBonesOrderDirty=!1)},_updateOrderedAllbones:function(){this._subOrderedAllBones.length=0;for(var t,e=[],i=this._childBones,n=0;n<i.length;n++)(t=i[n]).isVisible()&&e.push(t);for(;0<e.length;)for((i=(n=e.pop())._renderCmd)._syncStatus(i.getParentRenderCmd()),this._subOrderedAllBones.push(n),i=n.getChildBones(),n=0;n<i.length;n++)(t=i[n]).isVisible()&&e.push(t)},_sortOrderedAllBones:function(){this._sortArray(this._subOrderedAllBones)},_updateVertices:function(){var t=this._squareVertices,e=this._renderCmd._anchorPointInPoints;if(this._rackLength!=t[6].x-e.x||this._rackWidth!=t[3].y-e.y){var i=.5*this._rackLength,n=.5*this._rackWidth,s=.25*i,r=.25*n;for(t[5].y=t[2].y=t[1].y=t[6].y=t[0].x=t[4].x=t[7].x=t[3].x=0,t[5].x=-i,t[0].y=-n,t[6].x=i,t[3].y=n,t[1].x=s,t[7].y=r,t[2].x=-s,t[4].y=-r,i=0;i<t.length;i++)t[i].x+=e.x,t[i].y+=e.y}},_updateAllDrawBones:function(){for(var t in this._subDrawBones={},this._subBonesMap){t=this._subBonesMap[t];t.isVisible()&&t.isDebugDrawEnabled()&&this._subDrawBones.push(t)}this._sortArray(this._sortedAllBones),this._subDrawBones=!1}});return e.create=function(){return new e},e}(),ccs._load=function(){function t(t,e,i){var n,s,r=cc.loader.getRes(t);return r?"json"!==(n=((n=t.match(a))&&n[1]?n[1]:null).toLocaleLowerCase())&&"exportjson"!==n?cc.log("%s load error, must be json file",t):(e?s=o[e]:r.widgetTree?s=o.ccui:r.nodeTree||r.Content&&r.Content.Content?s=o.timeline:r.gameobjects&&(s=o.scene),s?!(e=r.version||r.Version)&&r.armature_data?(cc.warn("%s is armature. please use:",t),cc.warn("    ccs.armatureDataManager.addArmatureFileInfoAsync(%s);",t),cc.warn("    var armature = new ccs.Armature('name');"),new cc.Node):(s=c(s,e))?s.parse(t,r,i)||null:(cc.log("Can't find the parser : %s",t),new cc.Node):(cc.log("Can't find the parser : %s",t),new cc.Node)):cc.log("%s does not exist",t)}var o={ccui:{},timeline:{},action:{},scene:{}},a=(t.registerParser=function(t,e,i){if(!t||!e||!i)return cc.log("register parser error");o[t]||(o[t]={}),o[t][e]=i},t.getParser=function(t,e){return t&&e?o[t]?o[t][e]:void 0:t?o[t]:o},/\.([^\.]+)$/),i=/([^\.](\.\*)?)*$/,c=function(t,e){return t[e]||("*"===e?null:c(t,e.replace(i,"*")))};return t}(),ccs._parser=cc.Class.extend({ctor:function(){this.parsers={}},_dirnameReg:/\S*\//,_dirname:function(t){return(t=t.match(this._dirnameReg))&&t[0]?t[0]:""},getClass:function(t){return t.classname},getNodeJson:function(t){return t.widgetTree},parse:function(t,e,i){i=i||this._dirname(t),this.pretreatment(e,i);var n=this.parseNode(this.getNodeJson(e),i,t);return n&&this.deferred(e,i,n,t),n},pretreatment:function(t,e,i){},deferred:function(t,e,i,n){},parseNode:function(t,e){var i=this.parsers[this.getClass(t)],n=null;return i?n=i.call(this,t,e):cc.log("Can't find the parser : %s",this.getClass(t)),n},registerParser:function(t,e){this.parsers[t]=e}}),ccs.load=function(t,e){var i={node:null,action:null};return i.node=ccs._load(t,null,e),i.action=ccs._load(t,"action",e),i.action&&-1===i.action.tag&&i.node&&(i.action.tag=i.node.tag),i},ccs.load.validate={},ccs.load.preload=!0,ccs.loadWithVisibleSize=function(t,e){t=ccs.load(t,e),e=cc.director.getVisibleSize();return t.node&&e&&(t.node.setContentSize(e.width,e.height),ccui.helper.doLayout(t.node)),t},ccs.actionTimelineCache={createAction:function(t){return ccs._load(t,"action")}},ccs.csLoader={createNode:function(t){return ccs._load(t)}},cc.loader.register(["json"],{load:function(t,c,e,h){cc.loader.loadJson(t,function(t,e){var i=cc.path;if(e&&e.Content&&e.Content.Content.UsedResources){for(var n,s=e.Content.Content.UsedResources,r=i.dirname(c),o=[],a=0;a<s.length;a++)!ccs.load.preload&&/\.(png|jpg$)/.test(s[a])||(n=i.join(r,s[a]),n=i._normalize(n),ccs.load.validate[n])||(ccs.load.validate[n]=!0,o.push(n));cc.loader.load(o,function(){h(t,e)})}else h(t,e)})}}),!function(t){var e=new(ccs._parser.extend({getNodeJson:function(t){return t},parseNode:function(t,e){var i=this.parsers[this.getClass(t)],n=null;return i?n=i.call(this,t,e):cc.log("Can't find the parser : %s",this.getClass(t)),n},deferred:function(t,e,i,n){ccs.triggerManager.parse(t.Triggers||[]),ccs.sceneReader&&(ccs.sceneReader._node=i)},setPropertyFromJsonDict:function(t,e){var i=cc.isUndefined(e.x)?0:e.x,n=cc.isUndefined(e.y)?0:e.y;t.setPosition(i,n),i=Boolean(cc.isUndefined(e.visible)?1:e.visible),t.setVisible(i),i=cc.isUndefined(e.objecttag)?-1:e.objecttag,t.setTag(i),i=cc.isUndefined(e.zorder)?0:e.zorder,t.setLocalZOrder(i),i=cc.isUndefined(e.scalex)?1:e.scalex,n=cc.isUndefined(e.scaley)?1:e.scaley,t.setScaleX(i),t.setScaleY(n),i=cc.isUndefined(e.rotation)?0:e.rotation,t.setRotation(i),t.setName(e.name||"")}})),r=(e.parseChild=function(t,e,i){for(var n=0;n<e.length;n++){var s,r=e[n];(s=r?this.parseNode(r,i):s)&&t.addChild(s)}},{CCSprite:function(t,e,i){var n=new cc.Sprite;return a(e.fileData,i,function(t,e){0===e?n.setTexture(t):1===e&&(e=cc.spriteFrameCache.getSpriteFrame(t),n.setSpriteFrame(e))}),e=new ccs.ComRender(n,"CCSprite"),t.addComponent(e),e},CCTMXTiledMap:function(t,e,i){var n=null;return a(e.fileData,i,function(t,e){0===e&&(n=new cc.TMXTiledMap(t))}),e=new ccs.ComRender(n,"CCTMXTiledMap"),t.addComponent(e),e},CCParticleSystemQuad:function(t,e,i){var n=null;return a(e.fileData,i,function(t,e){0===e?n=new cc.ParticleSystem(t):cc.log("unknown resourcetype on CCParticleSystemQuad!"),n.setPosition(0,0)}),e=new ccs.ComRender(n,"CCParticleSystemQuad"),t.addComponent(e),e},CCArmature:function(t,e,i){var n=null;if(a(e.fileData,i,function(t,e){0===e&&((e=cc.loader.getRes(t))||cc.log("Please load the resource [%s] first!",t),e=e.armature_data[0].name,ccs.armatureDataManager.addArmatureFileInfo(t),n=new ccs.Armature(e))}),n)return i=new ccs.ComRender(n,"CCArmature"),t.addComponent(i),(t=e.selectedactionname)&&n.getAnimation()&&n.getAnimation().play(t),i},CCComAudio:function(i,n,t){var s=null;a(n.fileData,t,function(t,e){0===e&&((s=new ccs.ComAudio).preloadEffect(t),(e=n.name)&&s.setName(e),i.addComponent(s))})},CCComAttribute:function(i,t,e){var n=null;return a(t.fileData,e,function(t,e){0===e?(n=new ccs.ComAttribute,""!==t&&n.parse(t),i.addComponent(n)):cc.log("unknown resourcetype on CCComAttribute!")}),n},CCBackgroundAudio:function(n,s,t){var r=null;a(s.fileData,t,function(t,e){var i;0===e&&((r=new ccs.ComAudio).preloadBackgroundMusic(t),r.setFile(t),e=Boolean(s.loop||0),r.setLoop(e),(i=s.name)&&r.setName(i),n.addComponent(r),r.playBackgroundMusic(t,e))})},GUIComponent:function(t,e,i){var n=null;return a(e.fileData,i,function(t,e){n=ccs._load(t,"ccui")}),e=new ccs.ComRender(n,"GUIComponent"),t.addComponent(e),e},CCScene:function(){}}),o={},a=function(t,e,i){var n,s;null!=t&&(n=t.path,s=t.resourceType,t=t.plist,n)&&(t&&(cc.loader.getRes(e+t)?(o[e+t]=!0,cc.spriteFrameCache.addSpriteFrames(e+t)):o[e+t]||cc.log("%s need to be preloaded",e+t)),i(0!==s?n:e+n,s))};e.parseComponents=function(n,t,s){n&&t&&t.forEach(function(t){var e=r[t.classname],i=null;e?i=e(n,t,s):cc.log("Can't find the component parser : %s",t.classname),t=t.name,i&&t&&i.setName(t)})},e.registerParser("CCNode",function(t,e){var i=new cc.Node,e=(this.setPropertyFromJsonDict(i,t),this.parseChild.call(this,i,t.gameobjects,e),this.parseComponents(i,t.components,e),t.CanvasSize);return e&&i.setContentSize(cc.size(e._width,e._height)),i}),t.registerParser("scene","*",e)}(ccs._load),!function(t,e){function p(t,e,i,n){i&&n(0===e?t+i:i,e)}var h=Array(50),n=new(e.extend({addSpriteFrame:function(t,e){if(t)for(var i=0;i<t.length;i++)cc.spriteFrameCache.addSpriteFrames(e+t[i])},pretreatment:function(t,e){this.addSpriteFrame(t.textures,e)},parseRecursive:function(t,e){var i,n,s,r,o,a=1,c=null;for(h[0]=t;0<a;)if(n=h[--a],h[a]=null,n)if(s=n.classname,i=this.parsers[s]){if((s=new i.object)&&(c=c||s,r=n.options,this.generalAttributes(s,r),i.handle(s,r,e),this.colorAttributes(s,r),i=n.parent,n.parent=null,i instanceof ccui.PageView?i.addPage(s):i instanceof ccui.ListView?i.pushBackCustomItem(s):i&&(i instanceof ccui.Layout||(s.getPositionType()===ccui.Widget.POSITION_PERCENT&&(r=s._positionPercent,o=i._anchorPoint,s._positionPercent.x=r.x+o.x,s._positionPercent.y=r.y+o.y),r=i._renderCmd._anchorPointInPoints,s._position.x+=r.x,s._position.y+=r.y,s.setNodeDirty()),i.addChild(s)),n=n.children)&&0<n.length)for(i=n.length-1;0<=i;i--)h[a]=n[i],h[a].parent=s,a++}else cc.log("Can't find the parser : %s",s);return c},parse:function(t,e,i){i=i||this._dirname(t),this.pretreatment(e,i);var n=this.parseRecursive(e.widgetTree,i);return n&&this.deferred(e,i,n,t),n},deferred:function(t,e,i,n){i&&(ccs.actionManager.initWithDictionary(n,t.animation,i),i.setContentSize(t.designWidth,t.designHeight))}})),s=(n.generalAttributes=function(t,e){t._ignoreSize=e.ignoreSize||!0,t._sizeType=e.sizeType||0,t._positionType=e.positionType||0,t._sizePercent.x=e.sizePercentX||0,t._sizePercent.y=e.sizePercentY||0,t._positionPercent.x=e.positionPercentX||0,t._positionPercent.y=e.positionPercentY||0;var i=0,n=0,n=e.adaptScreen?(i=(n=cc.director.getWinSize()).width,n.height):(i=e.width||0,e.height||0),s=e.anchorPointX,r=e.anchorPointY;if(t._anchorPoint.x=isNaN(s)?.5:s,t._anchorPoint.y=isNaN(r)?.5:r,t.setContentSize(i,n),t.setTag(e.tag),t.setActionTag(e.actiontag),t.setTouchEnabled(e.touchAble),t._name=e.name||"default",t._position.x=e.x||0,t._position.y=e.y||0,t._scaleX=e.scaleX||1,t._scaleY=e.scaleY||1,t._rotationX=t._rotationY=e.rotation||0,t._visible=e.visible||!1,t._localZOrder=e.ZOrder||0,null!=e.layoutParameter){switch(i=e.layoutParameter,n=null,isNaN(i.type)?2:i.type){case 1:(n=new ccui.LinearLayoutParameter)._linearGravity=i.gravity||0;break;case 2:(n=new ccui.RelativeLayoutParameter)._relativeLayoutName=i.relativeName,n._relativeWidgetName=i.relativeToName,n._relativeAlign=i.align||0}null!=n&&((s=n._margin).left=i.marginLeft||0,s.top=i.marginTop||0,s.right=i.marginRight||0,s.bottom=i.marginDown||0,t.setLayoutParameter(n))}},n.colorAttributes=function(t,e){null!=(i=null!==e.opacity?e.opacity:255)&&t.setOpacity(i);var i=e.colorR,n=e.colorG,s=e.colorB;t.setColor(cc.color(null==i?255:i,null==n?255:n,null==s?255:s)),t.setFlippedX(e.flipX),t.setFlippedY(e.flipY)},n.LayoutAttributes=function(i,t,e){var n=0,s=0,s=(s=t.adaptScreen?(n=(s=cc.director.getWinSize()).width,s.height):(n=t.width||0,t.height||0),i.setSize(cc.size(n,s)),i.setClippingEnabled(t.clipAble),n=t.backGroundScale9Enable,i.setBackGroundImageScale9Enabled(n),t.bgColorR||0),r=t.bgColorG||0,o=t.bgColorB||0,a=isNaN(t.bgStartColorR)?255:t.bgStartColorR,c=isNaN(t.bgStartColorG)?255:t.bgStartColorG,h=isNaN(t.bgStartColorB)?255:t.bgStartColorB,l=isNaN(t.bgEndColorR)?255:t.bgEndColorR,u=isNaN(t.bgEndColorG)?255:t.bgEndColorG,d=isNaN(t.bgEndColorB)?255:t.bgEndColorB,_=(i.setBackGroundColorVector(cc.p(t.vectorX||0,t.vectorY||0)),t.bgColorOpacity||0);i.setBackGroundColorType(t.colorType||0),i.setBackGroundColor(cc.color(a,c,h),cc.color(l,u,d)),i.setBackGroundColor(cc.color(s,r,o)),i.setBackGroundColorOpacity(_),(s=t.backGroundImageData)&&p(e,s.resourceType||0,s.path,function(t,e){i.setBackGroundImage(t,e)}),n&&(e=t.capInsetsX||0,n=t.capInsetsY||0,s=isNaN(t.capInsetsWidth)?1:t.capInsetsWidth,r=isNaN(t.capInsetsHeight)?1:t.capInsetsHeight,i.setBackGroundImageCapInsets(cc.rect(e,n,s,r))),t.layoutType&&i.setLayoutType(t.layoutType)},n.ButtonAttributes=function(i,t,e){var n,s=t.scale9Enable,r=(i.setScale9Enabled(s),t.normalData);p(e,r.resourceType||0,r.path,function(t,e){i.loadTextureNormal(t,e)}),r=t.pressedData,p(e,r.resourceType||0,r.path,function(t,e){i.loadTexturePressed(t,e)}),r=t.disabledData,p(e,r.resourceType||0,r.path,function(t,e){i.loadTextureDisabled(t,e)}),s&&(e=t.capInsetsX||0,s=t.capInsetsY||0,r=isNaN(t.capInsetsWidth)?1:t.capInsetsWidth,n=isNaN(t.capInsetsHeight)?1:t.capInsetsHeight,i.setCapInsets(cc.rect(e,s,r,n)),e=t.scale9Width||0,s=t.scale9Height||0,null!=e)&&null!=s&&i.setSize(cc.size(e,s)),(e=t.text||"")&&(i.setTitleText(e),i.setTitleColor(cc.color(null!==t.textColorR?t.textColorR:255,null!==t.textColorG?t.textColorG:255,null!==t.textColorB?t.textColorB:255)),null!=t.fontSize&&i.setTitleFontSize(t.fontSize),t.fontName)&&i.setTitleFontName(t.fontName)},n.CheckBoxAttributes=function(i,t,e){var n=t.backGroundBoxData,s=(p(e,n.resourceType||0,n.path,function(t,e){i.loadTextureBackGround(t,e)}),t.backGroundBoxSelectedData);p(e,s.resourceType||n.resourceType,s.path||n.path,function(t,e){i.loadTextureBackGroundSelected(t,e)}),n=t.frontCrossData,p(e,n.resourceType||0,n.path,function(t,e){i.loadTextureFrontCross(t,e)}),s=t.backGroundBoxDisabledData,p(e,s.resourceType||n.resourceType,s.path||n.path,function(t,e){i.loadTextureBackGroundDisabled(t,e)}),n=t.frontCrossDisabledData,p(e,n.resourceType||0,n.path,function(t,e){i.loadTextureFrontCrossDisabled(t,e)}),t.selectedState&&i.setSelected(t.selectedState)},n.ImageViewAttributes=function(i,t,e){var n,s=t.fileNameData;p(e,s.resourceType||0,s.path,function(t,e){i.loadTexture(t,e)}),e=!1,t.scale9Enable&&(e=t.scale9Enable),i.setScale9Enabled(e),e&&(e=t.scale9Height||0,t.scale9Width&&e&&i.setSize(cc.size(t.scale9Width||0,t.scale9Height||0)),e=t.capInsetsX||0,s=t.capInsetsY||0,n=isNaN(t.capInsetsWidth)?1:t.capInsetsWidth,t=isNaN(t.capInsetsHeight)?1:t.capInsetsHeight,i.setCapInsets(cc.rect(e,s,n,t)))},n.TextAtlasAttributes=function(t,e,i){var n=e.stringValue,s=e.charMapFileData,r=e.itemWidth,o=e.itemHeight,a=e.startCharMap;if(null!=n&&s&&null!=r&&null!=o&&null!=a)switch(e=e.charMapFileData,e.resourceType||0){case 0:t.setProperty(n,i+e.path,r,o,a);break;case 1:cc.log("Wrong res type of LabelAtlas!")}},n.TextBMFontAttributes=function(t,e,i){var n=e.fileNameData;switch(n.resourceType||0){case 0:t.setFntFile(i+n.path);break;case 1:cc.log("Wrong res type of LabelAtlas!")}t.setString(e.text||"")},/\.ttf$/);n.TextAttributes=function(t,e,i){t.setTouchScaleChangeEnabled(e.touchScaleEnable);var n=e.text||"";n&&t._setString(n),null!=e.fontSize&&t._setFontSize(e.fontSize),null!=(n=e.fontName)&&(cc.sys.isNative?s.test(n)?t.setFontName(cc.path.join(cc.loader.resPath,i,n)):t.setFontName(n):t._setFontName(n.replace(s,""))),i=e.areaHeight||0,e.areaWidth&&i&&(i=cc.size(e.areaWidth,e.areaHeight),t._setTextAreaSize(i)),null!=(i=e.hAlignment||0)&&t._setTextHorizontalAlignment(i),null!=(e=e.vAlignment||0)&&t._setTextVerticalAlignment(e),t._updateUITextContentSize()},n.ListViewAttributes=function(t,e,i){n.ScrollViewAttributes(t,e,i),t.setDirection(e.direction||1),t.setGravity(e.gravity||0),t.setItemsMargin(e.itemMargin||0)},n.LoadingBarAttributes=function(i,t,e){var n,s,r=t.textureData;p(e,r.resourceType||0,r.path,function(t,e){i.loadTexture(t,e)}),e=t.scale9Enable,i.setScale9Enabled(e),e&&(e=t.capInsetsX||0,r=t.capInsetsY||0,n=isNaN(t.capInsetsWidth)?1:t.capInsetsWidth,s=isNaN(t.capInsetsHeight)?1:t.capInsetsHeight,i.setCapInsets(cc.rect(e,r,n,s)),i.setSize(cc.size(t.width||0,t.height||0))),i.setDirection(t.direction||0),i.setPercent(t.percent||0)},n.PageViewAttributes=n.LayoutAttributes,n.ScrollViewAttributes=function(t,e,i){n.LayoutAttributes(t,e,i),t.setInnerContainerSize(cc.size(null!=e.innerWidth?e.innerWidth:200,null!=e.innerHeight?e.innerHeight:200)),t.setDirection(null!=e.direction?e.direction:1),t.setBounceEnabled(e.bounceEnable)},n.SliderAttributes=function(i,t,e){var n=t.scale9Enable,s=(i.setScale9Enabled(n),t.length),r=(o=t.barFileNameData).resourceType||0,o=o.path;null!=t.barFileName?n&&(p(e,r,o,function(t,e){i.loadBarTexture(t,e)}),i.setSize(cc.size(s,i.getContentSize().height))):p(e,r,o,function(t,e){i.loadBarTexture(t,e)}),n=t.ballNormalData,p(e,n.resourceType||0,n.path,function(t,e){i.loadSlidBallTextureNormal(t,e)}),s=t.ballPressedData,p(e,s.resourceType||n.resourceType,s.path||n.path,function(t,e){i.loadSlidBallTexturePressed(t,e)}),n=t.ballDisabledData,p(e,n.resourceType||0,n.path,function(t,e){i.loadSlidBallTextureDisabled(t,e)}),t=t.progressBarData,p(e,t.resourceType||0,t.path,function(t,e){i.loadProgressBarTexture(t,e)})},n.TextFieldAttributes=function(t,e,i){var n=e.placeHolder||"";n&&t.setPlaceHolder(n),t.setString(e.text||""),(n=e.fontSize)&&t.setFontSize(n),null!=(n=e.fontName)&&(cc.sys.isNative?s.test(n)?t.setFontName(cc.path.join(cc.loader.resPath,i,n)):t.setFontName(n):t.setFontName(n.replace(s,""))),i=e.touchSizeWidth||0,n=e.touchSizeHeight||0,null!=i&&null!=n&&t.setTouchSize(i,n),i=e.maxLengthEnable,t.setMaxLengthEnabled(i),i&&t.setMaxLength(e.maxLength),i=e.passwordEnable,t.setPasswordEnabled(i),i&&t.setPasswordStyleText(e.passwordStyleText),i=e.areaWidth||0,n=e.areaHeight||0,i&&n&&(i=cc.size(i,n),t.setTextAreaSize(i)),(i=e.hAlignment||0)&&t.setTextHorizontalAlignment(i),(i=e.vAlignment||0)&&t.setTextVerticalAlignment(i),i=isNaN(e.colorR)?255:e.colorR,n=isNaN(e.colorG)?255:e.colorG,e=isNaN(e.colorB)?255:e.colorB,t.setTextColor(cc.color(i,n,e))},n.parsers={Panel:{object:ccui.Layout,handle:n.LayoutAttributes},Button:{object:ccui.Button,handle:n.ButtonAttributes},CheckBox:{object:ccui.CheckBox,handle:n.CheckBoxAttributes},ImageView:{object:ccui.ImageView,handle:n.ImageViewAttributes},LabelAtlas:{object:ccui.TextAtlas,handle:n.TextAtlasAttributes},LabelBMFont:{object:ccui.TextBMFont,handle:n.TextBMFontAttributes},Label:{object:ccui.Text,handle:n.TextAttributes},ListView:{object:ccui.ListView,handle:n.ListViewAttributes},LoadingBar:{object:ccui.LoadingBar,handle:n.LoadingBarAttributes},PageView:{object:ccui.PageView,handle:n.PageViewAttributes},ScrollView:{object:ccui.ScrollView,handle:n.ScrollViewAttributes},Slider:{object:ccui.Slider,handle:n.SliderAttributes},TextField:{object:ccui.TextField,handle:n.TextFieldAttributes}},t.registerParser("ccui","*",n)}(ccs._load,ccs._parser),!function(t){var e=new(ccs._parser.extend({getNodeJson:function(t){return t.action},parseNode:function(t,n,e){var s,r;return t?(s=this,(r=new ccs.ActionTimeline).setDuration(t.duration),r.setTimeSpeed(t.speed||1),t.timelines.forEach(function(t){var e,i=s.parsers[t.frameType];i?e=i.call(s,t,n):cc.log("parser does not exist : %s",t.frameType),e&&r.addTimeline(e),"ColorFrame"===t.frameType&&r.addTimeline(s.parsers.AlphaFrame.call(s,t,n))}),r):null}}));[{name:"PositionFrame",handle:function(t){var e=new ccs.PositionFrame;return e.setPosition(cc.p(t.x,t.y)),e}},{name:"VisibleFrame",handle:function(t){var e=new ccs.VisibleFrame;return e.setVisible(t.value),e}},{name:"ScaleFrame",handle:function(t){var e=new ccs.ScaleFrame,i=t.y;return e.setScaleX(t.x),e.setScaleY(i),e}},{name:"RotationFrame",handle:function(t){var e=new ccs.RotationFrame;return e.setRotation(t.rotation),e}},{name:"SkewFrame",handle:function(t){var e=new ccs.SkewFrame,i=t.y;return e.setSkewX(t.x),e.setSkewY(i),e}},{name:"RotationSkewFrame",handle:function(t){var e=new ccs.RotationSkewFrame,i=t.y;return e.setSkewX(t.x),e.setSkewY(i),e}},{name:"AnchorFrame",handle:function(t){var e=new ccs.AnchorPointFrame;return e.setAnchorPoint(cc.p(t.x,t.y)),e}},{name:"InnerActionFrame",handle:function(t){var e=new ccs.InnerActionFrame,i=t.startFrame;return e.setInnerActionType(t.innerActionType),e.setStartFrameIndex(i),e}},{name:"ColorFrame",handle:function(t){var e=new ccs.ColorFrame;return e.setColor(cc.color(t.red,t.green,t.blue)),(new ccs.AlphaFrame).setAlpha(t.alpha),e}},{name:"AlphaFrame",handle:function(t){var e=new ccs.AlphaFrame;return e.setAlpha(t.alpha),e}},{name:"TextureFrame",handle:function(t){var e,i=new ccs.TextureFrame;return null!=(t=t.value)&&(e=t,null==cc.spriteFrameCache.getSpriteFrame(e)&&(e=ccs.csLoader.getJsonPath()+t),i.setTextureName(e)),i}},{name:"EventFrame",handle:function(t){var e=new ccs.EventFrame;return null!=(t=t.value)&&e.setEvent(t),e}},{name:"ZOrderFrame",handle:function(t){var e=new ccs.ZOrderFrame;return e.setZOrder(t.value),e}}].forEach(function(n){e.registerParser(n.name,function(t,e){var i=new ccs.Timeline,t=(i.setActionTag(t.actionTag),t.frames);return t&&t.length&&t.forEach(function(t){var e=n.handle(t);e.setFrameIndex(t.frameIndex),e.setTween(t.tween),i.addFrame(e)}),i})}),t.registerParser("action","0.*",e),t.registerParser("action","1.*",e)}(ccs._load),!function(t){var e=new(ccs._parser.extend({getNodeJson:function(t){return t.Content.Content.Animation},parseNode:function(t,n,e){var s,r;return t?(s=this,(r=new ccs.ActionTimeline).setDuration(t.Duration),r.setTimeSpeed(t.Speed||1),t.Timelines.forEach(function(t){var e,i=s.parsers[t.Property];i?e=i.call(s,t,n):cc.log("parser does not exist : %s",t.Property),e&&r.addTimeline(e)}),r):null},deferred:function(t,e,i,n){for(e=(t=t.Content.Content.AnimationList)?t.length:0,n=0;n<e;n++){var s=t[n],r={name:null,startIndex:null,endIndex:null};r.name=s.Name,r.startIndex=s.StartIndex,r.endIndex=s.EndIndex,i.addAnimationInfo(r)}}}));[{name:"Position",handle:function(t){var e=new ccs.PositionFrame;return e.setPosition(cc.p(t.X,t.Y)),e}},{name:"VisibleForFrame",handle:function(t){var e=new ccs.VisibleFrame;return e.setVisible(t.Value),e}},{name:"Scale",handle:function(t){var e=new ccs.ScaleFrame,i=t.Y;return e.setScaleX(t.X),e.setScaleY(i),e}},{name:"Rotation",handle:function(t){var e=new ccs.RotationFrame;return e.setRotation(t.Rotation||t.Value||0),e}},{name:"Skew",handle:function(t){var e=new ccs.SkewFrame,i=t.Y;return e.setSkewX(t.X),e.setSkewY(i),e}},{name:"RotationSkew",handle:function(t){var e=new ccs.RotationSkewFrame,i=t.Y;return e.setSkewX(t.X),e.setSkewY(i),e}},{name:"Anchor",handle:function(t){var e=new ccs.AnchorPointFrame;return e.setAnchorPoint(cc.p(t.X,t.Y)),e}},{name:"AnchorPoint",handle:function(t){var e=new ccs.AnchorPointFrame;return e.setAnchorPoint(cc.p(t.X,t.Y)),e}},{name:"InnerAction",handle:function(t){var e=new ccs.InnerActionFrame,i=t.StartFrame;return e.setInnerActionType(t.InnerActionType),e.setStartFrameIndex(i),e}},{name:"CColor",handle:function(t){var e=new ccs.ColorFrame;return(t=(t=t.Color)||{}).R=void 0===t.R?255:t.R,t.G=void 0===t.G?255:t.G,t.B=void 0===t.B?255:t.B,e.setColor(cc.color(t.R,t.G,t.B)),e}},{name:"Alpha",handle:function(t){var e=new ccs.AlphaFrame;return e.setAlpha(t.Value),e}},{name:"FileData",handle:function(t,e){var i,n,s=new ccs.TextureFrame,t=t.TextureFile;return null!=t&&(i=t.Plist,t=t.Path,!(n=cc.spriteFrameCache.getSpriteFrame(t))&&i&&(cc.loader.getRes(e+i)?(cc.spriteFrameCache.addSpriteFrames(e+i),n=cc.spriteFrameCache.getSpriteFrame(t)):cc.log("%s need to be preloaded",e+i)),s.setTextureName(t=null==n?e+t:t)),s}},{name:"FrameEvent",handle:function(t){var e=new ccs.EventFrame;return null!=(t=t.Value)&&e.setEvent(t),e}},{name:"ZOrder",handle:function(t){var e=new ccs.ZOrderFrame;return e.setZOrder(t.Value),e}},{name:"ActionValue",handle:function(t){var e=new ccs.InnerActionFrame,i=t.InnerActionType,n=t.CurrentAniamtionName,s=t.SingleFrameIndex;return void 0!==(t=t.FrameIndex)&&e.setFrameIndex(t),e.setInnerActionType(ccs.InnerActionType[i]),e.setSingleFrameIndex(s),e.setEnterWithName(!0),n&&e.setAnimationName(n),e}},{name:"BlendFunc",handle:function(t){var e=new ccs.BlendFuncFrame;return(t=t.BlendFunc)&&void 0!==t.Src&&void 0!==t.Dst&&e.setBlendFunc(new cc.BlendFunc(t.Src,t.Dst)),e}}].forEach(function(o){e.registerParser(o.name,function(t,s){var r=new ccs.Timeline,t=(r.setActionTag(t.ActionTag),t.Frames);return t&&t.length&&t.forEach(function(t){var e,i,n=o.handle(t,s);n.setFrameIndex(t.FrameIndex),n.setTween(null==t.Tween||t.Tween),(t=t.EasingData)&&(t=t,(e=n).setTweenType(t.Type),t=t.Points,i=[],t)&&(t.forEach(function(t){i.push(t.X),i.push(t.Y)}),e.setEasingParams(i)),r.addFrame(n)}),r})}),t.registerParser("action","2.*",e),t.registerParser("action","*",e)}(ccs._load),!function(t,e){var r={},i=new(e.extend({getNodeJson:function(t){return t.nodeTree},addSpriteFrame:function(t,e,i){if(t&&e&&t.length===e.length)for(var n=0;n<t.length;n++){var s=i+t[n];cc.loader.getRes(s)||r[s]?r[s]=!0:cc.log("%s need to be preloaded",s),cc.spriteFrameCache.addSpriteFrames(s,i+e[n])}},pretreatment:function(t,e,i){this.addSpriteFrame(t.textures,t.texturesPng,e)}})),o=(i.generalAttributes=function(t,e){var i=null!=e.width?e.width:0,n=null!=e.height?e.height:0,s=null!=e.x?e.x:0,r=null!=e.y?e.y:0,o=null!=e.scaleX?e.scaleX:1,a=null!=e.scaleY?e.scaleY:1,c=null!=e.rotation?e.rotation:0,h=null!=e.rotationSkewX?e.rotationSkewX:0,l=null!=e.rotationSkewY?e.rotationSkewY:0,u=null!=e.skewX?e.skewX:0,d=null!=e.skewY?e.skewY:0,_=null!=e.anchorPointX?e.anchorPointX:.5,p=null!=e.anchorPointY?e.anchorPointY:.5,f=null!=e.opacity?e.opacity:255,g=null!=e.colorR?e.colorR:255,m=null!=e.colorG?e.colorG:255,y=null!=e.colorB?e.colorB:255,T=null!=e.colorR?e.colorR:0,S=null!=e.tag?e.tag:0,C=null!=e.actionTag?e.actionTag:0,e=null==e.visible||e.visible;0==s&&0==r||t.setPosition(cc.p(s,r)),1!=o&&t.setScaleX(o),1!=a&&t.setScaleY(a),0!=c&&t.setRotation(c),0!=h&&t.setRotationX(h),0!=l&&t.setRotationY(l),0!=u&&t.setSkewX(u),0!=d&&t.setSkewY(d),.5==_&&.5==p||t.setAnchorPoint(cc.p(_,p)),0==i&&0==n||t.setContentSize(cc.size(i,n)),0!=T&&t.setLocalZOrder(T),1!=e&&t.setVisible(e),255!=f&&t.setOpacity(f),255==g&&255==m&&255==y||t.setColor(cc.color(g,m,y)),t.setTag(S),t.setUserObject(new ccs.ActionTimelineData(C))},i.parseComponent=function(t,e){if(e)for(var i=0;i<e.length;++i){var n=this.loadComponent(e[i]);n&&t.addComponent(n)}},i.parseChild=function(t,e,i,n){for(t=i.children,i=0;i<t.length;i++){var s,r,o=this.parseNode(t[i],n);o&&(e instanceof ccui.PageView?o instanceof ccui.Layout&&e.addPage(o):e instanceof ccui.ListView?o instanceof ccui.Widget&&e.pushBackCustomItem(o):(!(e instanceof ccui.Layout)&&o instanceof ccui.Widget&&(o.getPositionType()===ccui.Widget.POSITION_PERCENT&&(s=o.getPositionPercent(),r=e.getAnchorPoint(),o.setPositionPercent(cc.p(s.x+r.x,s.y+r.y))),s=e.getAnchorPointInPoints(),o.setPosition(cc.p(o.getPositionX()+s.x,o.getPositionY()+s.y))),e.addChild(o)))}},i.initNode=function(t){var e=new cc.Node;return this.generalAttributes(e,t),e},i.initSubGraph=function(t){var e=(e=t.fileName)&&""!==e?this.createNode(e):new ccs.Node;return this.generalAttributes(e,t),e},i.initSprite=function(t,e){var i=t.fileName,n=(null!=i?(i=(n=cc.spriteFrameCache.getSpriteFrame(i))?ccs.Sprite.createWithSpriteFrame(n):new ccs.Sprite(e+i))||(i=new cc.Sprite,cc.log("filePath is empty. Create a sprite with no texture")):i=new ccs.Sprite,this.generalAttributes(i,t),t.flipX),e=t.flipY;return 0!=n&&i.setFlippedX(n),0!=e&&i.setFlippedY(e),i},i.initParticle=function(t,e){var i=t.tmxFile,n=new cc.ParticleSystemQuad(t.plistFile);return n.setTotalParticles(i),this.generalAttributes(n,t),n},i.initTMXTiledMap=function(t,e){var i=t.tmxFile,n=t.tmxString,t=t.resourcePath,s=null;return i&&""!==i?s=new cc.TMXTiledMap(i):n&&""!==n&&t&&""!==t&&(s=new cc.TMXTiledMap(n,t)),s},t.getParser("ccui")["*"]);i.initWidget=function(t,e){var i,n,s=t.classname,r=o.parsers[s];return r?((s=r.call(o,t,e))&&(r=t.rotationSkewX,e=t.rotationSkewY,i=t.skewX,n=t.skewY,0!=r&&s.setRotationX(r),0!=e&&s.setRotationY(e),0!=i&&s.setSkewX(i),0!=n&&s.setSkewY(n),s.setUserObject(new ccs.ActionTimelineData(t.actionTag))),s):cc.log("%s parser is not found",s)},[{name:"Node",handle:i.initNode},{name:"SubGraph",handle:i.initSubGraph},{name:"Sprite",handle:i.initSprite},{name:"Particle",handle:i.initParticle},{name:"TMXTiledMap",handle:i.initTMXTiledMap},{name:"Widget",handle:i.initWidget},{name:"Panel",handle:i.initWidget},{name:"Button",handle:i.initWidget},{name:"CheckBox",handle:i.initWidget},{name:"ImageView",handle:i.initWidget},{name:"LabelAtlas",handle:i.initWidget},{name:"LabelBMFont",handle:i.initWidget},{name:"Label",handle:i.initWidget},{name:"ListView",handle:i.initWidget},{name:"LoadingBar",handle:i.initWidget},{name:"PageView",handle:i.initWidget},{name:"ScrollView",handle:i.initWidget},{name:"Slider",handle:i.initWidget},{name:"TextField",handle:i.initWidget}].forEach(function(s){i.registerParser(s.name,function(t,e,i){var n=s.handle.call(this,t.options);return this.parseComponent(n,t.components),this.parseChild(e,n,t,i),n})}),t.registerParser("timeline","0.*",i),t.registerParser("timeline","1.*",i)}(ccs._load,ccs._parser),!function(t){function o(t,e){return void 0===t?e:t}function a(t,e,i,n){2===t.getBackGroundColorType()?(n=n||{},t.setBackGroundColor(d(i=i||{}),d(n))):t.setBackGroundColor(d(e=e||{}))}function c(t,e){t.setBackGroundColorVector(cc.p(e.ScaleX||0,e.ScaleY||0))}var s=new(ccs._parser.extend({parse:function(t,e,i){i=void 0!==i?i:this._dirname(t),this.pretreatment(e,i,t);var n=this.parseNode(this.getNodeJson(e),i);return this.deferred(e,i,n,t),n},getNodeJson:function(t){return(t=t.Content).ObjectData||t.Content.ObjectData},getClass:function(t){return t.ctype}})),r=(s.generalAttributes=function(t,e){null!=e.Name&&t.setName(e.Name);null==(i=e.Position)||null==i.X&&null==i.Y||t.setPosition(cc.p(i.X||0,i.Y||0)),null!=(i=e.Scale)&&(null!=i.ScaleX&&t.setScaleX(i.ScaleX),null!=i.ScaleY)&&t.setScaleY(i.ScaleY),null!=(i=e.RotationSkewX)&&t.setRotationX(i),i=e.RotationSkewY,null!=e.RotationSkewY&&t.setRotationY(i),null!=(i=e.AnchorPoint)&&(null==i.ScaleX&&(i.ScaleX=0),null==i.ScaleY&&(i.ScaleY=0),.5==i.ScaleX&&.5==i.ScaleY||t.setAnchorPoint(cc.p(i.ScaleX,i.ScaleY))),null!=e.ZOrder&&t.setLocalZOrder(e.ZOrder),i=o(e.VisibleForFrame,!0),t.setVisible(i),(i=e.Size)&&_(t,i),null!=e.Alpha&&t.setOpacity(e.Alpha),t.setTag(e.Tag||0);var i=e.ActionTag||0,n=new ccs.ComExtensionData,s=e.UserData;void 0!==s&&n.setCustomProperty(s),n.setActionTag(i),t.getComponent("ComExtensionData")&&t.removeComponent("ComExtensionData"),t.addComponent(n),t.setCascadeColorEnabled(!0),t.setCascadeOpacityEnabled(!0),h(t,e)},s.parseChild=function(t,e,i){if(t&&e)for(var n=0;n<e.length;n++){var s,r,o=this.parseNode(e[n],i);o&&(t instanceof ccui.PageView?o instanceof ccui.Layout&&t.addPage(o):t instanceof ccui.ListView?o instanceof ccui.Widget&&t.pushBackCustomItem(o):(!(t instanceof ccui.Layout)&&o instanceof ccui.Widget&&o.getPositionType()===ccui.Widget.POSITION_PERCENT&&(s=o.getPositionPercent(),r=t.getAnchorPoint(),o.setPositionPercent(cc.p(s.x+r.x,s.y+r.y))),t.addChild(o)))}},s.initSingleNode=function(t){var e=new cc.Node;return this.generalAttributes(e,t),null!=(t=t.CColor)&&e.setColor(d(t)),e},s.initSprite=function(t,e){var i,n=new cc.Sprite,e=(u(t.FileData,e,function(t,e){0===e?n.setTexture(t):1===e&&(e=cc.spriteFrameCache.getSpriteFrame(t))&&n.setSpriteFrame(e)}),t.BlendFunc);return t.BlendFunc&&(i=cc.BlendFunc.ALPHA_PREMULTIPLIED,void 0!==e.Src&&(i.src=e.Src),void 0!==e.Dst&&(i.dst=e.Dst),n.setBlendFunc(i)),t.FlipX&&n.setFlippedX(!0),t.FlipY&&n.setFlippedY(!0),this.generalAttributes(n,t),null!=(e=t.CColor)&&n.setColor(d(e)),n},s.initParticle=function(n,t){var s,r=this;return u(n.FileData,t,function(t,e){cc.loader.getRes(t)||cc.log("%s need to be preloaded",t),s=new cc.ParticleSystem(t),r.generalAttributes(s,n),s.setPositionType(cc.ParticleSystem.TYPE_GROUPED),cc.sys.isNative||s.setDrawMode(cc.ParticleSystem.TEXTURE_MODE);var i,t=n.BlendFunc;n.BlendFunc&&(i=cc.BlendFunc.ALPHA_PREMULTIPLIED,void 0!==t.Src&&(i.src=t.Src),void 0!==t.Dst&&(i.dst=t.Dst),s.setBlendFunc(i))}),s},s.widgetAttributes=function(t,e,i){t.setCascadeColorEnabled(!0),t.setCascadeOpacityEnabled(!0),t.setUnifySizeEnabled(!1),t.ignoreContentAdaptWithSize(!1),i||_(t,e.Size),(i=e.Name)&&t.setName(i),i=e.ActionTag||0,t.setActionTag(i);var n=new ccs.ComExtensionData,s=e.UserData;void 0!==s&&n.setCustomProperty(s),n.setActionTag(i),t.getComponent("ComExtensionData")&&t.removeComponent("ComExtensionData"),t.addComponent(n),(i=e.RotationSkewX)&&t.setRotationX(i),(i=e.RotationSkewY)&&t.setRotationY(i),e.FlipX&&t.setFlippedX(!0),e.FlipY&&t.setFlippedY(!0),null!=(i=e.zOrder)&&t.setLocalZOrder(i),i=o(e.VisibleForFrame,!0),t.setVisible(i),null!=(i=e.Alpha)&&t.setOpacity(i),t.setTag(e.Tag||0),t.setTouchEnabled(e.TouchEnable||!1),null!=(i=e.CallBackType)&&t.setCallbackType(i),(i=e.CallBackName)&&t.setCallbackName(i),null!=(i=e.Position)&&t.setPosition(i.X||0,i.Y||0),null!=(n=e.Scale)&&(i=o(n.ScaleX,1),n=o(n.ScaleY,1),t.setScaleX(i),t.setScaleY(n)),null!=(i=e.AnchorPoint)&&t.setAnchorPoint(i.ScaleX||0,i.ScaleY||0),null!=(i=e.CColor)&&t.setColor(d(i)),h(t,e),r(t,e)},function(e,t){function i(t){"function"==typeof e[s]&&e[s](t)}var n=t.CallBackType,s=t.CallBackName;"Click"===n?e.addClickEventListener(i):"Touch"===n?e.addTouchEventListener(i):"Event"===n&&e.addCCSEventListener(i)}),h=function(t,e){var i,n,s,r,o,a,c,h,l,u,d,_,p,f,g,t=ccui.LayoutComponent.bindLayoutComponent(t);t&&(i=e.PositionPercentXEnable||e.PositionPercentXEnabled||!1,n=e.PositionPercentYEnable||e.PositionPercentYEnabled||!1,r=s=0,null!=(_=e.PrePosition)&&(s=_.X||0,r=_.Y||0),o=e.PercentWidthEnable||e.PercentWidthEnabled||!1,a=e.PercentHeightEnable||e.PercentHeightEnabled||!1,h=c=0,p=e.PreSize,null!=_&&(c=p.X||0,h=p.Y||0),l=e.StretchWidthEnable||!1,u=e.StretchHeightEnable||!1,d=e.HorizontalEdge,_=e.VerticalEdge,p=e.LeftMargin||0,f=e.RightMargin||0,g=e.TopMargin||0,e=e.BottomMargin||0,t.setPositionPercentXEnabled(i),t.setPositionPercentYEnabled(n),t.setPositionPercentX(s),t.setPositionPercentY(r),t.setPercentWidthEnabled(o),t.setPercentHeightEnabled(a),t.setPercentWidth(c),t.setPercentHeight(h),t.setPercentWidthEnabled(o||a),t.setStretchWidthEnabled(l),t.setStretchHeightEnabled(u),i=ccui.LayoutComponent.horizontalEdge.NONE,"LeftEdge"===d?i=ccui.LayoutComponent.horizontalEdge.LEFT:"RightEdge"===d?i=ccui.LayoutComponent.horizontalEdge.RIGHT:"BothEdge"===d&&(i=ccui.LayoutComponent.horizontalEdge.CENTER),t.setHorizontalEdge(i),i=ccui.LayoutComponent.verticalEdge.NONE,"TopEdge"===_?i=ccui.LayoutComponent.verticalEdge.TOP:"BottomEdge"===_?i=ccui.LayoutComponent.verticalEdge.BOTTOM:"BothEdge"===_&&(i=ccui.LayoutComponent.verticalEdge.CENTER),t.setVerticalEdge(i),t.setTopMargin(g),t.setBottomMargin(e),t.setLeftMargin(p),t.setRightMargin(f),t.setVerticalEdge(i),t.setTopMargin(g),t.setBottomMargin(e),t.setLeftMargin(p),t.setRightMargin(f))},l=(s.initPanel=function(t,e){var i=new ccui.Layout,n=(this.widgetAttributes(i,t),t.ClipAble||!1),s=(null!=n&&i.setClippingEnabled(n),n=o(t.ComboBoxIndex,0),i.setBackGroundColorType(n),null!=(n=o(t.BackColorAlpha,255))&&i.setBackGroundColorOpacity(n),null!=(n=t.Scale9Enable)&&i.setBackGroundImageScale9Enabled(n),o(t.Alpha,255));return i.setOpacity(s),u(t.FileData,e,function(t,e){i.setBackGroundImage(t,e)}),n?(i.setBackGroundImageCapInsets(cc.rect(t.Scale9OriginX||0,t.Scale9OriginY||0,t.Scale9Width||0,t.Scale9Height||0)),_(i,t.Size)):i.isIgnoreContentAdaptWithSize()||_(i,t.Size),a(i,t.SingleColor,t.FirstColor,t.EndColor),c(i,t.ColorVector),i},s.initText=function(t,e){var i=new ccui.Text,n=(null!=(n=t.TouchScaleChangeAble)&&i.setTouchScaleChangeEnabled(n),null!=(n=t.LabelText)&&i.setString(n),null!=(n=t.FontSize)&&i.setFontSize(n),null!=(n=t.FontName)&&i.setFontName(n),t.AreaWidth),s=t.areaHeight;switch(n&&s&&i.setTextAreaSize(cc.size(n,s)),n=t.HorizontalAlignmentType||"HT_Left"){case"HT_Right":n=2;break;case"HT_Center":n=1;break;default:n=0}switch(i.setTextHorizontalAlignment(n),n=t.VerticalAlignmentType||"VT_Top"){case"VT_Bottom":n=2;break;case"VT_Center":n=1;break;default:n=0}return i.setTextVerticalAlignment(n),null!=(n=t.FontResource)&&null!=(n=n.Path)&&(n=cc.sys.isNative?cc.path.join(cc.loader.resPath,e,n):(n=n.match(/([^\/]+)\.(\S+)/))?n[1]:"",i.setFontName(n)),t.OutlineEnabled&&t.OutlineColor&&i.enableOutline&&i.enableOutline(d(t.OutlineColor),o(t.OutlineSize,1)),t.ShadowEnabled&&t.ShadowColor&&i.enableShadow&&i.enableShadow(d(t.ShadowColor),cc.size(o(t.ShadowOffsetX,2),o(t.ShadowOffsetY,-2)),t.ShadowBlurRadius||0),null!=(n=t.IsCustomSize)&&i.ignoreContentAdaptWithSize(!n),i.setUnifySizeEnabled(!1),n=t.CColor,t.CColor=null,i.setTextColor(d(n)),this.widgetAttributes(i,t,i.isIgnoreContentAdaptWithSize()),t.CColor=n,i},s.initButton=function(t,e){var i=new ccui.Button,n=(u(t.NormalFileData,e,function(t,e){i.loadTextureNormal(t,e)}),u(t.PressedFileData,e,function(t,e){i.loadTexturePressed(t,e)}),u(t.DisabledFileData,e,function(t,e){i.loadTextureDisabled(t,e)}),o(t.Scale9Enable,!1)),s=(n&&i.setScale9Enabled(n),t.ButtonText);return null!=s&&i.setTitleText(s),null!=(s=t.FontSize)&&i.setTitleFontSize(s),null!=(s=t.FontName)&&i.setTitleFontName(s),null!=(s=t.TextColor)&&i.setTitleColor(d(s)),s=o(t.DisplayState,!0),i.setBright(s),i.setEnabled(s),null!=(s=t.FontResource)&&null!=(s=s.Path)&&(s=cc.sys.isNative?cc.path.join(cc.loader.resPath,e,s):(s=s.match(/([^\/]+)\.(\S+)/))?s[1]:"",i.setTitleFontName(s)),(s=i.getTitleRenderer())&&t.ShadowEnabled&&t.ShadowColor&&s.enableShadow&&s.enableShadow(d(t.ShadowColor),cc.size(o(t.ShadowOffsetX,2),o(t.ShadowOffsetY,-2)),t.ShadowBlurRadius||0),s&&t.OutlineEnabled&&t.OutlineColor&&s.enableStroke&&s.enableStroke(d(t.OutlineColor),o(t.OutlineSize,1)),this.widgetAttributes(i,t),n&&(i.setUnifySizeEnabled(!1),i.ignoreContentAdaptWithSize(!1),n=cc.rect(t.Scale9OriginX||0,t.Scale9OriginY||0,t.Scale9Width||0,t.Scale9Height||0),i.setCapInsets(n)),_(i,t.Size),i},s.initCheckBox=function(t,e){var n=new ccui.CheckBox,i=(this.widgetAttributes(n,t),[{name:"NormalBackFileData",handle:n.loadTextureBackGround},{name:"PressedBackFileData",handle:n.loadTextureBackGroundSelected},{name:"NodeNormalFileData",handle:n.loadTextureFrontCross},{name:"DisableBackFileData",handle:n.loadTextureBackGroundDisabled},{name:"NodeDisableFileData",handle:n.loadTextureFrontCrossDisabled}].forEach(function(i){u(t[i.name],e,function(t,e){i.handle.call(n,t,e)})}),o(t.CheckedState,!1));return n.setSelected(i),i=o(t.DisplayState,!0),n.setBright(i),n.setEnabled(i),n},s.initScrollView=function(t,e){var i=new ccui.ScrollView,e=(this.widgetAttributes(i,t),u(t.FileData,e,function(t,e){i.setBackGroundImage(t,e)}),i.setClippingEnabled(t.ClipAble||!1),o(t.ComboBoxIndex,0));return i.setBackGroundColorType(e),null!=(e=t.BackColorAlpha)&&i.setBackGroundColorOpacity(e),t.Scale9Enable?(i.setBackGroundImageScale9Enabled(!0),i.setBackGroundImageCapInsets(cc.rect(t.Scale9OriginX||0,t.Scale9OriginY||0,t.Scale9Width||0,t.Scale9Height||0)),_(i,t.Size)):i.isIgnoreContentAdaptWithSize()||_(i,t.Size),a(i,t.SingleColor,t.FirstColor,t.EndColor),c(i,t.ColorVector),e=t.InnerNodeSize,e=cc.size(e.Width||0,e.Height||0),i.setInnerContainerSize(e),e=0,"Vertical"===t.ScrollDirectionType&&(e=1),"Horizontal"===t.ScrollDirectionType&&(e=2),"Vertical_Horizontal"===t.ScrollDirectionType&&(e=3),i.setDirection(e),e=o(t.IsBounceEnabled,!1),i.setBounceEnabled(e),i},s.initImageView=function(t,e){var i=new ccui.ImageView;return u(t.FileData,e,function(t,e){i.loadTexture(t,e)}),u(t.ImageFileData,e,function(t,e){i.loadTexture(t,e)}),t.Scale9Enable?(i.setScale9Enabled(!0),i.setUnifySizeEnabled(!1),i.ignoreContentAdaptWithSize(!1),i.setCapInsets(cc.rect(t.Scale9OriginX||0,t.Scale9OriginY||0,t.Scale9Width||0,t.Scale9Height||0))):_(i,t.Size),this.widgetAttributes(i,t),i},s.initLoadingBar=function(t,e){var i=new ccui.LoadingBar,e=(this.widgetAttributes(i,t),u(t.ImageFileData,e,function(t,e){i.loadTexture(t,e)}),i.setDirection("Right_To_Left"===t.ProgressType?1:0),o(t.ProgressInfo,80));return null!=e&&i.setPercent(e),i},s.initSlider=function(t,e){var n=new ccui.Slider,s=cc.loader,i=(this.widgetAttributes(n,t),[{name:"BackGroundData",handle:n.loadBarTexture},{name:"BallNormalData",handle:n.loadSlidBallTextureNormal},{name:"BallPressedData",handle:n.loadSlidBallTexturePressed},{name:"BallDisabledData",handle:n.loadSlidBallTextureDisabled},{name:"ProgressBarData",handle:n.loadProgressBarTexture}].forEach(function(i){u(t[i.name],e,function(t,e){0!==e||s.getRes(t)||cc.log("%s need to be preloaded",t),i.handle.call(n,t,e)})}),n.setPercent(t.PercentInfo||0),o(t.DisplayState,!0));return n.setBright(i),n.setEnabled(i),n},s.initPageView=function(t,e){var i=new ccui.PageView,e=(this.widgetAttributes(i,t),u(t.FileData,e,function(t,e){i.setBackGroundImage(t,e)}),i.setClippingEnabled(t.ClipAble||!1),t.Scale9Enable&&(i.setBackGroundImageScale9Enabled(!0),i.setBackGroundImageCapInsets(cc.rect(t.Scale9OriginX||0,t.Scale9OriginY||0,t.Scale9Width||0,t.Scale9Height||0))),o(t.ComboBoxIndex,0));return i.setBackGroundColorType(e),a(i,t.SingleColor,t.FirstColor,t.EndColor),c(i,t.ColorVector),null!=(e=t.BackColorAlpha)&&i.setBackGroundColorOpacity(e),_(i,t.Size),i},s.initListView=function(t,e){var i=new ccui.ListView,e=(this.widgetAttributes(i,t),u(t.FileData,e,function(t,e){i.setBackGroundImage(t,e)}),i.setClippingEnabled(t.ClipAble||!1),o(t.ComboBoxIndex,0)),n=(i.setBackGroundColorType(e),e=o(t.BackColorAlpha,255),t.Scale9Enable&&(i.setBackGroundImageScale9Enabled(!0),i.setBackGroundImageCapInsets(cc.rect(t.Scale9OriginX||0,t.Scale9OriginY||0,t.Scale9Width||0,t.Scale9Height||0))),o(t.DirectionType,ccui.ListView.DIR_HORIZONTAL)),s=o(t.VerticalType,"Align_Left"),r=o(t.HorizontalType,"Align_Top");return n?"Vertical"===n&&(i.setDirection(ccui.ScrollView.DIR_VERTICAL),""===r?i.setGravity(ccui.ListView.GRAVITY_LEFT):"Align_Right"===r?i.setGravity(ccui.ListView.GRAVITY_RIGHT):"Align_HorizontalCenter"===r&&i.setGravity(ccui.ListView.GRAVITY_CENTER_HORIZONTAL)):(i.setDirection(ccui.ScrollView.DIR_HORIZONTAL),"Align_Bottom"===s?i.setGravity(ccui.ListView.GRAVITY_BOTTOM):"Align_VerticalCenter"===s?i.setGravity(ccui.ListView.GRAVITY_CENTER_VERTICAL):i.setGravity(ccui.ListView.GRAVITY_TOP)),n=o(t.IsBounceEnabled,!1),i.setBounceEnabled(n),i.setItemsMargin(t.ItemMargin||0),null!=(n=t.InnerNodeSize)&&i.setInnerContainerSize(cc.size(n.Widget||0,n.Height||0)),a(i,t.SingleColor,t.FirstColor,t.EndColor),c(i,t.ColorVector),null!=e&&i.setBackGroundColorOpacity(e),_(i,t.Size),i},s.initTextAtlas=function(t,e){var i=new ccui.TextAtlas,n=t.LabelText,s=t.CharWidth,r=t.CharHeight,o=t.StartChar;return u(t.LabelAtlasFileImage_CNB,e,function(t,e){cc.loader.getRes(t)||cc.log("%s need to be preloaded",t),0===e&&i.setProperty(n,t,s,r,o)}),this.widgetAttributes(i,t),i.ignoreContentAdaptWithSize(!0),i},s.initTextBMFont=function(t,e){var i=new ccui.TextBMFont;return this.widgetAttributes(i,t),u(t.LabelBMFontFile_CNB,e,function(t,e){cc.loader.getRes(t)||cc.log("%s need to be pre loaded",t),i.setFntFile(t)}),i.setString(t.LabelText),i.ignoreContentAdaptWithSize(!0),i},s.initTextField=function(t,e){var i=new ccui.TextField,n=(t.PasswordEnable&&(i.setPasswordEnabled(!0),i.setPasswordStyleText(t.PasswordStyleText||"*")),t.PlaceHolderText);return null!=n&&i.setPlaceHolder(n),null!=(n=t.FontSize)&&i.setFontSize(n),null!=(n=t.FontName)&&i.setFontName(n),t.MaxLengthEnable&&(i.setMaxLengthEnabled(!0),i.setMaxLength(t.MaxLengthText||0)),this.widgetAttributes(i,t),null!=(n=t.LabelText)&&i.setString(n),null!=(n=t.FontResource)&&null!=(n=n.Path)&&(n=cc.sys.isNative?cc.path.join(cc.loader.resPath,e,n):(n=n.match(/([^\/]+)\.(\S+)/))?n[1]:"",i.setFontName(n)),i.setUnifySizeEnabled(!1),i.ignoreContentAdaptWithSize(!1),null!=(n=t.CColor)&&i.setTextColor(d(n)),i.isIgnoreContentAdaptWithSize()||(_(i,t.Size),cc.sys.isNative&&i.getVirtualRenderer().setLineBreakWithoutSpace(!0)),i},s.initSimpleAudio=function(t,e){var i=new ccs.ComAudio;i.setLoop(t.Loop||!1),u(t.FileData,e,function(t,e){i.setFile(t)})},s.initGameMap=function(i,t){var n=null;return u(i.FileData,t,function(t,e){0===e&&(n=new cc.TMXTiledMap(t)),s.generalAttributes(n,i)}),n},s.initProjectNode=function(t,e){var i=t.FileData;if(null!=i&&i.Path){if(i=e+i.Path,cc.loader.getRes(i))return i=ccs.load(i,e),s.generalAttributes(i.node,t),i.action&&i.node&&(i.action.tag=i.node.tag,void 0!==(e=t.InnerActionSpeed)&&i.action.setTimeSpeed(e),i.node.runAction(i.action),i.action.gotoFrameAndPause(0)),i.node;cc.log("%s need to be preloaded",i)}},s.initArmature=function(t,e){var r=new ccs.Armature,o=t.IsLoop,a=t.IsAutoPlay,c=t.CurrentAnimationName;return u(t.FileData,e,function(t,e){var i,n,s=cc.loader.getRes(t);s?(i=s.config_file_path,n=s.config_png_path,i.forEach(function(t,e){n[e]&&cc.spriteFrameCache.addSpriteFrames(t,n[e])})):cc.log("%s need to be preloaded",t),ccs.armatureDataManager.addArmatureFileInfo(t),r.init((s=(s=t)&&s.match(/([^\/]+)\.[^\/]+$/))&&s[1]?s[1]:""),a?r.getAnimation().play(c,-1,o):(r.getAnimation().play(c),r.getAnimation().gotoAndPause(0))}),delete t.AnchorPoint,delete t.Size,s.generalAttributes(r,t),r.setColor(d(t.CColor)),r},s.initBoneNode=function(t,e){var i=new ccs.BoneNode,n=t.Length;return void 0!==n&&i.setDebugDrawLength(n),(n=t.BlendFunc)&&void 0!==n.Src&&void 0!==n.Dst&&i.setBlendFunc(new cc.BlendFunc(n.Src,n.Dst)),s.generalAttributes(i,t),!(n=t.CColor)||void 0===n.R&&void 0===n.G&&void 0===n.B||i.setColor(d(n)),i},s.initSkeletonNode=function(t){var e=new ccs.SkeletonNode;return s.generalAttributes(e,t),!(t=t.CColor)||void 0===t.R&&void 0===t.G&&void 0===t.B||e.setColor(d(t)),e},{}),u=function(t,e,i){var n,s;null!=t&&(n=t.Path,s="Default"===t.Type||"Normal"===t.Type?0:1,(t=t.Plist)&&(cc.loader.getRes(e+t)?(l[e+t]=!0,cc.spriteFrameCache.addSpriteFrames(e+t)):l[e+t]||cc.spriteFrameCache.getSpriteFrame(n)||cc.log("%s need to be preloaded",e+t)),0!=s?cc.spriteFrameCache.getSpriteFrame(n)?i(n,s):cc.log("failed to get spriteFrame: %s",n):i(e+n,s))},d=function(t){if(t)return cc.color(null!=t.R?t.R:255,null!=t.G?t.G:255,null!=t.B?t.B:255,null!=t.A?t.A:255)},_=function(t,e){var i=e.X||0,n=e.Y||0;e&&t.setContentSize(cc.size(i,n))};[{name:"SingleNodeObjectData",handle:s.initSingleNode},{name:"NodeObjectData",handle:s.initSingleNode},{name:"LayerObjectData",handle:s.initSingleNode},{name:"GameNodeObjectData",handle:s.initSingleNode},{name:"GameLayerObjectData",handle:s.initSingleNode},{name:"SpriteObjectData",handle:s.initSprite},{name:"ParticleObjectData",handle:s.initParticle},{name:"PanelObjectData",handle:s.initPanel},{name:"TextObjectData",handle:s.initText},{name:"ButtonObjectData",handle:s.initButton},{name:"CheckBoxObjectData",handle:s.initCheckBox},{name:"ScrollViewObjectData",handle:s.initScrollView},{name:"ImageViewObjectData",handle:s.initImageView},{name:"LoadingBarObjectData",handle:s.initLoadingBar},{name:"SliderObjectData",handle:s.initSlider},{name:"PageViewObjectData",handle:s.initPageView},{name:"ListViewObjectData",handle:s.initListView},{name:"TextAtlasObjectData",handle:s.initTextAtlas},{name:"TextBMFontObjectData",handle:s.initTextBMFont},{name:"TextFieldObjectData",handle:s.initTextField},{name:"SimpleAudioObjectData",handle:s.initSimpleAudio},{name:"GameMapObjectData",handle:s.initGameMap},{name:"ProjectNodeObjectData",handle:s.initProjectNode},{name:"ArmatureNodeObjectData",handle:s.initArmature},{name:"BoneNodeObjectData",handle:s.initBoneNode},{name:"SkeletonNodeObjectData",handle:s.initSkeletonNode}].forEach(function(n){s.registerParser(n.name,function(t,e){var i=n.handle.call(this,t,e);return this.parseChild(i,t.Children,e),i})}),t.registerParser("timeline","2.*",s),t.registerParser("timeline","*",s)}(ccs._load),!function(){ccs.uiReader={_fileDesignSizes:{},widgetFromJsonFile:function(t){(e=cc.loader.getRes(t))&&(this._fileDesignSizes[t]=cc.size(e.designWidth||0,e.designHeight||0));var e=e.Version||e.version,i=ccs.uiReader.getVersionInteger(e);return!e||1700<=i?(cc.warn("Not supported file types, Please try use the ccs.load"),null):ccs._load(t,"ccui")},registerTypeAndCallBack:function(r,o,a,t){var e=ccs._load.getParser("ccui")["*"],c=t.bind(a);e.registerParser(r,function(t,e){var i=new o,n=t.options;a.setPropsFromJsonDictionary&&a.setPropsFromJsonDictionary(i,n),this.generalAttributes(i,n);var s=(s=n.customProperty)?JSON.parse(s):{};return c(r,i,s),this.colorAttributes(i,n),this.anchorPointAttributes(i,n),this.parseChild.call(this,i,t,e),i})},getVersionInteger:function(t){var i;return!t||"string"!=typeof t||4!==(t=t.split(".")).length?0:(i=0,t.forEach(function(t,e){i+=t*Math.pow(10,3-e)}),i)},storeFileDesignSize:function(t,e){this._fileDesignSizes[t]=e},getFileDesignSize:function(t){return this._fileDesignSizes[t]},getFilePath:function(){return this._filePath},setFilePath:function(t){this._filePath=t},getParseObjectMap:function(){return ccs._load.getParser("ccui")["*"].parsers},getParseCallBackMap:function(){return ccs._load.getParser("ccui")["*"].parsers},clear:function(){}};var t=ccs._load.getParser("ccui")["*"];ccs.imageViewReader={setPropsFromJsonDictionary:t.ImageViewAttributes},ccs.buttonReader={setPropsFromJsonDictionary:t.ButtonAttributes},ccs.checkBoxReader={setPropsFromJsonDictionary:t.CheckBoxAttributes},ccs.labelAtlasReader={setPropsFromJsonDictionary:t.TextAtlasAttributes},ccs.labelBMFontReader={setPropsFromJsonDictionary:t.TextBMFontAttributes},ccs.labelReader={setPropsFromJsonDictionary:t.TextAttributes},ccs.layoutReader={setPropsFromJsonDictionary:t.LayoutAttributes},ccs.listViewReader={setPropsFromJsonDictionary:t.ListViewAttributes},ccs.loadingBarReader={setPropsFromJsonDictionary:t.LoadingBarAttributes},ccs.pageViewReader={setPropsFromJsonDictionary:t.PageViewAttributes},ccs.scrollViewReader={setPropsFromJsonDictionary:t.ScrollViewAttributes},ccs.sliderReader={setPropsFromJsonDictionary:t.SliderAttributes},ccs.textFieldReader={setPropsFromJsonDictionary:t.TextFieldAttributes}}(),ccs.sceneReader={_node:null,createNodeWithSceneFile:function(t){return this._node=t=ccs._load(t,"scene")},getNodeByTag:function(t){return null==this._node?null:this._node.getTag()===t?this._node:this._nodeByTag(this._node,t)},_nodeByTag:function(t,e){if(null==t)return null;for(var i=null,n=t.getChildren(),s=0;s<n.length&&(!(i=n[s])||i.getTag()!==e)&&!(i=this._nodeByTag(i,e));s++);return i},version:function(){return"*"},setTarget:function(){},clear:function(){ccs.triggerManager.removeAll(),cc.audioEngine.end()}},this&&this.__extends||function(){var n=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])});return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}()),spine,sp=(!function(u){e.prototype.apply=function(t,e,i,n,s,r,o,a){if(null==t)throw Error("skeleton cannot be null.");n&&0!=this.duration&&(i%=this.duration,0<e)&&(e%=this.duration);for(var c=0,h=(n=this.timelines).length;c<h;c++)n[c].apply(t,e,i,s,r,o,a)},e.binarySearch=function(t,e,i){var n=0,s=t.length/(i=void 0===i?1:i)-2;if(0==s)return i;for(var r=s>>>1;;){if(t[(r+1)*i]<=e?n=r+1:s=r,n==s)return(n+1)*i;r=n+s>>>1}},e.linearSearch=function(t,e,i){for(var n=0,s=t.length-i;n<=s;n+=i)if(t[n]>e)return n;return-1};var p,l,t,f=e;function e(t,e,i){if(null==t)throw Error("name cannot be null.");if(null==e)throw Error("timelines cannot be null.");this.name=t,this.timelines=e,this.duration=i}u.Animation=f,(s=p=u.MixPose||(u.MixPose={}))[s.setup=0]="setup",s[s.current=1]="current",s[s.currentLayered=2]="currentLayered",(s=l=u.MixDirection||(u.MixDirection={}))[s.in=0]="in",s[s.out=1]="out",(s=t=u.TimelineType||(u.TimelineType={}))[s.rotate=0]="rotate",s[s.translate=1]="translate",s[s.scale=2]="scale",s[s.shear=3]="shear",s[s.attachment=4]="attachment",s[s.color=5]="color",s[s.deform=6]="deform",s[s.event=7]="event",s[s.drawOrder=8]="drawOrder",s[s.ikConstraint=9]="ikConstraint",s[s.transformConstraint=10]="transformConstraint",s[s.pathConstraintPosition=11]="pathConstraintPosition",s[s.pathConstraintSpacing=12]="pathConstraintSpacing",s[s.pathConstraintMix=13]="pathConstraintMix",s[s.twoColor=14]="twoColor";d.prototype.getFrameCount=function(){return this.curves.length/d.BEZIER_SIZE+1},d.prototype.setLinear=function(t){this.curves[t*d.BEZIER_SIZE]=d.LINEAR},d.prototype.setStepped=function(t){this.curves[t*d.BEZIER_SIZE]=d.STEPPED},d.prototype.getCurveType=function(t){return(t*=d.BEZIER_SIZE)==this.curves.length||(t=this.curves[t])==d.LINEAR?d.LINEAR:t==d.STEPPED?d.STEPPED:d.BEZIER},d.prototype.setCurve=function(t,e,i,n,s){var r=.03*(2*-i+s),o=2*(c=.03*(2*-e+n))+(n=.006*(3*(e-n)+1)),a=2*r+(s=.006*(3*(i-s)+1));e=.3*e+c+.16666667*n,i=.3*i+r+.16666667*s,t*=d.BEZIER_SIZE,(r=this.curves)[t++]=d.BEZIER;for(var c=e,h=i,l=t+d.BEZIER_SIZE-1;t<l;t+=2)r[t]=c,r[t+1]=h,e+=o,i+=a,o+=n,a+=s,c+=e,h+=i},d.prototype.getCurvePercent=function(t,e){e=u.MathUtils.clamp(e,0,1);var i=this.curves,n=t*d.BEZIER_SIZE;if((r=i[n])==d.LINEAR)return e;if(r==d.STEPPED)return 0;for(var s,r=0,o=++n,a=n+d.BEZIER_SIZE-1;n<a;n+=2)if(e<=(r=i[n]))return s=a=void 0,(s=n==o?a=0:(a=i[n-2],i[n-1]))+(i[n+1]-s)*(e-a)/(r-a);return(i=i[n-1])+(1-i)*(e-r)/(1-r)};var i,n,s=d;function d(t){if(t<=0)throw Error("frameCount must be > 0: "+t);this.curves=u.Utils.newFloatArray((t-1)*d.BEZIER_SIZE)}function c(t){var e=i.call(this,t)||this;return e.frames=u.Utils.newFloatArray(t<<1),e}function h(t){var e=n.call(this,t)||this;return e.frames=u.Utils.newFloatArray(t*h.ENTRIES),e}s.LINEAR=0,s.STEPPED=1,s.BEZIER=2,s.BEZIER_SIZE=19,u.CurveTimeline=s,__extends(c,i=s),c.prototype.getPropertyId=function(){return(t.rotate<<24)+this.boneIndex},c.prototype.setFrame=function(t,e,i){this.frames[t<<=1]=e,this.frames[t+c.ROTATION]=i},c.prototype.apply=function(t,e,i,n,s,r,o){var a;if(e=this.frames,t=t.bones[this.boneIndex],i<e[0])switch(r){case p.setup:t.rotation=t.data.rotation;break;case p.current:r=t.data.rotation-t.rotation,t.rotation+=(r-360*(16384-(16384.499999999996-r/360|0)))*s}else i>=e[e.length-c.ENTRIES]?r==p.setup?t.rotation=t.data.rotation+e[e.length+c.PREV_ROTATION]*s:(r=t.data.rotation+e[e.length+c.PREV_ROTATION]-t.rotation,t.rotation+=(r-360*(16384-(16384.499999999996-r/360|0)))*s):(n=e[(o=f.binarySearch(e,i,c.ENTRIES))+c.PREV_ROTATION],a=e[o],i=this.getCurvePercent((o>>1)-1,1-(i-a)/(e[o+c.PREV_TIME]-a)),e=n+((e=e[o+c.ROTATION]-n)-360*(16384-(16384.499999999996-e/360|0)))*i,r==p.setup?t.rotation=t.data.rotation+(e-=360*(16384-(16384.499999999996-e/360|0)))*s:(e=t.data.rotation+e-t.rotation,t.rotation+=(e-=360*(16384-(16384.499999999996-e/360|0)))*s))},(F=c).ENTRIES=2,F.PREV_TIME=-2,F.PREV_ROTATION=-1,F.ROTATION=1,u.RotateTimeline=F,__extends(h,n=s),h.prototype.getPropertyId=function(){return(t.translate<<24)+this.boneIndex},h.prototype.setFrame=function(t,e,i,n){this.frames[t*=h.ENTRIES]=e,this.frames[t+h.X]=i,this.frames[t+h.Y]=n},h.prototype.apply=function(t,e,i,n,s,r,o){var a,c;if(e=this.frames,t=t.bones[this.boneIndex],i<e[0])switch(r){case p.setup:t.x=t.data.x,t.y=t.data.y;break;case p.current:t.x+=(t.data.x-t.x)*s,t.y+=(t.data.y-t.y)*s}else o=n=0,i>=e[e.length-h.ENTRIES]?(n=e[e.length+h.PREV_X],o=e[e.length+h.PREV_Y]):(n=e[(a=f.binarySearch(e,i,h.ENTRIES))+h.PREV_X],o=e[a+h.PREV_Y],c=e[a],i=this.getCurvePercent(a/h.ENTRIES-1,1-(i-c)/(e[a+h.PREV_TIME]-c)),n+=(e[a+h.X]-n)*i,o+=(e[a+h.Y]-o)*i),r==p.setup?(t.x=t.data.x+n*s,t.y=t.data.y+o*s):(t.x+=(t.data.x+n-t.x)*s,t.y+=(t.data.y+o-t.y)*s)},(F=h).ENTRIES=3,F.PREV_TIME=-3,F.PREV_X=-2,F.PREV_Y=-1,F.X=1,F.Y=2,u.TranslateTimeline=F;__extends(g,r=F),g.prototype.getPropertyId=function(){return(t.scale<<24)+this.boneIndex},g.prototype.apply=function(t,e,i,n,s,r,o){var a,c,h=this.frames;if(t=t.bones[this.boneIndex],i<h[0])switch(r){case p.setup:t.scaleX=t.data.scaleX,t.scaleY=t.data.scaleY;break;case p.current:t.scaleX+=(t.data.scaleX-t.scaleX)*s,t.scaleY+=(t.data.scaleY-t.scaleY)*s}else n=e=0,n=i>=h[h.length-g.ENTRIES]?(e=h[h.length+g.PREV_X]*t.data.scaleX,h[h.length+g.PREV_Y]*t.data.scaleY):(e=h[(a=f.binarySearch(h,i,g.ENTRIES))+g.PREV_X],n=h[a+g.PREV_Y],c=h[a],i=this.getCurvePercent(a/g.ENTRIES-1,1-(i-c)/(h[a+g.PREV_TIME]-c)),e=(e+(h[a+g.X]-e)*i)*t.data.scaleX,(n+(h[a+g.Y]-n)*i)*t.data.scaleY),1==s?(t.scaleX=e,t.scaleY=n):(h=i=0,h=(r==p.setup?(i=t.data.scaleX,t.data):(i=t.scaleX,t)).scaleY,o==l.out?(e=Math.abs(e)*u.MathUtils.signum(i),n=Math.abs(n)*u.MathUtils.signum(h)):(i=Math.abs(i)*u.MathUtils.signum(e),h=Math.abs(h)*u.MathUtils.signum(n)),t.scaleX=i+(e-i)*s,t.scaleY=h+(n-h)*s)};var r,o,a,_,M=g;function g(t){return r.call(this,t)||this}function m(t){return o.call(this,t)||this}function y(t){var e=a.call(this,t)||this;return e.frames=u.Utils.newFloatArray(t*y.ENTRIES),e}function T(t){var e=_.call(this,t)||this;return e.frames=u.Utils.newFloatArray(t*T.ENTRIES),e}function S(t){this.frames=u.Utils.newFloatArray(t),this.attachmentNames=Array(t)}u.ScaleTimeline=M,__extends(m,o=F),m.prototype.getPropertyId=function(){return(t.shear<<24)+this.boneIndex},m.prototype.apply=function(t,e,i,n,s,r,o){var a,c;if(e=this.frames,t=t.bones[this.boneIndex],i<e[0])switch(r){case p.setup:t.shearX=t.data.shearX,t.shearY=t.data.shearY;break;case p.current:t.shearX+=(t.data.shearX-t.shearX)*s,t.shearY+=(t.data.shearY-t.shearY)*s}else o=n=0,i>=e[e.length-m.ENTRIES]?(n=e[e.length+m.PREV_X],o=e[e.length+m.PREV_Y]):(n=e[(a=f.binarySearch(e,i,m.ENTRIES))+m.PREV_X],o=e[a+m.PREV_Y],c=e[a],i=this.getCurvePercent(a/m.ENTRIES-1,1-(i-c)/(e[a+m.PREV_TIME]-c)),n+=(e[a+m.X]-n)*i,o+=(e[a+m.Y]-o)*i),r==p.setup?(t.shearX=t.data.shearX+n*s,t.shearY=t.data.shearY+o*s):(t.shearX+=(t.data.shearX+n-t.shearX)*s,t.shearY+=(t.data.shearY+o-t.shearY)*s)},F=m,u.ShearTimeline=F,__extends(y,a=s),y.prototype.getPropertyId=function(){return(t.color<<24)+this.slotIndex},y.prototype.setFrame=function(t,e,i,n,s,r){this.frames[t*=y.ENTRIES]=e,this.frames[t+y.R]=i,this.frames[t+y.G]=n,this.frames[t+y.B]=s,this.frames[t+y.A]=r},y.prototype.apply=function(t,e,i,n,s,r,o){t=t.slots[this.slotIndex];var a=this.frames;if(i<a[0])switch(r){case p.setup:t.color.setFromColor(t.data.color);break;case p.current:i=t.color,r=t.data.color,i.add((r.r-i.r)*s,(r.g-i.g)*s,(r.b-i.b)*s,(r.a-i.a)*s)}else{var c,h,l=o=n=e=0;i>=a[a.length-y.ENTRIES]?(e=a[(i=a.length)+y.PREV_R],n=a[i+y.PREV_G],o=a[i+y.PREV_B],l=a[i+y.PREV_A]):(e=a[(c=f.binarySearch(a,i,y.ENTRIES))+y.PREV_R],n=a[c+y.PREV_G],o=a[c+y.PREV_B],l=a[c+y.PREV_A],h=a[c],i=this.getCurvePercent(c/y.ENTRIES-1,1-(i-h)/(a[c+y.PREV_TIME]-h)),e+=(a[c+y.R]-e)*i,n+=(a[c+y.G]-n)*i,o+=(a[c+y.B]-o)*i,l+=(a[c+y.A]-l)*i),1==s?t.color.set(e,n,o,l):(i=t.color,r==p.setup&&i.setFromColor(t.data.color),i.add((e-i.r)*s,(n-i.g)*s,(o-i.b)*s,(l-i.a)*s))}},(F=y).ENTRIES=5,F.PREV_TIME=-5,F.PREV_R=-4,F.PREV_G=-3,F.PREV_B=-2,F.PREV_A=-1,F.R=1,F.G=2,F.B=3,F.A=4,u.ColorTimeline=F,__extends(T,_=s),T.prototype.getPropertyId=function(){return(t.twoColor<<24)+this.slotIndex},T.prototype.setFrame=function(t,e,i,n,s,r,o,a,c){this.frames[t*=T.ENTRIES]=e,this.frames[t+T.R]=i,this.frames[t+T.G]=n,this.frames[t+T.B]=s,this.frames[t+T.A]=r,this.frames[t+T.R2]=o,this.frames[t+T.G2]=a,this.frames[t+T.B2]=c},T.prototype.apply=function(t,e,i,n,s,r,o){t=t.slots[this.slotIndex];var a=this.frames;if(i<a[0])switch(r){case p.setup:t.color.setFromColor(t.data.color),t.darkColor.setFromColor(t.data.darkColor);break;case p.current:i=t.color,a=t.darkColor,r=t.data.color,t=t.data.darkColor,i.add((r.r-i.r)*s,(r.g-i.g)*s,(r.b-i.b)*s,(r.a-i.a)*s),a.add((t.r-a.r)*s,(t.g-a.g)*s,(t.b-a.b)*s,0)}else{var c,h,l=o=n=e=0,u=0,d=0,_=0;i>=a[a.length-T.ENTRIES]?(e=a[(i=a.length)+T.PREV_R],n=a[i+T.PREV_G],o=a[i+T.PREV_B],l=a[i+T.PREV_A],u=a[i+T.PREV_R2],d=a[i+T.PREV_G2],_=a[i+T.PREV_B2]):(e=a[(c=f.binarySearch(a,i,T.ENTRIES))+T.PREV_R],n=a[c+T.PREV_G],o=a[c+T.PREV_B],l=a[c+T.PREV_A],u=a[c+T.PREV_R2],d=a[c+T.PREV_G2],_=a[c+T.PREV_B2],h=a[c],i=this.getCurvePercent(c/T.ENTRIES-1,1-(i-h)/(a[c+T.PREV_TIME]-h)),e+=(a[c+T.R]-e)*i,n+=(a[c+T.G]-n)*i,o+=(a[c+T.B]-o)*i,l+=(a[c+T.A]-l)*i,u+=(a[c+T.R2]-u)*i,d+=(a[c+T.G2]-d)*i,_+=(a[c+T.B2]-_)*i),1==s?(t.color.set(e,n,o,l),t.darkColor.set(u,d,_,1)):(i=t.color,a=t.darkColor,r==p.setup&&(i.setFromColor(t.data.color),a.setFromColor(t.data.darkColor)),i.add((e-i.r)*s,(n-i.g)*s,(o-i.b)*s,(l-i.a)*s),a.add((u-a.r)*s,(d-a.g)*s,(_-a.b)*s,0))}},(F=T).ENTRIES=8,F.PREV_TIME=-8,F.PREV_R=-7,F.PREV_G=-6,F.PREV_B=-5,F.PREV_A=-4,F.PREV_R2=-3,F.PREV_G2=-2,F.PREV_B2=-1,F.R=1,F.G=2,F.B=3,F.A=4,F.R2=5,F.G2=6,F.B2=7,u.TwoColorTimeline=F,S.prototype.getPropertyId=function(){return(t.attachment<<24)+this.slotIndex},S.prototype.getFrameCount=function(){return this.frames.length},S.prototype.setFrame=function(t,e,i){this.frames[t]=e,this.attachmentNames[t]=i},S.prototype.apply=function(t,e,i,n,s,r,o){e=t.slots[this.slotIndex],o==l.out&&r==p.setup?(i=e.data.attachmentName,e.setAttachment(null==i?null:t.getAttachment(this.slotIndex,i))):i<(o=this.frames)[0]?r==p.setup&&(i=e.data.attachmentName,e.setAttachment(null==i?null:t.getAttachment(this.slotIndex,i))):(r=0,r=i>=o[o.length-1]?o.length-1:f.binarySearch(o,i,1)-1,i=this.attachmentNames[r],t.slots[this.slotIndex].setAttachment(null==i?null:t.getAttachment(this.slotIndex,i)))},F=S,u.AttachmentTimeline=F;var C,E,I,v,b,O,A=null,F=(__extends(x,C=s),x.prototype.getPropertyId=function(){return(t.deform<<27)+ +this.attachment.id+this.slotIndex},x.prototype.setFrame=function(t,e,i){this.frames[t]=e,this.frameVertices[t]=i},x.prototype.apply=function(t,e,i,n,s,r,o){var a=(e=t.slots[this.slotIndex]).getAttachment();if(a instanceof u.VertexAttachment&&a.applyDeform(this.attachment)){t=(o=this.frameVertices)[0].length,e=u.Utils.setArraySize(e.attachmentVertices,t);var c=this.frames;if(i<c[0])switch(r){case p.setup:null==a.bones?s=a.vertices:(s=A).length<t&&(A=s=u.Utils.newFloatArray(t)),u.Utils.arrayCopy(s,0,e,0,t);break;case p.current:if(1!=s)if(null==a.bones)for(n=a.vertices,r=0;r<t;r++)e[r]+=(n[r]-e[r])*s;else for(s=1-s,r=0;r<t;r++)e[r]*=s}else if(i>=c[c.length-1])if(n=o[c.length-1],1==s)u.Utils.arrayCopy(n,0,e,0,t);else if(r==p.setup)if(null==a.bones)for(o=a.vertices,i=0;i<t;i++)r=o[i],e[i]=r+(n[i]-r)*s;else for(r=0;r<t;r++)e[r]=n[r]*s;else for(r=0;r<t;r++)e[r]+=(n[r]-e[r])*s;else{var h=f.binarySearch(c,i),l=(n=o[h-1],o=o[h],c[h]);if(i=this.getCurvePercent(h-1,1-(i-l)/(c[h-1]-l)),1==s)for(s=0;s<t;s++)a=n[s],e[s]=a+(o[s]-a)*i;else if(r==p.setup)if(null==a.bones)for(c=a.vertices,h=0;h<t;h++)a=n[h],r=c[h],e[h]=r+(a+(o[h]-a)*i-r)*s;else for(r=0;r<t;r++)a=n[r],e[r]=(a+(o[r]-a)*i)*s;else for(r=0;r<t;r++)a=n[r],e[r]+=(a+(o[r]-a)*i-e[r])*s}}},x);function x(t){var e=C.call(this,t)||this;return e.frames=u.Utils.newFloatArray(t),e.frameVertices=Array(t),null==A&&(A=u.Utils.newFloatArray(64)),e}function P(t){this.frames=u.Utils.newFloatArray(t),this.events=Array(t)}function R(t){this.frames=u.Utils.newFloatArray(t),this.drawOrders=Array(t)}function L(t){var e=E.call(this,t)||this;return e.frames=u.Utils.newFloatArray(t*L.ENTRIES),e}function B(t){var e=I.call(this,t)||this;return e.frames=u.Utils.newFloatArray(t*B.ENTRIES),e}function D(t){var e=v.call(this,t)||this;return e.frames=u.Utils.newFloatArray(t*D.ENTRIES),e}function w(t){return b.call(this,t)||this}function N(t){var e=O.call(this,t)||this;return e.frames=u.Utils.newFloatArray(t*N.ENTRIES),e}u.DeformTimeline=F,P.prototype.getPropertyId=function(){return t.event<<24},P.prototype.getFrameCount=function(){return this.frames.length},P.prototype.setFrame=function(t,e){this.frames[t]=e.time,this.events[t]=e},P.prototype.apply=function(t,e,i,n,s,r,o){if(null!=n){var a=this.frames,c=this.frames.length;if(i<e)this.apply(t,e,Number.MAX_VALUE,n,s,r,o),e=-1;else if(e>=a[c-1])return;if(!(i<a[0])){if(e<a[t=0])t=0;else for(e=a[t=f.binarySearch(a,e)];0<t&&a[t-1]==e;)t--;for(;t<c&&i>=a[t];t++)n.push(this.events[t])}}},F=P,u.EventTimeline=F,R.prototype.getPropertyId=function(){return t.drawOrder<<24},R.prototype.getFrameCount=function(){return this.frames.length},R.prototype.setFrame=function(t,e,i){this.frames[t]=e,this.drawOrders[t]=i},R.prototype.apply=function(t,e,i,n,s,r,o){if(e=t.drawOrder,n=t.slots,o==l.out&&r==p.setup)u.Utils.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length);else if(i<(o=this.frames)[0])r==p.setup&&u.Utils.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length);else if(t=0,t=i>=o[o.length-1]?o.length-1:f.binarySearch(o,i)-1,null==(i=this.drawOrders[t]))u.Utils.arrayCopy(n,0,e,0,n.length);else for(t=0,r=i.length;t<r;t++)e[t]=n[i[t]]},F=R,u.DrawOrderTimeline=F,__extends(L,E=s),L.prototype.getPropertyId=function(){return(t.ikConstraint<<24)+this.ikConstraintIndex},L.prototype.setFrame=function(t,e,i,n){this.frames[t*=L.ENTRIES]=e,this.frames[t+L.MIX]=i,this.frames[t+L.BEND_DIRECTION]=n},L.prototype.apply=function(t,e,i,n,s,r,o){var a,c;if(e=this.frames,t=t.ikConstraints[this.ikConstraintIndex],i<e[0])switch(r){case p.setup:t.mix=t.data.mix,t.bendDirection=t.data.bendDirection;break;case p.current:t.mix+=(t.data.mix-t.mix)*s,t.bendDirection=t.data.bendDirection}else i>=e[e.length-L.ENTRIES]?r==p.setup?(t.mix=t.data.mix+(e[e.length+L.PREV_MIX]-t.data.mix)*s,t.bendDirection=o==l.out?t.data.bendDirection:e[e.length+L.PREV_BEND_DIRECTION]):(t.mix+=(e[e.length+L.PREV_MIX]-t.mix)*s,o==l.in&&(t.bendDirection=e[e.length+L.PREV_BEND_DIRECTION])):(a=e[(n=f.binarySearch(e,i,L.ENTRIES))+L.PREV_MIX],c=e[n],i=this.getCurvePercent(n/L.ENTRIES-1,1-(i-c)/(e[n+L.PREV_TIME]-c)),r==p.setup?(t.mix=t.data.mix+(a+(e[n+L.MIX]-a)*i-t.data.mix)*s,t.bendDirection=o==l.out?t.data.bendDirection:e[n+L.PREV_BEND_DIRECTION]):(t.mix+=(a+(e[n+L.MIX]-a)*i-t.mix)*s,o==l.in&&(t.bendDirection=e[n+L.PREV_BEND_DIRECTION])))},(F=L).ENTRIES=3,F.PREV_TIME=-3,F.PREV_MIX=-2,F.PREV_BEND_DIRECTION=-1,F.MIX=1,F.BEND_DIRECTION=2,u.IkConstraintTimeline=F,__extends(B,I=s),B.prototype.getPropertyId=function(){return(t.transformConstraint<<24)+this.transformConstraintIndex},B.prototype.setFrame=function(t,e,i,n,s,r){this.frames[t*=B.ENTRIES]=e,this.frames[t+B.ROTATE]=i,this.frames[t+B.TRANSLATE]=n,this.frames[t+B.SCALE]=s,this.frames[t+B.SHEAR]=r},B.prototype.apply=function(t,e,i,n,s,r,o){if(e=this.frames,t=t.transformConstraints[this.transformConstraintIndex],i<e[0])switch(i=t.data,r){case p.setup:t.rotateMix=i.rotateMix,t.translateMix=i.translateMix,t.scaleMix=i.scaleMix,t.shearMix=i.shearMix;break;case p.current:t.rotateMix+=(i.rotateMix-t.rotateMix)*s,t.translateMix+=(i.translateMix-t.translateMix)*s,t.scaleMix+=(i.scaleMix-t.scaleMix)*s,t.shearMix+=(i.shearMix-t.shearMix)*s}else{var a,c,h=o=n=0,l=0;i>=e[e.length-B.ENTRIES]?(n=e[(i=e.length)+B.PREV_ROTATE],o=e[i+B.PREV_TRANSLATE],h=e[i+B.PREV_SCALE],l=e[i+B.PREV_SHEAR]):(n=e[(a=f.binarySearch(e,i,B.ENTRIES))+B.PREV_ROTATE],o=e[a+B.PREV_TRANSLATE],h=e[a+B.PREV_SCALE],l=e[a+B.PREV_SHEAR],c=e[a],i=this.getCurvePercent(a/B.ENTRIES-1,1-(i-c)/(e[a+B.PREV_TIME]-c)),n+=(e[a+B.ROTATE]-n)*i,o+=(e[a+B.TRANSLATE]-o)*i,h+=(e[a+B.SCALE]-h)*i,l+=(e[a+B.SHEAR]-l)*i),r==p.setup?(i=t.data,t.rotateMix=i.rotateMix+(n-i.rotateMix)*s,t.translateMix=i.translateMix+(o-i.translateMix)*s,t.scaleMix=i.scaleMix+(h-i.scaleMix)*s,t.shearMix=i.shearMix+(l-i.shearMix)*s):(t.rotateMix+=(n-t.rotateMix)*s,t.translateMix+=(o-t.translateMix)*s,t.scaleMix+=(h-t.scaleMix)*s,t.shearMix+=(l-t.shearMix)*s)}},(F=B).ENTRIES=5,F.PREV_TIME=-5,F.PREV_ROTATE=-4,F.PREV_TRANSLATE=-3,F.PREV_SCALE=-2,F.PREV_SHEAR=-1,F.ROTATE=1,F.TRANSLATE=2,F.SCALE=3,F.SHEAR=4,u.TransformConstraintTimeline=F,__extends(D,v=s),D.prototype.getPropertyId=function(){return(t.pathConstraintPosition<<24)+this.pathConstraintIndex},D.prototype.setFrame=function(t,e,i){this.frames[t*=D.ENTRIES]=e,this.frames[t+D.VALUE]=i},D.prototype.apply=function(t,e,i,n,s,r,o){var a;if(e=this.frames,t=t.pathConstraints[this.pathConstraintIndex],i<e[0])switch(r){case p.setup:t.position=t.data.position;break;case p.current:t.position+=(t.data.position-t.position)*s}else n=0,i>=e[e.length-D.ENTRIES]?n=e[e.length+D.PREV_VALUE]:(n=e[(o=f.binarySearch(e,i,D.ENTRIES))+D.PREV_VALUE],a=e[o],i=this.getCurvePercent(o/D.ENTRIES-1,1-(i-a)/(e[o+D.PREV_TIME]-a)),n+=(e[o+D.VALUE]-n)*i),t.position=r==p.setup?t.data.position+(n-t.data.position)*s:t.position+(n-t.position)*s},(F=D).ENTRIES=2,F.PREV_TIME=-2,F.PREV_VALUE=-1,F.VALUE=1,u.PathConstraintPositionTimeline=F,__extends(w,b=F),w.prototype.getPropertyId=function(){return(t.pathConstraintSpacing<<24)+this.pathConstraintIndex},w.prototype.apply=function(t,e,i,n,s,r,o){var a;if(e=this.frames,t=t.pathConstraints[this.pathConstraintIndex],i<e[0])switch(r){case p.setup:t.spacing=t.data.spacing;break;case p.current:t.spacing+=(t.data.spacing-t.spacing)*s}else n=0,i>=e[e.length-w.ENTRIES]?n=e[e.length+w.PREV_VALUE]:(n=e[(o=f.binarySearch(e,i,w.ENTRIES))+w.PREV_VALUE],a=e[o],i=this.getCurvePercent(o/w.ENTRIES-1,1-(i-a)/(e[o+w.PREV_TIME]-a)),n+=(e[o+w.VALUE]-n)*i),t.spacing=r==p.setup?t.data.spacing+(n-t.data.spacing)*s:t.spacing+(n-t.spacing)*s},u.PathConstraintSpacingTimeline=F=w,__extends(N,O=s),N.prototype.getPropertyId=function(){return(t.pathConstraintMix<<24)+this.pathConstraintIndex},N.prototype.setFrame=function(t,e,i,n){this.frames[t*=N.ENTRIES]=e,this.frames[t+N.ROTATE]=i,this.frames[t+N.TRANSLATE]=n},N.prototype.apply=function(t,e,i,n,s,r,o){var a,c;if(e=this.frames,t=t.pathConstraints[this.pathConstraintIndex],i<e[0])switch(r){case p.setup:t.rotateMix=t.data.rotateMix,t.translateMix=t.data.translateMix;break;case p.current:t.rotateMix+=(t.data.rotateMix-t.rotateMix)*s,t.translateMix+=(t.data.translateMix-t.translateMix)*s}else o=n=0,i>=e[e.length-N.ENTRIES]?(n=e[e.length+N.PREV_ROTATE],o=e[e.length+N.PREV_TRANSLATE]):(n=e[(a=f.binarySearch(e,i,N.ENTRIES))+N.PREV_ROTATE],o=e[a+N.PREV_TRANSLATE],c=e[a],i=this.getCurvePercent(a/N.ENTRIES-1,1-(i-c)/(e[a+N.PREV_TIME]-c)),n+=(e[a+N.ROTATE]-n)*i,o+=(e[a+N.TRANSLATE]-o)*i),r==p.setup?(t.rotateMix=t.data.rotateMix+(n-t.data.rotateMix)*s,t.translateMix=t.data.translateMix+(o-t.data.translateMix)*s):(t.rotateMix+=(n-t.rotateMix)*s,t.translateMix+=(o-t.translateMix)*s)},(s=N).ENTRIES=3,s.PREV_TIME=-3,s.PREV_ROTATE=-2,s.PREV_TRANSLATE=-1,s.ROTATE=1,s.TRANSLATE=2,u.PathConstraintMixTimeline=s}(spine=spine||{}),!function(I){v.prototype.update=function(t){t*=this.timeScale;for(var e=this.tracks,i=0,n=e.length;i<n;i++){var s=e[i];if(null!=s){s.animationLast=s.nextAnimationLast,s.trackLast=s.nextTrackLast;var r=t*s.timeScale;if(0<s.delay){if(s.delay-=r,0<s.delay)continue;r=-s.delay,s.delay=0}var o=s.next;if(null!=o){var a=s.trackLast-o.delay;if(0<=a){for(o.delay=0,o.trackTime=a+t*o.timeScale,s.trackTime+=r,this.setCurrent(i,o,!0);null!=o.mixingFrom;)o.mixTime+=r,o=o.mixingFrom;continue}}else if(s.trackLast>=s.trackEnd&&null==s.mixingFrom){e[i]=null,this.queue.end(s),this.disposeNext(s);continue}if(null!=s.mixingFrom&&this.updateMixingFrom(s,t))for(o=s.mixingFrom,s.mixingFrom=null;null!=o;)this.queue.end(o),o=o.mixingFrom;s.trackTime+=r}}this.queue.drain()},v.prototype.updateMixingFrom=function(t,e){var i,n=t.mixingFrom;return null==n||(i=this.updateMixingFrom(n,e),0<t.mixTime&&(t.mixTime>=t.mixDuration||0==t.timeScale)?(0!=n.totalAlpha&&0!=t.mixDuration||(t.mixingFrom=n.mixingFrom,t.interruptAlpha=n.interruptAlpha,this.queue.end(n)),i):(n.animationLast=n.nextAnimationLast,n.trackLast=n.nextTrackLast,n.trackTime+=e*n.timeScale,t.mixTime+=e*t.timeScale,!1))},v.prototype.apply=function(t){if(null==t)throw Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();for(var e=this.events,i=this.tracks,n=!1,s=0,r=i.length;s<r;s++){var o=i[s];if(!(null==o||0<o.delay)){var n=!0,a=0==s?I.MixPose.current:I.MixPose.currentLayered,c=o.alpha,h=(null!=o.mixingFrom?c*=this.applyMixingFrom(o,t,a):o.trackTime>=o.trackEnd&&null==o.next&&(c=0),o.animationLast),l=o.getAnimationTime(),u=o.animation.timelines.length,d=o.animation.timelines;if(1==c)for(var _=0;_<u;_++)d[_].apply(t,h,l,e,1,I.MixPose.setup,I.MixDirection.in);else{var p=o.timelineData,f=0==o.timelinesRotation.length;f&&I.Utils.setArraySize(o.timelinesRotation,u<<1,null);for(var g=o.timelinesRotation,_=0;_<u;_++){var m=d[_],y=p[_]>=v.FIRST?I.MixPose.setup:a;m instanceof I.RotateTimeline?this.applyRotateTimeline(m,t,l,c,y,g,_<<1,f):m.apply(t,h,l,e,c,y,I.MixDirection.in)}}this.queueEvents(o,l),e.length=0,o.nextAnimationLast=l,o.nextTrackLast=o.trackTime}}return this.queue.drain(),n},v.prototype.applyMixingFrom=function(t,e,i){var n=t.mixingFrom,s=(null!=n.mixingFrom&&this.applyMixingFrom(n,e,i),0),r=(s=0==t.mixDuration||1<(s=t.mixTime/t.mixDuration)?1:s)<n.eventThreshold?this.events:null,o=s<n.attachmentThreshold,a=s<n.drawOrderThreshold,c=n.animationLast,h=n.getAnimationTime(),l=n.animation.timelines.length,u=n.animation.timelines,d=n.timelineData,_=n.timelineDipMix,p=0==n.timelinesRotation.length;p&&I.Utils.setArraySize(n.timelinesRotation,l<<1,null);for(var f=n.timelinesRotation,g=n.alpha*t.interruptAlpha,m=g*(1-s),y=0,T=n.totalAlpha=0;T<l;T++){var S=u[T];switch(d[T]){case v.SUBSEQUENT:if(!o&&S instanceof I.AttachmentTimeline)continue;if(!a&&S instanceof I.DrawOrderTimeline)continue;C=i,y=m;break;case v.FIRST:C=I.MixPose.setup,y=m;break;case v.DIP:C=I.MixPose.setup,y=g;break;default:var C=I.MixPose.setup,y=g,E=_[T],y=y*Math.max(0,1-E.mixTime/E.mixDuration)}n.totalAlpha+=y,S instanceof I.RotateTimeline?this.applyRotateTimeline(S,e,h,y,C,f,T<<1,p):S.apply(e,c,h,r,y,C,I.MixDirection.out)}return 0<t.mixDuration&&this.queueEvents(n,h),this.events.length=0,n.nextAnimationLast=h,n.nextTrackLast=n.trackTime,s},v.prototype.applyRotateTimeline=function(t,e,i,n,s,r,o,a){var c,h,l,u;a&&(r[o]=0),1==n?t.apply(e,0,i,null,1,s,I.MixDirection.in):(c=t.frames,e=e.bones[t.boneIndex],i<c[0]?s==I.MixPose.setup&&(e.rotation=e.data.rotation):(h=0,i>=c[c.length-I.RotateTimeline.ENTRIES]?h=e.data.rotation+c[c.length+I.RotateTimeline.PREV_ROTATION]:(l=c[(h=I.Animation.binarySearch(c,i,I.RotateTimeline.ENTRIES))+I.RotateTimeline.PREV_ROTATION],u=c[h],t=t.getCurvePercent((h>>1)-1,1-(i-u)/(c[h+I.RotateTimeline.PREV_TIME]-u)),h=l+((h=c[h+I.RotateTimeline.ROTATION]-l)-360*(16384-(16384.499999999996-h/360|0)))*t+e.data.rotation,h-=360*(16384-(16384.499999999996-h/360|0))),(c=0)==(t=h-(s=(s==I.MixPose.setup?e.data:e).rotation))?c=r[o]:(t-=360*(16384-(16384.499999999996-t/360|0)),c=i=0,c=a?(i=0,t):(i=r[o],r[o+1]),a=0<t,h=0<=i,I.MathUtils.signum(c)!=I.MathUtils.signum(t)&&Math.abs(c)<=90&&(180<Math.abs(i)&&(i+=360*I.MathUtils.signum(i)),h=a),c=t+i-i%360,h!=a&&(c+=360*I.MathUtils.signum(i)),r[o]=c),r[o+1]=t,e.rotation=(s+=c*n)-360*(16384-(16384.499999999996-s/360|0))))},v.prototype.queueEvents=function(t,e){for(var i=t.animationStart,n=t.animationEnd,s=n-i,r=t.trackLast%s,o=this.events,a=0,c=o.length;a<c;a++){var h=o[a];if(h.time<r)break;h.time>n||this.queue.event(t,h)}for((t.loop?r>t.trackTime%s:n<=e&&t.animationLast<n)&&this.queue.complete(t);a<c;a++)o[a].time<i||this.queue.event(t,o[a])},v.prototype.clearTracks=function(){var t=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(var e=0,i=this.tracks.length;e<i;e++)this.clearTrack(e);this.tracks.length=0,this.queue.drainDisabled=t,this.queue.drain()},v.prototype.clearTrack=function(t){if(!(t>=this.tracks.length)&&null!=(t=this.tracks[t])){this.queue.end(t),this.disposeNext(t);for(var e=t;;){var i=e.mixingFrom;if(null==i)break;this.queue.end(i),e.mixingFrom=null,e=i}this.tracks[t.trackIndex]=null,this.queue.drain()}},v.prototype.setCurrent=function(t,e,i){var n=this.expandToIndex(t);this.tracks[t]=e,null!=n&&(i&&this.queue.interrupt(n),e.mixingFrom=n,e.mixTime=0,null!=n.mixingFrom&&0<n.mixDuration&&(e.interruptAlpha*=Math.min(1,n.mixTime/n.mixDuration)),n.timelinesRotation.length=0),this.queue.start(e)},v.prototype.setAnimation=function(t,e,i){var n=this.data.skeletonData.findAnimation(e);if(null==n)throw Error("Animation not found: "+e);return this.setAnimationWith(t,n,i)},v.prototype.setAnimationWith=function(t,e,i){if(null==e)throw Error("animation cannot be null.");var n=!0,s=this.expandToIndex(t);return null!=s&&(-1==s.nextTrackLast?(this.tracks[t]=s.mixingFrom,this.queue.interrupt(s),this.queue.end(s),this.disposeNext(s),s=s.mixingFrom,n=!1):this.disposeNext(s)),e=this.trackEntry(t,e,i,s),this.setCurrent(t,e,n),this.queue.drain(),e},v.prototype.addAnimation=function(t,e,i,n){var s=this.data.skeletonData.findAnimation(e);if(null==s)throw Error("Animation not found: "+e);return this.addAnimationWith(t,s,i,n)},v.prototype.addAnimationWith=function(t,e,i,n){if(null==e)throw Error("animation cannot be null.");var s=this.expandToIndex(t);if(null!=s)for(;null!=s.next;)s=s.next;return i=this.trackEntry(t,e,i,s),null==s?(this.setCurrent(t,i,!0),this.queue.drain()):(s.next=i,n<=0&&(n=0!=(t=s.animationEnd-s.animationStart)?n+(t*(1+(s.trackTime/t|0))-this.data.getMix(s.animation,e)):0)),i.delay=n,i},v.prototype.setEmptyAnimation=function(t,e){t=this.setAnimationWith(t,v.emptyAnimation,!1);return t.mixDuration=e,t.trackEnd=e,t},v.prototype.addEmptyAnimation=function(t,e,i){return i<=0&&(i-=e),(t=this.addAnimationWith(t,v.emptyAnimation,!1,i)).mixDuration=e,t.trackEnd=e,t},v.prototype.setEmptyAnimations=function(t){var e=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(var i=0,n=this.tracks.length;i<n;i++){var s=this.tracks[i];null!=s&&this.setEmptyAnimation(s.trackIndex,t)}this.queue.drainDisabled=e,this.queue.drain()},v.prototype.expandToIndex=function(t){return t<this.tracks.length?this.tracks[t]:(I.Utils.ensureArrayCapacity(this.tracks,t-this.tracks.length+1,null),this.tracks.length=t+1,null)},v.prototype.trackEntry=function(t,e,i,n){var s=this.trackEntryPool.obtain();return s.trackIndex=t,s.animation=e,s.loop=i,s.eventThreshold=0,s.attachmentThreshold=0,s.drawOrderThreshold=0,s.animationStart=0,s.animationEnd=e.duration,s.animationLast=-1,s.nextAnimationLast=-1,s.delay=0,s.trackTime=0,s.trackLast=-1,s.nextTrackLast=-1,s.trackEnd=Number.MAX_VALUE,s.timeScale=1,s.alpha=1,s.interruptAlpha=1,s.mixTime=0,s.mixDuration=null==n?0:this.data.getMix(n.animation,e),s},v.prototype.disposeNext=function(t){for(var e=t.next;null!=e;)this.queue.dispose(e),e=e.next;t.next=null},v.prototype._animationsChanged=function(){this.animationsChanged=!1;var t=this.propertyIDs;t.clear();for(var e=this.mixingTo,i=0,n=this.tracks.length;i<n;i++){var s=this.tracks[i];null!=s&&s.setTimelineData(null,e,t)}},v.prototype.getCurrent=function(t){return t>=this.tracks.length?null:this.tracks[t]},v.prototype.addListener=function(t){if(null==t)throw Error("listener cannot be null.");this.listeners.push(t)},v.prototype.removeListener=function(t){0<=(t=this.listeners.indexOf(t))&&this.listeners.splice(t,1)},v.prototype.clearListeners=function(){this.listeners.length=0},v.prototype.clearListenerNotifications=function(){this.queue.clear()};var _=v;function v(t){this.tracks=[],this.events=[],this.listeners=[],this.queue=new n(this),this.propertyIDs=new I.IntSet,this.mixingTo=[],this.animationsChanged=!1,this.timeScale=1,this.trackEntryPool=new I.Pool(function(){return new e}),this.data=t}_.emptyAnimation=new I.Animation("<empty>",[],0),_.SUBSEQUENT=0,_.FIRST=1,_.DIP=2,_.DIP_MIX=3,I.AnimationState=_;t.prototype.reset=function(){this.listener=this.animation=this.mixingFrom=this.next=null,this.timelineData.length=0,this.timelineDipMix.length=0,this.timelinesRotation.length=0},t.prototype.setTimelineData=function(t,e,i){null!=t&&e.push(t);var n=null!=this.mixingFrom?this.mixingFrom.setTimelineData(this,e,i):this,s=(null!=t&&e.pop(),e.length-1),r=this.animation.timelines,o=this.animation.timelines.length,a=I.Utils.setArraySize(this.timelineData,o),c=(this.timelineDipMix.length=0,I.Utils.setArraySize(this.timelineDipMix,o)),h=0;t:for(;h<o;h++){var l=r[h].getPropertyId();if(i.add(l))if(null!=t&&t.hasTimeline(l)){for(var u=s;0<=u;u--){var d=e[u];if(!d.hasTimeline(l)&&0<d.mixDuration){a[h]=_.DIP_MIX,c[h]=d;continue t}}a[h]=_.DIP}else a[h]=_.FIRST;else a[h]=_.SUBSEQUENT}return n},t.prototype.hasTimeline=function(t){for(var e=this.animation.timelines,i=0,n=e.length;i<n;i++)if(e[i].getPropertyId()==t)return!0;return!1},t.prototype.getAnimationTime=function(){var t;return this.loop?0==(t=this.animationEnd-this.animationStart)?this.animationStart:this.trackTime%t+this.animationStart:Math.min(this.trackTime+this.animationStart,this.animationEnd)},t.prototype.setAnimationLast=function(t){this.nextAnimationLast=this.animationLast=t},t.prototype.isComplete=function(){return this.trackTime>=this.animationEnd-this.animationStart},t.prototype.resetRotationDirections=function(){this.timelinesRotation.length=0};var e=t;function t(){this.timelineData=[],this.timelineDipMix=[],this.timelinesRotation=[]}I.TrackEntry=e;s.prototype.start=function(t){this.objects.push(o.start),this.objects.push(t),this.animState.animationsChanged=!0},s.prototype.interrupt=function(t){this.objects.push(o.interrupt),this.objects.push(t)},s.prototype.end=function(t){this.objects.push(o.end),this.objects.push(t),this.animState.animationsChanged=!0},s.prototype.dispose=function(t){this.objects.push(o.dispose),this.objects.push(t)},s.prototype.complete=function(t){this.objects.push(o.complete),this.objects.push(t)},s.prototype.event=function(t,e){this.objects.push(o.event),this.objects.push(t),this.objects.push(e)},s.prototype.drain=function(){if(!this.drainDisabled){this.drainDisabled=!0;for(var t=this.objects,e=this.animState.listeners,i=0;i<t.length;i+=2){var n=t[i+1];switch(t[i]){case o.start:null!=n.listener&&n.listener.start&&n.listener.start(n);for(var s=0;s<e.length;s++)e[s].start&&e[s].start(n);break;case o.interrupt:for(null!=n.listener&&n.listener.interrupt&&n.listener.interrupt(n),s=0;s<e.length;s++)e[s].interrupt&&e[s].interrupt(n);break;case o.end:for(null!=n.listener&&n.listener.end&&n.listener.end(n),s=0;s<e.length;s++)e[s].end&&e[s].end(n);case o.dispose:for(null!=n.listener&&n.listener.dispose&&n.listener.dispose(n),s=0;s<e.length;s++)e[s].dispose&&e[s].dispose(n);this.animState.trackEntryPool.free(n);break;case o.complete:for(null!=n.listener&&n.listener.complete&&n.listener.complete(n),s=0;s<e.length;s++)e[s].complete&&e[s].complete(n);break;case o.event:var r=t[2+i++];for(null!=n.listener&&n.listener.event&&n.listener.event(n,r),s=0;s<e.length;s++)e[s].event&&e[s].event(n,r)}}this.clear(),this.drainDisabled=!1}},s.prototype.clear=function(){this.objects.length=0};var o,i,n=s;function s(t){this.objects=[],this.drainDisabled=!1,this.animState=t}function r(){}I.EventQueue=n,(i=o=I.EventType||(I.EventType={}))[i.start=0]="start",i[i.interrupt=1]="interrupt",i[i.end=2]="end",i[i.dispose=3]="dispose",i[i.complete=4]="complete",i[i.event=5]="event",r.prototype.start=function(t){},r.prototype.interrupt=function(t){},r.prototype.end=function(t){},r.prototype.dispose=function(t){},r.prototype.complete=function(t){},r.prototype.event=function(t,e){},I.AnimationStateAdapter2=r}(spine=spine||{}),!function(t){function e(t){if(this.animationToMixTime={},this.defaultMix=0,null==t)throw Error("skeletonData cannot be null.");this.skeletonData=t}e.prototype.setMix=function(t,e,i){var n=this.skeletonData.findAnimation(t);if(null==n)throw Error("Animation not found: "+t);if(null==(t=this.skeletonData.findAnimation(e)))throw Error("Animation not found: "+e);this.setMixWith(n,t,i)},e.prototype.setMixWith=function(t,e,i){if(null==t)throw Error("from cannot be null.");if(null==e)throw Error("to cannot be null.");this.animationToMixTime[t.name+e.name]=i},e.prototype.getMix=function(t,e){t=this.animationToMixTime[t.name+e.name];return void 0===t?this.defaultMix:t},t.AnimationStateData=e}(spine=spine||{}),!function(t){function e(t,e){void 0===e&&(e=""),this.assets={},this.errors={},this.loaded=this.toLoad=0,this.textureLoader=t,this.pathPrefix=e}e.prototype.loadText=function(t,e,i){var n=this,s=(void 0===e&&(e=null),void 0===i&&(i=null),t=this.pathPrefix+t,this.toLoad++,new XMLHttpRequest);s.onreadystatechange=function(){s.readyState==XMLHttpRequest.DONE&&(200<=s.status&&s.status<300?(n.assets[t]=s.responseText,e&&e(t,s.responseText)):(n.errors[t]="Couldn't load text "+t+": status "+s.status+", "+s.responseText,i&&i(t,"Couldn't load text "+t+": status "+s.status+", "+s.responseText)),n.toLoad--,n.loaded++)},s.open("GET",t,!0),s.send()},e.prototype.loadTexture=function(e,i,n){var s=this,r=(void 0===i&&(i=null),void 0===n&&(n=null),e=this.pathPrefix+e,this.toLoad++,new Image);r.crossOrigin="anonymous",r.onload=function(t){t=s.textureLoader(r),s.assets[e]=t,s.toLoad--,s.loaded++,i&&i(e,r)},r.onerror=function(t){s.errors[e]="Couldn't load image "+e,s.toLoad--,s.loaded++,n&&n(e,"Couldn't load image "+e)},r.src=e},e.prototype.loadTextureData=function(e,t,i,n){var s=this,r=(void 0===i&&(i=null),void 0===n&&(n=null),e=this.pathPrefix+e,this.toLoad++,new Image);r.onload=function(t){t=s.textureLoader(r),s.assets[e]=t,s.toLoad--,s.loaded++,i&&i(e,r)},r.onerror=function(t){s.errors[e]="Couldn't load image "+e,s.toLoad--,s.loaded++,n&&n(e,"Couldn't load image "+e)},r.src=t},e.prototype.get=function(t){return t=this.pathPrefix+t,this.assets[t]},e.prototype.remove=function(t){t=this.pathPrefix+t;var e=this.assets[t];e.dispose&&e.dispose(),this.assets[t]=null},e.prototype.removeAll=function(){for(var t in this.assets){t=this.assets[t];t.dispose&&t.dispose()}this.assets={}},e.prototype.isLoadingComplete=function(){return 0==this.toLoad},e.prototype.getToLoad=function(){return this.toLoad},e.prototype.getLoaded=function(){return this.loaded},e.prototype.dispose=function(){this.removeAll()},e.prototype.hasErrors=function(){return 0<Object.keys(this.errors).length},e.prototype.getErrors=function(){return this.errors},t.AssetManager=e}(spine=spine||{}),!function(n){function t(t){this.atlas=t}t.prototype.newRegionAttachment=function(t,e,i){if(null==(t=this.atlas.findRegion(i)))throw Error("Region not found in atlas: "+i+" (region attachment: "+e+")");return t.renderObject=t,(e=new n.RegionAttachment(e)).setRegion(t),e},t.prototype.newMeshAttachment=function(t,e,i){if(null==(t=this.atlas.findRegion(i)))throw Error("Region not found in atlas: "+i+" (mesh attachment: "+e+")");return t.renderObject=t,(e=new n.MeshAttachment(e)).region=t,e},t.prototype.newBoundingBoxAttachment=function(t,e){return new n.BoundingBoxAttachment(e)},t.prototype.newPathAttachment=function(t,e){return new n.PathAttachment(e)},t.prototype.newPointAttachment=function(t,e){return new n.PointAttachment(e)},t.prototype.newClippingAttachment=function(t,e){return new n.ClippingAttachment(e)},n.AtlasAttachmentLoader=t}(spine=spine||{}),!function(t){(t=t.BlendMode||(t.BlendMode={}))[t.Normal=0]="Normal",t[t.Additive=1]="Additive",t[t.Multiply=2]="Multiply",t[t.Screen=3]="Screen"}(spine=spine||{}),!function(p){function t(t,e,i){if(this.children=[],this.ashearY=this.ashearX=this.ascaleY=this.ascaleX=this.arotation=this.ay=this.ax=this.shearY=this.shearX=this.scaleY=this.scaleX=this.rotation=this.y=this.x=0,this.appliedValid=!1,this.worldY=this.d=this.c=this.worldX=this.b=this.a=0,this.sorted=!1,null==t)throw Error("data cannot be null.");if(null==e)throw Error("skeleton cannot be null.");this.data=t,this.skeleton=e,this.parent=i,this.setToSetupPose()}t.prototype.update=function(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)},t.prototype.updateWorldTransform=function(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)},t.prototype.updateWorldTransformWith=function(t,e,i,n,s,r,o){if(this.ax=t,this.ay=e,this.arotation=i,this.ascaleX=n,this.ascaleY=s,this.ashearX=r,this.ashearY=o,this.appliedValid=!0,null==(a=this.parent)){o=i+90+o;var a=p.MathUtils.cosDeg(i+r)*n,c=p.MathUtils.cosDeg(o)*s;n*=p.MathUtils.sinDeg(i+r),s*=p.MathUtils.sinDeg(o),(h=this.skeleton).flipX&&(t=-t,a=-a,c=-c),h.flipY&&(e=-e,n=-n,s=-s),this.a=a,this.b=c,this.c=n,this.d=s,this.worldX=t+h.x,this.worldY=e+h.y}else{var h=a.a,l=a.b,u=a.c,d=a.d;switch(this.worldX=h*t+l*e+a.worldX,this.worldY=u*t+d*e+a.worldY,this.data.transformMode){case p.TransformMode.Normal:return o=i+90+o,a=p.MathUtils.cosDeg(i+r)*n,c=p.MathUtils.cosDeg(o)*s,n*=p.MathUtils.sinDeg(i+r),s*=p.MathUtils.sinDeg(o),this.a=h*a+l*n,this.b=h*c+l*s,this.c=u*a+d*n,void(this.d=u*c+d*s);case p.TransformMode.OnlyTranslation:o=i+90+o,this.a=p.MathUtils.cosDeg(i+r)*n,this.b=p.MathUtils.cosDeg(o)*s,this.c=p.MathUtils.sinDeg(i+r)*n,this.d=p.MathUtils.sinDeg(o)*s;break;case p.TransformMode.NoRotationOrReflection:c=0,o=i+o-(c=1e-4<(a=h*h+u*u)?(l=u*(a=Math.abs(h*d-l*u)/a),d=h*a,Math.atan2(u,h)*p.MathUtils.radDeg):(u=h=0,90-Math.atan2(d,l)*p.MathUtils.radDeg))+90,a=p.MathUtils.cosDeg(r=i+r-c)*n,c=p.MathUtils.cosDeg(o)*s,n*=p.MathUtils.sinDeg(r),s*=p.MathUtils.sinDeg(o),this.a=h*a-l*n,this.b=h*c-l*s,this.c=u*a+d*n,this.d=u*c+d*s;break;case p.TransformMode.NoScale:case p.TransformMode.NoScaleOrReflection:i=h*(a=p.MathUtils.cosDeg(i))+l*(c=p.MathUtils.sinDeg(i)),t=u*a+d*c,i*=a=1e-5<(a=Math.sqrt(i*i+t*t))?1/a:a,t*=a,a=Math.sqrt(i*i+t*t),c=Math.PI/2+Math.atan2(t,i),e=Math.cos(c)*a;var _=Math.sin(c)*a,a=p.MathUtils.cosDeg(r)*n,c=p.MathUtils.cosDeg(90+o)*s;return n*=p.MathUtils.sinDeg(r),s*=p.MathUtils.sinDeg(90+o),(this.data.transformMode!=p.TransformMode.NoScaleOrReflection?h*d-l*u<0:this.skeleton.flipX!=this.skeleton.flipY)&&(e=-e,_=-_),this.a=i*a+e*n,this.b=i*c+e*s,this.c=t*a+_*n,void(this.d=t*c+_*s)}this.skeleton.flipX&&(this.a=-this.a,this.b=-this.b),this.skeleton.flipY&&(this.c=-this.c,this.d=-this.d)}},t.prototype.setToSetupPose=function(){var t=this.data;this.x=t.x,this.y=t.y,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.shearX=t.shearX,this.shearY=t.shearY},t.prototype.getWorldRotationX=function(){return Math.atan2(this.c,this.a)*p.MathUtils.radDeg},t.prototype.getWorldRotationY=function(){return Math.atan2(this.d,this.b)*p.MathUtils.radDeg},t.prototype.getWorldScaleX=function(){return Math.sqrt(this.a*this.a+this.c*this.c)},t.prototype.getWorldScaleY=function(){return Math.sqrt(this.b*this.b+this.d*this.d)},t.prototype.updateAppliedTransform=function(){this.appliedValid=!0;var t,e,i,n,s,r,o=this.parent;null==o?(this.ax=this.worldX,this.ay=this.worldY,this.arotation=Math.atan2(this.c,this.a)*p.MathUtils.radDeg,this.ascaleX=Math.sqrt(this.a*this.a+this.c*this.c),this.ascaleY=Math.sqrt(this.b*this.b+this.d*this.d),this.ashearX=0,this.ashearY=Math.atan2(this.a*this.b+this.c*this.d,this.a*this.d-this.b*this.c)*p.MathUtils.radDeg):(t=o.a,e=o.b,i=o.c,n=o.d,r=this.worldX-o.worldX,o=this.worldY-o.worldY,this.ax=r*n*(s=1/(t*n-e*i))-o*e*s,this.ay=o*t*s-r*i*s,n*=s,t*=s,e*=s,s*=i,i=n*this.a-e*this.c,e=n*this.b-e*this.d,n=t*this.c-s*this.a,s=t*this.d-s*this.b,this.ashearX=0,this.ascaleX=Math.sqrt(i*i+n*n),1e-4<this.ascaleX?(this.ascaleY=(t=i*s-e*n)/this.ascaleX,this.ashearY=Math.atan2(i*e+n*s,t)*p.MathUtils.radDeg,this.arotation=Math.atan2(n,i)*p.MathUtils.radDeg):(this.ascaleX=0,this.ascaleY=Math.sqrt(e*e+s*s),this.ashearY=0,this.arotation=90-Math.atan2(s,e)*p.MathUtils.radDeg))},t.prototype.worldToLocal=function(t){var e=this.a,i=this.b,n=this.c,s=this.d,r=1/(e*s-i*n),o=t.x-this.worldX,a=t.y-this.worldY;return t.x=o*s*r-a*i*r,t.y=a*e*r-o*n*r,t},t.prototype.localToWorld=function(t){var e=t.x,i=t.y;return t.x=e*this.a+i*this.b+this.worldX,t.y=e*this.c+i*this.d+this.worldY,t},t.prototype.worldToLocalRotation=function(t){var e=p.MathUtils.sinDeg(t);return t=p.MathUtils.cosDeg(t),Math.atan2(this.a*e-this.c*t,this.d*t-this.b*e)*p.MathUtils.radDeg},t.prototype.localToWorldRotation=function(t){var e=p.MathUtils.sinDeg(t);return t=p.MathUtils.cosDeg(t),Math.atan2(t*this.c+e*this.d,t*this.a+e*this.b)*p.MathUtils.radDeg},t.prototype.rotateWorld=function(t){var e=this.a,i=this.b,n=this.c,s=this.d,r=p.MathUtils.cosDeg(t);t=p.MathUtils.sinDeg(t),this.a=r*e-t*n,this.b=r*i-t*s,this.c=t*e+r*n,this.d=t*i+r*s,this.appliedValid=!1},p.Bone=t}(spine=spine||{}),!function(t){var n;t.BoneData=function(t,e,i){if(this.rotation=this.y=this.x=0,this.scaleY=this.scaleX=1,this.shearY=this.shearX=0,this.transformMode=n.Normal,t<0)throw Error("index must be >= 0.");if(null==e)throw Error("name cannot be null.");this.index=t,this.name=e,this.parent=i},(t=n=t.TransformMode||(t.TransformMode={}))[t.Normal=0]="Normal",t[t.OnlyTranslation=1]="OnlyTranslation",t[t.NoRotationOrReflection=2]="NoRotationOrReflection",t[t.NoScale=3]="NoScale",t[t.NoScaleOrReflection=4]="NoScaleOrReflection"}(spine=spine||{}),(spine||(spine={})).Event=function(t,e){if(null==e)throw Error("data cannot be null.");this.time=t,this.data=e},(spine||(spine={})).EventData=function(t){this.name=t},!function(x){function t(t,e){if(this.mix=1,this.bendDirection=0,null==t)throw Error("data cannot be null.");if(null==e)throw Error("skeleton cannot be null.");this.data=t,this.mix=t.mix,this.bendDirection=t.bendDirection,this.bones=[];for(var i=0;i<t.bones.length;i++)this.bones.push(e.findBone(t.bones[i].name));this.target=e.findBone(t.target.name)}t.prototype.getOrder=function(){return this.data.order},t.prototype.apply=function(){this.update()},t.prototype.update=function(){var t=this.target,e=this.bones;switch(e.length){case 1:this.apply1(e[0],t.worldX,t.worldY,this.mix);break;case 2:this.apply2(e[0],e[1],t.worldX,t.worldY,this.bendDirection,this.mix)}},t.prototype.apply1=function(t,e,i,n){t.appliedValid||t.updateAppliedTransform();var s=t.parent,r=1/(s.a*s.d-s.b*s.c);e-=s.worldX,i-=s.worldY,s=Math.atan2((i*s.a-e*s.c)*r-t.ay,(e*s.d-i*s.b)*r-t.ax)*x.MathUtils.radDeg-t.ashearX-t.arotation,t.ascaleX<0&&(s+=180),180<s?s-=360:s<-180&&(s+=360),t.updateWorldTransformWith(t.ax,t.ay,t.arotation+s*n,t.ascaleX,t.ascaleY,t.ashearX,t.ashearY)},t.prototype.apply2=function(t,e,i,n,s,r){var o,a,c,h,l,u,d,_,p,f,g,m,y,T,S,C,E,I,v,b,A,F;0==r?e.updateWorldTransform():(t.appliedValid||t.updateAppliedTransform(),e.appliedValid||e.updateAppliedTransform(),o=t.ax,a=t.ay,l=(S=t.ascaleX)<(l=u=h=0)?(S=-S,h=180,-1):(h=0,1),(I=t.ascaleY)<0&&(I=-I,l=-l),u=(c=e.ascaleX)<0?(c=-c,180):0,d=e.ax,v=p=_=0,g=t.a,m=t.b,F=t.c,y=t.d,v=(f=Math.abs(S-I)<=1e-4)?(p=g*d+m*(_=e.ay)+t.worldX,F*d+y*_+t.worldY):(_=0,p=g*d+t.worldX,F*d+t.worldY),g=(b=t.parent).a,m=b.b,F=b.c,E=1/(g*(y=b.d)-m*F),T=((i-=b.worldX)*y-(n-=b.worldY)*m)*E-o,C=(n*g-i*F)*E-a,m=((i=p-b.worldX)*y-(n=v-b.worldY)*m)*E-o,g=(n*g-i*F)*E-a,i=Math.sqrt(m*m+g*g),m=e.data.length*c,F=g=0,f?((g=(T*T+C*C-i*i-(m*=S)*m)/(2*i*m))<-1?g=-1:1<g&&(g=1),F=Math.acos(g)*s,g=i+m*g,m*=Math.sin(F),g=Math.atan2(C*g-T*m,T*g+C*m)):(n=(g=S*m)*g,c=(m*=I)*m,f=T*T+C*C,T=Math.atan2(C,T),F=0<=(y=(C=-2*c*i)*C-4*(E=c-n)*(F=c*i*i+n*f-n*c))&&(y=Math.sqrt(y),C=(y=-(C+(y=C<0?-y:y))/2)/E,F/=y,(F=Math.abs(C)<Math.abs(F)?C:F)*F<=f)?(n=Math.sqrt(f-F*F)*s,g=T-Math.atan2(n,F),Math.atan2(n/I,(F-i)/S)):(S=x.MathUtils.PI,E=(C=i-g)*C,b=(v=i+g)*v,A=I=p=0,-1<=(F=-g*i/(n-c))&&F<=1&&(F=Math.acos(F),(y=(i=g*Math.cos(F)+i)*i+(n=m*Math.sin(F))*n)<E&&(S=F,E=y,C=i,p=n),b<y)&&(I=F,b=y,v=i,A=n),f<=(E+b)/2?(g=T-Math.atan2(p*s,C),S*s):(g=T-Math.atan2(A*s,v),I*s))),s=Math.atan2(_,d)*l,m=t.arotation,180<(g=(g-s)*x.MathUtils.radDeg+h-m)?g-=360:g<-180&&(g+=360),t.updateWorldTransformWith(o,a,m+g*r,t.ascaleX,t.ascaleY,0,0),m=e.arotation,180<(F=((F+s)*x.MathUtils.radDeg-e.ashearX)*l+u-m)?F-=360:F<-180&&(F+=360),e.updateWorldTransformWith(d,_,m+F*r,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY))},x.IkConstraint=t}(spine=spine||{}),(spine||(spine={})).IkConstraintData=function(t){this.order=0,this.bones=[],this.mix=this.bendDirection=1,this.name=t},!function(D){w.prototype.apply=function(){this.update()},w.prototype.update=function(){var t=this.target.getAttachment();if(t instanceof D.PathAttachment){var e=this.rotateMix,i=this.translateMix,n=0<e;if(0<i||n){var s,r,o,a,c,h=this.data,l=h.spacingMode,u=l==D.SpacingMode.Length,d=h.rotateMode,_=d==D.RotateMode.Tangent,p=d==D.RotateMode.ChainScale,f=this.bones.length,g=_?f:f+1,m=this.bones,y=D.Utils.setArraySize(this.spaces,g),T=null,S=this.spacing;if(p||u){p&&(T=D.Utils.setArraySize(this.lengths,f));for(var C=0,E=g-1;C<E;){var I,v=(I=0==(I=(A=m[C]).data.length)?1e-7:I)*A.a,b=I*A.c,A=Math.sqrt(v*v+b*b);p&&(T[C]=A),y[++C]=(u?I+S:S)*A/I}}else for(C=1;C<g;C++)y[C]=S;for(u=(t=this.computeWorldPositions(t,g,_,h.positionMode==D.PositionMode.Percent,l==D.SpacingMode.Percent))[0],g=t[1],l=!1,0==(h=h.offsetRotation)?l=d==D.RotateMode.Chain:(l=!1,h*=0<(d=this.target.bone).a*d.d-d.b*d.c?D.MathUtils.degRad:-D.MathUtils.degRad),C=0,d=3;C<f;C++,d+=3)(A=m[C]).worldX+=(u-A.worldX)*i,A.worldY+=(g-A.worldY)*i,S=(v=t[d])-u,E=(b=t[d+1])-g,p&&0!=(u=T[C])&&(u=(Math.sqrt(S*S+E*E)/u-1)*e+1,A.a*=u,A.c*=u),u=v,g=b,n&&(v=A.a,b=A.b,I=A.c,s=A.d,a=o=r=0,r=(r=_?t[d-1]:0==y[C+1]?t[d+2]:Math.atan2(E,S))-Math.atan2(I,v),l?(o=Math.cos(r),a=Math.sin(r),u+=((c=A.data.length)*(o*v-a*I)-S)*e,g+=(c*(a*v+o*I)-E)*e):r+=h,r>D.MathUtils.PI?r-=D.MathUtils.PI2:r<-D.MathUtils.PI&&(r+=D.MathUtils.PI2),r*=e,o=Math.cos(r),a=Math.sin(r),A.a=o*v-a*I,A.b=o*b-a*s,A.c=a*v+o*I,A.d=a*b+o*s),A.appliedValid=!1}}},w.prototype.computeWorldPositions=function(t,e,i,n,s){var r=this.target,o=this.position,a=this.spaces,c=D.Utils.setArraySize(this.positions,3*e+2),h=null,l=t.closed,u=t.worldVerticesLength,d=u/6,_=w.NONE;if(t.constantSpeed){l?(h=D.Utils.setArraySize(this.world,u+=2),t.computeWorldVertices(r,2,u-4,h,0,2),t.computeWorldVertices(r,0,2,h,u-4,2),h[u-2]=h[0],h[u-1]=h[1]):(d--,h=D.Utils.setArraySize(this.world,u-=4),t.computeWorldVertices(r,2,u,h,0,2)),t=D.Utils.setArraySize(this.curves,d);for(var r=0,p=h[0],f=h[1],g=R=0,m=0,y=0,T=0,S=0,C=0,E=0,I=L=0,v=0,b=0,A=E=C=0,F=2;A<d;A++,F+=6)R=h[F],g=h[F+1],m=h[F+2],y=h[F+3],v=2*(C=.1875*(p-2*R+m))+(L=.09375*(3*(R-m)-p+(T=h[F+4]))),b=2*(E=.1875*(f-2*g+y))+(I=.09375*(3*(g-y)-f+(S=h[F+5]))),C=.75*(R-p)+C+.16666667*L,E=.75*(g-f)+E+.16666667*I,r+=Math.sqrt(C*C+E*E),C+=v,E+=b,v+=L,b+=I,r+=Math.sqrt(C*C+E*E),C+=v,E+=b,r+=Math.sqrt(C*C+E*E),C+=v+L,E+=b+I,r+=Math.sqrt(C*C+E*E),t[A]=r,p=T,f=S;if(n&&(o*=r),s)for(A=0;A<e;A++)a[A]*=r;for(var d=this.segments,x=0,I=s=n=A=0;A<e;A++,n+=3){if(B=o+=F=a[A],l)(B%=r)<0&&(B+=r),s=0;else{if(B<0){this.addBeforePosition(B,h,0,c,n);continue}if(r<B){this.addAfterPosition(B-r,h,u-4,c,n);continue}}for(;;s++)if(!((v=t[s])<B)){0==s?B/=v:B=(B-(L=t[s-1]))/(v-L);break}if(s!=_){var _=s,P=6*s,p=h[P],f=h[P+1],R=h[P+2],g=h[P+3],m=h[P+4],y=h[P+5],v=2*(C=.03*(p-2*R+m))+(L=.006*(3*(R-m)-p+(T=h[P+6]))),b=2*(E=.03*(f-2*g+y))+(I=.006*(3*(g-y)-f+(S=h[P+7]))),C=.3*(R-p)+C+.16666667*L,E=.3*(g-f)+E+.16666667*I,x=Math.sqrt(C*C+E*E);for(d[0]=x,P=1;P<8;P++)C+=v,E+=b,v+=L,b+=I,x+=Math.sqrt(C*C+E*E),d[P]=x;C+=v,E+=b,x+=Math.sqrt(C*C+E*E),d[8]=x,C+=v+L,E+=b+I,x+=Math.sqrt(C*C+E*E),d[9]=x,I=0}for(B*=x;;I++)if(!((v=d[I])<B)){0==I?B/=v:B=I+(B-(L=d[I-1]))/(v-L);break}this.addCurvePosition(.1*B,p,f,R,g,m,y,T,S,c,n,i||0<A&&0==F)}}else{var p,f=(p=t.lengths)[d=d-(l?1:2)];if(n&&(o*=f),s)for(var A=0;A<e;A++)a[A]*=f;for(h=D.Utils.setArraySize(this.world,8),s=n=A=0;A<e;A++,n+=3){var F,R,L,B=o+=F=a[A];if(l)(B%=f)<0&&(B+=f),s=0;else{if(B<0){_!=w.BEFORE&&(_=w.BEFORE,t.computeWorldVertices(r,2,4,h,0,2)),this.addBeforePosition(B,h,0,c,n);continue}if(f<B){_!=w.AFTER&&(_=w.AFTER,t.computeWorldVertices(r,u-6,4,h,0,2)),this.addAfterPosition(B-f,h,0,c,n);continue}}for(;;s++)if(!((R=p[s])<B)){0==s?B/=R:B=(B-(L=p[s-1]))/(R-L);break}s!=_&&(_=s,l&&s==d?(t.computeWorldVertices(r,u-4,4,h,0,2),t.computeWorldVertices(r,0,4,h,4,2)):t.computeWorldVertices(r,6*s+2,8,h,0,2)),this.addCurvePosition(B,h[0],h[1],h[2],h[3],h[4],h[5],h[6],h[7],c,n,i||0<A&&0==F)}}return c},w.prototype.addBeforePosition=function(t,e,i,n,s){var r=e[i],o=e[i+1];e=Math.atan2(e[i+3]-o,e[i+2]-r),n[s]=r+t*Math.cos(e),n[s+1]=o+t*Math.sin(e),n[s+2]=e},w.prototype.addAfterPosition=function(t,e,i,n,s){var r=e[i+2],o=e[i+3];e=Math.atan2(o-e[i+1],r-e[i]),n[s]=r+t*Math.cos(e),n[s+1]=o+t*Math.sin(e),n[s+2]=e},w.prototype.addCurvePosition=function(t,e,i,n,s,r,o,a,c,h,l,u){var d=(t=0!=t&&!isNaN(t)?t:1e-4)*t,_=d*t,p=1-t,f=p*p,g=f*p,m=p*t,y=3*m;c=i*g+s*(p=p*y)+o*(t*=y)+c*_,h[l]=a=e*g+n*p+r*t+a*_,h[l+1]=c,u&&(h[l+2]=Math.atan2(c-(i*f+s*m*2+o*d),a-(e*f+n*m*2+r*d)))},w.prototype.getOrder=function(){return this.data.order};var t=w;function w(t,e){if(this.translateMix=this.rotateMix=this.spacing=this.position=0,this.spaces=[],this.positions=[],this.world=[],this.curves=[],this.lengths=[],this.segments=[],null==t)throw Error("data cannot be null.");if(null==e)throw Error("skeleton cannot be null.");this.data=t,this.bones=[];for(var i=0,n=t.bones.length;i<n;i++)this.bones.push(e.findBone(t.bones[i].name));this.target=e.findSlot(t.target.name),this.position=t.position,this.spacing=t.spacing,this.rotateMix=t.rotateMix,this.translateMix=t.translateMix}t.NONE=-1,t.BEFORE=-2,t.AFTER=-3,D.PathConstraint=t}(spine=spine||{}),!function(t){var e;t.PathConstraintData=function(t){this.order=0,this.bones=[],this.name=t},(e=t.PositionMode||(t.PositionMode={}))[e.Fixed=0]="Fixed",e[e.Percent=1]="Percent",(e=t.SpacingMode||(t.SpacingMode={}))[e.Length=0]="Length",e[e.Fixed=1]="Fixed",e[e.Percent=2]="Percent",(e=t.RotateMode||(t.RotateMode={}))[e.Tangent=0]="Tangent",e[e.Chain=1]="Chain",e[e.ChainScale=2]="ChainScale"}(spine=spine||{}),!function(){var e;Math.fround||(Math.fround=(e=new Float32Array(1),function(t){return e[0]=t,e[0]}))}(),!function(t){i.prototype.loaded=function(){var t,e=0;for(t in this.assets)e++;return e};var s=i;function e(t){void 0===t&&(t=""),this.clientAssets={},this.queuedAssets={},this.rawAssets={},this.errors={},this.pathPrefix=t}function i(t){this.toLoad=[],this.assets={},this.clientId=t}e.prototype.queueAsset=function(t,e,i){var n=this.clientAssets[t];return null==n&&(n=new s(t),this.clientAssets[t]=n),null!==e&&(n.textureLoader=e),n.toLoad.push(i),this.queuedAssets[i]!==i&&(this.queuedAssets[i]=i,!0)},e.prototype.loadText=function(t,e){var i,n=this;e=this.pathPrefix+e,this.queueAsset(t,null,e)&&((i=new XMLHttpRequest).onreadystatechange=function(){i.readyState==XMLHttpRequest.DONE&&(200<=i.status&&i.status<300?n.rawAssets[e]=i.responseText:n.errors[e]="Couldn't load text "+e+": status "+i.status+", "+i.responseText)},i.open("GET",e,!0),i.send())},e.prototype.loadJson=function(t,e){var i,n=this;e=this.pathPrefix+e,this.queueAsset(t,null,e)&&((i=new XMLHttpRequest).onreadystatechange=function(){i.readyState==XMLHttpRequest.DONE&&(200<=i.status&&i.status<300?n.rawAssets[e]=JSON.parse(i.responseText):n.errors[e]="Couldn't load text "+e+": status "+i.status+", "+i.responseText)},i.open("GET",e,!0),i.send())},e.prototype.loadTexture=function(t,e,i){var n,s=this;i=this.pathPrefix+i,this.queueAsset(t,e,i)&&((n=new Image).src=i,n.crossOrigin="anonymous",n.onload=function(t){s.rawAssets[i]=n},n.onerror=function(t){s.errors[i]="Couldn't load image "+i})},e.prototype.get=function(t,e){e=this.pathPrefix+e;t=this.clientAssets[t];return null==t||t.assets[e]},e.prototype.updateClientAssets=function(t){for(var e=0;e<t.toLoad.length;e++){var i=t.toLoad[e],n=t.assets[i];null==n&&null!=(n=this.rawAssets[i])&&(t.assets[i]=n instanceof HTMLImageElement?t.textureLoader(n):n)}},e.prototype.isLoadingComplete=function(t){return null==(t=this.clientAssets[t])||(this.updateClientAssets(t),t.toLoad.length==t.loaded())},e.prototype.dispose=function(){},e.prototype.hasErrors=function(){return 0<Object.keys(this.errors).length},e.prototype.getErrors=function(){return this.errors},t.SharedAssetManager=e}(spine=spine||{}),!function(f){function t(t){if(this._updateCache=[],this.updateCacheReset=[],this.time=0,this.flipY=this.flipX=!1,this.y=this.x=0,null==t)throw Error("data cannot be null.");this.data=t,this.bones=[];for(var e=0;e<t.bones.length;e++){var i,n=t.bones[e],s=void 0;null==n.parent?s=new f.Bone(n,this,null):(i=this.bones[n.parent.index],s=new f.Bone(n,this,i),i.children.push(s)),this.bones.push(s)}for(this.slots=[],this.drawOrder=[],e=0;e<t.slots.length;e++)n=t.slots[e],s=this.bones[n.boneData.index],s=new f.Slot(n,s),this.slots.push(s),this.drawOrder.push(s);for(this.ikConstraints=[],e=0;e<t.ikConstraints.length;e++)this.ikConstraints.push(new f.IkConstraint(t.ikConstraints[e],this));for(this.transformConstraints=[],e=0;e<t.transformConstraints.length;e++)this.transformConstraints.push(new f.TransformConstraint(t.transformConstraints[e],this));for(this.pathConstraints=[],e=0;e<t.pathConstraints.length;e++)this.pathConstraints.push(new f.PathConstraint(t.pathConstraints[e],this));this.color=new f.Color(1,1,1,1),this.updateCache()}t.prototype.updateCache=function(){this._updateCache.length=0,this.updateCacheReset.length=0;for(var t=this.bones,e=0,i=t.length;e<i;e++)t[e].sorted=!1;var i=this.ikConstraints,n=this.transformConstraints,s=this.pathConstraints,r=i.length,o=n.length,a=s.length,c=r+o+a,e=0;t:for(;e<c;e++){for(var h=0;h<r;h++){var l=i[h];if(l.data.order==e){this.sortIkConstraint(l);continue t}}for(h=0;h<o;h++)if((l=n[h]).data.order==e){this.sortTransformConstraint(l);continue t}for(h=0;h<a;h++)if((l=s[h]).data.order==e){this.sortPathConstraint(l);continue t}}for(e=0,i=t.length;e<i;e++)this.sortBone(t[e])},t.prototype.sortIkConstraint=function(t){this.sortBone(t.target);var e,i=t.bones,n=i[0];this.sortBone(n),1<i.length&&(e=i[i.length-1],-1<this._updateCache.indexOf(e)||this.updateCacheReset.push(e)),this._updateCache.push(t),this.sortReset(n.children),i[i.length-1].sorted=!0},t.prototype.sortPathConstraint=function(t){var e=t.target,i=e.data.index,n=e.bone;null!=this.skin&&this.sortPathConstraintAttachment(this.skin,i,n),null!=this.data.defaultSkin&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,i,n);for(var s=0,r=this.data.skins.length;s<r;s++)this.sortPathConstraintAttachment(this.data.skins[s],i,n);for((s=e.getAttachment())instanceof f.PathAttachment&&this.sortPathConstraintAttachmentWith(s,n),e=(n=t.bones).length,s=0;s<e;s++)this.sortBone(n[s]);for(this._updateCache.push(t),s=0;s<e;s++)this.sortReset(n[s].children);for(s=0;s<e;s++)n[s].sorted=!0},t.prototype.sortTransformConstraint=function(t){this.sortBone(t.target);var e=t.bones,i=e.length;if(t.data.local)for(var n=0;n<i;n++){var s=e[n];this.sortBone(s.parent),-1<this._updateCache.indexOf(s)||this.updateCacheReset.push(s)}else for(n=0;n<i;n++)this.sortBone(e[n]);for(this._updateCache.push(t),t=0;t<i;t++)this.sortReset(e[t].children);for(t=0;t<i;t++)e[t].sorted=!0},t.prototype.sortPathConstraintAttachment=function(t,e,i){if(t=t.attachments[e])for(var n in t)this.sortPathConstraintAttachmentWith(t[n],i)},t.prototype.sortPathConstraintAttachmentWith=function(t,e){if(t instanceof f.PathAttachment){var i=t.bones;if(null==i)this.sortBone(e);else for(var n=this.bones,s=0;s<i.length;)for(var r=i[s++],r=s+r;s<r;s++)this.sortBone(n[i[s]])}},t.prototype.sortBone=function(t){var e;t.sorted||(null!=(e=t.parent)&&this.sortBone(e),t.sorted=!0,this._updateCache.push(t))},t.prototype.sortReset=function(t){for(var e=0,i=t.length;e<i;e++){var n=t[e];n.sorted&&this.sortReset(n.children),n.sorted=!1}},t.prototype.updateWorldTransform=function(){for(var t=this.updateCacheReset,e=0,i=t.length;e<i;e++){var n=t[e];n.ax=n.x,n.ay=n.y,n.arotation=n.rotation,n.ascaleX=n.scaleX,n.ascaleY=n.scaleY,n.ashearX=n.shearX,n.ashearY=n.shearY,n.appliedValid=!0}for(e=0,i=(t=this._updateCache).length;e<i;e++)t[e].update()},t.prototype.setToSetupPose=function(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()},t.prototype.setBonesToSetupPose=function(){for(var t=this.bones,e=0,i=t.length;e<i;e++)t[e].setToSetupPose();for(var n=this.ikConstraints,e=0,i=n.length;e<i;e++)(t=n[e]).bendDirection=t.data.bendDirection,t.mix=t.data.mix;for(var s=this.transformConstraints,e=0,i=s.length;e<i;e++)n=(t=s[e]).data,t.rotateMix=n.rotateMix,t.translateMix=n.translateMix,t.scaleMix=n.scaleMix,t.shearMix=n.shearMix;for(e=0,i=(s=this.pathConstraints).length;e<i;e++)n=(t=s[e]).data,t.position=n.position,t.spacing=n.spacing,t.rotateMix=n.rotateMix,t.translateMix=n.translateMix},t.prototype.setSlotsToSetupPose=function(){var t=this.slots;f.Utils.arrayCopy(t,0,this.drawOrder,0,t.length);for(var e=0,i=t.length;e<i;e++)t[e].setToSetupPose()},t.prototype.getRootBone=function(){return 0==this.bones.length?null:this.bones[0]},t.prototype.findBone=function(t){if(null==t)throw Error("boneName cannot be null.");for(var e=this.bones,i=0,n=e.length;i<n;i++){var s=e[i];if(s.data.name==t)return s}return null},t.prototype.findBoneIndex=function(t){if(null==t)throw Error("boneName cannot be null.");for(var e=this.bones,i=0,n=e.length;i<n;i++)if(e[i].data.name==t)return i;return-1},t.prototype.findSlot=function(t){if(null==t)throw Error("slotName cannot be null.");for(var e=this.slots,i=0,n=e.length;i<n;i++){var s=e[i];if(s.data.name==t)return s}return null},t.prototype.findSlotIndex=function(t){if(null==t)throw Error("slotName cannot be null.");for(var e=this.slots,i=0,n=e.length;i<n;i++)if(e[i].data.name==t)return i;return-1},t.prototype.setSkinByName=function(t){var e=this.data.findSkin(t);if(null==e)throw Error("Skin not found: "+t);this.setSkin(e)},t.prototype.setSkin=function(t){if(null!=t)if(null!=this.skin)t.attachAll(this,this.skin);else for(var e=this.slots,i=0,n=e.length;i<n;i++){var s=e[i],r=s.data.attachmentName;null!=r&&null!=(r=t.getAttachment(i,r))&&s.setAttachment(r)}this.skin=t},t.prototype.getAttachmentByName=function(t,e){return this.getAttachment(this.data.findSlotIndex(t),e)},t.prototype.getAttachment=function(t,e){if(null==e)throw Error("attachmentName cannot be null.");if(null!=this.skin){var i=this.skin.getAttachment(t,e);if(null!=i)return i}return null!=this.data.defaultSkin?this.data.defaultSkin.getAttachment(t,e):null},t.prototype.setAttachment=function(t,e){if(null==t)throw Error("slotName cannot be null.");for(var i=this.slots,n=0,s=i.length;n<s;n++){var r=i[n];if(r.data.name==t){if((i=null)!=e&&null==(i=this.getAttachment(n,e)))throw Error("Attachment not found: "+e+", for slot: "+t);return void r.setAttachment(i)}}throw Error("Slot not found: "+t)},t.prototype.findIkConstraint=function(t){if(null==t)throw Error("constraintName cannot be null.");for(var e=this.ikConstraints,i=0,n=e.length;i<n;i++){var s=e[i];if(s.data.name==t)return s}return null},t.prototype.findTransformConstraint=function(t){if(null==t)throw Error("constraintName cannot be null.");for(var e=this.transformConstraints,i=0,n=e.length;i<n;i++){var s=e[i];if(s.data.name==t)return s}return null},t.prototype.findPathConstraint=function(t){if(null==t)throw Error("constraintName cannot be null.");for(var e=this.pathConstraints,i=0,n=e.length;i<n;i++){var s=e[i];if(s.data.name==t)return s}return null},t.prototype.getBounds=function(t,e,i){if(null==t)throw Error("offset cannot be null.");if(null==e)throw Error("size cannot be null.");for(var n=this.drawOrder,s=Number.POSITIVE_INFINITY,r=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY,a=Number.NEGATIVE_INFINITY,c=0,h=n.length;c<h;c++){var l=n[c],u=0,d=null;if((_=l.getAttachment())instanceof f.RegionAttachment?(d=f.Utils.setArraySize(i,u=8,0),_.computeWorldVertices(l.bone,d,0,2)):_ instanceof f.MeshAttachment&&(u=_.worldVerticesLength,d=f.Utils.setArraySize(i,u,0),_.computeWorldVertices(l,0,u,d,0,2)),null!=d)for(l=0,u=d.length;l<u;l+=2)var _=d[l],p=d[l+1],s=Math.min(s,_),r=Math.min(r,p),o=Math.max(o,_),a=Math.max(a,p)}t.set(s,r),e.set(o-s,a-r)},t.prototype.update=function(t){this.time+=t},f.Skeleton=t}(spine=spine||{}),!function(u){function t(){this.maxY=this.maxX=this.minY=this.minX=0,this.boundingBoxes=[],this.polygons=[],this.polygonPool=new u.Pool(function(){return u.Utils.newFloatArray(16)})}t.prototype.update=function(t,e){if(null==t)throw Error("skeleton cannot be null.");var i=this.boundingBoxes,n=this.polygons,s=this.polygonPool,r=t.slots,o=r.length;i.length=0,s.freeAll(n);for(var a=n.length=0;a<o;a++){var c,h=r[a],l=h.getAttachment();l instanceof u.BoundingBoxAttachment&&(i.push(l),(c=s.obtain()).length!=l.worldVerticesLength&&(c=u.Utils.newFloatArray(l.worldVerticesLength)),n.push(c),l.computeWorldVertices(h,0,l.worldVerticesLength,c,0,2))}e?this.aabbCompute():(this.minY=this.minX=Number.POSITIVE_INFINITY,this.maxY=this.maxX=Number.NEGATIVE_INFINITY)},t.prototype.aabbCompute=function(){for(var t=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,n=Number.NEGATIVE_INFINITY,s=this.polygons,r=0,o=s.length;r<o;r++)for(var a=h=s[r],c=0,h=h.length;c<h;c+=2)var l=a[c],u=a[c+1],t=Math.min(t,l),e=Math.min(e,u),i=Math.max(i,l),n=Math.max(n,u);this.minX=t,this.minY=e,this.maxX=i,this.maxY=n},t.prototype.aabbContainsPoint=function(t,e){return t>=this.minX&&t<=this.maxX&&e>=this.minY&&e<=this.maxY},t.prototype.aabbIntersectsSegment=function(t,e,i,n){var s=this.minX,r=this.minY,o=this.maxX,a=this.maxY;return!(t<=s&&i<=s||e<=r&&n<=r||o<=t&&o<=i||a<=e&&a<=n)&&(r<(n=(i=(n-e)/(i-t))*(s-t)+e)&&n<a||r<(n=i*(o-t)+e)&&n<a||s<(r=(r-e)/i+t)&&r<o||s<(r=(a-e)/i+t)&&r<o)},t.prototype.aabbIntersectsSkeleton=function(t){return this.minX<t.maxX&&this.maxX>t.minX&&this.minY<t.maxY&&this.maxY>t.minY},t.prototype.containsPoint=function(t,e){for(var i=this.polygons,n=0,s=i.length;n<s;n++)if(this.containsPointPolygon(i[n],t,e))return this.boundingBoxes[n];return null},t.prototype.containsPointPolygon=function(t,e,i){for(var n=t.length,s=n-2,r=!1,o=0;o<n;o+=2){var a,c=t[o+1],h=t[s+1];(c<i&&i<=h||h<i&&i<=c)&&(a=t[o])+(i-c)/(h-c)*(t[s]-a)<e&&(r=!r),s=o}return r},t.prototype.intersectsSegment=function(t,e,i,n){for(var s=this.polygons,r=0,o=s.length;r<o;r++)if(this.intersectsSegmentPolygon(s[r],t,e,i,n))return this.boundingBoxes[r];return null},t.prototype.intersectsSegmentPolygon=function(t,e,i,n,s){for(var r=t.length,o=e-n,a=i-s,c=e*s-i*n,h=t[r-2],l=t[r-1],u=0;u<r;u+=2){var d=t[u],_=t[u+1],p=h*_-l*d,f=h-d,g=l-_,m=o*g-a*f;if((h<=(f=(c*f-o*p)/m)&&f<=d||d<=f&&f<=h)&&(e<=f&&f<=n||n<=f&&f<=e)&&(l<=(h=(c*g-a*p)/m)&&h<=_||_<=h&&h<=l)&&(i<=h&&h<=s||s<=h&&h<=i))return!0;h=d,l=_}return!1},t.prototype.getPolygon=function(t){if(null==t)throw Error("boundingBox cannot be null.");return-1==(t=this.boundingBoxes.indexOf(t))?null:this.polygons[t]},t.prototype.getWidth=function(){return this.maxX-this.minX},t.prototype.getHeight=function(){return this.maxY-this.minY},u.SkeletonBounds=t}(spine=spine||{}),!function(W){function o(){this.triangulator=new W.Triangulator,this.clippingPolygon=[],this.clipOutput=[],this.clippedVertices=[],this.clippedTriangles=[],this.scratch=[]}o.prototype.clipStart=function(t,e){if(null!=this.clipAttachment)return 0;var i=(this.clipAttachment=e).worldVerticesLength,n=W.Utils.setArraySize(this.clippingPolygon,i);e.computeWorldVertices(t,0,i,n,0,2),i=this.clippingPolygon,o.makeClockwise(i);for(var n=0,s=(i=this.clippingPolygons=this.triangulator.decompose(i,this.triangulator.triangulate(i))).length;n<s;n++){var r=i[n];o.makeClockwise(r),r.push(r[0]),r.push(r[1])}return i.length},o.prototype.clipEndWithSlot=function(t){null!=this.clipAttachment&&this.clipAttachment.endSlot==t.data&&this.clipEnd()},o.prototype.clipEnd=function(){null!=this.clipAttachment&&(this.clippingPolygons=this.clipAttachment=null,this.clippedVertices.length=0,this.clippedTriangles.length=0,this.clippingPolygon.length=0)},o.prototype.isClipping=function(){return null!=this.clipAttachment},o.prototype.clipTriangles=function(t,e,i,M,n,s,r,o){e=this.clipOutput;var a=this.clippedVertices,c=this.clippedTriangles,O=this.clippingPolygons,G=this.clippingPolygons.length,h=o?12:8,l=0,u=(a.length=0,c.length=0);t:for(;u<M;u+=3)for(var d=i[u]<<1,_=t[d],p=t[1+d],f=n[d],g=n[1+d],d=i[u+1]<<1,m=t[d],y=t[1+d],T=n[d],S=n[1+d],d=i[u+2]<<1,C=t[d],E=t[1+d],I=n[d],d=n[1+d],v=0;v<G;v++){var b=a.length;if(!this.clip(_,p,m,y,C,E,O[v],e)){(L=W.Utils.setArraySize(a,b+3*h))[b]=_,L[b+1]=p,L[b+2]=s.r,L[b+3]=s.g,L[b+4]=s.b,L[b+5]=s.a,o?(L[b+6]=f,L[b+7]=g,L[b+8]=r.r,L[b+9]=r.g,L[b+10]=r.b,L[b+11]=r.a,L[b+12]=m,L[b+13]=y,L[b+14]=s.r,L[b+15]=s.g,L[b+16]=s.b,L[b+17]=s.a,L[b+18]=T,L[b+19]=S,L[b+20]=r.r,L[b+21]=r.g,L[b+22]=r.b,L[b+23]=r.a,L[b+24]=C,L[b+25]=E,L[b+26]=s.r,L[b+27]=s.g,L[b+28]=s.b,L[b+29]=s.a,L[b+30]=I,L[b+31]=d,L[b+32]=r.r,L[b+33]=r.g,L[b+34]=r.b,L[b+35]=r.a):(L[b+6]=f,L[b+7]=g,L[b+8]=m,L[b+9]=y,L[b+10]=s.r,L[b+11]=s.g,L[b+12]=s.b,L[b+13]=s.a,L[b+14]=T,L[b+15]=S,L[b+16]=C,L[b+17]=E,L[b+18]=s.r,L[b+19]=s.g,L[b+20]=s.b,L[b+21]=s.a,L[b+22]=I,L[b+23]=d),b=c.length,(A=W.Utils.setArraySize(c,b+3))[b]=l,A[b+1]=l+1,A[b+2]=l+2,l+=3;continue t}var A=e.length;if(0!=A){for(var F=y-E,x=C-m,P=_-C,k=E-p,V=1/(F*P+x*(p-E)),R=A>>1,U=this.clipOutput,L=W.Utils.setArraySize(a,b+R*h),B=0;B<A;B+=2){var D=U[B],w=U[B+1],D=(L[b]=D,L[b+1]=w,L[b+2]=s.r,L[b+3]=s.g,L[b+4]=s.b,L[b+5]=s.a,D-C),N=w-E;L[b+6]=f*(w=(F*D+x*N)*V)+T*(D=(k*D+P*N)*V)+I*(N=1-w-D),L[b+7]=g*w+S*D+d*N,o&&(L[b+8]=r.r,L[b+9]=r.g,L[b+10]=r.b,L[b+11]=r.a),b+=h}for(b=c.length,A=W.Utils.setArraySize(c,b+3*(R-2)),R--,B=1;B<R;B++)A[b]=l,A[b+1]=l+B,A[b+2]=l+B+1,b+=3;l+=1+R}}},o.prototype.clip=function(t,e,i,n,s,r,o,a){var c=a,h=!1,l=null;for(2<=o.length%4?(l=a,a=this.scratch):l=this.scratch,l.length=0,l.push(t),l.push(e),l.push(i),l.push(n),l.push(s),l.push(r),l.push(t),l.push(e),a.length=0,e=o.length-4,t=0;;t+=2){i=o[t],n=o[t+1];for(var u=i-(s=o[t+2]),d=n-(r=o[t+3]),_=l,p=l.length-2,f=a.length,g=0;g<p;g+=2){var m=_[g],y=_[g+1],T=_[g+2],S=_[g+3],C=0<u*(S-r)-d*(T-s);if(0<u*(y-r)-d*(m-s)){if(C){a.push(T),a.push(S);continue}a.push(i+(s-i)*(h=((C=T-m)*(n-y)-(h=S-y)*(i-m))/(h*(s-i)-C*(r-n)))),a.push(n+(r-n)*h)}else C&&(a.push(i+(s-i)*(h=((C=T-m)*(n-y)-(h=S-y)*(i-m))/(h*(s-i)-C*(r-n)))),a.push(n+(r-n)*h),a.push(T),a.push(S));h=!0}if(f==a.length)return!(c.length=0);if(a.push(a[0]),a.push(a[1]),t==e)break;i=a,(a=l).length=0,l=i}if(c!=a)for(t=c.length=0,o=a.length-2;t<o;t++)c[t]=a[t];else c.length-=2;return h},o.makeClockwise=function(t){for(var e,i=t.length,n=t[i-2]*t[1]-t[0]*t[i-1],s=0,r=0,o=0,a=i-3;o<a;o+=2)s=t[o],r=t[o+1],e=t[o+2],n+=s*t[o+3]-e*r;if(!(n<0))for(o=0,n=i-2,a=i>>1;o<a;o+=2)i=t[o],s=t[o+1],t[o]=t[r=n-o],t[o+1]=t[r+1],t[r]=i,t[r+1]=s},W.SkeletonClipping=o}(spine=spine||{}),!function(t){function e(){this.bones=[],this.slots=[],this.skins=[],this.events=[],this.animations=[],this.ikConstraints=[],this.transformConstraints=[],this.pathConstraints=[],this.fps=0}e.prototype.findBone=function(t){if(null==t)throw Error("boneName cannot be null.");for(var e=this.bones,i=0,n=e.length;i<n;i++){var s=e[i];if(s.name==t)return s}return null},e.prototype.findBoneIndex=function(t){if(null==t)throw Error("boneName cannot be null.");for(var e=this.bones,i=0,n=e.length;i<n;i++)if(e[i].name==t)return i;return-1},e.prototype.findSlot=function(t){if(null==t)throw Error("slotName cannot be null.");for(var e=this.slots,i=0,n=e.length;i<n;i++){var s=e[i];if(s.name==t)return s}return null},e.prototype.findSlotIndex=function(t){if(null==t)throw Error("slotName cannot be null.");for(var e=this.slots,i=0,n=e.length;i<n;i++)if(e[i].name==t)return i;return-1},e.prototype.findSkin=function(t){if(null==t)throw Error("skinName cannot be null.");for(var e=this.skins,i=0,n=e.length;i<n;i++){var s=e[i];if(s.name==t)return s}return null},e.prototype.findEvent=function(t){if(null==t)throw Error("eventDataName cannot be null.");for(var e=this.events,i=0,n=e.length;i<n;i++){var s=e[i];if(s.name==t)return s}return null},e.prototype.findAnimation=function(t){if(null==t)throw Error("animationName cannot be null.");for(var e=this.animations,i=0,n=e.length;i<n;i++){var s=e[i];if(s.name==t)return s}return null},e.prototype.findIkConstraint=function(t){if(null==t)throw Error("constraintName cannot be null.");for(var e=this.ikConstraints,i=0,n=e.length;i<n;i++){var s=e[i];if(s.name==t)return s}return null},e.prototype.findTransformConstraint=function(t){if(null==t)throw Error("constraintName cannot be null.");for(var e=this.transformConstraints,i=0,n=e.length;i<n;i++){var s=e[i];if(s.name==t)return s}return null},e.prototype.findPathConstraint=function(t){if(null==t)throw Error("constraintName cannot be null.");for(var e=this.pathConstraints,i=0,n=e.length;i<n;i++){var s=e[i];if(s.name==t)return s}return null},e.prototype.findPathConstraintIndex=function(t){if(null==t)throw Error("pathConstraintName cannot be null.");for(var e=this.pathConstraints,i=0,n=e.length;i<n;i++)if(e[i].name==t)return i;return-1},t.SkeletonData=e}(spine=spine||{}),!function(v){function p(t){this.scale=1,this.linkedMeshes=[],this.attachmentLoader=t}p.prototype.readSkeletonData=function(t){var e,i=this.scale,n=new v.SkeletonData,s=(t="string"==typeof t?JSON.parse(t):t).skeleton;if(null!=s&&(n.hash=s.hash,n.version=s.spine,n.width=s.width,n.height=s.height,n.fps=s.fps,n.imagesPath=s.images),t.bones)for(s=0;s<t.bones.length;s++){var r=t.bones[s],o=null;if(null!=(c=this.getValue(r,"parent",null))&&null==(o=n.findBone(c)))throw Error("Parent bone not found: "+c);(o=new v.BoneData(n.bones.length,r.name,o)).length=this.getValue(r,"length",0)*i,o.x=this.getValue(r,"x",0)*i,o.y=this.getValue(r,"y",0)*i,o.rotation=this.getValue(r,"rotation",0),o.scaleX=this.getValue(r,"scaleX",1),o.scaleY=this.getValue(r,"scaleY",1),o.shearX=this.getValue(r,"shearX",0),o.shearY=this.getValue(r,"shearY",0),o.transformMode=p.transformModeFromString(this.getValue(r,"transform","normal")),n.bones.push(o)}if(t.slots)for(s=0;s<t.slots.length;s++){var a=(r=t.slots[s]).name,c=r.bone;if(null==(o=n.findBone(c)))throw Error("Slot bone not found: "+c);o=new v.SlotData(n.slots.length,a,o),null!=(c=this.getValue(r,"color",null))&&o.color.setFromString(c),null!=(c=this.getValue(r,"dark",null))&&(o.darkColor=new v.Color(1,1,1,1),o.darkColor.setFromString(c)),o.attachmentName=this.getValue(r,"attachment",null),o.blendMode=p.blendModeFromString(this.getValue(r,"blend","normal")),n.slots.push(o)}if(t.ik)for(s=0;s<t.ik.length;s++){r=t.ik[s],(o=new v.IkConstraintData(r.name)).order=this.getValue(r,"order",0);for(var h=0;h<r.bones.length;h++){var c=r.bones[h],l=n.findBone(c);if(null==l)throw Error("IK bone not found: "+c);o.bones.push(l)}if(c=r.target,o.target=n.findBone(c),null==o.target)throw Error("IK target bone not found: "+c);o.bendDirection=this.getValue(r,"bendPositive",!0)?1:-1,o.mix=this.getValue(r,"mix",1),n.ikConstraints.push(o)}if(t.transform)for(s=0;s<t.transform.length;s++){for(r=t.transform[s],(o=new v.TransformConstraintData(r.name)).order=this.getValue(r,"order",0),h=0;h<r.bones.length;h++){if(c=r.bones[h],null==(l=n.findBone(c)))throw Error("Transform constraint bone not found: "+c);o.bones.push(l)}if(c=r.target,o.target=n.findBone(c),null==o.target)throw Error("Transform constraint target bone not found: "+c);o.local=this.getValue(r,"local",!1),o.relative=this.getValue(r,"relative",!1),o.offsetRotation=this.getValue(r,"rotation",0),o.offsetX=this.getValue(r,"x",0)*i,o.offsetY=this.getValue(r,"y",0)*i,o.offsetScaleX=this.getValue(r,"scaleX",0),o.offsetScaleY=this.getValue(r,"scaleY",0),o.offsetShearY=this.getValue(r,"shearY",0),o.rotateMix=this.getValue(r,"rotateMix",1),o.translateMix=this.getValue(r,"translateMix",1),o.scaleMix=this.getValue(r,"scaleMix",1),o.shearMix=this.getValue(r,"shearMix",1),n.transformConstraints.push(o)}if(t.path)for(s=0;s<t.path.length;s++){for(r=t.path[s],(o=new v.PathConstraintData(r.name)).order=this.getValue(r,"order",0),h=0;h<r.bones.length;h++){if(c=r.bones[h],null==(l=n.findBone(c)))throw Error("Transform constraint bone not found: "+c);o.bones.push(l)}if(c=r.target,o.target=n.findSlot(c),null==o.target)throw Error("Path target slot not found: "+c);o.positionMode=p.positionModeFromString(this.getValue(r,"positionMode","percent")),o.spacingMode=p.spacingModeFromString(this.getValue(r,"spacingMode","length")),o.rotateMode=p.rotateModeFromString(this.getValue(r,"rotateMode","tangent")),o.offsetRotation=this.getValue(r,"rotation",0),o.position=this.getValue(r,"position",0),o.positionMode==v.PositionMode.Fixed&&(o.position*=i),o.spacing=this.getValue(r,"spacing",0),o.spacingMode!=v.SpacingMode.Length&&o.spacingMode!=v.SpacingMode.Fixed||(o.spacing*=i),o.rotateMix=this.getValue(r,"rotateMix",1),o.translateMix=this.getValue(r,"translateMix",1),n.pathConstraints.push(o)}if(t.skins)for(var u in t.skins){for(a in s=t.skins[u],i=new v.Skin(u),s){if(-1==(o=n.findSlotIndex(a)))throw Error("Slot not found: "+a);for(e in r=s[a])c=this.readAttachment(r[e],i,o,e,n),null!=c&&i.addAttachment(o,e,c)}n.skins.push(i),"default"==i.name&&(n.defaultSkin=i)}for(s=0,a=this.linkedMeshes.length;s<a;s++){if(null==(i=null==(u=this.linkedMeshes[s]).skin?n.defaultSkin:n.findSkin(u.skin)))throw Error("Skin not found: "+u.skin);if(null==(e=i.getAttachment(u.slotIndex,u.parent)))throw Error("Parent mesh not found: "+u.parent);u.mesh.setParentMesh(e),u.mesh.updateUVs()}if(this.linkedMeshes.length=0,t.events)for(var d in t.events)a=t.events[d],o=new v.EventData(d),o.intValue=this.getValue(a,"int",0),o.floatValue=this.getValue(a,"float",0),o.stringValue=this.getValue(a,"string",""),n.events.push(o);if(t.animations)for(var _ in t.animations)this.readAnimation(t.animations[_],_,n);return n},p.prototype.readAttachment=function(t,e,i,n,s){var r=this.scale;switch(n=this.getValue(t,"name",n),this.getValue(t,"type","region")){case"region":if(s=this.getValue(t,"path",n),null==(i=this.attachmentLoader.newRegionAttachment(e,n,s)))break;return i.path=s,i.x=this.getValue(t,"x",0)*r,i.y=this.getValue(t,"y",0)*r,i.scaleX=this.getValue(t,"scaleX",1),i.scaleY=this.getValue(t,"scaleY",1),i.rotation=this.getValue(t,"rotation",0),i.width=t.width*r,i.height=t.height*r,null!=(r=this.getValue(t,"color",null))&&i.color.setFromString(r),i.updateOffset(),i;case"boundingbox":if(null==(s=this.attachmentLoader.newBoundingBoxAttachment(e,n)))break;return this.readVertices(t,s,t.vertexCount<<1),null!=(r=this.getValue(t,"color",null))&&s.color.setFromString(r),s;case"mesh":case"linkedmesh":if(s=this.getValue(t,"path",n),null==(e=this.attachmentLoader.newMeshAttachment(e,n,s)))break;return e.path=s,null!=(r=this.getValue(t,"color",null))&&e.color.setFromString(r),null!=(r=this.getValue(t,"parent",null))?(e.inheritDeform=this.getValue(t,"deform",!0),this.linkedMeshes.push(new o(e,this.getValue(t,"skin",null),i,r))):(r=t.uvs,this.readVertices(t,e,r.length),e.triangles=t.triangles,e.regionUVs=r,e.updateUVs(),e.hullLength=2*this.getValue(t,"hull",0)),e;case"path":if(null==(s=this.attachmentLoader.newPathAttachment(e,n)))break;for(s.closed=this.getValue(t,"closed",!1),s.constantSpeed=this.getValue(t,"constantSpeed",!0),e=t.vertexCount,this.readVertices(t,s,e<<1),i=v.Utils.newArray(e/3,0),e=0;e<t.lengths.length;e++)i[e]=t.lengths[e]*r;return s.lengths=i,null!=(r=this.getValue(t,"color",null))&&s.color.setFromString(r),s;case"point":if(null==(s=this.attachmentLoader.newPointAttachment(e,n)))break;return s.x=this.getValue(t,"x",0)*r,s.y=this.getValue(t,"y",0)*r,s.rotation=this.getValue(t,"rotation",0),null!=(r=this.getValue(t,"color",null))&&s.color.setFromString(r),s;case"clipping":if(null==(i=this.attachmentLoader.newClippingAttachment(e,n)))break;if(null!=(r=this.getValue(t,"end",null))){if(null==(s=s.findSlot(r)))throw Error("Clipping end slot not found: "+r);i.endSlot=s}return e=t.vertexCount,this.readVertices(t,i,e<<1),null!=(r=this.getValue(t,"color",null))&&i.color.setFromString(r),i}return null},p.prototype.readVertices=function(t,e,i){var n=this.scale;if((e.worldVerticesLength=i)==(t=t.vertices).length){var s=v.Utils.toFloatArray(t);if(1!=n){i=0;for(var r=t.length;i<r;i++)s[i]*=n}e.vertices=s}else{var s=[],o=[];for(i=0,r=t.length;i<r;){var a=t[i++];for(o.push(a),a=i+4*a;i<a;i+=4)o.push(t[i]),s.push(t[i+1]*n),s.push(t[i+2]*n),s.push(t[i+3])}e.bones=o,e.vertices=v.Utils.toFloatArray(s)}},p.prototype.readAnimation=function(t,e,i){var n=this.scale,s=[],r=0;if(t.slots)for(var o in t.slots){var a,c=t.slots[o],h=i.findSlotIndex(o);if(-1==h)throw Error("Slot not found: "+o);for(a in c){var l=c[a];if("attachment"==a){(S=new v.AttachmentTimeline(l.length)).slotIndex=h;for(var u=0,d=0;d<l.length;d++){var _=l[d];S.setFrame(u++,_.time,_.name)}s.push(S),r=Math.max(r,S.frames[S.getFrameCount()-1])}else if("color"==a){for((S=new v.ColorTimeline(l.length)).slotIndex=h,d=u=0;d<l.length;d++){_=l[d];(p=new v.Color).setFromString(_.color),S.setFrame(u,_.time,p.r,p.g,p.b,p.a),this.readCurve(_,S,u),u++}s.push(S),r=Math.max(r,S.frames[(S.getFrameCount()-1)*v.ColorTimeline.ENTRIES])}else{if("twoColor"!=a)throw Error("Invalid timeline type for a slot: "+a+" ("+o+")");for((S=new v.TwoColorTimeline(l.length)).slotIndex=h,d=u=0;d<l.length;d++){var _=l[d],p=new v.Color,f=new v.Color;p.setFromString(_.light),f.setFromString(_.dark),S.setFrame(u,_.time,p.r,p.g,p.b,p.a,f.r,f.g,f.b),this.readCurve(_,S,u),u++}s.push(S),r=Math.max(r,S.frames[(S.getFrameCount()-1)*v.TwoColorTimeline.ENTRIES])}}}if(t.bones)for(var g in t.bones){if(c=t.bones[g],-1==(p=i.findBoneIndex(g)))throw Error("Bone not found: "+g);for(a in c)if(l=c[a],"rotate"===a){for((S=new v.RotateTimeline(l.length)).boneIndex=p,d=u=0;d<l.length;d++)_=l[d],S.setFrame(u,_.time,_.angle),this.readCurve(_,S,u),u++;s.push(S),r=Math.max(r,S.frames[(S.getFrameCount()-1)*v.RotateTimeline.ENTRIES])}else{if("translate"!==a&&"scale"!==a&&"shear"!==a)throw Error("Invalid timeline type for a bone: "+a+" ("+g+")");for(h=1,"scale"===a?S=new v.ScaleTimeline(l.length):"shear"===a?S=new v.ShearTimeline(l.length):(S=new v.TranslateTimeline(l.length),h=n),S.boneIndex=p,d=u=0;d<l.length;d++){var _=l[d],f=this.getValue(_,"x",0),m=this.getValue(_,"y",0);S.setFrame(u,_.time,f*h,m*h),this.readCurve(_,S,u),u++}s.push(S),r=Math.max(r,S.frames[(S.getFrameCount()-1)*v.TranslateTimeline.ENTRIES])}}if(t.ik)for(var y in t.ik){for(c=t.ik[y],u=i.findIkConstraint(y),(S=new v.IkConstraintTimeline(c.length)).ikConstraintIndex=i.ikConstraints.indexOf(u),d=u=0;d<c.length;d++)_=c[d],S.setFrame(u,_.time,this.getValue(_,"mix",1),this.getValue(_,"bendPositive",!0)?1:-1),this.readCurve(_,S,u),u++;s.push(S),r=Math.max(r,S.frames[(S.getFrameCount()-1)*v.IkConstraintTimeline.ENTRIES])}if(t.transform)for(y in t.transform){for(c=t.transform[y],u=i.findTransformConstraint(y),(S=new v.TransformConstraintTimeline(c.length)).transformConstraintIndex=i.transformConstraints.indexOf(u),d=u=0;d<c.length;d++)_=c[d],S.setFrame(u,_.time,this.getValue(_,"rotateMix",1),this.getValue(_,"translateMix",1),this.getValue(_,"scaleMix",1),this.getValue(_,"shearMix",1)),this.readCurve(_,S,u),u++;s.push(S),r=Math.max(r,S.frames[(S.getFrameCount()-1)*v.TransformConstraintTimeline.ENTRIES])}if(t.paths)for(y in t.paths){if(c=t.paths[y],-1==(g=i.findPathConstraintIndex(y)))throw Error("Path constraint not found: "+y);for(a in p=i.pathConstraints[g],c)if(l=c[a],"position"===a||"spacing"===a){for(h=1,"spacing"===a?(S=new v.PathConstraintSpacingTimeline(l.length),p.spacingMode!=v.SpacingMode.Length&&p.spacingMode!=v.SpacingMode.Fixed||(h=n)):(S=new v.PathConstraintPositionTimeline(l.length),p.positionMode==v.PositionMode.Fixed&&(h=n)),S.pathConstraintIndex=g,d=u=0;d<l.length;d++)_=l[d],S.setFrame(u,_.time,this.getValue(_,a,0)*h),this.readCurve(_,S,u),u++;s.push(S),r=Math.max(r,S.frames[(S.getFrameCount()-1)*v.PathConstraintPositionTimeline.ENTRIES])}else if("mix"===a){for((S=new v.PathConstraintMixTimeline(l.length)).pathConstraintIndex=g,d=u=0;d<l.length;d++)_=l[d],S.setFrame(u,_.time,this.getValue(_,"rotateMix",1),this.getValue(_,"translateMix",1)),this.readCurve(_,S,u),u++;s.push(S),r=Math.max(r,S.frames[(S.getFrameCount()-1)*v.PathConstraintMixTimeline.ENTRIES])}}if(t.deform)for(var T in t.deform){if(g=t.deform[T],null==(p=i.findSkin(T)))throw Error("Skin not found: "+T);for(o in g){if(c=g[o],-1==(h=i.findSlotIndex(o)))throw Error("Slot not found: "+c.name);for(a in c){if(l=c[a],null==(u=p.getAttachment(h,a)))throw Error("Deform attachment not found: "+l.name);var S,f=null!=u.bones,m=u.vertices,C=f?m.length/3*2:m.length;for((S=new v.DeformTimeline(l.length)).slotIndex=h,S.attachment=u,y=u=0;y<l.length;y++){var _=l[y],E=void 0,I=this.getValue(_,"vertices",null);if(null==I)E=f?v.Utils.newFloatArray(C):m;else{if(E=v.Utils.newFloatArray(C),d=this.getValue(_,"offset",0),v.Utils.arrayCopy(I,0,E,d,I.length),1!=n)for(I=d+I.length;d<I;d++)E[d]*=n;if(!f)for(d=0;d<C;d++)E[d]+=m[d]}S.setFrame(u,_.time,E),this.readCurve(_,S,u),u++}s.push(S),r=Math.max(r,S.frames[S.getFrameCount()-1])}}}if(null!=(n=null==(n=t.drawOrder)?t.draworder:n)){for(S=new v.DrawOrderTimeline(n.length),o=i.slots.length,y=u=0;y<n.length;y++){if(a=n[y],(T=null)!=(l=this.getValue(a,"offsets",null))){for(T=v.Utils.newArray(o,-1),_=v.Utils.newArray(o-l.length,0),d=g=c=0;d<l.length;d++){if(p=l[d],-1==(h=i.findSlotIndex(p.slot)))throw Error("Slot not found: "+p.slot);for(;c!=h;)_[g++]=c++;T[c+p.offset]=c++}for(;c<o;)_[g++]=c++;for(d=o-1;0<=d;d--)-1==T[d]&&(T[d]=_[--g])}S.setFrame(u++,a.time,T)}s.push(S),r=Math.max(r,S.frames[S.getFrameCount()-1])}if(t.events){for(S=new v.EventTimeline(t.events.length),d=u=0;d<t.events.length;d++){if(n=t.events[d],null==(o=i.findEvent(n.name)))throw Error("Event not found: "+n.name);(h=new v.Event(v.Utils.toSinglePrecision(n.time),o)).intValue=this.getValue(n,"int",o.intValue),h.floatValue=this.getValue(n,"float",o.floatValue),h.stringValue=this.getValue(n,"string",o.stringValue),S.setFrame(u++,h)}s.push(S),r=Math.max(r,S.frames[S.getFrameCount()-1])}if(isNaN(r))throw Error("Error while parsing animation, duration is NaN");i.animations.push(new v.Animation(e,s,r))},p.prototype.readCurve=function(t,e,i){t.curve&&("stepped"===t.curve?e.setStepped(i):"[object Array]"===Object.prototype.toString.call(t.curve)&&(t=t.curve,e.setCurve(i,t[0],t[1],t[2],t[3])))},p.prototype.getValue=function(t,e,i){return void 0!==t[e]?t[e]:i},p.blendModeFromString=function(t){if("normal"==(t=t.toLowerCase()))return v.BlendMode.Normal;if("additive"==t)return v.BlendMode.Additive;if("multiply"==t)return v.BlendMode.Multiply;if("screen"==t)return v.BlendMode.Screen;throw Error("Unknown blend mode: "+t)},p.positionModeFromString=function(t){if("fixed"==(t=t.toLowerCase()))return v.PositionMode.Fixed;if("percent"==t)return v.PositionMode.Percent;throw Error("Unknown position mode: "+t)},p.spacingModeFromString=function(t){if("length"==(t=t.toLowerCase()))return v.SpacingMode.Length;if("fixed"==t)return v.SpacingMode.Fixed;if("percent"==t)return v.SpacingMode.Percent;throw Error("Unknown position mode: "+t)},p.rotateModeFromString=function(t){if("tangent"==(t=t.toLowerCase()))return v.RotateMode.Tangent;if("chain"==t)return v.RotateMode.Chain;if("chainscale"==t)return v.RotateMode.ChainScale;throw Error("Unknown rotate mode: "+t)},p.transformModeFromString=function(t){if("normal"==(t=t.toLowerCase()))return v.TransformMode.Normal;if("onlytranslation"==t)return v.TransformMode.OnlyTranslation;if("norotationorreflection"==t)return v.TransformMode.NoRotationOrReflection;if("noscale"==t)return v.TransformMode.NoScale;if("noscaleorreflection"==t)return v.TransformMode.NoScaleOrReflection;throw Error("Unknown transform mode: "+t)},v.SkeletonJson=p;var o=function(t,e,i,n){this.mesh=t,this.skin=e,this.slotIndex=i,this.parent=n}}(spine=spine||{}),!function(t){function e(t){if(this.attachments=[],null==t)throw Error("name cannot be null.");this.name=t}e.prototype.addAttachment=function(t,e,i){if(null==i)throw Error("attachment cannot be null.");var n=this.attachments;t>=n.length&&(n.length=t+1),n[t]||(n[t]={}),n[t][e]=i},e.prototype.getAttachment=function(t,e){t=this.attachments[t];return t?t[e]:null},e.prototype.attachAll=function(t,e){for(var i=0,n=0;n<t.slots.length;n++){var s=t.slots[n],r=s.getAttachment();if(r&&i<e.attachments.length){var o,a=e.attachments[i];for(o in a)if(r==a[o]){null!=(r=this.getAttachment(i,o))&&s.setAttachment(r);break}}i++}},t.Skin=e}(spine=spine||{}),!function(i){function t(t,e){if(this.attachmentVertices=[],null==t)throw Error("data cannot be null.");if(null==e)throw Error("bone cannot be null.");this.data=t,this.bone=e,this.color=new i.Color,this.darkColor=null==t.darkColor?null:new i.Color,this.setToSetupPose()}t.prototype.getAttachment=function(){return this.attachment},t.prototype.setAttachment=function(t){this.attachment!=t&&(this.attachment=t,this.attachmentTime=this.bone.skeleton.time,this.attachmentVertices.length=0)},t.prototype.setAttachmentTime=function(t){this.attachmentTime=this.bone.skeleton.time-t},t.prototype.getAttachmentTime=function(){return this.bone.skeleton.time-this.attachmentTime},t.prototype.setToSetupPose=function(){this.color.setFromColor(this.data.color),null!=this.darkColor&&this.darkColor.setFromColor(this.data.darkColor),null==this.data.attachmentName?this.attachment=null:(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName)))},i.Slot=t}(spine=spine||{}),!function(n){n.SlotData=function(t,e,i){if(this.color=new n.Color(1,1,1,1),t<0)throw Error("index must be >= 0.");if(null==e)throw Error("name cannot be null.");if(null==i)throw Error("boneData cannot be null.");this.index=t,this.name=e,this.boneData=i}}(spine=spine||{}),!function(t){var e,i,n;s.prototype.getImage=function(){return this._image},s.filterFromString=function(t){switch(t.toLowerCase()){case"nearest":return e.Nearest;case"linear":return e.Linear;case"mipmap":return e.MipMap;case"mipmapnearestnearest":return e.MipMapNearestNearest;case"mipmaplinearnearest":return e.MipMapLinearNearest;case"mipmapnearestlinear":return e.MipMapNearestLinear;case"mipmaplinearlinear":return e.MipMapLinearLinear;default:throw Error("Unknown texture filter "+t)}},s.wrapFromString=function(t){switch(t.toLowerCase()){case"mirroredtepeat":return i.MirroredRepeat;case"clamptoedge":return i.ClampToEdge;case"repeat":return i.Repeat;default:throw Error("Unknown texture wrap "+t)}};function s(t){this._image=t}t.Texture=s,(n=e=t.TextureFilter||(t.TextureFilter={}))[n.Nearest=9728]="Nearest",n[n.Linear=9729]="Linear",n[n.MipMap=9987]="MipMap",n[n.MipMapNearestNearest=9984]="MipMapNearestNearest",n[n.MipMapLinearNearest=9985]="MipMapLinearNearest",n[n.MipMapNearestLinear=9986]="MipMapNearestLinear",n[n.MipMapLinearLinear=9987]="MipMapLinearLinear",(n=i=t.TextureWrap||(t.TextureWrap={}))[n.MirroredRepeat=33648]="MirroredRepeat",n[n.ClampToEdge=33071]="ClampToEdge",n[n.Repeat=10497]="Repeat",t.TextureRegion=function(){this.height=this.width=this.v2=this.u2=this.v=this.u=0,this.rotate=!1,this.originalHeight=this.originalWidth=this.offsetY=this.offsetX=0}}(spine=spine||{}),!function(l){function t(t,e){this.pages=[],this.regions=[],this.load(t,e)}t.prototype.load=function(t,e){if(null==e)throw Error("textureLoader cannot be null.");for(var i=new u(t),n=Array(4),s=null;;){var r,o,a,c,h=i.readLine();if(null==h)break;0==(h=h.trim()).length?s=null:s?((r=new _).name=h,r.page=s,r.rotate="true"==i.readValue(),i.readTuple(n),h=parseInt(n[0]),o=parseInt(n[1]),i.readTuple(n),a=parseInt(n[0]),c=parseInt(n[1]),r.u=h/s.width,r.v=o/s.height,r.rotate?(r.u2=(h+c)/s.width,r.v2=(o+a)/s.height):(r.u2=(h+a)/s.width,r.v2=(o+c)/s.height),r.x=h,r.y=o,r.width=Math.abs(a),r.height=Math.abs(c),4==i.readTuple(n)&&4==i.readTuple(n)&&i.readTuple(n),r.originalWidth=parseInt(n[0]),r.originalHeight=parseInt(n[1]),i.readTuple(n),r.offsetX=parseInt(n[0]),r.offsetY=parseInt(n[1]),r.index=parseInt(i.readValue()),r.texture=s.texture,this.regions.push(r)):((s=new d).name=h,2==i.readTuple(n)&&(s.width=parseInt(n[0]),s.height=parseInt(n[1]),i.readTuple(n)),i.readTuple(n),s.minFilter=l.Texture.filterFromString(n[0]),s.magFilter=l.Texture.filterFromString(n[1]),r=i.readValue(),s.uWrap=l.TextureWrap.ClampToEdge,s.vWrap=l.TextureWrap.ClampToEdge,"x"==r?s.uWrap=l.TextureWrap.Repeat:"y"==r?s.vWrap=l.TextureWrap.Repeat:"xy"==r&&(s.uWrap=s.vWrap=l.TextureWrap.Repeat),s.texture=e(h),s.texture.setFilters(s.minFilter,s.magFilter),s.texture.setWraps(s.uWrap,s.vWrap),s.width=s.texture.getImage().width,s.height=s.texture.getImage().height,this.pages.push(s))}},t.prototype.findRegion=function(t){for(var e=0;e<this.regions.length;e++)if(this.regions[e].name==t)return this.regions[e];return null},t.prototype.dispose=function(){for(var t=0;t<this.pages.length;t++)this.pages[t].texture.dispose()},l.TextureAtlas=t;e.prototype.readLine=function(){return this.index>=this.lines.length?null:this.lines[this.index++]},e.prototype.readValue=function(){var t=this.readLine(),e=t.indexOf(":");if(-1==e)throw Error("Invalid line: "+t);return t.substring(e+1).trim()},e.prototype.readTuple=function(t){var e=this.readLine();if(-1==(n=e.indexOf(":")))throw Error("Invalid line: "+e);for(var i=0,n=n+1;i<3;i++){var s=e.indexOf(",",n);if(-1==s)break;t[i]=e.substr(n,s-n).trim(),n=s+1}return t[i]=e.substring(n).trim(),i+1};var u=e,d=function(){};function e(t){this.index=0,this.lines=t.split(/\r\n|\r|\n/)}l.TextureAtlasPage=d;i=l.TextureRegion,__extends(n,i);var i,_=n;function n(){return null!==i&&i.apply(this,arguments)||this}l.TextureAtlasRegion=_}(spine=spine||{}),!function(C){function t(t,e){if(this.shearMix=this.scaleMix=this.translateMix=this.rotateMix=0,this.temp=new C.Vector2,null==t)throw Error("data cannot be null.");if(null==e)throw Error("skeleton cannot be null.");this.data=t,this.rotateMix=t.rotateMix,this.translateMix=t.translateMix,this.scaleMix=t.scaleMix,this.shearMix=t.shearMix,this.bones=[];for(var i=0;i<t.bones.length;i++)this.bones.push(e.findBone(t.bones[i].name));this.target=e.findBone(t.target.name)}t.prototype.apply=function(){this.update()},t.prototype.update=function(){this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld()},t.prototype.applyAbsoluteWorld=function(){for(var t=this.rotateMix,e=this.translateMix,i=this.scaleMix,n=this.shearMix,s=this.target,r=s.a,o=s.b,a=s.c,c=s.d,h=0<r*c-o*a?C.MathUtils.degRad:-C.MathUtils.degRad,l=this.data.offsetRotation*h,h=this.data.offsetShearY*h,u=this.bones,d=0,_=u.length;d<_;d++){var p,f,g,m,y,T=u[d],S=!1;0!=t&&(p=T.a,S=T.b,f=T.c,g=T.d,(y=Math.atan2(a,r)-Math.atan2(f,p)+l)>C.MathUtils.PI?y-=C.MathUtils.PI2:y<-C.MathUtils.PI&&(y+=C.MathUtils.PI2),y*=t,m=Math.cos(y),y=Math.sin(y),T.a=m*p-y*f,T.b=m*S-y*g,T.c=y*p+m*f,T.d=y*S+m*g,S=!0),0!=e&&(S=this.temp,s.localToWorld(S.set(this.data.offsetX,this.data.offsetY)),T.worldX+=(S.x-T.worldX)*e,T.worldY+=(S.y-T.worldY)*e,S=!0),0<i&&(S=Math.sqrt(T.a*T.a+T.c*T.c),g=Math.sqrt(r*r+a*a),1e-5<S&&(S=(S+(g-S+this.data.offsetScaleX)*i)/S),T.a*=S,T.c*=S,S=Math.sqrt(T.b*T.b+T.d*T.d),g=Math.sqrt(o*o+c*c),1e-5<S&&(S=(S+(g-S+this.data.offsetScaleY)*i)/S),T.b*=S,T.d*=S,S=!0),0<n&&(S=T.b,g=T.d,p=Math.atan2(g,S),(y=Math.atan2(c,o)-Math.atan2(a,r)-(p-Math.atan2(T.c,T.a)))>C.MathUtils.PI?y-=C.MathUtils.PI2:y<-C.MathUtils.PI&&(y+=C.MathUtils.PI2),y=p+(y+h)*n,S=Math.sqrt(S*S+g*g),T.b=Math.cos(y)*S,T.d=Math.sin(y)*S,S=!0),S&&(T.appliedValid=!1)}},t.prototype.applyRelativeWorld=function(){for(var t=this.rotateMix,e=this.translateMix,i=this.scaleMix,n=this.shearMix,s=this.target,r=s.a,o=s.b,a=s.c,c=s.d,h=0<r*c-o*a?C.MathUtils.degRad:-C.MathUtils.degRad,l=this.data.offsetRotation*h,h=this.data.offsetShearY*h,u=this.bones,d=0,_=u.length;d<_;d++){var p,f,g,m,y,T=u[d],S=!1;0!=t&&(S=T.a,p=T.b,f=T.c,g=T.d,(y=Math.atan2(a,r)+l)>C.MathUtils.PI?y-=C.MathUtils.PI2:y<-C.MathUtils.PI&&(y+=C.MathUtils.PI2),y*=t,m=Math.cos(y),y=Math.sin(y),T.a=m*S-y*f,T.b=m*p-y*g,T.c=y*S+m*f,T.d=y*p+m*g,S=!0),0!=e&&(S=this.temp,s.localToWorld(S.set(this.data.offsetX,this.data.offsetY)),T.worldX+=S.x*e,T.worldY+=S.y*e,S=!0),0<i&&(S=(Math.sqrt(r*r+a*a)-1+this.data.offsetScaleX)*i+1,T.a*=S,T.c*=S,S=(Math.sqrt(o*o+c*c)-1+this.data.offsetScaleY)*i+1,T.b*=S,T.d*=S,S=!0),0<n&&((y=Math.atan2(c,o)-Math.atan2(a,r))>C.MathUtils.PI?y-=C.MathUtils.PI2:y<-C.MathUtils.PI&&(y+=C.MathUtils.PI2),p=T.b,g=T.d,y=Math.atan2(g,p)+(y-C.MathUtils.PI/2+h)*n,S=Math.sqrt(p*p+g*g),T.b=Math.cos(y)*S,T.d=Math.sin(y)*S,S=!0),S&&(T.appliedValid=!1)}},t.prototype.applyAbsoluteLocal=function(){var t=this.rotateMix,e=this.translateMix,i=this.scaleMix,n=this.shearMix,s=this.target;s.appliedValid||s.updateAppliedTransform();for(var r=this.bones,o=0,a=r.length;o<a;o++){var c,h=r[o],l=(h.appliedValid||h.updateAppliedTransform(),h.arotation),u=(0!=t&&(c=s.arotation-l+this.data.offsetRotation,l+=(c-=360*(16384-(16384.499999999996-c/360|0)))*t),h.ax),d=h.ay,_=(0!=e&&(u+=(s.ax-u+this.data.offsetX)*e,d+=(s.ay-d+this.data.offsetY)*e),h.ascaleX),p=h.ascaleY,f=(0<i&&(1e-5<_&&(_=(_+(s.ascaleX-_+this.data.offsetScaleX)*i)/_),1e-5<p)&&(p=(p+(s.ascaleY-p+this.data.offsetScaleY)*i)/p),h.ashearY);0<n&&(c=s.ashearY-f+this.data.offsetShearY,c-=360*(16384-(16384.499999999996-c/360|0)),h.shearY+=c*n),h.updateWorldTransformWith(u,d,l,_,p,h.ashearX,f)}},t.prototype.applyRelativeLocal=function(){var t=this.rotateMix,e=this.translateMix,i=this.scaleMix,n=this.shearMix,s=this.target;s.appliedValid||s.updateAppliedTransform();for(var r=this.bones,o=0,a=r.length;o<a;o++){var c=r[o],h=(c.appliedValid||c.updateAppliedTransform(),c.arotation),l=(0!=t&&(h+=(s.arotation+this.data.offsetRotation)*t),c.ax),u=c.ay,d=(0!=e&&(l+=(s.ax+this.data.offsetX)*e,u+=(s.ay+this.data.offsetY)*e),c.ascaleX),_=c.ascaleY,p=(0<i&&(1e-5<d&&(d*=(s.ascaleX-1+this.data.offsetScaleX)*i+1),1e-5<_)&&(_*=(s.ascaleY-1+this.data.offsetScaleY)*i+1),c.ashearY);0<n&&(p+=(s.ashearY+this.data.offsetShearY)*n),c.updateWorldTransformWith(l,u,h,d,_,c.ashearX,p)}},t.prototype.getOrder=function(){return this.data.order},C.TransformConstraint=t}(spine=spine||{}),(spine||(spine={})).TransformConstraintData=function(t){if(this.order=0,this.bones=[],this.offsetShearY=this.offsetScaleY=this.offsetScaleX=this.offsetY=this.offsetX=this.offsetRotation=this.shearMix=this.scaleMix=this.translateMix=this.rotateMix=0,this.local=this.relative=!1,null==t)throw Error("name cannot be null.");this.name=t},!function(t){function F(){this.convexPolygons=[],this.convexPolygonsIndices=[],this.indicesArray=[],this.isConcaveArray=[],this.triangles=[],this.polygonPool=new t.Pool(function(){return[]}),this.polygonIndicesPool=new t.Pool(function(){return[]})}F.prototype.triangulate=function(t){for(var e=t.length>>1,i=this.indicesArray,n=i.length=0;n<e;n++)i[n]=n;for(var s=this.isConcaveArray,n=s.length=0,r=e;n<r;++n)s[n]=F.isConcave(n,e,t,i);for((r=this.triangles).length=0;3<e;){for(var o=e-1,n=0,a=1;;){t:if(!s[n]){for(var c=i[o]<<1,h=i[n]<<1,l=i[a]<<1,u=t[c],c=t[1+c],d=t[h],h=t[1+h],_=t[l],l=t[1+l],p=(a+1)%e;p!=o;p=(p+1)%e)if(s[p]){var f=t[g=i[p]<<1],g=t[1+g];if(F.positiveArea(_,l,u,c,f,g)&&F.positiveArea(u,c,d,h,f,g)&&F.positiveArea(d,h,_,l,f,g))break t}break}if(0==a){for(;s[n]&&0<--n;);break}o=n,a=((n=a)+1)%e}r.push(i[(e+n-1)%e]),r.push(i[n]),r.push(i[(n+1)%e]),i.splice(n,1),s.splice(n,1),o=(--e+n-1)%e,n=n==e?0:n,s[o]=F.isConcave(o,e,t,i),s[n]=F.isConcave(n,e,t,i)}return 3==e&&(r.push(i[2]),r.push(i[0]),r.push(i[1])),r},F.prototype.decompose=function(t,e){for(var i,n,s,r=this.convexPolygons,o=(this.polygonPool.freeAll(r),r.length=0,this.convexPolygonsIndices),a=(this.polygonIndicesPool.freeAll(o),o.length=0,this.polygonIndicesPool.obtain()),c=(a.length=0,this.polygonPool.obtain()),h=-1,l=c.length=0,u=0,d=e.length;u<d;u+=3){var _,p=e[u]<<1,f=e[u+1]<<1,g=e[u+2]<<1,m=t[p],y=t[p+1],T=t[f],S=t[f+1],C=t[g],E=t[g+1],I=!1;h==p&&(v=c.length-4,v=F.winding(c[v],c[v+1],c[v+2],c[v+3],C,E),_=F.winding(C,E,c[0],c[1],c[2],c[3]),v==l)&&_==l&&(c.push(C),c.push(E),a.push(g),I=!0),I||(0<c.length?(r.push(c),o.push(a)):(this.polygonPool.free(c),this.polygonIndicesPool.free(a)),(c=this.polygonPool.obtain()).length=0,c.push(m),c.push(y),c.push(T),c.push(S),c.push(C),c.push(E),(a=this.polygonIndicesPool.obtain()).length=0,a.push(p),a.push(f),a.push(g),l=F.winding(m,y,T,S,C,E),h=p)}for(0<c.length&&(r.push(c),o.push(a)),u=0,d=r.length;u<d;u++)if(0!=(a=o[u]).length)for(var v,h=a[0],l=a[a.length-1],p=(c=r[u])[v=c.length-4],f=c[v+1],g=c[v+2],m=c[v+3],y=c[0],T=c[1],S=c[2],I=c[3],b=F.winding(p,f,g,m,y,T),A=0;A<d;A++)A!=u&&3==(i=o[A]).length&&(v=i[0],_=i[1],n=i[2],C=(s=r[A])[s.length-2],E=s[s.length-1],v==h)&&_==l&&(v=F.winding(p,f,g,m,C,E),_=F.winding(C,E,y,T,S,I),v==b)&&_==b&&(s.length=0,i.length=0,c.push(C),c.push(E),a.push(n),p=g,f=m,g=C,m=E,A=0);for(u=r.length-1;0<=u;u--)0==(c=r[u]).length&&(r.splice(u,1),this.polygonPool.free(c),a=o[u],o.splice(u,1),this.polygonIndicesPool.free(a));return r},F.isConcave=function(t,e,i,n){var s=n[(e+t-1)%e]<<1,r=n[t]<<1;return t=n[(t+1)%e]<<1,!this.positiveArea(i[s],i[1+s],i[r],i[1+r],i[t],i[t+1])},F.positiveArea=function(t,e,i,n,s,r){return 0<=t*(r-n)+i*(e-r)+s*(n-e)},F.winding=function(t,e,i,n,s,r){return 0<=s*(n-=e)-r*(i-=t)+i*e-t*n?1:-1},t.Triangulator=F}(spine=spine||{}),!function(t){s.prototype.add=function(t){var e=this.contains(t);return this.array[0|t]=0|t,!e},s.prototype.contains=function(t){return null!=this.array[0|t]},s.prototype.remove=function(t){this.array[0|t]=void 0},s.prototype.clear=function(){this.array.length=0};var i,e,n=s;function s(){this.array=[]}function r(t,e,i,n){void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),this.r=t=void 0===t?0:t,this.g=e,this.b=i,this.a=n}function o(){}function a(){}function c(t){var e=i.call(this)||this;return e.power=2,e.power=t,e}function h(t){return e.call(this,t)||this}function l(){}function u(){}function d(t){this.items=[],this.instantiator=t}function _(t,e){void 0===e&&(e=0),this.x=t=void 0===t?0:t,this.y=e}function p(){this.maxDelta=.064,this.totalTime=this.delta=this.framesPerSecond=0,this.lastTime=Date.now()/1e3,this.frameTime=this.frameCount=0}function f(t){void 0===t&&(t=32),this.mean=this.lastValue=this.addedValues=0,this.dirty=!0,this.values=Array(t)}t.IntSet=n,r.prototype.set=function(t,e,i,n){return this.r=t,this.g=e,this.b=i,this.a=n,this.clamp(),this},r.prototype.setFromColor=function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this},r.prototype.setFromString=function(t){return t="#"==t.charAt(0)?t.substr(1):t,this.r=parseInt(t.substr(0,2),16)/255,this.g=parseInt(t.substr(2,2),16)/255,this.b=parseInt(t.substr(4,2),16)/255,this.a=(8!=t.length?255:parseInt(t.substr(6,2),16))/255,this},r.prototype.add=function(t,e,i,n){return this.r+=t,this.g+=e,this.b+=i,this.a+=n,this.clamp(),this},r.prototype.clamp=function(){return this.r<0?this.r=0:1<this.r&&(this.r=1),this.g<0?this.g=0:1<this.g&&(this.g=1),this.b<0?this.b=0:1<this.b&&(this.b=1),this.a<0?this.a=0:1<this.a&&(this.a=1),this},(n=r).WHITE=new n(1,1,1,1),n.RED=new n(1,0,0,1),n.GREEN=new n(0,1,0,1),n.BLUE=new n(0,0,1,1),n.MAGENTA=new n(1,0,1,1),t.Color=n,o.clamp=function(t,e,i){return t<e?e:i<t?i:t},o.cosDeg=function(t){return Math.cos(t*o.degRad)},o.sinDeg=function(t){return Math.sin(t*o.degRad)},o.signum=function(t){return 0<t?1:t<0?-1:0},o.toInt=function(t){return 0<t?Math.floor(t):Math.ceil(t)},o.cbrt=function(t){var e=Math.pow(Math.abs(t),1/3);return t<0?-e:e},o.randomTriangular=function(t,e){return o.randomTriangularWith(t,e,.5*(t+e))},o.randomTriangularWith=function(t,e,i){var n=Math.random(),s=e-t;return n<=(i-t)/s?t+Math.sqrt(n*s*(i-t)):e-Math.sqrt((1-n)*s*(e-i))},(n=o).PI=3.1415927,n.PI2=2*n.PI,n.radiansToDegrees=180/n.PI,n.radDeg=n.radiansToDegrees,n.degreesToRadians=n.PI/180,n.degRad=n.degreesToRadians,t.MathUtils=n,a.prototype.apply=function(t,e,i){return t+(e-t)*this.applyInternal(i)},n=a,t.Interpolation=n,__extends(c,i=n),c.prototype.applyInternal=function(t){return t<=.5?Math.pow(2*t,this.power)/2:Math.pow(2*(t-1),this.power)/(0==this.power%2?-2:2)+1},n=c,t.Pow=n,__extends(h,e=n),h.prototype.applyInternal=function(t){return Math.pow(t-1,this.power)*(0==this.power%2?-1:1)+1},t.PowOut=n=h,l.arrayCopy=function(t,e,i,n,s){for(var r=e;r<e+s;r++,n++)i[n]=t[r]},l.setArraySize=function(t,e,i){void 0===i&&(i=0);var n=t.length;if(n!=e&&n<(t.length=e))for(;n<e;n++)t[n]=i;return t},l.ensureArrayCapacity=function(t,e,i){return void 0===i&&(i=0),t.length>=e?t:l.setArraySize(t,e,i)},l.newArray=function(t,e){for(var i=Array(t),n=0;n<t;n++)i[n]=e;return i},l.newFloatArray=function(t){if(l.SUPPORTS_TYPED_ARRAYS)return new Float32Array(t);t=Array(t);for(var e=0;e<t.length;e++)t[e]=0;return t},l.newShortArray=function(t){if(l.SUPPORTS_TYPED_ARRAYS)return new Int16Array(t);t=Array(t);for(var e=0;e<t.length;e++)t[e]=0;return t},l.toFloatArray=function(t){return l.SUPPORTS_TYPED_ARRAYS?new Float32Array(t):t},l.toSinglePrecision=function(t){return l.SUPPORTS_TYPED_ARRAYS?Math.fround(t):t},(n=l).SUPPORTS_TYPED_ARRAYS="undefined"!=typeof Float32Array,t.Utils=n,u.logBones=function(t){for(var e=0;e<t.bones.length;e++){var i=t.bones[e];console.log(i.data.name+", "+i.a+", "+i.b+", "+i.c+", "+i.d+", "+i.worldX+", "+i.worldY)}},t.DebugUtils=n=u,d.prototype.obtain=function(){return 0<this.items.length?this.items.pop():this.instantiator()},d.prototype.free=function(t){t.reset&&t.reset(),this.items.push(t)},d.prototype.freeAll=function(t){for(var e=0;e<t.length;e++)t[e].reset&&t[e].reset(),this.items[e]=t[e]},d.prototype.clear=function(){this.items.length=0},t.Pool=n=d,_.prototype.set=function(t,e){return this.x=t,this.y=e,this},_.prototype.length=function(){var t=this.x,e=this.y;return Math.sqrt(t*t+e*e)},_.prototype.normalize=function(){var t=this.length();return 0!=t&&(this.x/=t,this.y/=t),this},t.Vector2=n=_,p.prototype.update=function(){var t=Date.now()/1e3;this.delta=t-this.lastTime,this.frameTime+=this.delta,this.totalTime+=this.delta,this.delta>this.maxDelta&&(this.delta=this.maxDelta),this.lastTime=t,this.frameCount++,1<this.frameTime&&(this.framesPerSecond=this.frameCount/this.frameTime,this.frameCount=this.frameTime=0)},t.TimeKeeper=n=p,f.prototype.hasEnoughData=function(){return this.addedValues>=this.values.length},f.prototype.addValue=function(t){this.addedValues<this.values.length&&this.addedValues++,this.values[this.lastValue++]=t,this.lastValue>this.values.length-1&&(this.lastValue=0),this.dirty=!0},f.prototype.getMean=function(){if(this.hasEnoughData()){if(this.dirty){for(var t=0,e=0;e<this.values.length;e++)t+=this.values[e];this.mean=t/this.values.length,this.dirty=!1}return this.mean}return 0},t.WindowedMean=n=f}(spine=spine||{}),!function(t){var e,i=function(t){if(null==t)throw Error("name cannot be null.");this.name=t};function n(t){return(t=e.call(this,t)||this).id=(65535&n.nextID++)<<11,t.worldVerticesLength=0,t}t.Attachment=i,__extends(n,e=i),n.prototype.computeWorldVertices=function(t,e,i,n,s,r){i=s+(i>>1)*r;var o=t.bone.skeleton,a=t.attachmentVertices,c=this.vertices;if(null==(h=this.bones)){0<a.length&&(c=a);var a=(t=t.bone).worldX,h=t.worldY,l=t.a,o=t.b,u=t.c;t=t.d;for(var d=e;s<i;d+=2,s+=r){e=c[d];var _=c[d+1];n[s]=e*l+_*o+a,n[s+1]=e*u+_*t+h}}else{for(_=t=l=0;_<e;_+=2)l+=(u=h[l])+1,t+=u;if(d=o.bones,0==a.length)for(o=3*t;s<i;s+=r){for(var p=0,f=0,u=(u=h[l++])+l;l<u;l++,o+=3){t=d[h[l]],e=c[o];var _=c[o+1],g=c[o+2],p=p+(e*t.a+_*t.b+t.worldX)*g,f=f+(e*t.c+_*t.d+t.worldY)*g}n[s]=p,n[s+1]=f}else for(var o=3*t,m=t<<1;s<i;s+=r){for(f=p=0,u=h[l++],u+=l;l<u;l++,o+=3,m+=2)t=d[h[l]],e=c[o]+a[m],_=c[o+1]+a[m+1],g=c[o+2],p+=(e*t.a+_*t.b+t.worldX)*g,f+=(e*t.c+_*t.d+t.worldY)*g;n[s]=p,n[s+1]=f}}},n.prototype.applyDeform=function(t){return this==t},(i=n).nextID=0,t.VertexAttachment=i}(spine=spine||{}),!function(t){(t=t.AttachmentType||(t.AttachmentType={}))[t.Region=0]="Region",t[t.BoundingBox=1]="BoundingBox",t[t.Mesh=2]="Mesh",t[t.LinkedMesh=3]="LinkedMesh",t[t.Path=4]="Path",t[t.Point=5]="Point"}(spine=spine||{}),!function(e){i=e.VertexAttachment,__extends(n,i);var i,t=n;function n(t){return(t=i.call(this,t)||this).color=new e.Color(1,1,1,1),t}e.BoundingBoxAttachment=t}(spine=spine||{}),!function(e){i=e.VertexAttachment,__extends(n,i);var i,t=n;function n(t){return(t=i.call(this,t)||this).color=new e.Color(.2275,.2275,.8078,1),t}e.ClippingAttachment=t}(spine=spine||{}),!function(c){e=c.VertexAttachment,__extends(i,e),i.prototype.updateUVs=function(){var t=0,e=0,i=0,n=0,s=(null==this.region?(t=e=0,i=n=1):(t=this.region.u,e=this.region.v,i=this.region.u2-t,n=this.region.v2-e),this.regionUVs),r=(null!=this.uvs&&this.uvs.length==s.length||(this.uvs=c.Utils.newFloatArray(s.length)),this.uvs);if(this.region.rotate)for(var o=0,a=r.length;o<a;o+=2)r[o]=t+s[o+1]*i,r[o+1]=e+n-s[o]*n;else for(o=0,a=r.length;o<a;o+=2)r[o]=t+s[o]*i,r[o+1]=e+s[o+1]*n},i.prototype.applyDeform=function(t){return this==t||this.inheritDeform&&this.parentMesh==t},i.prototype.getParentMesh=function(){return this.parentMesh},i.prototype.setParentMesh=function(t){null!=(this.parentMesh=t)&&(this.bones=t.bones,this.vertices=t.vertices,this.worldVerticesLength=t.worldVerticesLength,this.regionUVs=t.regionUVs,this.triangles=t.triangles,this.hullLength=t.hullLength,this.worldVerticesLength=t.worldVerticesLength)};var e,t=i;function i(t){return(t=e.call(this,t)||this).color=new c.Color(1,1,1,1),t.inheritDeform=!1,t.tempColor=new c.Color(0,0,0,0),t}c.MeshAttachment=t}(spine=spine||{}),!function(e){i=e.VertexAttachment,__extends(n,i);var i,t=n;function n(t){return(t=i.call(this,t)||this).closed=!1,t.constantSpeed=!1,t.color=new e.Color(1,1,1,1),t}e.PathAttachment=t}(spine=spine||{}),!function(n){e=n.VertexAttachment,__extends(i,e),i.prototype.computeWorldPosition=function(t,e){return e.x=this.x*t.a+this.y*t.b+t.worldX,e.y=this.x*t.c+this.y*t.d+t.worldY,e},i.prototype.computeWorldRotation=function(t){var e=n.MathUtils.cosDeg(this.rotation),i=n.MathUtils.sinDeg(this.rotation);return Math.atan2(e*t.c+i*t.d,e*t.a+i*t.b)*n.MathUtils.radDeg};var e,t=i;function i(t){return(t=e.call(this,t)||this).color=new n.Color(.38,.94,0,1),t}n.PointAttachment=t}(spine=spine||{}),!function(e){i=e.Attachment,__extends(d,i),d.prototype.updateOffset=function(){var t=this.width/this.region.originalWidth*this.scaleX,e=this.height/this.region.originalHeight*this.scaleY,i=-this.width/2*this.scaleX+this.region.offsetX*t,n=-this.height/2*this.scaleY+this.region.offsetY*e,s=i+this.region.width*t,t=n+this.region.height*e,e=this.rotation*Math.PI/180,r=Math.cos(e),o=Math.sin(e),e=i*r+this.x,i=i*o,a=n*r+this.y,n=n*o,c=s*r+this.x,s=s*o,r=t*r+this.y,t=t*o;(o=this.offset)[d.OX1]=e-n,o[d.OY1]=a+i,o[d.OX2]=e-t,o[d.OY2]=r+i,o[d.OX3]=c-t,o[d.OY3]=r+s,o[d.OX4]=c-n,o[d.OY4]=a+s},d.prototype.setRegion=function(t){this.region=t;var e=this.uvs;t.rotate?(e[2]=t.u,e[3]=t.v2,e[4]=t.u,e[5]=t.v,e[6]=t.u2,e[7]=t.v,e[0]=t.u2,e[1]=t.v2):(e[0]=t.u,e[1]=t.v2,e[2]=t.u,e[3]=t.v,e[4]=t.u2,e[5]=t.v,e[6]=t.u2,e[7]=t.v2)},d.prototype.computeWorldVertices=function(t,e,i,n){var s=this.offset,r=t.worldX,o=t.worldY,a=t.a,c=t.b,h=t.c,l=(t=t.d,s[d.OX1]),u=s[d.OY1];e[i]=l*a+u*c+r,e[i+1]=l*h+u*t+o,l=s[d.OX2],u=s[d.OY2],e[i+=n]=l*a+u*c+r,e[i+1]=l*h+u*t+o,l=s[d.OX3],u=s[d.OY3],e[i+=n]=l*a+u*c+r,e[i+1]=l*h+u*t+o,l=s[d.OX4],u=s[d.OY4],e[i+=n]=l*a+u*c+r,e[i+1]=l*h+u*t+o};var i,t=d;function d(t){return(t=i.call(this,t)||this).x=0,t.y=0,t.scaleX=1,t.scaleY=1,t.rotation=0,t.width=0,t.height=0,t.color=new e.Color(1,1,1,1),t.offset=e.Utils.newFloatArray(8),t.uvs=e.Utils.newFloatArray(8),t.tempColor=new e.Color(1,1,1,1),t}t.OX1=0,t.OY1=1,t.OX2=2,t.OY2=3,t.OX3=4,t.OY3=5,t.OX4=6,t.OY4=7,t.X1=0,t.Y1=1,t.C1R=2,t.C1G=3,t.C1B=4,t.C1A=5,t.U1=6,t.V1=7,t.X2=8,t.Y2=9,t.C2R=10,t.C2G=11,t.C2B=12,t.C2A=13,t.U2=14,t.V2=15,t.X3=16,t.Y3=17,t.C3R=18,t.C3G=19,t.C3B=20,t.C3A=21,t.U3=22,t.V3=23,t.X4=24,t.Y4=25,t.C4R=26,t.C4G=27,t.C4B=28,t.C4A=29,t.U4=30,t.V4=31,e.RegionAttachment=t}(spine=spine||{}),!function(s){function t(t,e){this.jitterY=this.jitterX=0,this.jitterX=t,this.jitterY=e}t.prototype.begin=function(t){},t.prototype.transform=function(t,e,i,n){t.x+=s.MathUtils.randomTriangular(-this.jitterX,this.jitterY),t.y+=s.MathUtils.randomTriangular(-this.jitterX,this.jitterY)},t.prototype.end=function(){},s.JitterEffect=t}(spine=spine||{}),!function(r){o.prototype.begin=function(t){this.worldX=t.x+this.centerX,this.worldY=t.y+this.centerY},o.prototype.transform=function(t,e,i,n){n=this.angle*r.MathUtils.degreesToRadians,e=t.x-this.worldX,i=t.y-this.worldY;var s=Math.sqrt(e*e+i*i);s<this.radius&&(s=o.interpolation.apply(0,n,(this.radius-s)/this.radius),n=Math.cos(s),s=Math.sin(s),t.x=n*e-s*i+this.worldX,t.y=s*e+n*i+this.worldY)},o.prototype.end=function(){};var t=o;function o(t){this.worldY=this.worldX=this.angle=this.radius=this.centerY=this.centerX=0,this.radius=t}t.interpolation=new r.PowOut(2),r.SwirlEffect=t}(spine=spine||{}),sp||{}),proto=(sp.spine=spine,sp=sp||{},spine=sp.spine,sp.Skeleton=cc.Node.extend({_skeleton:null,_rootBone:null,_timeScale:1,_debugSlots:!1,_debugBones:!1,_premultipliedAlpha:!1,_ownsSkeletonData:null,_atlas:null,ctor:function(t,e,i){cc.Node.prototype.ctor.call(this),0===arguments.length?this.init():this.initWithArgs(t,e,i)},_createRenderCmd:function(){return new(cc._renderType===cc.game.RENDER_TYPE_CANVAS?sp.Skeleton.CanvasRenderCmd:sp.Skeleton.WebGLRenderCmd)(this)},init:function(){cc.Node.prototype.init.call(this),this._premultipliedAlpha=cc._renderType===cc.game.RENDER_TYPE_WEBGL&&cc.OPTIMIZE_BLEND_FUNC_FOR_PREMULTIPLIED_ALPHA},onEnter:function(){cc.Node.prototype.onEnter.call(this),this.scheduleUpdate()},onExit:function(){this.unscheduleUpdate(),cc.Node.prototype.onExit.call(this)},setDebugSolots:function(t){this._debugSlots=t},setDebugBones:function(t){this._debugBones=t},setDebugSlotsEnabled:function(t){this._debugSlots=t},getDebugSlotsEnabled:function(){return this._debugSlots},setDebugBonesEnabled:function(t){this._debugBones=t},getDebugBonesEnabled:function(){return this._debugBones},setTimeScale:function(t){this._timeScale=t},getTimeScale:function(){return this._timeScale},initWithArgs:function(t,e,i){var n;i=cc.isString(t)?(cc.isString(e)&&(n=cc.loader.getRes(e),sp._atlasLoader.setAtlasFile(e),e=new spine.TextureAtlas(n,sp._atlasLoader.load.bind(sp._atlasLoader))),i=i||1/cc.director.getContentScaleFactor(),n=new spine.AtlasAttachmentLoader(e),(n=new spine.SkeletonJson(n)).scale=i,t=cc.loader.getRes(t),t=n.readSkeletonData(t),e.dispose(n),!0):e,this.setSkeletonData(t,i),this.init()},getBoundingBox:function(){for(var t,e=cc.FLT_MAX,i=cc.FLT_MAX,n=cc.FLT_MIN,s=cc.FLT_MIN,r=this.getScaleX(),o=this.getScaleY(),a=this._skeleton.slots,c=spine.RegionAttachment,h=0,l=a.length;h<l;++h){var u=a[h],d=u.attachment;d&&d instanceof spine.RegionAttachment&&(t=spine.Utils.setArraySize([],8,0),d.computeWorldVertices(u.bone,t,0,2),e=Math.min(e,t[c.OX1]*r,t[c.OX4]*r,t[c.OX2]*r,t[c.OX3]*r),i=Math.min(i,t[c.OY1]*o,t[c.OY4]*o,t[c.OY2]*o,t[c.OY3]*o),n=Math.max(n,t[c.OX1]*r,t[c.OX4]*r,t[c.OX2]*r,t[c.OX3]*r),s=Math.max(s,t[c.OY1]*o,t[c.OY4]*o,t[c.OY2]*o,t[c.OY3]*o))}return r=this.getPosition(),cc.rect(r.x+e,r.y+i,n-e,s-i)},updateWorldTransform:function(){this._skeleton.updateWorldTransform()},setToSetupPose:function(){this._skeleton.setToSetupPose()},setBonesToSetupPose:function(){this._skeleton.setBonesToSetupPose()},setSlotsToSetupPose:function(){this._skeleton.setSlotsToSetupPose()},findBone:function(t){return this._skeleton.findBone(t)},findSlot:function(t){return this._skeleton.findSlot(t)},setSkin:function(t){return this._skeleton.setSkinByName(t)},getAttachment:function(t,e){return this._skeleton.getAttachmentByName(t,e)},setAttachment:function(t,e){this._skeleton.setAttachment(t,e)},setPremultipliedAlpha:function(t){this._premultipliedAlpha=t},isPremultipliedAlpha:function(){return this._premultipliedAlpha},setSkeletonData:function(t,e){null!=t.width&&null!=t.height&&this.setContentSize(t.width/cc.director.getContentScaleFactor(),t.height/cc.director.getContentScaleFactor()),this._skeleton=new spine.Skeleton(t),this._skeleton.updateWorldTransform(),this._rootBone=this._skeleton.getRootBone(),this._ownsSkeletonData=e,this._renderCmd._createChildFormSkeletonData()},getTextureAtlas:function(t){return t.region},getBlendFunc:function(){var t=this._skeleton.drawOrder[0];return t?this._renderCmd._getBlendFunc(t.data.blendMode,this._premultipliedAlpha):{}},setBlendFunc:function(t,e){},update:function(t){this._skeleton.update(t)}}),cc.defineGetterSetter(sp.Skeleton.prototype,"opacityModifyRGB",sp.Skeleton.prototype.isOpacityModifyRGB),cc.defineGetterSetter(sp.Skeleton.prototype,"_blendFunc",sp.Skeleton.prototype.getBlendFunc),cc.defineGetterSetter(sp.Skeleton.prototype,"_texture",function(){return this._renderCmd._currTexture}),sp.Skeleton.create=function(t,e,i){return new sp.Skeleton(t,e,i)},sp._atlasLoader={spAtlasFile:null,setAtlasFile:function(t){this.spAtlasFile=t},load:function(t){t=cc.path.join(cc.path.dirname(this.spAtlasFile),t),t=cc.textureCache.addImage(t);var e=new sp.SkeletonTexture({width:t.getPixelsWide(),height:t.getPixelsHigh()});return e.setRealTexture(t),e},unload:function(t){}},sp.ANIMATION_EVENT_TYPE={START:0,INTERRUPT:1,END:2,DISPOSE:3,COMPLETE:4,EVENT:5},sp.TrackEntryListeners=function(t,e,i,n,s,r){this.startListener=t||null,this.endListener=e||null,this.completeListener=i||null,this.eventListener=n||null,this.interruptListener=s||null,this.disposeListener=r||null,this.skeletonNode=this.callbackTarget=this.callback=null},sp.TrackEntryListeners.prototype),res=(proto.start=function(t){this.startListener&&this.startListener(t),this.callback&&this.callback.call(this.callbackTarget,this.skeletonNode,t,sp.ANIMATION_EVENT_TYPE.START,null,0)},proto.interrupt=function(t){this.interruptListener&&this.interruptListener(t),this.callback&&this.callback.call(this.callbackTarget,this.skeletonNode,t,sp.ANIMATION_EVENT_TYPE.INTERRUPT,null,0)},proto.end=function(t){this.endListener&&this.endListener(t),this.callback&&this.callback.call(this.callbackTarget,this.skeletonNode,t,sp.ANIMATION_EVENT_TYPE.END,null,0)},proto.dispose=function(t){this.disposeListener&&this.disposeListener(t),this.callback&&this.callback.call(this.callbackTarget,this.skeletonNode,t,sp.ANIMATION_EVENT_TYPE.DISPOSE,null,0)},proto.complete=function(t){var e=Math.floor(t.trackTime/t.animationEnd);this.completeListener&&this.completeListener(t,e),this.callback&&this.callback.call(this.callbackTarget,this.skeletonNode,t,sp.ANIMATION_EVENT_TYPE.COMPLETE,null,e)},proto.event=function(t,e){this.eventListener&&this.eventListener(t,e),this.callback&&this.callback.call(this.callbackTarget,this.skeletonNode,t,sp.ANIMATION_EVENT_TYPE.EVENT,e,0)},sp.TrackEntryListeners.getListeners=function(t){return t.listener||(t.listener=new sp.TrackEntryListeners),t.listener},sp.SkeletonAnimation=sp.Skeleton.extend({_state:null,_ownsAnimationStateData:!1,_listener:null,init:function(){sp.Skeleton.prototype.init.call(this),this._ownsAnimationStateData=!0,this.setAnimationStateData(new spine.AnimationStateData(this._skeleton.data))},setAnimationStateData:function(t){t=new spine.AnimationState(t),this._listener=new sp.TrackEntryListeners,t.rendererObject=this,t.addListener(this._listener),this._state=t},setMix:function(t,e,i){this._state.data.setMixWith(t,e,i)},setAnimationListener:function(t,e){this._listener.callbackTarget=t,this._listener.callback=e,this._listener.skeletonNode=this},setAnimation:function(t,e,i){var n=this._skeleton.data.findAnimation(e);return n?this._state.setAnimationWith(t,n,i):(cc.log("Spine: Animation not found: "+e),null)},addAnimation:function(t,e,i,n){n=null==n?0:n;var s=this._skeleton.data.findAnimation(e);return s?this._state.addAnimationWith(t,s,i,n):(cc.log("Spine: Animation not found:"+e),null)},findAnimation:function(t){return this._skeleton.data.findAnimation(t)},getCurrent:function(t){return this._state.getCurrent(t)},clearTracks:function(){this._state.clearTracks()},clearTrack:function(t){this._state.clearTrack(t)},update:function(t){this._super(t),t*=this._timeScale,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.contentDirty),this._state.update(t),this._state.apply(this._skeleton),this._skeleton.updateWorldTransform(),this._renderCmd._updateChild()},setStartListener:function(t){this._listener.startListener=t},setInterruptListener:function(t){this._listener.interruptListener=t},setEndListener:function(t){this._listener.endListener=t},setDisposeListener:function(t){this._listener.disposeListener=t},setCompleteListener:function(t){this._listener.completeListener=t},setEventListener:function(t){this._listener.eventListener=t},setTrackStartListener:function(t,e){sp.TrackEntryListeners.getListeners(t).startListener=e},setTrackInterruptListener:function(t,e){sp.TrackEntryListeners.getListeners(t).interruptListener=e},setTrackEndListener:function(t,e){sp.TrackEntryListeners.getListeners(t).endListener=e},setTrackDisposeListener:function(t,e){sp.TrackEntryListeners.getListeners(t).disposeListener=e},setTrackCompleteListener:function(t,e){sp.TrackEntryListeners.getListeners(t).completeListener=e},setTrackEventListener:function(t,e){sp.TrackEntryListeners.getListeners(t).eventListener=e},getState:function(){return this._state}}),sp.SkeletonAnimation.createWithJsonFile=sp.SkeletonAnimation.create=function(t,e,i){return new sp.SkeletonAnimation(t,e,i)},sp.SkeletonTexture=function(t){sp.spine.Texture.call(this,t)},cc.inherits(sp.SkeletonTexture,sp.spine.Texture),cc.extend(sp.SkeletonTexture.prototype,{name:"sp.SkeletonTexture",_texture:null,setRealTexture:function(t){this._texture=t},getRealTexture:function(){return this._texture},setFilters:function(t,e){var i;cc._renderType===cc.game.RENDER_TYPE_WEBGL&&(i=cc._renderContext,this.bind(),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,t),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,e))},setWraps:function(t,e){var i;cc._renderType===cc.game.RENDER_TYPE_WEBGL&&(i=cc._renderContext,this.bind(),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,t),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,e))},dispose:function(){},bind:function(){cc._renderType===cc.game.RENDER_TYPE_WEBGL&&cc.glBindTexture2D(this._texture)}}),!function(){function r(t,e,i){var n=i.region,s=new cc.Rect(n.x,n.y,n.width,n.height);t.initWithTexture(e,s,n.rotate,!1),t._rect.width=i.width,t._rect.height=i.height,t.setContentSize(i.width,i.height),t.setRotation(-i.rotation),t.setScale(n.width/n.originalWidth*i.scaleX,n.height/n.originalHeight*i.scaleY)}var u=sp.spine,t=(sp.Skeleton.CanvasRenderCmd=function(t){this._rootCtor(t),this._needDraw=!0},sp.Skeleton.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype));t.constructor=sp.Skeleton.CanvasRenderCmd,t.rendering=function(t,e,i){for(var n,s,r=this._node,o=(t=t||cc._renderContext,r._skeleton),a=o.drawOrder,c=0,h=a.length;c<h;c++)(s=(n=a[c])._slotNode)._visible&&s._renderCmd&&n.currentSprite&&(s._renderCmd.transform(this,!0),n.currentSprite._renderCmd.rendering(t,e,i),s._renderCmd._dirtyFlag=n.currentSprite._renderCmd._dirtyFlag=0);if(r._debugSlots||r._debugBones){if(t.setTransform(this._worldTransform,e,i),t.setGlobalAlpha(1),t=cc._drawingUtil,r._debugSlots)for(t.setDrawColor(0,0,255,255),t.setLineWidth(1),i=[],c=0,h=o.slots.length;c<h;c++)(n=o.drawOrder[c]).attachment&&n.attachment instanceof u.RegionAttachment&&(e=n.attachment,this._updateRegionAttachmentSlot(e,n,i),t.drawPoly(i,4,!0));if(r._debugBones){for(t.setLineWidth(2),t.setDrawColor(255,0,0,255),c=0,h=o.bones.length;c<h;c++)r=o.bones[c],t.drawLine({x:r.worldX,y:r.worldY},{x:r.data.length*r.a+r.worldX,y:r.data.length*r.c+r.worldY});for(t.setDrawColor(0,0,255,255),c=0,h=o.bones.length;c<h;c++)r=o.bones[c],t.drawPoint({x:r.worldX,y:r.worldY},4),0===c&&t.setDrawColor(0,255,0,255)}}},t.updateStatus=function(){this.originUpdateStatus(),this._updateCurrentRegions(),this._regionFlag=cc.Node.CanvasRenderCmd.RegionStatus.DirtyDouble,this._dirtyFlag&=~cc.Node._dirtyFlags.contentDirty},t.getLocalBB=function(){return this._node.getBoundingBox()},t._updateRegionAttachmentSlot=function(t,e,i){var n;i&&(n=u.Utils.setArraySize([],8,0),t.computeWorldVertices(e.bone,n,0,2),t=u.RegionAttachment,i.length=0,i.push(cc.p(n[t.OX1],n[t.OY1])),i.push(cc.p(n[t.OX4],n[t.OY4])),i.push(cc.p(n[t.OX3],n[t.OY3])),i.push(cc.p(n[t.OX2],n[t.OY2])))},t._createChildFormSkeletonData=function(){for(var t,e=this._node._skeleton,i=0,n=e.slots.length;i<n;i++){var s=e.slots[i],r=s.attachment,o=new cc.Node;s._slotNode=o,r instanceof u.RegionAttachment&&(t=r.region.name,r=this._createSprite(s,r),s.currentSprite=r,s.currentSpriteName=t,o.addChild(r))}};t._createSprite=function(t,e){var i=e.region,n=i.texture.getRealTexture(),s=new cc.Sprite;return n.isLoaded()?r(s,n,e):n.addEventListener("load",function(){r(s,n,e)},this),t.sprites=t.sprites||{},t.sprites[i.name]=s},t._updateChild=function(){for(var t,e,i,n,s,r,o=this._node._skeleton.slots,a=this._displayedColor,c=this._displayedOpacity,h=0,l=o.length;h<l;h++)if(n=(i=o[h]).attachment,s=i._slotNode,n){if(n instanceof u.RegionAttachment)!n.region||i.currentSpriteName&&i.currentSpriteName===n.name||(r=n.region.name,void 0!==i.currentSprite&&i.currentSprite.setVisible(!1),i.sprites=i.sprites||{},void 0!==i.sprites[r]?i.sprites[r].setVisible(!0):(t=this._createSprite(i,n),s.addChild(t)),i.currentSprite=i.sprites[r],i.currentSpriteName=r),r=i.bone,e=0===n.region.offsetX&&0===n.region.offsetY?(t=n.x,n.y):(t=.5*(n.offset[0]+n.offset[4]),.5*(n.offset[1]+n.offset[5])),s.setPosition(r.worldX+t*r.a+e*r.b,r.worldY+t*r.c+e*r.d),s.setScale(r.getWorldScaleX(),r.getWorldScaleY()),(t=i.currentSprite)._flippedX=r.skeleton.flipX,t._flippedY=r.skeleton.flipY,t._flippedY||t._flippedX?(s.setRotation(r.getWorldRotationX()),t.setRotation(n.rotation)):(s.setRotation(-r.getWorldRotationX()),t.setRotation(-n.rotation)),t._renderCmd._displayedOpacity=0|c*i.color.a,t.setColor(cc.color(0|a.r*i.color.r,0|a.g*i.color.g,0|a.b*i.color.b)),t._renderCmd._updateColor();else if(!(n instanceof u.MeshAttachment)){s.setVisible(!1);continue}s.setVisible(!0)}else s.setVisible(!1)}}(),!function(){var I=sp.spine,t=(sp.Skeleton.WebGLRenderCmd=function(t){this._rootCtor(t),this._needDraw=!0,this._matrix=new cc.math.Matrix4,this._matrix.identity(),this._currTexture=null,this._currBlendFunc={},this.vertexType=cc.renderer.VertexType.CUSTOM,this.setShaderProgram(cc.shaderCache.programForKey(cc.SHADER_SPRITE_POSITION_TEXTURECOLOR))},sp.Skeleton.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype));t.constructor=sp.Skeleton.WebGLRenderCmd,t.uploadData=function(t,e,i){var n,s,r=this._node,o=this._displayedColor,a=r._skeleton,c=r._premultipliedAlpha,h=(a.r=o.r/255,a.g=o.g/255,a.b=o.b/255,a.a=this._displayedOpacity/255,c&&(a.r*=a.a,a.g*=a.a,a.b*=a.a),null);for(this._node._debugSlots&&(h=[]),o=0,s=a.drawOrder.length;o<s;o++)if((n=a.drawOrder[o]).attachment){var l,u=0;if((l=n.attachment)instanceof I.RegionAttachment)u=6;else{if(!(l instanceof I.MeshAttachment))continue;u=l.regionUVs.length/2}if(0!==u){this._currTexture=r.getTextureAtlas(l).texture.getRealTexture();var d=cc.renderer._updateBatchedInfo(this._currTexture,this._getBlendFunc(n.data.blendMode,c),this._glProgramState),_=i/6+u>.5*(cc.BATCH_VERTEX_COUNT-200);if(!d&&_&&(cc.renderer._batchRendering(),d=!0),d&&(i=0),d=null,l instanceof I.RegionAttachment)d=this._uploadRegionAttachmentData(l,n,c,t,e,i);else{if(!(l instanceof I.MeshAttachment))continue;this._uploadMeshAttachmentData(l,n,c,t,e,i)}this._node._debugSlots&&(h[o]=d),l instanceof I.RegionAttachment?cc.renderer._increaseBatchingSize(u,cc.renderer.VertexType.TRIANGLE):cc.renderer._increaseBatchingSize(u,cc.renderer.VertexType.CUSTOM,l.triangles),i+=6*u}}if(r._debugBones||r._debugSlots){if(cc.renderer._batchRendering(),o=this._worldTransform,(s=this._matrix.mat)[0]=o.a,s[4]=o.c,s[12]=o.tx,s[1]=o.b,s[5]=o.d,s[13]=o.ty,cc.kmGLMatrixMode(cc.KM_GL_MODELVIEW),cc.current_stack.stack.push(cc.current_stack.top),cc.current_stack.top=this._matrix,t=cc._drawingUtil,r._debugSlots&&h&&0<h.length)for(t.setDrawColor(0,0,255,255),t.setLineWidth(1),o=0,s=a.slots.length;o<s;o++)(e=h[o])&&t.drawPoly(e,4,!0);if(r._debugBones){for(t.setLineWidth(2),t.setDrawColor(255,0,0,255),o=0,s=a.bones.length;o<s;o++)h=(r=a.bones[o]).data.length*r.a+r.worldX,e=r.data.length*r.c+r.worldY,t.drawLine(cc.p(r.worldX,r.worldY),cc.p(h,e));for(t.setPointSize(4),t.setDrawColor(0,0,255,255),o=0,s=a.bones.length;o<s;o++)r=a.bones[o],t.drawPoint(cc.p(r.worldX,r.worldY)),0==o&&t.setDrawColor(0,255,0,255)}cc.kmGLPopMatrix()}return 0},t._getBlendFunc=function(t,e){var i=this._currBlendFunc;switch(t){case I.BlendMode.Normal:i.src=e?cc.ONE:cc.SRC_ALPHA,i.dst=cc.ONE_MINUS_SRC_ALPHA;break;case I.BlendMode.Additive:i.src=e?cc.ONE:cc.SRC_ALPHA,i.dst=cc.ONE;break;case I.BlendMode.Multiply:i.src=cc.DST_COLOR,i.dst=cc.ONE_MINUS_SRC_ALPHA;break;case I.BlendMode.Screen:i.src=cc.ONE,i.dst=cc.ONE_MINUS_SRC_COLOR;break;default:i=this._node._blendFunc}return i},t._createChildFormSkeletonData=function(){},t._updateChild=function(){},t._uploadRegionAttachmentData=function(t,e,i,n,s,r){var o=(l=this._displayedColor).r,a=l.g,c=l.b,h=this._displayedOpacity,l=I.Utils.setArraySize([],8,0),u=(t.computeWorldVertices(e.bone,l,0,2),t.uvs),d=e.bone.skeleton.color,_=(e=e.color,t.color),p=d.a*e.a*_.a;(t=t.tempColor).set(d.r*e.r*_.r*(i=i?p:1),d.g*e.g*_.g*i,d.b*e.b*_.b*i,p);d=(f=this._worldTransform).a;i=f.b,e=f.c;for(var _=f.d,p=f.tx,f=f.ty,g=this._node.vertexZ,m=0;m<6;m++){var y=m<4?m%3:m-2,T=l[2*y],S=l[2*y+1],C=T*i+S*_+f,E=t.a*h<<24|t.b*c<<16|t.g*a<<8|t.r*o;n[r]=T*d+S*e+p,n[r+1]=C,n[r+2]=g,s[r+3]=E,n[r+4]=u[2*y],n[r+5]=u[2*y+1],r+=6}if(this._node._debugSlots)return n=I.RegionAttachment,[cc.p(l[n.OX1],l[n.OY1]),cc.p(l[n.OX2],l[n.OY2]),cc.p(l[n.OX3],l[n.OY3]),cc.p(l[n.OX4],l[n.OY4])]},t._uploadMeshAttachmentData=function(t,e,i,n,s,r){var o=(u=this._worldTransform).a,a=u.b,c=u.c,h=u.d,l=u.tx,u=u.ty,d=this._node.vertexZ,_=t.worldVerticesLength,p=I.Utils.setArraySize([],_,0),_=(t.computeWorldVertices(e,0,_,p,0,2),t.uvs),f=e.bone.skeleton.color,g=(e=e.color,t.color),m=f.a*e.a*g.a;(t=t.tempColor).set(f.r*e.r*g.r*(i=i?m:1),f.g*e.g*g.g*i,f.b*e.b*g.b*i,m),i=(e=this._displayedColor).r,f=e.g,e=e.b;for(var g=this._displayedOpacity,m=0,y=p.length;m<y;m+=2){var T=p[m],S=p[m+1],C=T*c+S*h+u,E=t.a*g<<24|t.b*e<<16|t.g*f<<8|t.r*i;n[r]=T*o+S*a+l,n[r+1]=C,n[r+2]=d,s[r+3]=E,n[r+4]=_[m],n[r+5]=_[m+1],r+=6}}}(),!function(){cc.PhysicsSprite=cc.Sprite.extend({_ignoreBodyRotation:!1,_body:null,_rotation:1,ctor:function(t,e){var i;cc.Sprite.prototype.ctor.call(this),void 0===t?cc.PhysicsSprite.prototype.init.call(this):cc.isString(t)?"#"===t[0]?(i=t.substr(1,t.length-1),i=cc.spriteFrameCache.getSpriteFrame(i),this.initWithSpriteFrame(i)):this.init(t,e):cc.isObject(t)&&(t instanceof cc.Texture2D?this.initWithTexture(t,e):t instanceof cc.SpriteFrame&&this.initWithSpriteFrame(t)),cc.renderer.pushRenderCommand(this._renderCmd)},visit:function(){cc.renderer.pushRenderCommand(this._renderCmd),cc.Sprite.prototype.visit.call(this)},setBody:function(t){this._body=t},getBody:function(){return this._body},getPosition:function(){var t=this._body;return{x:t.p.x,y:t.p.y}},getPositionX:function(){return this._body.p.x},getPositionY:function(){return this._body.p.y},setPosition:function(t,e){void 0===e?(this._body.p.x=t.x,this._body.p.y=t.y):(this._body.p.x=t,this._body.p.y=e)},setPositionX:function(t){this._body.p.x=t},setPositionY:function(t){this._body.p.y=t},_syncPosition:function(){var t=this._position,e=this._body;t.x===e.p.x&&t.y===e.p.y||cc.Sprite.prototype.setPosition.call(this,e.p.x,e.p.y)},getRotation:function(){return this._ignoreBodyRotation?this._rotationX:-cc.radiansToDegrees(this._body.a)},setRotation:function(t){this._ignoreBodyRotation?cc.Sprite.prototype.setRotation.call(this,t):this._body.a=-cc.degreesToRadians(t)},_syncRotation:function(){var t=-cc.radiansToDegrees(this._body.a);this._rotationX!==t&&cc.Sprite.prototype.setRotation.call(this,t)},getNodeToParentTransform:function(){return this._renderCmd.getNodeToParentTransform()},isDirty:function(){return!this._body.isSleeping()},setDirty:function(){},setIgnoreBodyRotation:function(t){this._ignoreBodyRotation=t},_createRenderCmd:function(){return new(cc._renderType===cc.game.RENDER_TYPE_CANVAS?cc.PhysicsSprite.CanvasRenderCmd:cc.PhysicsSprite.WebGLRenderCmd)(this)}}),cc.PhysicsSprite._className="PhysicsSprite";var t=cc.PhysicsSprite.prototype;cc.defineGetterSetter(t,"body",t.getBody,t.setBody),cc.defineGetterSetter(t,"dirty",t.isDirty,t.setDirty),cc.PhysicsSprite.create=function(t,e){return new cc.PhysicsSprite(t,e)},cc.PhysicsSprite.createWithSpriteFrameName=cc.PhysicsSprite.create,cc.PhysicsSprite.createWithSpriteFrame=cc.PhysicsSprite.create}(),cc.__convertVerts=function(t){for(var e=[],i=0;i<t.length/2;i++)e[i]={x:t[2*i],y:t[2*i+1]};return e},cc.ColorForBody=function(t){return t.isRogue()||t.isSleeping()?cc.color(128,128,128,128):t.nodeIdleTime>t.space.sleepTimeThreshold?cc.color(84,84,84,128):cc.color(255,0,0,128)},cc.DrawShape=function(t,e){var i=t.body,n=cc.ColorForBody(i);switch(t.collisionCode){case cp.CircleShape.prototype.collisionCode:this.drawDot(t.tc,Math.max(t.r,1),n),this.drawSegment(t.tc,cp.v.add(t.tc,cp.v.mult(i.rot,t.r)),1,n);break;case cp.SegmentShape.prototype.collisionCode:this.drawSegment(t.ta,t.tb,Math.max(t.r,2),n);break;case cp.PolyShape.prototype.collisionCode:i=cc.color(n.r,n.g,n.b,cc.lerp(n.a,255,.5)),this.drawPoly(cc.__convertVerts(t.tVerts),n,1,i);break;default:cc.log("cc.DrawShape(): Bad assertion in DrawShape()")}},cc.DrawConstraint=function(t,e){var i,n=t.a,s=t.b;t instanceof cp.PinJoint||t instanceof cp.SlideJoint?(i=n.local2World(t.anchr1),n=s.local2World(t.anchr2),this.drawDot(i,3,cc.CONSTRAINT_COLOR),this.drawDot(n,3,cc.CONSTRAINT_COLOR),this.drawSegment(i,n,1,cc.CONSTRAINT_COLOR)):t instanceof cp.PivotJoint?(i=n.local2World(t.anchr1),n=s.local2World(t.anchr2),this.drawDot(i,3,cc.CONSTRAINT_COLOR),this.drawDot(n,3,cc.CONSTRAINT_COLOR)):t instanceof cp.GrooveJoint&&(i=n.local2World(t.grv_a),n=n.local2World(t.grv_b),s=s.local2World(t.anchr2),this.drawDot(s,3,cc.CONSTRAINT_COLOR),this.drawSegment(i,n,1,cc.CONSTRAINT_COLOR))},cc.CONSTRAINT_COLOR=cc.color(0,255,0,128),cc.PhysicsDebugNode=cc.DrawNode.extend({_space:null,_className:"PhysicsDebugNode",ctor:function(t){cc.DrawNode.prototype.ctor.call(this),this._space=t},getSpace:function(){return this._space},setSpace:function(t){this._space=t},draw:function(t){this._space&&(this._space.eachShape(cc.DrawShape.bind(this)),this._space.eachConstraint(cc.DrawConstraint.bind(this)),cc.DrawNode.prototype.draw.call(this),this.clear())},_createRenderCmd:function(){return new(cc._renderType===cc.game.RENDER_TYPE_CANVAS?cc.PhysicsDebugNode.CanvasRenderCmd:cc.PhysicsDebugNode.WebGLRenderCmd)(this)}}),cc.PhysicsDebugNode.create=function(t){return new cc.PhysicsDebugNode(t)},!function(){cc.PhysicsDebugNode.CanvasRenderCmd=function(t){this._rootCtor(t),this._buffer=t._buffer,this._needDraw=!0};var t=cc.PhysicsDebugNode.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);t.constructor=cc.PhysicsDebugNode.CanvasRenderCmd,t.rendering=function(t,e,i){var n=this._node;n._space&&(n._space.eachShape(cc.DrawShape.bind(n)),n._space.eachConstraint(cc.DrawConstraint.bind(n)),cc.DrawNode.CanvasRenderCmd.prototype.rendering.call(this,t,e,i),n.clear())},t._drawDot=cc.DrawNode.CanvasRenderCmd.prototype._drawDot,t._drawSegment=cc.DrawNode.CanvasRenderCmd.prototype._drawSegment,t._drawPoly=cc.DrawNode.CanvasRenderCmd.prototype._drawPoly}(),cc.PhysicsDebugNode.WebGLRenderCmd=function(t){this._rootCtor(t),this._needDraw=!0,this._matrix=new cc.math.Matrix4,this._matrix.identity()},cc.PhysicsDebugNode.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype),cc.PhysicsDebugNode.WebGLRenderCmd.prototype.constructor=cc.PhysicsDebugNode.WebGLRenderCmd,cc.PhysicsDebugNode.WebGLRenderCmd.prototype.rendering=function(t){var e;(t=this._node)._space&&(t._space.eachShape(cc.DrawShape.bind(t)),t._space.eachConstraint(cc.DrawConstraint.bind(t)),e=this._worldTransform,this._matrix.mat[0]=e.a,this._matrix.mat[4]=e.c,this._matrix.mat[12]=e.tx,this._matrix.mat[1]=e.b,this._matrix.mat[5]=e.d,this._matrix.mat[13]=e.ty,cc.glBlendFunc(t._blendFunc.src,t._blendFunc.dst),this._glProgramState.apply(this._matrix),t._render(),t.clear())},!function(){cc.PhysicsSprite.CanvasRenderCmd=function(t){this._spriteCmdCtor(t),this._needDraw=!0};var t=cc.PhysicsSprite.CanvasRenderCmd.prototype=Object.create(cc.Sprite.CanvasRenderCmd.prototype);t.constructor=cc.PhysicsSprite.CanvasRenderCmd,t.rendering=function(t,e,i){var n=this._node;n._syncPosition(),n._ignoreBodyRotation||n._syncRotation(),this.transform(this.getParentRenderCmd()),cc.Sprite.CanvasRenderCmd.prototype.rendering.call(this,t,e,i)}}(),!function(){cc.PhysicsSprite.WebGLRenderCmd=function(t){this._spriteCmdCtor(t),this._needDraw=!0};var t=cc.PhysicsSprite.WebGLRenderCmd.prototype=Object.create(cc.Sprite.WebGLRenderCmd.prototype);t.constructor=cc.PhysicsSprite.WebGLRenderCmd,t.spUploadData=cc.Sprite.WebGLRenderCmd.prototype.uploadData,t.uploadData=function(t,e,i){var n=this._node;return n._syncPosition(),n._ignoreBodyRotation||n._syncRotation(),this.transform(this.getParentRenderCmd(),!0),this.spUploadData(t,e,i)}}(),!function(){function c(t,e){if(!t)throw Error("Assertion failed: "+e)}function h(t,e){!t&&console&&console.warn&&(console.warn("ASSERTION FAILED: "+e),console.trace)&&console.trace()}Object.create=Object.create||function(t){function e(){}return e.prototype=t,new e},"undefined"==typeof exports?(o={},"object"==typeof window&&(window.cp=o)):o=exports;function _(t,e){return t<e?t+" "+e:e+" "+t}function s(t,e){for(var i=0;i<t.length;i++)if(t[i]===e){t[i]=t[t.length-1],t.length--;break}}function M(t,e,i,n,s,r){if(0===i)return 0;var o=0,a=e,c=(s=E(s,n),r*=d(s),e);for(i=e+i-1;c<=i;){var h=new y(t[2*c],t[2*c+1]);r<(h=b(s,E(h,n)))?(o<h&&(o=h,a=c),c++):(Et(t,c,i),i--)}return a!=e&&Et(t,e,a),c-e}function O(t,e,i,n,s,r,o,a){var c,h;return n<0?0:0==n?(e[2*a]=r.x,e[2*a+1]=r.y,1):(c=M(e,i,n,s,r,t),h=new y(e[2*i],e[2*i+1]),s=O(t,e,i+1,c-1,s,h,r,a),e[2*(h=a+s++)]=r.x,e[2*h+1]=r.y,n=M(e,i+c,n-c,r,o,t),h=new y(e[2*(i+c)],e[2*(i+c)+1]),s+O(t,e,i+c+1,n-1,r,h,o,a+s))}function p(t,e,i){return g(m(t,e),i)}function G(t){return m(0,g(t,1))}function k(t,e){return new Dt(t.x-e,t.y-e,t.x+e,t.y+e)}function V(t,e,i){this.shape=t,this.p=e,this.d=i}function U(t,e,i){this.shape=t,this.t=e,this.n=i}function W(t,e,i,n,s,r){if(n=E(n,e),s=E(s,e),e=S(n,n)-2*S(n,s)+S(s,s),0<=(i=(r=-2*S(n,n)+2*S(n,s))*r-4*e*(i=S(n,n)-i*i))&&0<=(i=(-r-Math.sqrt(i))/(2*e))&&i<=1)return new U(t,i,P(Ft(n,s,i)))}function J(t,e){this.n=t,this.d=e}function z(t,e,i){return t===i?t.next(e):(t.a===e?t.next_a=z(t.next_a,e,i):t.next_b=z(t.next_b,e,i),t)}function n(t,e,i){this.obj=null,this.bb_l=g(e.bb_l,i.bb_l),this.bb_b=g(e.bb_b,i.bb_b),this.bb_r=m(e.bb_r,i.bb_r),this.bb_t=m(e.bb_t,i.bb_t),this.parent=null,this.setA(e),this.setB(i)}function i(t,e){this.obj=e,t.getBB(e,this),this.parent=null,this.stamp=1,this.pairs=null}function X(t,e,i,n){this.prevA=null,this.leafA=t,this.nextA=e,this.prevB=null,this.leafB=i,this.nextB=n}function H(t,e,i){i&&(i.leafA===e?i.prevA=t:i.prevB=t),t?t.leafA===e?t.nextA=i:t.nextB=i:e.pairs=i}function Y(t,e,i){var n=t.pairs,s=e.pairs;i=i.makePair(t,n,e,s),t.pairs=e.pairs=i,n&&(n.leafA===t?n.prevA=i:n.prevB=i),s&&(s.leafA===e?s.prevA=i:s.prevB=i)}function j(t,e){return(m(t.bb_r,e.bb_r)-g(t.bb_l,e.bb_l))*(m(t.bb_t,e.bb_t)-g(t.bb_b,e.bb_b))}function K(t,e){return Math.abs(t.bb_l+t.bb_r-e.bb_l-e.bb_r)+Math.abs(t.bb_b+t.bb_t-e.bb_b-e.bb_t)}function Q(t,e,i){var n,s;return null==t?e:t.isLeaf?i.makeNode(e,t):((n=t.B.bbArea()+j(t.A,e))===(s=t.A.bbArea()+j(t.B,e))&&(n=K(t.A,e),s=K(t.B,e)),s<n?t.setB(Q(t.B,e,i)):t.setA(Q(t.A,e,i)),t.bb_l=g(t.bb_l,e.bb_l),t.bb_b=g(t.bb_b,e.bb_b),t.bb_r=m(t.bb_r,e.bb_r),t.bb_t=m(t.bb_t,e.bb_t),t)}function Z(t,e,i){t.intersectsBB(e)&&(t.isLeaf?i(t.obj):(Z(t.A,e,i),Z(t.B,e,i)))}function q(t,e,i){var n=1/(i.x-e.x),s=t.bb_l==e.x?-1/0:(t.bb_l-e.x)*n,r=t.bb_r==e.x?1/0:(t.bb_r-e.x)*n,n=g(s,r),s=m(s,r),r=1/(i.y-e.y);return i=t.bb_b==e.y?-1/0:(t.bb_b-e.y)*r,e=t.bb_t==e.y?1/0:(t.bb_t-e.y)*r,t=g(i,e),e=m(i,e),t<=s&&n<=e&&(n=m(n,t),0<=g(s,e))&&n<=1?m(n,0):1/0}function $(t,e,i,n,s){var r,o;return t.isLeaf?s(t.obj):((r=q(t.A,e,i))<(o=q(t.B,e,i))?o<(n=r<n?g(n,$(t.A,e,i,n,s)):n)&&(n=g(n,$(t.B,e,i,n,s))):r<(n=o<n?g(n,$(t.B,e,i,n,s)):n)&&(n=g(n,$(t.A,e,i,n,s))),n)}function tt(t,e,i){var n;return e==t?null:(n=e.parent)==t?((e=t.otherChild(e)).parent=t.parent,t.recycle(i),e):(n.parent.replaceChild(n,n.otherChild(e),i),t)}function et(t,e){return t.bb_l<=e.bb_r&&e.bb_l<=t.bb_r&&t.bb_b<=e.bb_t&&e.bb_b<=t.bb_t}function it(t,e){}function nt(t,e,i,n,s){return(m(t.bb_r,n)-g(t.bb_l,e))*(m(t.bb_t,s)-g(t.bb_b,i))}function st(t,e,i,n){if(1==n)return e[i];if(2==n)return t.makeNode(e[i],e[i+1]);for(var s=(l=e[i]).bb_l,r=l.bb_b,o=l.bb_r,a=l.bb_t,c=i+n,h=i+1;h<c;h++)l=e[h],s=g(s,l.bb_l),r=g(r,l.bb_b),o=m(o,l.bb_r),a=m(a,l.bb_t);var l=a-r<o-s,u=Array(2*n);if(l)for(h=i;h<c;h++)u[2*h+0]=e[h].bb_l,u[2*h+1]=e[h].bb_r;else for(h=i;h<c;h++)u[2*h+0]=e[h].bb_b,u[2*h+1]=e[h].bb_t;u.sort(function(t,e){return t-e});var d=.5*(u[n-1]+u[n]),h=s,u=r,_=o,p=a;l?_=s=d:p=r=d;for(var d=c,f=i;f<d;)l=e[f],nt(l,s,r,o,a)<nt(l,h,u,_,p)?(e[f]=e[--d],e[d]=l):f++;if(d!=n)return NodeNew(t,st(t,e,i,d-i),st(t,e,d,c-d));for(l=null,h=i;h<c;h++)l=Q(l,e[h],t);return l}function rt(t,e){!t.isLeaf&&e<=10&&(rt(t.A,e+1),rt(t.B,e+1));for(var i="",n=0;n<e;n++)i+=" ";console.log(i+t.bb_b+" "+t.bb_t)}function l(t,e){this.u=this.e=0,this.surface_vr=T,this.a=t,this.body_a=t.body,this.b=e,this.body_b=e.body,this.contacts=this.thread_b_next=this.thread_b_prev=this.thread_a_next=this.thread_a_prev=null,this.stamp=0,this.handler=null,this.swappedColl=!1,this.state="first coll"}function ot(t,e,i){this.point=t,this.normal=e,this.dist=i}function at(t,e,i,n){i?i.body_a===e?i.thread_a_next=n:i.thread_b_next=n:e.arbiterList=n,n&&(n.body_a===e?n.thread_a_prev=i:n.thread_b_prev=i)}function f(t,e,i,n){this.p=t,this.n=e,this.dist=i,this.r1=this.r2=T,this.jnAcc=this.jtAcc=this.jBias=this.nMass=this.tMass=this.bounce=this.bias=0,this.hash=n,0}function u(t,e,i,n){n=i+n,e=E(e,t);var s=x(e);if(!(n*n<=s))return s=Math.sqrt(s),new f(C(t,v(e,.5+(i-.5*n)/(s||1/0))),s?v(e,1/s):new y(1,0),s-n,0)}function ct(t,e){var i=0,n=t.valueOnAxis(e[0].n,e[0].d);if(0<n)return-1;for(var s=1;s<e.length;s++){var r=t.valueOnAxis(e[s].n,e[s].d);if(0<r)return-1;n<r&&(n=r,i=s)}return kt=n,i}function ht(t,e,i,n){for(var s=[],r=t.tVerts,o=0;o<r.length;o+=2){var a=r[o],c=r[o+1];e.containsVert(a,c)&&s.push(new f(new y(a,c),i,n,_(t.hashid,o>>1)))}for(r=e.tVerts,o=0;o<r.length;o+=2)a=r[o],c=r[o+1],t.containsVert(a,c)&&s.push(new f(new y(a,c),i,n,_(e.hashid,o>>1)));if(!s.length){for(s=[],r=t.tVerts,o=0;o<r.length;o+=2)a=r[o],c=r[o+1],e.containsVertPartial(a,c,I(i))&&s.push(new f(new y(a,c),i,n,_(t.hashid,o)));for(r=e.tVerts,o=0;o<r.length;o+=2)a=r[o],c=r[o+1],t.containsVertPartial(a,c,i)&&s.push(new f(new y(a,c),i,n,_(e.hashid,o)))}return s}function lt(t,e,i){var n=S(e,t.ta)-t.r;return t=S(e,t.tb)-t.r,g(n,t)-i}function ut(t,e,i,n,s){for(var r=b(e.tn,e.ta),o=b(e.tn,e.tb),a=v(e.tn,s),c=i.tVerts,h=0;h<c.length;h+=2){var l,u=c[h],d=c[h+1];u*a.x+d*a.y<S(e.tn,e.ta)*s+e.r&&(l=e.tn.x*d-e.tn.y*u)<=r&&o<=l&&t.push(new f(new y(u,d),a,n,_(i.hashid,h)))}}function a(t){c(!t.locked,"This addition/removal cannot be done safely during a call to cpSpaceStep()  or during a query. Put these calls into a post-step callback.")}function dt(t,e){if(!e.isRogue()){var i=e?e.nodeRoot:null;if(null==i){for(e.nodeRoot=t,e!==t&&(e.nodeNext=t.nodeNext,t.nodeNext=e),i=e.arbiterList;i;i=i.next(e))dt(t,e==i.body_a?i.body_b:i.body_a);for(i=e.constraintList;i;i=i.next(e))dt(t,e==i.a?i.b:i.a)}else h(i===t,"Internal Error: Inconsistency detected in the contact graph.")}}function _t(t){var e=t.body;t.update(e.p,e.rot)}function pt(t,e,i,n){return new y(e.vx+-n.y*e.w-(t.vx+-i.y*t.w),e.vy+n.x*e.w-(t.vy+i.x*t.w))}function ft(t,e,i){return e=b(e,i),t.m_inv+t.i_inv*e*e}function gt(t,e,i,n,s,r){var o=t.m_inv+e.m_inv,a=t.i_inv,c=i.x*i.x*a;t=-i.x*i.y*a,i=o+i.y*i.y*a,o+=c,a=e.i_inv,e=n.x*n.x*a,c=-n.x*n.y*a,i+=n.y*n.y*a,h(0!==(e=i*(o+=e)-(n=0+t+c)*(t=0+t+c)),"Unsolvable constraint."),s.x=o*(e=1/e),s.y=-n*e,r.x=-t*e,r.y=i*e}function mt(t,e){return(t.restLength-e)*t.stiffness}function yt(t,e){return(e-t.restAngle)*t.stiffness}var o,g,Tt,St,m="object"==typeof window&&-1<window.navigator.userAgent.indexOf("Firefox")?(g=Math.min,Math.max):(g=function(t,e){return t<e?t:e},function(t,e){return e<t?t:e}),Ct=(o.momentForCircle=function(t,e,i,n){return t*(.5*(e*e+i*i)+x(n))},o.areaForCircle=function(t,e){return Math.PI*Math.abs(t*t-e*e)},o.momentForSegment=function(t,e,i){var n=v(C(e,i),.5);return t*(Lt(i,e)/12+x(n))},o.areaForSegment=function(t,e,i){return i*(Math.PI*i+2*Rt(t,e))},o.momentForPoly=function(t,e,i){for(var n=0,s=0,r=e.length,o=0;o<r;o+=2)var a=e[o]+i.x,c=e[o+1]+i.y,h=e[(o+2)%r]+i.x,l=e[(o+3)%r]+i.y,u=h*c-l*a,n=n+u*(a*a+c*c+(a*h+c*l)+(h*h+l*l)),s=s+u;return t*n/(6*s)},o.areaForPoly=function(t){for(var e=0,i=0,n=t.length;i<n;i+=2)e+=b(new y(t[i],t[i+1]),new y(t[(i+2)%n],t[(i+3)%n]));return-e/2},o.centroidForPoly=function(t){for(var e=0,i=new y(0,0),n=0,s=t.length;n<s;n+=2)var r=new y(t[n],t[n+1]),o=new y(t[(n+2)%s],t[(n+3)%s]),a=b(r,o),e=e+a,i=C(i,v(C(r,o),a));return v(i,1/(3*e))},o.recenterPoly=function(t){for(var e=o.centroidForPoly(t),i=0;i<t.length;i+=2)t[i]-=e.x,t[i+1]-=e.y},o.momentForBox=function(t,e,i){return t*(e*e+i*i)/12},o.momentForBox2=function(t,e){var i=e.r-e.l,n=e.t-e.b,e=v([e.l+e.r,e.b+e.t],.5);return o.momentForBox(t,i,n)+t*x(e)},o.loopIndexes=function(t){for(var e,i,n=0,s=0,r=e=t[0],o=i=t[1],a=t.length>>1,c=1;c<a;c++){var h=t[2*c],l=t[2*c+1];h<r||h==r&&l<o?(r=h,o=l,n=c):(e<h||h==e&&i<l)&&(e=h,i=l,s=c)}return[n,s]}),Et=function(t,e,i){var n=t[2*e];t[2*e]=t[2*i],t[2*i]=n,n=t[2*e+1],t[2*e+1]=t[2*i+1],t[2*i+1]=n},y=(o.convexHull=function(t,e,i){if(e)for(var n=0;n<t.length;n++)e[n]=t[n];else e=t;var s=Ct(t);return(n=s[0])==(s=s[1])?e.length=2:(Et(e,0,n),Et(e,1,0==s?n:s),n=new y(e[0],e[1]),s=new y(e[2],e[3]),t=O(i,e,2,(t.length>>1)-2,n,s,n,1)+1,e.length=2*t,h(Nt(e),"Internal error: cpConvexHull() and cpPolyValidate() did not agree.Please report this error with as much info as you can.")),e},o.Vect=function(t,e){this.x=t,this.y=e}),T=(o.v=function(t,e){return new y(t,e)},o.vzero=new y(0,0)),S=o.v.dot=function(t,e){return t.x*e.x+t.y*e.y},d=o.v.len=function(t){return Math.sqrt(S(t,t))},It=o.v.len2=function(t,e){return Math.sqrt(t*t+e*e)},C=(o.v.eql=function(t,e){return t.x===e.x&&t.y===e.y},o.v.add=function(t,e){return new y(t.x+e.x,t.y+e.y)}),E=(y.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},o.v.sub=function(t,e){return new y(t.x-e.x,t.y-e.y)}),I=(y.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this},o.v.neg=function(t){return new y(-t.x,-t.y)}),v=(y.prototype.neg=function(){return this.x=-this.x,this.y=-this.y,this},o.v.mult=function(t,e){return new y(t.x*e,t.y*e)}),b=(y.prototype.mult=function(t){return this.x*=t,this.y*=t,this},o.v.cross=function(t,e){return t.x*e.y-t.y*e.x}),A=o.v.perp=function(t){return new y(-t.y,t.x)},vt=(o.v.pvrperp=function(t){return new y(t.y,-t.x)},o.v.project=function(t,e){return v(e,S(t,e)/x(e))}),F=(y.prototype.project=function(t){return this.mult(S(this,t)/x(t)),this},o.v.rotate=function(t,e){return new y(t.x*e.x-t.y*e.y,t.x*e.y+t.y*e.x)}),bt=(y.prototype.rotate=function(t){return this.x=this.x*t.x-this.y*t.y,this.y=this.x*t.y+this.y*t.x,this},o.v.unrotate=function(t,e){return new y(t.x*e.x+t.y*e.y,t.y*e.x-t.x*e.y)}),x=o.v.lengthsq=function(t){return S(t,t)},At=o.v.lengthsq2=function(t,e){return t*t+e*e},Ft=o.v.lerp=function(t,e,i){return C(v(t,1-i),v(e,i))},P=o.v.normalize=function(t){return v(t,1/d(t))},xt=o.v.normalize_safe=function(t){return 0===t.x&&0===t.y?T:P(t)},Pt=o.v.clamp=function(t,e){return S(t,t)>e*e?v(P(t),e):t},Rt=(o.v.lerpconst=function(t,e,i){return C(t,Pt(E(e,t),i))},o.v.dist=function(t,e){return d(E(t,e))}),Lt=o.v.distsq=function(t,e){return x(E(t,e))},Bt=(o.v.near=function(t,e,i){return Lt(t,e)<i*i},o.v.slerp=function(t,e,i){var n,s=Math.acos(S(t,e));return s?(n=1/Math.sin(s),C(v(t,Math.sin((1-i)*s)*n),v(e,Math.sin(i*s)*n))):t}),Dt=(o.v.slerpconst=function(t,e,i){var n=Math.acos(S(t,e));return Bt(t,e,g(i,n)/n)},o.v.forangle=function(t){return new y(Math.cos(t),Math.sin(t))},o.v.toangle=function(t){return Math.atan2(t.y,t.x)},o.v.str=function(t){return"("+t.x.toFixed(3)+", "+t.y.toFixed(3)+")"},o.BB=function(t,e,i,n){this.l=t,this.b=e,this.r=i,this.t=n,0}),wt=(o.bb=function(t,e,i,n){return new Dt(t,e,i,n)},0),r=(o.NO_GROUP=0,o.ALL_LAYERS=-1,o.ALL_CATEGORIES=-1,o.resetShapeIdCounter=function(){wt=0},o.Shape=function(t){this.body=t,this.bb_l=this.bb_b=this.bb_r=this.bb_t=0,this.hashid=wt++,this.sensor=!1,this.u=this.e=0,this.surface_v=T,this.group=this.collision_type=0,this.layers=-1,this.space=null,this.collisionCode=this.collisionCode}),t=(r.prototype.setElasticity=function(t){this.e=t},r.prototype.setFriction=function(t){this.body.activate(),this.u=t},r.prototype.setLayers=function(t){this.body.activate(),this.layers=t},r.prototype.setSensor=function(t){this.body.activate(),this.sensor=t},r.prototype.setCollisionType=function(t){this.body.activate(),this.collision_type=t},r.prototype.getBody=function(){return this.body},r.prototype.active=function(){return this.body&&-1!==this.body.shapeList.indexOf(this)},r.prototype.setBody=function(t){c(!this.active(),"You cannot change the body on an active shape. You must remove the shape from the space before changing the body."),this.body=t},r.prototype.cacheBB=function(){return this.update(this.body.p,this.body.rot)},r.prototype.update=function(t,e){c(!isNaN(e.x),"Rotation is NaN"),c(!isNaN(t.x),"Position is NaN"),this.cacheData(t,e)},r.prototype.pointQuery=function(t){if((t=this.nearestPointQuery(t)).d<0)return t},r.prototype.getBB=function(){return new Dt(this.bb_l,this.bb_b,this.bb_r,this.bb_t)},U.prototype.hitPoint=function(t,e){return Ft(t,e,this.t)},U.prototype.hitDist=function(t,e){return Rt(t,e)*this.t},o.CircleShape=function(t,e,i){this.c=this.tc=i,this.r=e,this.type="circle",r.call(this,t)}),e=((t.prototype=Object.create(r.prototype)).cacheData=function(t,e){e=this.tc=F(this.c,e).add(t),t=this.r;this.bb_l=e.x-t,this.bb_b=e.y-t,this.bb_r=e.x+t,this.bb_t=e.y+t},t.prototype.nearestPointQuery=function(t){var e=t.x-this.tc.x,i=t.y-this.tc.y,n=(t=It(e,i),this.r),e=new y(this.tc.x+e*n/t,this.tc.y+i*n/t);return new V(this,e,t-n)},t.prototype.segmentQuery=function(t,e){return W(this,this.tc,this.r,t,e)},o.SegmentShape=function(t,e,i,n){this.a=e,this.b=i,this.n=A(P(E(i,e))),this.ta=this.tb=this.tn=null,this.r=n,this.b_tangent=this.a_tangent=T,this.type="segment",r.call(this,t)}),Nt=((e.prototype=Object.create(r.prototype)).cacheData=function(t,e){this.ta=C(t,F(this.a,e)),this.tb=C(t,F(this.b,e)),this.tn=F(this.n,e),t=(this.ta.x<this.tb.x?(i=this.ta.x,this.tb):(i=this.tb.x,this.ta)).x,e=(this.ta.y<this.tb.y?(n=this.ta.y,this.tb):(n=this.tb.y,this.ta)).y;var i,n,s=this.r;this.bb_l=i-s,this.bb_b=n-s,this.bb_r=t+s,this.bb_t=e+s},e.prototype.nearestPointQuery=function(t){var e=this.tb,i=E(this.ta,e),n=G(S(i,E(t,e))/x(i)),i=(e=C(e,v(i,n)),t.x-e.x),s=t.y-e.y;return t=It(i,s),n=this.r,e=t?C(e,v(new y(i,s),n/t)):e,new V(this,e,t-n)},e.prototype.segmentQuery=function(t,e){var i=this.tn,n=S(E(this.ta,t),i),s=this.r,r=0<n?I(i):i,o=E(v(r,s),t),a=C(this.ta,o),c=C(this.tb,o),o=E(e,t);if(b(o,a)*b(o,c)<=0){if((n=-(s=n+(0<n?-s:s)))*(i=S(o,i)-s)<0)return new U(this,n/(n-i),r)}else if(0!==s)return r=W(this,this.ta,this.r,t,e),i=W(this,this.tb,this.r,t,e),!r||i&&i.t<r.t?i:r},e.prototype.setNeighbors=function(t,e){this.a_tangent=E(t,this.a),this.b_tangent=E(e,this.b)},e.prototype.setEndpoints=function(t,e){this.a=t,this.b=e,this.n=A(P(E(e,t)))},function(t){for(var e=t.length,i=0;i<e;i+=2){var n=t[(i+2)%e],s=t[(i+3)%e];if(0<(n-t[i])*(t[(i+5)%e]-s)-(s-t[i+1])*(t[(i+4)%e]-n))return!1}return!0}),R=o.PolyShape=function(t,e,i){this.setVerts(e,i),this.type="poly",r.call(this,t)},Mt=(R.prototype=Object.create(r.prototype),J.prototype.compare=function(t){return S(this.n,t)-this.d},R.prototype.setVerts=function(t,e){c(4<=t.length,"Polygons require some verts"),c("number"==typeof t[0],"Polygon verticies should be specified in a flattened list (eg [x1,y1,x2,y2,x3,y3,...])"),c(Nt(t),"Polygon is concave or has a reversed winding. Consider using cpConvexHull()");var i=t.length,n=i>>1;for(this.verts=Array(i),this.tVerts=Array(i),this.planes=Array(n),this.tPlanes=Array(n),n=0;n<i;n+=2){var s=t[n]+e.x,r=t[n+1]+e.y,o=P(A(new y(t[(n+2)%i]+e.x-s,t[(n+3)%i]+e.y-r)));this.verts[n]=s,this.verts[n+1]=r,this.planes[n>>1]=new J(o,o.x*s+o.y*r),this.tPlanes[n>>1]=new J(new y(0,0),0)}},o.BoxShape=function(t,e,i){return Mt(t,new Dt(-(e/=2),-(i/=2),e,i))},o.BoxShape2=function(t,e){return new R(t,[e.l,e.b,e.l,e.t,e.r,e.t,e.r,e.b],T)}),L=(R.prototype.transformVerts=function(t,e){for(var i=this.verts,n=this.tVerts,s=1/0,r=-1/0,o=1/0,a=-1/0,c=0;c<i.length;c+=2){var h=i[c],l=i[c+1],u=t.x+h*e.x-l*e.y,h=t.y+h*e.y+l*e.x;n[c]=u,n[c+1]=h,s=g(s,u),r=m(r,u),o=g(o,h),a=m(a,h)}this.bb_l=s,this.bb_b=o,this.bb_r=r,this.bb_t=a},R.prototype.transformAxes=function(t,e){for(var i=this.planes,n=this.tPlanes,s=0;s<i.length;s++){var r=F(i[s].n,e);n[s].n=r,n[s].d=S(t,r)+i[s].d}},R.prototype.cacheData=function(t,e){this.transformAxes(t,e),this.transformVerts(t,e)},R.prototype.nearestPointQuery=function(t){for(var e=this.tPlanes,i=this.tVerts,n=i[i.length-2],s=i[i.length-1],r=1/0,o=T,a=!1,c=0;c<e.length;c++){0<e[c].compare(t)&&(a=!0);var h=i[2*c],l=i[2*c+1],u=h,d=l,s=s-d,_=G(((n=n-u)*(t.x-u)+s*(t.y-d))/At(n,s));u=new y(u+n*_,d+s*_),(d=Rt(t,u))<r&&(r=d,o=u),n=h,s=l}return new V(this,o,a?r:-r)},R.prototype.segmentQuery=function(t,e){for(var i=this.tPlanes,n=this.tVerts,s=i.length,r=2*s,o=0;o<s;o++){var a=i[o].n,c=S(t,a);if(!(i[o].d>c)){var h=S(e,a);if(!((c=(i[o].d-c)/(h-c))<0||1<c)){var h=Ft(t,e,c),h=-b(a,h),l=-(a.x*n[(2*o+3)%r]-a.y*n[(2*o+2)%r]);if(-(a.x*n[2*o+1]-a.y*n[2*o])<=h&&h<=l)return new U(this,c,a)}}}},R.prototype.valueOnAxis=function(t,e){for(var i=this.tVerts,n=t.x*i[0]+t.y*i[1],s=2;s<i.length;s+=2)n=g(n,t.x*i[s]+t.y*i[s+1]);return n-e},R.prototype.containsVert=function(t,e){for(var i=this.tPlanes,n=0;n<i.length;n++){var s=i[n].n;if(0<s.x*t+s.y*e-i[n].d)return!1}return!0},R.prototype.containsVertPartial=function(t,e,i){for(var n=this.tPlanes,s=0;s<n.length;s++){var r=n[s].n;if(!(S(r,i)<0)&&0<r.x*t+r.y*e-n[s].d)return!1}return!0},R.prototype.getNumVerts=function(){return this.verts.length/2},R.prototype.getCount=R.prototype.getNumVerts,R.prototype.getVert=function(t){return new y(this.verts[2*t],this.verts[2*t+1])},o.Body=function(t,e){this.p=new y(0,0),this.vx=this.vy=0,this.f=new y(0,0),this.t=this.w=0,this.w_limit=this.v_limit=1/0,this.w_bias=this.v_biasx=this.v_biasy=0,this.space=null,this.shapeList=[],this.nodeNext=this.nodeRoot=this.constraintList=this.arbiterList=null,this.nodeIdleTime=0,this.setMass(t),this.setMoment(e),this.rot=new y(0,0),this.setAngle(0)}),Ot=(o.StaticBody=function(){var t=new L(1/0,1/0);return t.nodeIdleTime=1/0,t},"undefined"!=typeof DEBUG&&DEBUG?(Tt=function(t,e){c(t.x==t.x&&t.y==t.y,e)},St=function(t,e){c(1/0!==Math.abs(t.x)&&1/0!==Math.abs(t.y),e)},L.prototype.sanityCheck=function(){c(this.m==this.m&&this.m_inv==this.m_inv,"Body's mass is invalid."),c(this.i==this.i&&this.i_inv==this.i_inv,"Body's moment is invalid.");var t=this.p;Tt(t,"Body's position is invalid."),St(t,"Body's position is invalid."),t=this.f,Tt(t,"Body's force is invalid."),St(t,"Body's force is invalid."),c(this.vx==this.vx&&1/0!==Math.abs(this.vx),"Body's velocity is invalid."),c(this.vy==this.vy&&1/0!==Math.abs(this.vy),"Body's velocity is invalid."),c(this.a==this.a&&1/0!==Math.abs(this.a),"Body's angle is invalid."),c(this.w==this.w&&1/0!==Math.abs(this.w),"Body's angular velocity is invalid."),c(this.t==this.t&&1/0!==Math.abs(this.t),"Body's torque is invalid."),t=this.rot,Tt(t,"Body's rotation vector is invalid."),St(t,"Body's rotation vector is invalid."),c(this.v_limit==this.v_limit,"Body's velocity limit is invalid."),c(this.w_limit==this.w_limit,"Body's angular velocity limit is invalid.")}):L.prototype.sanityCheck=function(){},L.prototype.getPos=function(){return this.p},L.prototype.getVel=function(){return new y(this.vx,this.vy)},L.prototype.getAngVel=function(){return this.w},L.prototype.getPosition=L.prototype.getPos,L.prototype.getVelocity=L.prototype.getVel,L.prototype.getAngularVelocity=L.prototype.getAngVel,L.prototype.getCenterOfGravity=function(){return this.p},L.prototype.isSleeping=function(){return null!==this.nodeRoot},L.prototype.isStatic=function(){return 1/0===this.nodeIdleTime},L.prototype.isRogue=function(){return null===this.space},L.prototype.setMass=function(t){c(0<t,"Mass must be positive and non-zero."),this.activate(),this.m=t,this.m_inv=1/t},L.prototype.setMoment=function(t){c(0<t,"Moment of Inertia must be positive and non-zero."),this.activate(),this.i=t,this.i_inv=1/t},L.prototype.addShape=function(t){this.shapeList.push(t)},L.prototype.removeShape=function(t){s(this.shapeList,t)},L.prototype.removeConstraint=function(t){this.constraintList=z(this.constraintList,this,t)},L.prototype.setPos=function(t){this.activate(),this.sanityCheck(),t===T&&(t=o.v(0,0)),this.p=t},L.prototype.setVel=function(t){this.activate(),this.vx=t.x,this.vy=t.y},L.prototype.setAngVel=function(t){this.activate(),this.w=t},L.prototype.setAngleInternal=function(t){c(!isNaN(t),"Internal Error: Attempting to set body's angle to NaN"),this.a=t,this.rot.x=Math.cos(t),this.rot.y=Math.sin(t)},L.prototype.setAngle=function(t){this.activate(),this.sanityCheck(),this.setAngleInternal(t)},L.prototype.velocity_func=function(t,e,i){var n=this.vx*e+(t.x+this.f.x*this.m_inv)*i,s=(t=this.vy*e+(t.y+this.f.y*this.m_inv)*i,this.v_limit),r=n*n+t*t,s=s*s<r?s/Math.sqrt(r):1;this.vx=n*s,this.vy=t*s,n=this.w_limit,this.w=p(this.w*e+this.t*this.i_inv*i,-n,n),this.sanityCheck()},L.prototype.position_func=function(t){this.p.x+=(this.vx+this.v_biasx)*t,this.p.y+=(this.vy+this.v_biasy)*t,this.setAngleInternal(this.a+(this.w+this.w_bias)*t),this.w_bias=this.v_biasx=this.v_biasy=0,this.sanityCheck()},L.prototype.resetForces=function(){this.activate(),this.f=new y(0,0),this.t=0},L.prototype.applyForce=function(t,e){this.activate(),this.f=C(this.f,t),this.t+=b(e,t)},L.prototype.applyImpulse=function(t,e){this.activate(),Jt(this,t.x,t.y,e)},L.prototype.getVelAtPoint=function(t){return C(new y(this.vx,this.vy),v(A(t),this.w))},L.prototype.getVelAtWorldPoint=function(t){return this.getVelAtPoint(E(t,this.p))},L.prototype.getVelAtLocalPoint=function(t){return this.getVelAtPoint(F(t,this.rot))},L.prototype.eachShape=function(t){for(var e=0,i=this.shapeList.length;e<i;e++)t(this.shapeList[e])},L.prototype.eachConstraint=function(t){for(var e=this.constraintList;e;){var i=e.next(this);t(e),e=i}},L.prototype.eachArbiter=function(t){for(var e=this.arbiterList;e;){var i=e.next(this);e.swappedColl=this===e.body_b,t(e),e=i}},L.prototype.local2World=function(t){return C(this.p,F(t,this.rot))},L.prototype.world2Local=function(t){return bt(E(t,this.p),this.rot)},L.prototype.localToWorld=L.prototype.local2World,L.prototype.worldToLocal=L.prototype.world2Local,L.prototype.kineticEnergy=function(){var t=this.vx*this.vx+this.vy*this.vy,e=this.w*this.w;return(t?t*this.m:0)+(e?e*this.i:0)},o.SpatialIndex=function(t){if(this.staticIndex=t){if(t.dynamicIndex)throw Error("This static index is already associated with a dynamic index.");t.dynamicIndex=this}}),B=(Ot.prototype.collideStatic=function(t,e){var i;0<t.count&&(i=t.query,this.each(function(t){i(t,new Dt(t.bb_l,t.bb_b,t.bb_r,t.bb_t),e)}))},o.BBTree=function(t){Ot.call(this,t),this.velocityFunc=null,this.leaves={},this.count=0,this.pooledPairs=this.pooledNodes=this.root=null,this.stamp=0}),Gt=(B.prototype=Object.create(Ot.prototype),B.prototype.makeNode=function(t,e){var i=this.pooledNodes;return i?(this.pooledNodes=i.parent,i.constructor(this,t,e),i):new n(0,t,e)},B.prototype.getBB=function(t,e){var i,n,s=this.velocityFunc;s?(i=.1*(t.bb_r-t.bb_l),n=.1*(t.bb_t-t.bb_b),s=v(s(t),.1),e.bb_l=t.bb_l+g(-i,s.x),e.bb_b=t.bb_b+g(-n,s.y),e.bb_r=t.bb_r+m(i,s.x),e.bb_t=t.bb_t+m(n,s.y)):(e.bb_l=t.bb_l,e.bb_b=t.bb_b,e.bb_r=t.bb_r,e.bb_t=t.bb_t)},B.prototype.getStamp=function(){var t=this.dynamicIndex;return(t&&t.stamp?t:this).stamp},B.prototype.incrementStamp=function(){this.dynamicIndex&&this.dynamicIndex.stamp?this.dynamicIndex.stamp++:this.stamp++},B.prototype.makePair=function(t,e,i,n){var s=this.pooledPairs;return s?(this.pooledPairs=s.prevA,s.prevA=null,s.leafA=t,s.nextA=e,s.prevB=null,s.leafB=i,s.nextB=n,s):new X(t,e,i,n)},X.prototype.recycle=function(t){this.prevA=t.pooledPairs,t.pooledPairs=this},i.prototype.clearPairs=function(t){var e,i=this.pairs;for(this.pairs=null;i;)i.leafA===this?(e=i.nextA,H(i.prevB,i.leafB,i.nextB)):(e=i.nextB,H(i.prevA,i.leafA,i.nextA)),i.recycle(t),i=e},n.prototype.recycle=function(t){this.parent=t.pooledNodes,t.pooledNodes=this},i.prototype.recycle=function(t){},n.prototype.setA=function(t){(this.A=t).parent=this},n.prototype.setB=function(t){(this.B=t).parent=this},n.prototype.isLeaf=!(i.prototype.isLeaf=!0),n.prototype.otherChild=function(t){return this.A==t?this.B:this.A},n.prototype.replaceChild=function(t,e,i){for(h(t==this.A||t==this.B,"Node is not a child of parent."),this.A==t?(this.A.recycle(i),this.setA(e)):(this.B.recycle(i),this.setB(e)),t=this;t;t=t.parent)e=t.A,i=t.B,t.bb_l=g(e.bb_l,i.bb_l),t.bb_b=g(e.bb_b,i.bb_b),t.bb_r=m(e.bb_r,i.bb_r),t.bb_t=m(e.bb_t,i.bb_t)},n.prototype.bbArea=i.prototype.bbArea=function(){return(this.bb_r-this.bb_l)*(this.bb_t-this.bb_b)},n.prototype.intersectsBB=i.prototype.intersectsBB=function(t){return this.bb_l<=t.r&&t.l<=this.bb_r&&this.bb_b<=t.t&&t.b<=this.bb_t},B.prototype.subtreeRecycle=function(t){t.isLeaf&&(this.subtreeRecycle(t.A),this.subtreeRecycle(t.B),t.recycle(this))},i.prototype.markLeafQuery=function(t,e,i,n){et(t,this)&&(e?Y(t,this,i):(this.stamp<t.stamp&&Y(this,t,i),n&&n(t.obj,this.obj)))},n.prototype.markLeafQuery=function(t,e,i,n){et(t,this)&&(this.A.markLeafQuery(t,e,i,n),this.B.markLeafQuery(t,e,i,n))},i.prototype.markSubtree=function(t,e,i){if(this.stamp==t.getStamp())for(e&&e.markLeafQuery(this,!1,t,i),e=this;e.parent;e=e.parent)e==e.parent.A?e.parent.B.markLeafQuery(this,!0,t,i):e.parent.A.markLeafQuery(this,!1,t,i);else for(t=this.pairs;t;)t=this===t.leafB?(i&&i(t.leafA.obj,this.obj),t.nextB):t.nextA},n.prototype.markSubtree=function(t,e,i){this.A.markSubtree(t,e,i),this.B.markSubtree(t,e,i)},i.prototype.containsObj=function(t){return this.bb_l<=t.bb_l&&this.bb_r>=t.bb_r&&this.bb_b<=t.bb_b&&this.bb_t>=t.bb_t},i.prototype.update=function(t){var e=t.root;return!this.containsObj(this.obj)&&(t.getBB(this.obj,this),e=tt(e,this,t),t.root=Q(e,this,t),this.clearPairs(t),this.stamp=t.getStamp(),!0)},i.prototype.addPairs=function(t){var e=t.dynamicIndex;e?(t=e.root)&&t.markLeafQuery(this,!0,e,null):this.markSubtree(t,t.staticIndex.root,null)},B.prototype.insert=function(t,e){t=new i(this,t);this.leaves[e]=t,this.root=Q(this.root,t,this),this.count++,t.stamp=this.getStamp(),t.addPairs(this),this.incrementStamp()},B.prototype.remove=function(t,e){var i=this.leaves[e];delete this.leaves[e],this.root=tt(this.root,i,this),this.count--,i.clearPairs(this),i.recycle(this)},B.prototype.contains=function(t,e){return null!=this.leaves[e]},B.prototype.reindexQuery=function(t){if(this.root){var e,i=this.leaves;for(e in i)i[e].update(this);i=(e=this.staticIndex)&&e.root,this.root.markSubtree(this,i,t),e&&!i&&this.collideStatic(this,e,t),this.incrementStamp()}},B.prototype.reindex=function(){this.reindexQuery(it)},B.prototype.reindexObject=function(t,e){e=this.leaves[e];e&&(e.update(this)&&e.addPairs(this),this.incrementStamp())},B.prototype.pointQuery=function(t,e){this.query(new Dt(t.x,t.y,t.x,t.y),e)},B.prototype.segmentQuery=function(t,e,i,n){this.root&&$(this.root,t,e,i,n)},B.prototype.query=function(t,e){this.root&&Z(this.root,t,e)},B.prototype.count=function(){return this.count},B.prototype.each=function(t){for(var e in this.leaves)t(this.leaves[e].obj)},B.prototype.optimize=function(){var t,e=Array(this.count),i=0;for(t in this.leaves)e[i++]=this.nodes[t];tree.subtreeRecycle(root),this.root=st(tree,e,e.length)},B.prototype.log=function(){this.root&&rt(this.root,0)},o.CollisionHandler=function(){this.a=this.b=0}),D=(Gt.prototype.begin=function(t,e){return!0},Gt.prototype.preSolve=function(t,e){return!0},Gt.prototype.postSolve=function(t,e){},Gt.prototype.separate=function(t,e){},l.prototype.getShapes=function(){return this.swappedColl?[this.b,this.a]:[this.a,this.b]},l.prototype.totalImpulse=function(){for(var t=this.contacts,e=new y(0,0),i=0,n=t.length;i<n;i++){var s=t[i];e.add(v(s.n,s.jnAcc))}return this.swappedColl?e:e.neg()},l.prototype.totalImpulseWithFriction=function(){for(var t=this.contacts,e=new y(0,0),i=0,n=t.length;i<n;i++){var s=t[i];e.add(new y(s.jnAcc,s.jtAcc).rotate(s.n))}return this.swappedColl?e:e.neg()},l.prototype.totalKE=function(){for(var t=(1-this.e)/(1+this.e),e=0,i=this.contacts,n=0,s=i.length;n<s;n++)var r=i[n],o=r.jnAcc,a=r.jtAcc,e=e+(t*o*o/r.nMass+a*a/r.tMass);return e},l.prototype.ignore=function(){this.state="ignore"},l.prototype.getA=function(){return this.swappedColl?this.b:this.a},l.prototype.getB=function(){return this.swappedColl?this.a:this.b},l.prototype.isFirstContact=function(){return"first coll"===this.state},l.prototype.getContactPointSet=function(){for(var t=Array(this.contacts.length),e=0;e<t.length;e++)t[e]=new ot(this.contacts[e].p,this.contacts[e].n,this.contacts[e].dist);return t},l.prototype.getNormal=function(t){return t=this.contacts[t].n,this.swappedColl?I(t):t},l.prototype.getPoint=function(t){return this.contacts[t].p},l.prototype.getDepth=function(t){return this.contacts[t].dist},l.prototype.unthread=function(){at(0,this.body_a,this.thread_a_prev,this.thread_a_next),at(0,this.body_b,this.thread_b_prev,this.thread_b_next),this.thread_b_prev=this.thread_b_next=this.thread_a_prev=this.thread_a_next=null},l.prototype.update=function(t,e,i,n){if(this.contacts)for(var s=0;s<this.contacts.length;s++)for(var r=this.contacts[s],o=0;o<t.length;o++){var a=t[o];a.hash===r.hash&&(a.jnAcc=r.jnAcc,a.jtAcc=r.jtAcc)}this.contacts=t,this.handler=e,this.swappedColl=i.collision_type!==e.a,this.e=i.e*n.e,this.u=i.u*n.u,this.surface_vr=E(i.surface_v,n.surface_v),this.a=i,this.body_a=i.body,this.b=n,this.body_b=n.body,"cached"==this.state&&(this.state="first coll")},l.prototype.preStep=function(t,e,i){for(var n=this.body_a,s=this.body_b,r=0;r<this.contacts.length;r++){var o=this.contacts[r];o.r1=E(o.p,n.p),o.r2=E(o.p,s.p),o.nMass=1/Xt(n,s,o.r1,o.r2,o.n),o.tMass=1/Xt(n,s,o.r1,o.r2,A(o.n)),o.bias=-i*g(0,o.dist+e)/t,o.jBias=0,o.bounce=Wt(n,s,o.r1,o.r2,o.n)*this.e}},l.prototype.applyCachedImpulse=function(t){if(!this.isFirstContact())for(var e=this.body_a,i=this.body_b,n=0;n<this.contacts.length;n++){var s=this.contacts[n],r=s.n.x,o=s.n.y;w(e,i,s.r1,s.r2,(r*s.jnAcc-o*s.jtAcc)*t,(r*s.jtAcc+o*s.jnAcc)*t)}},l.prototype.applyImpulse=function(){0;for(var t=this.body_a,e=this.body_b,i=this.surface_vr,n=this.u,s=0;s<this.contacts.length;s++){0;var r=this.contacts[s],o=r.nMass,a=r.n,c=r.r1,h=r.r2,l=e.vx-h.y*e.w-(t.vx-c.y*t.w),u=e.vy+h.x*e.w-(t.vy+c.x*t.w),d=l*a.x+u*a.y,_=(l+i.x)*-a.y+(u+i.y)*a.x,u=r.jBias;r.jBias=m(u+(r.bias-(a.x*(e.v_biasx-h.y*e.w_bias-t.v_biasx+c.y*t.w_bias)+a.y*(h.x*e.w_bias+e.v_biasy-c.x*t.w_bias-t.v_biasy)))*o,0),l=r.jnAcc,r.jnAcc=m(l+-(r.bounce+d)*o,0),d=n*r.jnAcc,o=r.jtAcc,r.jtAcc=p(o+-_*r.tMass,-d,d),d=a.x*(r.jBias-u),u=a.y*(r.jBias-u),zt(t,-d,-u,c),zt(e,d,u,h),l=r.jnAcc-l,r=r.jtAcc-o,w(t,e,c,h,a.x*l-a.y*r,a.x*r+a.y*l)}},l.prototype.callSeparate=function(t){t.lookupHandler(this.a.collision_type,this.b.collision_type).separate(this,t)},l.prototype.next=function(t){return this.body_a==t?this.thread_a_next:this.thread_b_next},[]),kt=0,Vt=(t.prototype.collisionCode=0,e.prototype.collisionCode=1,R.prototype.collisionCode=2,t.prototype.collisionTable=[function(t,e){t=u(t.tc,e.tc,t.r,e.r);return t?[t]:D},function(t,e){var i=e.ta,n=t.tc,s=E(e.tb,i),r=G(S(s,E(n,i))/x(s)),i=C(i,v(s,r));return!(n=u(n,i,t.r,e.r))||(i=n.n,0===r&&S(i,e.a_tangent)<0)||1===r&&S(i,e.b_tangent)<0?D:[n]},function(t,e){for(var i=e.tPlanes,n=0,s=S(i[0].n,t.tc)-i[0].d-t.r,r=0;r<i.length;r++){if(0<(c=S(i[r].n,t.tc)-i[r].d-t.r))return D;s<c&&(s=c,n=r)}var o,i=i[n].n,a=(e=e.tVerts).length,n=e[h=n<<1],r=e[1+h],c=e[(2+h)%a],e=e[(3+h)%a],a=i.x*r-i.y*n,h=i.x*e-i.y*c,l=b(i,t.tc);return l<h?(o=u(t.tc,new y(c,e),t.r,0))?[o]:D:l<a?[new f(E(t.tc,v(i,t.r+s/2)),I(i),s,0)]:(o=u(t.tc,new y(n,r),t.r,0))?[o]:D}],e.prototype.collisionTable=[null,function(t,e){return D},function(t,e){var i=[],n=e.tPlanes,s=n.length,r=S(t.tn,t.ta),o=e.valueOnAxis(t.tn,r)-t.r;if(0<(r=e.valueOnAxis(I(t.tn),-r)-t.r)||0<o)return D;var a=0,c=lt(t,n[0].n,n[0].d);if(0<c)return D;for(var h=0;h<s;h++){var l=lt(t,n[h].n,n[h].d);if(0<l)return D;c<l&&(c=l,a=h)}if(n=I(n[a].n),h=C(t.ta,v(n,t.r)),l=C(t.tb,v(n,t.r)),e.containsVert(h.x,h.y)&&i.push(new f(h,n,c,_(t.hashid,0))),e.containsVert(l.x,l.y)&&i.push(new f(l,n,c,_(t.hashid,1))),(c<=o||c<=r)&&(r<o?ut(i,t,e,o,1):ut(i,t,e,r,-1)),0===i.length){if(r=e.tVerts,c=new y(r[o=2*a],r[1+o]),a=(a=u(t.ta,c,t.r,0))||u(t.tb,c,t.r,0))return[a];if(s=new y(r[(2+o)%(s*=2)],r[(3+o)%s]),a=(a=u(t.ta,s,t.r,0))||u(t.tb,s,t.r,0))return[a]}return i}],R.prototype.collisionTable=[null,null,function(t,e){var i,n,s,r=ct(e,t.tPlanes);return-1==r||(i=kt,-1==(n=ct(t,e.tPlanes)))?D:(s=kt)<i?ht(t,e,t.tPlanes[r].n,i):ht(t,e,I(e.tPlanes[n].n),s)}],o.collideShapes=function(t,e){return c(t.collisionCode<=e.collisionCode,"Collided shapes must be sorted by type"),t.collisionTable[e.collisionCode](t,e)}),Ut=new Gt,t=o.Space=function(){this.curr_dt=this.stamp=0,this.bodies=[],this.rousedBodies=[],this.sleepingComponents=[],this.staticShapes=new B(null),this.activeShapes=new B(this.staticShapes),this.arbiters=[],this.contactBuffersHead=null,this.cachedArbiters={},this.constraints=[],this.locked=0,this.collisionHandlers={},this.defaultHandler=Ut,this.postStepCallbacks=[],this.iterations=10,this.gravity=T,this.damping=1,this.idleSpeedThreshold=0,this.sleepTimeThreshold=1/0,this.collisionSlop=.1,this.collisionBias=Math.pow(.9,60),this.collisionPersistence=3,this.enableContactGraph=!1,this.staticBody=new L(1/0,1/0),this.staticBody.nodeIdleTime=1/0,this.collideShapes=this.makeCollideShapes()},Wt=(t.prototype.getCurrentTimeStep=function(){return this.curr_dt},t.prototype.setIterations=function(t){this.iterations=t},t.prototype.isLocked=function(){return this.locked},t.prototype.addCollisionHandler=function(t,e,i,n,s,r){a(this),this.removeCollisionHandler(t,e);var o=new Gt;o.a=t,o.b=e,i&&(o.begin=i),n&&(o.preSolve=n),s&&(o.postSolve=s),r&&(o.separate=r),this.collisionHandlers[_(t,e)]=o},t.prototype.removeCollisionHandler=function(t,e){a(this),delete this.collisionHandlers[_(t,e)]},t.prototype.setDefaultCollisionHandler=function(t,e,i,n){a(this);var s=new Gt;t&&(s.begin=t),e&&(s.preSolve=e),i&&(s.postSolve=i),n&&(s.separate=n),this.defaultHandler=s},t.prototype.lookupHandler=function(t,e){return this.collisionHandlers[_(t,e)]||this.defaultHandler},t.prototype.addShape=function(t){var e=t.body;return e.isStatic()?this.addStaticShape(t):(c(!t.space,"This shape is already added to a space and cannot be added to another."),a(this),e.activate(),e.addShape(t),t.update(e.p,e.rot),this.activeShapes.insert(t,t.hashid),t.space=this,t)},t.prototype.addStaticShape=function(t){c(!t.space,"This shape is already added to a space and cannot be added to another."),a(this);var e=t.body;return e.addShape(t),t.update(e.p,e.rot),this.staticShapes.insert(t,t.hashid),t.space=this,t},t.prototype.addBody=function(t){return c(!t.isStatic(),"Static bodies cannot be added to a space as they are not meant to be simulated."),c(!t.space,"This body is already added to a space and cannot be added to another."),a(this),this.bodies.push(t),t.space=this,t},t.prototype.addConstraint=function(t){c(!t.space,"This shape is already added to a space and cannot be added to another."),a(this);var e=t.a,i=t.b;return e.activate(),i.activate(),this.constraints.push(t),t.next_a=e.constraintList,(e.constraintList=t).next_b=i.constraintList,(i.constraintList=t).space=this,t},t.prototype.filterArbiters=function(t,e){for(var i in this.cachedArbiters){var n=this.cachedArbiters[i];(t!==n.body_a||e!==n.a&&null!==e)&&(t!==n.body_b||e!==n.b&&null!==e)||(e&&"cached"!==n.state&&n.callSeparate(this),n.unthread(),s(this.arbiters,n),delete this.cachedArbiters[i])}},t.prototype.removeShape=function(t){var e=t.body;e.isStatic()?this.removeStaticShape(t):(c(this.containsShape(t),"Cannot remove a shape that was not added to the space. (Removed twice maybe?)"),a(this),e.activate(),e.removeShape(t),this.filterArbiters(e,t),this.activeShapes.remove(t,t.hashid),t.space=null)},t.prototype.removeStaticShape=function(t){c(this.containsShape(t),"Cannot remove a static or sleeping shape that was not added to the space. (Removed twice maybe?)"),a(this);var e=t.body;e.isStatic()&&e.activateStatic(t),e.removeShape(t),this.filterArbiters(e,t),this.staticShapes.remove(t,t.hashid),t.space=null},t.prototype.removeBody=function(t){c(this.containsBody(t),"Cannot remove a body that was not added to the space. (Removed twice maybe?)"),a(this),t.activate(),s(this.bodies,t),t.space=null},t.prototype.removeConstraint=function(t){c(this.containsConstraint(t),"Cannot remove a constraint that was not added to the space. (Removed twice maybe?)"),a(this),t.a.activate(),t.b.activate(),s(this.constraints,t),t.a.removeConstraint(t),t.b.removeConstraint(t),t.space=null},t.prototype.containsShape=function(t){return t.space===this},t.prototype.containsBody=function(t){return t.space==this},t.prototype.containsConstraint=function(t){return t.space==this},t.prototype.uncacheArbiter=function(t){delete this.cachedArbiters[_(t.a.hashid,t.b.hashid)],s(this.arbiters,t)},t.prototype.eachBody=function(t){this.lock();for(var e=this.bodies,i=0;i<e.length;i++)t(e[i]);for(e=this.sleepingComponents,i=0;i<e.length;i++)for(var n=e[i];n;){var s=n.nodeNext;t(n),n=s}this.unlock(!0)},t.prototype.eachShape=function(t){this.lock(),this.activeShapes.each(t),this.staticShapes.each(t),this.unlock(!0)},t.prototype.eachConstraint=function(t){this.lock();for(var e=this.constraints,i=0;i<e.length;i++)t(e[i]);this.unlock(!0)},t.prototype.reindexStatic=function(){c(!this.locked,"You cannot manually reindex objects while the space is locked. Wait until the current query or step is complete."),this.staticShapes.each(function(t){var e=t.body;t.update(e.p,e.rot)}),this.staticShapes.reindex()},t.prototype.reindexShape=function(t){c(!this.locked,"You cannot manually reindex objects while the space is locked. Wait until the current query or step is complete.");var e=t.body;t.update(e.p,e.rot),this.activeShapes.reindexObject(t,t.hashid),this.staticShapes.reindexObject(t,t.hashid)},t.prototype.reindexShapesForBody=function(t){for(t=t.shapeList;t;t=t.next)this.reindexShape(t)},t.prototype.useSpatialHash=function(t,e){throw Error("Spatial Hash not implemented.")},t.prototype.activateBody=function(t){if(c(!t.isRogue(),"Internal error: Attempting to activate a rogue body."),this.locked)-1===this.rousedBodies.indexOf(t)&&this.rousedBodies.push(t);else{this.bodies.push(t);for(var e,i=0;i<t.shapeList.length;i++){var n=t.shapeList[i];this.staticShapes.remove(n,n.hashid),this.activeShapes.insert(n,n.hashid)}for(i=t.arbiterList;i;i=i.next(t))t!==(n=i.body_a)&&!n.isStatic()||(n=i.a,e=i.b,(this.cachedArbiters[_(n.hashid,e.hashid)]=i).stamp=this.stamp,i.handler=this.lookupHandler(n.collision_type,e.collision_type),this.arbiters.push(i));for(i=t.constraintList;i;i=i.nodeNext)t!==(n=i.a)&&!n.isStatic()||this.constraints.push(i)}},t.prototype.deactivateBody=function(t){c(!t.isRogue(),"Internal error: Attempting to deactivate a rogue body."),s(this.bodies,t);for(var e=0;e<t.shapeList.length;e++){var i=t.shapeList[e];this.activeShapes.remove(i,i.hashid),this.staticShapes.insert(i,i.hashid)}for(i=t.arbiterList;i;i=i.next(t))t!==(e=i.body_a)&&!e.isStatic()||this.uncacheArbiter(i);for(i=t.constraintList;i;i=i.nodeNext)t!==(e=i.a)&&!e.isStatic()||s(this.constraints,i)},L.prototype.activate=function(){if(!this.isRogue()){this.nodeIdleTime=0;var t=this?this.nodeRoot:null;if(t&&t.isSleeping(t)){c(!t.isRogue(),"Internal Error: componentActivate() called on a rogue body.");for(var e=t.space,i=t;i;){var n=i.nodeNext;i.nodeIdleTime=0,i.nodeRoot=null,i.nodeNext=null,e.activateBody(i),i=n}s(e.sleepingComponents,t)}}},L.prototype.activateStatic=function(t){c(this.isStatic(),"Body.activateStatic() called on a non-static body.");for(var e=this.arbiterList;e;e=e.next(this))t&&t!=e.a&&t!=e.b||(e.body_a==this?e.body_b:e.body_a).activate()},L.prototype.pushArbiter=function(t){h(null===(t.body_a===this?t.thread_a_next:t.thread_b_next),"Internal Error: Dangling contact graph pointers detected. (A)"),h(null===(t.body_a===this?t.thread_a_prev:t.thread_b_prev),"Internal Error: Dangling contact graph pointers detected. (B)");var e=this.arbiterList;h(null===e||null===(e.body_a===this?e.thread_a_prev:e.thread_b_prev),"Internal Error: Dangling contact graph pointers detected. (C)"),t.body_a===this?t.thread_a_next=e:t.thread_b_next=e,e&&(e.body_a===this?e.thread_a_prev=t:e.thread_b_prev=t),this.arbiterList=t},t.prototype.processComponents=function(t){for(var e=1/0!==this.sleepTimeThreshold,i=this.bodies,n=0;n<i.length;n++){var s=i[n];h(null===s.nodeNext,"Internal Error: Dangling next pointer detected in contact graph."),h(null===s.nodeRoot,"Internal Error: Dangling root pointer detected in contact graph.")}if(e)for(var r=(n=this.idleSpeedThreshold)?n*n:x(this.gravity)*t*t,n=0;n<i.length;n++){var s=i[n],o=r?s.m*r:0;s.nodeIdleTime=s.kineticEnergy()>o?0:s.nodeIdleTime+t}for(n=0,o=(r=this.arbiters).length;n<o;n++){var a=r[n],s=a.body_a;t=a.body_b,e&&((t.isRogue()&&!t.isStatic()||s.isSleeping())&&s.activate(),s.isRogue()&&!s.isStatic()||t.isSleeping())&&t.activate(),s.pushArbiter(a),t.pushArbiter(a)}if(e){for(e=this.constraints,n=0;n<e.length;n++)s=(t=e[n]).a,(t=t.b).isRogue()&&!t.isStatic()&&s.activate(),s.isRogue()&&!s.isStatic()&&t.activate();for(n=0;n<i.length;){if(null===((s=i[n])?s.nodeRoot:null)){dt(s,s);t:{for(e=s;e;e=e.nodeNext)if(e.nodeIdleTime<this.sleepTimeThreshold){e=!0;break t}e=!1}if(!e){for(this.sleepingComponents.push(s),e=s;e;e=e.nodeNext)this.deactivateBody(e);continue}}n++,s.nodeRoot=null,s.nodeNext=null}}},L.prototype.sleep=function(){this.sleepWithGroup(null)},L.prototype.sleepWithGroup=function(t){c(!this.isStatic()&&!this.isRogue(),"Rogue and static bodies cannot be put to sleep.");var e=this.space;if(c(e,"Cannot put a rogue body to sleep."),c(!e.locked,"Bodies cannot be put to sleep during a query or a call to cpSpaceStep(). Put these calls into a post-step callback."),c(null===t||t.isSleeping(),"Cannot use a non-sleeping body as a group identifier."),this.isSleeping())c((this?this.nodeRoot:null)===(t?t.nodeRoot:null),"The body is already sleeping and it's group cannot be reassigned.");else{for(var i=0;i<this.shapeList.length;i++)this.shapeList[i].update(this.p,this.rot);e.deactivateBody(this),t?(this.nodeRoot=t=t?t.nodeRoot:null,this.nodeNext=t.nodeNext,this.nodeIdleTime=0,t.nodeNext=this):((this.nodeRoot=this).nodeNext=null,this.nodeIdleTime=0,e.sleepingComponents.push(this)),s(e.bodies,this)}},t.prototype.activateShapesTouchingShape=function(t){1/0!==this.sleepTimeThreshold&&this.shapeQuery(t,function(t,e){t.body.activate()})},t.prototype.pointQuery=function(e,i,n,s){function t(t){(!t.group||n!==t.group)&&i&t.layers&&t.pointQuery(e)&&s(t)}var r=new Dt(e.x,e.y,e.x,e.y);this.lock(),this.activeShapes.query(r,t),this.staticShapes.query(r,t),this.unlock(!0)},t.prototype.pointQueryFirst=function(t,e,i){var n=null;return this.pointQuery(t,e,i,function(t){t.sensor||(n=t)}),n},t.prototype.nearestPointQuery=function(i,n,s,r,o){function t(t){var e;(!t.group||r!==t.group)&&s&t.layers&&(e=t.nearestPointQuery(i)).d<n&&o(t,e.d,e.p)}var e=k(i,n);this.lock(),this.activeShapes.query(e,t),this.staticShapes.query(e,t),this.unlock(!0)},t.prototype.nearestPointQueryNearest=function(e,i,n,s){function t(t){t.group&&s===t.group||!(n&t.layers)||t.sensor||(t=t.nearestPointQuery(e)).d<i&&(!r||t.d<r.d)&&(r=t)}var r,o=k(e,i);return this.activeShapes.query(o,t),this.staticShapes.query(o,t),r},o.SHAPE_FILTER_ALL={group:o.NO_GROUP,categories:o.ALL_CATEGORIES,mask:o.ALL_CATEGORIES},t.prototype.pointQueryNearest=function(t,e,i){return void 0!==(t=this.nearestPointQueryNearest(t,e,i.mask,i.group))&&(t.distance=t.d,t.point=t.p),t},t.prototype.segmentQuery=function(i,n,s,r,o){function t(t){var e;return(!t.group||r!==t.group)&&s&t.layers&&(e=t.segmentQuery(i,n))&&o(t,e.t,e.n),1}this.lock(),this.staticShapes.segmentQuery(i,n,1,t),this.activeShapes.segmentQuery(i,n,1,t),this.unlock(!0)},t.prototype.segmentQueryFirst=function(e,i,n,s){function t(t){return(r=(!t.group||s!==t.group)&&n&t.layers&&!t.sensor&&(t=t.segmentQuery(e,i))&&(null===r||t.t<r.t)?t:r)?r.t:1}var r=null;return this.staticShapes.segmentQuery(e,i,1,t),this.activeShapes.segmentQuery(e,i,r?r.t:1,t),r&&"null"!==r&&"undefined"!==r&&(r.normal=r.n,r.alpha=r.t,r.p=r.point=o.v.lerp(e,i,r.t)),r},t.prototype.bbQuery=function(e,i,n,s){function t(t){(!t.group||n!==t.group)&&i&t.layers&&e.l<=t.bb_r&&t.bb_l<=e.r&&e.b<=t.bb_t&&t.bb_b<=e.t&&s(t)}this.lock(),this.activeShapes.query(e,t),this.staticShapes.query(e,t),this.unlock(!0)},t.prototype.shapeQuery=function(s,r){function t(t){if((!s.group||s.group!==t.group)&&s.layers&t.layers&&s!==t){if(s.collisionCode<=t.collisionCode)e=Vt(s,t);else for(var e=Vt(t,s),i=0;i<e.length;i++)e[i].n=I(e[i].n);if(e.length&&(o=!(s.sensor||t.sensor),r)){for(var n=Array(e.length),i=0;i<e.length;i++)n[i]=new ot(e[i].p,e[i].n,e[i].dist);r(t,n)}}}(e=s.body)&&s.update(e.p,e.rot);var e=new Dt(s.bb_l,s.bb_b,s.bb_r,s.bb_t),o=!1;return this.lock(),this.activeShapes.query(e,t),this.staticShapes.query(e,t),this.unlock(!0),o},t.prototype.addPostStepCallback=function(t){h(this.locked,"Adding a post-step callback when the space is not locked is unnecessary. Post-step callbacks will not called until the end of the next call to cpSpaceStep() or the next query."),this.postStepCallbacks.push(t)},t.prototype.runPostStepCallbacks=function(){for(var t=0;t<this.postStepCallbacks.length;t++)this.postStepCallbacks[t]();this.postStepCallbacks=[]},t.prototype.lock=function(){this.locked++},t.prototype.unlock=function(t){if(this.locked--,c(0<=this.locked,"Internal Error: Space lock underflow."),0===this.locked&&t){t=this.rousedBodies;for(var e=0;e<t.length;e++)this.activateBody(t[e]);t.length=0,this.runPostStepCallbacks()}},t.prototype.makeCollideShapes=function(){var a=this;return function(t,e){var i,n,s,r,o;t.bb_l<=e.bb_r&&e.bb_l<=t.bb_r&&t.bb_b<=e.bb_t&&e.bb_b<=t.bb_t&&t.body!==e.body&&(!t.group||t.group!==e.group)&&t.layers&e.layers&&(i=a.lookupHandler(t.collision_type,e.collision_type),(n=t.sensor||e.sensor)&&i===Ut||(t.collisionCode>e.collisionCode&&(s=t,t=e,e=s),0!==(s=Vt(t,e)).length&&(r=_(t.hashid,e.hashid),(o=(o=a.cachedArbiters[r])||(a.cachedArbiters[r]=new l(t,e))).update(s,i,t,e),"first coll"!=o.state||i.begin(o,a)||o.ignore(),"ignore"!==o.state&&i.preSolve(o,a)&&!n?a.arbiters.push(o):(o.contacts=null,"ignore"!==o.state&&(o.state="normal")),o.stamp=a.stamp)))}},t.prototype.arbiterSetFilter=function(t){var e=this.stamp-t.stamp,i=t.body_a,n=t.body_b;return!((!i.isStatic()&&!i.isSleeping()||!n.isStatic()&&!n.isSleeping())&&(1<=e&&"cached"!=t.state&&(t.callSeparate(this),t.state="cached"),e>=this.collisionPersistence)&&(t.contacts=null,1))},t.prototype.step=function(t){if(0!==t){c(0===T.x&&0===T.y,"vzero is invalid"),this.stamp++;var e=this.curr_dt;this.curr_dt=t;for(var i,n=this.bodies,s=this.constraints,r=this.arbiters,o=0;o<r.length;o++){var a=r[o];a.state="normal",a.body_a.isSleeping()||a.body_b.isSleeping()||a.unthread()}for(r.length=0,this.lock(),o=0;o<n.length;o++)n[o].position_func(t);for(i in this.activeShapes.each(_t),this.activeShapes.reindexQuery(this.collideShapes),this.unlock(!1),this.processComponents(t),this.lock(),this.cachedArbiters)this.arbiterSetFilter(this.cachedArbiters[i])||delete this.cachedArbiters[i];for(i=this.collisionSlop,a=1-Math.pow(this.collisionBias,t),o=0;o<r.length;o++)r[o].preStep(t,i,a);for(o=0;o<s.length;o++)(i=s[o]).preSolve(this),i.preStep(t);for(i=Math.pow(this.damping,t),a=this.gravity,o=0;o<n.length;o++)n[o].velocity_func(a,i,t);for(t=0===e?0:t/e,o=0;o<r.length;o++)r[o].applyCachedImpulse(t);for(o=0;o<s.length;o++)s[o].applyCachedImpulse(t);for(o=0;o<this.iterations;o++){for(t=0;t<r.length;t++)r[t].applyImpulse();for(t=0;t<s.length;t++)s[t].applyImpulse()}for(o=0;o<s.length;o++)s[o].postSolve(this);for(o=0;o<r.length;o++)r[o].handler.postSolve(r[o],this);this.unlock(!0)}},function(t,e,i,n,s){return(e.vx+-n.y*e.w-(t.vx+-i.y*t.w))*s.x+(e.vy+n.x*e.w-(t.vy+i.x*t.w))*s.y}),Jt=function(t,e,i,n){t.vx+=e*t.m_inv,t.vy+=i*t.m_inv,t.w+=t.i_inv*(n.x*i-n.y*e)},w=function(t,e,i,n,s,r){Jt(t,-s,-r,i),Jt(e,s,r,n)},zt=function(t,e,i,n){t.v_biasx+=e*t.m_inv,t.v_biasy+=i*t.m_inv,t.w_bias+=t.i_inv*(n.x*i-n.y*e)},Xt=function(t,e,i,n,s){return t=ft(t,i,s)+ft(e,n,s),h(0!==t,"Unsolvable collision or constraint."),t},N=o.Constraint=function(t,e){this.a=t,this.b=e,this.next_b=this.next_a=this.space=null,this.maxForce=1/0,this.errorBias=Math.pow(.9,60),this.maxBias=1/0},e=(N.prototype.activateBodies=function(){this.a&&this.a.activate(),this.b&&this.b.activate()},N.prototype.preStep=function(t){},N.prototype.applyCachedImpulse=function(t){},N.prototype.applyImpulse=function(){},N.prototype.getImpulse=function(){return 0},N.prototype.preSolve=function(t){},N.prototype.postSolve=function(t){},N.prototype.next=function(t){return this.a===t?this.next_a:this.next_b},o.PinJoint=function(t,e,i,n){N.call(this,t,e),this.anchr1=i,this.anchr2=n,t=t?C(t.p,F(i,t.rot)):i,e=e?C(e.p,F(n,e.rot)):n,this.dist=d(E(e,t)),h(0<this.dist,"You created a 0 length pin joint. A pivot joint will be much more stable."),this.n=this.r1=this.r2=null,this.bias=this.jnAcc=this.jnMax=this.nMass=0}),t=((e.prototype=Object.create(N.prototype)).preStep=function(t){var e=this.a,i=this.b,n=(this.r1=F(this.anchr1,e.rot),this.r2=F(this.anchr2,i.rot),E(C(i.p,this.r2),C(e.p,this.r1))),s=d(n);this.n=v(n,1/(s||1/0)),this.nMass=1/Xt(e,i,this.r1,this.r2,this.n),e=this.maxBias,this.bias=p(-(1-Math.pow(this.errorBias,t))*(s-this.dist)/t,-e,e),this.jnMax=this.maxForce*t},e.prototype.applyCachedImpulse=function(t){t=v(this.n,this.jnAcc*t),w(this.a,this.b,this.r1,this.r2,t.x,t.y)},e.prototype.applyImpulse=function(){var t=this.a,e=this.b,i=this.n,n=Wt(t,e,this.r1,this.r2,i),n=(this.bias-n)*this.nMass,s=this.jnAcc;this.jnAcc=p(s+n,-this.jnMax,this.jnMax),n=this.jnAcc-s,w(t,e,this.r1,this.r2,i.x*n,i.y*n)},e.prototype.getImpulse=function(){return Math.abs(this.jnAcc)},o.SlideJoint=function(t,e,i,n,s,r){N.call(this,t,e),this.anchr1=i,this.anchr2=n,this.min=s,this.max=r,this.r1=this.r2=this.n=null,this.bias=this.jnAcc=this.jnMax=this.nMass=0}),e=((t.prototype=Object.create(N.prototype)).preStep=function(t){var e=this.a,i=this.b,n=(this.r1=F(this.anchr1,e.rot),this.r2=F(this.anchr2,i.rot),E(C(i.p,this.r2),C(e.p,this.r1))),s=d(n),r=0;s>this.max?(r=s-this.max,this.n=xt(n)):s<this.min?(r=this.min-s,this.n=I(xt(n))):(this.n=T,this.jnAcc=0),this.nMass=1/Xt(e,i,this.r1,this.r2,this.n),e=this.maxBias,this.bias=p(-(1-Math.pow(this.errorBias,t))*r/t,-e,e),this.jnMax=this.maxForce*t},t.prototype.applyCachedImpulse=function(t){t*=this.jnAcc,w(this.a,this.b,this.r1,this.r2,this.n.x*t,this.n.y*t)},t.prototype.applyImpulse=function(){var t,e,i,n,s;0===this.n.x&&0===this.n.y||(t=this.a,e=this.b,i=this.n,n=pt(t,e,this.r1,this.r2),n=S(n,i),n=(this.bias-n)*this.nMass,s=this.jnAcc,this.jnAcc=p(s+n,-this.jnMax,0),n=this.jnAcc-s,w(t,e,this.r1,this.r2,i.x*n,i.y*n))},t.prototype.getImpulse=function(){return Math.abs(this.jnAcc)},o.PivotJoint=function(t,e,i,n){N.call(this,t,e),void 0===n&&(n=i,i=t?t.world2Local(n):n,n=e?e.world2Local(n):n),this.anchr1=i,this.anchr2=n,this.r1=this.r2=T,this.k1=new y(0,0),this.k2=new y(0,0),this.jAcc=T,this.jMaxLen=0,this.bias=T}),t=((e.prototype=Object.create(N.prototype)).preStep=function(t){var e=this.a,i=this.b;this.r1=F(this.anchr1,e.rot),this.r2=F(this.anchr2,i.rot),gt(e,i,this.r1,this.r2,this.k1,this.k2),this.jMaxLen=this.maxForce*t,e=E(C(i.p,this.r2),C(e.p,this.r1)),this.bias=Pt(v(e,-(1-Math.pow(this.errorBias,t))/t),this.maxBias)},e.prototype.applyCachedImpulse=function(t){w(this.a,this.b,this.r1,this.r2,this.jAcc.x*t,this.jAcc.y*t)},e.prototype.applyImpulse=function(){var t=this.a,e=this.b,i=pt(t,e,this.r1,this.r2),i=E(this.bias,i),n=this.k2,i=new y(S(i,this.k1),S(i,n)),n=this.jAcc;this.jAcc=Pt(C(this.jAcc,i),this.jMaxLen),w(t,e,this.r1,this.r2,this.jAcc.x-n.x,this.jAcc.y-n.y)},e.prototype.getImpulse=function(){return d(this.jAcc)},o.GrooveJoint=function(t,e,i,n,s){N.call(this,t,e),this.grv_a=i,this.grv_b=n,this.grv_n=A(P(E(n,i))),this.anchr2=s,this.grv_tn=null,this.clamp=0,this.r1=this.r2=null,this.k1=new y(0,0),this.k2=new y(0,0),this.jAcc=T,this.jMaxLen=0,this.bias=null}),e=((t.prototype=Object.create(N.prototype)).preStep=function(t){var e=this.a,i=this.b,n=e.local2World(this.grv_a),s=e.local2World(this.grv_b),r=F(this.grv_n,e.rot),o=S(n,r),a=(this.grv_tn=r,this.r2=F(this.anchr2,i.rot),b(C(i.p,this.r2),r));a<=b(n,r)?(this.clamp=1,this.r1=E(n,e.p)):a>=b(s,r)?(this.clamp=-1,this.r1=E(s,e.p)):(this.clamp=0,this.r1=E(C(v(A(r),-a),v(r,o)),e.p)),gt(e,i,this.r1,this.r2,this.k1,this.k2),this.jMaxLen=this.maxForce*t,e=E(C(i.p,this.r2),C(e.p,this.r1)),this.bias=Pt(v(e,-(1-Math.pow(this.errorBias,t))/t),this.maxBias)},t.prototype.applyCachedImpulse=function(t){w(this.a,this.b,this.r1,this.r2,this.jAcc.x*t,this.jAcc.y*t)},t.prototype.grooveConstrain=function(t){var e=this.grv_tn;return t=0<this.clamp*b(t,e)?t:vt(t,e),Pt(t,this.jMaxLen)},t.prototype.applyImpulse=function(){var t=this.a,e=this.b,i=pt(t,e,this.r1,this.r2),i=E(this.bias,i),n=this.k2,i=new y(S(i,this.k1),S(i,n)),n=this.jAcc;this.jAcc=this.grooveConstrain(C(n,i)),w(t,e,this.r1,this.r2,this.jAcc.x-n.x,this.jAcc.y-n.y)},t.prototype.getImpulse=function(){return d(this.jAcc)},t.prototype.setGrooveA=function(t){this.grv_a=t,this.grv_n=A(P(E(this.grv_b,t))),this.activateBodies()},t.prototype.setGrooveB=function(t){this.grv_b=t,this.grv_n=A(P(E(t,this.grv_a))),this.activateBodies()},o.DampedSpring=function(t,e,i,n,s,r,o){N.call(this,t,e),this.anchr1=i,this.anchr2=n,this.restLength=s,this.stiffness=r,this.damping=o,this.springForceFunc=mt,this.target_vrn=this.v_coef=0,this.r1=this.r2=null,this.nMass=0,this.n=null}),t=((e.prototype=Object.create(N.prototype)).preStep=function(t){var e=this.a,i=this.b,n=(this.r1=F(this.anchr1,e.rot),this.r2=F(this.anchr2,i.rot),E(C(i.p,this.r2),C(e.p,this.r1))),s=d(n);this.n=v(n,1/(s||1/0)),n=Xt(e,i,this.r1,this.r2,this.n),h(0!==n,"Unsolvable this."),this.nMass=1/n,this.target_vrn=0,this.v_coef=1-Math.exp(-this.damping*t*n),s=this.springForceFunc(this,s),w(e,i,this.r1,this.r2,this.n.x*s*t,this.n.y*s*t)},e.prototype.applyCachedImpulse=function(t){},e.prototype.applyImpulse=function(){var t=this.a,e=this.b,i=Wt(t,e,this.r1,this.r2,this.n),n=(this.target_vrn-i)*this.v_coef;this.target_vrn=i+n,n*=this.nMass,w(t,e,this.r1,this.r2,this.n.x*n,this.n.y*n)},e.prototype.getImpulse=function(){return 0},o.DampedRotarySpring=function(t,e,i,n,s){N.call(this,t,e),this.restAngle=i,this.stiffness=n,this.damping=s,this.springTorqueFunc=yt,this.iSum=this.w_coef=this.target_wrn=0}),e=((t.prototype=Object.create(N.prototype)).preStep=function(t){var e=this.a,i=this.b,n=e.i_inv+i.i_inv;h(0!==n,"Unsolvable spring."),this.iSum=1/n,this.w_coef=1-Math.exp(-this.damping*t*n),this.target_wrn=0,t*=this.springTorqueFunc(this,e.a-i.a),e.w-=t*e.i_inv,i.w+=t*i.i_inv},t.prototype.applyImpulse=function(){var t=this.a,e=this.b,i=t.w-e.w,n=(this.target_wrn-i)*this.w_coef;this.target_wrn=i+n,i=n*this.iSum,t.w+=i*t.i_inv,e.w-=i*e.i_inv},o.RotaryLimitJoint=function(t,e,i,n){N.call(this,t,e),this.min=i,this.max=n,this.iSum=this.bias=this.jMax=this.jAcc=0}),t=((e.prototype=Object.create(N.prototype)).preStep=function(t){var e=this.a,i=this.b,n=i.a-e.a,s=0;n>this.max?s=this.max-n:n<this.min&&(s=this.min-n),this.iSum=1/(1/e.i+1/i.i),e=this.maxBias,this.bias=p(-(1-Math.pow(this.errorBias,t))*s/t,-e,e),this.jMax=this.maxForce*t,this.bias||(this.jAcc=0)},e.prototype.applyCachedImpulse=function(t){var e=this.a,i=this.b;t*=this.jAcc,e.w-=t*e.i_inv,i.w+=t*i.i_inv},e.prototype.applyImpulse=function(){var t,e,i,n;this.bias&&(t=this.a,e=this.b,i=-(this.bias+(e.w-t.w))*this.iSum,n=this.jAcc,this.jAcc=this.bias<0?p(n+i,0,this.jMax):p(n+i,-this.jMax,0),i=this.jAcc-n,t.w-=i*t.i_inv,e.w+=i*e.i_inv)},e.prototype.getImpulse=function(){return Math.abs(joint.jAcc)},o.RatchetJoint=function(t,e,i,n){N.call(this,t,e),this.angle=0,this.phase=i,this.ratchet=n,this.angle=(e?e.a:0)-(t?t.a:0),this.iSum=this.bias=this.jAcc=this.jMax=0}),e=((t.prototype=Object.create(N.prototype)).preStep=function(t){var e=this.a,i=this.b,n=this.phase,s=this.ratchet,r=i.a-e.a,o=this.angle-r,a=0;0<o*s?a=o:this.angle=Math.floor((r-n)/s)*s+n,this.iSum=1/(e.i_inv+i.i_inv),e=this.maxBias,this.bias=p(-(1-Math.pow(this.errorBias,t))*a/t,-e,e),this.jMax=this.maxForce*t,this.bias||(this.jAcc=0)},t.prototype.applyCachedImpulse=function(t){var e=this.a,i=this.b;t*=this.jAcc,e.w-=t*e.i_inv,i.w+=t*i.i_inv},t.prototype.applyImpulse=function(){var t,e,i,n,s;this.bias&&(t=this.a,e=this.b,i=this.ratchet,n=-(this.bias+(e.w-t.w))*this.iSum,s=this.jAcc,this.jAcc=p((s+n)*i,0,this.jMax*Math.abs(i))/i,n=this.jAcc-s,t.w-=n*t.i_inv,e.w+=n*e.i_inv)},t.prototype.getImpulse=function(t){return Math.abs(t.jAcc)},o.GearJoint=function(t,e,i,n){N.call(this,t,e),this.phase=i,this.ratio=n,this.ratio_inv=1/n,this.iSum=this.bias=this.jMax=this.jAcc=0}),t=((e.prototype=Object.create(N.prototype)).preStep=function(t){var e=this.a,i=this.b,n=(this.iSum=1/(e.i_inv*this.ratio_inv+this.ratio*i.i_inv),this.maxBias);this.bias=p(-(1-Math.pow(this.errorBias,t))*(i.a*this.ratio-e.a-this.phase)/t,-n,n),this.jMax=this.maxForce*t},e.prototype.applyCachedImpulse=function(t){var e=this.a,i=this.b;t*=this.jAcc,e.w-=t*e.i_inv*this.ratio_inv,i.w+=t*i.i_inv},e.prototype.applyImpulse=function(){var t=this.a,e=this.b,i=(this.bias-(e.w*this.ratio-t.w))*this.iSum,n=this.jAcc;this.jAcc=p(n+i,-this.jMax,this.jMax),i=this.jAcc-n,t.w-=i*t.i_inv*this.ratio_inv,e.w+=i*e.i_inv},e.prototype.getImpulse=function(){return Math.abs(this.jAcc)},e.prototype.setRatio=function(t){this.ratio=t,this.ratio_inv=1/t,this.activateBodies()},o.SimpleMotor=function(t,e,i){N.call(this,t,e),this.rate=i,this.iSum=this.jMax=this.jAcc=0});(t.prototype=Object.create(N.prototype)).preStep=function(t){this.iSum=1/(this.a.i_inv+this.b.i_inv),this.jMax=this.maxForce*t},t.prototype.applyCachedImpulse=function(t){var e=this.a,i=this.b;t*=this.jAcc,e.w-=t*e.i_inv,i.w+=t*i.i_inv},t.prototype.applyImpulse=function(){var t=this.a,e=this.b,i=-(e.w-t.w+this.rate)*this.iSum,n=this.jAcc;this.jAcc=p(n+i,-this.jMax,this.jMax),i=this.jAcc-n,t.w-=i*t.i_inv,e.w+=i*e.i_inv},t.prototype.getImpulse=function(){return Math.abs(this.jAcc)}}(),cc.CONTROL_EVENT_TOTAL_NUMBER=9,cc.CONTROL_EVENT_TOUCH_DOWN=1,cc.CONTROL_EVENT_TOUCH_DRAG_INSIDE=2,cc.CONTROL_EVENT_TOUCH_DRAG_OUTSIDE=4,cc.CONTROL_EVENT_TOUCH_DRAG_ENTER=8,cc.CONTROL_EVENT_TOUCH_DRAG_EXIT=16,cc.CONTROL_EVENT_TOUCH_UP_INSIDE=32,cc.CONTROL_EVENT_TOUCH_UP_OUTSIDE=64,cc.CONTROL_EVENT_TOUCH_CANCEL=128,cc.CONTROL_EVENT_VALUECHANGED=256,cc.CONTROL_STATE_NORMAL=1,cc.CONTROL_STATE_HIGHLIGHTED=2,cc.CONTROL_STATE_DISABLED=4,cc.CONTROL_STATE_SELECTED=8,cc.CONTROL_STATE_INITIAL=8,cc.Control=cc.Layer.extend({_isOpacityModifyRGB:!1,_hasVisibleParents:!1,_touchListener:null,_className:"Control",isOpacityModifyRGB:function(){return this._isOpacityModifyRGB},setOpacityModifyRGB:function(t){this._isOpacityModifyRGB=t;for(var e=this.getChildren(),i=0,n=e.length;i<n;i++){var s=e[i];s&&s.setOpacityModifyRGB(t)}},_state:cc.CONTROL_STATE_NORMAL,getState:function(){return this._state},_enabled:!1,_selected:!1,_highlighted:!1,_dispatchTable:null,setEnabled:function(t){this._state=(this._enabled=t)?cc.CONTROL_STATE_NORMAL:cc.CONTROL_STATE_DISABLED,this.needsLayout()},isEnabled:function(){return this._enabled},setSelected:function(t){this._selected=t,this.needsLayout()},isSelected:function(){return this._selected},setHighlighted:function(t){this._highlighted=t,this.needsLayout()},isHighlighted:function(){return this._highlighted},hasVisibleParents:function(){for(var t=this.getParent();null!=t;t=t.getParent())if(!t.isVisible())return!1;return!0},ctor:function(){cc.Layer.prototype.ctor.call(this),this._dispatchTable={},this._color=cc.color.WHITE},init:function(){this._state=cc.CONTROL_STATE_NORMAL,this._enabled=!0,this._highlighted=this._selected=!1;var t=cc.EventListener.create({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0});return this.onTouchBegan&&(t.onTouchBegan=this.onTouchBegan.bind(this)),this.onTouchMoved&&(t.onTouchMoved=this.onTouchMoved.bind(this)),this.onTouchEnded&&(t.onTouchEnded=this.onTouchEnded.bind(this)),this.onTouchCancelled&&(t.onTouchCancelled=this.onTouchCancelled.bind(this)),this._touchListener=t,!0},onEnter:function(){var t=this._touchListener;t._isRegistered()||cc.eventManager.addListener(t,this),cc.Node.prototype.onEnter.call(this)},sendActionsForControlEvents:function(t){for(var e=0,i=cc.CONTROL_EVENT_TOTAL_NUMBER;e<i;e++)if(t&1<<e)for(var n=this._dispatchListforControlEvent(1<<e),s=0,r=n.length;s<r;s++)n[s].invoke(this)},addTargetWithActionForControlEvents:function(t,e,i){for(var n=0,s=cc.CONTROL_EVENT_TOTAL_NUMBER;n<s;n++)i&1<<n&&this._addTargetWithActionForControlEvent(t,e,1<<n)},removeTargetWithActionForControlEvents:function(t,e,i){for(var n=0,s=cc.CONTROL_EVENT_TOTAL_NUMBER;n<s;n++)i&1<<n&&this._removeTargetWithActionForControlEvent(t,e,1<<n)},getTouchLocation:function(t){return t=t.getLocation(),this.convertToNodeSpace(t)},isTouchInside:function(t){return t=t.getLocation(),t=this.getParent().convertToNodeSpace(t),cc.rectContainsPoint(this.getBoundingBox(),t)},_invocationWithTargetAndActionForControlEvent:function(t,e,i){return null},_dispatchListforControlEvent:function(t){return t=t.toString(),this._dispatchTable[t]||(this._dispatchTable[t]=[]),this._dispatchTable[t]},_addTargetWithActionForControlEvent:function(t,e,i){t=new cc.Invocation(t,e,i),this._dispatchListforControlEvent(i).push(t)},_removeTargetWithActionForControlEvent:function(t,e,i){if(i=this._dispatchListforControlEvent(i),t||e)for(var n=0;n<i.length;){var s=i[n],r=!0;t&&(r=t===s.getTarget()),(r=e?r&&e===s.getAction():r)?cc.arrayRemoveObject(i,s):n++}else i.length=0},needsLayout:function(){}}),_p=cc.Control.prototype,cc.defineGetterSetter(_p,"state",_p.getState),cc.defineGetterSetter(_p,"enabled",_p.isEnabled,_p.setEnabled),cc.defineGetterSetter(_p,"selected",_p.isSelected,_p.setSelected),cc.defineGetterSetter(_p,"highlighted",_p.isHighlighted,_p.setHighlighted),_p=null,cc.Control.create=function(){var t=new cc.Control;return t&&t.init()?t:null},cc.CONTROL_ZOOM_ACTION_TAG=3435855873,cc.ControlButton=cc.Control.extend({_doesAdjustBackgroundImage:!1,zoomOnTouchDown:!1,_preferredSize:null,_labelAnchorPoint:null,_currentTitle:null,_currentTitleColor:null,_titleLabel:null,_backgroundSprite:null,_opacity:0,_isPushed:!1,_titleDispatchTable:null,_titleColorDispatchTable:null,_titleLabelDispatchTable:null,_backgroundSpriteDispatchTable:null,_parentInited:!1,_marginV:0,_marginH:0,_className:"ControlButton",ctor:function(t,e,i){cc.Control.prototype.ctor.call(this),this._preferredSize=cc.size(0,0),this._labelAnchorPoint=cc.p(0,0),this._currentTitle="",this._currentTitleColor=cc.color.WHITE,this._titleDispatchTable={},this._titleColorDispatchTable={},this._titleLabelDispatchTable={},this._backgroundSpriteDispatchTable={},null!=i?this.initWithTitleAndFontNameAndFontSize(t,e,i):null!=e?this.initWithLabelAndBackgroundSprite(t,e):null!=t?this.initWithBackgroundSprite(t):this.init()},init:function(){return this.initWithLabelAndBackgroundSprite(new cc.LabelTTF("","Arial",12),new cc.Scale9Sprite)},needsLayout:function(){var t,e,i,n;this._parentInited&&(this._titleLabel&&this._titleLabel.setVisible(!1),this._backgroundSprite&&this._backgroundSprite.setVisible(!1),this.setLabelAnchorPoint(this._labelAnchorPoint),t=this._state,this._currentTitle=this.getTitleForState(t),this._currentTitleColor=this.getTitleColorForState(t),(e=this._titleLabel=this.getTitleLabelForState(t))&&e.setString&&e.setString(this._currentTitle),e&&e.setColor(this._currentTitleColor),i=this.getContentSize(),e&&e.setPosition(i.width/2,i.height/2),(t=this._backgroundSprite=this.getBackgroundSpriteForState(t))&&t.setPosition(i.width/2,i.height/2),i=cc.size(0,0),e&&(n=e.getBoundingBox(),i.width=n.width,i.height=n.height),this._doesAdjustBackgroundImage?t&&t.setContentSize(i.width+2*this._marginH,i.height+2*this._marginV):t&&(n=t.getPreferredSize(),(n=cc.size(n.width,n.height)).width<=0&&(n.width=i.width),n.height<=0&&(n.height=i.height),t.setContentSize(n)),i=e?e.getBoundingBox():cc.rect(0,0,0,0),n=t?t.getBoundingBox():cc.rect(0,0,0,0),i=cc.rectUnion(i,n),this.setContentSize(i.width,i.height),i=this.getContentSize(),e&&(e.setPosition(i.width/2,i.height/2),e.setVisible(!0)),t)&&(t.setPosition(i.width/2,i.height/2),t.setVisible(!0))},initWithLabelAndBackgroundSprite:function(t,e){if(!t)throw Error("cc.ControlButton.initWithLabelAndBackgroundSprite(): label should be non-null");var i;if(e)return!!cc.Control.prototype.init.call(this,!0)&&(this._parentInited=!0,this._titleDispatchTable={},this._titleColorDispatchTable={},this._titleLabelDispatchTable={},this._backgroundSpriteDispatchTable={},this._isPushed=!1,this.zoomOnTouchDown=!0,this._currentTitle=null,this.setAdjustBackgroundImage(!0),this.setPreferredSize(cc.size(0,0)),this.zoomOnTouchDown=!0,this.ignoreAnchorPointForPosition(!1),this.setAnchorPoint(.5,.5),this._titleLabel=t,this._backgroundSprite=e,this.setOpacity(255),this.setOpacityModifyRGB(!0),i=t.getString(),this.setTitleForState(i,cc.CONTROL_STATE_NORMAL),this.setTitleColorForState(t.getColor(),cc.CONTROL_STATE_NORMAL),this.setTitleLabelForState(t,cc.CONTROL_STATE_NORMAL),this.setBackgroundSpriteForState(e,cc.CONTROL_STATE_NORMAL),this._state=cc.CONTROL_STATE_NORMAL,this._marginH=24,this._marginV=12,this._labelAnchorPoint=cc.p(.5,.5),this.setPreferredSize(cc.size(0,0)),this.needsLayout(),!0);throw Error("cc.ControlButton.initWithLabelAndBackgroundSprite(): backgroundSprite should be non-null")},initWithTitleAndFontNameAndFontSize:function(t,e,i){return t=new cc.LabelTTF(t,e,i),this.initWithLabelAndBackgroundSprite(t,new cc.Scale9Sprite)},initWithBackgroundSprite:function(t){var e=new cc.LabelTTF("","Arial",30);return this.initWithLabelAndBackgroundSprite(e,t)},doesAdjustBackgroundImage:function(){return this._doesAdjustBackgroundImage},setAdjustBackgroundImage:function(t){this._doesAdjustBackgroundImage=t,this.needsLayout()},getZoomOnTouchDown:function(){return this.zoomOnTouchDown},setZoomOnTouchDown:function(t){return this.zoomOnTouchDown=t},getPreferredSize:function(){return this._preferredSize},setPreferredSize:function(t){if(0===t.width&&0===t.height)this._doesAdjustBackgroundImage=!0;else{this._doesAdjustBackgroundImage=!1;var e,i=this._backgroundSpriteDispatchTable;for(e in i)i[e].setPreferredSize(t)}this._preferredSize=t,this.needsLayout()},getLabelAnchorPoint:function(){return this._labelAnchorPoint},setLabelAnchorPoint:function(t){this._labelAnchorPoint=t,this._titleLabel&&this._titleLabel.setAnchorPoint(t)},_getCurrentTitle:function(){return this._currentTitle},_getCurrentTitleColor:function(){return this._currentTitleColor},getOpacity:function(){return this._opacity},setOpacity:function(t){cc.Control.prototype.setOpacity.call(this,t);var e,i=this._backgroundSpriteDispatchTable;for(e in i)i[e].setOpacity(t)},setColor:function(t){cc.Control.prototype.setColor.call(this,t);var e,i=this._backgroundSpriteDispatchTable;for(e in i)i[e].setColor(t)},getColor:function(){var t=this._realColor;return cc.color(t.r,t.g,t.b,t.a)},isPushed:function(){return this._isPushed},_getVerticalMargin:function(){return this._marginV},_getHorizontalOrigin:function(){return this._marginH},setMargins:function(t,e){this._marginV=e,this._marginH=t,this.needsLayout()},setEnabled:function(t){cc.Control.prototype.setEnabled.call(this,t),this.needsLayout()},setSelected:function(t){cc.Control.prototype.setSelected.call(this,t),this.needsLayout()},setHighlighted:function(t){this._state=t?cc.CONTROL_STATE_HIGHLIGHTED:cc.CONTROL_STATE_NORMAL,cc.Control.prototype.setHighlighted.call(this,t),(t=this.getActionByTag(cc.CONTROL_ZOOM_ACTION_TAG))&&this.stopAction(t),this.zoomOnTouchDown&&(t=this.isHighlighted()&&this.isEnabled()&&!this.isSelected()?1.1:1,(t=cc.scaleTo(.05,t)).setTag(cc.CONTROL_ZOOM_ACTION_TAG),this.runAction(t))},onTouchBegan:function(t,e){return!!(this.isTouchInside(t)&&this.isEnabled()&&this.isVisible()&&this.hasVisibleParents())&&(this._isPushed=!0,this.setHighlighted(!0),this.sendActionsForControlEvents(cc.CONTROL_EVENT_TOUCH_DOWN),!0)},onTouchMoved:function(t,e){this._enabled&&this._isPushed&&!this._selected?(t=this.isTouchInside(t))&&!this._highlighted?(this.setHighlighted(!0),this.sendActionsForControlEvents(cc.CONTROL_EVENT_TOUCH_DRAG_ENTER)):t&&this._highlighted?this.sendActionsForControlEvents(cc.CONTROL_EVENT_TOUCH_DRAG_INSIDE):!t&&this._highlighted?(this.setHighlighted(!1),this.sendActionsForControlEvents(cc.CONTROL_EVENT_TOUCH_DRAG_EXIT)):t||this._highlighted||this.sendActionsForControlEvents(cc.CONTROL_EVENT_TOUCH_DRAG_OUTSIDE):this._highlighted&&this.setHighlighted(!1)},onTouchEnded:function(t,e){this._isPushed=!1,this.setHighlighted(!1),this.isTouchInside(t)?this.sendActionsForControlEvents(cc.CONTROL_EVENT_TOUCH_UP_INSIDE):this.sendActionsForControlEvents(cc.CONTROL_EVENT_TOUCH_UP_OUTSIDE)},onTouchCancelled:function(t,e){this._isPushed=!1,this.setHighlighted(!1),this.sendActionsForControlEvents(cc.CONTROL_EVENT_TOUCH_CANCEL)},getTitleForState:function(t){var e=this._titleDispatchTable;return e?e[t]||e[cc.CONTROL_STATE_NORMAL]:""},setTitleForState:function(t,e){this._titleDispatchTable[e]=t||"",this.getState()===e&&this.needsLayout()},getTitleColorForState:function(t){return(t=(t=this._titleColorDispatchTable[t])||this._titleColorDispatchTable[cc.CONTROL_STATE_NORMAL])||cc.color.WHITE},setTitleColorForState:function(t,e){this._titleColorDispatchTable[e]=t,this.getState()===e&&this.needsLayout()},getTitleLabelForState:function(t){var e=this._titleLabelDispatchTable;return e[t]||e[cc.CONTROL_STATE_NORMAL]},setTitleLabelForState:function(t,e){var i,n=this._titleLabelDispatchTable;n[e]&&(i=n[e])&&this.removeChild(i,!0),(n[e]=t).setVisible(!1),t.setAnchorPoint(.5,.5),this.addChild(t,1),this.getState()===e&&this.needsLayout()},setTitleTTFForState:function(t,e){var i=(i=this.getTitleForState(e))||"";this.setTitleLabelForState(new cc.LabelTTF(i,t,12),e)},getTitleTTFForState:function(t){return null!=(t=this.getTitleLabelForState(t))&&t instanceof cc.LabelTTF?t.getFontName():""},setTitleTTFSizeForState:function(t,e){e=this.getTitleLabelForState(e);null!=e&&e instanceof cc.LabelTTF&&e.setFontSize(t)},getTitleTTFSizeForState:function(t){return null!=(t=this.getTitleLabelForState(t))&&t instanceof cc.LabelTTF?t.getFontSize():0},setTitleBMFontForState:function(t,e){var i=(i=this.getTitleForState(e))||"";this.setTitleLabelForState(new cc.LabelBMFont(i,t),e)},getTitleBMFontForState:function(t){return null!=(t=this.getTitleLabelForState(t))&&t instanceof cc.LabelBMFont?t.getFntFile():""},getBackgroundSpriteForState:function(t){var e=this._backgroundSpriteDispatchTable;return e[t]||e[cc.CONTROL_STATE_NORMAL]},setBackgroundSpriteForState:function(t,e){var i,n=this._backgroundSpriteDispatchTable;n[e]&&(i=n[e])&&this.removeChild(i,!0),(n[e]=t).setVisible(!1),t.setAnchorPoint(.5,.5),this.addChild(t),0===(n=this._preferredSize).width&&0===n.height||t.setPreferredSize(n),this._state===e&&this.needsLayout()},setBackgroundSpriteFrameForState:function(t,e){t=cc.Scale9Sprite.createWithSpriteFrame(t);this.setBackgroundSpriteForState(t,e)}}),_p=cc.ControlButton.prototype,cc.defineGetterSetter(_p,"adjustBackground",_p.getAdjustBackgroundImage,_p.setAdjustBackgroundImage),cc.defineGetterSetter(_p,"preferredSize",_p.getPreferredSize,_p.setPreferredSize),cc.defineGetterSetter(_p,"labelAnchor",_p.getLabelAnchorPoint,_p.setLabelAnchorPoint),_p=null,cc.ControlButton.create=function(t,e,i){return new cc.ControlButton(t,e,i)},cc.RGBA=function(t,e,i,n){this.r=t,this.g=e,this.b=i,this.a=n},cc.HSV=function(t,e,i){this.h=t,this.s=e,this.v=i},cc.ControlUtils={},cc.ControlUtils.addSpriteToTargetWithPosAndAnchor=function(t,e,i,n){return(t=new cc.Sprite("#"+t))?(t.setPosition(i),t.setAnchorPoint(n),e.addChild(t),t):null},cc.ControlUtils.HSVfromRGB=function(t){var e,i=new cc.HSV,n=t.r<t.g?t.r:t.g;return n=n<t.b?n:t.b,e=(e=t.r>t.g?t.r:t.g)>t.b?e:t.b,n=(i.v=e)-n,0<e?(i.s=n/e,i.h=t.r>=e?(t.g-t.b)/n:t.g>=e?2+(t.b-t.r)/n:4+(t.r-t.g)/n,i.h*=60,i.h<0&&(i.h+=360)):(i.s=0,i.h=-1),i},cc.ControlUtils.RGBfromHSV=function(t){var e,i,n,s,r=new cc.RGBA;if(r.a=1,t.s<=0)t.h?(r.r=0,r.g=0,r.b=0):(r.r=t.v,r.g=t.v,r.b=t.v);else switch(360<=(e=t.h)&&(e=0),n=(e/=60)-(s=0|e),e=t.v*(1-t.s),i=t.v*(1-t.s*n),n=t.v*(1-t.s*(1-n)),s){case 0:r.r=t.v,r.g=n,r.b=e;break;case 1:r.r=i,r.g=t.v,r.b=e;break;case 2:r.r=e,r.g=t.v,r.b=n;break;case 3:r.r=e,r.g=i,r.b=t.v;break;case 4:r.r=n,r.g=e,r.b=t.v;break;default:r.r=t.v,r.g=e,r.b=i}return r},cc.ControlUtils.CCRectUnion=function(t,e){return cc.rectUnion(t,e)},cc.Invocation=cc.Class.extend({_action:null,_target:null,_controlEvent:null,ctor:function(t,e,i){this._target=t,this._action=e,this._controlEvent=i},getAction:function(){return this._action},getTarget:function(){return this._target},getControlEvent:function(){return this._controlEvent},invoke:function(t){this._target&&this._action&&(cc.isString(this._action)?this._target[this._action](t,this._controlEvent):this._action.call(this._target,t,this._controlEvent))}}),cc.Spacer=cc.Layer.extend({}),cc.Spacer.verticalSpacer=function(t){var e=new cc.Spacer;return e.init(),e.setContentSize(0,t),e},cc.Spacer.horizontalSpacer=function(t){var e=new cc.Spacer;return e.init(),e.setContentSize(t,0),e},cc.MenuPassive=cc.Layer.extend({_color:null,_opacity:0,_className:"MenuPassive",ctor:function(){},getColor:function(){var t=this._color;return cc.color(t.r,t.g,t.b,t.a)},setColor:function(t){var e=this._color;if(e.r=t.r,e.g=t.g,e.b=t.b,this._children&&0<this._children.length)for(e=0;e<this._children.length;e++)this._children[e]&&this._children[e].setColor(t);void 0===t.a||t.a_undefined||this.setOpacity(t.a)},getOpacity:function(){return this._opacity},setOpacity:function(t){if(this._opacity=t,this._children&&0<this._children.length)for(var e=0;e<this._children.length;e++)this._children[e]&&this._children[e].setOpacity(t);this._color.a=t},initWithItems:function(t,e){if(this.init()){var i=cc.director.getWinSize();if(this.ignoreAnchorPointForPosition(!0),this.setAnchorPoint(.5,.5),this.setContentSize(i),this.setPosition(i.width/2,i.height/2),i=0,t){this.addChild(t,i);for(var n=0;n<e.length;n++)e[n]&&this.addChild(e[n],++i)}return!0}return!1},alignItemsVertically:function(){this.alignItemsVerticallyWithPadding(cc.DEFAULT_PADDING)},alignItemsVerticallyWithPadding:function(t){var e,i=-t;if(this._children&&0<this._children.length)for(e=0;e<this._children.length;e++)this._children[e]&&(i+=this._children[e].getContentSize().height*this._children[e].getScaleY()+t);var n=0,s=i/2;if(this._children&&0<this._children.length)for(e=0;e<this._children.length;e++)this._children[e]&&(n=Math.max(n,this._children[e].getContentSize().width),this._children[e].setPosition(0,s-this._children[e].getContentSize().height*this._children[e].getScaleY()/2),s-=this._children[e].getContentSize().height*this._children[e].getScaleY()+t);this.setContentSize(n,i)},alignItemsHorizontally:function(){this.alignItemsHorizontallyWithPadding(cc.DEFAULT_PADDING)},alignItemsHorizontallyWithPadding:function(t){var e,i=-t;if(this._children&&0<this._children.length)for(e=0;e<this._children.length;e++)this._children[e]&&(i+=this._children[e].getContentSize().width*this._children[e].getScaleX()+t);var n=0,s=-i/2;if(this._children&&0<this._children.length)for(e=0;e<this._children.length;e++)this._children[e]&&(n=Math.max(n,this._children[e].getContentSize().height),this._children[e].setPosition(s+this._children[e].getContentSize().width*this._children[e].getScaleX()/2,0),s+=this._children[e].getContentSize().width*this._children[e].getScaleX()+t);this.setContentSize(i,n)},alignItemsInColumns:function(t){for(var e=[],i=1;i<arguments.length;i++)e.push(arguments[i]);var n,s,r=-5,o=0,a=0,c=0;if(this._children&&0<this._children.length)for(i=0;i<this._children.length;i++)this._children[i]&&(e.length<=o?cc.log("cc.MenuPassive.alignItemsInColumns(): invalid row index"):(n=e[o])?(a=0|((s=this._children[i].getContentSize().height)<=a||null==s?a:s),n<=++c&&(r+=a+5,a=c=0,++o)):cc.log("cc.MenuPassive.alignItemsInColumns(): can not have zero columns on a row"));var h=cc.director.getWinSize(),l=n=a=o=0,u=0,r=r/2;if(this._children&&0<this._children.length)for(i=0;i<this._children.length;i++)this._children[i]&&(0===n&&(u=l=h.width/(1+(n=e[o]))),a=0|((s=this._children[i].getContentSize().height)<=a||null==s?a:s),this._children[i].setPosition(u-h.width/2,r-this._children[i].getContentSize().height/2),u+=l,n<=++c)&&(r-=a+5,a=n=c=0,++o)},alignItemsInRows:function(t){for(var e=[],i=1;i<arguments.length;i++)e.push(arguments[i]);var n,s=[],r=[],o=-10,a=-5,c=0,h=0,l=0;if(this._children&&0<this._children.length)for(i=0;i<this._children.length;i++)this._children[i]&&(e.length<=c?cc.log("cc.MenuPassive.alignItemsInRows(): invalid row index"):(u=e[c])?(h=0|((n=this._children[i].getContentSize().width)<=h||null==n?h:n),a+=0|this._children[i].getContentSize().height+5,u<=++l&&(s.push(h),r.push(a),o+=h+10,h=l=0,a=-5,++c)):cc.log("cc.MenuPassive.alignItemsInColumns(): can't have zero rows on a column"));var a=cc.director.getWinSize(),h=c=0,u=null,o=-o/2,d=0;if(this._children&&0<this._children.length)for(i=0;i<this._children.length;i++)this._children[i]&&(null==u&&(u=e[c],d=r[c]),h=0|((n=this._children[i].getContentSize().width)<=h||null==n?h:n),this._children[i].setPosition(o+s[c]/2,d-a.height/2),d-=this._children[i].getContentSize().height+10,u<=++l)&&(o+=h+5,h=u=l=0,++c)},setOpacityModifyRGB:function(t){},isOpacityModifyRGB:function(){return!1}}),cc.MenuPassive.create=function(t){t=t||null;for(var e=[],i=1;i<arguments.length;i++)e.push(arguments[i]);return(i=new cc.MenuPassive)&&i.initWithItems(t,e)?i:null},cc.MenuPassive.createWithItem=function(t){return cc.MenuPassive.create(t,null)},cc.ControlSaturationBrightnessPicker=cc.Control.extend({_saturation:0,_brightness:0,_background:null,_overlay:null,_shadow:null,_slider:null,_startPos:null,_boxPos:0,_boxSize:0,_className:"ControlSaturationBrightnessPicker",ctor:function(t,e){cc.Control.prototype.ctor.call(this),e&&this.initWithTargetAndPos(t,e)},getSaturation:function(){return this._saturation},getBrightness:function(){return this._brightness},getBackground:function(){return this._background},getOverlay:function(){return this._brightness},getShadow:function(){return this._shadow},getSlider:function(){return this._slider},getStartPos:function(){return this._startPos},initWithTargetAndPos:function(t,e){return!!cc.Control.prototype.init.call(this)&&(this._background=cc.ControlUtils.addSpriteToTargetWithPosAndAnchor("colourPickerBackground.png",t,e,cc.p(0,0)),this._overlay=cc.ControlUtils.addSpriteToTargetWithPosAndAnchor("colourPickerOverlay.png",t,e,cc.p(0,0)),this._shadow=cc.ControlUtils.addSpriteToTargetWithPosAndAnchor("colourPickerShadow.png",t,e,cc.p(0,0)),this._slider=cc.ControlUtils.addSpriteToTargetWithPosAndAnchor("colourPicker.png",t,e,cc.p(.5,.5)),this._startPos=e,this._boxPos=35,this._boxSize=this._background.getContentSize().width/2,!0)},setEnabled:function(t){cc.Control.prototype.setEnabled.call(this,t),this._slider&&this._slider.setOpacity(t?255:128)},updateWithHSV:function(t){var e=new cc.HSV;e.s=1,e.h=t.h,e.v=1,t=cc.ControlUtils.RGBfromHSV(e),this._background.setColor(cc.color(0|255*t.r,0|255*t.g,0|255*t.b))},updateDraggerWithHSV:function(t){t=cc.p(this._startPos.x+this._boxPos+this._boxSize*(1-t.s),this._startPos.y+this._boxPos+this._boxSize*t.v),this._updateSliderPosition(t)},_updateSliderPosition:function(t){var e=this._startPos.x+.5*this._background.getBoundingBox().width,i=this._startPos.y+.5*this._background.getBoundingBox().height,n=t.x-e,s=t.y-i,r=Math.sqrt(n*n+s*s),n=Math.atan2(s,n);(s=.5*this._background.getBoundingBox().width)<r&&(t.x=e+s*Math.cos(n),t.y=i+s*Math.sin(n)),this._slider.setPosition(t),t.x<this._startPos.x+this._boxPos?t.x=this._startPos.x+this._boxPos:t.x>this._startPos.x+this._boxPos+this._boxSize-1&&(t.x=this._startPos.x+this._boxPos+this._boxSize-1),t.y<this._startPos.y+this._boxPos?t.y=this._startPos.y+this._boxPos:t.y>this._startPos.y+this._boxPos+this._boxSize&&(t.y=this._startPos.y+this._boxPos+this._boxSize),this._saturation=1-Math.abs((this._startPos.x+this._boxPos-t.x)/this._boxSize),this._brightness=Math.abs((this._startPos.y+this._boxPos-t.y)/this._boxSize)},_checkSliderPosition:function(t){var e=this._startPos.x+.5*this._background.getBoundingBox().width,i=this._startPos.y+.5*this._background.getBoundingBox().height,e=t.x-e,i=t.y-i;return Math.sqrt(e*e+i*i)<=.5*this._background.getBoundingBox().width&&(this._updateSliderPosition(t),this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED),!0)},onTouchBegan:function(t,e){return!(!this.isEnabled()||!this.isVisible())&&(t=this.getTouchLocation(t),this._checkSliderPosition(t))},onTouchMoved:function(t,e){t=this.getTouchLocation(t);this._checkSliderPosition(t)}}),_p=cc.ControlSaturationBrightnessPicker.prototype,cc.defineGetterSetter(_p,"saturation",_p.getSaturation),cc.defineGetterSetter(_p,"brightness",_p.getBrightness),cc.defineGetterSetter(_p,"background",_p.getBackground),cc.defineGetterSetter(_p,"overlay",_p.getOverlay),cc.defineGetterSetter(_p,"shadow",_p.getShadow),cc.defineGetterSetter(_p,"slider",_p.getSlider),cc.defineGetterSetter(_p,"startPos",_p.getStartPos),_p=null,cc.ControlSaturationBrightnessPicker.create=function(t,e){return new cc.ControlSaturationBrightnessPicker(t,e)},cc.ControlHuePicker=cc.Control.extend({_hue:0,_huePercentage:0,_background:null,_slider:null,_startPos:null,_className:"ControlHuePicker",ctor:function(t,e){cc.Control.prototype.ctor.call(this),e&&this.initWithTargetAndPos(t,e)},getHue:function(){return this._hue},setHue:function(t){this._hue=t,this.setHuePercentage(this._hue/360)},getHuePercentage:function(){return this._huePercentage},setHuePercentage:function(t){this._huePercentage=t,this._hue=360*this._huePercentage;var e=this._background.getBoundingBox(),i=this._startPos.x+.5*e.width,e=(t=this._startPos.y+.5*e.height,.5*e.width-15),n=cc.degreesToRadians(360*this._huePercentage-180),i=i+e*Math.cos(n);t+=e*Math.sin(n),this._slider.setPosition(i,t)},setEnabled:function(t){cc.Control.prototype.setEnabled.call(this,t),this._slider&&this._slider.setOpacity(t?255:128)},getBackground:function(){return this._background},getSlider:function(){return this._slider},getStartPos:function(){return this._startPos},initWithTargetAndPos:function(t,e){return!!cc.Control.prototype.init.call(this)&&(this._background=cc.ControlUtils.addSpriteToTargetWithPosAndAnchor("huePickerBackground.png",t,e,cc.p(0,0)),this._slider=cc.ControlUtils.addSpriteToTargetWithPosAndAnchor("colourPicker.png",t,e,cc.p(.5,.5)),this._slider.setPosition(e.x,e.y+.5*this._background.getBoundingBox().height),this._startPos=e,!(this._huePercentage=this._hue=0))},_updateSliderPosition:function(t){var e=this._background.getBoundingBox();t=Math.atan2(t.y-(this._startPos.y+.5*e.height),t.x-(this._startPos.x+.5*e.width)),t=cc.radiansToDegrees(t)+180,this.setHue(t),this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED)},_checkSliderPosition:function(t){var e=Math.sqrt(Math.pow(t.x+10,2)+Math.pow(t.y,2));return e<80&&59<e&&(this._updateSliderPosition(t),!0)},onTouchBegan:function(t,e){return!(!this.isEnabled()||!this.isVisible())&&(t=this.getTouchLocation(t),this._checkSliderPosition(t))},onTouchMoved:function(t,e){t=this.getTouchLocation(t);this._checkSliderPosition(t)}}),_p=cc.ControlHuePicker.prototype,cc.defineGetterSetter(_p,"hue",_p.getHue,_p.setHue),cc.defineGetterSetter(_p,"huePercent",_p.getHuePercentage,_p.setHuePercentage),cc.defineGetterSetter(_p,"background",_p.getBackground),cc.defineGetterSetter(_p,"slider",_p.getSlider),cc.defineGetterSetter(_p,"startPos",_p.getStartPos),_p=null,cc.ControlHuePicker.create=function(t,e){return new cc.ControlHuePicker(t,e)},cc.ControlColourPicker=cc.Control.extend({_hsv:null,_colourPicker:null,_huePicker:null,_background:null,_className:"ControlColourPicker",ctor:function(){cc.Control.prototype.ctor.call(this),this.init()},hueSliderValueChanged:function(t,e){this._hsv.h=t.getHue();t=cc.ControlUtils.RGBfromHSV(this._hsv);cc.Control.prototype.setColor.call(this,cc.color(0|255*t.r,0|255*t.g,0|255*t.b)),this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED),this._updateControlPicker()},colourSliderValueChanged:function(t,e){this._hsv.s=t.getSaturation(),this._hsv.v=t.getBrightness();t=cc.ControlUtils.RGBfromHSV(this._hsv);cc.Control.prototype.setColor.call(this,cc.color(0|255*t.r,0|255*t.g,0|255*t.b)),this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED)},setColor:function(t){cc.Control.prototype.setColor.call(this,t);var e=new cc.RGBA;e.r=t.r/255,e.g=t.g/255,e.b=t.b/255,e.a=1,this._hsv=cc.ControlUtils.HSVfromRGB(e),this._updateHueAndControlPicker()},getBackground:function(){return this._background},init:function(){var t,e;return!!cc.Control.prototype.init.call(this)&&(cc.spriteFrameCache.addSpriteFrames(res.CCControlColourPickerSpriteSheet_plist),t=new cc.SpriteBatchNode(res.CCControlColourPickerSpriteSheet_png),this.addChild(t),this._hsv=new cc.HSV(0,0,0),this._background=cc.ControlUtils.addSpriteToTargetWithPosAndAnchor("menuColourPanelBackground.png",t,cc.p(0,0),cc.p(.5,.5)),e=cc.pSub(this._background.getPosition(),cc.p(this._background.getContentSize().width/2,this._background.getContentSize().height/2)),this._huePicker=new cc.ControlHuePicker(t,cc.p(e.x+8,e.y+8)),this._colourPicker=new cc.ControlSaturationBrightnessPicker(t,cc.p(e.x+28,e.y+28)),this._huePicker.addTargetWithActionForControlEvents(this,this.hueSliderValueChanged,cc.CONTROL_EVENT_VALUECHANGED),this._colourPicker.addTargetWithActionForControlEvents(this,this.colourSliderValueChanged,cc.CONTROL_EVENT_VALUECHANGED),this._updateHueAndControlPicker(),this.addChild(this._huePicker),this.addChild(this._colourPicker),this.setContentSize(this._background.getContentSize()),!0)},_updateControlPicker:function(){this._huePicker.setHue(this._hsv.h),this._colourPicker.updateWithHSV(this._hsv)},_updateHueAndControlPicker:function(){this._huePicker.setHue(this._hsv.h),this._colourPicker.updateWithHSV(this._hsv),this._colourPicker.updateDraggerWithHSV(this._hsv)},setEnabled:function(t){cc.Control.prototype.setEnabled.call(this,t),null!==this._huePicker&&this._huePicker.setEnabled(t),this._colourPicker&&this._colourPicker.setEnabled(t)},onTouchBegan:function(){return!1}}),_p=cc.ControlColourPicker.prototype,cc.defineGetterSetter(_p,"background",_p.getBackground),_p=null,cc.ControlColourPicker.create=function(){return new cc.ControlColourPicker},res||{}),SCROLL_DEACCEL_RATE=(res.CCControlColourPickerSpriteSheet_plist=res.CCControlColourPickerSpriteSheet_plist||"res/extensions/CCControlColourPickerSpriteSheet.plist",res.CCControlColourPickerSpriteSheet_png=res.CCControlColourPickerSpriteSheet_png||"res/extensions/CCControlColourPickerSpriteSheet.png",cc.SLIDER_MARGIN_H=24,cc.SLIDER_MARGIN_V=8,cc.ControlSlider=cc.Control.extend({_value:0,_minimumValue:0,_maximumValue:0,_minimumAllowedValue:0,_maximumAllowedValue:0,_thumbSprite:null,_progressSprite:null,_backgroundSprite:null,_className:"ControlSlider",ctor:function(t,e,i){cc.Control.prototype.ctor.call(this),null!=i&&(t=new cc.Sprite(t),e=new cc.Sprite(e),i=new cc.Sprite(i),this.initWithSprites(t,e,i))},getValue:function(){return this._value},setValue:function(t){t=Math.max(t,this._minimumValue),this._value=t=Math.min(t,this._maximumValue),this.needsLayout(),this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED)},getMinimumValue:function(){return this._minimumValue},setMinimumValue:function(t){this._minimumAllowedValue=this._minimumValue=t,this._minimumValue>=this._maximumValue&&(this._maximumValue=this._minimumValue+1),this.setValue(this._value)},getMaximumValue:function(){return this._maximumValue},setMaximumValue:function(t){this._maximumAllowedValue=this._maximumValue=t,this._maximumValue<=this._minimumValue&&(this._minimumValue=this._maximumValue-1),this.setValue(this._value)},isTouchInside:function(t){t=t.getLocation(),t=this.getParent().convertToNodeSpace(t);var e=this.getBoundingBox();return e.width+=this._thumbSprite.getContentSize().width,e.x-=this._thumbSprite.getContentSize().width/2,cc.rectContainsPoint(e,t)},locationFromTouch:function(t){return t=t.getLocation(),(t=this.convertToNodeSpace(t)).x<0?t.x=0:t.x>this._backgroundSprite.getContentSize().width&&(t.x=this._backgroundSprite.getContentSize().width),t},getMinimumAllowedValue:function(){return this._minimumAllowedValue},setMinimumAllowedValue:function(t){this._minimumAllowedValue=t},getMaximumAllowedValue:function(){return this._maximumAllowedValue},setMaximumAllowedValue:function(t){this._maximumAllowedValue=t},getThumbSprite:function(){return this._thumbSprite},getProgressSprite:function(){return this._progressSprite},getBackgroundSprite:function(){return this._backgroundSprite},initWithSprites:function(t,e,i){return!!cc.Control.prototype.init.call(this)&&(this.ignoreAnchorPointForPosition(!1),this._backgroundSprite=t,this._progressSprite=e,this._thumbSprite=i,t=cc.ControlUtils.CCRectUnion(t.getBoundingBox(),i.getBoundingBox()),this.setContentSize(t.width,t.height),this._backgroundSprite.setAnchorPoint(.5,.5),this._backgroundSprite.setPosition(t.width/2,t.height/2),this.addChild(this._backgroundSprite),this._progressSprite.setAnchorPoint(0,.5),this._progressSprite.setPosition(0,t.height/2),this.addChild(this._progressSprite),this._thumbSprite.setPosition(0,t.height/2),this.addChild(this._thumbSprite),this._minimumValue=0,this._maximumValue=1,this.setValue(this._minimumValue),!0)},setEnabled:function(t){cc.Control.prototype.setEnabled.call(this,t),this._thumbSprite&&this._thumbSprite.setOpacity(t?255:128)},sliderBegan:function(t){this.setSelected(!0),this._thumbSprite.setColor(cc.color.GRAY),this.setValue(this.valueForLocation(t))},sliderMoved:function(t){this.setValue(this.valueForLocation(t))},sliderEnded:function(t){this.isSelected()&&this.setValue(this.valueForLocation(this._thumbSprite.getPosition())),this._thumbSprite.setColor(cc.color.WHITE),this.setSelected(!1)},getTouchLocationInControl:function(t){return t=t.getLocation(),(t=this.convertToNodeSpace(t)).x<0?t.x=0:t.x>this._backgroundSprite.getContentSize().width+cc.SLIDER_MARGIN_H&&(t.x=this._backgroundSprite.getContentSize().width+cc.SLIDER_MARGIN_H),t},onTouchBegan:function(t,e){return!!(this.isTouchInside(t)&&this.isEnabled()&&this.isVisible())&&(t=this.locationFromTouch(t),this.sliderBegan(t),!0)},onTouchMoved:function(t,e){t=this.locationFromTouch(t);this.sliderMoved(t)},onTouchEnded:function(t,e){this.sliderEnded(cc.p(0,0))},needsLayout:function(){this._thumbSprite.setPositionX((this._value-this._minimumValue)/(this._maximumValue-this._minimumValue)*this._backgroundSprite.getContentSize().width);var t=this._progressSprite.getTextureRect(),t=cc.rect(t.x,t.y,this._thumbSprite.getPositionX(),t.height);this._progressSprite.setTextureRect(t,this._progressSprite.isTextureRectRotated()),this._thumbSprite._renderCmd.transform(this._renderCmd)},valueForLocation:function(t){return t=t.x/this._backgroundSprite.getContentSize().width,Math.max(Math.min(this._minimumValue+t*(this._maximumValue-this._minimumValue),this._maximumAllowedValue),this._minimumAllowedValue)}}),_p=cc.ControlSlider.prototype,cc.defineGetterSetter(_p,"value",_p.getValue,_p.setValue),cc.defineGetterSetter(_p,"minValue",_p.getMinimumValue,_p.setMinimumValue),cc.defineGetterSetter(_p,"maxValue",_p.getMaximumValue,_p.setMaximumValue),cc.defineGetterSetter(_p,"minAllowedValue",_p.getMinimumAllowedValue,_p.setMinimumAllowedValue),cc.defineGetterSetter(_p,"maxAllowedValue",_p.getMaximumAllowedValue,_p.setMaximumAllowedValue),cc.defineGetterSetter(_p,"thumbSprite",_p.getThumbSprite),cc.defineGetterSetter(_p,"progressSprite",_p.getProgressSprite),cc.defineGetterSetter(_p,"backgroundSprite",_p.getBackgroundSprite),_p=null,cc.ControlSlider.create=function(t,e,i){return new cc.ControlSlider(t,e,i)},cc.ControlSwitch=cc.Control.extend({_switchSprite:null,_initialTouchXPosition:0,_moved:!1,_on:!1,_className:"ControlSwitch",ctor:function(t,e,i,n,s,r){cc.Control.prototype.ctor.call(this),r&&this.initWithMaskSprite(t,e,i,n,s,r)},initWithMaskSprite:function(t,e,i,n,s,r){if(!t)throw Error("cc.ControlSwitch.initWithMaskSprite(): maskSprite should be non-null.");if(!e)throw Error("cc.ControlSwitch.initWithMaskSprite(): onSprite should be non-null.");if(!i)throw Error("cc.ControlSwitch.initWithMaskSprite(): offSprite should be non-null.");if(n)return!!this.init()&&(this._on=!0,this._switchSprite=new cc.ControlSwitchSprite,this._switchSprite.initWithMaskSprite(t,e,i,n,s,r),this._switchSprite.setPosition(this._switchSprite.getContentSize().width/2,this._switchSprite.getContentSize().height/2),this.addChild(this._switchSprite),this.ignoreAnchorPointForPosition(!1),this.setAnchorPoint(.5,.5),this.setContentSize(this._switchSprite.getContentSize()),!0);throw Error("cc.ControlSwitch.initWithMaskSprite(): thumbSprite should be non-null.")},setOn:function(t,e){e=e||!1;t=(this._on=t)?this._switchSprite.getOnPosition():this._switchSprite.getOffPosition();e?this._switchSprite.runAction(new cc.ActionTween(.2,"sliderXPosition",this._switchSprite.getSliderXPosition(),t)):this._switchSprite.setSliderXPosition(t),this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED)},isOn:function(){return this._on},hasMoved:function(){return this._moved},setEnabled:function(t){this._enabled=t,this._switchSprite.setOpacity(t?255:128)},locationFromTouch:function(t){return t=t.getLocation(),this.convertToNodeSpace(t)},onTouchBegan:function(t,e){return!!(this.isTouchInside(t)&&this.isEnabled()&&this.isVisible())&&(this._moved=!1,this._initialTouchXPosition=this.locationFromTouch(t).x-this._switchSprite.getSliderXPosition(),this._switchSprite.getThumbSprite().setColor(cc.color.GRAY),this._switchSprite.needsLayout(),!0)},onTouchMoved:function(t,e){t=this.locationFromTouch(t),t=cc.p(t.x-this._initialTouchXPosition,0);this._moved=!0,this._switchSprite.setSliderXPosition(t.x)},onTouchEnded:function(t,e){t=this.locationFromTouch(t);this._switchSprite.getThumbSprite().setColor(cc.color.WHITE),this.hasMoved()?this.setOn(!(t.x<this._switchSprite.getContentSize().width/2),!0):this.setOn(!this._on,!0)},onTouchCancelled:function(t,e){t=this.locationFromTouch(t);this._switchSprite.getThumbSprite().setColor(cc.color.WHITE),this.hasMoved()?this.setOn(!(t.x<this._switchSprite.getContentSize().width/2),!0):this.setOn(!this._on,!0)}}),cc.ControlSwitch.create=function(t,e,i,n,s,r){return new cc.ControlSwitch(t,e,i,n,s,r)},cc.ControlSwitchSprite=cc.Sprite.extend({_sliderXPosition:0,_onPosition:0,_offPosition:0,_textureLocation:0,_maskLocation:0,_maskSize:null,_onSprite:null,_offSprite:null,_thumbSprite:null,_onLabel:null,_offLabel:null,_clipper:null,_stencil:null,_backRT:null,ctor:function(){cc.Sprite.prototype.ctor.call(this),this._maskLocation=this._offPosition=this._onPosition=this._sliderXPosition=0,this._maskSize=cc.size(0,0),this._offLabel=this._onLabel=this._thumbSprite=this._offSprite=this._onSprite=null},initWithMaskSprite:function(t,e,i,n,s,r){return!!cc.Sprite.prototype.init.call(this)&&(this.setSpriteFrame(t.displayFrame()),this._onPosition=0,this._offPosition=-e.getContentSize().width+n.getContentSize().width/2,this._sliderXPosition=this._onPosition,this.setOnSprite(e),this.setOffSprite(i),this.setThumbSprite(n),this.setOnLabel(s),this.setOffLabel(r),this._stencil=t,t=this._maskSize=this._stencil.getContentSize(),this._stencil.setPosition(0,0),this._clipper=new cc.ClippingNode,this._clipper.setAnchorPoint(.5,.5),this._clipper.setPosition(t.width/2,t.height/2),this._clipper.setStencil(this._stencil),this.addChild(this._clipper),this._clipper.addChild(e),this._clipper.addChild(i),this._clipper.addChild(s),this._clipper.addChild(r),this.addChild(this._thumbSprite),this.needsLayout(),!0)},needsLayout:function(){var t=this._maskSize;this._onSprite.setPosition(this._onSprite.getContentSize().width/2+this._sliderXPosition-t.width/2,this._onSprite.getContentSize().height/2-t.height/2),this._offSprite.setPosition(this._onSprite.getContentSize().width+this._offSprite.getContentSize().width/2+this._sliderXPosition-t.width/2,this._offSprite.getContentSize().height/2-t.height/2),this._onLabel&&this._onLabel.setPosition(this._onSprite.getPositionX()-this._thumbSprite.getContentSize().width/6,this._onSprite.getContentSize().height/2-t.height/2),this._offLabel&&this._offLabel.setPosition(this._offSprite.getPositionX()+this._thumbSprite.getContentSize().width/6,this._offSprite.getContentSize().height/2-t.height/2),this._thumbSprite.setPosition(this._onSprite.getContentSize().width+this._sliderXPosition,this._maskSize.height/2)},setSliderXPosition:function(t){t<=this._offPosition?t=this._offPosition:t>=this._onPosition&&(t=this._onPosition),this._sliderXPosition=t,this.needsLayout()},getSliderXPosition:function(){return this._sliderXPosition},_getOnSideWidth:function(){return this._onSprite.getContentSize().width},_getOffSideWidth:function(){return this._offSprite.getContentSize().height},updateTweenAction:function(t,e){"sliderXPosition"===e&&this.setSliderXPosition(t)},setOnPosition:function(t){this._onPosition=t},getOnPosition:function(){return this._onPosition},setOffPosition:function(t){this._offPosition=t},getOffPosition:function(){return this._offPosition},setMaskTexture:function(t){this._stencil.setTexture(t)},getMaskTexture:function(){return this._stencil.getTexture()},setTextureLocation:function(t){this._textureLocation=t},getTextureLocation:function(){return this._textureLocation},setMaskLocation:function(t){this._maskLocation=t},getMaskLocation:function(){return this._maskLocation},setOnSprite:function(t){this._onSprite=t},getOnSprite:function(){return this._onSprite},setOffSprite:function(t){this._offSprite=t},getOffSprite:function(){return this._offSprite},setThumbSprite:function(t){this._thumbSprite=t},getThumbSprite:function(){return this._thumbSprite},setOnLabel:function(t){this._onLabel=t},getOnLabel:function(){return this._onLabel},setOffLabel:function(t){this._offLabel=t},getOffLabel:function(){return this._offLabel}}),_p=cc.ControlSwitchSprite.prototype,cc.defineGetterSetter(_p,"sliderX",_p.getSliderXPosition,_p.setSliderXPosition),cc.defineGetterSetter(_p,"onPos",_p.getOnPosition,_p.setOnPosition),cc.defineGetterSetter(_p,"offPos",_p.getOffPosition,_p.setOffPosition),cc.defineGetterSetter(_p,"maskTexture",_p.getMaskTexture,_p.setMaskTexture),cc.defineGetterSetter(_p,"maskPos",_p.getMaskLocation,_p.setMaskLocation),cc.defineGetterSetter(_p,"onSprite",_p.getOnSprite,_p.setOnSprite),cc.defineGetterSetter(_p,"offSprite",_p.getOffSprite,_p.setOffSprite),cc.defineGetterSetter(_p,"thumbSprite",_p.getThumbSprite,_p.setThumbSprite),cc.defineGetterSetter(_p,"onLabel",_p.getOnLabel,_p.setOnLabel),cc.defineGetterSetter(_p,"offLabel",_p.getOffLabel,_p.setOffLabel),cc.defineGetterSetter(_p,"onSideWidth",_p._getOnSideWidth),cc.defineGetterSetter(_p,"offSideWidth",_p._getOffSideWidth),_p=null,cc.CONTROL_STEPPER_PARTMINUS=0,cc.CONTROL_STEPPER_PARTPLUS=1,cc.CONTROL_STEPPER_PARTNONE=2,cc.CONTROL_STEPPER_LABELCOLOR_ENABLED=cc.color(55,55,55),cc.CONTROL_STEPPER_LABELCOLOR_DISABLED=cc.color(147,147,147),cc.CONTROL_STEPPER_LABELFONT="CourierNewPSMT",cc.AUTOREPEAT_DELTATIME=.15,cc.AUTOREPEAT_INCREASETIME_INCREMENT=12,cc.ControlStepper=cc.Control.extend({_minusSprite:null,_plusSprite:null,_minusLabel:null,_plusLabel:null,_value:0,_continuous:!1,_autorepeat:!1,_wraps:!1,_minimumValue:0,_maximumValue:0,_stepValue:0,_touchInsideFlag:!1,_touchedPart:cc.CONTROL_STEPPER_PARTNONE,_autorepeatCount:0,_className:"ControlStepper",ctor:function(t,e){cc.Control.prototype.ctor.call(this),this._plusLabel=this._minusLabel=this._plusSprite=this._minusSprite=null,this._value=0,this._wraps=this._autorepeat=this._continuous=!1,this._stepValue=this._maximumValue=this._minimumValue=0,this._touchInsideFlag=!1,this._touchedPart=cc.CONTROL_STEPPER_PARTNONE,this._autorepeatCount=0,e&&this.initWithMinusSpriteAndPlusSprite(t,e)},initWithMinusSpriteAndPlusSprite:function(t,e){if(!t)throw Error("cc.ControlStepper.initWithMinusSpriteAndPlusSprite(): Minus sprite should be non-null.");if(e)return!!this.init()&&(this._continuous=this._autorepeat=!0,this._minimumValue=0,this._maximumValue=100,this._value=0,this._stepValue=1,this._wraps=!1,this.ignoreAnchorPointForPosition(!1),this.setMinusSprite(t),this._minusSprite.setPosition(t.getContentSize().width/2,t.getContentSize().height/2),this.addChild(this._minusSprite),this.setMinusLabel(new cc.LabelTTF("-",cc.CONTROL_STEPPER_LABELFONT,40,cc.size(40,40),cc.TEXT_ALIGNMENT_CENTER,cc.VERTICAL_TEXT_ALIGNMENT_CENTER)),this._minusLabel.setColor(cc.CONTROL_STEPPER_LABELCOLOR_DISABLED),this._minusLabel.setPosition(this._minusSprite.getContentSize().width/2,this._minusSprite.getContentSize().height/2),this._minusSprite.addChild(this._minusLabel),this.setPlusSprite(e),this._plusSprite.setPosition(t.getContentSize().width+e.getContentSize().width/2,t.getContentSize().height/2),this.addChild(this._plusSprite),this.setPlusLabel(new cc.LabelTTF("+",cc.CONTROL_STEPPER_LABELFONT,40,cc.size(40,40),cc.TEXT_ALIGNMENT_CENTER,cc.VERTICAL_TEXT_ALIGNMENT_CENTER)),this._plusLabel.setColor(cc.CONTROL_STEPPER_LABELCOLOR_ENABLED),this._plusLabel.setPosition(this._plusSprite.getContentSize().width/2,this._plusSprite.getContentSize().height/2),this._plusSprite.addChild(this._plusLabel),e=cc.ControlUtils.CCRectUnion(this._minusSprite.getBoundingBox(),this._plusSprite.getBoundingBox()),this.setContentSize(this._minusSprite.getContentSize().width+this._plusSprite.getContentSize().height,e.height),!0);throw Error("cc.ControlStepper.initWithMinusSpriteAndPlusSprite(): Plus sprite should be non-null.")},setWraps:function(t){(this._wraps=t)&&(this._minusLabel.setColor(cc.CONTROL_STEPPER_LABELCOLOR_ENABLED),this._plusLabel.setColor(cc.CONTROL_STEPPER_LABELCOLOR_ENABLED)),this.setValue(this._value)},getWraps:function(){return this._wraps},setMinimumValue:function(t){if(t>=this._maximumValue)throw Error("cc.ControlStepper.setMinimumValue(): minimumValue should be numerically less than maximumValue.");this._minimumValue=t,this.setValue(this._value)},getMinimumValue:function(){return this._minimumValue},setMaximumValue:function(t){if(t<=this._minimumValue)throw Error("cc.ControlStepper.setMaximumValue(): maximumValue should be numerically less than maximumValue.");this._maximumValue=t,this.setValue(this._value)},getMaximumValue:function(){return this._maximumValue},setValue:function(t){this.setValueWithSendingEvent(t,!0)},getValue:function(){return this._value},setStepValue:function(t){if(t<=0)throw Error("cc.ControlStepper.setMaximumValue(): stepValue should be numerically greater than 0.");this._stepValue=t},getStepValue:function(){return this._stepValue},isContinuous:function(){return this._continuous},setValueWithSendingEvent:function(t,e){t<this._minimumValue?t=this._wraps?this._maximumValue:this._minimumValue:t>this._maximumValue&&(t=this._wraps?this._minimumValue:this._maximumValue),this._value=t,this._wraps||(this._minusLabel.setColor(t===this._minimumValue?cc.CONTROL_STEPPER_LABELCOLOR_DISABLED:cc.CONTROL_STEPPER_LABELCOLOR_ENABLED),this._plusLabel.setColor(t===this._maximumValue?cc.CONTROL_STEPPER_LABELCOLOR_DISABLED:cc.CONTROL_STEPPER_LABELCOLOR_ENABLED)),e&&this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED)},startAutorepeat:function(){this._autorepeatCount=-1,this.schedule(this.update,cc.AUTOREPEAT_DELTATIME,cc.REPEAT_FOREVER,3*cc.AUTOREPEAT_DELTATIME)},stopAutorepeat:function(){this.unschedule(this.update)},update:function(t){this._autorepeatCount++,this._autorepeatCount<cc.AUTOREPEAT_INCREASETIME_INCREMENT&&0!=this._autorepeatCount%3||(this._touchedPart===cc.CONTROL_STEPPER_PARTMINUS?this.setValueWithSendingEvent(this._value-this._stepValue,this._continuous):this._touchedPart===cc.CONTROL_STEPPER_PARTPLUS&&this.setValueWithSendingEvent(this._value+this._stepValue,this._continuous))},updateLayoutUsingTouchLocation:function(t){t.x<this._minusSprite.getContentSize().width&&this._value>this._minimumValue?(this._touchedPart=cc.CONTROL_STEPPER_PARTMINUS,this._minusSprite.setColor(cc.color.GRAY),this._plusSprite.setColor(cc.color.WHITE)):t.x>=this._minusSprite.getContentSize().width&&this._value<this._maximumValue?(this._touchedPart=cc.CONTROL_STEPPER_PARTPLUS,this._minusSprite.setColor(cc.color.WHITE),this._plusSprite.setColor(cc.color.GRAY)):(this._touchedPart=cc.CONTROL_STEPPER_PARTNONE,this._minusSprite.setColor(cc.color.WHITE),this._plusSprite.setColor(cc.color.WHITE))},onTouchBegan:function(t,e){return!!(this.isTouchInside(t)&&this.isEnabled()&&this.isVisible())&&(t=this.getTouchLocation(t),this.updateLayoutUsingTouchLocation(t),this._touchInsideFlag=!0,this._autorepeat&&this.startAutorepeat(),!0)},onTouchMoved:function(t,e){this.isTouchInside(t)?(t=this.getTouchLocation(t),this.updateLayoutUsingTouchLocation(t),this._touchInsideFlag||(this._touchInsideFlag=!0,this._autorepeat&&this.startAutorepeat())):(this._touchInsideFlag=!1,this._touchedPart=cc.CONTROL_STEPPER_PARTNONE,this._minusSprite.setColor(cc.color.WHITE),this._plusSprite.setColor(cc.color.WHITE),this._autorepeat&&this.stopAutorepeat())},onTouchEnded:function(t,e){this._minusSprite.setColor(cc.color.WHITE),this._plusSprite.setColor(cc.color.WHITE),this._autorepeat&&this.stopAutorepeat(),this.isTouchInside(t)&&(t=this.getTouchLocation(t),this.setValue(this._value+(t.x<this._minusSprite.getContentSize().width?0-this._stepValue:this._stepValue)))},setMinusSprite:function(t){this._minusSprite=t},getMinusSprite:function(){return this._minusSprite},setPlusSprite:function(t){this._plusSprite=t},getPlusSprite:function(){return this._plusSprite},setMinusLabel:function(t){this._minusLabel=t},getMinusLabel:function(){return this._minusLabel},setPlusLabel:function(t){this._plusLabel=t},getPlusLabel:function(){return this._plusLabel}}),_p=cc.ControlStepper.prototype,cc.defineGetterSetter(_p,"wraps",_p.getWraps,_p.setWraps),cc.defineGetterSetter(_p,"value",_p.getValue,_p.setValue),cc.defineGetterSetter(_p,"minValue",_p.getMinimumValue,_p.setMinimumValue),cc.defineGetterSetter(_p,"maxValue",_p.getMaximumValue,_p.setMaximumValue),cc.defineGetterSetter(_p,"stepValue",_p.getStepValue,_p.setStepValue),cc.defineGetterSetter(_p,"continuous",_p.isContinuous),cc.defineGetterSetter(_p,"minusSprite",_p.getMinusSprite,_p.setMinusSprite),cc.defineGetterSetter(_p,"plusSprite",_p.getPlusSprite,_p.setPlusSprite),cc.defineGetterSetter(_p,"minusLabel",_p.getMinusLabel,_p.setMinusLabel),cc.defineGetterSetter(_p,"plusLabel",_p.getPlusLabel,_p.setPlusLabel),_p=null,cc.ControlStepper.create=function(t,e){return new cc.ControlStepper(t,e)},cc.ControlPotentiometer=cc.Control.extend({_thumbSprite:null,_progressTimer:null,_previousLocation:null,_value:0,_minimumValue:0,_maximumValue:1,_className:"ControlPotentiometer",ctor:function(t,e,i){cc.Control.prototype.ctor.call(this),null!=i&&(t=new cc.Sprite(t),i=new cc.Sprite(i),e=new cc.ProgressTimer(new cc.Sprite(e)),this.initWithTrackSprite_ProgressTimer_ThumbSprite(t,e,i))},initWithTrackSprite_ProgressTimer_ThumbSprite:function(t,e,i){return!!this.init()&&(this.setProgressTimer(e),this.setThumbSprite(i),this._thumbSprite.setPosition(e.getPosition()),this.addChild(i,2),this.addChild(e,1),this.addChild(t),this.setContentSize(t.getContentSize()),this._minimumValue=0,this._maximumValue=1,this.setValue(this._minimumValue),!0)},setEnabled:function(t){this.setEnabled(t),null!==this._thumbSprite&&this._thumbSprite.setOpacity(t?255:128)},setValue:function(t){(t=t<this._minimumValue?this._minimumValue:t)>this._maximumValue&&(t=this._maximumValue),t=((this._value=t)-this._minimumValue)/(this._maximumValue-this._minimumValue),this._progressTimer.setPercentage(100*t),this._thumbSprite.setRotation(360*t),this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED)},getValue:function(){return this._value},setMinimumValue:function(t){this._minimumValue=t,this._minimumValue>=this._maximumValue&&(this._maximumValue=this._minimumValue+1),this.setValue(this._maximumValue)},getMinimumValue:function(){return this._minimumValue},setMaximumValue:function(t){this._maximumValue=t,this._maximumValue<=this._minimumValue&&(this._minimumValue=this._maximumValue-1),this.setValue(this._minimumValue)},getMaximumValue:function(){return this._maximumValue},isTouchInside:function(t){return t=this.getTouchLocation(t),this.distanceBetweenPointAndPoint(this._progressTimer.getPosition(),t)<Math.min(this.getContentSize().width/2,this.getContentSize().height/2)},onTouchBegan:function(t,e){return!!(this.isTouchInside(t)&&this.isEnabled()&&this.isVisible())&&(this._previousLocation=this.getTouchLocation(t),this.potentiometerBegan(this._previousLocation),!0)},onTouchMoved:function(t,e){t=this.getTouchLocation(t);this.potentiometerMoved(t)},onTouchEnded:function(t,e){this.potentiometerEnded(cc.p(0,0))},distanceBetweenPointAndPoint:function(t,e){var i=t.x-e.x,t=t.y-e.y;return Math.sqrt(i*i+t*t)},angleInDegreesBetweenLineFromPoint_toPoint_toLineFromPoint_toPoint:function(t,e,i,n){var s=n.x-i.x;return i=n.y-i.y,180*((t=Math.atan2(e.x-t.x,e.y-t.y))-Math.atan2(s,i))/Math.PI},potentiometerBegan:function(t){this.setSelected(!0),this.getThumbSprite().setColor(cc.color.GRAY)},potentiometerMoved:function(t){var e=this.angleInDegreesBetweenLineFromPoint_toPoint_toLineFromPoint_toPoint(this._progressTimer.getPosition(),t,this._progressTimer.getPosition(),this._previousLocation);180<e?e-=360:e<-180&&(e+=360),this.setValue(this._value+e/360*(this._maximumValue-this._minimumValue)),this._previousLocation=t},potentiometerEnded:function(t){this.getThumbSprite().setColor(cc.color.WHITE),this.setSelected(!1)},setThumbSprite:function(t){this._thumbSprite=t},getThumbSprite:function(){return this._thumbSprite},setProgressTimer:function(t){this._progressTimer=t},getProgressTimer:function(){return this._progressTimer},setPreviousLocation:function(t){this._previousLocation=t},getPreviousLocation:function(){return this._previousLocation}}),_p=cc.ControlPotentiometer.prototype,cc.defineGetterSetter(_p,"value",_p.getValue,_p.setValue),cc.defineGetterSetter(_p,"minValue",_p.getMinimumValue,_p.setMinimumValue),cc.defineGetterSetter(_p,"maxValue",_p.getMaximumValue,_p.setMaximumValue),cc.defineGetterSetter(_p,"progressTimer",_p.getProgressTimer,_p.setProgressTimer),cc.defineGetterSetter(_p,"thumbSprite",_p.getThumbSprite,_p.setThumbSprite),cc.defineGetterSetter(_p,"prevLocation",_p.getPreviousLocation,_p.setPreviousLocation),_p=null,cc.ControlPotentiometer.create=function(t,e,i){return new cc.ControlPotentiometer(t,e,i)},cc.SCROLLVIEW_DIRECTION_NONE=-1,cc.SCROLLVIEW_DIRECTION_HORIZONTAL=0,cc.SCROLLVIEW_DIRECTION_VERTICAL=1,cc.SCROLLVIEW_DIRECTION_BOTH=2,.95),SCROLL_DEACCEL_DIST=1,BOUNCE_DURATION=.15,INSET_RATIO=.2,MOVE_INCH=.04375,BOUNCE_BACK_FACTOR=.35,_compareObject=(cc.convertDistanceFromPointToInch=function(t){var e=cc.view;return t*(e=(e.getScaleX()+e.getScaleY())/2)/160},cc.ScrollViewDelegate=cc.Class.extend({scrollViewDidScroll:function(t){},scrollViewDidZoom:function(t){}}),cc.ScrollView=cc.Layer.extend({_zoomScale:0,_minZoomScale:0,_maxZoomScale:0,_delegate:null,_direction:cc.SCROLLVIEW_DIRECTION_BOTH,_dragging:!1,_contentOffset:null,_container:null,_touchMoved:!1,_maxInset:null,_minInset:null,_bounceable:!1,_clippingToBounds:!1,_scrollDistance:null,_touchPoint:null,_touchLength:0,_touches:null,_viewSize:null,_minScale:0,_maxScale:0,_parentScissorRect:null,_scissorRestored:!1,_tmpViewRect:null,_touchListener:null,_className:"ScrollView",ctor:function(t,e){cc.Layer.prototype.ctor.call(this),this._contentOffset=cc.p(0,0),this._maxInset=cc.p(0,0),this._minInset=cc.p(0,0),this._scrollDistance=cc.p(0,0),this._touchPoint=cc.p(0,0),this._touches=[],this._viewSize=cc.size(0,0),this._parentScissorRect=new cc.Rect(0,0,0,0),this._tmpViewRect=new cc.Rect(0,0,0,0),null!=e?this.initWithViewSize(t,e):this.initWithViewSize(cc.size(200,200),null)},init:function(){return this.initWithViewSize(cc.size(200,200),null)},initWithViewSize:function(t,e){var i=cc.p(0,0);return!!cc.Layer.prototype.init.call(this)&&((e=e||this._container?e:new cc.Layer)&&this.setContainer(e),this.setViewSize(t),this.setTouchEnabled(!0),this._touches.length=0,this._delegate=null,this._clippingToBounds=this._bounceable=!0,this._direction=cc.SCROLLVIEW_DIRECTION_BOTH,this._container.setPosition(i),this._touchLength=0,this._minScale=this._maxScale=1,!0)},visit:function(t){var e=this._renderCmd,i=t?t._renderCmd:null;if(this._visible){t=cc.renderer,e.visit(i),this._clippingToBounds&&t.pushRenderCommand(e.startCmd);var n=this._children,s=n.length;if(0<s)for(this._reorderChildDirty&&this.sortAllChildren(),i=0;i<s;i++)n[i].visit(this);this._clippingToBounds&&t.pushRenderCommand(e.endCmd),e._dirtyFlag=0}else e._propagateFlagsDown(i)},setContentOffset:function(t,e){var i;e?this.setContentOffsetInDuration(t,BOUNCE_DURATION):(this._bounceable||(i=this.minContainerOffset(),e=this.maxContainerOffset(),t.x=Math.max(i.x,Math.min(e.x,t.x)),t.y=Math.max(i.y,Math.min(e.y,t.y))),this._container.setPosition(t),null!=(i=this._delegate)&&i.scrollViewDidScroll&&i.scrollViewDidScroll(this))},getContentOffset:function(){var t=this._container.getPosition();return cc.p(t.x,t.y)},setContentOffsetInDuration:function(t,e){e=cc.moveTo(e,t),t=cc.callFunc(this._stoppedAnimatedScroll,this);this._container.runAction(cc.sequence(e,t)),this.schedule(this._performedAnimatedScroll)},setZoomScale:function(t,e){var i,n;e?this.setZoomScaleInDuration(t,BOUNCE_DURATION):(e=this._container).getScale()!==t&&(i=0===this._touchLength?(i=this._viewSize,i=cc.p(.5*i.width,.5*i.height),this.convertToWorldSpace(i)):this._touchPoint,n=e.convertToNodeSpace(i),e.setScale(Math.max(this._minScale,Math.min(this._maxScale,t))),n=e.convertToWorldSpace(n),i=cc.pSub(i,n),this._delegate&&this._delegate.scrollViewDidZoom&&this._delegate.scrollViewDidZoom(this),this.setContentOffset(cc.pAdd(e.getPosition(),i)))},getZoomScale:function(){return this._container.getScale()},setZoomScaleInDuration:function(t,e){var i;0<e?(i=this._container.getScale())!==t&&(i=cc.actionTween(e,"zoomScale",i,t),this.runAction(i)):this.setZoomScale(t)},minContainerOffset:function(){var t=this._container,e=t.getContentSize(),i=this._viewSize;return cc.p(i.width-e.width*t.getScaleX(),i.height-e.height*t.getScaleY())},maxContainerOffset:function(){return cc.p(0,0)},isNodeVisible:function(t){var e=this.getContentOffset(),i=this.getViewSize(),n=this.getZoomScale(),e=cc.rect(-e.x/n,-e.y/n,i.width/n,i.height/n);return cc.rectIntersectsRect(e,t.getBoundingBox())},pause:function(t){this._container.pause(),t=this._container.getChildren();for(var e=0;e<t.length;e++)t[e].pause();this._super()},resume:function(t){for(var e=0,i=(t=this._container.getChildren()).length;e<i;e++)t[e].resume();this._container.resume(),this._super()},isDragging:function(){return this._dragging},isTouchMoved:function(){return this._touchMoved},isBounceable:function(){return this._bounceable},setBounceable:function(t){this._bounceable=t},getViewSize:function(){return this._viewSize},setViewSize:function(t){this._viewSize=t,cc.Node.prototype.setContentSize.call(this,t)},getContainer:function(){return this._container},setContainer:function(t){t&&(this.removeAllChildren(!0),(this._container=t).ignoreAnchorPointForPosition(!1),t.setAnchorPoint(0,0),this.addChild(t),this.setViewSize(this._viewSize))},getDirection:function(){return this._direction},setDirection:function(t){this._direction=t},getDelegate:function(){return this._delegate},setDelegate:function(t){this._delegate=t},onTouchBegan:function(t,e){for(var i=this;null!=i;i=i.parent)if(!i.isVisible())return!1;var i=this._getViewRect(),n=this._container,s=n.convertToWorldSpace(n.convertTouchToNodeSpace(t)),r=this._touches;return!(2<r.length||this._touchMoved||!cc.rectContainsPoint(i,s)||(r.push(t),1===r.length?(this._touchPoint=this.convertTouchToNodeSpace(t),this._touchMoved=!1,this._dragging=!0,this._scrollDistance.x=0,this._touchLength=this._scrollDistance.y=0):2===r.length&&(this._touchPoint=cc.pMidpoint(this.convertTouchToNodeSpace(r[0]),this.convertTouchToNodeSpace(r[1])),this._touchLength=cc.pDistance(n.convertTouchToNodeSpace(r[0]),n.convertTouchToNodeSpace(r[1])),this._dragging=!1),0))},onTouchMoved:function(t,e){if(this.isVisible())if(this.setNodeDirty(),1===this._touches.length&&this._dragging){this._touchMoved=!0,this._getViewRect();var i,n,s,t=this.convertTouchToNodeSpace(t),r=cc.pSub(t,this._touchPoint),o=0,a=this._direction;if(a===cc.SCROLLVIEW_DIRECTION_VERTICAL?(o=r.y,i=this._container.getPositionY(),this.minContainerOffset().y<=i&&i<=this.maxContainerOffset().y||(r.y*=BOUNCE_BACK_FACTOR)):a===cc.SCROLLVIEW_DIRECTION_HORIZONTAL?(o=r.x,i=this._container.getPositionX(),this.minContainerOffset().x<=i&&i<=this.maxContainerOffset().x||(r.x*=BOUNCE_BACK_FACTOR)):(o=Math.sqrt(r.x*r.x+r.y*r.y),i=this._container.getPositionY(),n=this.minContainerOffset(),s=this.maxContainerOffset(),n.y<=i&&i<=s.y||(r.y*=BOUNCE_BACK_FACTOR),i=this._container.getPositionX(),n.x<=i&&i<=s.x||(r.x*=BOUNCE_BACK_FACTOR)),(this._touchMoved||!(Math.abs(cc.convertDistanceFromPointToInch(o))<MOVE_INCH))&&(this._touchMoved||(r.x=0,r.y=0),this._touchPoint=t,this._touchMoved=!0,this._dragging)){switch(a){case cc.SCROLLVIEW_DIRECTION_VERTICAL:r.x=0;break;case cc.SCROLLVIEW_DIRECTION_HORIZONTAL:r.y=0}t=(o=this._container.getPosition()).x+r.x,o=o.y+r.y,this._scrollDistance=r,this.setContentOffset(cc.p(t,o))}}else 2!==this._touches.length||this._dragging||(r=cc.pDistance(this._container.convertTouchToNodeSpace(this._touches[0]),this._container.convertTouchToNodeSpace(this._touches[1])),this.setZoomScale(this.getZoomScale()*r/this._touchLength))},onTouchEnded:function(t,e){this.isVisible()&&(1===this._touches.length&&this._touchMoved&&this.schedule(this._deaccelerateScrolling),this._touches.length=0,this._touchMoved=this._dragging=!1)},onTouchCancelled:function(t,e){this.isVisible()&&(this._touches.length=0,this._touchMoved=this._dragging=!1)},setContentSize:function(t,e){null!==this.getContainer()&&(void 0===e?this.getContainer().setContentSize(t):this.getContainer().setContentSize(t,e),this.updateInset())},_setWidth:function(t){var e=this.getContainer();null!==e&&(e._setWidth(t),this.updateInset())},_setHeight:function(t){var e=this.getContainer();null!==e&&(e._setHeight(t),this.updateInset())},getContentSize:function(){return this._container.getContentSize()},updateInset:function(){var t,e;null!==this.getContainer()&&(t=this._viewSize,e=this.maxContainerOffset(),this._maxInset.x=e.x+t.width*INSET_RATIO,this._maxInset.y=e.y+t.height*INSET_RATIO,e=this.minContainerOffset(),this._minInset.x=e.x-t.width*INSET_RATIO,this._minInset.y=e.y-t.height*INSET_RATIO)},isClippingToBounds:function(){return this._clippingToBounds},setClippingToBounds:function(t){this._clippingToBounds=t},addChild:function(t,e,i){if(!t)throw Error("child must not nil!");e=e||t.getLocalZOrder(),i=i||t.getTag(),this._container!==t?this._container.addChild(t,e,i):cc.Layer.prototype.addChild.call(this,t,e,i)},isTouchEnabled:function(){return null!==this._touchListener},setTouchEnabled:function(t){this._touchListener&&cc.eventManager.removeListener(this._touchListener),this._touchListener=null,t?(t=cc.EventListener.create({event:cc.EventListener.TOUCH_ONE_BY_ONE}),this.onTouchBegan&&(t.onTouchBegan=this.onTouchBegan.bind(this)),this.onTouchMoved&&(t.onTouchMoved=this.onTouchMoved.bind(this)),this.onTouchEnded&&(t.onTouchEnded=this.onTouchEnded.bind(this)),this.onTouchCancelled&&(t.onTouchCancelled=this.onTouchCancelled.bind(this)),this._touchListener=t,cc.eventManager.addListener(t,this)):(this._touchMoved=this._dragging=!1,this._touches.length=0)},_initWithViewSize:function(t){return null},_relocateContainer:function(t){var e=this.minContainerOffset(),i=this.maxContainerOffset(),n=this._direction,s=this._container.getPosition(),r=s.x,o=s.y;n!==cc.SCROLLVIEW_DIRECTION_BOTH&&n!==cc.SCROLLVIEW_DIRECTION_HORIZONTAL||(r=Math.max(r,e.x),r=Math.min(r,i.x)),n!==cc.SCROLLVIEW_DIRECTION_BOTH&&n!==cc.SCROLLVIEW_DIRECTION_VERTICAL||(o=Math.min(o,i.y),o=Math.max(o,e.y)),o===s.y&&r===s.x||this.setContentOffset(cc.p(r,o),t)},_deaccelerateScrolling:function(t){var e,i,n,s;this._dragging?this.unschedule(this._deaccelerateScrolling):(e=this._container.getPosition(),t=this._scrollDistance,this._container.setPosition(e.x+t.x,e.y+t.y),i=this._bounceable?(e=this._maxInset,this._minInset):(e=this.maxContainerOffset(),this.minContainerOffset()),n=this._container.getPositionX(),s=this._container.getPositionY(),t.x*=SCROLL_DEACCEL_RATE,t.y*=SCROLL_DEACCEL_RATE,this.setContentOffset(cc.p(n,s)),(Math.abs(t.x)<=SCROLL_DEACCEL_DIST&&Math.abs(t.y)<=SCROLL_DEACCEL_DIST||s>e.y||s<i.y||n>e.x||n<i.x||n===e.x||n===i.x||s===e.y||s===i.y)&&(this.unschedule(this._deaccelerateScrolling),this._relocateContainer(!0)))},_performedAnimatedScroll:function(t){this._dragging?this.unschedule(this._performedAnimatedScroll):this._delegate&&this._delegate.scrollViewDidScroll&&this._delegate.scrollViewDidScroll(this)},_stoppedAnimatedScroll:function(t){this.unschedule(this._performedAnimatedScroll),this._delegate&&this._delegate.scrollViewDidScroll&&this._delegate.scrollViewDidScroll(this)},_handleZoom:function(){},_getViewRect:function(){for(var t=this.convertToWorldSpace(cc.p(0,0)),e=this._viewSize,i=this.getScaleX(),n=this.getScaleY(),s=this._parent;null!=s;s=s.getParent())i*=s.getScaleX(),n*=s.getScaleY();return i<0&&(t.x+=e.width*i,i=-i),n<0&&(t.y+=e.height*n,n=-n),(s=this._tmpViewRect).x=t.x,s.y=t.y,s.width=e.width*i,s.height=e.height*n,s},_createRenderCmd:function(){return new(cc._renderType===cc.game.RENDER_TYPE_CANVAS?cc.ScrollView.CanvasRenderCmd:cc.ScrollView.WebGLRenderCmd)(this)}}),_p=cc.ScrollView.prototype,cc.defineGetterSetter(_p,"minOffset",_p.minContainerOffset),cc.defineGetterSetter(_p,"maxOffset",_p.maxContainerOffset),cc.defineGetterSetter(_p,"bounceable",_p.isBounceable,_p.setBounceable),cc.defineGetterSetter(_p,"viewSize",_p.getViewSize,_p.setViewSize),cc.defineGetterSetter(_p,"container",_p.getContainer,_p.setContainer),cc.defineGetterSetter(_p,"direction",_p.getDirection,_p.setDirection),cc.defineGetterSetter(_p,"delegate",_p.getDelegate,_p.setDelegate),cc.defineGetterSetter(_p,"clippingToBounds",_p.isClippingToBounds,_p.setClippingToBounds),_p=null,cc.ScrollView.create=function(t,e){return new cc.ScrollView(t,e)},!function(){cc.ScrollView.CanvasRenderCmd=function(t){this._layerCmdCtor(t),this._needDraw=!1,this.startCmd=new cc.CustomRenderCmd(this,this._startCmd),this.startCmd._canUseDirtyRegion=!0,this.endCmd=new cc.CustomRenderCmd(this,this._endCmd),this.endCmd._canUseDirtyRegion=!0};var t=cc.ScrollView.CanvasRenderCmd.prototype=Object.create(cc.Layer.CanvasRenderCmd.prototype);t.constructor=cc.ScrollView.CanvasRenderCmd,t._startCmd=function(t,e,i){var n=this._node,s=t||cc._renderContext;t=s.getContext(),s.save(),n._clippingToBounds&&(this._scissorRestored=!1,s.setTransform(this._worldTransform,e,i),i=n.getScaleX(),e=n.getScaleY(),i*=n._viewSize.width,n=n._viewSize.height*e,t.beginPath(),t.rect(0,0,i,-n),t.closePath(),t.clip())},t._endCmd=function(t){(t=t||cc._renderContext).restore()}}(),!function(){cc.ScrollView.WebGLRenderCmd=function(t){this._layerCmdCtor(t),this._needDraw=!1,this.startCmd=new cc.CustomRenderCmd(this,this._startCmd),this.endCmd=new cc.CustomRenderCmd(this,this._endCmd)};var t=cc.ScrollView.WebGLRenderCmd.prototype=Object.create(cc.Layer.WebGLRenderCmd.prototype);t.constructor=cc.ScrollView.WebGLRenderCmd,t._startCmd=function(){var t,e,i,n=this._node,s=cc.view,r=n._getViewRect();s.isScissorEnabled()?(n._scissorRestored=!0,n._parentScissorRect=s.getScissorRect(),cc.rectIntersection(r,n._parentScissorRect)&&(t=n._parentScissorRect,n=Math.max(r.x,t.x),e=Math.max(r.y,t.y),i=Math.min(r.x+r.width,t.x+t.width),r=Math.min(r.y+r.height,t.y+t.height),s.setScissorInPoints(n,e,i-n,r-e))):((n=cc._renderContext).enable(n.SCISSOR_TEST),s.setScissorInPoints(r.x,r.y,r.width,r.height))},t._endCmd=function(){var t=this._node;t._scissorRestored?(t=t._parentScissorRect,cc.view.setScissorInPoints(t.x,t.y,t.width,t.height)):(t=cc._renderContext).disable(t.SCISSOR_TEST)}}(),cc.SortableObject=cc.Class.extend({setObjectID:function(t){},getObjectID:function(){return 0}}),cc.SortedObject=cc.SortableObject.extend({_objectID:0,ctor:function(){this._objectID=0},setObjectID:function(t){this._objectID=t},getObjectID:function(){return this._objectID}}),function(t,e){return t.getObjectID()-e.getObjectID()});function _0x2a88(){var t=["CurrentHP","PathSeed","BirthTime","SpawnBossFishResponse","SpawnCrowdedFish","SpawnCrowdedFishResponse","CatchRedFishResponse","UpdateBossHPResponse","BossDie","BossDieResponse","SpawnParadeFish_REALTIME","SpawnParadeFishResponse_REALTIME","HitFishEffect","HitFishEffectResponse","PingPong","PlayRoomEffect","PlayRoomEffectResponse","StopRoomEffect","StopRoomEffectResponse","GlobalBossUseSkill","GlobalBossUserSkillResponse","OnUserChatResponse","ListUserInDeskResponse_2D","SpawnParadeFishResponse_2D","SpawnFishResponse_2D","UserComeResponse_2D","SpawnCrowdedFishResponse_2D","Slot_FreeTicket","Slot_FreeTicketResponse","Slot_UpdateCurrentPoint","Slot_UpdateCurrentPointResponse","QuaySo_User_GetInfo","UserInfoResponse","trace","QuaySo_User_Roll_Result","RollingResultResponse","QuaySo_User_ConnectSuccess","ConnectSuccessResponse","QuaySo_ListItem","ListItemResponse","RollHistoryResponse","Slot_UserLoginResponse","Slot_ErrorMessage","Slot_ErrorMessageResponse","Slot_ResultResponse","Slot_UpdateBetValueResponse","Slot_UpdateJackpotResponse","Slot_BetHistoryResponse","Slot_TopWinResponse","Slot_WinJackpot","Slot_WinJackpotResponse","Slot_WinJackpot error","TaiXiu_GameInfo","GoldUserBetTai","GoldUserBetXiu","TotalTai","NumberUserBetTai","TotalXiu","NumberUserBetXiu","GameInfoResponse","TaiXiu_StartMatch","StartMatchResponse","TaiXiu_EndMatch","EndMatchResponse","BetResponse","ResultHistoryResponse","BetHistoryResponse","ChatResponse","TaiXiu_UpdateGold","UpdateGoldResponse","TaiXiu_UpdateBetValue","UpdateBetValueResponse","User","NumberOfWheel","WheelWidth","NumberOfLines","FreeSpin","FreeSpin_Value","LineResult","IsWinJackpot","PrevMatchID","DelayTime","FindBetValueByID","CheckFreeTicket","BetValue","SpinWheels","ResponseResult","Slot_FreeTicketValue","WheelValueConfig","FreeWheel","NormalWheel","CheckScatter","concat","RecordTopWin","CheckLine","CheckJackpotByLine","indexOf","Slot_TicketFromScatter","BetResultConfig","Exception","Line","IsOrdered","GetFreeTicket","AutoGenerateResultForFreeTicket","UpdateDBForAutoPlay","Slot_TopWinRatio","Slot_BetResultConfig","SQLAdapter","TopWinInsert","SendJackpotBroadCast","FormatNumber","Chúc mừng "," đã nổ hũ Xèng 777 nhận được "," Xu","GMToolAdapter","SendBroadCastMasterCommand","GMToolConfig","CMD","Notification","UpdateGoldForUserOutGame","GoldReward","LogResultInsert","UpdateStock","MaintainFlag","Logger","Game","error","JackpotManager.prototype.UpdateDBForAutoPlay Maintain with MatchID","GetFirstIndexForTestResult","Test_NormalResult","Test_FreeResult","MainTime","FishSpawnerTimers","ParadeFishSpawnerTimers","NonStopTimers","ClearExpiredFish","SecondTimer","ArrayStationNo","RoomID","RoomName","FishInfo","FishSpawner","IsSpecialScreen","BossFish","CurrentParadeFish","DEBUG","LimitFarmerMultiple","RoomEffect","CurrentRoomEffect","Freezed","BrainFreezeTimeOut","FISH_LIFE_CYCLE","FishParadeTimeOut","ReloadFishScript","timeMain","initRoomCore","initRoom","TimerLoop","ResetAllTimerTick","Tick","Interval","Wake","getTime","FindUserInDesk","SendAllPlayerExceptUserID","CheckBulletMultiple","GetFishDetailInDesk","IndexOfFishInDesk","RemoveFishInDesk","FISH_KIND_COUNT","CalcExp","OnUserKillFish","FindIndexOfFishInFishParade","CheckParadeIsEnd","EndParadeFish","OnUserRanOutMoney","OnCatchFishWithoutRemove","SpawnNormalFish","SpawnSmallFish","SpawnMediumFish","FindListFishByKindID","UpdateBossHP","ValueHP","Tài khoản đã hết tiền, vui lòng nạp thêm","ManageSpawnParade","Duration_2D","GetExpToNextLevel","ResetFishTimer","GetTimerWakeFunction","SpawnBigFish","SpawnGoldenFish","FindUserInDeskByUserID","FindPathInfo","PathConfig","PathInfo","PathID","SpawnCrowdedFish1","SpawnCrowdedFish1_2D","SpawnCrowdedFish_2D","BossDieEffect","GlobalBossFindByID","LastHitAwardValue","LastHitItemID","LastHitItemCount","ResetFishTimer_Group","SpawnFish_Group","NumberOfFish","IsCrowded","Path","MinY","MaxY","MinZ","MaxZ","SpawnNormalFish_Group_2D","SpawnFish_2D","BrainFreeze","AddRoomEffect","EffectID","EndEffect","PlayEffect","RemoveEffect","FireBySkill","ListSkill","UseSkillCatchFish","RoomFree.prototype.OnUseSkillCatchFish - try err: ","CalcSkillAppear","FishScriptConfig","SpawnEventFish","GetNewFishID","EventFish","FishMultiple","InitCount","Position","GeneratePosition","OnBossUseSkill","UserChat","ChatID","RoomCore.prototype.OnUserChat - try err: ","EndingThreshold","OnUserFire2D","OnCatchFishWithoutRemove2D","ProcessCatchFishWithoutRemove","EventID","NumberOfPathSeeds","DebugPath","PathSeed_LeftToRight","PathSeed_RightToLeft","Width","Height","DeviationX","Deviation_Min","Deviation_Max","MaximumZ","CurrentFishID","FishIDLimited","FishKindList","SmallFishList","MediumFishList","BigFishList","GoldenFishList","CrowdedFishList","SpecialFish","SpecialFish_2D","ParadeKind","CurrentParade","UZUMAKI","CurrentSceneKind","NumberOfSceneKind","CurrentParadeKind","FindFishConfigByFishKind","NormalFish","SpawnLineFish","TORNADO","SpawnTornadoParadeFish","SpawnSmallTornadoParadeFish","SpawnRedFish","RedFish","SpawnUzumakiParadeFish","MaxFishMultiple","STAR","SpawnStarParadeFish","SpawnNormalFish_Group","SpawnSpecialFish","CreateSpecialFish","PosX","PosY","BoundingBox","Direction","GeneratePosition_Group","GeneratePosition_Boss","SpawnParadeFish1","GetFishRedRatio","GetFishRedRule","SpawnParadeFish2","SpawnParadeFish3","SpawnParadeFish4","SpawnParadeFish5","SpawnParadeFish_2D","RedRatio","RedRule","apply","OnUserHitBoss","CatchRate","OnUserHitEventFish","IsActive","TimeUserKillFish","TimeLostSkill","ScoreLostSkill","SkillScorePool","AddSkillScore","SkillAppearResponse","ScoreGetSkill","CalcSkillEnd","SetSkill","CalcNextSkill","FindSkillIndexBySkillID","UseSkillResponse","LastedBulletID","PrevSkill","FindSkillBySkillID","UserCatchFish","NumberFishGet","CalcPowerGun","GoldLimit","TimerEndSkill","EndSkill","836208lXMBIX","578942eCZxRW","1767357TEyHXc","1734380gasHZQ","5MedXvz","25530AEiNJO","868EFiOUJ","1751576gxhDms","9YHMhcR","10gVofeo","7904193cvotQQ","exports","call","defineProperty","__esModule","default","prototype","hasOwnProperty","../","Define","StringDynamic","UInt32","UInt64","UInt8","Object8","Float","UInt16","Array8","AddHeader","Struct","GameInfo","ErrorMessage","StartMatch","EndMatch","UserBet","ResultHistory","BetHistory","TopWin","Chat","UpdateGold","UpdateBetValue","FishID","FishKind","BuildTick","Desk","Multiple","Ratio","undefined","ItemID","MaxMultiple","IsRedFish","CalcMultiple","GetFishMultiple","GetHit","round","random","Init","OnFishDie","floor","Msg","PacketID","QuaySo_User_Error_Message","ErrorMessageResponse","QuaySo_User_TopWin","ListPlayerWinResponse","CheckVariable","length","function","iterator","@@iterator","asyncIterator","@@asyncIterator","toStringTag","@@toStringTag","object","regeneratorRuntime","create","_invoke","wrap","normal","throw","suspendedStart","suspendedYield","executing","completed","getPrototypeOf","constructor","displayName","GeneratorFunction","next","return","forEach","isGeneratorFunction","name","mark","setPrototypeOf","__proto__","awrap","type","arg","value","__await","resolve","then","AsyncIterator","async","done","Generator is already running","method","delegate","sent","_sent","dispatchException","abrupt","The iterator does not provide a 'throw' method","iterator result is not an object","resultName","nextLoc","Generator","toString","[object Generator]","catchLoc","finallyLoc","afterLoc","tryEntries","push","completion","root","reset","keys","reverse","pop","values","prev","charAt","slice","rval","tryLoc","end","try statement without catch or finally","break","continue","complete","illegal catch attempt","return this","GameServer","GameServerID","DeskList","FishConfig","Run","Config","readyState","userController","ParadeFishConfig","myUser","ListItem","MoneyRequired","DiceFace","MatchState","State","PrepareTime","BetTime","CurrentTimer","now","TimeSwitchState","NumberOfDice","UpperEdge","TAI","XIU","SoTai","SoXiu","MatchID","ListUserBet","CreateTime","ResultArray","TotalGoldBetTai","TotalGoldBetXiu","NumberBetTai","NumberBetXiu","MAX_BET","MIN_BET","RewardRatio","TopResult","RequestDelay","BetValueList","BetValueConfig","TopBetHistory","TopWinHistory","TopWinner","Start","initGameServer","InitDesk","InitListDesk","GetRoomByKind","GameKindID","SecretKey","SecretIV","SendSocketBinary","onmessage","GetFishKindDetail","Kind","JoinDesk","AddUser","MyDesk","StartDeskWhenUserJoin","OnSendSkillInfo","onopen","onerror","onclose","close","send","processData","bind","requestId","loginMaster","joinGameServer","HandleMessage","botGame","127.0.0.1:3000","token","UserLoginGameServer","ConnectSuccess","UserInfo","Ticket","Gold","/Images/Item/",".png","UserGetInfo","Nickname","UserStartRolling","SendUserResult","ItemValues","History","RollingResult","GetTopUserWin","Nick","Item","Time","TopWinUser","TopUserWin","UserGetTopWin","UserGetHistory","RollHistory","OnLoginSuccess","Slot_BetValueList","Slot","Slot_UserLogin","FreeTicket","ScatterTicket","Slot_UpdateBetValue","OnUserSpin","CurrentState","data","BetID","BetValueID","OnUserGetHistory","Slot_History","Slot_UserGetHistory","OnUserGetJackpotValue","Slot_UpdateJackpot","OnUserGetTopWin","nick1","nick2","Slot_UserGetTopWin","RollTheDice","PrepareForNewMatch","PREPARE","StartBetting","ResetDataForNewMatch","BET","SendAllPlayer","EndBetting","END_MATCH","CalculateReward","CalculateResult","splice","OnUserBet","GoldBetTai","GoldBetXiu","UserID","StartMatchWhenUserCome","OnLoginSuccessTX","GetTotalGoldBet","GetTopResult","GetTopResultCoolDown","GetBetHistory","Dice1","Dice2","Dice3","GoldBet","Reward","UpdatedTime","GetTopWinCoolDown","OnUserChat","ChatCoolDown","LoadConfig","ReloadListBetValue","UpdateBetConfig","UpdateBetState","3D Free","Wild","Jackpot","Scatter","Cá ngựa Đỏ","Cá ngựa Xanh lá","Cá ngựa Xanh dương","Vương miện","Sao biển","Xí ngầu","Master","StartingGold","PrevGoldBetTai","PrevGoldBetXiu","IsLoggedIn","GetJackpotCoolDown","SetOnlineFlagStatus","NeedUpdateLeftDesk","IsUpdateLeftDesk","ScatterValue","FreeTicket_Start","Socket","ListFishDie","DeskID","StationID","LeftDesk","NickName","UserName","Exp","Level","IsUseSkill","FishScore","FishExp","FishLevel","BulletMultiple","TimeIn","PositionX","PositionY","FishHistory","TimeCheck","PingPongLost","ItemList","SkillModel","OnPong","CheckSocket","SetFishDie","IsNullOrUndefined","FishKindID","Amount","Score","RecordFish","RecordMoneyHistory","OnUserFireBullet","PopBulletWithValue","OnUserFireSkill","Laze","Điện","Bomb","loginGame","LoginGame","userLeft","UserLeft","UserModel","StopDeskWhenUserLeft","QuaySo_User_Login","QuaySo_User_StartRoll","QuaySo_User_History","CatchFish","OnCatchFish","UserFire","OnUserFire","Angle","LockedFishID","FireSkill","BinaryParser","FireSkillRequest","SkillCatchFish","OnUseSkillCatchFish","BulletID","SkillID","ListFish","CatchRedFish","CatchRedFishInfo","OnCatchRedFish","FishIDArray","Slot_UserSpin","TaiXiu_UserLogin","TaiXiu_UserBet","TaiXiu_ResultHistory","TaiXiu_BetHistory","TaiXiu_TopWin","TaiXiu_Chat","LoginResponse","ListUserInDesk","ListUserInDeskResponse","UserCome","UserComeResponse","ShowMsg","ShowMsgResponse","UserFireResponse","SpawnFish","SpawnFishResponse","CatchFishResponse","UserLeftResponse","SpawnParadeFish","SpawnParadeFishResponse","SendSkillInfo","SkillInfo","SkillAppear","ClearFish","KickUser","KickUserResponse","SpawnBossFish","MaxHP"];return(_0x2a88=function(){return t})()}function _0x2576(t,e){var i=_0x2a88();return(_0x2576=function(t,e){return i[t-=203]})(t,e)}cc.ArrayForObjectSorting=cc.Class.extend({_saveObjectArr:null,ctor:function(){this._saveObjectArr=[]},insertSortedObject:function(t){if(!t)throw Error("cc.ArrayForObjectSorting.insertSortedObject(): addObject should be non-null.");var e=this.indexOfSortedObject(t);this.insertObject(t,e)},removeSortedObject:function(t){var e;0!==this.count()&&(e=this.indexOfSortedObject(t))<this.count()&&e!==cc.INVALID_INDEX&&this.objectAtIndex(e).getObjectID()===t.getObjectID()&&this.removeObjectAtIndex(e)},setObjectID_ofSortedObject:function(t,e){var i,n=this.indexOfSortedObject(e);n<this.count()&&n!==cc.INVALID_INDEX&&(i=this.objectAtIndex(n)).getObjectID()===e.getObjectID()&&(this.removeObjectAtIndex(n),i.setObjectID(t),this.insertSortedObject(i))},objectWithObjectID:function(t){var e,i;return 0===this.count()||((e=new cc.SortedObject).setObjectID(t),(i=this.indexOfSortedObject(e))<this.count()&&i!==cc.INVALID_INDEX&&(e=this.objectAtIndex(i)).getObjectID()!==t)?null:e},getObjectWithObjectID:function(t){return null},indexOfSortedObject:function(t){var e=0;if(t){var i=0;t=t.getObjectID();for(var n=this._saveObjectArr,s=0;s<n.length;s++){var r=n[s].getObjectID();if(t===r||i<=t&&t<r)break;i=r,e++}}else e=cc.INVALID_INDEX;return e},count:function(){return this._saveObjectArr.length},lastObject:function(){var t=this._saveObjectArr;return 0===t.length?null:t[t.length-1]},objectAtIndex:function(t){return this._saveObjectArr[t]},addObject:function(t){this._saveObjectArr.push(t),this._saveObjectArr.sort(_compareObject)},removeObjectAtIndex:function(t){this._saveObjectArr.splice(t,1),this._saveObjectArr.sort(_compareObject)},insertObject:function(t,e){this._saveObjectArr.splice(e,0,t),this._saveObjectArr.sort(_compareObject)}}),cc.TABLEVIEW_FILL_TOPDOWN=0,cc.TABLEVIEW_FILL_BOTTOMUP=1,cc.TableViewCell=cc.Node.extend({_idx:0,_className:"TableViewCell",getIdx:function(){return this._idx},setIdx:function(t){this._idx=t},reset:function(){this._idx=cc.INVALID_INDEX},setObjectID:function(t){this._idx=t},getObjectID:function(){return this._idx}}),_p=cc.TableViewCell.prototype,cc.defineGetterSetter(_p,"objectId",_p.getObjectID,_p.setObjectID),_p=null,cc.TableViewDelegate=cc.ScrollViewDelegate.extend({tableCellTouched:function(t,e){},tableCellHighlight:function(t,e){},tableCellUnhighlight:function(t,e){},tableCellWillRecycle:function(t,e){}}),cc.TableViewDataSource=cc.Class.extend({tableCellSizeForIndex:function(t,e){return this.cellSizeForTable(t)},cellSizeForTable:function(t){return cc.size(0,0)},tableCellAtIndex:function(t,e){return null},numberOfCellsInTableView:function(t){return 0}}),cc.TableView=cc.ScrollView.extend({_vOrdering:null,_indices:null,_cellsFreed:null,_dataSource:null,_tableViewDelegate:null,_oldDirection:null,_cellsPositions:null,_touchedCell:null,ctor:function(t,e,i){cc.ScrollView.prototype.ctor.call(this),this._oldDirection=cc.SCROLLVIEW_DIRECTION_NONE,this._cellsPositions=[],this.initWithViewSize(e,i),this.setDataSource(t),this._updateCellPositions(),this._updateContentSize()},__indexFromOffset:function(t){var e=0,i=this._dataSource.numberOfCellsInTableView(this)-1;t=this.getDirection()===cc.SCROLLVIEW_DIRECTION_HORIZONTAL?t.x:t.y;for(var n=this._cellsPositions;e<=i;){var s=0|e+(i-e)/2,r=n[s],o=n[1+s];if(r<=t&&t<=o)return s;t<r?i=s-1:e=1+s}return e<=0?0:-1},_indexFromOffset:function(t){var e={x:t.x,y:t.y};return t=this._dataSource.numberOfCellsInTableView(this)-1,this._vOrdering===cc.TABLEVIEW_FILL_TOPDOWN&&(e.y=this.getContainer().getContentSize().height-e.y),e=-1!==(e=this.__indexFromOffset(e))&&t<(e=Math.max(0,e))?cc.INVALID_INDEX:e},__offsetFromIndex:function(t){return t=this.getDirection()===cc.SCROLLVIEW_DIRECTION_HORIZONTAL?cc.p(this._cellsPositions[t],0):cc.p(0,this._cellsPositions[t])},_offsetFromIndex:function(t){var e=this.__offsetFromIndex(t);return t=this._dataSource.tableCellSizeForIndex(this,t),this._vOrdering===cc.TABLEVIEW_FILL_TOPDOWN&&(e.y=this.getContainer().getContentSize().height-e.y-t.height),e},_updateCellPositions:function(){var t=this._dataSource.numberOfCellsInTableView(this),e=this._cellsPositions;if(0<t){for(var i,n=0,s=this._dataSource,r=0;r<t;r++)e[r]=n,i=s.tableCellSizeForIndex(this,r),this.getDirection()===cc.SCROLLVIEW_DIRECTION_HORIZONTAL?n+=i.width:n+=i.height;this._cellsPositions[t]=n}},_updateContentSize:function(){var t=cc.size(0,0),e=this._dataSource.numberOfCellsInTableView(this);0<e&&(t=this._cellsPositions[e],t=this.getDirection()===cc.SCROLLVIEW_DIRECTION_HORIZONTAL?cc.size(t,this._viewSize.height):cc.size(this._viewSize.width,t)),this.setContentSize(t),this._oldDirection!==this._direction&&(this._direction===cc.SCROLLVIEW_DIRECTION_HORIZONTAL?this.setContentOffset(cc.p(0,0)):this.setContentOffset(cc.p(0,this.minContainerOffset().y)),this._oldDirection=this._direction)},_moveCellOutOfSight:function(t){this._tableViewDelegate&&this._tableViewDelegate.tableCellWillRecycle&&this._tableViewDelegate.tableCellWillRecycle(this,t),this._cellsFreed.addObject(t),this._cellsUsed.removeSortedObject(t),cc.arrayRemoveObject(this._indices,t.getIdx()),t.reset(),t.getParent()===this.getContainer()&&this.getContainer().removeChild(t,!0)},_setIndexForCell:function(t,e){e.setAnchorPoint(0,0),e.setPosition(this._offsetFromIndex(t)),e.setIdx(t)},_addCellIfNecessary:function(t){t.getParent()!==this.getContainer()&&this.getContainer().addChild(t),this._cellsUsed.insertSortedObject(t);var e=this._indices;t=t.getIdx(),-1===e.indexOf(t)&&(e.push(t),e.sort(function(t,e){return t-e}))},getDataSource:function(){return this._dataSource},setDataSource:function(t){this._dataSource=t},getDelegate:function(){return this._tableViewDelegate},setDelegate:function(t){this._tableViewDelegate=t},setVerticalFillOrder:function(t){this._vOrdering!==t&&(this._vOrdering=t,0<this._cellsUsed.count())&&this.reloadData()},getVerticalFillOrder:function(){return this._vOrdering},initWithViewSize:function(t,e){return!!cc.ScrollView.prototype.initWithViewSize.call(this,t,e)&&(this._cellsUsed=new cc.ArrayForObjectSorting,this._cellsFreed=new cc.ArrayForObjectSorting,this._indices=[],this._tableViewDelegate=null,this._vOrdering=cc.TABLEVIEW_FILL_BOTTOMUP,this.setDirection(cc.SCROLLVIEW_DIRECTION_VERTICAL),cc.ScrollView.prototype.setDelegate.call(this,this),!0)},updateCellAtIndex:function(t){var e;t===cc.INVALID_INDEX||t>this._dataSource.numberOfCellsInTableView(this)-1||((e=this.cellAtIndex(t))&&this._moveCellOutOfSight(e),e=this._dataSource.tableCellAtIndex(this,t),this._setIndexForCell(t,e),this._addCellIfNecessary(e))},insertCellAtIndex:function(t){if(!(t===cc.INVALID_INDEX||t>this._dataSource.numberOfCellsInTableView(this)-1)){var e,i=this._cellsUsed;if(e=i.objectWithObjectID(t))for(var n=e=i.indexOfSortedObject(e);n<i.count();n++)e=i.objectAtIndex(n),this._setIndexForCell(e.getIdx()+1,e);e=this._dataSource.tableCellAtIndex(this,t),this._setIndexForCell(t,e),this._addCellIfNecessary(e),this._updateCellPositions(),this._updateContentSize()}},removeCellAtIndex:function(t){if(!(t===cc.INVALID_INDEX||t>this._dataSource.numberOfCellsInTableView(this)-1)){var e=this.cellAtIndex(t);if(e){var i=this._cellsUsed,n=i.indexOfSortedObject(e);for(this._moveCellOutOfSight(e),cc.arrayRemoveObject(this._indices,t),this._updateCellPositions(),t=i.count()-1;n<t;t--)e=i.objectAtIndex(t),this._setIndexForCell(e.getIdx()-1,e)}}},reloadData:function(){this._oldDirection=cc.SCROLLVIEW_DIRECTION_NONE;for(var t=this._cellsUsed,e=this._cellsFreed,i=this.getContainer(),n=0,s=t.count();n<s;n++){var r=t.objectAtIndex(n);this._tableViewDelegate&&this._tableViewDelegate.tableCellWillRecycle&&this._tableViewDelegate.tableCellWillRecycle(this,r),e.addObject(r),r.reset(),r.getParent()===i&&i.removeChild(r,!0)}this._indices=[],this._cellsUsed=new cc.ArrayForObjectSorting,this._updateCellPositions(),this._updateContentSize(),0<this._dataSource.numberOfCellsInTableView(this)&&this.scrollViewDidScroll(this),this.setNodeDirty()},dequeueCell:function(){var t;return 0===this._cellsFreed.count()?null:(t=this._cellsFreed.objectAtIndex(0),this._cellsFreed.removeObjectAtIndex(0),t)},cellAtIndex:function(t){return-1===this._indices.indexOf(t)?null:this._cellsUsed.objectWithObjectID(t)},scrollViewDidScroll:function(t){var e=this._dataSource.numberOfCellsInTableView(this);if(0!==e){null!==this._tableViewDelegate&&this._tableViewDelegate.scrollViewDidScroll&&this._tableViewDelegate.scrollViewDidScroll(this);var i=0,n=this._viewSize,i=this.getContainer(),s=this.getContentOffset(),r=(s.x*=-1,s.y*=-1,Math.max(e-1,0));if(this._vOrdering===cc.TABLEVIEW_FILL_TOPDOWN&&(s.y+=n.height/i.getScaleY()),(t=this._indexFromOffset(s))===cc.INVALID_INDEX&&(t=e-1),s.y=this._vOrdering===cc.TABLEVIEW_FILL_TOPDOWN?s.y-n.height/i.getScaleY():s.y+n.height/i.getScaleY(),s.x+=n.width/i.getScaleX(),(n=this._indexFromOffset(s))===cc.INVALID_INDEX&&(n=e-1),0<(s=this._cellsUsed).count())for(i=(e=s.objectAtIndex(0)).getIdx();i<t&&(this._moveCellOutOfSight(e),0<s.count());)i=(e=s.objectAtIndex(0)).getIdx();if(0<s.count())for(i=(e=s.lastObject()).getIdx();i<=r&&n<i&&(this._moveCellOutOfSight(e),0<s.count());)i=(e=s.lastObject()).getIdx();for(r=this._indices;t<=n;t++)-1===r.indexOf(t)&&this.updateCellAtIndex(t)}},scrollViewDidZoom:function(t){},onTouchEnded:function(t,e){var i,n;this.isVisible()&&(this._touchedCell&&(i=this.getBoundingBox(),n=cc.p(i.x,i.y),n=this._parent.convertToWorldSpace(n),i.x=n.x,i.y=n.y,n=this._tableViewDelegate,cc.rectContainsPoint(i,t.getLocation())&&null!==n&&(n.tableCellUnhighlight&&n.tableCellUnhighlight(this,this._touchedCell),n.tableCellTouched)&&n.tableCellTouched(this,this._touchedCell),this._touchedCell=null),cc.ScrollView.prototype.onTouchEnded.call(this,t,e))},onTouchBegan:function(t,e){for(var i=this;null!=i;i=i.parent)if(!i.isVisible())return!1;return i=cc.ScrollView.prototype.onTouchBegan.call(this,t,e),1===this._touches.length?(e=this.getContainer().convertTouchToNodeSpace(t),e=this._indexFromOffset(e),(this._touchedCell=e===cc.INVALID_INDEX?null:this.cellAtIndex(e))&&null!==this._tableViewDelegate&&this._tableViewDelegate.tableCellHighlight&&this._tableViewDelegate.tableCellHighlight(this,this._touchedCell)):this._touchedCell&&(null!==this._tableViewDelegate&&this._tableViewDelegate.tableCellUnhighlight&&this._tableViewDelegate.tableCellUnhighlight(this,this._touchedCell),this._touchedCell=null),i},onTouchMoved:function(t,e){cc.ScrollView.prototype.onTouchMoved.call(this,t,e),this._touchedCell&&this.isTouchMoved()&&(null!==this._tableViewDelegate&&this._tableViewDelegate.tableCellUnhighlight&&this._tableViewDelegate.tableCellUnhighlight(this,this._touchedCell),this._touchedCell=null)},onTouchCancelled:function(t,e){cc.ScrollView.prototype.onTouchCancelled.call(this,t,e),this._touchedCell&&(null!==this._tableViewDelegate&&this._tableViewDelegate.tableCellUnhighlight&&this._tableViewDelegate.tableCellUnhighlight(this,this._touchedCell),this._touchedCell=null)}}),_p=cc.TableView.prototype,cc.defineGetterSetter(_p,"dataSource",_p.getDataSource,_p.setDataSource),cc.defineGetterSetter(_p,"delegate",_p.getDelegate,_p.setDelegate),cc.defineGetterSetter(_p,"verticalFillOrder",_p.getVerticalFillOrder,_p.setVerticalFillOrder),_p=null,cc.TableView.create=function(t,e,i){return new cc.TableView(t,e,i)},cc.KEYBOARD_RETURNTYPE_DEFAULT=0,cc.KEYBOARD_RETURNTYPE_DONE=1,cc.KEYBOARD_RETURNTYPE_SEND=2,cc.KEYBOARD_RETURNTYPE_SEARCH=3,cc.KEYBOARD_RETURNTYPE_GO=4,cc.EDITBOX_INPUT_MODE_ANY=0,cc.EDITBOX_INPUT_MODE_EMAILADDR=1,cc.EDITBOX_INPUT_MODE_NUMERIC=2,cc.EDITBOX_INPUT_MODE_PHONENUMBER=3,cc.EDITBOX_INPUT_MODE_URL=4,cc.EDITBOX_INPUT_MODE_DECIMAL=5,cc.EDITBOX_INPUT_MODE_SINGLELINE=6,cc.EDITBOX_INPUT_FLAG_PASSWORD=0,cc.EDITBOX_INPUT_FLAG_SENSITIVE=1,cc.EDITBOX_INPUT_FLAG_INITIAL_CAPS_WORD=2,cc.EDITBOX_INPUT_FLAG_INITIAL_CAPS_SENTENCE=3,cc.EDITBOX_INPUT_FLAG_INITIAL_CAPS_ALL_CHARACTERS=4,cc.EditBoxDelegate=cc.Class.extend({editBoxEditingDidBegin:function(t){},editBoxEditingDidEnd:function(t){},editBoxTextChanged:function(t,e){},editBoxReturn:function(t){}}),cc.EditBox=cc.Node.extend({_backgroundSprite:null,_delegate:null,_editBoxInputMode:cc.EDITBOX_INPUT_MODE_ANY,_editBoxInputFlag:cc.EDITBOX_INPUT_FLAG_SENSITIVE,_keyboardReturnType:cc.KEYBOARD_RETURNTYPE_DEFAULT,_maxLength:50,_text:"",_textColor:null,_placeholderText:"",_placeholderFontName:"",_placeholderFontSize:14,_placeholderColor:null,_className:"EditBox",_touchListener:null,_touchEnabled:!0,ctor:function(t,e){cc.Node.prototype.ctor.call(this),this._anchorPoint=cc.p(.5,.5),this._textColor=cc.color.WHITE,this._placeholderColor=cc.color.GRAY,this._renderCmd._createLabels(),this.createDomElementIfNeeded(),this.initWithSizeAndBackgroundSprite(t,e),this._touchListener=cc.EventListener.create({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:this._onTouchBegan.bind(this),onTouchEnded:this._onTouchEnded.bind(this)}),cc.eventManager.addListener(this._touchListener,this),this.setInputFlag(this._editBoxInputFlag)},setTouchEnabled:function(t){this._touchEnabled!==t&&((this._touchEnabled=t)?cc.eventManager.addListener(this._touchListener,this):cc.eventManager.removeListener(this._touchListener))},_createRenderCmd:function(){return new(cc._renderType===cc.game.RENDER_TYPE_CANVAS?cc.EditBox.CanvasRenderCmd:cc.EditBox.WebGLRenderCmd)(this)},setContentSize:function(t,e){void 0!==t.width&&void 0!==t.height&&(e=t.height,t=t.width),cc.Node.prototype.setContentSize.call(this,t,e),this._updateEditBoxSize(t,e)},setVisible:function(t){cc.Node.prototype.setVisible.call(this,t),this._renderCmd.updateVisibility()},createDomElementIfNeeded:function(){this._renderCmd._edTxt||this._renderCmd._createDomTextArea()},setTabIndex:function(t){this._renderCmd._edTxt&&(this._renderCmd._edTxt.tabIndex=t)},getTabIndex:function(){return this._renderCmd._edTxt?this._renderCmd._edTxt.tabIndex:(cc.warn("The dom control is not created!"),-1)},setFocus:function(){this._renderCmd._edTxt&&this._renderCmd._edTxt.focus()},isFocused:function(){return this._renderCmd._edTxt?document.activeElement===this._renderCmd._edTxt:(cc.warn("The dom control is not created!"),!1)},stayOnTop:function(t){this._alwaysOnTop!==t&&(this._alwaysOnTop=t,this._renderCmd.stayOnTop(this._alwaysOnTop))},cleanup:function(){this._super(),this._renderCmd._removeDomFromGameContainer()},_isAncestorsVisible:function(t){return null==t||!((t=t.getParent())&&!t.isVisible())&&this._isAncestorsVisible(t)},_onTouchBegan:function(t){var e;if(this.isVisible()&&this._isAncestorsVisible(this))return t=t.getLocation(),e=cc.rect(0,0,this._contentSize.width,this._contentSize.height),!!cc.rectContainsPoint(e,this.convertToNodeSpace(t))||(this._renderCmd._endEditing(),!1)},_onTouchEnded:function(){this.isVisible()&&this._isAncestorsVisible(this)&&this._renderCmd._beginEditing()},_updateBackgroundSpriteSize:function(t,e){this._backgroundSprite&&this._backgroundSprite.setContentSize(t,e)},_updateEditBoxSize:function(t,e){var i="number"==typeof t.width?t.width:t,t="number"==typeof t.height?t.height:e;this._updateBackgroundSpriteSize(i,t),this._renderCmd.updateSize(i,t)},setLineHeight:function(t){this._renderCmd.setLineHeight(t)},setFont:function(t,e){this._renderCmd.setFont(t,e)},_setFont:function(t){this._renderCmd._setFont(t)},getBackgroundSprite:function(){return this._backgroundSprite},setFontName:function(t){this._renderCmd.setFontName(t)},setFontSize:function(t){this._renderCmd.setFontSize(t)},setString:function(t){t.length>=this._maxLength&&(t=t.slice(0,this._maxLength)),this._text=t,this._renderCmd.setString(t)},setFontColor:function(t){this._textColor=t,this._renderCmd.setFontColor(t)},setMaxLength:function(t){isNaN(t)||(this._maxLength=t=t<0?65535:t,this._renderCmd.setMaxLength(t))},getMaxLength:function(){return this._maxLength},setPlaceHolder:function(t){null!==t&&(this._renderCmd.setPlaceHolder(t),this._placeholderText=t)},setPlaceholderFont:function(t,e){this._placeholderFontName=t,this._placeholderFontSize=e,this._renderCmd._updateDOMPlaceholderFontStyle()},_setPlaceholderFont:function(t){(t=cc.LabelTTF._fontStyleRE.exec(t))&&(this._placeholderFontName=t[2],this._placeholderFontSize=parseInt(t[1]),this._renderCmd._updateDOMPlaceholderFontStyle())},setPlaceholderFontName:function(t){this._placeholderFontName=t,this._renderCmd._updateDOMPlaceholderFontStyle()},setPlaceholderFontSize:function(t){this._placeholderFontSize=t,this._renderCmd._updateDOMPlaceholderFontStyle()},setPlaceholderFontColor:function(t){this._placeholderColor=t,this._renderCmd.setPlaceholderFontColor(t)},setInputFlag:function(t){this._editBoxInputFlag=t,this._renderCmd.setInputFlag(t)},getString:function(){return this._text},initWithSizeAndBackgroundSprite:function(t,e){return this._backgroundSprite&&this._backgroundSprite.removeFromParent(),this._backgroundSprite=e,this.setContentSize(t),this._backgroundSprite&&!this._backgroundSprite.parent&&(this._backgroundSprite.setAnchorPoint(cc.p(0,0)),this.addChild(this._backgroundSprite),this._updateBackgroundSpriteSize(t.width,t.height)),!(this.y=this.x=0)},setDelegate:function(t){this._delegate=t},getPlaceHolder:function(){return this._placeholderText},setInputMode:function(t){var e;this._editBoxInputMode!==t&&(e=this.getString(),this._editBoxInputMode=t,this._renderCmd.setInputMode(t),this._renderCmd.transform(),this.setString(e),this._renderCmd._updateLabelPosition(this.getContentSize()))},setReturnType:function(t){this._keyboardReturnType=t,this._renderCmd._updateDomInputType()},initWithBackgroundColor:function(t,e){this._edWidth=t.width,this.dom.style.width=this._edWidth.toString()+"px",this._edHeight=t.height,this.dom.style.height=this._edHeight.toString()+"px",this.dom.style.backgroundColor=cc.colorToHex(e)}}),_p=cc.EditBox.prototype,cc.defineGetterSetter(_p,"font",null,_p._setFont),cc.defineGetterSetter(_p,"fontName",null,_p.setFontName),cc.defineGetterSetter(_p,"fontSize",null,_p.setFontSize),cc.defineGetterSetter(_p,"fontColor",null,_p.setFontColor),cc.defineGetterSetter(_p,"string",_p.getString,_p.setString),cc.defineGetterSetter(_p,"maxLength",_p.getMaxLength,_p.setMaxLength),cc.defineGetterSetter(_p,"placeholder",_p.getPlaceHolder,_p.setPlaceHolder),cc.defineGetterSetter(_p,"placeholderFont",null,_p._setPlaceholderFont),cc.defineGetterSetter(_p,"placeholderFontName",null,_p.setPlaceholderFontName),cc.defineGetterSetter(_p,"placeholderFontSize",null,_p.setPlaceholderFontSize),cc.defineGetterSetter(_p,"placeholderFontColor",null,_p.setPlaceholderFontColor),cc.defineGetterSetter(_p,"inputFlag",null,_p.setInputFlag),cc.defineGetterSetter(_p,"delegate",null,_p.setDelegate),cc.defineGetterSetter(_p,"inputMode",null,_p.setInputMode),cc.defineGetterSetter(_p,"returnType",null,_p.setReturnType),_p=null,cc.EditBox.create=function(t,e,i,n){return new cc.EditBox(t,e,i,n)},!function(t){t._polyfill={zoomInvalid:!1},cc.sys.OS_ANDROID!==cc.sys.os||cc.sys.browserType!==cc.sys.BROWSER_TYPE_SOUGOU&&cc.sys.browserType!==cc.sys.BROWSER_TYPE_360||(t._polyfill.zoomInvalid=!0)}(cc.EditBox),!function(l){function i(t){var e=t.convertToWorldSpace(cc.p(0,0)),i=cc.visibleRect.height,n=.5;cc.visibleRect.width>i&&(n=.7),setTimeout(function(){var t;window.scrollY<40&&e.y<i*n&&(320<(t=(t=i*n-e.y-window.scrollY)<35?35:t)&&(t=320),window.scrollTo(t,t))},400)}var t=Object.create(Object.prototype),e=(t.updateMatrix=function(){var t,e,i,n,s,r,o,a,c,h;this._edTxt&&(t=this._node,c=cc.view._scaleX,h=cc.view._scaleY,i=cc.view._devicePixelRatio,e=this._worldTransform,h/=i,a=cc.game.container,i=e.a*(c=c/i),n=e.b,s=e.c,r=e.d*h,o=a&&a.style.paddingLeft&&parseInt(a.style.paddingLeft),a=a&&a.style.paddingBottom&&parseInt(a.style.paddingBottom),c=e.tx*c+o,h=e.ty*h+a,l.zoomInvalid&&(this.updateSize(t._contentSize.width*i,t._contentSize.height*r),r=i=1),this._edTxt.style.transform=t="matrix("+i+","+-n+","+-s+","+r+","+c+","+-h+")",this._edTxt.style["-webkit-transform"]=t,this._edTxt.style["transform-origin"]="0px 100% 0px",this._edTxt.style["-webkit-transform-origin"]="0px 100% 0px")},t.updateVisibility=function(){this._edTxt&&(this._edTxt.style.visibility=this._node.visible?"visible":"hidden")},t.stayOnTop=function(t){t?(this._removeLabels(),this._edTxt.style.display=""):(this._createLabels(),this._edTxt.style.display="none",this._showLabels())},t._beginEditingOnMobile=function(t){this.__orientationChanged=function(){i(t)},window.addEventListener("orientationchange",this.__orientationChanged),cc.view.isAutoFullScreenEnabled()?(this.__fullscreen=!0,cc.view.enableAutoFullScreen(!1),cc.screen.exitFullScreen()):this.__fullscreen=!1,this.__autoResize=cc.view.__resizeWithBrowserSize,cc.view.resizeWithBrowserSize(!1)},t._endEditingOnMobile=function(){var t,e,i;this.__rotateScreen&&((t=cc.game.container.style)["-webkit-transform"]="rotate(90deg)",t.transform="rotate(90deg)",e=(t=cc.view)._originalDesignResolutionSize.width,i=t._originalDesignResolutionSize.height,0<e&&t.setDesignResolutionSize(e,i,t._resolutionPolicy),this.__rotateScreen=!1),window.removeEventListener("orientationchange",this.__orientationChanged),window.scrollTo(0,0),this.__fullscreen&&cc.view.enableAutoFullScreen(!0),this.__autoResize&&cc.view.resizeWithBrowserSize(!0)},t._onFocusOnMobile=function(t){var e;cc.view._isRotated?((e=cc.game.container.style)["-webkit-transform"]="rotate(0deg)",e.transform="rotate(0deg)",e.margin="0px",window.scrollTo(35,35),this.__rotateScreen=!0):this.__rotateScreen=!1,i(t)},t._createDomInput=function(){this._removeDomFromGameContainer();var i=this,t=this._edTxt=document.createElement("input");return t.type="text",t.style.fontFamily=this._edFontName,t.style.fontSize=this._edFontSize+"px",t.style.color="#000000",t.style.border=0,t.style.background="transparent",t.style.width="100%",t.style.height="100%",t.style.active=0,t.style.outline="medium",t.style.padding="0",t.style.display="none",t.setAttribute("autocapitalize","none"),t.style.position="absolute",t.style.bottom="0px",t.style.left="2px",t.style.className="cocosEditBox",this.setMaxLength(i._editBox._maxLength),t.addEventListener("input",function(){var t=i._editBox;this.value.length>this.maxLength&&(this.value=this.value.slice(0,this.maxLength)),t._delegate&&t._delegate.editBoxTextChanged&&t._text!==this.value&&(t._text=this.value,i._updateDomTextCases(),t._delegate.editBoxTextChanged(t,t._text))}),t.addEventListener("keypress",function(t){var e=i._editBox;t.keyCode===cc.KEY.enter&&(t.stopPropagation(),t.preventDefault(),""===this.value&&(this.style.fontSize=e._placeholderFontSize+"px",this.style.color=cc.colorToHex(e._placeholderColor)),e._text=this.value,i._updateDomTextCases(),i._endEditing(),e._delegate&&e._delegate.editBoxReturn&&e._delegate.editBoxReturn(e),cc._canvas.focus())}),t.addEventListener("focus",function(){var t=i._editBox;this.style.fontSize=i._edFontSize+"px",this.style.color=cc.colorToHex(t._textColor),i._hiddenLabels(),cc.sys.isMobile&&i._onFocusOnMobile(t),t._delegate&&t._delegate.editBoxEditingDidBegin&&t._delegate.editBoxEditingDidBegin(t)}),t.addEventListener("blur",function(){var t=i._editBox;t._text=this.value,i._updateDomTextCases(),t._delegate&&t._delegate.editBoxEditingDidEnd&&t._delegate.editBoxEditingDidEnd(t),""===this.value&&(this.style.fontSize=t._placeholderFontSize+"px",this.style.color=cc.colorToHex(t._placeholderColor)),i._endEditing()}),this._addDomToGameContainer(),t},t._createDomTextArea=function(){this._removeDomFromGameContainer();var i=this,t=this._edTxt=document.createElement("textarea");return t.type="text",t.style.fontFamily=this._edFontName,t.style.fontSize=this._edFontSize+"px",t.style.color="#000000",t.style.border=0,t.style.background="transparent",t.style.width="100%",t.style.height="100%",t.style.active=0,t.style.outline="medium",t.style.padding="0",t.style.resize="none",t.style.textTransform="uppercase",t.style.overflow_y="scroll",t.style.display="none",t.style.position="absolute",t.style.bottom="0px",t.style.left="2px",t.style.className="cocosEditBox",this.setMaxLength(i._editBox._maxLength),t.addEventListener("input",function(){this.value.length>this.maxLength&&(this.value=this.value.slice(0,this.maxLength));var t=i._editBox;t._delegate&&t._delegate.editBoxTextChanged&&t._text.toLowerCase()!==this.value.toLowerCase()&&(t._text=this.value,i._updateDomTextCases(),t._delegate.editBoxTextChanged(t,t._text))}),t.addEventListener("focus",function(){var t=i._editBox;i._hiddenLabels(),this.style.fontSize=i._edFontSize+"px",this.style.color=cc.colorToHex(t._textColor),cc.sys.isMobile&&i._onFocusOnMobile(t),t._delegate&&t._delegate.editBoxEditingDidBegin&&t._delegate.editBoxEditingDidBegin(t)}),t.addEventListener("keypress",function(t){var e=i._editBox;t.keyCode===cc.KEY.enter&&(t.stopPropagation(),e._delegate)&&e._delegate.editBoxReturn&&e._delegate.editBoxReturn(e)}),t.addEventListener("blur",function(){var t=i._editBox;t._text=this.value,i._updateDomTextCases(),t._delegate&&t._delegate.editBoxEditingDidEnd&&t._delegate.editBoxEditingDidEnd(t),""===this.value&&(this.style.fontSize=t._placeholderFontSize+"px",this.style.color=cc.colorToHex(t._placeholderColor)),i._endEditing()}),this._addDomToGameContainer(),t},t._createLabels=function(){var t=this._editBox.getContentSize();this._textLabel||(this._textLabel=new cc.LabelTTF,this._textLabel.setAnchorPoint(cc.p(0,1)),this._editBox.addChild(this._textLabel,100)),this._placeholderLabel||(this._placeholderLabel=new cc.LabelTTF,this._placeholderLabel.setAnchorPoint(cc.p(0,1)),this._placeholderLabel.setColor(cc.color.GRAY),this._editBox.addChild(this._placeholderLabel,100)),this._updateLabelPosition(t)},t._removeLabels=function(){this._textLabel&&(this._editBox.removeChild(this._textLabel),this._textLabel=null)},t._updateLabelPosition=function(t){var e;this._textLabel&&this._placeholderLabel&&(e=cc.size(t.width-2,t.height),this._textLabel.setContentSize(e),this._textLabel.setDimensions(e),this._placeholderLabel.setLineHeight(t.height),e=this._placeholderLabel.getContentSize(),this._editBox._editBoxInputMode===cc.EDITBOX_INPUT_MODE_ANY?(this._textLabel.setPosition(2,t.height),this._placeholderLabel.setPosition(2,t.height),this._placeholderLabel.setVerticalAlignment(cc.VERTICAL_TEXT_ALIGNMENT_TOP),this._textLabel.setVerticalAlignment(cc.VERTICAL_TEXT_ALIGNMENT_TOP)):(this._textLabel.setPosition(2,t.height),this._placeholderLabel.setPosition(2,(t.height+e.height)/2),this._placeholderLabel.setVerticalAlignment(cc.VERTICAL_TEXT_ALIGNMENT_CENTER),this._textLabel.setVerticalAlignment(cc.VERTICAL_TEXT_ALIGNMENT_CENTER)))},t.setLineHeight=function(t){this._textLabel&&this._textLabel.setLineHeight(t)},t._hiddenLabels=function(){this._textLabel&&this._textLabel.setVisible(!1),this._placeholderLabel&&this._placeholderLabel.setVisible(!1)},t._updateDomTextCases=function(){var t,e=this._editBox._editBoxInputFlag;e===cc.EDITBOX_INPUT_FLAG_INITIAL_CAPS_ALL_CHARACTERS?this._editBox._text=this._editBox._text.toUpperCase():e===cc.EDITBOX_INPUT_FLAG_INITIAL_CAPS_WORD?this._editBox._text=this._editBox._text.replace(/(?:^|\s)\S/g,function(t){return t.toUpperCase()}):e===cc.EDITBOX_INPUT_FLAG_INITIAL_CAPS_SENTENCE&&(e=this._editBox,t=(t=this._editBox._text).charAt(0).toUpperCase()+t.slice(1),e._text=t)},t._updateLabelStringStyle=function(){if("password"===this._edTxt.type){for(var t="",e=this._editBox._text.length,i=0;i<e;++i)t+="●";this._textLabel&&this._textLabel.setString(t)}else this._updateDomTextCases(),this._textLabel&&this._textLabel.setString(this._editBox._text)},t._showLabels=function(){this._hiddenLabels(),""===this._edTxt.value?this._placeholderLabel&&(this._placeholderLabel.setVisible(!0),this._placeholderLabel.setString(this._editBox._placeholderText)):this._textLabel&&(this._textLabel.setVisible(!0),this._textLabel.setString(this._editBox._text)),this._updateLabelStringStyle()},t._beginEditing=function(){this._editBox._alwaysOnTop||"none"!==this._edTxt.style.display||(this._edTxt.style.display="",this._edTxt.focus()),cc.sys.isMobile&&!this._editingMode&&this._beginEditingOnMobile(this._editBox),this._editingMode=!0},t._endEditing=function(){var t;this._editBox._alwaysOnTop||(this._edTxt.style.display="none"),this._showLabels(),cc.sys.isMobile&&this._editingMode&&(t=this,setTimeout(function(){t._endEditingOnMobile()},400)),this._editingMode=!1},t._setFont=function(t){var e=(t=cc.LabelTTF._fontStyleRE.exec(t))[2],i=parseInt(t[1]);t&&this.setFont(e,i)},t.setFont=function(t,e){this._edFontName=t||this._edFontName,this._edFontSize=e||this._edFontSize,this._updateDOMFontStyle()},t.setFontName=function(t){this._edFontName=t||this._edFontName,this._updateDOMFontStyle()},t.setFontSize=function(t){this._edFontSize=t||this._edFontSize,this._updateDOMFontStyle()},t.setFontColor=function(t){this._edTxt&&(this._edTxt.value!==this._editBox._placeholderText&&(this._edTxt.style.color=cc.colorToHex(t)),this._textLabel)&&this._textLabel.setColor(t)},t.setPlaceHolder=function(t){this._placeholderLabel.setString(t)},t.setMaxLength=function(t){this._edTxt&&(this._edTxt.maxLength=t)},t._updateDOMPlaceholderFontStyle=function(){this._placeholderLabel.setFontName(this._editBox._placeholderFontName),this._placeholderLabel.setFontSize(this._editBox._placeholderFontSize)},t.setPlaceholderFontColor=function(t){this._placeholderLabel.setColor(t)},t._updateDomInputType=function(){var t=this._editBox._editBoxInputMode;t===cc.EDITBOX_INPUT_MODE_EMAILADDR?this._edTxt.type="email":t===cc.EDITBOX_INPUT_MODE_DECIMAL||t===cc.EDITBOX_INPUT_MODE_NUMERIC?this._edTxt.type="number":t===cc.EDITBOX_INPUT_MODE_PHONENUMBER?(this._edTxt.type="number",this._edTxt.pattern="[0-9]*"):t===cc.EDITBOX_INPUT_MODE_URL?this._edTxt.type="url":(this._edTxt.type="text",this._editBox._keyboardReturnType===cc.KEYBOARD_RETURNTYPE_SEARCH&&(this._edTxt.type="search")),this._editBox._editBoxInputFlag===cc.EDITBOX_INPUT_FLAG_PASSWORD&&(this._edTxt.type="password")},t.setInputFlag=function(t){this._edTxt&&(this._updateDomInputType(),this._edTxt.style.textTransform="none",t===cc.EDITBOX_INPUT_FLAG_INITIAL_CAPS_ALL_CHARACTERS?this._edTxt.style.textTransform="uppercase":t===cc.EDITBOX_INPUT_FLAG_INITIAL_CAPS_WORD&&(this._edTxt.style.textTransform="capitalize"),this._updateLabelStringStyle())},t.setInputMode=function(t){t===cc.EDITBOX_INPUT_MODE_ANY?this._createDomTextArea():this._createDomInput(),this._updateDomInputType(),t=this._node.getContentSize(),this.updateSize(t.width,t.height)},t.setString=function(t){this._edTxt&&null!==t&&(""===(this._edTxt.value=t)?(this._placeholderLabel&&(this._placeholderLabel.setString(this._editBox._placeholderText),this._placeholderLabel.setColor(this._editBox._placeholderColor)),this._editingMode||(this._placeholderLabel&&this._placeholderLabel.setVisible(!0),this._textLabel&&this._textLabel.setVisible(!1))):(this._edTxt.style.color=cc.colorToHex(this._editBox._textColor),this._textLabel&&this._textLabel.setColor(this._editBox._textColor),this._editingMode||(this._placeholderLabel&&this._placeholderLabel.setVisible(!1),this._textLabel&&this._textLabel.setVisible(!0)),this._updateLabelStringStyle()))},t._updateDOMFontStyle=function(){this._edTxt&&(""!==this._edTxt.value&&(this._edTxt.style.fontFamily=this._edFontName,this._edTxt.style.fontSize=this._edFontSize+"px"),this._textLabel)&&(this._textLabel.setFontSize(this._edFontSize),this._textLabel.setFontName(this._edFontName))},t.updateSize=function(t,e){var i=this._edTxt;i&&(i.style.width=t+"px",i.style.height=e+"px",this._updateLabelPosition(cc.size(t,e)))},t._addDomToGameContainer=function(){cc.game.container.appendChild(this._edTxt)},t._removeDomFromGameContainer=function(){var t=this._edTxt;t&&("contains"in cc.game.container?cc.game.container.contains(t):cc.game.container.compareDocumentPosition(t)%16)&&cc.game.container.removeChild(t),this._edTxt=null},t.initializeRenderCmd=function(t){this._editBox=t,this._edFontSize=14,this._edFontName="Arial",this._placeholderLabel=this._textLabel=null,this.__rotateScreen=this.__autoResize=this.__fullscreen=this._editingMode=!1,this.__orientationChanged=null},cc.EditBox.CanvasRenderCmd=function(t){this._rootCtor(t),this.initializeRenderCmd(t)},cc.EditBox.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype));cc.inject(t,e),e.constructor=cc.EditBox.CanvasRenderCmd,e.transform=function(t,e){this.originTransform(t,e),this.updateMatrix()},cc.EditBox.WebGLRenderCmd=function(t){this._rootCtor(t),this.initializeRenderCmd(t)},e=cc.EditBox.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype),cc.inject(t,e),e.constructor=cc.EditBox.WebGLRenderCmd,e.transform=function(t,e){this.originTransform(t,e),this.updateMatrix()}}(cc.EditBox._polyfill),!function(t){var e;"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):("undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.io=t())}(function(){return function n(s,r,o){function a(i,t){if(!r[i]){if(!s[i]){var e="function"==typeof require&&require;if(!t&&e)return e(i,!0);if(c)return c(i,!0);throw Error("Cannot find module '"+i+"'")}e=r[i]={exports:{}},s[i][0].call(e.exports,function(t){var e=s[i][1][t];return a(e||t)},e,e.exports,n,s,r,o)}return r[i].exports}for(var c="function"==typeof require&&require,t=0;t<o.length;t++)a(o[t]);return a}({1:[function(t,e,i){e.exports=t("./lib/")},{"./lib/":2}],2:[function(t,e,i){function n(t,e){"object"==typeof t&&(e=t,t=void 0),e=e||{};var t=s(t),i=t.source,n=t.id;return(i=e.forceNew||e["force new connection"]||!1===e.multiplex?(a("ignoring socket cache for %s",i),o(i,e)):(c[n]||(a("new io instance for %s",i),c[n]=o(i,e)),c[n])).socket(t.path)}var s=t("./url"),r=t("socket.io-parser"),o=t("./manager"),a=t("debug")("socket.io-client"),c=(e.exports=i=n,i.managers={});i.protocol=r.protocol,i.connect=n,i.Manager=t("./manager"),i.Socket=t("./socket")},{"./manager":3,"./socket":5,"./url":6,debug:10,"socket.io-parser":46}],3:[function(t,e,i){function n(t,e){if(!(this instanceof n))return new n(t,e);t&&"object"==typeof t&&(e=t,t=void 0),(e=e||{}).path=e.path||"/socket.io",this.nsps={},this.subs=[],this.opts=e,this.reconnection(!1!==e.reconnection),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor(e.randomizationFactor||.5),this.backoff=new u({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==e.timeout?2e4:e.timeout),this.readyState="closed",this.uri=t,this.connected=[],this.encoding=!1,this.packetBuffer=[],this.encoder=new r.Encoder,this.decoder=new r.Decoder,(this.autoConnect=!1!==e.autoConnect)&&this.open()}t("./url");var a=t("engine.io-client"),s=t("./socket"),r=(i=t("component-emitter"),t("socket.io-parser")),c=t("./on"),o=t("component-bind"),h=(t("object-component"),t("debug")("socket.io-client:manager")),l=t("indexof"),u=t("backo2");(e.exports=n).prototype.emitAll=function(){for(var t in this.emit.apply(this,arguments),this.nsps)this.nsps[t].emit.apply(this.nsps[t],arguments)},n.prototype.updateSocketIds=function(){for(var t in this.nsps)this.nsps[t].id=this.engine.id},i(n.prototype),n.prototype.reconnection=function(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection},n.prototype.reconnectionAttempts=function(t){return arguments.length?(this._reconnectionAttempts=t,this):this._reconnectionAttempts},n.prototype.reconnectionDelay=function(t){return arguments.length?(this._reconnectionDelay=t,this.backoff&&this.backoff.setMin(t),this):this._reconnectionDelay},n.prototype.randomizationFactor=function(t){return arguments.length?(this._randomizationFactor=t,this.backoff&&this.backoff.setJitter(t),this):this._randomizationFactor},n.prototype.reconnectionDelayMax=function(t){return arguments.length?(this._reconnectionDelayMax=t,this.backoff&&this.backoff.setMax(t),this):this._reconnectionDelayMax},n.prototype.timeout=function(t){return arguments.length?(this._timeout=t,this):this._timeout},n.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},n.prototype.open=n.prototype.connect=function(i){var t,n,e,s,r,o;return h("readyState %s",this.readyState),~this.readyState.indexOf("open")||(h("opening %s",this.uri),t=this.engine=a(this.uri,this.opts),(n=this).readyState="opening",this.skipReconnect=!1,e=c(t,"open",function(){n.onopen(),i&&i()}),s=c(t,"error",function(t){var e;h("connect_error"),n.cleanup(),n.readyState="closed",n.emitAll("connect_error",t),i?((e=Error("Connection error")).data=t,i(e)):n.maybeReconnectOnOpen()}),!1!==this._timeout&&(r=this._timeout,h("connect attempt will timeout after %d",r),o=setTimeout(function(){h("connect attempt timed out after %d",r),e.destroy(),t.close(),t.emit("error","timeout"),n.emitAll("connect_timeout",r)},r),this.subs.push({destroy:function(){clearTimeout(o)}})),this.subs.push(e),this.subs.push(s)),this},n.prototype.onopen=function(){h("open"),this.cleanup(),this.readyState="open",this.emit("open");var t=this.engine;this.subs.push(c(t,"data",o(this,"ondata"))),this.subs.push(c(this.decoder,"decoded",o(this,"ondecoded"))),this.subs.push(c(t,"error",o(this,"onerror"))),this.subs.push(c(t,"close",o(this,"onclose")))},n.prototype.ondata=function(t){this.decoder.add(t)},n.prototype.ondecoded=function(t){this.emit("packet",t)},n.prototype.onerror=function(t){h("error",t),this.emitAll("error",t)},n.prototype.socket=function(t){var e,i=this.nsps[t];return i||(i=new s(this,t),this.nsps[t]=i,e=this,i.on("connect",function(){i.id=e.engine.id,~l(e.connected,i)||e.connected.push(i)})),i},n.prototype.destroy=function(t){~(t=l(this.connected,t))&&this.connected.splice(t,1),this.connected.length||this.close()},n.prototype.packet=function(t){h("writing packet %j",t);var i=this;i.encoding?i.packetBuffer.push(t):(i.encoding=!0,this.encoder.encode(t,function(t){for(var e=0;e<t.length;e++)i.engine.write(t[e]);i.encoding=!1,i.processPacketQueue()}))},n.prototype.processPacketQueue=function(){var t;0<this.packetBuffer.length&&!this.encoding&&(t=this.packetBuffer.shift(),this.packet(t))},n.prototype.cleanup=function(){for(var t;t=this.subs.shift();)t.destroy();this.packetBuffer=[],this.encoding=!1,this.decoder.destroy()},n.prototype.close=n.prototype.disconnect=function(){this.skipReconnect=!0,this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},n.prototype.onclose=function(t){h("close"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",t),this._reconnection&&!this.skipReconnect&&this.reconnect()},n.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var t,e,i=this;this.backoff.attempts>=this._reconnectionAttempts?(h("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1):(t=this.backoff.duration(),h("will wait %dms before reconnect attempt",t),this.reconnecting=!0,e=setTimeout(function(){i.skipReconnect||(h("attempting reconnect"),i.emitAll("reconnect_attempt",i.backoff.attempts),i.emitAll("reconnecting",i.backoff.attempts),i.skipReconnect)||i.open(function(t){t?(h("reconnect attempt error"),i.reconnecting=!1,i.reconnect(),i.emitAll("reconnect_error",t.data)):(h("reconnect success"),i.onreconnect())})},t),this.subs.push({destroy:function(){clearTimeout(e)}}))},n.prototype.onreconnect=function(){var t=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",t)}},{"./on":4,"./socket":5,"./url":6,backo2:7,"component-bind":8,"component-emitter":9,debug:10,"engine.io-client":11,indexof:42,"object-component":43,"socket.io-parser":46}],4:[function(t,e,i){e.exports=function(t,e,i){return t.on(e,i),{destroy:function(){t.removeListener(e,i)}}}},{}],5:[function(t,e,i){function n(t,e){this.io=t,this.nsp=e,(this.json=this).ids=0,this.acks={},this.io.autoConnect&&this.open(),this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0}var r=t("socket.io-parser"),o=(i=t("component-emitter"),t("to-array")),s=t("./on"),a=t("component-bind"),c=t("debug")("socket.io-client:socket"),h=t("has-binary"),l=(e.exports=n,{connect:1,connect_error:1,connect_timeout:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1}),u=i.prototype.emit;i(n.prototype),n.prototype.subEvents=function(){var t;this.subs||(t=this.io,this.subs=[s(t,"open",a(this,"onopen")),s(t,"packet",a(this,"onpacket")),s(t,"close",a(this,"onclose"))])},n.prototype.open=n.prototype.connect=function(){return this.connected||(this.subEvents(),this.io.open(),"open"==this.io.readyState&&this.onopen()),this},n.prototype.send=function(){var t=o(arguments);return t.unshift("message"),this.emit.apply(this,t),this},n.prototype.emit=function(t){var e,i;return l.hasOwnProperty(t)?u.apply(this,arguments):(e=o(arguments),i=r.EVENT,i={type:i=h(e)?r.BINARY_EVENT:i,data:e},"function"==typeof e[e.length-1]&&(c("emitting packet with ack id %d",this.ids),this.acks[this.ids]=e.pop(),i.id=this.ids++),this.connected?this.packet(i):this.sendBuffer.push(i)),this},n.prototype.packet=function(t){t.nsp=this.nsp,this.io.packet(t)},n.prototype.onopen=function(){c("transport is open - connecting"),"/"!=this.nsp&&this.packet({type:r.CONNECT})},n.prototype.onclose=function(t){c("close (%s)",t),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",t)},n.prototype.onpacket=function(t){if(t.nsp==this.nsp)switch(t.type){case r.CONNECT:this.onconnect();break;case r.EVENT:case r.BINARY_EVENT:this.onevent(t);break;case r.ACK:case r.BINARY_ACK:this.onack(t);break;case r.DISCONNECT:this.ondisconnect();break;case r.ERROR:this.emit("error",t.data)}},n.prototype.onevent=function(t){var e=t.data||[];c("emitting event %j",e),null!=t.id&&(c("attaching ack callback to event"),e.push(this.ack(t.id))),this.connected?u.apply(this,e):this.receiveBuffer.push(e)},n.prototype.ack=function(i){var n=this,s=!1;return function(){var t,e;s||(s=!0,t=o(arguments),c("sending ack %j",t),e=h(t)?r.BINARY_ACK:r.ACK,n.packet({type:e,id:i,data:t}))}},n.prototype.onack=function(t){c("calling ack %s with %j",t.id,t.data),this.acks[t.id].apply(this,t.data),delete this.acks[t.id]},n.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},n.prototype.emitBuffered=function(){for(var t=0;t<this.receiveBuffer.length;t++)u.apply(this,this.receiveBuffer[t]);for(this.receiveBuffer=[],t=0;t<this.sendBuffer.length;t++)this.packet(this.sendBuffer[t]);this.sendBuffer=[]},n.prototype.ondisconnect=function(){c("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},n.prototype.destroy=function(){if(this.subs){for(var t=0;t<this.subs.length;t++)this.subs[t].destroy();this.subs=null}this.io.destroy(this)},n.prototype.close=n.prototype.disconnect=function(){return this.connected&&(c("performing disconnect (%s)",this.nsp),this.packet({type:r.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}},{"./on":4,"component-bind":8,"component-emitter":9,debug:10,"has-binary":38,"socket.io-parser":46,"to-array":50}],6:[function(t,e,i){!function(n){var s=t("parseuri"),r=t("debug")("socket.io-client:url");e.exports=function(t,e){var i=t;return e=e||n.location,"string"==typeof(t=null==t?e.protocol+"//"+e.host:t)&&("/"==t.charAt(0)&&(t="/"==t.charAt(1)?e.protocol+t:e.hostname+t),/^(https?|wss?):\/\//.test(t)||(r("protocol-less url %s",t),t=void 0!==e?e.protocol+"//"+t:"https://"+t),r("parse %s",t),i=s(t)),i.port||(/^(http|ws)$/.test(i.protocol)?i.port="80":/^(http|ws)s$/.test(i.protocol)&&(i.port="443")),i.path=i.path||"/",i.id=i.protocol+"://"+i.host+":"+i.port,i.href=i.protocol+"://"+i.host+(e&&e.port==i.port?"":":"+i.port),i}}.call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{debug:10,parseuri:44}],7:[function(t,e,i){function n(t){this.ms=(t=t||{}).min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=0<t.jitter&&t.jitter<=1?t.jitter:0,this.attempts=0}(e.exports=n).prototype.duration=function(){var t,e,i=this.ms*Math.pow(this.factor,this.attempts++);return this.jitter&&(t=Math.random(),e=Math.floor(t*this.jitter*i),i=0==(1&Math.floor(10*t))?i-e:i+e),0|Math.min(i,this.max)},n.prototype.reset=function(){this.attempts=0},n.prototype.setMin=function(t){this.ms=t},n.prototype.setMax=function(t){this.max=t},n.prototype.setJitter=function(t){this.jitter=t}},{}],8:[function(t,e,i){var n=[].slice;e.exports=function(t,e){if("function"!=typeof(e="string"==typeof e?t[e]:e))throw Error("bind() requires a function");var i=n.call(arguments,2);return function(){return e.apply(t,i.concat(n.call(arguments)))}}},{}],9:[function(t,e,i){function n(t){if(t){for(var e in n.prototype)t[e]=n.prototype[e];return t}}(e.exports=n).prototype.on=n.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks[t]=this._callbacks[t]||[]).push(e),this},n.prototype.once=function(t,e){function i(){n.off(t,i),e.apply(this,arguments)}var n=this;return this._callbacks=this._callbacks||{},i.fn=e,this.on(t,i),this},n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=n.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)this._callbacks={};else{var i=this._callbacks[t];if(i)if(1==arguments.length)delete this._callbacks[t];else for(var n,s=0;s<i.length;s++)if((n=i[s])===e||n.fn===e){i.splice(s,1);break}}return this},n.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),i=this._callbacks[t];if(i)for(var n=0,s=(i=i.slice(0)).length;n<s;++n)i[n].apply(this,e);return this},n.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks[t]||[]},n.prototype.hasListeners=function(t){return!!this.listeners(t).length}},{}],10:[function(t,e,i){function s(n){return s.enabled(n)?function(t){t instanceof Error&&(t=t.stack||t.message);var e=new Date,i=e-(s[n]||e);s[n]=e,t=n+" "+t+" +"+s.humanize(i),window.console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}:function(){}}(e.exports=s).names=[],s.skips=[],s.enable=function(t){try{localStorage.debug=t}catch(t){}for(var e=(t||"").split(/[\s,]+/),i=e.length,n=0;n<i;n++)"-"===(t=e[n].replace("*",".*?"))[0]?s.skips.push(RegExp("^"+t.substr(1)+"$")):s.names.push(RegExp("^"+t+"$"))},s.disable=function(){s.enable("")},s.humanize=function(t){return 36e5<=t?(t/36e5).toFixed(1)+"h":6e4<=t?(t/6e4).toFixed(1)+"m":1e3<=t?(t/1e3|0)+"s":t+"ms"},s.enabled=function(t){for(var e=0,i=s.skips.length;e<i;e++)if(s.skips[e].test(t))return!1;for(e=0,i=s.names.length;e<i;e++)if(s.names[e].test(t))return!0;return!1};try{window.localStorage&&s.enable(localStorage.debug)}catch(t){}},{}],11:[function(t,e,i){e.exports=t("./lib/")},{"./lib/":12}],12:[function(t,e,i){e.exports=t("./socket"),e.exports.parser=t("engine.io-parser")},{"./socket":13,"engine.io-parser":25}],13:[function(e,h,t){!function(i){function u(t,e){if(!(this instanceof u))return new u(t,e);e=e||{},t&&"object"==typeof t&&(e=t,t=null),t&&(t=n(t),e.host=t.host,e.secure="https"==t.protocol||"wss"==t.protocol,e.port=t.port,t.query)&&(e.query=t.query),this.secure=null!=e.secure?e.secure:i.location&&"https:"==location.protocol,e.host&&(t=e.host.split(":"),e.hostname=t.shift(),t.length?e.port=t.pop():e.port||(e.port=this.secure?"443":"80")),this.agent=e.agent||!1,this.hostname=e.hostname||(i.location?location.hostname:"localhost"),this.port=e.port||(i.location&&location.port?location.port:this.secure?443:80),this.query=e.query||{},"string"==typeof this.query&&(this.query=c.decode(this.query)),this.upgrade=!1!==e.upgrade,this.path=(e.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!e.forceJSONP,this.jsonp=!1!==e.jsonp,this.forceBase64=!!e.forceBase64,this.enablesXDR=!!e.enablesXDR,this.timestampParam=e.timestampParam||"t",this.timestampRequests=e.timestampRequests,this.transports=e.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.callbackBuffer=[],this.policyPort=e.policyPort||843,this.rememberUpgrade=e.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=e.onlyBinaryUpgrades,this.pfx=e.pfx||null,this.key=e.key||null,this.passphrase=e.passphrase||null,this.cert=e.cert||null,this.ca=e.ca||null,this.ciphers=e.ciphers||null,this.rejectUnauthorized=e.rejectUnauthorized||null,this.open()}var s=e("./transports"),t=e("component-emitter"),d=e("debug")("engine.io-client:socket"),r=e("indexof"),o=e("engine.io-parser"),n=e("parseuri"),a=e("parsejson"),c=e("parseqs");(h.exports=u).priorWebsocketSuccess=!1,t(u.prototype),u.protocol=o.protocol,(u.Socket=u).Transport=e("./transport"),u.transports=e("./transports"),u.parser=e("engine.io-parser"),u.prototype.createTransport=function(t){d('creating transport "%s"',t);var e,i=this.query,n={};for(e in i)i.hasOwnProperty(e)&&(n[e]=i[e]);return n.EIO=o.protocol,n.transport=t,this.id&&(n.sid=this.id),new s[t]({agent:this.agent,hostname:this.hostname,port:this.port,secure:this.secure,path:this.path,query:n,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this,pfx:this.pfx,key:this.key,passphrase:this.passphrase,cert:this.cert,ca:this.ca,ciphers:this.ciphers,rejectUnauthorized:this.rejectUnauthorized})},u.prototype.open=function(){var t,e;if(this.rememberUpgrade&&u.priorWebsocketSuccess&&-1!=this.transports.indexOf("websocket"))t="websocket";else{if(0==this.transports.length)return e=this,void setTimeout(function(){e.emit("error","No transports available")},0);t=this.transports[0]}this.readyState="opening";try{t=this.createTransport(t)}catch(t){return this.transports.shift(),void this.open()}t.open(),this.setTransport(t)},u.prototype.setTransport=function(t){d("setting transport %s",t.name);var e=this;this.transport&&(d("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),(this.transport=t).on("drain",function(){e.onDrain()}).on("packet",function(t){e.onPacket(t)}).on("error",function(t){e.onError(t)}).on("close",function(){e.onClose("transport close")})},u.prototype.probe=function(i){function t(){var t;l.onlyBinaryUpgrades&&(t=!this.supportsBinary&&l.transport.supportsBinary,h=h||t),h||(d('probe transport "%s" opened',i),c.send([{type:"ping",data:"probe"}]),c.once("packet",function(t){h||("pong"==t.type&&"probe"==t.data?(d('probe transport "%s" pong',i),l.upgrading=!0,l.emit("upgrading",c),c&&(u.priorWebsocketSuccess="websocket"==c.name,d('pausing current transport "%s"',l.transport.name),l.transport.pause(function(){h||"closed"==l.readyState||(d("changing transport and sending upgrade packet"),a(),l.setTransport(c),c.send([{type:"upgrade"}]),l.emit("upgrade",c),c=null,l.upgrading=!1,l.flush())}))):(d('probe transport "%s" failed',i),(t=Error("probe error")).transport=c.name,l.emit("upgradeError",t)))}))}function n(){h||(h=!0,a(),c.close(),c=null)}function e(t){var e=Error("probe error: "+t);e.transport=c.name,n(),d('probe transport "%s" failed because of error: %s',i,t),l.emit("upgradeError",e)}function s(){e("transport closed")}function r(){e("socket closed")}function o(t){c&&t.name!=c.name&&(d('"%s" works - aborting "%s"',t.name,c.name),n())}function a(){c.removeListener("open",t),c.removeListener("error",e),c.removeListener("close",s),l.removeListener("close",r),l.removeListener("upgrading",o)}d('probing transport "%s"',i);var c=this.createTransport(i,{probe:1}),h=!1,l=this;u.priorWebsocketSuccess=!1,c.once("open",t),c.once("error",e),c.once("close",s),this.once("close",r),this.once("upgrading",o),c.open()},u.prototype.onOpen=function(){if(d("socket open"),this.readyState="open",u.priorWebsocketSuccess="websocket"==this.transport.name,this.emit("open"),this.flush(),"open"==this.readyState&&this.upgrade&&this.transport.pause){d("starting upgrade probes");for(var t=0,e=this.upgrades.length;t<e;t++)this.probe(this.upgrades[t])}},u.prototype.onPacket=function(t){if("opening"==this.readyState||"open"==this.readyState)switch(d('socket receive: type "%s", data "%s"',t.type,t.data),this.emit("packet",t),this.emit("heartbeat"),t.type){case"open":this.onHandshake(a(t.data));break;case"pong":this.setPing();break;case"error":var e=Error("server error");e.code=t.data,this.emit("error",e);break;case"message":this.emit("data",t.data),this.emit("message",t.data)}else d('packet received with socket readyState "%s"',this.readyState)},u.prototype.onHandshake=function(t){this.emit("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.onOpen(),"closed"!=this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},u.prototype.onHeartbeat=function(t){clearTimeout(this.pingTimeoutTimer);var e=this;e.pingTimeoutTimer=setTimeout(function(){"closed"!=e.readyState&&e.onClose("ping timeout")},t||e.pingInterval+e.pingTimeout)},u.prototype.setPing=function(){var t=this;clearTimeout(t.pingIntervalTimer),t.pingIntervalTimer=setTimeout(function(){d("writing ping packet - expecting pong within %sms",t.pingTimeout),t.ping(),t.onHeartbeat(t.pingTimeout)},t.pingInterval)},u.prototype.ping=function(){this.sendPacket("ping")},u.prototype.onDrain=function(){for(var t=0;t<this.prevBufferLen;t++)this.callbackBuffer[t]&&this.callbackBuffer[t]();this.writeBuffer.splice(0,this.prevBufferLen),this.callbackBuffer.splice(0,this.prevBufferLen),(this.prevBufferLen=0)==this.writeBuffer.length?this.emit("drain"):this.flush()},u.prototype.flush=function(){"closed"!=this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(d("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},u.prototype.write=u.prototype.send=function(t,e){return this.sendPacket("message",t,e),this},u.prototype.sendPacket=function(t,e,i){"closing"!=this.readyState&&"closed"!=this.readyState&&(this.emit("packetCreate",t={type:t,data:e}),this.writeBuffer.push(t),this.callbackBuffer.push(i),this.flush())},u.prototype.close=function(){var t,e,i,n;return"opening"!=this.readyState&&"open"!=this.readyState||(this.readyState="closing",e=function(){t.onClose("forced close"),d("socket closing - telling transport to close"),t.transport.close()},i=function(){t.removeListener("upgrade",i),t.removeListener("upgradeError",i),e()},n=function(){t.once("upgrade",i),t.once("upgradeError",i)},(t=this).writeBuffer.length?this.once("drain",function(){(this.upgrading?n:e)()}):(this.upgrading?n:e)()),this},u.prototype.onError=function(t){d("socket error %j",t),u.priorWebsocketSuccess=!1,this.emit("error",t),this.onClose("transport error",t)},u.prototype.onClose=function(t,e){var i;"opening"!=this.readyState&&"open"!=this.readyState&&"closing"!=this.readyState||(d('socket close with reason: "%s"',t),i=this,clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),setTimeout(function(){i.writeBuffer=[],i.callbackBuffer=[],i.prevBufferLen=0},0),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",t,e))},u.prototype.filterUpgrades=function(t){for(var e=[],i=0,n=t.length;i<n;i++)~r(this.transports,t[i])&&e.push(t[i]);return e}}.call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./transport":14,"./transports":15,"component-emitter":9,debug:22,"engine.io-parser":25,indexof:42,parsejson:34,parseqs:35,parseuri:36}],14:[function(t,e,i){function n(t){this.path=t.path,this.hostname=t.hostname,this.port=t.port,this.secure=t.secure,this.query=t.query,this.timestampParam=t.timestampParam,this.timestampRequests=t.timestampRequests,this.readyState="",this.agent=t.agent||!1,this.socket=t.socket,this.enablesXDR=t.enablesXDR,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized}var s=t("engine.io-parser");(t=t("component-emitter"))((e.exports=n).prototype),n.timestamps=0,n.prototype.onError=function(t,e){t=Error(t);return t.type="TransportError",t.description=e,this.emit("error",t),this},n.prototype.open=function(){return"closed"!=this.readyState&&""!=this.readyState||(this.readyState="opening",this.doOpen()),this},n.prototype.close=function(){return"opening"!=this.readyState&&"open"!=this.readyState||(this.doClose(),this.onClose()),this},n.prototype.send=function(t){if("open"!=this.readyState)throw Error("Transport not open");this.write(t)},n.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},n.prototype.onData=function(t){t=s.decodePacket(t,this.socket.binaryType),this.onPacket(t)},n.prototype.onPacket=function(t){this.emit("packet",t)},n.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},{"component-emitter":9,"engine.io-parser":25}],15:[function(e,t,i){!function(s){var r=e("xmlhttprequest"),o=e("./polling-xhr"),a=e("./polling-jsonp"),t=e("./websocket");i.polling=function(t){var e=!1,i=!1,n=!1!==t.jsonp;if(s.location&&(i="https:"==location.protocol,e=(e=location.port)||(i?443:80),e=t.hostname!=location.hostname||e!=t.port,i=t.secure!=i),t.xdomain=e,t.xscheme=i,"open"in new r(t)&&!t.forceJSONP)return new o(t);if(n)return new a(t);throw Error("JSONP disabled")},i.websocket=t}.call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./polling-jsonp":16,"./polling-xhr":17,"./websocket":19,xmlhttprequest:20}],16:[function(o,a,t){!function(i){function n(){}function t(t){r.call(this,t),this.query=this.query||{},s||(i.___eio||(i.___eio=[]),s=i.___eio),this.index=s.length;var e=this;s.push(function(t){e.onData(t)}),this.query.j=this.index,i.document&&i.addEventListener&&i.addEventListener("beforeunload",function(){e.script&&(e.script.onerror=n)},!1)}var s,r=o("./polling"),e=o("component-inherit"),h=(a.exports=t,/\n/g),l=/\\n/g;e(t,r),t.prototype.supportsBinary=!1,t.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.iframe=this.form=null),r.prototype.doClose.call(this)},t.prototype.doPoll=function(){var e=this,t=document.createElement("script"),i=(this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)},document.getElementsByTagName("script")[0]);i.parentNode.insertBefore(t,i),this.script=t,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var t=document.createElement("iframe");document.body.appendChild(t),document.body.removeChild(t)},100)},t.prototype.doWrite=function(t,e){function i(){n(),e()}function n(){if(c.iframe)try{c.form.removeChild(c.iframe)}catch(t){c.onError("jsonp polling iframe removal error",t)}try{a=document.createElement('<iframe src="javascript:0" name="'+c.iframeId+'">')}catch(t){(a=document.createElement("iframe")).name=c.iframeId,a.src="javascript:0"}a.id=c.iframeId,c.form.appendChild(a),c.iframe=a}var s,r,o,a,c=this;this.form||(s=document.createElement("form"),r=document.createElement("textarea"),o=this.iframeId="eio_iframe_"+this.index,s.className="socketio",s.style.position="absolute",s.style.top="-1000px",s.style.left="-1000px",s.target=o,s.method="POST",s.setAttribute("accept-charset","utf-8"),r.name="d",s.appendChild(r),document.body.appendChild(s),this.form=s,this.area=r),this.form.action=this.uri(),n(),t=t.replace(l,"\\\n"),this.area.value=t.replace(h,"\\n");try{this.form.submit()}catch(t){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"==c.iframe.readyState&&i()}:this.iframe.onload=i}}.call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./polling":18,"component-inherit":21}],17:[function(l,u,t){!function(n){function e(){}function t(t){var e,i;o.call(this,t),n.location&&(e="https:"==location.protocol,i=(i=location.port)||(e?443:80),this.xd=t.hostname!=n.location.hostname||i!=t.port,this.xs=t.secure!=e)}function s(t){this.method=t.method||"GET",this.uri=t.uri,this.xd=!!t.xd,this.xs=!!t.xs,this.async=!1!==t.async,this.data=null!=t.data?t.data:null,this.agent=t.agent,this.isBinary=t.isBinary,this.supportsBinary=t.supportsBinary,this.enablesXDR=t.enablesXDR,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.create()}function i(){for(var t in s.requests)s.requests.hasOwnProperty(t)&&s.requests[t].abort()}var r=l("xmlhttprequest"),o=l("./polling"),a=l("component-emitter"),c=l("component-inherit"),h=l("debug")("engine.io-client:polling-xhr");u.exports=t,u.exports.Request=s,c(t,o),t.prototype.supportsBinary=!0,t.prototype.request=function(t){return(t=t||{}).uri=this.uri(),t.xd=this.xd,t.xs=this.xs,t.agent=this.agent||!1,t.supportsBinary=this.supportsBinary,t.enablesXDR=this.enablesXDR,t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized,new s(t)},t.prototype.doWrite=function(t,e){var t=this.request({method:"POST",data:t,isBinary:"string"!=typeof t&&void 0!==t}),i=this;t.on("success",e),t.on("error",function(t){i.onError("xhr post error",t)}),this.sendXhr=t},t.prototype.doPoll=function(){h("xhr poll");var t=this.request(),e=this;t.on("data",function(t){e.onData(t)}),t.on("error",function(t){e.onError("xhr poll error",t)}),this.pollXhr=t},a(s.prototype),s.prototype.create=function(){var t={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR},e=(t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized,this.xhr=new r(t)),i=this;try{if(h("xhr open %s: %s",this.method,this.uri),e.open(this.method,this.uri,this.async),this.supportsBinary&&(e.responseType="arraybuffer"),"POST"==this.method)try{this.isBinary?e.setRequestHeader("Content-type","application/octet-stream"):e.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(t){}"withCredentials"in e&&(e.withCredentials=!0),this.hasXDR()?(e.onload=function(){i.onLoad()},e.onerror=function(){i.onError(e.responseText)}):e.onreadystatechange=function(){4==e.readyState&&(200==e.status||1223==e.status?i.onLoad():setTimeout(function(){i.onError(e.status)},0))},h("xhr data %s",this.data),e.send(this.data)}catch(t){return void setTimeout(function(){i.onError(t)},0)}n.document&&(this.index=s.requestsCount++,s.requests[this.index]=this)},s.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},s.prototype.onData=function(t){this.emit("data",t),this.onSuccess()},s.prototype.onError=function(t){this.emit("error",t),this.cleanup(!0)},s.prototype.cleanup=function(t){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=e:this.xhr.onreadystatechange=e,t)try{this.xhr.abort()}catch(t){}n.document&&delete s.requests[this.index],this.xhr=null}},s.prototype.onLoad=function(){var t,e;try{try{e=this.xhr.getResponseHeader("Content-Type").split(";")[0]}catch(t){}t="application/octet-stream"===e?this.xhr.response:this.supportsBinary?"ok":this.xhr.responseText}catch(t){this.onError(t)}null!=t&&this.onData(t)},s.prototype.hasXDR=function(){return void 0!==n.XDomainRequest&&!this.xs&&this.enablesXDR},s.prototype.abort=function(){this.cleanup()},n.document&&(s.requestsCount=0,s.requests={},n.attachEvent?n.attachEvent("onunload",i):n.addEventListener&&n.addEventListener("beforeunload",i,!1))}.call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./polling":18,"component-emitter":9,"component-inherit":21,debug:22,xmlhttprequest:20}],18:[function(t,e,i){function n(t){var e=t&&t.forceBase64;c&&!e||(this.supportsBinary=!1),s.call(this,t)}var s=t("../transport"),r=t("parseqs"),o=t("engine.io-parser"),a=(i=t("component-inherit"),t("debug")("engine.io-client:polling")),c=(e.exports=n,null!=new(t("xmlhttprequest"))({xdomain:!1}).responseType);i(n,s),n.prototype.name="polling",n.prototype.doOpen=function(){this.poll()},n.prototype.pause=function(t){function e(){a("paused"),n.readyState="paused",t()}var i,n=this;this.readyState="pausing",this.polling||!this.writable?(i=0,this.polling&&(a("we are currently polling - waiting to pause"),i++,this.once("pollComplete",function(){a("pre-pause polling complete"),--i||e()})),this.writable||(a("we are currently writing - waiting to pause"),i++,this.once("drain",function(){a("pre-pause writing complete"),--i||e()}))):e()},n.prototype.poll=function(){a("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},n.prototype.onData=function(t){var n=this;a("polling got data %s",t),o.decodePayload(t,this.socket.binaryType,function(t,e,i){if("opening"==n.readyState&&n.onOpen(),"close"==t.type)return n.onClose(),!1;n.onPacket(t)}),"closed"!=this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"==this.readyState?this.poll():a('ignoring poll - transport state "%s"',this.readyState))},n.prototype.doClose=function(){function t(){a("writing close packet"),e.write([{type:"close"}])}var e=this;"open"==this.readyState?(a("transport open - closing"),t()):(a("transport not open - deferring close"),this.once("open",t))},n.prototype.write=function(t){function e(){i.writable=!0,i.emit("drain")}this.writable=!1;var i=this;o.encodePayload(t,this.supportsBinary,function(t){i.doWrite(t,e)})},n.prototype.uri=function(){var t=this.query||{},e=this.secure?"https":"http",i="";return!1!==this.timestampRequests&&(t[this.timestampParam]=+new Date+"-"+s.timestamps++),this.supportsBinary||t.sid||(t.b64=1),t=r.encode(t),this.port&&("https"==e&&443!=this.port||"http"==e&&80!=this.port)&&(i=":"+this.port),t.length&&(t="?"+t),e+"://"+this.hostname+i+this.path+t}},{"../transport":14,"component-inherit":21,debug:22,"engine.io-parser":25,parseqs:35,xmlhttprequest:20}],19:[function(t,e,i){function n(t){t&&t.forceBase64&&(this.supportsBinary=!1),s.call(this,t)}var s=t("../transport"),r=t("engine.io-parser"),o=t("parseqs"),a=(i=t("component-inherit"),t("debug")("engine.io-client:websocket")),c=t("ws");i(e.exports=n,s),n.prototype.name="websocket",n.prototype.supportsBinary=!0,n.prototype.doOpen=function(){var t,e;this.check()&&(t=this.uri(),(e={agent:this.agent}).pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,this.ws=new c(t,void 0,e),void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.binaryType="arraybuffer",this.addEventListeners())},n.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}},"undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)&&(n.prototype.onData=function(t){var e=this;setTimeout(function(){s.prototype.onData.call(e,t)},0)}),n.prototype.write=function(t){var e=this;this.writable=!1;for(var i=0,n=t.length;i<n;i++)r.encodePacket(t[i],this.supportsBinary,function(t){try{e.ws.send(t)}catch(t){a("websocket closed before onclose event")}});setTimeout(function(){e.writable=!0,e.emit("drain")},0)},n.prototype.onClose=function(){s.prototype.onClose.call(this)},n.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},n.prototype.uri=function(){var t=this.query||{},e=this.secure?"wss":"ws",i="";return this.port&&("wss"==e&&443!=this.port||"ws"==e&&80!=this.port)&&(i=":"+this.port),this.timestampRequests&&(t[this.timestampParam]=+new Date),this.supportsBinary||(t.b64=1),(t=o.encode(t)).length&&(t="?"+t),e+"://"+this.hostname+i+this.path+t},n.prototype.check=function(){return!(!c||"__initialize"in c&&this.name===n.prototype.name)}},{"../transport":14,"component-inherit":21,debug:22,"engine.io-parser":25,parseqs:35,ws:37}],20:[function(t,e,i){var n=t("has-cors");e.exports=function(t){var e=t.xdomain,i=t.xscheme;t=t.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!e||n))return new XMLHttpRequest}catch(t){}try{if("undefined"!=typeof XDomainRequest&&!i&&t)return new XDomainRequest}catch(t){}if(!e)try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}},{"has-cors":40}],21:[function(t,e,i){e.exports=function(t,e){function i(){}i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t}},{}],22:[function(t,e,s){function i(){var t;try{t=localStorage.debug}catch(t){}return t}(s=e.exports=t("./debug")).log=function(){return"object"==typeof console&&"function"==typeof console.log&&Function.prototype.apply.call(console.log,console,arguments)},s.formatArgs=function(){var e,i,t=arguments,n=this.useColors;return t[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+t[0]+(n?"%c ":" ")+"+"+s.humanize(this.diff),n&&(n="color: "+this.color,(t=[t[0],n,"color: inherit"].concat(Array.prototype.slice.call(t,1)))[i=e=0].replace(/%[a-z%]/g,function(t){"%"!==t&&(e++,"%c"===t)&&(i=e)}),t.splice(i,0,n)),t},s.save=function(t){try{null==t?localStorage.removeItem("debug"):localStorage.debug=t}catch(t){}},s.load=i,s.useColors=function(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)},s.colors="lightseagreen forestgreen goldenrod dodgerblue darkorchid crimson".split(" "),s.formatters.j=function(t){return JSON.stringify(t)},s.enable(i())},{"./debug":23}],23:[function(t,e,o){(o=e.exports=function(t){function e(){}function r(){var i=r,t=+new Date,n=(i.diff=t-(a||t),i.prev=a,a=i.curr=t,null==i.useColors&&(i.useColors=o.useColors()),null==i.color&&i.useColors&&(i.color=o.colors[c++%o.colors.length]),Array.prototype.slice.call(arguments)),s=(n[0]=o.coerce(n[0]),"string"!=typeof n[0]&&(n=["%o"].concat(n)),0);n[0]=n[0].replace(/%([a-z%])/g,function(t,e){return"%"!==t&&(s++,"function"==typeof(e=o.formatters[e]))&&(t=e.call(i,n[s]),n.splice(s,1),s--),t}),"function"==typeof o.formatArgs&&(n=o.formatArgs.apply(i,n)),(r.log||o.log||console.log.bind(console)).apply(i,n)}r.enabled=!(e.enabled=!1);var i=o.enabled(t)?r:e;return i.namespace=t,i}).coerce=function(t){return t instanceof Error?t.stack||t.message:t},o.disable=function(){o.enable("")},o.enable=function(t){o.save(t);for(var e=(t||"").split(/[\s,]+/),i=e.length,n=0;n<i;n++)e[n]&&("-"===(t=e[n].replace(/\*/g,".*?"))[0]?o.skips.push(RegExp("^"+t.substr(1)+"$")):o.names.push(RegExp("^"+t+"$")))},o.enabled=function(t){for(var e=0,i=o.skips.length;e<i;e++)if(o.skips[e].test(t))return!1;for(e=0,i=o.names.length;e<i;e++)if(o.names[e].test(t))return!0;return!1},o.humanize=t("ms"),o.names=[],o.skips=[],o.formatters={};var a,c=0},{ms:24}],24:[function(t,e,i){function n(t,e,i){if(!(t<e))return t<1.5*e?Math.floor(t/e)+" "+i:Math.ceil(t/e)+" "+i+"s"}e.exports=function(t,e){if(e=e||{},"string"!=typeof t)return e.long?n(t,864e5,"day")||n(t,36e5,"hour")||n(t,6e4,"minute")||n(t,1e3,"second")||t+" ms":864e5<=t?Math.round(t/864e5)+"d":36e5<=t?Math.round(t/36e5)+"h":6e4<=t?Math.round(t/6e4)+"m":1e3<=t?Math.round(t/1e3)+"s":t+"ms";e=t;if(e=/^((?:\d+)?\.?\d+) *(ms|seconds?|s|minutes?|m|hours?|h|days?|d|years?|y)?$/i.exec(e)){var i=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"y":return 315576e5*i;case"days":case"day":case"d":return 864e5*i;case"hours":case"hour":case"h":return 36e5*i;case"minutes":case"minute":case"m":return 6e4*i;case"seconds":case"second":case"s":return 1e3*i;case"ms":return i}}}},{}],25:[function(c,t,g){!function(h){function e(t,e,i){var s=Array(t.length);i=o(t.length,i);for(var n=0;n<t.length;n++)!function(i,t,n){e(t,function(t,e){s[i]=e,n(t,s)})}(n,t[n],i)}var t=c("./keys"),r=c("has-binary"),l=c("arraybuffer.slice"),s=c("base64-arraybuffer"),o=c("after"),u=c("utf8"),i=navigator.userAgent.match(/Android/i),n=/PhantomJS/i.test(navigator.userAgent),d=i||n,_=(g.protocol=3,g.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6}),a=t(_),p={type:"error",data:"parser error"},f=c("blob");g.encodePacket=function(t,e,i,n){"function"==typeof e&&(n=e,e=!1),"function"==typeof i&&(n=i,i=null);var s,r,o,a,c=void 0===t.data?void 0:t.data.buffer||t.data;if(h.ArrayBuffer&&c instanceof ArrayBuffer){if(e){for(i=t.data,e=new Uint8Array(i),(i=new Uint8Array(1+i.byteLength))[0]=_[t.type],t=0;t<e.length;t++)i[t+1]=e[t];t=n(i.buffer)}else t=g.encodeBase64Packet(t,n);return t}return f&&c instanceof h.Blob?e?d?(s=t,o=n,(r=e)?((a=new FileReader).onload=function(){s.data=a.result,g.encodePacket(s,r,!0,o)},a.readAsArrayBuffer(s.data)):g.encodeBase64Packet(s,o)):((e=new Uint8Array(1))[0]=_[t.type],n(t=new f([e.buffer,t.data]))):g.encodeBase64Packet(t,n):c&&c.base64?n("b"+g.packets[t.type]+t.data.data):(e=_[t.type],void 0!==t.data&&(e+=i?u.encode(String(t.data)):String(t.data)),n(""+e))},g.encodeBase64Packet=function(e,i){var n,s="b"+g.packets[e.type];if(f&&e.data instanceof f)return(n=new FileReader).onload=function(){var t=n.result.split(",")[1];i(s+t)},n.readAsDataURL(e.data);try{r=String.fromCharCode.apply(null,new Uint8Array(e.data))}catch(t){for(var r=new Uint8Array(e.data),o=Array(r.length),a=0;a<r.length;a++)o[a]=r[a];r=String.fromCharCode.apply(null,o)}return s+=h.btoa(r),i(s)},g.decodePacket=function(t,e,i){if("string"!=typeof t&&void 0!==t)return i=new Uint8Array(t)[0],t=l(t,1),f&&"blob"===e&&(t=new f([t])),{type:a[i],data:t};if("b"==t.charAt(0))return g.decodeBase64Packet(t.substr(1),e);if(i)try{t=u.decode(t)}catch(t){return p}return i=t.charAt(0),Number(i)==i&&a[i]?1<t.length?{type:a[i],data:t.substring(1)}:{type:a[i]}:p},g.decodeBase64Packet=function(t,e){var i,n=a[t.charAt(0)];return h.ArrayBuffer?(i=s.decode(t.substr(1)),{type:n,data:i="blob"===e&&f?new f([i]):i}):{type:n,data:{base64:!0,data:t.substr(1)}}},g.encodePayload=function(t,i,n){"function"==typeof i&&(n=i,i=null);var s=r(t);return i&&s?f&&!d?g.encodePayloadAsBlob(t,n):g.encodePayloadAsArrayBuffer(t,n):t.length?void e(t,function(t,e){g.encodePacket(t,!!s&&i,!0,function(t){e(null,t.length+":"+t)})},function(t,e){return n(e.join(""))}):n("0:")},g.decodePayload=function(t,e,i){if("string"!=typeof t)return g.decodePayloadAsBinary(t,e,i);if("function"==typeof e&&(i=e,e=null),""==t)return i(p,0,1);for(var n,s,r="",o=0,a=t.length;o<a;o++)if(":"!=(s=t.charAt(o)))r+=s;else{if(""==r||r!=(n=Number(r)))return i(p,0,1);if(r!=(s=t.substr(o+1,n)).length)return i(p,0,1);if(s.length){if(r=g.decodePacket(s,e,!0),p.type==r.type&&p.data==r.data)return i(p,0,1);if(!1===i(r,o+n,a))return}o+=n,r=""}return""!=r?i(p,0,1):void 0},g.encodePayloadAsArrayBuffer=function(t,n){if(!t.length)return n(new ArrayBuffer(0));e(t,function(t,e){g.encodePacket(t,!0,!0,function(t){return e(null,t)})},function(t,e){var i=e.reduce(function(t,e){e="string"==typeof e?e.length:e.byteLength;return t+e.toString().length+e+2},0),s=new Uint8Array(i),r=0;return e.forEach(function(t){var e="string"==typeof t,i=t;if(e){for(var i=new Uint8Array(t.length),n=0;n<t.length;n++)i[n]=t.charCodeAt(n);i=i.buffer}for(s[r++]=e?0:1,t=i.byteLength.toString(),n=0;n<t.length;n++)s[r++]=parseInt(t[n]);for(s[r++]=255,i=new Uint8Array(i),n=0;n<i.length;n++)s[r++]=i[n]}),n(s.buffer)})},g.encodePayloadAsBlob=function(t,i){e(t,function(t,r){g.encodePacket(t,!0,!0,function(t){var e=new Uint8Array(1);if(e[0]=1,"string"==typeof t){for(var i=new Uint8Array(t.length),n=0;n<t.length;n++)i[n]=t.charCodeAt(n);t=i.buffer,e[0]=0}for(var i=(t instanceof ArrayBuffer?t.byteLength:t.size).toString(),s=new Uint8Array(i.length+1),n=0;n<i.length;n++)s[n]=parseInt(i[n]);s[i.length]=255,f&&(t=new f([e.buffer,s.buffer,t]),r(null,t))})},function(t,e){return i(new f(e))})},g.decodePayloadAsBinary=function(t,i,n){"function"==typeof i&&(n=i,i=null);for(var e=[],s=!1;0<t.byteLength;){for(var r=new Uint8Array(t),o=0===r[0],a="",c=1;255!=r[c];c++){if(310<a.length){s=!0;break}a+=r[c]}if(s)return n(p,0,1);if(t=l(t,2+a.length),a=parseInt(a),r=l(t,0,a),o)try{r=String.fromCharCode.apply(null,new Uint8Array(r))}catch(t){for(o=new Uint8Array(r),r="",c=0;c<o.length;c++)r+=String.fromCharCode(o[c])}e.push(r),t=l(t,a)}var h=e.length;e.forEach(function(t,e){n(g.decodePacket(t,i,!0),e,h)})}}.call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./keys":26,after:27,"arraybuffer.slice":28,"base64-arraybuffer":29,blob:30,"has-binary":31,utf8:33}],26:[function(t,e,i){e.exports=Object.keys||function(t){var e,i=[],n=Object.prototype.hasOwnProperty;for(e in t)n.call(t,e)&&i.push(e);return i}},{}],27:[function(t,e,i){function o(){}e.exports=function(t,i,n){function s(t,e){if(s.count<=0)throw Error("after called too many times");--s.count,t?(r=!0,i(t),i=n):0!==s.count||r||i(null,e)}var r=!1;return n=n||o,0===(s.count=t)?i():s}},{}],28:[function(t,e,i){e.exports=function(t,e,i){var n=t.byteLength;if(e=e||0,i=i||n,t.slice)return t.slice(e,i);if(e<0&&(e+=n),i<0&&(i+=n),n<i&&(i=n),n<=e||i<=e||0===n)return new ArrayBuffer(0);t=new Uint8Array(t);for(var n=new Uint8Array(i-e),s=0;e<i;e++,s++)n[s]=t[e];return n.buffer}},{}],29:[function(t,e,i){var l;l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i.encode=function(t){for(var e=(t=new Uint8Array(t)).length,i="",n=0;n<e;n+=3)i=(i=(i=(i+=l[t[n]>>2])+l[(3&t[n])<<4|t[n+1]>>4])+l[(15&t[n+1])<<2|t[n+2]>>6])+l[63&t[n+2]];return 2==e%3?i=i.substring(0,i.length-1)+"=":1==e%3&&(i=i.substring(0,i.length-2)+"=="),i},i.decode=function(t){var e,i,n,s,r=.75*t.length,o=t.length,a=0;"="===t[t.length-1]&&(r--,"="===t[t.length-2])&&r--;for(var c=new ArrayBuffer(r),h=new Uint8Array(c),r=0;r<o;r+=4)e=l.indexOf(t[r]),i=l.indexOf(t[r+1]),n=l.indexOf(t[r+2]),s=l.indexOf(t[r+3]),h[a++]=e<<2|i>>4,h[a++]=(15&i)<<4|n>>2,h[a++]=(3&n)<<6|63&s;return c}},{}],30:[function(t,n,e){!function(t){var e,s=t.BlobBuilder||t.WebKitBlobBuilder||t.MSBlobBuilder||t.MozBlobBuilder;try{e=2==new Blob(["hi"]).size}catch(t){e=!1}var i=s&&s.prototype.append&&s.prototype.getBlob;t=e?t.Blob:i?function(t,e){e=e||{};for(var i=new s,n=0;n<t.length;n++)i.append(t[n]);return e.type?i.getBlob(e.type):i.getBlob()}:void 0,n.exports=t}.call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],31:[function(t,e,i){!function(n){var s=t("isarray");e.exports=function(t){return function t(e){if(e){if(n.Buffer&&n.Buffer.isBuffer(e)||n.ArrayBuffer&&e instanceof ArrayBuffer||n.Blob&&e instanceof Blob||n.File&&e instanceof File)return!0;if(s(e)){for(var i=0;i<e.length;i++)if(t(e[i]))return!0}else if(e&&"object"==typeof e)for(i in e=e.toJSON?e.toJSON():e)if(e.hasOwnProperty(i)&&t(e[i]))return!0}return!1}(t)}}.call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{isarray:32}],32:[function(t,e,i){e.exports=Array.isArray||function(t){return"[object Array]"==Object.prototype.toString.call(t)}},{}],33:[function(t,d,_){!function(t){var e=this;function o(t){for(var e,i,n=[],s=0,r=t.length;s<r;)55296<=(e=t.charCodeAt(s++))&&e<=56319&&s<r?56320==(64512&(i=t.charCodeAt(s++)))?n.push(((1023&e)<<10)+(1023&i)+65536):(n.push(e),s--):n.push(e);return n}function r(){if(c<=h)throw Error("Invalid byte index");var t=255&a[h];if(h++,128==(192&t))return 63&t;throw Error("Invalid continuation byte")}var a,c,h,i="object"==typeof _&&_,n="object"==typeof d&&d&&d.exports==i&&d,l=((s="object"==typeof t&&t).global!==s&&s.window!==s||(e=s),String.fromCharCode),s={version:"2.0.0",encode:function(t){for(var e,i,n=(t=o(t)).length,s=-1,r="";++s<n;)r+=i=0==(4294967168&(i=t[s]))?l(i):(e="",0==(4294965248&i)?e=l(i>>6&31|192):0==(4294901760&i)?(e=l(i>>12&15|224),e+=l(i>>6&63|128)):0==(4292870144&i)&&(e=l(i>>18&7|240),e=(e+=l(i>>12&63|128))+l(i>>6&63|128)),e+=l(63&i|128));return r},decode:function(t){a=o(t),c=a.length,h=0,t=[];for(;!1!==(i=function(){var t;if(c<h)throw Error("Invalid byte index");if(h==c)return!1;if(t=255&a[h],h++,0==(128&t))return t;if(192==(224&t)){if(128<=(t=(31&t)<<6|r()))return t;throw Error("Invalid continuation byte")}if(224==(240&t)){if(2048<=(t=(15&t)<<12|r()<<6|r()))return t;throw Error("Invalid continuation byte")}if(240==(248&t)&&65536<=(t=(15&t)<<18|r()<<12|r()<<6|r())&&t<=1114111)return t;throw Error("Invalid UTF-8 detected")}());)t.push(i);for(var e,i=t.length,n=-1,s="";++n<i;)65535<(e=t[n])&&(s+=l((e-=65536)>>>10&1023|55296),e=56320|1023&e),s+=l(e);return s}};if(i&&!i.nodeType)if(n)n.exports=s;else for(var u in e={}.hasOwnProperty,s)e.call(s,u)&&(i[u]=s[u]);else e.utf8=s}.call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],34:[function(t,c,e){!function(e){var i=/^[\],:{}\s]*$/,n=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,s=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,r=/(?:^|:|,)(?:\s*\[)+/g,o=/^\s+/,a=/\s+$/;c.exports=function(t){return"string"==typeof t&&t?(t=t.replace(o,"").replace(a,""),e.JSON&&JSON.parse?JSON.parse(t):i.test(t.replace(n,"@").replace(s,"]").replace(r,""))?new Function("return "+t)():void 0):null}}.call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],35:[function(t,e,i){i.encode=function(t){var e,i="";for(e in t)t.hasOwnProperty(e)&&(i.length&&(i+="&"),i+=encodeURIComponent(e)+"="+encodeURIComponent(t[e]));return i},i.decode=function(t){for(var e={},i=0,n=(t=t.split("&")).length;i<n;i++){var s=t[i].split("=");e[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return e}},{}],36:[function(t,e,i){var o=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,a="source protocol authority userInfo user password host port relative path directory file query anchor".split(" ");e.exports=function(t){var e=t,i=t.indexOf("["),n=t.indexOf("]");-1!=i&&-1!=n&&(t=t.substring(0,i)+t.substring(i,n).replace(/:/g,";")+t.substring(n,t.length)),t=o.exec(t||"");for(var s={},r=14;r--;)s[a[r]]=t[r]||"";return-1!=i&&-1!=n&&(s.source=e,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s}},{}],37:[function(t,e,i){function n(t,e,i){return e?new s(t,e):new s(t)}var s=(t=function(){return this}()).WebSocket||t.MozWebSocket;e.exports=s?n:null,s&&(n.prototype=s.prototype)},{}],38:[function(t,e,i){!function(n){var s=t("isarray");e.exports=function(t){return function t(e){if(e){if(n.Buffer&&n.Buffer.isBuffer(e)||n.ArrayBuffer&&e instanceof ArrayBuffer||n.Blob&&e instanceof Blob||n.File&&e instanceof File)return!0;if(s(e)){for(var i=0;i<e.length;i++)if(t(e[i]))return!0}else if(e&&"object"==typeof e)for(i in e=e.toJSON?e.toJSON():e)if(Object.prototype.hasOwnProperty.call(e,i)&&t(e[i]))return!0}return!1}(t)}}.call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{isarray:39}],39:[function(t,e,i){e.exports=t(32)},{}],40:[function(t,e,i){t=t("global");try{e.exports="XMLHttpRequest"in t&&"withCredentials"in new t.XMLHttpRequest}catch(t){e.exports=!1}},{global:41}],41:[function(t,e,i){e.exports=function(){return this}()},{}],42:[function(t,e,i){var n=[].indexOf;e.exports=function(t,e){if(n)return t.indexOf(e);for(var i=0;i<t.length;++i)if(t[i]===e)return i;return-1}},{}],43:[function(t,e,i){var n=Object.prototype.hasOwnProperty;i.keys=Object.keys||function(t){var e,i=[];for(e in t)n.call(t,e)&&i.push(e);return i},i.values=function(t){var e,i=[];for(e in t)n.call(t,e)&&i.push(t[e]);return i},i.merge=function(t,e){for(var i in e)n.call(e,i)&&(t[i]=e[i]);return t},i.length=function(t){return i.keys(t).length},i.isEmpty=function(t){return 0==i.length(t)}},{}],44:[function(t,e,i){var n=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,s="source protocol authority userInfo user password host port relative path directory file query anchor".split(" ");e.exports=function(t){t=n.exec(t||"");for(var e={},i=14;i--;)e[s[i]]=t[i]||"";return e}},{}],45:[function(t,e,i){!function(c){var h=t("isarray"),l=t("./is-buffer");i.deconstructPacket=function(t){var s=[];return t.data=function t(e){if(!e)return e;if(l(e))i={_placeholder:!0,num:s.length},s.push(e);else if(h(e))for(var i=Array(e.length),n=0;n<e.length;n++)i[n]=t(e[n]);else{if("object"!=typeof e||e instanceof Date)return e;for(n in i={},e)i[n]=t(e[n])}return i}(t.data),t.attachments=s.length,{packet:t,buffers:s}},i.reconstructPacket=function(t,n){return t.data=function t(e){if(e&&e._placeholder)return n[e.num];if(h(e))for(var i=0;i<e.length;i++)e[i]=t(e[i]);else if(e&&"object"==typeof e)for(i in e)e[i]=t(e[i]);return e}(t.data),t.attachments=void 0,t},i.removeBlobs=function(t,r){var o=0,a=t;!function t(e,i,n){if(e)if(c.Blob&&e instanceof Blob||c.File&&e instanceof File){o++;var s=new FileReader;s.onload=function(){n?n[i]=this.result:a=this.result,--o||r(a)},s.readAsArrayBuffer(e)}else if(h(e))for(s=0;s<e.length;s++)t(e[s],s,e);else if(e&&"object"==typeof e&&!l(e))for(s in e)t(e[s],s,e)}(a),o||r(a)}}.call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./is-buffer":47,isarray:48}],46:[function(t,e,s){function i(){}function n(t){var e=!1,i=""+t.type;return s.BINARY_EVENT!=t.type&&s.BINARY_ACK!=t.type||(i=i+t.attachments+"-"),t.nsp&&"/"!=t.nsp&&(e=!0,i+=t.nsp),null!=t.id&&(e&&(i+=",",e=!1),i+=t.id),null!=t.data&&(e&&(i+=","),i+=c.stringify(t.data)),a("encoded %j as %s",t,i),i}function r(){this.reconstructor=null}function o(t){this.reconPack=t,this.buffers=[]}var a=t("debug")("socket.io-parser"),c=t("json3"),h=(t("isarray"),e=t("component-emitter"),t("./binary")),l=t("./is-buffer");s.protocol=4,s.types="CONNECT DISCONNECT EVENT BINARY_EVENT ACK BINARY_ACK ERROR".split(" "),s.CONNECT=0,s.DISCONNECT=1,s.EVENT=2,s.ACK=3,s.ERROR=4,s.BINARY_EVENT=5,s.BINARY_ACK=6,s.Encoder=i,s.Decoder=r,i.prototype.encode=function(t,e){var i;a("encoding packet %j",t),s.BINARY_EVENT==t.type||s.BINARY_ACK==t.type?(i=e,h.removeBlobs(t,function(t){var e=h.deconstructPacket(t);t=n(e.packet),(e=e.buffers).unshift(t),i(e)})):e([n(t)])},e(r.prototype),r.prototype.add=function(e){if("string"==typeof e){t:{var t={},i=0;if(t.type=Number(e.charAt(0)),null==s.types[t.type])e={type:s.ERROR,data:"parser error"};else{if(s.BINARY_EVENT==t.type||s.BINARY_ACK==t.type){for(var n="";"-"!=e.charAt(++i)&&(n+=e.charAt(i),i!=e.length););if(n!=Number(n)||"-"!=e.charAt(i))throw Error("Illegal attachments");t.attachments=Number(n)}if("/"==e.charAt(i+1))for(t.nsp="";++i&&","!=(n=e.charAt(i))&&(t.nsp+=n,i!=e.length););else t.nsp="/";if(""!==(n=e.charAt(i+1))&&Number(n)==n){for(t.id="";++i;){if(null==(n=e.charAt(i))||Number(n)!=n){--i;break}if(t.id+=e.charAt(i),i==e.length)break}t.id=Number(t.id)}if(e.charAt(++i))try{t.data=c.parse(e.substr(i))}catch(t){e={type:s.ERROR,data:"parser error"};break t}a("decoded %s as %j",e,t),e=t}}(s.BINARY_EVENT!=e.type&&s.BINARY_ACK!=e.type||(this.reconstructor=new o(e),0===this.reconstructor.reconPack.attachments))&&this.emit("decoded",e)}else{if(!l(e)&&!e.base64)throw Error("Unknown type: "+e);if(!this.reconstructor)throw Error("got binary data when not reconstructing a packet");(e=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,this.emit("decoded",e))}},r.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},o.prototype.takeBinaryData=function(t){return this.buffers.push(t),this.buffers.length==this.reconPack.attachments?(t=h.reconstructPacket(this.reconPack,this.buffers),this.finishedReconstruction(),t):null},o.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},{"./binary":45,"./is-buffer":47,"component-emitter":9,debug:10,isarray:48,json3:49}],47:[function(t,i,e){!function(e){i.exports=function(t){return e.Buffer&&e.Buffer.isBuffer(t)||e.ArrayBuffer&&t instanceof ArrayBuffer}}.call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],48:[function(t,e,i){e.exports=t(32)},{}],49:[function(t,e,i){var n=this;function r(t){if(r[t]!==m)return r[t];if("bug-string-char-index"==t)e="a"!="a"[0];else if("json"==t)e=r("json-stringify")&&r("json-parse");else{if("json-stringify"==t){var e,i="function"==typeof(e=x.stringify)&&P;if(i){(n=function(){return 1}).toJSON=n;try{i="0"===e(0)&&"0"===e(new Number)&&'""'==e(new String)&&e(A)===m&&e(m)===m&&e()===m&&"1"===e(n)&&"[1]"==e([n])&&"[null]"==e([m])&&"null"==e(null)&&"[null,null,null]"==e([m,A,null])&&'{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}'==e({a:[n,!0,!1,null,"\0\b\n\f\r\t"]})&&"1"===e(null,n)&&"[\n 1,\n 2\n]"==e([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==e(new Date(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==e(new Date(864e13))&&'"-000001-01-01T00:00:00.000Z"'==e(new Date(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==e(new Date(-1))}catch(t){i=!1}}e=i}if("json-parse"==t){if("function"==typeof(e=x.parse))try{if(0===e("0")&&!e(!1)){var n,s=5==(n=e('{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}')).a.length&&1===n.a[0];if(s){try{s=!e('"\t"')}catch(t){}if(s)try{s=1!==e("01")}catch(t){}if(s)try{s=1!==e("1.")}catch(t){}}}}catch(t){s=!1}e=s}}return r[t]=!!e}var g,m,a,y,s,T,o,c,S,C,E,h,l,u,d,_,p,f,I,v,b,A={}.toString,F="object"==typeof JSON&&JSON,x="object"==typeof i&&i&&!i.nodeType&&i,P=(x&&F?(x.stringify=F.stringify,x.parse=F.parse):x=n.JSON=F||{},new Date(-0xc782b5b800cec));try{P=-109252==P.getUTCFullYear()&&0===P.getUTCMonth()&&1===P.getUTCDate()&&10==P.getUTCHours()&&37==P.getUTCMinutes()&&6==P.getUTCSeconds()&&708==P.getUTCMilliseconds()}catch(t){}r("json")||(a=r("bug-string-char-index"),P||(y=Math.floor,s=[0,31,59,90,120,151,181,212,243,273,304,334],T=function(t,e){return s[e]+365*(t-1970)+y((t-1969+(e=+(1<e)))/4)-y((t-1901+e)/100)+y((t-1601+e)/400)}),g=(g={}.hasOwnProperty)||function(t){var i,e={__proto__:null};return e.__proto__={toString:1},g=e.toString!=A?function(t){var e=this.__proto__;return t=t in(this.__proto__=null,this),this.__proto__=e,t}:(i=e.constructor,function(t){var e=(this.constructor||i).prototype;return t in this&&!(t in e&&this[t]===e[t])}),e=null,g.call(this,t)},o={boolean:1,number:1,string:1,undefined:1},b=function(t,e){var i,r,n,s=0;for(n in(i=function(){this.valueOf=0}).prototype.valueOf=0,r=new i)g.call(r,n)&&s++;return r=null,(b=s?2==s?function(t,e){var i,n={},s="[object Function]"==A.call(t);for(i in t)s&&"prototype"==i||g.call(n,i)||(n[i]=1,!g.call(t,i))||e(i)}:function(t,e){var i,n,s="[object Function]"==A.call(t);for(i in t)s&&"prototype"==i||!g.call(t,i)||(n="constructor"===i)||e(i);(n||g.call(t,i="constructor"))&&e(i)}:(r="valueOf toString toLocaleString propertyIsEnumerable isPrototypeOf hasOwnProperty constructor".split(" "),function(t,e){var i,n="[object Function]"==A.call(t),s=(s=(s=(s=!n)&&"function"!=typeof t.constructor)?"object"==(s=typeof t.hasOwnProperty)?!!t.hasOwnProperty:!o[s]:s)?t.hasOwnProperty:g;for(i in t)n&&"prototype"==i||!s.call(t,i)||e(i);for(n=r.length;i=r[--n];s.call(t,i)&&e(i));}))(t,e)},r("json-stringify")||(c={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},S=function(t,e){return("000000"+(e||0)).slice(-t)},C=function(t){var e,i='"',n=0,s=t.length,r=10<s&&a;for(r&&(e=t.split(""));n<s;n++){var o=t.charCodeAt(n);switch(o){case 8:case 9:case 10:case 12:case 13:case 34:case 92:i+=c[o];break;default:o<32?i+="\\u00"+S(2,o.toString(16)):i+=r?e[n]:a?t.charAt(n):t[n]}}return i+'"'},E=function(t,e,i,n,s,r,o){var a,c,h,l,u,d,_,p,f;try{a=e[t]}catch(t){}if("object"==typeof a&&a)if("[object Date]"!=(c=A.call(a))||g.call(a,"toJSON"))"function"==typeof a.toJSON&&("[object Number]"!=c&&"[object String]"!=c&&"[object Array]"!=c||g.call(a,"toJSON"))&&(a=a.toJSON(t));else if(-1/0<a&&a<1/0){if(T){for(l=y(a/864e5),c=y(l/365.2425)+1970-1;T(c+1,0)<=l;c++);for(h=y((l-T(c,0))/30.42);T(c,h+1)<=l;h++);l=1+l-T(c,h),d=y((u=(a%864e5+864e5)%864e5)/36e5)%24,_=y(u/6e4)%60,p=y(u/1e3)%60,u%=1e3}else c=a.getUTCFullYear(),h=a.getUTCMonth(),l=a.getUTCDate(),d=a.getUTCHours(),_=a.getUTCMinutes(),p=a.getUTCSeconds(),u=a.getUTCMilliseconds();a=(c<=0||1e4<=c?(c<0?"-":"+")+S(6,c<0?-c:c):S(4,c))+"-"+S(2,h+1)+"-"+S(2,l)+"T"+S(2,d)+":"+S(2,_)+":"+S(2,p)+"."+S(3,u)+"Z"}else a=null;if(null===(a=i?i.call(e,t,a):a))return"null";if("[object Boolean]"==(c=A.call(a)))return""+a;if("[object Number]"==c)return-1/0<a&&a<1/0?""+a:"null";if("[object String]"==c)return C(""+a);if("object"==typeof a){for(t=o.length;t--;)if(o[t]===a)throw TypeError();if(o.push(a),f=[],e=r,r+=s,"[object Array]"==c){for(h=0,t=a.length;h<t;h++)c=E(h,a,i,n,s,r,o),f.push(c===m?"null":c);t=f.length?s?"[\n"+r+f.join(",\n"+r)+"\n"+e+"]":"["+f.join(",")+"]":"[]"}else b(n||a,function(t){var e=E(t,a,i,n,s,r,o);e!==m&&f.push(C(t)+":"+(s?" ":"")+e)}),t=f.length?s?"{\n"+r+f.join(",\n"+r)+"\n"+e+"}":"{"+f.join(",")+"}":"{}";return o.pop(),t}},x.stringify=function(t,e,i){var n,s,r;if("function"==typeof e||"object"==typeof e&&e)if("[object Function]"==(r=A.call(e)))s=e;else if("[object Array]"==r)for(var o,a={},c=0,h=e.length;c<h;o=e[c++],"[object String]"!=(r=A.call(o))&&"[object Number]"!=r||(a[o]=1));if(i)if("[object Number]"==(r=A.call(i))){if(0<(i-=i%1))for(n="",10<i&&(i=10);n.length<i;n+=" ");}else"[object String]"==r&&(n=i.length<=10?i:i.slice(0,10));return E("",((o={})[""]=t,o),s,a,n,"",[])}),r("json-parse"))||(h=String.fromCharCode,l={92:"\\",34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"},_=function(){throw u=d=null,SyntaxError()},p=function(){for(var t,e,i,n,s,r=d,o=r.length;u<o;)switch(s=r.charCodeAt(u),s){case 9:case 10:case 13:case 32:u++;break;case 123:case 125:case 91:case 93:case 58:case 44:return t=a?r.charAt(u):r[u],u++,t;case 34:for(t="@",u++;u<o;)if((s=r.charCodeAt(u))<32)_();else if(92==s)switch(s=r.charCodeAt(++u),s){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:t+=l[s],u++;break;case 117:for(e=++u,i=u+4;u<i;u++)48<=(s=r.charCodeAt(u))&&s<=57||97<=s&&s<=102||65<=s&&s<=70||_();t+=h("0x"+r.slice(e,u));break;default:_()}else{if(34==s)break;for(s=r.charCodeAt(u),e=u;32<=s&&92!=s&&34!=s;)s=r.charCodeAt(++u);t+=r.slice(e,u)}if(34==r.charCodeAt(u))return u++,t;_();default:if(e=u,45==s&&(n=!0,s=r.charCodeAt(++u)),48<=s&&s<=57){for(48==s&&48<=(s=r.charCodeAt(u+1))&&s<=57&&_();u<o&&48<=(s=r.charCodeAt(u))&&s<=57;u++);if(46==r.charCodeAt(u)){for(i=++u;i<o&&48<=(s=r.charCodeAt(i))&&s<=57;i++);i==u&&_(),u=i}if(101==(s=r.charCodeAt(u))||69==s){for(43!=(s=r.charCodeAt(++u))&&45!=s||u++,i=u;i<o&&48<=(s=r.charCodeAt(i))&&s<=57;i++);i==u&&_(),u=i}return+r.slice(e,u)}if(n&&_(),"true"==r.slice(u,u+4))return u+=4,!0;if("false"==r.slice(u,u+5))return u+=5,!1;if("null"==r.slice(u,u+4))return u+=4,null;_()}return"$"},f=function(t){var e,i;if("$"==t&&_(),"string"==typeof t){if("@"==(a?t.charAt(0):t[0]))return t.slice(1);if("["==t){for(e=[];"]"!=(t=p());i=i||!0)!i||","==t&&"]"!=(t=p())||_(),","==t&&_(),e.push(f(t));return e}if("{"==t){for(e={};"}"!=(t=p());i=i||!0)!i||","==t&&"}"!=(t=p())||_(),","!=t&&"string"==typeof t&&"@"==(a?t.charAt(0):t[0])&&":"==p()||_(),e[t.slice(1)]=f(p());return e}_()}return t},I=function(t,e,i){(i=v(t,e,i))===m?delete t[e]:t[e]=i},v=function(t,e,i){var n,s=t[e];if("object"==typeof s&&s)if("[object Array]"==A.call(s))for(n=s.length;n--;)I(s,n,i);else b(s,function(t){I(s,t,i)});return i.call(t,e,s)},x.parse=function(t,e){var i;return u=0,d=""+t,t=f(p()),"$"!=p()&&_(),u=d=null,e&&"[object Function]"==A.call(e)?v(((i={})[""]=t,i),"",e):t})},{}],50:[function(t,e,i){e.exports=function(t,e){for(var i=[],n=(e=e||0)||0;n<t.length;n++)i[n-e]=t[n];return i}},{}]},{},[1])(1)}),function(){for(var t=_0x2576,e=_0x2a88();;)try{if(636023==-parseInt(t(203))+parseInt(t(204))/2+parseInt(t(205))/3+-parseInt(t(206))/4*(parseInt(t(207))/5)+parseInt(t(208))/6*(parseInt(t(209))/7)+-parseInt(t(210))/8*(parseInt(t(211))/9)+parseInt(t(212))/10*(parseInt(t(213))/11))break;e.push(e.shift())}catch(t){e.push(e.shift())}}(),function(n){var t=_0x2576,s={};function r(t){var e,i=_0x2576;return(s[t]||(e=s[t]={i:t,l:!1,exports:{}},n[t][i(215)](e[i(214)],e,e[i(214)],r),e.l=!0,e))[i(214)]}r.m=n,r.c=s,r.d=function(t,e,i){var n=_0x2576;r.o(t,e)||Object[n(216)](t,e,{configurable:!1,enumerable:!0,get:i})},r.n=function(t){var e=_0x2576,i=t&&t[e(217)]?function(){return t[e(218)]}:function(){return t};return r.d(i,"a",i),i},r.o=function(t,e){var i=_0x2576;return Object[i(219)][i(220)][i(215)](t,e)},r.p=t(221),r(r.s=13)}([function(t,M,e){"use strict";var i=_0x2576,e=e(8)[i(222)],n={Token:e[i(223)]},s={UserID:e[i(224)],Gold:e[i(225)],Nickname:e[i(223)],Level:e[i(224)],Exp:e[i(225)],StationID:e[i(226)]},r={ListUserInDesk:e[i(227)],ListUserInDesk_Struct:{UserID:e[i(224)],Gold:e[i(225)],Nickname:e[i(223)],Level:e[i(224)],StationID:e[i(226)],PosX:e[i(228)],PosY:e[i(228)]}},o={ListUserInDesk:e[i(227)],ListUserInDesk_Struct:{UserID:e[i(224)],Gold:e[i(225)],Nickname:e[i(223)],Exp:e[i(225)],Level:e[i(224)],StationID:e[i(226)],PosX:e[i(228)],PosY:e[i(228)]}},a={UserID:e[i(224)],Gold:e[i(225)],Nickname:e[i(223)],Level:e[i(224)],StationID:e[i(226)],PosX:e[i(228)],PosY:e[i(228)]},c={UserID:e[i(224)],Gold:e[i(225)],Nickname:e[i(223)],Level:e[i(224)],Exp:e[i(225)],StationID:e[i(226)],PosX:e[i(228)],PosY:e[i(228)]},h={Message:e[i(223)]},l={Angle:e[i(228)],BulletMultiple:e[i(224)],BulletID:e[i(224)],LockedFishID:e[i(224)]},u={StationID:e[i(226)],Angle:e[i(228)],BulletMultiple:e[i(224)],LockedFishID:e[i(224)],Gold:e[i(225)]},d={ListFish:e[i(227)],ListFish_Struct:{FishID:e[i(224)],FishKind:e[i(226)],SpecialKind:e[i(226)],PosX:e[i(228)],PosY:e[i(228)],PosZ:e[i(228)],PathSeed:e[i(229)],ItemID:e[i(224)]}},_={ListFish:e[i(227)],ListFish_Struct:{FishID:e[i(224)],FishKind:e[i(226)],IsRedFish:e[i(226)],InitCount:e[i(226)],Position:e[i(227)],Position_Struct:{PosX:e[i(228)],PosY:e[i(228)]},ItemID:e[i(224)]}},p={FishID:e[i(224)],BulletMultiple:e[i(225)]},f={StationID:e[i(226)],FishID:e[i(224)],GoldReward:e[i(225)],TotalGold:e[i(225)],Level:e[i(224)],Exp:e[i(225)]},g={StationID:e[i(226)]},m={ParadeKind:e[i(226)],ParadePosition:e[i(226)],ListFish:e[i(227)],ListFish_Struct:{FishID:e[i(224)],FishKind:e[i(226)],SpecialKind:e[i(226)]}},y={ListSkill:e[i(227)],ListSkill_Struct:{ID:e[i(226)],NameSkill:e[i(223)],TimeLostSkill:e[i(229)],ScoreLostSkill:e[i(229)],NumberFishGet:e[i(229)],ScoreGetSkill:e[i(224)],TimeEffect:e[i(226)]},CurrentSkill:e[i(226)]},T={Angle:e[i(228)],x:e[i(228)],y:e[i(228)]},S={DeskStation:e[i(226)],Angle:e[i(228)],x:e[i(228)],y:e[i(228)],BulletID:e[i(226)],SkillID:e[i(226)]},C={SkillID:e[i(226)],SkillScore:e[i(228)],IsUseSkill:e[i(226)]},E={BulletID:e[i(226)],SkillID:e[i(226)],ListFish:e[i(230)],ListFish_Type:e[i(224)]},I={FishID:e[i(224)],BossID:e[i(224)],FishKind:e[i(226)],MaxHP:e[i(224)],CurrentHP:e[i(224)],PathSeed:e[i(229)],BirthTime:e[i(224)]},v={FishID:e[i(224)],FishIDArray:e[i(230)],FishIDArray_Type:e[i(224)],BulletMultiple:e[i(225)]},b={StationID:e[i(226)],FishID:e[i(224)],GoldReward:e[i(225)],TotalGold:e[i(225)],Level:e[i(224)],Exp:e[i(225)],FishIDArray:e[i(230)],FishIDArray_Type:e[i(224)]},A={BossID:e[i(224)],ValueHP:e[i(224)],CurrentHP:e[i(224)]},F={State:e[i(226)],Msg:e[i(223)]},x={BossID:e[i(224)],UserID:e[i(224)],GoldReward:e[i(225)],CardReward:e[i(224)],NumberOfCard:e[i(229)]},P={BossID:e[i(224)],ListUser:e[i(227)],ListUser_Struct:{UserID:e[i(224)],UserName:e[i(223)],Rank:e[i(226)],Damage:e[i(225)],GoldReward:e[i(225)],CardReward:e[i(224)],NumberOfCard:e[i(229)]}},R={ParadeKind:e[i(226)],PathSeed:e[i(226)],BirthTime:e[i(226)],ListFish:e[i(227)],ListFish_Struct:{FishID:e[i(224)],FishKind:e[i(226)],SpecialKind:e[i(226)]}},L={ParadeKind:e[i(226)],SceneKind:e[i(226)],ListFish:e[i(227)],ListFish_Struct:{FishID:e[i(224)],FishKind:e[i(226)],IsRedFish:e[i(226)]}},B={StationID:e[i(226)],FishID:e[i(224)],EffectID:e[i(226)],GoldReward:e[i(225)],TotalGold:e[i(225)]},D={EffectID:e[i(229)]},w={EffectID:e[i(229)]},O={BossID:e[i(224)],SkillID:e[i(226)],Direction:e[i(226)],TimeEffect:e[i(226)],Distance:e[i(224)]},N={StationID:e[i(226)],ChatID:e[i(226)]},G={StationID:e[i(226)],EffectID:e[i(226)]},k={CurrentPoint:e[i(225)],PointToGetTicket:e[i(225)]},e={StationID:e[i(226)],CurrentPoint:e[i(225)],IsGetTicket:e[i(226)]};t[i(214)]={LoginGameInfo:n,LoginResponse:s,ListUserInDeskResponse:r,UserComeResponse:a,ShowMsgResponse:h,UserFireInfo:l,UserFireResponse:u,SpawnFishResponse:d,CatchFishInfo:p,CatchFishResponse:f,UserLeftResponse:g,SpawnParadeFishResponse:m,SkillInfo:y,FireSkill:S,SkillAppear:C,ClearFishResponse:{},FireSkillRequest:T,SkillCatchFish:E,SpawnBossFishResponse:I,SpawnCrowdedFishResponse:d,KickUserResponse:F,CatchRedFishResponse:b,CatchRedFishInfo:v,UpdateBossHPResponse:A,BossDieResponse:x,BossLeaderBoard:P,SpawnParadeFishResponse_REALTIME:R,HitFishEffectResponse:B,PlayRoomEffectResponse:D,StopRoomEffectResponse:w,GlobalBossUserSkillResponse:O,OnUserChatInfo:N,OnUserChatResponse:N,ListUserInDeskResponse_2D:o,UserComeResponse_2D:c,SpawnFishResponse_2D:_,SpawnParadeFishResponse_2D:L,SpawnCrowdedFishResponse_2D:_,GunEffect:G,Slot_FreeTicketResponse:k,Slot_UpdateCurrentPointResponse:e}},function(t,e,i){"use strict";t[_0x2576(214)]={LoginGame:2001,ListUserInDesk:2002,UserCome:2003,ShowMsg:2004,UserFire:2005,SpawnFish:2006,CatchFish:2007,UserLeft:2008,SpawnParadeFish:2009,SendSkillInfo:2010,FireSkill:2011,SkillAppear:2012,ClearFish:2013,SkillCatchFish:2014,SpawnBossFish:2015,SpawnCrowdedFish:2016,CatchRedFish:2017,UpdateBossHPResponse:2018,KickUser:2019,BossDie:2020,SpawnParadeFish_REALTIME:2022,HitFishEffect:2023,PlayRoomEffect:2024,StopRoomEffect:2025,GlobalBossUseSkill:2026,OnUserChat:2027,Slot_FreeTicket:2029,Slot_UpdateCurrentPoint:2030,PingPong:2999,QuaySo_User_ConnectSuccess:1,QuaySo_User_Login:20001,QuaySo_User_GetInfo:3,QuaySo_User_StartRoll:4,QuaySo_User_Roll_Result:5,QuaySo_User_Error_Message:6,QuaySo_ListItem:7,QuaySo_User_TopWin:8,QuaySo_User_History:9,TaiXiu_UserLogin:30001,TaiXiu_GameInfo:30002,TaiXiu_ErrorMessage:30003,TaiXiu_StartMatch:30004,TaiXiu_EndMatch:30005,TaiXiu_UserBet:30006,TaiXiu_ResultHistory:30007,TaiXiu_BetHistory:30008,TaiXiu_TopWin:30009,TaiXiu_Chat:30010,TaiXiu_UpdateGold:30011,TaiXiu_UpdateBetValue:30012,Slot_UserLogin:40001,Slot_ErrorMessage:40002,Slot_UserSpin:40003,Slot_ResultResponse:40004,Slot_UpdateBetValue:40005,Slot_UpdateJackpot:40006,Slot_WinJackpot:40007,Slot_UserGetHistory:40008,Slot_UserGetTopWin:40009}},function(t,e,i){"use strict";t[_0x2576(214)]=function(t,e,i){return t}},function(t,e,i){"use strict";var n=_0x2576;function s(){}(t[n(214)]=s)[n(219)][n(231)]=function(t,e,i){return{requestId:t,content:e}}},function(t,e,i){"use strict";var n=_0x2576;function s(t,e,i){var n=_0x2576;e in t?Object[n(216)](t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i}t[n(214)]=(s(t={Struct:i(0),LoginResponse:i(35),ListUserInDeskResponse:i(36),UserCome:i(37),ShowMsg:i(38),UserFire:i(39),SpawnFish:i(40),CatchFish:i(41),UserLeft:i(42),SpawnParadeFish:i(43),SkillInfoResponse:i(44),UseSkillResponse:i(45),SkillAppearResponse:i(46),ClearFish:i(47),KickUserResponse:i(48),SpawnBossFish:i(49),SpawnCrowdedFish:i(50),CatchRedFish:i(51),UpdateBossHPResponse:i(52),BossDie:i(53),SpawnParadeFish_REALTIME:i(54),HitFishEffect:i(55),PingPong:i(56),PlayRoomEffect:i(57),StopRoomEffect:i(58),GlobalBossUseSkill:i(59),UserChat:i(60),ListUserInDeskResponse_2D:i(61),SpawnParadeFish_2D:i(62),SpawnFish_2D:i(63),UserCome_2D:i(64),SpawnCrowdedFish_2D:i(65),Slot_FreeTicket:i(66),Slot_UpdateCurrentPoint:i(67),UserInfo:i(68),RollingResult:i(69),ErrorMessage:i(9),ConnectSuccess:i(70),ListItem:i(71),TopUserWin:i(10),RollHistory:i(72),Slot_UserLogin:i(73),Slot_ErrorMessage:i(74),Slot_ResultResponse:i(75),Slot_UpdateBetValue:i(76),Slot_UpdateJackpot:i(77),Slot_UserGetHistory:i(78),Slot_UserGetTopWin:i(79),Slot_WinJackpot:i(80)},n(232),i(0)),s(t,n(233),i(81)),s(t,n(234),i(9)),s(t,n(235),i(82)),s(t,n(236),i(83)),s(t,n(237),i(84)),s(t,n(238),i(85)),s(t,n(239),i(86)),s(t,n(240),i(10)),s(t,n(241),i(87)),s(t,n(242),i(88)),s(t,n(243),i(89)),t)},function(t,e,i){"use strict";var c=_0x2576;function n(t,e,i,n,s,r,o,a,c){var h=_0x2576;this[h(244)]=t,this[h(245)]=e,this[h(246)]=i,this[h(247)]=n,this[h(248)]=s,this[h(249)]=typeof c==h(250)?1/this[h(248)]:c,this[h(251)]=r!=h(250)&&null!=r?r:0,this[h(252)]=o,this[h(253)]=typeof a==h(250)?0:a,this[h(254)]=this[h(255)]()}(t[c(214)]=n)[c(219)][c(256)]=function(t,e,i,n,s){var r=c,o=Math[r(257)](1e4*Math[r(258)]()+1)/1e4,r=this[r(255)](),a=0;return(o=n?0:o)<=(a=0<r?1/r*t:a)?r:0},n[c(219)][c(259)]=function(){},n[c(219)][c(260)]=function(){},n[c(219)][c(255)]=function(){var t=c;return typeof this[t(252)]==t(250)||this[t(252)]<this[t(248)]?this[t(248)]:Math[t(261)](Math[t(258)]()*(this[t(252)]-this[t(248)]+1)+this[t(248)])}},function(t,e,i){"use strict";var n=_0x2576,i={GameServerConfig:i(17),FishConfig:i(18),PathConfig:i(19),GunConfig:i(20),FishScriptConfig:i(21),RoomKindConfig:i(22),EventFishConfig:i(23),BossSkillConfig:i(24),FishScriptConfig_2D:i(7),FishConfig_2D:i(25),ParadeFishConfig:i(26),WheelItemConfig:i(27),WheelValueConfig:i(28),BetResultConfig:i(29),BetValueConfig:i(30)};t[n(214)]=i},function(t,e,i){"use strict";t[_0x2576(214)]=[{FishKind:[0,1,2,3,4,5,6,7,8,9],Time:2e3,MinY:100,MaxY:700,MinZ:1,MaxZ:300,IsCrowded:0,NumberOfFish:4,IsRedFish:0},{FishKind:[0,1,2,3,4,5,6,7,8,9],Time:2e3,MinY:100,MaxY:700,MinZ:1,MaxZ:300,IsCrowded:1,NumberOfFish:4,IsRedFish:0},{FishKind:[10,11,12,13,14,15],Time:5e3,MinY:100,MaxY:700,MinZ:1,MaxZ:300,IsCrowded:0,NumberOfFish:2,IsRedFish:0},{FishKind:[16,17,18,19,20,21],Time:1e4,MinY:100,MaxY:700,MinZ:1,MaxZ:300,IsCrowded:0,NumberOfFish:2,IsRedFish:0},{FishKind:[22],Time:5e4,MinY:100,MaxY:700,MinZ:1,MaxZ:300,IsCrowded:0,NumberOfFish:1,IsRedFish:0},{FishKind:[23],Time:6e4,MinY:100,MaxY:700,MinZ:1,MaxZ:300,IsCrowded:0,NumberOfFish:1,IsRedFish:0},{FishKind:[24,25],Time:9e4,MinY:100,MaxY:700,MinZ:1,MaxZ:300,IsCrowded:0,NumberOfFish:1,IsRedFish:0},{FishKind:[0,1,2,3,4,5,6,7,8,9,10,11],Time:11e3,MinY:100,MaxY:700,MinZ:1,MaxZ:300,IsCrowded:0,NumberOfFish:1,IsRedFish:1},{FishKind:[26,27],Time:3e4,MinY:100,MaxY:700,MinZ:1,MaxZ:300,IsCrowded:0,NumberOfFish:1,IsRedFish:0},{FishKind:[28,29],Time:4e4,MinY:100,MaxY:700,MinZ:1,MaxZ:300,IsCrowded:0,NumberOfFish:1,IsRedFish:0}]},function(t,e,i){"use strict";t[_0x2576(214)]={Define:i(33),BinaryParser:i(34),BinaryBuilder:i(2)}},function(t,e,i){"use strict";var n=_0x2576,s=i(2),r=i(3),o=i(1),a=i(0);function c(t){var e=_0x2576;return this[e(262)]=t,this[e(263)]=o[e(264)],this[e(231)](o[e(264)],new s({Msg:t},a[e(265)]))}(t[n(214)]=c)[n(219)]=new r},function(t,e,i){"use strict";var n=_0x2576,s=i(2),r=i(3),o=i(1),a=i(0);function c(t){var e=_0x2576;try{return this[e(231)](o[e(266)],new s({ListPlayerWin:t},a[e(267)]))}catch(t){}}(t[n(214)]=c)[n(219)]=new r},function(t,e,i){"use strict";t[_0x2576(214)]={NormalFish:i(5),RedFish:i(94),BossFish:i(95),SpecialFish:i(96),EventFish:i(97)}},function(t,e,i){"use strict";var n=_0x2576;e[n(268)]=function(){var t=n;if(typeof arguments[0]==t(250)||null==arguments[0])return!1;for(var e=1;e<arguments[t(269)];e++)if(typeof arguments[0][arguments[e]]==t(250)||null==arguments[0][arguments[e]])return!1;return!0}},function(t,e,i){var n=_0x2576;i(14),t[n(214)]=i(15)},function(x,t){var e=_0x2576;!function(t){"use strict";var h,l,u,d,_,p,i,f=_0x2576,e=Object[f(219)],g=e[f(220)],n=typeof Symbol===f(270)?Symbol:{},r=n[f(271)]||f(272),s=n[f(273)]||f(274),o=n[f(275)]||f(276),n=typeof x===f(277),a=t[f(278)];function c(t,e,i,n){var s,r,o,a,c=f,e=e&&e[c(219)]instanceof y?e:y,e=Object[c(279)](e[c(219)]),n=new b(n||[]);return e[c(280)]=(s=t,r=i,o=n,a=l,function(t,e){var i=_0x2576;if(a===d)throw new Error(i(310));if(a===_){if(t===i(283))throw e;return F()}for(o[i(311)]=t,o[i(302)]=e;;){var n=o[i(312)];if(n){n=function t(e,i){var n=f,s=e[n(271)][i[n(311)]];if(s===h){if(i[n(312)]=null,i[n(311)]===n(283)){if(e[n(271)][n(293)]&&(i[n(311)]=n(293),i[n(302)]=h,t(e,i),i[n(311)]===n(283)))return p;i[n(311)]=n(283),i[n(302)]=new TypeError(n(317))}return p}s=m(s,e[n(271)],i[n(302)]);if(s[n(301)]===n(283))return i[n(311)]=n(283),i[n(302)]=s[n(302)],i[n(312)]=null,p;s=s[n(302)];if(!s)return i[n(311)]=n(283),i[n(302)]=new TypeError(n(318)),i[n(312)]=null,p;{if(!s[n(309)])return s;i[e[n(319)]]=s[n(303)],i[n(292)]=e[n(320)],i[n(311)]!==n(293)&&(i[n(311)]=n(292),i[n(302)]=h)}return i[n(312)]=null,p}(n,o);if(n){if(n===p)continue;return n}}if(o[i(311)]===i(292))o[i(313)]=o[i(314)]=o[i(302)];else if(o[i(311)]===i(283)){if(a===l)throw a=_,o[i(302)];o[i(315)](o[i(302)])}else o[i(311)]===i(293)&&o[i(316)](i(293),o[i(302)]);a=d;n=m(s,r,o);if(n[i(301)]===i(282)){if(a=o[i(309)]?_:u,n[i(302)]!==p)return{value:n[i(302)],done:o[i(309)]}}else n[i(301)]===i(283)&&(a=_,o[i(311)]=i(283),o[i(302)]=n[i(302)])}}),e}function m(t,e,i){var n=f;try{return{type:n(282),arg:t[n(215)](e,i)}}catch(t){return{type:n(283),arg:t}}}function y(){}function T(){}function S(){}function C(t){var e=f;[e(292),e(283),e(293)][e(294)](function(e){t[e]=function(t){return this[_0x2576(280)](e,t)}})}function E(a){var e;this[f(280)]=function(i,n){function t(){return new Promise(function(t,e){!function e(t,i,n,s){var r,o=_0x2576,t=m(a[t],a,i);if(t[o(301)]!==o(283))return(i=(r=t[o(302)])[o(303)])&&typeof i===o(277)&&g[o(215)](i,o(304))?Promise[o(305)](i[o(304)])[o(306)](function(t){e(o(292),t,n,s)},function(t){e(o(283),t,n,s)}):Promise[o(305)](i)[o(306)](function(t){r[o(303)]=t,n(r)},function(t){return e(o(283),t,n,s)});s(t[o(302)])}(i,n,t,e)})}return e=e?e[_0x2576(306)](t,t):t()}}function I(t){var e=f,i={tryLoc:t[0]};1 in t&&(i[e(324)]=t[1]),2 in t&&(i[e(325)]=t[2],i[e(326)]=t[3]),this[e(327)][e(328)](i)}function v(t){var e=f,i=t[e(329)]||{};i[e(301)]=e(282),delete i[e(302)],t[e(329)]=i}function b(t){var e=f;this[e(327)]=[{tryLoc:e(330)}],t[e(294)](I,this),this[e(331)](!0)}function A(i){var n=f;if(i){var s,t=i[r];if(t)return t[n(215)](i);if(typeof i[n(292)]===n(270))return i;if(!isNaN(i[n(269)]))return s=-1,(t=function t(){for(var e=n;++s<i[e(269)];)if(g[e(215)](i,s))return t[e(303)]=i[s],t[e(309)]=!1,t;return t[e(303)]=h,t[e(309)]=!0,t})[n(292)]=t}return{next:F}}function F(){return{value:h,done:!0}}a?n&&(x[f(214)]=a):((a=t[f(278)]=n?x[f(214)]:{})[f(281)]=c,l=f(284),u=f(285),d=f(286),_=f(287),p={},(t={})[r]=function(){return this},n=(n=Object[f(288)])&&n(n(A([]))),n&&n!==e&&g[f(215)](n,r)&&(t=n),i=S[f(219)]=y[f(219)]=Object[f(279)](t),(T[f(219)]=i[f(289)]=S)[f(289)]=T,S[o]=T[f(290)]=f(291),a[f(295)]=function(t){var e=f,t=typeof t===e(270)&&t[e(289)];return!!t&&(t===T||(t[e(290)]||t[e(296)])===e(291))},a[f(297)]=function(t){var e=f;return Object[e(298)]?Object[e(298)](t,S):(t[e(299)]=S,o in t||(t[o]=e(291))),t[e(219)]=Object[e(279)](i),t},a[f(300)]=function(t){return{__await:t}},C(E[f(219)]),E[f(219)][s]=function(){return this},a[f(307)]=E,a[f(308)]=function(t,e,i,n){var s=f,r=new E(c(t,e,i,n));return a[s(295)](e)?r:r[s(292)]()[s(306)](function(t){var e=s;return t[e(309)]?t[e(303)]:r[e(292)]()})},C(i),i[o]=f(321),i[r]=function(){return this},i[f(322)]=function(){return f(323)},a[f(332)]=function(n){var t,s=f,r=[];for(t in n)r[s(328)](t);return r[s(333)](),function t(){for(var e=s;r[e(269)];){var i=r[e(334)]();if(i in n)return t[e(303)]=i,t[e(309)]=!1,t}return t[e(309)]=!0,t}},a[f(335)]=A,b[f(219)]={constructor:b,reset:function(t){var e=f;if(this[e(336)]=0,this[e(292)]=0,this[e(313)]=this[e(314)]=h,this[e(309)]=!1,this[e(312)]=null,this[e(311)]=e(292),this[e(302)]=h,this[e(327)][e(294)](v),!t)for(var i in this)"t"===i[e(337)](0)&&g[e(215)](this,i)&&!isNaN(+i[e(338)](1))&&(this[i]=h)},stop:function(){var t=f;this[t(309)]=!0;var e=this[t(327)][0][t(329)];if(e[t(301)]===t(283))throw e[t(302)];return this[t(339)]},dispatchException:function(n){var s=f;if(this[s(309)])throw n;var r=this;function t(t,e){var i=s;return o[i(301)]=i(283),o[i(302)]=n,r[i(292)]=t,e&&(r[i(311)]=i(292),r[i(302)]=h),!!e}for(var e=this[s(327)][s(269)]-1;0<=e;--e){var i=this[s(327)][e],o=i[s(329)];if(i[s(340)]===s(330))return t(s(341));if(i[s(340)]<=this[s(336)]){var a=g[s(215)](i,s(324)),c=g[s(215)](i,s(325));if(a&&c){if(this[s(336)]<i[s(324)])return t(i[s(324)],!0);if(this[s(336)]<i[s(325)])return t(i[s(325)])}else if(a){if(this[s(336)]<i[s(324)])return t(i[s(324)],!0)}else{if(!c)throw new Error(s(342));if(this[s(336)]<i[s(325)])return t(i[s(325)])}}}},abrupt:function(t,e){for(var i=f,n=this[i(327)][i(269)]-1;0<=n;--n){var s=this[i(327)][n];if(s[i(340)]<=this[i(336)]&&g[i(215)](s,i(325))&&this[i(336)]<s[i(325)]){var r=s;break}}var o=(r=r&&(t===i(343)||t===i(344))&&r[i(340)]<=e&&e<=r[i(325)]?null:r)?r[i(329)]:{};return o[i(301)]=t,o[i(302)]=e,r?(this[i(311)]=i(292),this[i(292)]=r[i(325)],p):this[i(345)](o)},complete:function(t,e){var i=f;if(t[i(301)]===i(283))throw t[i(302)];return t[i(301)]===i(343)||t[i(301)]===i(344)?this[i(292)]=t[i(302)]:t[i(301)]===i(293)?(this[i(339)]=this[i(302)]=t[i(302)],this[i(311)]=i(293),this[i(292)]=i(341)):t[i(301)]===i(282)&&e&&(this[i(292)]=e),p},finish:function(t){for(var e=f,i=this[e(327)][e(269)]-1;0<=i;--i){var n=this[e(327)][i];if(n[e(325)]===t)return this[e(345)](n[e(329)],n[e(326)]),v(n),p}},catch:function(t){for(var e=f,i=this[e(327)][e(269)]-1;0<=i;--i){var n,s,r=this[e(327)][i];if(r[e(340)]===t)return(n=r[e(329)])[e(301)]===e(283)&&(s=n[e(302)],v(r)),s}throw new Error(e(346))},delegateYield:function(t,e,i){var n=f;return this[n(312)]={iterator:A(t),resultName:e,nextLoc:i},this[n(311)]===n(292)&&(this[n(302)]=h),p}})}(function(){return this||typeof self===_0x2576(277)&&self}()||Function(e(347))())},function(t,e,i){"use strict";var n=_0x2576,i=i(16);window[n(348)]=i},function(t,e,i){"use strict";var o=_0x2576,n=i(6),s=i(31),r=i(32),a=i(4),c=i(90);function h(){var t=o;this[t(349)]=0,this[t(350)]=[],this[t(351)]=[],this[t(352)]=!0,this[t(353)]=n,this[t(351)]=n[t(351)],this[t(354)]=1,this[t(355)]=null,this[t(356)]=n[t(356)],this[t(357)]=null,this[t(358)]=[],this[t(359)]=0,this[t(360)]=6,this[t(361)]=0,this[t(362)]={PREPARE:1,BET:2,END_MATCH:3},this[t(363)]=3,this[t(364)]=10,this[t(365)]=Date[t(366)](),this[t(367)]=0,this[t(368)]=3,this[t(369)]=11,this[t(370)]=1,this[t(371)]=0,this[t(372)]=0,this[t(373)]=0,this[t(374)]=0,this[t(375)]=[],this[t(376)]=0,this[t(377)]=[],this[t(378)]=0,this[t(379)]=0,this[t(380)]=0,this[t(381)]=0,this[t(382)]=2e7,this[t(383)]=10,this[t(384)]=.95,this[t(238)]=[],this[t(385)]=100,this[t(386)]=3e3,this[t(387)]=n[t(388)],this[t(389)]=50,this[t(390)]=10,this[t(391)]=[]}(t[o(214)]=h)[o(219)][o(392)]=function(){this[o(259)]()},h[o(219)][o(259)]=function(){this[o(393)]()},h[o(219)][o(394)]=function(){this[o(395)]()},h[o(219)][o(395)]=function(){var t=o,e=i(91);this[t(350)][0]=e[t(396)](this[t(397)],this[t(398)],this[t(399)],""),this[t(350)][0][t(392)](this,1)},h[o(219)][o(400)]=function(t){this[o(401)](t)},h[o(219)][o(402)]=function(t){for(var e=o,i=0;i<this[e(351)][e(269)];i++)if(this[e(351)][i][e(403)]==t)return this[e(351)][i];return null},h[o(219)][o(393)]=function(){this[o(394)]()},h[o(219)][o(404)]=function(t){var e=o,i=(this[e(357)]=new s(this,{}),this[e(350)][0]);this[e(355)]=new r(this,{UserModel:this[e(357)]}),2001==t&&i[e(405)](this[e(357)]),(this[e(357)][e(406)]=i)[e(407)](),this[e(357)][e(406)][e(408)](this[e(357)])},h[o(219)][o(409)]=function(){},h[o(219)][o(410)]=function(){},h[o(219)][o(401)]=function(t){},h[o(219)][o(411)]=function(){},h[o(219)][o(412)]=function(){},h[o(219)][o(413)]=function(t){var e=o;setTimeout(this[e(414)][e(415)](this),50,t)},h[o(219)][o(414)]=function(t){var e=o;switch(t[e(416)]){case 1001:this[e(417)]();break;case 1006:this[e(418)]();break;case 2001:case 20001:case 40001:case 30001:this[e(404)](t[e(416)]),this[e(355)][e(419)](t);break;default:this[e(355)]&&this[e(355)][e(419)](t)}},h[o(219)][o(417)]=function(t){var e=o,i={requestId:1001,content:{UserID:10,Gold:1e6,Level:100,Nickname:e(420)}};this[e(401)](i)},h[o(219)][o(418)]=function(t){var e=o,i={requestId:1006,content:{IsError:0,KindID:1,LevelLimit:0,GoldLimit:1e3,Gold:1e5,Level:10,Server:e(421),Token:e(422)}};this[e(401)](i)},h[o(219)][o(423)]=function(){for(var t=o,e=(this[t(400)](new a[t(424)](0)),this[t(400)](new a[t(425)](this[t(357)][t(426)],this[t(357)][t(427)])),[]),i=0;i<9;i++)e[t(328)]({ID:i+1,ItemName:t(296)+i,ItemID:i+1,ItemCount:2*i,ItemValues:1e3*i,ItemImage:t(428)+(43+i)+t(429),Ratio:10});this[t(400)](new a[t(358)](e))},h[o(219)][o(430)]=function(t){var e=o;t[e(427)]=data[e(427)],t[e(426)]=data[e(426)],t[e(431)]=data[e(431)],this[e(400)](new a[e(425)](t[e(426)],t[e(427)]))},h[o(219)][o(432)]=function(t){var e=o;this[e(433)](this[e(357)],5)},h[o(219)][o(433)]=function(t,e){var i=o,n={ItemID:0,ItemValues:1e4};t[i(426)]--,0==n[i(251)]&&(t[i(427)]+=n[i(434)]),t[i(435)]=0,this[i(400)](new a[i(436)](e)),this[i(400)](new a[i(425)](t[i(426)],t[i(427)]))},h[o(219)][o(437)]=function(){for(var t=o,e=[],i=0;i<3;i++)e[t(328)]({Nickname:t(438)+i,Msg:t(439)+i,TimeRecord:t(440)+i});this[t(441)]=new a[t(442)](e)},h[o(219)][o(443)]=function(t){for(var e=o,i=[],n=0;n<3;n++)i[e(328)]({Nickname:e(438)+n,Msg:e(439)+n,TimeRecord:e(440)+n});i=new a[e(442)](i),this[e(400)](i)},h[o(219)][o(444)]=function(){for(var t=o,e=[],i=0;i<3;i++)e[t(328)]({Nickname:t(438)+i,Msg:t(438)+i,TimeRecord:t(438)+i});this[t(357)][t(435)]=new a[t(445)](e),this[t(400)](this[t(357)][t(435)])},h[o(219)][o(446)]=function(){var t=o,e=(this[t(447)]=[{BetValueID:1,BetValue:1e4},{BetValueID:2,BetValue:2e4},{BetValueID:3,BetValue:3e4}],this[t(357)][t(448)]=new c(this,this[t(357)]),new a[t(449)](this[t(357)][t(427)],this[t(357)][t(450)],this[t(357)][t(451)]));this[t(400)](e),e=new a[t(452)](this[t(447)]),this[t(400)](e)},h[o(219)][o(453)]=function(t){var e=o;0==this[e(357)][e(448)][e(454)]&&this[e(357)][e(448)][e(453)](t[e(455)][e(456)],t[e(455)][e(457)])},h[o(219)][o(458)]=function(){var t=o,e=[{MatchID:10,BetID:1,GoldBet:1e5,Reward:1e4,Time:Date[t(366)](),UpdatedTime:Date[t(366)](),GoldReward:1e4,LineResult:[1,2,3],Dices:[1,3,4]}],e=(this[t(357)][t(459)]=e,new a[t(460)](e));this[t(400)](e)},h[o(219)][o(461)]=function(){var t=o,e=new a[t(462)]([{JackpotID:1,JackpotValue:1e5},{JackpotID:2,JackpotValue:2e5}]);this[t(400)](e)},h[o(219)][o(463)]=function(t){var e=o,i=[{Nickname:e(464),GoldWin:1e5,WinType:1,GoldReward:1e5},{Nickname:e(465),GoldWin:2e5,WinType:2,GoldReward:1e5}],i=new a[e(466)](i);this[e(400)](i)},h[o(219)][o(467)]=function(t){for(var e=o,i=[],n=0;n<t;n++){var s=Math[e(261)](Math[e(258)]()*this[e(360)])+1;i[e(328)](s)}return i},h[o(219)][o(468)]=function(){var t=o;this[t(361)]=this[t(362)][t(469)],this[t(365)]=1e3*this[t(363)],this[t(367)]=+new Date,setTimeout(this[t(470)][t(415)](this),this[t(365)])},h[o(219)][o(470)]=function(){var t=o,e=(this[t(471)](),this[t(374)]=10,this[t(376)]=+Date[t(366)](),this[t(361)]=this[t(362)][t(472)],this[t(365)]=1e3*this[t(364)],this[t(367)]=+new Date,new a[t(235)](this[t(374)],this[t(361)],this[t(365)]));this[t(473)](e),setTimeout(this[t(474)][t(415)](this),this[t(365)])},h[o(219)][o(474)]=function(){var t=o;this[t(361)]=this[t(362)][t(475)],this[t(365)]=1e3*this[t(363)],this[t(367)]=+new Date,this[t(476)](),setTimeout(this[t(470)][t(415)](this),this[t(365)])},h[o(219)][o(477)]=function(t){for(var e=o,i=0,n=0;n<t[e(269)];n++)i+=t[n];return this[e(238)][e(328)](i),this[e(238)][e(269)]>this[e(385)]&&this[e(238)][e(478)](0,1),i<this[e(369)]?(this[e(373)]++,this[e(371)]):(this[e(372)]++,this[e(370)])},h[o(219)][o(479)]=function(t,e){var i,n,s,r=o;this[r(361)]===this[r(362)][r(472)]&&e>=this[r(383)]&&(s=this[r(357)][r(480)],0<(e=e+(s=t==this[r(371)]?this[r(357)][r(481)]:s)>this[r(382)]?this[r(382)]-s:e))&&this[r(357)][r(427)]>=e&&(this[r(357)][r(427)]-=e,n=i=s=0,(t==this[r(370)]&&0==this[r(357)][r(480)]||t==this[r(371)]&&0==this[r(357)][r(481)])&&(s=1),n=t==this[r(370)]?(this[r(357)][r(480)]+=e,this[r(378)]+=e,this[r(380)]+=s,i=this[r(378)],this[r(380)]):(this[r(357)][r(481)]+=e,this[r(379)]+=e,this[r(381)]+=s,i=this[r(379)],this[r(381)]),s=new a[r(237)](this[r(357)][r(482)],t,e,i,n),this[r(400)](s))},h[o(219)][o(483)]=function(){this[o(468)]()},h[o(219)][o(484)]=function(){var t=o;0==this[t(361)]&&this[t(483)]();var e=+new Date-this[t(367)],e=this[t(365)]-e,i={GoldUserBetTai:0,GoldUserBetXiu:0,TotalTai:this[t(378)],NumberUserBetTai:this[t(380)],TotalXiu:this[t(379)],NumberUserBetXiu:this[t(381)]},e=new a[t(233)](this[t(357)][t(427)],this[t(374)],this[t(361)],e,this[t(377)],i,this[t(387)],this[t(383)],this[t(382)]);this[t(400)](e)},h[o(219)][o(476)]=function(){var t,e,i=o;this[i(361)]===this[i(362)][i(475)]&&(this[i(377)]=this[i(467)](this[i(368)]),t=e=0,this[i(477)](this[i(377)])===this[i(370)]?e=this[i(357)][i(480)]*this[i(384)]:t=this[i(357)][i(481)]*this[i(384)],this[i(357)][i(427)]+=e+t,this[i(357)][i(485)](),this[i(357)][i(485)](),e=new a[i(236)](this[i(361)],this[i(365)],this[i(377)],e+t,this[i(357)][i(427)]),this[i(400)](e),this[i(357)][i(471)]())},h[o(219)][o(471)]=function(){var t=o;this[t(380)]=0,this[t(381)]=0,this[t(378)]=0,this[t(379)]=0,this[t(375)]=[],this[t(377)]=[],this[t(357)][t(471)]()},h[o(219)][o(486)]=function(t){var e,i=o,n=+new Date;(n-this[i(357)][i(487)]>this[i(386)]||0==this[i(357)][i(487)])&&((e=new a[i(238)](this[i(238)]))&&this[i(400)](e),this[i(357)][i(487)]=n)},h[o(219)][o(488)]=function(t){for(var e=o,i=[],n=0;n<data[e(269)];n++){var s=[data[n][e(489)],data[n][e(490)],data[n][e(491)]];i[e(328)]({MatchID:data[n][e(374)],BetID:data[n][e(456)],GoldBet:data[n][e(492)],Reward:data[n][e(493)],Time:+data[n][e(494)],Dices:s})}var r=new a[e(239)](i);r&&this[e(400)](r)},h[o(219)][o(443)]=function(t){var e,i=o,n=+new Date;(n-this[i(357)][i(495)]>this[i(386)]||0==this[i(357)][i(495)])&&((e=new a[i(240)](this[i(391)]))&&this[i(400)](e),this[i(357)][i(495)]=n)},h[o(219)][o(496)]=function(t,e){var i=o,n=+new Date;(n-this[i(357)][i(497)]>this[i(386)]||0==this[i(357)][i(497)])&&(e=new a[i(241)](this[i(357)][i(482)],this[i(357)][i(431)],e),this[i(473)](e),this[i(357)][i(497)]=n)},h[o(219)][o(498)]=function(){var t=o;this[t(364)]=30,this[t(363)]=10,this[t(382)]=1e6,this[t(383)]=1e3,this[t(384)]=1},h[o(219)][o(499)]=function(){var t=o;this[t(387)]=NewListBetValue,this[t(500)]()},h[o(219)][o(501)]=function(){var t,e=o;this[e(361)]==this[e(362)][e(472)]&&(t=new a[e(237)](0,this[e(371)],0,this[e(379)],this[e(381)]),this[e(473)](t),t=new a[e(237)](0,this[e(370)],0,this[e(378)],this[e(380)]),this[e(473)](t))},h[o(219)][o(500)]=function(){var t=o,e=new a[t(243)](this[t(383)],this[t(382)],this[t(387)]);this[t(473)](e)},h[o(219)][o(473)]=function(t){this[o(401)](t)}},function(t,e,i){"use strict";var n=_0x2576,s={GameServer:{MAX_BULLET_SKILL_LAZER:8,MAX_BULLET_COUNT:50,INVALID_CHAIR:255,Enable_Adventure:1},RoomTypeConfig:{GameKindID:3,RoomName:n(502),MoneyRequired:5e5,LevelRequired:0,DeskCount:10}};t[n(214)]=s},function(t,e,i){"use strict";t[_0x2576(214)]={FishInfo:[{FishKind:0,Speed:5,FishMultiple:2,BoundingBox:{Width:55,Height:15},HitRadius:10,CaptureProbability:.5},{FishKind:1,Speed:5,FishMultiple:2,BoundingBox:{Width:60,Height:25},HitRadius:10,CaptureProbability:.5},{FishKind:2,Speed:5,FishMultiple:3,BoundingBox:{Width:80,Height:32},HitRadius:10,CaptureProbability:.3333},{FishKind:3,Speed:5,FishMultiple:4,BoundingBox:{Width:70,Height:43},HitRadius:10,CaptureProbability:.25},{FishKind:4,Speed:5,FishMultiple:5,BoundingBox:{Width:80,Height:54},HitRadius:10,CaptureProbability:.2},{FishKind:5,Speed:5,FishMultiple:6,BoundingBox:{Width:90,Height:70},HitRadius:10,CaptureProbability:.1666},{FishKind:6,Speed:5,FishMultiple:7,BoundingBox:{Width:90,Height:40},HitRadius:10,CaptureProbability:.1428},{FishKind:7,Speed:5,FishMultiple:8,BoundingBox:{Width:120,Height:55},HitRadius:10,CaptureProbability:.125},{FishKind:8,Speed:5,FishMultiple:9,BoundingBox:{Width:150,Height:47},HitRadius:10,CaptureProbability:.111},{FishKind:9,Speed:5,FishMultiple:9,BoundingBox:{Width:110,Height:112},HitRadius:10,CaptureProbability:.111},{FishKind:10,Speed:4,FishMultiple:10,BoundingBox:{Width:145,Height:80},HitRadius:10,CaptureProbability:.1},{FishKind:11,Speed:4,FishMultiple:12,BoundingBox:{Width:120,Height:150},HitRadius:10,CaptureProbability:.0833},{FishKind:12,Speed:4,FishMultiple:15,BoundingBox:{Width:180,Height:70},HitRadius:10,CaptureProbability:.0666},{FishKind:13,Speed:4,FishMultiple:18,BoundingBox:{Width:255,Height:88},HitRadius:10,CaptureProbability:.0555},{FishKind:14,Speed:4,FishMultiple:20,BoundingBox:{Width:180,Height:80},HitRadius:10,CaptureProbability:.05},{FishKind:15,Speed:3,FishMultiple:25,BoundingBox:{Width:180,Height:150},HitRadius:10,CaptureProbability:.04},{FishKind:16,Speed:3,FishMultiple:30,BoundingBox:{Width:250,Height:90},HitRadius:10,CaptureProbability:.0333},{FishKind:17,Speed:3,FishMultiple:40,BoundingBox:{Width:240,Height:100},HitRadius:10,CaptureProbability:.025},{FishKind:18,Speed:3,FishMultiple:50,EffectID:1,BoundingBox:{Width:350,Height:70},HitRadius:10,CaptureProbability:.02},{FishKind:19,Speed:1,FishMultiple:100,BoundingBox:{Width:450,Height:150},HitRadius:10,CaptureProbability:.01},{FishKind:20,Speed:2,FishMultiple:200,BoundingBox:{Width:380,Height:110},HitRadius:10,CaptureProbability:.005},{FishKind:21,Speed:2,FishMultiple:300,BoundingBox:{Width:380,Height:110},HitRadius:10,CaptureProbability:.0033},{FishKind:22,Speed:3,FishMultiple:9,MaxFishMultiple:45,BoundingBox:{Width:120,Height:120},HitRadius:10,CaptureProbability:.037},{FishKind:23,Speed:4,FishMultiple:1,MaxFishMultiple:999,BoundingBox:{Width:170,Height:180},HitRadius:10,CaptureProbability:.002},{FishKind:24,Speed:2,FishMultiple:40,MaxFishMultiple:280,BoundingBox:{Width:240,Height:220},HitRadius:10,CaptureProbability:.00625},{FishKind:25,Speed:2,FishMultiple:100,MaxFishMultiple:250,BoundingBox:{Width:250,Height:250},HitRadius:10,CaptureProbability:.0057},{FishKind:26,Speed:3,FishMultiple:80,MaxFishMultiple:100,BoundingBox:{Width:250,Height:250},HitRadius:10,CaptureProbability:.0111},{FishKind:27,Speed:3,FishMultiple:18,MaxFishMultiple:30,BoundingBox:{Width:130,Height:340},HitRadius:10,CaptureProbability:.0416},{FishKind:28,Speed:3,FishMultiple:150,MaxFishMultiple:204,BoundingBox:{Width:250,Height:250},HitRadius:10,CaptureProbability:.00564},{FishKind:29,Speed:3,FishMultiple:32,MaxFishMultiple:60,BoundingBox:{Width:130,Height:360},HitRadius:10,CaptureProbability:.02173},{FishKind:30,Speed:4,FishMultiple:0,BoundingBox:{Width:170,Height:180},HitRadius:10,CaptureProbability:.002},{FishKind:31,Speed:4,FishMultiple:0,BoundingBox:{Width:170,Height:180},HitRadius:10,CaptureProbability:.002},{FishKind:32,Speed:1,FishMultiple:1,BoundingBox:{Width:800,Height:250},HitRadius:10,CaptureProbability:.001,BossSkill:0},{FishKind:33,Speed:1,FishMultiple:1,BoundingBox:{Width:800,Height:250},HitRadius:10,CaptureProbability:.001,BossSkill:0},{FishKind:34,Speed:1,FishMultiple:1,BoundingBox:{Width:800,Height:250},HitRadius:10,CaptureProbability:.001,BossSkill:1},{FishKind:35,Speed:2,FishMultiple:1,BoundingBox:{Width:350,Height:250},HitRadius:10,CaptureProbability:.001},{FishKind:36,Speed:2,FishMultiple:1,BoundingBox:{Width:350,Height:250},HitRadius:10,CaptureProbability:.001},{FishKind:37,Speed:2,FishMultiple:1,BoundingBox:{Width:350,Height:250},HitRadius:10,CaptureProbability:.001},{FishKind:38,Speed:2,FishMultiple:1,BoundingBox:{Width:350,Height:250},HitRadius:10,CaptureProbability:.001},{FishKind:39,Speed:2,FishMultiple:1,BoundingBox:{Width:350,Height:250},HitRadius:10,CaptureProbability:.001}]}},function(t,e,i){"use strict";t[_0x2576(214)]={PathInfo:[{PathID:1,Time:12},{PathID:2,Time:14},{PathID:3,Time:14},{PathID:4,Time:14},{PathID:5,Time:12},{PathID:6,Time:12},{PathID:7,Time:12},{PathID:8,Time:16},{PathID:9,Time:14},{PathID:10,Time:14},{PathID:11,Time:14},{PathID:12,Time:22},{PathID:50,Time:43}]}},function(t,e,i){"use strict";t[_0x2576(214)]={Gun:{GunMultiple:{Min:100,Max:3e3},GunList:[10,100,200,300,500,1e3,2e3]}}},function(t,e,i){"use strict";t[_0x2576(214)]=[{FishKind:[0,1,2,3,4,5,6,7,8,9],Time:2e3,MinY:100,MaxY:700,MinZ:1,MaxZ:300,IsCrowded:0,NumberOfFish:4,IsRedFish:0},{FishKind:[0,1,2,3,4,5,6,7,8,9],Time:2e3,MinY:100,MaxY:700,MinZ:1,MaxZ:300,IsCrowded:1,NumberOfFish:4,IsRedFish:0},{FishKind:[10,11,12,13,14,15],Time:5e3,MinY:100,MaxY:700,MinZ:1,MaxZ:300,IsCrowded:0,NumberOfFish:2,IsRedFish:0},{FishKind:[16,17,18,19,20,21],Time:1e4,MinY:100,MaxY:700,MinZ:1,MaxZ:300,IsCrowded:0,NumberOfFish:2,IsRedFish:0},{FishKind:[22],Time:5e4,MinY:100,MaxY:700,MinZ:1,MaxZ:300,IsCrowded:0,NumberOfFish:1,IsRedFish:0},{FishKind:[23],Time:6e4,MinY:100,MaxY:700,MinZ:1,MaxZ:300,IsCrowded:0,NumberOfFish:1,IsRedFish:0},{FishKind:[24,25],Time:9e4,MinY:100,MaxY:700,MinZ:1,MaxZ:300,IsCrowded:0,NumberOfFish:1,IsRedFish:0},{FishKind:[0,1,2,3,4,5,6,7,8,9,10,11],Time:11e3,MinY:100,MaxY:700,MinZ:1,MaxZ:300,IsCrowded:0,NumberOfFish:1,IsRedFish:1},{FishKind:[26,27],Time:3e4,MinY:100,MaxY:700,MinZ:1,MaxZ:300,IsCrowded:0,NumberOfFish:1,IsRedFish:0},{FishKind:[28,29],Time:4e4,MinY:100,MaxY:700,MinZ:1,MaxZ:300,IsCrowded:0,NumberOfFish:1,IsRedFish:0},{FishKind:[0,1,2,3,4,5,6,7,8,9,10,11],Time:5e3,MinY:100,MaxY:700,MinZ:1,MaxZ:300,IsCrowded:0,NumberOfFish:1,IsRedFish:1}]},function(t,e,i){"use strict";t[_0x2576(214)]={RoomFree3D:11,RoomVIP3D:13,RoomAdventure3D:14,RoomTrial3D:15}},function(t,e,i){"use strict";t[_0x2576(214)]=[{FishKind:[0,1,2,3,4,5,6,24],PathSeed:[1,2,3,4,5,6,7,8,9,10,11],MinY:100,MaxY:700,MinZ:150,MaxZ:300},{FishKind:[7,8,9,10,11,12,13],PathSeed:[1,2,3,4,5,6,7,8,9,10,11],MinY:100,MaxY:700,MinZ:1,MaxZ:300},{FishKind:[14,15,16,17,18,19],PathSeed:[1,2,3,4,5,6,7,8,9,10,11],MinY:100,MaxY:700,MinZ:1,MaxZ:600},{FishKind:[0,1,2,3,4,5,6,24],PathSeed:[1,2,3,4,5,6,7,8,9,10,11],MinY:100,MaxY:700,MinZ:150,MaxZ:300},{FishKind:[21,22],PathSeed:[2,3,5,6,7],MinY:200,MaxY:700,MinZ:300,MaxZ:600},{FishKind:[25],PathSeed:[1,2,3,4,5,6,7,8,9,10,11],MinY:200,MaxY:700,MinZ:1,MaxZ:600},{FishKind:[20,23],PathSeed:[2,3,5,6,7],MinY:200,MaxY:700,MinZ:300,MaxZ:600},{FishKind:[31,33],PathSeed:[1,2,3,4,5,6,7,8,9,10,11],MinY:100,MaxY:700,MinZ:150,MaxZ:300},{FishKind:[30,32,34,36],PathSeed:[1,2,3,4,5,6,7,9,10,11],MinY:100,MaxY:700,MinZ:150,MaxZ:600}]},function(t,e,i){"use strict";t[_0x2576(214)]=[{SkillID:1,TimeEffect:5,Distance:640,CoolDown:1e4}]},function(t,e,i){"use strict";t[_0x2576(214)]={RedRatio:.002,RedRule:1,FishInfo:[{FishKind:0,Speed:5,FishMultiple:2,BoundingBox:{Width:55,Height:15},HitRadius:10,CaptureProbability:.5},{FishKind:1,Speed:5,FishMultiple:2,BoundingBox:{Width:60,Height:25},HitRadius:10,CaptureProbability:.5},{FishKind:2,Speed:5,FishMultiple:3,BoundingBox:{Width:80,Height:32},HitRadius:10,CaptureProbability:.3333},{FishKind:3,Speed:5,FishMultiple:4,BoundingBox:{Width:70,Height:43},HitRadius:10,CaptureProbability:.25},{FishKind:4,Speed:5,FishMultiple:5,BoundingBox:{Width:80,Height:54},HitRadius:10,CaptureProbability:.2},{FishKind:5,Speed:5,FishMultiple:6,BoundingBox:{Width:90,Height:70},HitRadius:10,CaptureProbability:.1666},{FishKind:6,Speed:5,FishMultiple:7,BoundingBox:{Width:90,Height:40},HitRadius:10,CaptureProbability:.1428},{FishKind:7,Speed:5,FishMultiple:8,BoundingBox:{Width:120,Height:55},HitRadius:10,CaptureProbability:.125},{FishKind:8,Speed:5,FishMultiple:9,BoundingBox:{Width:150,Height:47},HitRadius:10,CaptureProbability:.111},{FishKind:9,Speed:5,FishMultiple:9,BoundingBox:{Width:110,Height:112},HitRadius:10,CaptureProbability:.111},{FishKind:10,Speed:4,FishMultiple:10,BoundingBox:{Width:145,Height:80},HitRadius:10,CaptureProbability:.1},{FishKind:11,Speed:4,FishMultiple:12,BoundingBox:{Width:120,Height:150},HitRadius:10,CaptureProbability:.0833},{FishKind:12,Speed:4,FishMultiple:15,BoundingBox:{Width:180,Height:70},HitRadius:10,CaptureProbability:.0666},{FishKind:13,Speed:4,FishMultiple:18,BoundingBox:{Width:255,Height:88},HitRadius:10,CaptureProbability:.0555},{FishKind:14,Speed:4,FishMultiple:20,BoundingBox:{Width:180,Height:80},HitRadius:10,CaptureProbability:.05},{FishKind:15,Speed:3,FishMultiple:25,BoundingBox:{Width:180,Height:150},HitRadius:10,CaptureProbability:.04},{FishKind:16,Speed:3,FishMultiple:30,BoundingBox:{Width:250,Height:90},HitRadius:10,CaptureProbability:.0333},{FishKind:17,Speed:3,FishMultiple:40,BoundingBox:{Width:240,Height:100},HitRadius:10,CaptureProbability:.025},{FishKind:18,Speed:3,FishMultiple:50,EffectID:1,BoundingBox:{Width:350,Height:70},HitRadius:10,CaptureProbability:.02},{FishKind:19,Speed:1,FishMultiple:100,BoundingBox:{Width:450,Height:150},HitRadius:10,CaptureProbability:.01},{FishKind:20,Speed:2,FishMultiple:200,BoundingBox:{Width:380,Height:110},HitRadius:10,CaptureProbability:.005},{FishKind:21,Speed:2,FishMultiple:300,BoundingBox:{Width:380,Height:110},HitRadius:10,CaptureProbability:.0033},{FishKind:22,Speed:3,FishMultiple:9,MaxFishMultiple:45,BoundingBox:{Width:120,Height:120},HitRadius:10,CaptureProbability:.037},{FishKind:23,Speed:4,FishMultiple:1,MaxFishMultiple:999,BoundingBox:{Width:170,Height:180},HitRadius:10,CaptureProbability:.002},{FishKind:24,Speed:2,FishMultiple:40,MaxFishMultiple:280,BoundingBox:{Width:240,Height:220},HitRadius:10,CaptureProbability:.00625},{FishKind:25,Speed:2,FishMultiple:100,MaxFishMultiple:250,BoundingBox:{Width:250,Height:250},HitRadius:10,CaptureProbability:.0057},{FishKind:26,Speed:3,FishMultiple:80,MaxFishMultiple:100,BoundingBox:{Width:250,Height:250},HitRadius:10,CaptureProbability:.0111},{FishKind:27,Speed:3,FishMultiple:18,MaxFishMultiple:30,BoundingBox:{Width:130,Height:340},HitRadius:10,CaptureProbability:.0416},{FishKind:28,Speed:3,FishMultiple:150,MaxFishMultiple:204,BoundingBox:{Width:250,Height:250},HitRadius:10,CaptureProbability:.00564},{FishKind:29,Speed:3,FishMultiple:32,MaxFishMultiple:60,BoundingBox:{Width:130,Height:360},HitRadius:10,CaptureProbability:.02173},{FishKind:30,Speed:4,FishMultiple:0,BoundingBox:{Width:170,Height:180},HitRadius:10,CaptureProbability:.002},{FishKind:31,Speed:4,FishMultiple:0,BoundingBox:{Width:170,Height:180},HitRadius:10,CaptureProbability:.002},{FishKind:32,Speed:1,FishMultiple:1,BoundingBox:{Width:800,Height:250},HitRadius:10,CaptureProbability:.001,BossSkill:0},{FishKind:33,Speed:1,FishMultiple:1,BoundingBox:{Width:800,Height:250},HitRadius:10,CaptureProbability:.001,BossSkill:0},{FishKind:34,Speed:1,FishMultiple:1,BoundingBox:{Width:800,Height:250},HitRadius:10,CaptureProbability:.001,BossSkill:1},{FishKind:35,Speed:2,FishMultiple:1,BoundingBox:{Width:350,Height:250},HitRadius:10,CaptureProbability:.001},{FishKind:36,Speed:2,FishMultiple:1,BoundingBox:{Width:350,Height:250},HitRadius:10,CaptureProbability:.001},{FishKind:37,Speed:2,FishMultiple:1,BoundingBox:{Width:350,Height:250},HitRadius:10,CaptureProbability:.001},{FishKind:38,Speed:2,FishMultiple:1,BoundingBox:{Width:350,Height:250},HitRadius:10,CaptureProbability:.001},{FishKind:39,Speed:2,FishMultiple:1,BoundingBox:{Width:350,Height:250},HitRadius:10,CaptureProbability:.001}]}},function(t,e,i){"use strict";t[_0x2576(214)]={EndingThreshold:5,Duration_3D:40,Duration_2D:63}},function(t,e,i){"use strict";var n=_0x2576,s=[{ID:0,Name:n(503)},{ID:1,Name:n(504)},{ID:2,Name:n(505)},{ID:3,Name:n(506)},{ID:4,Name:n(507)},{ID:5,Name:n(508)},{ID:6,Name:n(509)},{ID:7,Name:n(510)},{ID:8,Name:n(511)}];t[n(214)]=s},function(t,e,i){"use strict";t[_0x2576(214)]={NormalWheel:[[0,3,4,6,7,3,4,8,6,7,3,4,7,3,6,4,8,6,7,8,4,7,6,8,7,3,6,7,3,6,7,4,2,6,3,8,7,6,8,3,6,1,4,7,3,4,7,5,4,3,6,4,7,6,3,4,6,3,7,6,5,7,6,3,7,6],[8,5,7,8,4,6,7,8,5,4,8,3,7,8,6,3,8,6,5,8,6,3,8,6,5,8,3,7,8,3,6,8,3,6,8,3,0,8,6,7,8,3,6,8,5,7,8,6,3,8,6,5,2,8,3,6,8,5,6,8,3,1,6,8,5,3],[4,5,3,8,5,7,8,4,7,8,6,7,8,4,7,5,8,7,3,8,7,4,8,7,6,8,7,4,8,7,5,8,7,4,8,7,6,8,7,4,8,0,7,8,6,7,5,8,7,4,8,7,6,8,5,7,4,8,5,2,7,8,5,7,8,1]],FreeWheel:[[0,3,4,6,7,3,4,5,6,7,3,4,7,3,6,4,8,6,7,3,4,7,6,4,7,3,6,7,3,6,7,4,2,6,3,8,7,6,8,3,6,0,4,7,3,4,7,5,4,3,6,4,7,6,3,4,6,3,7,6,5,7,6,3,7,6],[8,5,7,3,4,6,7,5,5,4,8,3,7,8,6,3,8,6,5,8,6,3,4,6,5,8,3,7,8,3,6,8,3,6,8,3,0,8,6,7,8,3,6,8,5,7,8,6,3,8,6,5,2,8,3,6,8,5,6,8,3,0,6,8,5,3],[4,5,3,8,5,7,3,4,7,5,6,7,8,4,7,5,4,7,3,8,7,4,8,7,6,8,7,4,8,7,5,8,7,4,8,7,6,8,7,4,8,0,7,8,6,7,5,8,7,4,8,7,6,8,5,7,4,8,5,2,7,8,5,7,8,0]]}},function(t,e,i){"use strict";t[_0x2576(214)]=[{Line:[0,0,0],Exception:[],IsOrdered:0,Ratio:2500},{Line:[5,4,3],Exception:[],IsOrdered:1,Ratio:200},{Line:[5,5,5],Exception:[],IsOrdered:0,Ratio:80},{Line:[4,4,4],Exception:[],IsOrdered:0,Ratio:60},{Line:[3,3,3],Exception:[],IsOrdered:0,Ratio:40},{Line:[6,6,6],Exception:[],IsOrdered:0,Ratio:20},{Line:[7,7,7],Exception:[],IsOrdered:0,Ratio:15},{Line:[8,8,8],Exception:[],IsOrdered:0,Ratio:10},{Line:[3,4,5],Exception:[],IsOrdered:0,Ratio:2},{Line:[],Exception:[1,2,3,4,5],IsOrdered:0,Ratio:1}]},function(t,e,i){"use strict";t[_0x2576(214)]=[2e4,3e4,5e4,1e5,15e4,2e5,3e5,1e6]},function(t,e,i){"use strict";var s=_0x2576;function n(t,e){var i=_0x2576;this[i(512)]=t,this[i(426)]=100,this[i(427)]=1e5,this[i(435)]=0,this[i(482)]=0,this[i(513)]=0,this[i(238)]=0,this[i(480)]=0,this[i(481)]=0,this[i(514)]=0,this[i(515)]=0,this[i(516)]=!1,this[i(487)]=0,this[i(517)]=0,this[i(495)]=0,this[i(497)]=0,this[i(518)]=!1,this[i(519)]=!1,this[i(520)]=!1,this[i(448)]=0,this[i(459)]=0,this[i(451)]=0,this[i(521)]=0,this[i(522)]=0,this[i(450)]=0,this[i(482)]=0,this[i(348)]=t,this[i(523)]=e,this[i(524)]=[],this[i(406)]=0,this[i(525)]=0,this[i(526)]=0,this[i(527)]=!1,this[i(528)]="",this[i(529)]="",this[i(530)]=0,this[i(531)]=0,this[i(532)]=!1,this[i(533)]=1e5,this[i(534)]=0,this[i(535)]=0,this[i(536)]=0,this[i(537)]="",this[i(538)]=0;for(var n=this[i(539)]=0;n<32;n++)this[i(524)][i(328)]({FishKindID:n,Amount:0,Score:0});this[i(540)]=[],this[i(541)]=+new Date,this[i(540)]=[],this[i(542)]=0,this[i(540)]=[],this[i(543)]=[],this[i(544)]=0}(t[s(214)]=n)[s(219)][s(545)]=function(){},n[s(219)][s(546)]=function(){},n[s(219)][s(547)]=function(t,e){var i=s;if(!this[i(548)](this[i(524)]))for(var n=0;n<this[i(524)][i(269)];n++)if(this[i(524)][n][i(549)]==t){this[i(524)][n][i(550)]+=1,this[i(524)][n][i(551)]+=+e;break}},n[s(219)][s(548)]=function(t){return null==t||t==s(250)},n[s(219)][s(552)]=function(t,e,i,n,s){},n[s(219)][s(553)]=function(t,e){},n[s(219)][s(554)]=function(t){},n[s(219)][s(555)]=function(t){return 1e3},n[s(219)][s(556)]=function(t){var e=s;e(557);2==t&&e(558),3==t&&e(559)},n[s(219)][s(471)]=function(){var t=s;this[t(514)]=this[t(480)],this[t(515)]=this[t(481)],this[t(480)]=0,this[t(481)]=0},n[s(219)][s(485)]=function(){var t=s;return this[t(480)]+this[t(481)]}},function(t,e,i){"use strict";var r=_0x2576,n=i(4),s=i(1),o=i(8);function a(t,e){var i=_0x2576;this[i(348)]=t,this[i(523)]=e}(t[r(214)]=a)[r(219)][r(560)]=function(t){var e=r,i={requestId:s[e(561)],content:{UserID:10,Gold:1e6,Nickname:e(420),Level:10,Exp:1e3,DeskStation:0}},i=(this[e(348)][e(401)](i),{requestId:2002,content:{ListUserInDesk:[{UserID:10,Gold:1e6,Nickname:e(420),Exp:10,Level:10,DeskStation:0,PosX:0,PosY:0}]}});this[e(348)][e(401)](i)},a[r(219)][r(562)]=function(t){var e=r,i={requestId:s[e(563)],content:{DeskStation:0}};this[e(348)][e(401)](i),this[e(523)][e(564)][e(406)][e(565)]()},a[r(219)][r(419)]=function(t){var e=r;switch(t[e(416)]){case s[e(566)]:this[e(348)][e(423)]();break;case s[e(567)]:this[e(348)][e(432)]();break;case s[e(266)]:this[e(348)][e(443)](this[e(523)]);break;case s[e(568)]:this[e(348)][e(444)](this[e(523)]);break;case s[e(561)]:this[e(560)]();break;case s[e(563)]:this[e(562)]();break;case s[e(569)]:this[e(523)][e(564)][e(406)][e(570)](this[e(523)][e(564)],t[e(455)][e(244)],t[e(455)][e(248)]);break;case s[e(571)]:this[e(523)][e(564)][e(406)][e(572)](this[e(523)],t[e(455)][e(573)],t[e(455)][e(536)],1,t[e(455)][e(574)]);break;case s[e(575)]:var i=new o[e(576)](t,n[e(232)][e(577)]);this[e(556)](this[e(523)][e(564)],i[e(573)],i.x,i.y);break;case s[e(578)]:i=new o[e(576)](t,n[e(232)][e(578)]);this[e(579)](this[e(523)][e(564)],i[e(580)],i[e(581)],i[e(582)]);break;case s[e(583)]:i=new o[e(576)](t,n[e(232)][e(584)]);this[e(585)](i[e(244)],i[e(586)],i[e(536)]);break;case s[e(449)]:this[e(348)][e(446)]();break;case s[e(587)]:this[e(348)][e(453)](t);break;case s[e(460)]:this[e(348)][e(458)](this[e(523)]);break;case s[e(462)]:this[e(348)][e(461)](this[e(523)]);break;case s[e(466)]:this[e(348)][e(463)](this[e(523)]);break;case s[e(588)]:this[e(348)][e(484)](t);break;case s[e(589)]:this[e(348)][e(479)](t[e(455)][e(456)],t[e(455)][e(492)]);break;case s[e(590)]:this[e(348)][e(486)](this[e(523)]);break;case s[e(591)]:this[e(348)][e(488)](this[e(523)]);break;case s[e(592)]:this[e(348)][e(443)](this[e(523)]);break;case s[e(593)]:this[e(348)][e(496)](t)}},a[r(219)][r(556)]=function(t,e,i,n){var s=r;t[s(406)][s(556)](t[s(523)],e,i,n)},a[r(219)][r(579)]=function(t,e,i,n){var s=r;t[s(406)][s(579)](t[s(523)],e,i,n)},a[r(219)][r(585)]=function(t,e,i){var n=r;this[n(523)][n(564)][n(406)][n(585)](this[n(523)][n(564)],t,e,i)}},function(t,e,i){"use strict";t[_0x2576(214)]={Int8:1,UInt8:2,Int16:3,UInt16:4,Int32:5,UInt32:6,Int64:7,UInt64:8,Float:9,Double:10,StringDynamic:11,Object8:12,Array8:13}},function(t,e,i){"use strict";t[_0x2576(214)]=function(t,e,i,n){return t}},function(t,e,i){"use strict";var n=_0x2576,s=i(3),a=i(1),c=i(0),h=i(2);function r(t,e,i,n,s,r){var o=_0x2576;t=t||0,e=e||0,i=i||"",n=n||0,s=s||0,r=r||0;try{return this[o(231)](a[o(561)],new h({UserID:t,Gold:e,Nickname:i,Level:n,Exp:s,StationID:r},c[o(594)]))}catch(t){}return 0}(t[n(214)]=r)[n(219)]=new s},function(t,e,i){"use strict";var n=_0x2576,s=i(3),r=i(1),o=i(0),a=i(2);function c(t){var e=_0x2576;return this[e(231)](r[e(595)],new a({ListUserInDesk:t},o[e(596)]))}(t[n(214)]=c)[n(219)]=new s},function(t,e,i){"use strict";var n=_0x2576,s=i(3),c=i(1),h=i(0),l=i(2);function r(t,e,i,n,s,r,o){var a=_0x2576;return this[a(231)](c[a(597)],new l({UserID:t,Gold:e,Nickname:i,Level:n,StationID:s,PosX:r,PosY:o},h[a(598)]))}(t[n(214)]=r)[n(219)]=new s},function(t,e,i){"use strict";var n=_0x2576,s=i(3),r=i(1),o=i(0),a=i(2);function c(t){var e=_0x2576;return this[e(231)](r[e(599)],new a({Message:t},o[e(600)]))}(t[n(214)]=c)[n(219)]=new s},function(t,e,i){"use strict";var n=_0x2576,s=i(3),o=i(1),a=i(0),c=i(2);function r(t,e,i,n,s){var r=_0x2576;return this[r(231)](o[r(571)],new c({StationID:t,Angle:e,BulletMultiple:i,LockedFishID:n,Gold:s},a[r(601)]))}(t[n(214)]=r)[n(219)]=new s},function(t,e,i){"use strict";var n=_0x2576,s=i(3),r=i(1),o=i(0),a=i(2);function c(t){var e=_0x2576;return this[e(231)](r[e(602)],new a({ListFish:t},o[e(603)]))}(t[n(214)]=c)[n(219)]=new s},function(t,e,i){"use strict";var n=_0x2576,s=i(3),a=i(1),c=i(0),h=i(2);function r(t,e,i,n,s,r){var o=_0x2576;return this[o(231)](a[o(569)],new h({StationID:t,FishID:e,GoldReward:i,TotalGold:n,Level:s,Exp:r},c[o(604)]))}(t[n(214)]=r)[n(219)]=new s},function(t,e,i){"use strict";var n=_0x2576,s=i(3),r=i(1),o=i(0),a=i(2);function c(t){var e=_0x2576;return this[e(231)](r[e(563)],new a({StationID:t},o[e(605)]))}(t[n(214)]=c)[n(219)]=new s},function(t,e,i){"use strict";var n=_0x2576,s=i(3),r=i(1),o=i(0),a=i(2);function c(t,e,i){var n=_0x2576;return this[n(231)](r[n(606)],new a({ParadeKind:t,ParadePosition:e,ListFish:i},o[n(607)]))}(t[n(214)]=c)[n(219)]=new s},function(t,e,i){"use strict";var n=_0x2576,s=i(3),r=i(1),o=i(0),a=i(2);function c(t,e){var i=_0x2576;t=t||[],e=e||0;try{return this[i(231)](r[i(608)],new a({ListSkill:t,CurrentSkill:e},o[i(609)]))}catch(t){}return 0}(t[n(214)]=c)[n(219)]=new s},function(t,e,i){"use strict";var n=_0x2576,s=i(3),a=i(1),c=i(0),h=i(2);function r(t,e,i,n,s,r){var o=_0x2576;t=t||0,e=e||0,i=i||0,n=n||0,s=s||0,r=r||0;try{return this[o(231)](a[o(575)],new h({DeskStation:t,Angle:e,x:i,y:n,BulletID:s,SkillID:r},c[o(575)]))}catch(t){}return 0}(t[n(214)]=r)[n(219)]=new s},function(t,e,i){"use strict";var n=_0x2576,s=i(3),r=i(1),o=i(0),a=i(2);function c(t,e,i){var n=_0x2576;t=t||0,e=e||0,i=i||0;try{return this[n(231)](r[n(610)],new a({SkillID:t,SkillScore:e,IsUseSkill:i},o[n(610)]))}catch(t){}return 0}(t[n(214)]=c)[n(219)]=new s},function(t,e,i){"use strict";var n=_0x2576,s=i(3),r=i(1);function o(){var t=_0x2576;return this[t(231)](r[t(611)])}(t[n(214)]=o)[n(219)]=new s},function(t,e,i){"use strict";var n=_0x2576,s=i(3),r=i(1),o=i(0),a=i(2);function c(t,e){var i=_0x2576;try{return this[i(231)](r[i(612)],new a({State:t,Msg:e},o[i(613)]))}catch(t){}return 0}(t[n(214)]=c)[n(219)]=new s},function(t,e,i){"use strict";var n=_0x2576,s=i(3),r=i(1),o=i(0),a=i(2);function c(t){var e=_0x2576;return this[e(231)](r[e(614)],new a({FishID:t[e(244)],BossID:t[e(244)],FishKind:t[e(245)],MaxHP:t[e(615)],CurrentHP:t[e(616)],PathSeed:t[e(617)],BirthTime:t[e(618)]},o[e(619)]))}(t[n(214)]=c)[n(219)]=new s},function(t,e,i){"use strict";var n=_0x2576,s=i(3),r=i(1),o=i(0),a=i(2);function c(t){var e=_0x2576;return this[e(231)](r[e(620)],new a({ListFish:t},o[e(621)]))}(t[n(214)]=c)[n(219)]=new s},function(t,e,i){"use strict";var n=_0x2576,s=i(3),c=i(1),h=i(0),l=i(2);function r(t,e,i,n,s,r,o){var a=_0x2576;try{return this[a(231)](c[a(583)],new l({StationID:t,FishID:e,GoldReward:i,TotalGold:n,Level:s,Exp:r,FishIDArray:o},h[a(622)]))}catch(t){}return 0}(t[n(214)]=r)[n(219)]=new s},function(t,e,i){"use strict";var n=_0x2576,s=i(3),r=i(1),o=i(0),a=i(2);function c(t,e,i){var n=_0x2576;return this[n(231)](r[n(623)],new a({BossID:t,ValueHP:e,CurrentHP:i},o[n(623)]))}(t[n(214)]=c)[n(219)]=new s},function(t,e,i){"use strict";var n=_0x2576,s=i(3),o=i(1),a=i(0),c=i(2);function r(t,e,i,n,s){var r=_0x2576;return this[r(231)](o[r(624)],new c({BossID:t,UserID:e,GoldReward:i,CardReward:n,NumberOfCard:s},a[r(625)]))}(t[n(214)]=r)[n(219)]=new s},function(t,e,i){"use strict";var n=_0x2576,s=i(3),o=i(1),a=i(0),c=i(2);function r(t,e,i,n){var s=_0x2576,r=+new Date,r=Math[s(261)]((r-i)/1e3);return this[s(231)](o[s(626)],new c({ParadeKind:t,PathSeed:e,BirthTime:r,ListFish:n},a[s(627)]))}(t[n(214)]=r)[n(219)]=new s},function(t,e,i){"use strict";var n=_0x2576,s=i(3),o=i(1),a=i(0),c=i(2);function r(t,e,i,n,s){var r=_0x2576;return this[r(231)](o[r(628)],new c({StationID:t,FishID:e,EffectID:i,GoldReward:n,TotalGold:s},a[r(629)]))}(t[n(214)]=r)[n(219)]=new s},function(t,e,i){"use strict";var n=_0x2576,s=i(3),r=i(1);i(0),i(2);function o(){var t=_0x2576;return this[t(231)](r[t(630)])}(t[n(214)]=o)[n(219)]=new s},function(t,e,i){"use strict";var n=_0x2576,s=i(3),r=i(1),o=i(0),a=i(2);function c(t){var e=_0x2576;return this[e(231)](r[e(631)],new a({EffectID:t},o[e(632)]))}(t[n(214)]=c)[n(219)]=new s},function(t,e,i){"use strict";var n=_0x2576,s=i(3),r=i(1),o=i(0),a=i(2);function c(t){var e=_0x2576;return this[e(231)](r[e(633)],new a({EffectID:t},o[e(634)]))}(t[n(214)]=c)[n(219)]=new s},function(t,e,i){"use strict";var n=_0x2576,s=i(3),o=i(1),a=i(0),c=i(2);function r(t,e,i,n,s){var r=_0x2576;return this[r(231)](o[r(635)],new c({BossID:t,SkillID:e,Direction:i,TimeEffect:n,Distance:s},a[r(636)]))}(t[n(214)]=r)[n(219)]=new s},function(t,e,i){"use strict";var n=_0x2576,s=i(3),r=i(1),o=i(0),a=i(2);function c(t,e){var i=_0x2576;return this[i(231)](r[i(496)],new a({StationID:t,ChatID:e},o[i(637)]))}(t[n(214)]=c)[n(219)]=new s},function(t,e,i){"use strict";var n=_0x2576,s=i(3),r=i(1),o=i(0),a=i(2);function c(t){var e=_0x2576;return this[e(231)](r[e(595)],new a({ListUserInDesk:t},o[e(638)]))}(t[n(214)]=c)[n(219)]=new s},function(t,e,i){"use strict";var n=_0x2576,s=i(3),r=i(1),o=i(0),a=i(2);function c(t,e,i){var n=_0x2576;new Date;return this[n(231)](r[n(626)],new a({ParadeKind:t,SceneKind:e,ListFish:i},o[n(639)]))}(t[n(214)]=c)[n(219)]=new s},function(t,e,i){"use strict";var n=_0x2576,s=i(3),r=i(1),o=i(0),a=i(2);function c(t){var e=_0x2576;return this[e(231)](r[e(602)],new a({ListFish:t},o[e(640)]))}(t[n(214)]=c)[n(219)]=new s},function(t,e,i){"use strict";var n=_0x2576,s=i(3),h=i(1),l=i(0),u=i(2);function r(t,e,i,n,s,r,o,a){var c=_0x2576;return this[c(231)](h[c(597)],new u({UserID:t,Gold:e,Nickname:i,Level:n,Exp:a,StationID:s,PosX:r,PosY:o},l[c(641)]))}(t[n(214)]=r)[n(219)]=new s},function(t,e,i){"use strict";var n=_0x2576,s=i(3),r=i(1),o=i(0),a=i(2);function c(t){var e=_0x2576;return this[e(231)](r[e(620)],new a({ListFish:t},o[e(642)]))}(t[n(214)]=c)[n(219)]=new s},function(t,e,i){"use strict";var n=_0x2576,s=i(3),r=i(1),o=i(0),a=i(2);function c(t,e){var i=_0x2576;return this[i(231)](r[i(643)],new a({CurrentPoint:t,PointToGetTicket:e},o[i(644)]))}(t[n(214)]=c)[n(219)]=new s},function(t,e,i){"use strict";var n=_0x2576,s=i(3),r=i(1),o=i(0),a=i(2);function c(t,e,i){var n=_0x2576;return this[n(231)](r[n(645)],new a({StationID:t,CurrentPoint:e,IsGetTicket:i},o[n(646)]))}(t[n(214)]=c)[n(219)]=new s},function(t,e,i){"use strict";var n=_0x2576,s=i(2),r=i(3),o=i(1),a=i(0);function c(t,e){var i=_0x2576;try{return this[i(231)](o[i(647)],new s({Ticket:t,Money:e},a[i(648)]))}catch(t){console[i(649)](t)}}(t[n(214)]=c)[n(219)]=new r},function(t,e,i){"use strict";var n=_0x2576,s=i(2),r=i(3),o=i(1),a=i(0);function c(t){var e=_0x2576;return this[e(231)](o[e(650)],new s({ID:t},a[e(651)]))}(t[n(214)]=c)[n(219)]=new r},function(t,e,i){"use strict";var n=_0x2576,s=i(2),r=i(3),o=i(1),a=i(0);function c(t){var e=_0x2576;return this[e(231)](o[e(652)],new s({ErrorCode:t},a[e(653)]))}(t[n(214)]=c)[n(219)]=new r},function(t,e,i){"use strict";var n=_0x2576,s=i(2),r=i(3),o=i(1),a=i(0);function c(t){var e=_0x2576;return this[e(231)](o[e(654)],new s({ListItem:t},a[e(655)]))}(t[n(214)]=c)[n(219)]=new r},function(t,e,i){"use strict";var n=_0x2576,s=i(2),r=i(3),o=i(1),a=i(0);function c(t){var e=_0x2576;return this[e(231)](o[e(568)],new s({HistoryList:t},a[e(656)]))}(t[n(214)]=c)[n(219)]=new r},function(t,e,i){"use strict";var n=_0x2576,s=i(2),r=i(3),o=i(1),a=i(0);function c(t,e,i){var n=_0x2576;try{return this[n(231)](o[n(449)],new s({Gold:t,FreeTicket:e,ScatterTicket:i},a[n(657)]))}catch(t){console[n(649)](n(449),t)}}(t[n(214)]=c)[n(219)]=new r},function(t,e,i){"use strict";var n=_0x2576,s=i(2),r=i(3),o=i(1),a=i(0);function c(t){var e=_0x2576;try{return this[e(231)](o[e(658)],new s({Msg:t},a[e(659)]))}catch(t){console[e(649)](e(658),t)}}(t[n(214)]=c)[n(219)]=new r},function(t,e,i){"use strict";var n=_0x2576,l=i(2),s=i(3),u=i(1),d=i(0);function r(t,e,i,n,s,r,o,a,c){var h=_0x2576;try{return this[h(231)](u[h(660)],new l({WheelWidth:t,ResultArray:e,LineResult:i,GoldReward:n,ScatterTicket:s,FreeTicket:r,MatchID:o,TotalGold:a,BetValue:c},d[h(660)]))}catch(t){console[h(649)](h(660),t)}}(t[n(214)]=r)[n(219)]=new s},function(t,e,i){"use strict";var n=_0x2576,s=i(2),r=i(3),o=i(1),a=i(0);function c(t){var e=_0x2576;try{return this[e(231)](o[e(452)],new s({BetValueList:t},a[e(661)]))}catch(t){console[e(649)](e(452),t)}}(t[n(214)]=c)[n(219)]=new r},function(t,e,i){"use strict";var n=_0x2576,s=i(2),r=i(3),o=i(1),a=i(0);function c(t){var e=_0x2576;try{return this[e(231)](o[e(462)],new s({JackpotValueList:t},a[e(662)]))}catch(t){console[e(649)](e(462),t)}}(t[n(214)]=c)[n(219)]=new r},function(t,e,i){"use strict";var n=_0x2576,s=i(2),r=i(3),o=i(1),a=i(0);function c(t){var e=_0x2576;try{return this[e(231)](o[e(460)],new s({History:t},a[e(663)]))}catch(t){console[e(649)](e(452),t)}}(t[n(214)]=c)[n(219)]=new r},function(t,e,i){"use strict";var n=_0x2576,s=i(2),r=i(3),o=i(1),a=i(0);function c(t){var e=_0x2576;try{return this[e(231)](o[e(466)],new s({TopWin:t},a[e(664)]))}catch(t){console[e(649)](e(466),t)}}(t[n(214)]=c)[n(219)]=new r},function(t,e,i){"use strict";var n=_0x2576,r=i(2),s=i(3),o=i(1),a=i(0);function c(t,e,i,n){var s=_0x2576;try{return this[s(231)](o[s(665)],new r({MatchID:t,BetValue:e,GoldReward:i,TotalGold:n},a[s(666)]))}catch(t){console[s(649)](s(667),t)}}(t[n(214)]=c)[n(219)]=new s},function(t,e,i){"use strict";var n=_0x2576,l=i(2),s=i(3),u=i(1),d=i(0);function r(t,e,i,n,s,r,o,a,c){var h=_0x2576;try{return this[h(231)](u[h(668)],new l({Gold:t,MatchID:e,State:i,TimeCoolDown:n,Result:s,GoldUserBetTai:r[h(669)],GoldUserBetXiu:r[h(670)],TotalTai:r[h(671)],NumberUserBetTai:r[h(672)],TotalXiu:r[h(673)],NumberUserBetXiu:r[h(674)],BetValueList:o,MinBet:a,MaxBet:c},d[h(675)]))}catch(t){console[h(649)](t)}}(t[n(214)]=r)[n(219)]=new s},function(t,e,i){"use strict";var n=_0x2576,s=i(2),r=i(3),o=i(1),a=i(0);function c(t,e,i){var n=_0x2576;try{return this[n(231)](o[n(676)],new s({MatchID:t,State:e,TimeCoolDown:i},a[n(677)]))}catch(t){console[n(649)](t)}}(t[n(214)]=c)[n(219)]=new r},function(t,e,i){"use strict";var n=_0x2576,o=i(2),s=i(3),a=i(1),c=i(0);function r(t,e,i,n,s){var r=_0x2576;try{return this[r(231)](a[r(678)],new o({State:t,TimeCoolDown:e,Result:i,GoldUserWin:n,TotalUserGold:s},c[r(679)]))}catch(t){console[r(649)](t)}}(t[n(214)]=r)[n(219)]=new s},function(t,e,i){"use strict";var n=_0x2576,o=i(2),s=i(3),a=i(1),c=i(0);function r(t,e,i,n,s){var r=_0x2576;try{return this[r(231)](a[r(589)],new o({UserID:t,BetID:e,GoldBet:i,TotalBet:n,NumberBet:s},c[r(680)]))}catch(t){console[r(649)](t)}}(t[n(214)]=r)[n(219)]=new s},function(t,e,i){"use strict";var n=_0x2576,s=i(2),r=i(3),o=i(1),a=i(0);function c(t){var e=_0x2576;try{return this[e(231)](o[e(590)],new s({ResultArray:t},a[e(681)]))}catch(t){console[e(649)](t)}}(t[n(214)]=c)[n(219)]=new r},function(t,e,i){"use strict";var n=_0x2576,s=i(2),r=i(3),o=i(1),a=i(0);function c(t){var e=_0x2576;try{return this[e(231)](o[e(591)],new s({BetHistory:t},a[e(682)]))}catch(t){console[e(649)](t)}}(t[n(214)]=c)[n(219)]=new r},function(t,e,i){"use strict";var n=_0x2576,s=i(2),r=i(3),o=i(1),a=i(0);function c(t,e,i){var n=_0x2576;try{return this[n(231)](o[n(593)],new s({UserID:t,Nickname:e,Message:i},a[n(683)]))}catch(t){console[n(649)](t)}}(t[n(214)]=c)[n(219)]=new r},function(t,e,i){"use strict";var n=_0x2576,s=i(2),r=i(3),o=i(1),a=i(0);function c(t){var e=_0x2576;try{return this[e(231)](o[e(684)],new s({Gold:t},a[e(685)]))}catch(t){console[e(649)](t)}}(t[n(214)]=c)[n(219)]=new r},function(t,e,i){"use strict";var n=_0x2576,s=i(2),r=i(3),o=i(1),a=i(0);function c(t,e,i){var n=_0x2576;try{return this[n(231)](o[n(686)],new s({MinBet:t,MaxBet:e,BetValueList:i},a[n(687)]))}catch(t){console[n(649)](t)}}(t[n(214)]=c)[n(219)]=new r},function(t,e,i){"use strict";var u=_0x2576,l=i(4),h=i(6);function n(t,e){var i=_0x2576;this[i(348)]=t,this[i(688)]=e,this[i(451)]=0,this[i(689)]=3,this[i(690)]=3,this[i(691)]=5,this[i(387)]=[],this[i(692)]=0,this[i(693)]=0,this[i(694)]=[],this[i(695)]=0,this[i(387)]=this[i(348)][i(447)],this[i(454)]=0,this[i(696)]=0,this[i(697)]=3500}(t[u(214)]=n)[u(219)][u(453)]=function(t,e){var i=u,n=0,s=(0<e&&(n=this[i(698)](e)),this[i(699)](),0),n=(this[i(692)]?s=this[i(693)]:(s=n[i(700)],this[i(688)][i(427)]-=s),this[i(454)]=1,this[i(695)]=0,this[i(701)](this[i(692)]));this[i(702)](n,19,s,e)},n[u(219)][u(699)]=function(){var t=u;0<this[t(688)][t(451)]?(this[t(692)]=2,this[t(693)]=this[t(688)][t(521)],this[t(688)][t(451)]--):0<this[t(688)][t(450)]&&this[t(348)][t(703)]?(this[t(692)]=1,this[t(693)]=this[t(348)][t(703)],this[t(688)][t(450)]--):(this[t(692)]=0,this[t(693)]=0)},n[u(219)][u(698)]=function(t){for(var e=u,i=0;i<this[e(387)][e(269)];i++)if(this[e(387)][i][e(457)]==t)return this[e(387)][i];return 0},n[u(219)][u(701)]=function(t){for(var e=u,i=[],n=[],n=t?h[e(704)][e(705)]:h[e(704)][e(706)],s=0;s<n[e(269)];s++){for(var r=Math[e(261)](Math[e(258)]()*n[s][e(269)]),o=[],a=0;a<this[e(690)];a++){var c=(r+a)%n[s][e(269)];o[e(328)](n[s][c])}i[e(328)](o)}return i},n[u(219)][u(702)]=function(t,e,i,n){for(var s=u,r=this[s(477)](t),o=this[s(707)](t),a=r*i/this[s(691)]*1,c=(this[s(688)][s(451)]+=o,[]),h=0;h<t[s(269)];h++)c=c[s(708)](t[h]);this[s(709)](a,r,0);this[s(692)],this[s(688)][s(427)]+=a;o=new l[s(660)](this[s(690)],c,this[s(694)],a,this[s(688)][s(451)],this[s(688)][s(450)],e,this[s(688)][s(427)],i);this[s(348)][s(400)](o),this[s(688)][s(521)]=i,this[s(696)]=e,setTimeout(function(){var t,e=s;this[e(695)]||(this[e(454)]=0),(0<this[e(688)][e(451)]||0<this[e(688)][e(450)])&&(t=new l[e(452)](this[e(348)][e(447)]),this[e(348)][e(400)](this[e(688)][e(523)],t),this[e(453)](0,0))}[s(415)](this),this[s(697)]),this[s(695)]&&(this[s(454)]=0,a=d,this[s(688)][s(427)]+=a,this[s(709)](a,r,1),o=new l[s(665)](e,i,a,this[s(688)][s(427)]),this[s(348)][s(400)](this[s(688)][s(523)],o))},n[u(219)][u(477)]=function(t){var e=u,i=0,n=[];this[e(694)]=[],n[0]=[],n[1]=[],n[2]=[],n[3]=[],n[4]=[];for(var s=0;s<t[e(269)];s++)n[0][e(328)](t[s][0]),n[1][e(328)](t[s][1]),n[2][e(328)](t[s][2]),n[3][e(328)](t[s][s]),n[4][e(328)](t[s][this[e(690)]-s-1]);for(s=0;s<n[e(269)];s++){var r=this[e(710)](n[s]);r?this[e(694)][e(328)](1):this[e(694)][e(328)](0),!this[e(695)]&&(this[e(695)]=this[e(711)](n[s]),this[e(695)])&&(this[e(694)][e(334)](),this[e(694)][e(328)](1)),i+=r}return i},n[u(219)][u(707)]=function(t){for(var e=u,i=0;i<t[e(269)];i++){var n=t[i][e(712)](2);if(!(-1<n))return 0}return this[e(348)][e(713)]},n[u(219)][u(710)]=function(t){for(var e=u,i=0,n=h[e(714)],s=0;s<n[e(269)];s++){for(var r=0,o=1,a=0;a<t[e(269)];a++){if(0<n[s][e(715)][e(269)]){var c=n[s][e(715)][e(712)](t[a]);if(-1<c){r=1;continue}}0<n[s][e(716)][e(269)]&&(n[s][e(717)]?n[s][e(716)][a]!==t[a]&&0!==t[a]&&(o=0):-1<(c=n[s][e(716)][e(712)](t[a]))||0===t[a]||(o=0))}if(o&&!r)return i+n[s][e(249)]}return i},n[u(219)][u(711)]=function(t){for(var e=u,i=0;i<t[e(269)];i++)if(1!=t[i])return 0;return 1},n[u(219)][u(718)]=function(){var t=u;return this[t(688)][t(451)]+this[t(688)][t(450)]},n[u(219)][u(719)]=function(){var t=u,e=[];do{if(this[t(699)](),this[t(692)]){for(var i=this[t(701)](this[t(692)]),n=this[t(477)](i),s=this[t(693)],r=this[t(707)](i),o=n*s/this[t(691)]*1,a=(this[t(451)]+=r,[]),c=0;c<i[t(269)];c++)a=a[t(708)](i[c]);e[t(328)]({MatchID:0,UserID:this[t(688)][t(482)],GoldBet:s,GoldReward:o,ScatterTicket:this[t(451)],FreeTicket:this[t(688)][t(450)],ResultArray:a,LineResult:this[t(694)],FreeSpin:this[t(692)],Ratio:n})}}while(0<this[t(718)]());this[t(720)](e[t(333)]())},n[u(219)][u(709)]=function(t,e,i){var n=u;(e/this[n(691)]>=this[n(348)][n(721)]||1==i)&&(i=0,this[n(695)]?i=1:e>this[n(348)][n(722)][0][n(249)]&&(i=2),this[n(348)][n(723)][n(724)](this[n(688)][n(482)],this[n(688)][n(431)],i,t))},n[u(219)][u(725)]=function(t){var e=u,i=this[e(688)][e(431)],t=this[e(348)][e(726)](Math[e(261)](t)),i=e(727)+i+e(728)+t+e(729);this[e(348)][e(730)][e(731)]({SID:0,CMD:h[e(732)][e(733)][e(734)],Data:{Priority:9999,Msg:i,UrlLink:"",ChannelID:0}}),this[e(348)][e(735)](this[e(688)][e(482)])},n[u(219)][u(720)]=function(i){var n,t,s,e,r,o,a,c,h,l=u;0<i[l(269)]&&(h=i[l(334)](),n=this[l(696)],t=h[l(492)],s=h[l(736)],e=h[l(451)],r=h[l(450)],o=h[l(377)],a=h[l(694)],c=h[l(692)],h=h[l(249)],this[l(348)][l(723)][l(737)](n,this[l(688)][l(482)],t,s,e,r,o,a,c),this[l(709)](t,h),0<s)&&this[l(348)][l(738)](s,n,this[l(688)][l(482)],s,function(t){var e=l;this[e(348)][e(739)]?this[e(348)][e(740)][e(741)]()[e(742)](e(743),n,this[e(688)][e(482)]):this[e(688)][e(427)]+=0<s?s:0,this[e(720)](i)}[l(415)](this))},n[u(219)][u(744)]=function(t,e){var i=u,n=-1,s=this[i(348)][i(745)];return n=0<(s=e?this[i(348)][i(746)]:s)[i(269)]?s[t]:n}},function(t,e,i){"use strict";var n=_0x2576;t[n(214)][n(396)]=function(){return new(i(92))}},function(t,e,i){"use strict";var p=_0x2576,s=i(6),f=i(4),n=i(93),r=i(12),o=i(98),l=i(11);function a(){var t=_0x2576;this[t(348)]=0,this[t(525)]=0,this[t(352)]=!0,this[t(595)]=[],this[t(747)]=+new Date,this[t(748)]=[],this[t(749)]=[{Tick:0,Interval:3e4,Wake:this[t(626)][t(415)](this)}],this[t(750)]=[{Tick:0,Interval:12e4,Wake:this[t(751)][t(415)](this)}],this[t(752)]={Tick:0,Interval:1e3},this[t(753)]=[0,1,2,3],this[t(754)]=0,this[t(755)]="",this[t(582)]=[],this[t(351)]=s[t(351)][t(756)],this[t(757)]=0,this[t(758)]=0,this[t(353)]=s,this[t(759)]=0,this[t(609)],this[t(760)]=0,this[t(761)]=0,this[t(762)]=0,this[t(763)]={BrainFreeze:1,Stunned:2},this[t(764)]=[],this[t(765)]=0,this[t(766)]=1e4,this[t(767)]=120,this[t(768)]=0,this[t(769)](),this[t(770)]=0}(t[p(214)]=a)[p(219)][p(771)]=function(t,e){var i=p;this[i(348)]=t,this[i(525)]=e,this[i(352)]=!1,this[i(757)]=new n(this)},a[p(219)][p(772)]=function(){var t=p;this[t(771)](this[t(348)],this[t(525)]),this[t(609)]=new o(this[t(348)],this)},a[p(219)][p(392)]=function(t,e){var i=p;this[i(348)]=t,this[i(525)]=e,this[i(772)](),this[i(770)]=setInterval(this[i(773)][i(415)](this),100)},a[p(219)][p(407)]=function(){var t=p;!this[t(352)]&&0<this[t(595)][t(269)]&&(this[t(352)]=!0,this[t(774)]())},a[p(219)][p(565)]=function(){var t=p;this[t(352)]=!1,this[t(774)](),clearInterval(this[t(770)])},a[p(219)][p(773)]=function(){var t=p;if(this[t(352)]){var e=new Date,i=e-this[t(747)];if(0<this[t(595)][t(269)]){if(0==this[t(758)]&&0==this[t(765)]){for(var n=0;n<this[t(748)][t(269)];n++)this[t(748)][n][t(775)]+=i,this[t(748)][n][t(775)]>this[t(748)][n][t(776)]&&(this[t(748)][n][t(775)]=0,this[t(748)][n][t(777)]());for(n=0;n<this[t(749)][t(269)];n++)this[t(749)][n][t(775)]+=i,this[t(749)][n][t(775)]>this[t(749)][n][t(776)]&&(this[t(749)][n][t(775)]=0,this[t(749)][n][t(777)]())}for(n=0;n<this[t(764)][t(269)];n++)this[t(764)][n][t(775)]+=i,this[t(764)][n][t(775)]>this[t(764)][n][t(776)]&&(this[t(764)][n][t(775)]=0,this[t(764)][n][t(777)]());for(n=0;n<this[t(750)][t(269)];n++)this[t(750)][n][t(775)]+=i,this[t(750)][n][t(775)]>this[t(750)][n][t(776)]&&(this[t(750)][n][t(775)]=0,this[t(750)][n][t(777)]())}this[t(747)]=e}},a[p(219)][p(774)]=function(){var t=p;this[t(747)]=+new Date;for(var e=0;e<this[t(748)][t(269)];e++)this[t(748)][e][t(775)]=0},a[p(219)][p(751)]=function(){for(var t=p,e=(new Date)[t(778)](),i=0;i<this[t(582)][t(269)];i++)e-this[t(582)][i][t(246)]>1e3*this[t(767)]&&-1<i&&(this[t(582)][t(478)](i,1),i--)},a[p(219)][p(405)]=function(t){var e=p;this[e(595)][e(328)]({User:t,DeskStation:0})},a[p(219)][p(779)]=function(t){for(var e=p,i=0;i<this[e(595)][e(269)];i++)if(this[e(595)][i][e(688)][e(523)]==t)return this[e(595)][i];return null},a[p(219)][p(473)]=function(t){var e=p;this[e(348)][e(401)](t)},a[p(219)][p(780)]=function(t,e){},a[p(219)][p(781)]=function(t){return!0},a[p(219)][p(782)]=function(t){var e=p;if(!this[e(548)](this[e(582)]))for(var i=0;i<this[e(582)][e(269)];i++)if(this[e(582)][i][e(244)]==t)return this[e(582)][i];return 0},a[p(219)][p(783)]=function(t){var e=p,i=-1;if(!this[e(548)](this[e(582)]))for(var n=0;n<this[e(582)][e(269)];n++)if(this[e(582)][n][e(244)]==t){i=n;break}return i},a[p(219)][p(784)]=function(t){var e=p,t=this[e(783)](t);-1<t&&this[e(582)][e(478)](t,1)},a[p(219)][p(548)]=function(t){return!r[p(268)](t)},a[p(219)][p(547)]=function(t,e,i){var n=p;e<=s[n(351)][n(245)][n(785)]&&t[n(547)](e,i)},a[p(219)][p(585)]=function(t,e,i,n){var s=p,r=this[s(782)](e);if(0!=r&&1==r[s(253)]&&0<n)if(t[s(533)]>=n){t[s(533)]-=0<n?+n:0;for(var o=r[s(248)],a=0;a<i[s(269)];a++){var c=this[s(782)](i[a]);c[s(245)]==r[s(245)]&&(o+=c[s(248)])}var h=r[s(256)](1,t[s(482)],n,0,o),l=h*n;if(0<h){t[s(533)]+=0<l?l:0,this[s(786)](l,t),this[s(348)][s(787)](t,n,r[s(245)],l,e,this);var u=new f[s(583)](t[s(526)],e,l,t[s(533)],t[s(535)],t[s(534)],i),d=(this[s(473)](u),i);d[s(328)](e);for(a=0;a<d[s(269)];a++)if(this[s(784)](d[a]),this[s(758)])for(a=0;a<d[s(269)];a++){var _=this[s(788)](d[a]);-1!=_&&(this[s(760)][s(582)][_][s(244)]=0,this[s(760)][s(582)][_][s(245)]=-1),this[s(789)]()&&setTimeout(function(){this[s(790)]()}[s(415)](this),1e3)}t[s(552)](30,n,o,1,1)}else{t[s(552)](30,n,0,1,0);u=new f[s(569)](t[s(526)],0,0,t[s(533)],t[s(535)],t[s(530)]);this[s(473)](u)}}else this[s(791)](t[s(523)])},a[p(219)][p(570)]=function(t,e,i){this[p(792)](t,e,i,0)},a[p(219)][p(793)]=function(){var t,e=p;0==this[e(758)]&&(t=Math[e(261)](5*Math[e(258)]())+1,t=this[e(757)][e(793)](t,0,0),t=new f[e(602)](t),this[e(473)](t))},a[p(219)][p(606)]=function(){var t,i=p;0==this[i(758)]&&(this[i(758)]=1,t=new f[i(611)],this[i(473)](t),setTimeout(function(){var t=i;this[t(757)][t(606)]()}[i(415)](this),2e3),setTimeout(function(){var t=i,e=(this[t(758)]=0,new f[t(611)]);this[t(473)](e)}[i(415)](this),6e4))},a[p(219)][p(794)]=function(){var t,e=p;0==this[e(758)]&&(t=this[e(757)][e(794)](),t=new f[e(602)](t),this[e(473)](t))},a[p(219)][p(795)]=function(){var t,e=p;0==this[e(758)]&&(t=this[e(757)][e(795)](),t=new f[e(602)](t),this[e(473)](t))},a[p(219)][p(614)]=function(t,e,i,n,s){var r=p,o=+new Date,o=Math[r(261)]((o-s)/1e3),s=(this[r(759)]=this[r(757)][r(614)](t,e,i,n,o),new f[r(614)](this[r(759)]));this[r(473)](s)},a[p(219)][p(620)]=function(){var t,e=p;0==this[e(758)]&&(t=this[e(757)][e(620)](),t=new f[e(620)](t),this[e(473)](t))},a[p(219)][p(796)]=function(t,e){var i=p,n=[];if(this[i(582)]){for(var s=0,r=this[i(582)];s<r;s++)this[i(582)][s][i(245)]==t&&n[i(328)](this[i(582)][s]);0<e&&(n=n[i(338)](0,e))}return n},a[p(219)][p(797)]=function(t){var e=p,t=new f[e(623)](t[e(244)],t[e(798)],t[e(616)]);this[e(473)](t)},a[p(219)][p(791)]=function(t){var e=p,i=new f[e(613)](1,e(799));this[e(473)](i)},a[p(219)][p(626)]=function(){var t,e,i=p;0==this[i(758)]&&(this[i(758)]=1,t=new f[i(611)],this[i(473)](t),t=this[i(757)][i(800)](),e=1e3*this[i(348)][i(356)][i(801)],this[i(473)](t),this[i(768)]=setTimeout(function(){this[i(790)]()}[i(415)](this),e))},a[p(219)][p(788)]=function(t){var e=p;if(0!=this[e(760)])for(var i=0;i<this[e(760)][e(582)][e(269)];i++)if(this[e(760)][e(582)][i][e(244)]==t)return i;return-1},a[p(219)][p(802)]=function(t){return 3*(t*t*t*t*2+t*t*t*6+t*t*4+25*t)},a[p(219)][p(786)]=function(t,e){var i=p,n=(t/=10,e[i(535)]=+e[i(535)],e[i(534)]=+e[i(534)],this[i(802)](e[i(535)]));e[i(534)]+=+t,e[i(534)]>=n&&(e[i(535)]+=1,e[i(534)]=0)},a[p(219)][p(803)]=function(t){var e=p;if(1==this[e(761)]){this[e(748)]=[];for(var i=0;i<t[e(269)];i++)this[e(748)][e(328)]({Tick:0,Interval:t[i][e(776)],Wake:this[e(804)](t[i][e(403)])})}},a[p(219)][p(804)]=function(t){var e=p,i=0;switch(t){case 1:i=this[e(794)][e(415)](this);break;case 2:i=this[e(795)][e(415)](this);break;case 3:i=this[e(805)][e(415)](this);break;case 4:i=this[e(806)][e(415)](this);break;case 5:i=this[e(620)][e(415)](this);break;case 6:i=this[e(626)][e(415)](this)}return i},a[p(219)][p(807)]=function(t){for(var e=p,i=0,n=0;n<this[e(595)][e(269)];n++){var s=this[e(595)][n];s[e(688)][e(482)]==t&&(i=s[e(688)])}return i},a[p(219)][p(805)]=function(){var t,e=p;0==this[e(758)]&&(t=this[e(757)][e(805)](),t=new f[e(602)](t),this[e(473)](t))},a[p(219)][p(806)]=function(){var t,e=p;0==this[e(758)]&&(t=this[e(757)][e(806)](),t=new f[e(602)](t),this[e(473)](t))},a[p(219)][p(808)]=function(t){for(var e=p,i=0,n=this[e(353)][e(809)][e(810)],s=0;s<n[e(269)];s++){var r=n[s];r[e(811)]==t&&(i=r)}return i},a[p(219)][p(812)]=function(t){var e=p;0==this[e(758)]&&0==this[e(765)]&&(t=this[e(757)][e(813)](t),t=new f[e(814)](t),this[e(473)](t))},a[p(219)][p(815)]=function(t,e){var i=p,n=this[i(348)][i(816)](t);0!=n&&(t=new f[i(624)](t,e,n[i(817)],n[i(818)],n[i(819)]),this[i(473)](t))},a[p(219)][p(820)]=function(t){var e=p;this[e(748)]=[];for(var i=0;i<t[e(269)];i++){var n=this[e(821)][e(415)](this,t[i]);t[i][e(822)];1==t[i][e(823)]&&(n=this[e(812)][e(415)](this,t[i])),this[e(748)][e(328)]({FishKind:t[i][e(245)],Path:t[i][e(824)],Tick:0,Interval:t[i][e(440)],MinY:t[i][e(825)],MaxY:t[i][e(826)],MinZ:t[i][e(827)],MaxZ:t[i][e(828)],Wake:n})}},a[p(219)][p(821)]=function(t){var e=p;0==this[e(758)]&&0==this[e(765)]&&(t=this[e(757)][e(829)](t),t=new f[e(830)](t),this[e(473)](t))},a[p(219)][p(831)]=function(){this[p(765)]=1},a[p(219)][p(832)]=function(t){for(var e=p,i=0;i<this[e(764)][e(269)];i++){var n=this[e(764)][i];t==n[e(833)]&&this[e(764)][e(478)](i,1),(1==t&&2==n[e(833)]||2==t&&1==n[e(833)])&&this[e(764)][e(478)](i,1)}this[e(764)][e(328)]({EffectID:t,Tick:0,Interval:this[e(766)],Wake:this[e(834)][e(415)](this,t)})},a[p(219)][p(835)]=function(t){var e=p,i=new f[e(631)](t);this[e(473)](i),1!=t&&2!=t||(this[e(765)]=1)},a[p(219)][p(834)]=function(t){var e=p,i=new f[e(633)](t);this[e(473)](i),this[e(836)](t),1!=t&&2!=t||(this[e(765)]=0)},a[p(219)][p(631)]=function(t){var e=p;this[e(832)](t),this[e(835)](t)},a[p(219)][p(836)]=function(t){for(var e=p,i=0;i<this[e(764)][e(269)];i++)if(this[e(764)][i][e(833)]==t){this[e(764)][e(478)](i,1);break}},a[p(219)][p(408)]=function(t){var e=p;this[e(609)][e(608)](t)},a[p(219)][p(556)]=function(t,e,i,n){var s=p,r=this[s(779)](t);this[s(548)](r)||this[s(609)][s(837)](t[s(564)],e,i,n)},a[p(219)][p(579)]=function(t,e,i,n){var s=p;try{var r=this[s(779)](t);!this[s(548)](r)&&!this[s(548)](this[s(348)][s(838)])&&0<this[s(348)][s(838)][s(269)]&&this[s(609)][s(839)](t[s(564)],e,i,n)}catch(t){this[s(348)][s(740)][s(741)]()[s(742)](s(840)+t)}},a[p(219)][p(841)]=function(t,e){var i=p;this[i(609)][i(841)](t,e)},a[p(219)][p(769)]=function(){var t=p,e=i(7);this[t(820)](e),this[t(353)][t(842)]=e},a[p(219)][p(843)]=function(t,e,i){for(var n=p,s=[],r=0;r<t[n(269)];r++){var o=t[r],a=this[n(757)][n(844)](),c=(o[n(244)]=a,new l[n(845)](a,o[n(245)],+new Date,0,o[n(846)],o[n(251)],o[n(252)],0));c[n(259)](this,e,a,i),this[n(582)][n(328)](c),o[n(253)]=0,o[n(847)]=3,o[n(848)]=this[n(757)][n(849)](c[n(847)],o[n(245)]),s[n(328)](o)}var h=new f[n(830)](s);this[n(473)](h)},a[p(219)][p(850)]=function(t,e,i,n,s){var r=p;this[r(758)]||(t=new f[r(635)](t,e,i,n,s),this[r(473)](t))},a[p(219)][p(496)]=function(t){var e=p;try{var i=new f[e(851)](t[e(526)],t[e(852)]);this[e(473)](i)}catch(t){this[e(348)][e(740)][e(741)]()[e(742)](e(853)+t)}},a[p(219)][p(789)]=function(){var t=p;if(0!=this[t(760)]){for(var e=0,i=0;i<this[t(760)][t(582)][t(269)];i++)0==this[t(760)][t(582)][i][t(244)]&&e++;if(e+this[t(348)][t(356)][t(854)]>=this[t(760)][t(582)][t(269)])return 1}return 0},a[p(219)][p(572)]=function(t,e,i,n,s){this[p(855)](t,e,i,n,s)},a[p(219)][p(855)]=function(t,e,i,n,s){var r=p,t=t[r(564)];0<i&&t[r(533)]>=i&&this[r(781)](i)?(t[r(554)](i),t[r(533)]-=0<i?+i:0,e=new f[r(571)](t[r(526)],e,i,s,t[r(533)]),this[r(473)](e)):this[r(791)](t[r(523)])},a[p(219)][p(792)]=function(t,e,i,n,s){this[p(856)](t,e,i,n,s)},a[p(219)][p(856)]=function(t,e,i,n,s){var r=p,o=this[r(782)](e);if(0!=o&&(0<i&&this[r(781)](i)||n)){if(n){if(1==o[r(253)])return;t[r(556)](s)}else if(t[r(555)](i)<=0)return;this[r(857)](t,e,i,n,o)}},a[p(219)][p(857)]=function(t,e,i,n,s){var r,o=p,a=n,a=s[o(256)](1,t[o(482)],i,a),c=a*i;0<s[o(858)]&&(c=0),0<a?(t[o(533)]+=0<c?+c:0,this[o(786)](c,t),n||this[o(841)](t,c),r=new f[o(569)](t[o(526)],e,c,t[o(533)],t[o(535)],t[o(534)]),0<s[o(833)]&&this[o(631)](s[o(833)]),this[o(758)]&&(-1!=(a=this[o(788)](e))&&(this[o(760)][o(582)][a][o(244)]=0,this[o(760)][o(582)][a][o(245)]=-1),this[o(789)]())&&setTimeout(function(){this[o(790)]()}[o(415)](this),1e3),this[o(784)](e),t[o(552)](s[o(245)],i,c,1,1)):(t[o(552)](s[o(245)],i,0,1,0),r=new f[o(569)](t[o(526)],0,0,t[o(533)],t[o(535)],t[o(530)])),0!=r&&this[o(473)](r)},a[p(219)][p(790)]=function(){var t=p;this[t(758)]&&(this[t(774)](),this[t(758)]=0,this[t(760)]=0,clearTimeout(this[t(768)]))}},function(t,e,i){"use strict";var T=_0x2576,S=i(11),s=i(4);function n(t){var e=_0x2576;this[e(247)]=t,this[e(859)]=11,this[e(860)]=9,this[e(861)]=[1,2,3,4,5,7],this[e(862)]=[6,8,9,10,11,12],this[e(863)]=1280,this[e(864)]=720,this[e(865)]=200,this[e(866)]=300,this[e(867)]=600,this[e(868)]=150,this[e(869)]=1,this[e(870)]=2e5,this[e(871)]=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,30,31,32,33,34],this[e(872)]=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,24],this[e(873)]=[14,15,16,17,18,19],this[e(874)]=[21,22,25],this[e(875)]=[30,31,32,33,34],this[e(876)]=[0,1,2,3,4,5,6,24],this[e(877)]=[20,23],this[e(878)]=[18],this[e(879)]={TORNADO:1,UZUMAKI:2,STAR:3},this[e(880)]=this[e(879)][e(881)],this[e(882)]=0,this[e(883)]=4,this[e(884)]=0}(t[T(214)]=n)[T(219)][T(844)]=function(){var t=T;return this[t(869)]++,(this[t(869)]<0||this[t(869)]==t(250)||this[t(869)]>this[t(870)])&&(this[t(869)]=1),this[t(869)]},n[T(219)][T(885)]=function(t){for(var e=T,i=0;i<this[e(247)][e(348)][e(351)][e(756)][e(269)];i++)if(this[e(247)][e(348)][e(351)][e(756)][i][e(245)]==t)return this[e(247)][e(348)][e(351)][e(756)][i];return 0},n[T(219)][T(793)]=function(t,e){for(var i=T,n=[],s=new Date,r=0;r<t;r++){var o=s[i(778)](),a=e[Math[i(261)](Math[i(258)]()*e[i(269)])],c=0,h=0,l=0,l=6==(c=1==Math[i(261)](2*Math[i(258)]())?(h=-this[i(865)],this[i(861)][Math[i(261)](Math[i(258)]()*this[i(861)][i(269)])]):(h=this[i(863)]+this[i(865)],this[i(862)][Math[i(261)](Math[i(258)]()*this[i(862)][i(269)])]))||8<=c&&c<11?Math[i(261)](Math[i(258)]()*this[i(864)]/2)+this[i(864)]/2:12==c?this[i(864)]:Math[i(261)](Math[i(258)]()*(this[i(864)]-300-150+1))+150,u=-(Math[i(261)](Math[i(258)]()*(this[i(867)]-this[i(866)]+1))+this[i(866)]),d=this[i(844)](),_=this[i(885)](a),o=new S[i(886)](d,a,o,this[i(247)],_[i(846)]),p=0;_[i(220)](i(833))&&(p=_[i(833)]),n[i(328)]({FishID:d,FishKind:a,SpecialKind:0,PosX:h,PosY:l,PosZ:u,PathSeed:c,EffectID:p}),this[i(247)][i(582)][i(328)](o)}return n},n[T(219)][T(887)]=function(t,e){for(var i=T,n=(e=this[i(871)][Math[i(261)](Math[i(258)]()*this[i(871)][i(269)])],[]),s=new Date,r=0,r=1==Math[i(261)](2*Math[i(258)]())?-(Math[i(261)](Math[i(258)]()*(this[i(867)]-this[i(866)]+1))+this[i(866)]):this[i(863)]+(Math[i(261)](Math[i(258)]()*(this[i(867)]-this[i(866)]+1))+this[i(866)]),o=Math[i(261)](Math[i(258)]()*this[i(859)])+1,a=Math[i(261)](Math[i(258)]()*(this[i(864)]-300))+150,c=-(Math[i(261)](Math[i(258)]()*(this[i(867)]-this[i(866)]+1))+this[i(866)]),h=0;h<t;h++){var l=s[i(778)](),u=this[i(844)](),d=this[i(885)](e),l=new S[i(886)](u,e,l,this[i(247)],d[i(846)]);n[i(328)]({FishID:u,FishKind:e,SpecialKind:0,PosX:r,PosY:a,PosZ:c,PathSeed:o}),this[i(247)][i(582)][i(328)](l)}return n},n[T(219)][T(606)]=function(){var t=T;this[t(880)]++,this[t(880)]>Object[t(332)](this[t(879)])[t(269)]&&(this[t(880)]=this[t(879)][t(888)]),this[t(880)]===this[t(879)][t(888)]&&this[t(889)]()},n[T(219)][T(889)]=function(){for(var t=T,e=[2,15,13],i=0;i<e[t(269)];i++){var n=this[t(890)](e[i]),n=new s[t(606)](this[t(879)][t(888)],i,n);this[t(247)][t(473)](n)}},n[T(219)][T(890)]=function(t){for(var e=T,i=[],n=new Date,s=0;s<15;s++){var r=n[e(778)](),o=this[e(844)](),a=this[e(885)](t),r=new S[e(886)](o,t,r,this[e(247)],a[e(846)]);i[e(328)]({FishID:o,FishKind:t,SpecialKind:0}),this[e(247)][e(582)][e(328)](r)}return i},n[T(219)][T(620)]=function(){for(var t,e=T,i=[],n=new Date,s=0,r=this[e(876)][Math[e(261)](Math[e(258)]()*this[e(876)][e(269)])],o=6==(s=1==Math[e(261)](2*Math[e(258)]())?(t=-this[e(865)],this[e(861)][Math[e(261)](Math[e(258)]()*this[e(861)][e(269)])]):(t=this[e(863)]+this[e(865)],this[e(862)][Math[e(261)](Math[e(258)]()*this[e(862)][e(269)])]))||8<=s&&s<11?Math[e(261)](Math[e(258)]()*this[e(864)]/2)+this[e(864)]/2:Math[e(261)](Math[e(258)]()*this[e(864)]),a=-(Math[e(261)](Math[e(258)]()*(this[e(867)]-this[e(866)]+1))+this[e(866)]),c=0;c<5;c++){var h,l,u=this[e(844)](),d=n[e(778)](),_=0==c?(h=t,l=o,a):(h=(Math[e(258)]()<=.5?1:-1)*Math[e(261)](51*Math[e(258)]())+70+t,l=(Math[e(258)]()<=.5?1:-1)*Math[e(261)](51*Math[e(258)]())+70+o,(Math[e(258)]()<=.5?1:-1)*Math[e(261)](51*Math[e(258)]())+70+a),p=this[e(885)](r),d=new S[e(886)](u,r,d,this[e(247)],p[e(846)]);i[e(328)]({FishID:u,FishKind:r,SpecialKind:0,PosX:h,PosY:l,PosZ:_,PathSeed:s}),this[e(247)][e(582)][e(328)](d)}return i},n[T(219)][T(614)]=function(t,e,i,n,s){var r=T,o=this[r(844)](),a=(new Date)[r(778)](),o=new S[r(759)](o,e,a,this[r(247)],1);return o[r(259)](t,i,n,50,s),this[r(247)][r(582)][r(328)](o),o},n[T(219)][T(891)]=function(t){for(var e=T,i=[],n=+new Date,s=0;s<t;s++){var r=n,o={x:-(Math[e(261)](Math[e(258)]()*(this[e(867)]-this[e(866)]+1))+this[e(866)]),y:0,z:0},a=(1!=Math[e(261)](2*Math[e(258)]())&&(o.x=this[e(863)]+(Math[e(261)](Math[e(258)]()*(this[e(867)]-this[e(866)]+1))+this[e(866)])),this[e(860)]),c=(o.y=Math[e(261)](Math[e(258)]()*(this[e(864)]-300))+150,o.z=-Math[e(261)](Math[e(258)]()*this[e(868)]),this[e(844)]()),h=this[e(885)](1),r=new S[e(892)](c,1,r,this[e(247)],h[e(846)]);i[e(328)]({FishID:c,FishKind:1,SpecialKind:1,PosX:o.x,PosY:o.y,PosZ:o.z,PathSeed:a}),this[e(247)][e(582)][e(328)](r)}return i},n[T(219)][T(893)]=function(t){var e=T;if(0==t){(t={})[e(879)]=2,t[e(617)]=2,t[e(618)]=+new Date;for(var i=[],n=[15,10,1],s=[7,10,15],r=new Date,o=0;o<n[e(269)];o++)for(var a=0;a<s[o];a++){var c=r[e(778)](),h=this[e(844)](),l=n[o],u=this[e(885)](l),c=new S[e(886)](h,l,c,this[e(247)],u[e(846)],0,u[e(894)],0);i[e(328)]({FishID:h,FishKind:l,SpecialKind:0,ItemID:0}),this[e(247)][e(582)][e(328)](c)}t[e(582)]=i}return t},n[T(219)][T(626)]=function(t){var e=T;switch(this[e(880)]){case this[e(879)][e(881)]:this[e(247)][e(760)]=this[e(893)](this[e(247)][e(760)]);break;case this[e(879)][e(895)]:this[e(247)][e(760)]=this[e(896)](this[e(247)][e(760)])}1==t&&(this[e(880)]++,this[e(880)]>Object[e(332)](this[e(879)])[e(269)])&&(this[e(880)]=this[e(879)][e(881)]);t=this[e(247)][e(760)];return new s[e(626)](t[e(879)],t[e(617)],t[e(618)],t[e(582)])},n[T(219)][T(794)]=function(){var t=T,e=Math[t(261)](3*Math[t(258)]())+6;return this[t(793)](e,this[t(872)])},n[T(219)][T(795)]=function(){var t=T,e=Math[t(261)](4*Math[t(258)]())+1;return this[t(793)](e,this[t(873)])},n[T(219)][T(805)]=function(){var t=T;return this[t(793)](1,this[t(874)])},n[T(219)][T(806)]=function(){var t=T;return this[t(793)](1,this[t(875)])},n[T(219)][T(812)]=function(t){for(var e=T,i=[],n=new Date,s=Math[e(261)](Math[e(258)]()*(t[e(822)]-2))+2,r=t[e(824)],o=r[Math[e(261)](Math[e(258)]()*r[e(269)])],a=t[e(245)][Math[e(261)](Math[e(258)]()*t[e(245)][e(269)])],c=-1!=this[e(861)][e(712)](o)?-this[e(865)]-100:this[e(863)]+this[e(865)]+100,h=Math[e(261)](Math[e(258)]()*(t[e(826)]-t[e(825)]+1))+t[e(825)],l=-(Math[e(261)](Math[e(258)]()*(t[e(828)]-t[e(827)]+1))+t[e(827)]),u=0;u<s;u++){var d,_,p=this[e(844)](),f=n[e(778)](),g=(_=0==u?(d=c,h):(d=(Math[e(258)]()<=.5?1:-1)*Math[e(261)](101*Math[e(258)]())+100+c,(Math[e(258)]()<=.5?1:-1)*Math[e(261)](101*Math[e(258)]())+100+h),l),m=this[e(885)](a),f=new S[e(886)](p,a,f,this[e(247)],m[e(846)],0,m[e(894)],0);i[e(328)]({FishID:p,FishKind:a,SpecialKind:0,PosX:d,PosY:_,PosZ:g,PathSeed:o,ItemID:0}),this[e(247)][e(582)][e(328)](f)}return i},n[T(219)][T(897)]=function(t){for(var e=T,i=t[e(245)],n=t[e(824)],s=[],r=t[e(822)],o=new Date,a=0;a<r;a++){var c=o[e(778)](),h=i[Math[e(261)](Math[e(258)]()*i[e(269)])],l=n[Math[e(261)](Math[e(258)]()*n[e(269)])],u=0,u=1==Math[e(261)](2*Math[e(258)]())?-this[e(865)]:this[e(863)]+this[e(865)],d=Math[e(261)](Math[e(258)]()*(t[e(826)]-t[e(825)]+1))+t[e(825)],_=-(Math[e(261)](Math[e(258)]()*(t[e(828)]-t[e(827)]+1))+t[e(827)]),p=this[e(844)](),f=this[e(885)](h),g=this[e(877)][e(712)](h),m=0,y=0;0<f[e(251)]&&(y=f[e(251)]),-1==g?m=new S[e(886)](p,h,c,this[e(247)],f[e(846)],y,f[e(894)],0):(m=new S[e(877)](p,h,c,this[e(247)],f[e(846)],y,f[e(894)],0))[e(259)](f[e(833)]),s[e(328)]({FishID:p,FishKind:h,SpecialKind:0,PosX:u,PosY:d,PosZ:_,PathSeed:l,ItemID:y}),this[e(247)][e(582)][e(328)](m)}return s},n[T(219)][T(896)]=function(t){var e=T;if(0==t){(t={})[e(879)]=3,t[e(617)]=3,t[e(618)]=+new Date;for(var i=[],n=[3,18],s=[20,20],r=new Date,o=0;o<n[e(269)];o++)for(var a=0;a<s[o];a++){var c=r[e(778)](),h=this[e(844)](),l=n[o],u=this[e(885)](l),c=new S[e(886)](h,l,c,this[e(247)],u[e(846)],0,u[e(894)],0);i[e(328)]({FishID:h,FishKind:l,SpecialKind:0,ItemID:0}),this[e(247)][e(582)][e(328)](c)}t[e(582)]=i}return t},n[T(219)][T(898)]=function(){var t=T,e=Math[t(261)](3*Math[t(258)]())+6;return this[t(793)](e,this[t(877)])},n[T(219)][T(899)]=function(t,e){for(var i=T,n=[],s=new Date,r=0;r<t;r++){var o=s[i(778)](),a=e[Math[i(261)](Math[i(258)]()*e[i(269)])],c=0,h=0,l=0,l=6==(c=1==Math[i(261)](2*Math[i(258)]())?(h=-this[i(865)],this[i(861)][Math[i(261)](Math[i(258)]()*this[i(861)][i(269)])]):(h=this[i(863)]+this[i(865)],this[i(862)][Math[i(261)](Math[i(258)]()*this[i(862)][i(269)])]))||8<=c&&c<11?Math[i(261)](Math[i(258)]()*this[i(864)]/2)+this[i(864)]/2:12==c?this[i(864)]:Math[i(261)](Math[i(258)]()*(this[i(864)]-300-150+1))+150,u=-(Math[i(261)](Math[i(258)]()*(this[i(867)]-this[i(866)]+1))+this[i(866)]),d=this[i(844)](),_=this[i(885)](a),o=new S[i(886)](d,a,o,this[i(247)],_[i(846)]);n[i(328)]({FishID:d,FishKind:a,SpecialKind:0,PosX:h,PosY:l,PosZ:u,PathSeed:c,ItemID:0}),this[i(247)][i(582)][i(328)](o)}return n},n[T(219)][T(849)]=function(t,e){for(var i=T,n=[],s=this[i(885)](e),r=0;r<3;r++)n[i(328)]({PosX:0,PosY:0});var e=Math[i(261)](8*Math[i(258)]()),o=Math[i(261)](2*Math[i(258)]())%2==0?1:-1;switch(e){case 0:case 1:case 2:n[0][i(900)]=720+o*Math[i(261)](720*Math[i(258)]()),n[0][i(901)]=0-2*s[i(902)][i(864)],n[1][i(900)]=720+o*Math[i(261)](720*Math[i(258)]()),n[1][i(901)]=450+Math[i(261)](450*Math[i(258)]()),n[2][i(900)]=720-o*Math[i(261)](720*Math[i(258)]()),n[2][i(901)]=900+2*s[i(902)][i(864)];break;case 3:n[0][i(900)]=1440+2*s[i(902)][i(863)],n[0][i(901)]=450+o*Math[i(261)](450*Math[i(258)]()),n[1][i(900)]=720-Math[i(261)](720*Math[i(258)]()),n[1][i(901)]=450+o*Math[i(261)](450*Math[i(258)]()),n[2][i(900)]=0-2*s[i(902)][i(863)],n[2][i(901)]=450-o*Math[i(261)](450*Math[i(258)]());break;case 4:case 5:case 6:n[0][i(900)]=720+o*Math[i(261)](720*Math[i(258)]()),n[0][i(901)]=900+2*s[i(902)][i(864)],n[1][i(900)]=720+o*Math[i(261)](720*Math[i(258)]()),n[1][i(901)]=450+Math[i(261)](450*Math[i(258)]()),n[2][i(900)]=720-o*Math[i(261)](720*Math[i(258)]()),n[2][i(901)]=0-2*s[i(902)][i(864)];break;case 7:n[0][i(900)]=0-2*s[i(902)][i(863)],n[0][i(901)]=450+o*Math[i(261)](450*Math[i(258)]()),n[1][i(900)]=720-Math[i(261)](720*Math[i(258)]()),n[1][i(901)]=450+o*Math[i(261)](450*Math[i(258)]()),n[2][i(900)]=1440+2*s[i(902)][i(863)],n[2][i(901)]=450-o*Math[i(261)](450*Math[i(258)]())}return 2==t&&(n[1]=n[2]),n[i(903)]=e,n},n[T(219)][T(904)]=function(t,e){for(var i=T,n=[],s=this[i(885)](e),r=0;r<3;r++)n[i(328)]({PosX:0,PosY:0});var e=Math[i(261)](8*Math[i(258)]()),o=Math[i(261)](2*Math[i(258)]())%2==0?1:-1;switch(e){case 0:case 1:case 2:n[0][i(900)]=720+o*Math[i(261)](720*Math[i(258)]()),n[0][i(901)]=0-2*s[i(902)][i(864)],n[1][i(900)]=720+o*Math[i(261)](720*Math[i(258)]()),n[1][i(901)]=450+Math[i(261)](450*Math[i(258)]()),n[2][i(900)]=720-o*Math[i(261)](720*Math[i(258)]()),n[2][i(901)]=900+2*s[i(902)][i(864)];break;case 3:n[0][i(900)]=1440+2*s[i(902)][i(863)],n[0][i(901)]=450+o*Math[i(261)](450*Math[i(258)]()),n[1][i(900)]=720-Math[i(261)](720*Math[i(258)]()),n[1][i(901)]=450+o*Math[i(261)](450*Math[i(258)]()),n[2][i(900)]=0-2*s[i(902)][i(863)],n[2][i(901)]=450-o*Math[i(261)](450*Math[i(258)]());break;case 4:case 5:case 6:n[0][i(900)]=720+o*Math[i(261)](720*Math[i(258)]()),n[0][i(901)]=900+2*s[i(902)][i(864)],n[1][i(900)]=720+o*Math[i(261)](720*Math[i(258)]()),n[1][i(901)]=450+Math[i(261)](450*Math[i(258)]()),n[2][i(900)]=720-o*Math[i(261)](720*Math[i(258)]()),n[2][i(901)]=0-2*s[i(902)][i(864)];break;case 7:n[0][i(900)]=0-2*s[i(902)][i(863)],n[0][i(901)]=450+o*Math[i(261)](450*Math[i(258)]()),n[1][i(900)]=720-Math[i(261)](720*Math[i(258)]()),n[1][i(901)]=450+o*Math[i(261)](450*Math[i(258)]()),n[2][i(900)]=1440+2*s[i(902)][i(863)],n[2][i(901)]=450-o*Math[i(261)](450*Math[i(258)]())}return 2==t&&(n[1]=n[2]),{Position:n,ChairID:e}},n[T(219)][T(905)]=function(t){for(var e=T,i=[],t=this[e(885)](t),n=0;n<3;n++)i[e(328)]({PosX:0,PosY:0});return i[0][e(900)]=-t[e(902)][e(863)],i[0][e(901)]=450,i[1][e(900)]=900+2*t[e(902)][e(863)],i[1][e(901)]=450,i[2][e(900)]=900+2*t[e(902)][e(863)],i[2][e(901)]=450,i},n[T(219)][T(906)]=function(){for(var t=T,e=[0,2,4,1,3,5,19],i=[100,17,17,30,30,15,1],n=[],s=0;s<e[t(269)];s++)for(var r=e[s],o=+new Date,a=Math[t(261)](Math[t(258)]()*i[s]),c=this[t(885)](r),h=0;h<i[s];h++){var l=0,u=0,d=this[t(844)]();(l=h==a&&r<11?1:l)?(u=new S[t(892)](d,r,o,this[t(247)],c[t(846)],0,c[t(894)],l))[t(259)](this[t(907)](),this[t(908)]()):u=new S[t(886)](d,r,o,this[t(247)],c[t(846)],0,c[t(894)],l),this[t(247)][t(582)][t(328)](u),n[t(328)]({FishID:d,FishKind:r,IsRedFish:l})}return n},n[T(219)][T(909)]=function(){for(var t=T,e=[0,-1],i=[200,14],n=[],s=0;s<e[t(269)];s++)for(var r=+new Date,o=Math[t(261)](Math[t(258)]()*i[s]),a=0;a<i[s];a++){var c=e[s],h=(-1==c&&(c=11+a%7),this[t(885)](c)),l=0,u=0,d=this[t(844)]();(l=a==o&&c<11?0:l)?(u=new S[t(892)](d,c,r,this[t(247)],h[t(846)],0,h[t(894)],l))[t(259)](this[t(907)](),this[t(908)]()):u=new S[t(886)](d,c,r,this[t(247)],h[t(846)],0,h[t(894)],l),this[t(247)][t(582)][t(328)](u),n[t(328)]({FishID:d,FishKind:c,IsRedFish:l})}return n},n[T(219)][T(910)]=function(){for(var t=T,e=[0,2,3,15,0,1,4,17],i=[50,40,30,1,50,40,30,1],n=[],s=0;s<e[t(269)];s++)for(var r=+new Date,o=Math[t(261)](Math[t(258)]()*i[s]),a=e[s],c=this[t(885)](a),h=0;h<i[s];h++){var l=0,u=0,d=this[t(844)]();(l=h==o&&a<11?1:l)?(u=new S[t(892)](d,a,r,this[t(247)],c[t(846)],0,c[t(894)],l))[t(259)](this[t(907)](),this[t(908)]()):u=new S[t(886)](d,a,r,this[t(247)],c[t(846)],0,c[t(894)],l),this[t(247)][t(582)][t(328)](u),n[t(328)]({FishID:d,FishKind:a,IsRedFish:l})}return n},n[T(219)][T(911)]=function(){for(var t=T,e=[10,11,12,13,14,15,16,17],i=[8,8,8,8,8,8,8,8],n=[],s=0;s<e[t(269)];s++)for(var r=+new Date,o=Math[t(261)](Math[t(258)]()*i[s]),a=e[s],c=this[t(885)](a),h=0;h<i[s];h++){var l=0,u=0,d=this[t(844)]();(l=h==o&&a<11?1:l)?(u=new S[t(892)](d,a,r,this[t(247)],c[t(846)],0,c[t(894)],l))[t(259)](this[t(907)](),this[t(908)]()):u=new S[t(886)](d,a,r,this[t(247)],c[t(846)],0,c[t(894)],l),this[t(247)][t(582)][t(328)](u),n[t(328)]({FishID:d,FishKind:a,IsRedFish:l})}return n},n[T(219)][T(912)]=function(){for(var t=T,e=[0,1,2,2,3,6,5,5,19,19],i=[40,40,40,40,24,24,13,13,1,1],n=[],s=0;s<e[t(269)];s++)for(var r=+new Date,o=Math[t(261)](Math[t(258)]()*i[s]),a=e[s],c=this[t(885)](a),h=0;h<i[s];h++){var l=0,u=0,d=this[t(844)]();(l=h==o&&a<11?1:l)?(u=new S[t(892)](d,a,r,this[t(247)],c[t(846)],0,c[t(894)],l))[t(259)](this[t(907)](),this[t(908)]()):u=new S[t(886)](d,a,r,this[t(247)],c[t(846)],0,c[t(894)],l),this[t(247)][t(582)][t(328)](u),n[t(328)]({FishID:d,FishKind:a,IsRedFish:l})}return n},n[T(219)][T(800)]=function(){var t=T,e=[],i=this[t(884)],n=this[t(882)];switch(this[t(884)]){case 0:e=this[t(906)]();break;case 1:e=this[t(909)]();break;case 2:e=this[t(910)]();break;case 3:e=this[t(911)]();break;case 4:e=this[t(912)]()}return this[t(884)]++,4<this[t(884)]&&(this[t(884)]=0),this[t(882)]++,3<this[t(882)]&&(this[t(882)]=0),this[t(247)][t(760)]={},this[t(247)][t(760)][t(879)]=this[t(884)],this[t(247)][t(760)][t(882)]=this[t(882)],this[t(247)][t(760)][t(582)]=e,new s[t(913)](i,n,e)},n[T(219)][T(829)]=function(t){for(var e=T,i=t[e(245)],n=(t[e(824)],[]),s=t[e(822)],r=new Date,o=0;o<s;o++){var a=r[e(778)](),c=i[Math[e(261)](Math[e(258)]()*i[e(269)])],h=t[e(253)],l=this[e(844)](),u=this[e(885)](c),d=this[e(878)][e(712)](c),_=0,d=(h?(_=new S[e(892)](l,c,a,this[e(247)],u[e(846)],0,u[e(894)],h))[e(259)](this[e(907)](),this[e(908)]()):-1==d?_=new S[e(886)](l,c,a,this[e(247)],u[e(846)],0,u[e(894)],h):(_=new S[e(877)](l,c,a,this[e(247)],u[e(846)],0,u[e(894)],h))[e(259)](u[e(833)]),2),a=(1<c&&(d=3),this[e(849)](d,c));n[e(328)]({FishID:l,FishKind:c,IsRedFish:h,InitCount:d,Position:a,ItemID:0}),this[e(247)][e(582)][e(328)](_)}return n},n[T(219)][T(813)]=function(t){for(var e=T,i=[],n=new Date,s=Math[e(261)](Math[e(258)]()*(t[e(822)]-2))+2,r=t[e(245)][Math[e(261)](Math[e(258)]()*t[e(245)][e(269)])],o=2,a=(1<r&&(o=3),this[e(849)](o,r)),c=0;c<s;c++){var h=a,l=this[e(844)](),u=this[e(885)](r),d=n[e(778)]();switch(a[e(903)]){case 0:case 1:case 2:h[0][e(901)]=a[0][e(901)]-100*c;break;case 3:h[0][e(900)]=a[0][e(900)]+100*c;break;case 4:case 5:case 6:h[0][e(901)]=a[0][e(901)]+100*c;break;case 7:h[0][e(900)]=a[0][e(900)]-100*c}d=new S[e(886)](l,r,d,this[e(247)],u[e(846)],0,u[e(894)],0);i[e(328)]({FishID:l,FishKind:r,IsRedFish:0,InitCount:o,Position:h,ItemID:0}),this[e(247)][e(582)][e(328)](d)}return i},n[T(219)][T(907)]=function(){var t=T;return this[t(247)][t(348)][t(351)][t(914)]},n[T(219)][T(908)]=function(){var t=T;return this[t(247)][t(348)][t(351)][t(915)]}},function(t,e,i){"use strict";var a=_0x2576,n=i(5);function s(){var t=_0x2576;n[t(916)](this,Array[t(219)][t(338)][t(215)](arguments))}s[a(219)]=new n,(t[a(214)]=s)[a(219)][a(259)]=function(t,e){var i=a;this[i(914)]=t,this[i(915)]=e},s[a(219)][a(256)]=function(t,e,i,n,s){var r=a,o=Math[r(257)](1e4*Math[r(258)]()+1)/1e4;if(!n)if(1==this[r(915)]){if(o<=this[r(914)]*t)return s}else if(o<=1/s*t*this[r(914)])return s;return 0},s[a(219)][a(260)]=function(){var t=a;this[t(247)][t(784)](this[t(244)])}},function(t,e,i){"use strict";var o=_0x2576,n=i(5);function s(){var t=_0x2576;n[t(916)](this,Array[t(219)][t(338)][t(215)](arguments)),this[t(615)]=0,this[t(616)]=0,this[t(617)]=50,this[t(618)]=0}(t[o(214)]=s)[o(219)]=new n,s[o(219)][o(259)]=function(t,e,i,n,s){var r=o;this[r(244)]=t,this[r(615)]=e,this[r(616)]=i,this[r(617)]=n,this[r(618)]=s},s[o(219)][o(256)]=function(t,e,i,n){var s=o;return n||(this[s(616)]-=i,n=this[s(247)][s(807)](e),this[s(247)][s(348)][s(917)](n,n[s(526)],i,this[s(244)],this[s(247)])),0},s[o(219)][o(260)]=function(){}},function(t,e,i){"use strict";var n=_0x2576,s=i(5);function r(){var t=_0x2576;s[t(916)](this,Array[t(219)][t(338)][t(215)](arguments)),this[t(833)]=0}(t[n(214)]=r)[n(219)]=new s,r[n(219)][n(259)]=function(t){this[n(833)]=t},r[n(219)][n(835)]=function(){var t=n;this[t(247)][t(631)](this[t(833)])}},function(t,e,i){"use strict";var c=_0x2576,n=i(5);function s(){var t=_0x2576;n[t(916)](this,Array[t(219)][t(338)][t(215)](arguments)),this[t(918)]=0}(t[c(214)]=s)[c(219)]=new n,s[c(219)][c(259)]=function(t,e,i,n){var s=c;this[s(247)]=t,this[s(918)]=e,this[s(244)]=i,this[s(858)]=n},s[c(219)][c(835)]=function(){},s[c(219)][c(256)]=function(t,e,i,n){var s=c,r=Math[s(257)](1e4*Math[s(258)]()+1)/1e4,o=this[s(255)](),a=0;return!n&&(this[s(247)][s(348)][s(919)](this[s(858)],e,i),this[s(918)]<=0?0<o&&(a=1/o*t):a=this[s(918)],r<=a)?o:0},s[c(219)][c(255)]=function(){var t=c;return typeof this[t(252)]==t(250)||this[t(252)]<this[t(248)]?this[t(248)]:Math[t(261)](Math[t(258)]()*(this[t(252)]-this[t(248)]+1)+this[t(248)])}},function(t,e,i){"use strict";var u=_0x2576,d=i(12),o=i(4);function n(t,e){var i=_0x2576;this[i(348)]=t,this[i(247)]=e}(t[u(214)]=n)[u(219)][u(608)]=function(t){},n[u(219)][u(841)]=function(t,e){var i,n,s,r=u;d[r(268)](this[r(348)][r(838)])&&0<this[r(348)][r(838)][r(269)]&&0==(i=t[r(544)])[r(920)]&&(0<(s=((n=+new Date)-i[r(921)])/1e3-i[r(922)])&&(s=s*i[r(923)],i[r(924)]-=s,i[r(924)]<0)&&(i[r(924)]=0),i[r(921)]=n,i[r(925)](e),0!=(s=new o[r(926)](i.ID,i[r(924)],i[r(920)]))&&this[r(348)][r(400)](t[r(523)],s),i[r(920)])&&(i[r(924)]-=i[r(927)])},n[u(219)][u(928)]=function(t){var e=u,i=t[e(544)],i=(i[e(929)](this[e(930)](i.ID)),new o[e(926)](i.ID,0,!1));0!=i&&this[e(348)][e(400)](t[e(523)],i)},n[u(219)][u(930)]=function(t){var e=u,i=0,t=this[e(931)](t);return-1<t&&(++t>=this[e(348)][e(838)][e(269)]&&(t=0),i=this[e(348)][e(838)][t]),i},n[u(219)][u(837)]=function(t,e,i,n){var s=u,r=t[s(544)];d[s(268)](r)&&r[s(571)]()&&0!=(t=new o[s(932)](t[s(526)],e,i,n,r[s(933)],r.ID))&&this[s(247)][s(473)](t)},n[u(219)][u(839)]=function(t,e,i,n){var s=u,r=0;if(i!=t[s(544)].ID){if(i!=t[s(544)][s(934)]||-1==t[s(544)][s(934)])return;r=this[s(935)](t[s(544)][s(934)]),t[s(544)][s(934)]=-1}else r=t[s(544)];if(0!=r&&d[s(268)](r)&&e==r[s(933)]&&-1!=r[s(933)]){r[s(936)]();var o=n[s(269)];o>r[s(937)]&&(o=r[s(937)]);for(var a,c=0,h=0;h<o;h++)0!=(a=this[s(247)][s(782)](n[h]))&&(c+=a[s(254)]);var l=this[s(938)](r[s(939)],c);for(h=0;h<o;h++)this[s(247)][s(792)](t,n[h],l,1,i);4==r.ID&&(clearTimeout(r[s(940)]),r[s(941)]())}},n[u(219)][u(931)]=function(t){for(var e=u,i=-1,n=0;n<this[e(348)][e(838)][e(269)];n++)if(this[e(348)][e(838)][n].ID==t){i=n;break}return i},n[u(219)][u(938)]=function(t,e){t=(t=t<0?0:t)/(e=e<=0?1:e);return Math[u(261)](t)},n[u(219)][u(935)]=function(t){for(var e=u,i=0;i<this[e(348)][e(838)][e(269)];i++)if(this[e(348)][e(838)][i].ID==t)return this[e(348)][e(838)][i];return 0}}]),!function(t,e){"object"==typeof exports?module.exports=exports=e():"function"==typeof define&&define.amd?define([],e):t.CryptoJS=e()}(this,function(){a=Math,M=Object.create||function(t){return Rt.prototype=t,t=new Rt,Rt.prototype=null,t},f=(g={}).lib={},e=f.Base={extend:function(t){var e=M(this);return t&&e.mixIn(t),e.hasOwnProperty("init")&&this.init!==e.init||(e.init=function(){e.$super.init.apply(this,arguments)}),(e.init.prototype=e).$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},O=f.WordArray=e.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:4*t.length},toString:function(t){return(t||G).stringify(this)},concat:function(t){var e=this.words,i=t.words,n=this.sigBytes;if(t=t.sigBytes,this.clamp(),n%4)for(var s=0;s<t;s++)e[n+s>>>2]|=(i[s>>>2]>>>24-s%4*8&255)<<24-(n+s)%4*8;else for(s=0;s<t;s+=4)e[n+s>>>2]=i[s>>>2];return this.sigBytes+=t,this},clamp:function(){var t=this.words,e=this.sigBytes;t[e>>>2]&=4294967295<<32-e%4*8,t.length=a.ceil(e/4)},clone:function(){var t=e.clone.call(this);return t.words=this.words.slice(0),t},random:function(t){for(var e=[],i=0;i<t;i+=4){var n=function(t){var e=987654321;return function(){return((((e=36969*(65535&e)+(e>>16)&4294967295)<<16)+(t=18e3*(65535&t)+(t>>16)&4294967295)&4294967295)/4294967296+.5)*(.5<a.random()?1:-1)}}(4294967296*(s||a.random())),s=987654071*n();e.push(4294967296*n()|0)}return new O.init(e,t)}}),m=g.enc={},G=m.Hex={stringify:function(t){var e=t.words;t=t.sigBytes;for(var i=[],n=0;n<t;n++){var s=e[n>>>2]>>>24-n%4*8&255;i.push((s>>>4).toString(16)),i.push((15&s).toString(16))}return i.join("")},parse:function(t){for(var e=t.length,i=[],n=0;n<e;n+=2)i[n>>>3]|=parseInt(t.substr(n,2),16)<<24-n%8*4;return new O.init(i,e/2)}},k=m.Latin1={stringify:function(t){var e=t.words;t=t.sigBytes;for(var i=[],n=0;n<t;n++)i.push(String.fromCharCode(e[n>>>2]>>>24-n%4*8&255));return i.join("")},parse:function(t){for(var e=t.length,i=[],n=0;n<e;n++)i[n>>>2]|=(255&t.charCodeAt(n))<<24-n%4*8;return new O.init(i,e)}},V=m.Utf8={stringify:function(t){try{return decodeURIComponent(escape(k.stringify(t)))}catch(t){throw Error("Malformed UTF-8 data")}},parse:function(t){return k.parse(unescape(encodeURIComponent(t)))}},U=f.BufferedBlockAlgorithm=e.extend({reset:function(){this._data=new O.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=V.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(t){var e=this._data,i=e.words,n=e.sigBytes,s=this.blockSize,r=n/(4*s),r=t?a.ceil(r):a.max((0|r)-this._minBufferSize,0),n=a.min(4*(t=r*s),n);if(t){for(var o=0;o<t;o+=s)this._doProcessBlock(i,o);o=i.splice(0,t),e.sigBytes-=n}return new O.init(o,n)},clone:function(){var t=e.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0}),f.Hasher=U.extend({cfg:e.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){U.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(i){return function(t,e){return new i.init(e).finalize(t)}},_createHmacHelper:function(i){return function(t,e){return new W.HMAC.init(i,e).finalize(t)}}}),W=g.algo={};var a,M,e,O,G,k,V,U,W,J,z,X,l,H,Y,t,j,K,Q,Z,q,$,tt,et,it,nt,st,rt,ot,at,ct,ht,lt,i,ut,dt,_t,pt,ft,gt,mt,yt,s,Tt,n,r,St,Ct,Et,It,vt,bt,At,Ft,xt,Pt,o,c,h,u,d,_,p=g;function Rt(){}J=(m=p).lib.WordArray,m.enc.Base64={stringify:function(t){var e=t.words,i=t.sigBytes,n=this._map;t.clamp(),t=[];for(var s=0;s<i;s+=3)for(var r=(e[s>>>2]>>>24-s%4*8&255)<<16|(e[s+1>>>2]>>>24-(s+1)%4*8&255)<<8|e[s+2>>>2]>>>24-(s+2)%4*8&255,o=0;o<4&&s+.75*o<i;o++)t.push(n.charAt(r>>>6*(3-o)&63));if(e=n.charAt(64))for(;t.length%4;)t.push(e);return t.join("")},parse:function(t){var e=t.length,i=this._map;if(!(n=this._reverseMap))for(var n=this._reverseMap=[],s=0;s<i.length;s++)n[i.charCodeAt(s)]=s;(i=i.charAt(64))&&-1!==(i=t.indexOf(i))&&(e=i);for(var r,o,i=[],a=s=0;a<e;a++)a%4&&(r=n[t.charCodeAt(a-1)]<<a%4*2,o=n[t.charCodeAt(a)]>>>6-a%4*2,i[s>>>2]|=(r|o)<<24-s%4*8,s++);return J.create(i,s)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};var Lt=Math;function I(t,e,i,n,s,r,o){return((t=t+(e&i|~e&n)+s+o)<<r|t>>>32-r)+e}function v(t,e,i,n,s,r,o){return((t=t+(e&n|i&~n)+s+o)<<r|t>>>32-r)+e}function b(t,e,i,n,s,r,o){return((t=t+(e^i^n)+s+o)<<r|t>>>32-r)+e}function A(t,e,i,n,s,r,o){return((t=t+(i^(e|~n))+s+o)<<r|t>>>32-r)+e}for(var f=p,Bt=(g=f.lib).WordArray,Dt=g.Hasher,g=f.algo,F=[],wt=0;wt<64;wt++)F[wt]=4294967296*Lt.abs(Lt.sin(wt+1))|0;g=g.MD5=Dt.extend({_doReset:function(){this._hash=new Bt.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(t,e){for(var i=0;i<16;i++){var n=t[s=e+i];t[s]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8)}var i=this._hash.words,s=t[e+0],n=t[e+1],r=t[e+2],o=t[e+3],a=t[e+4],c=t[e+5],h=t[e+6],l=t[e+7],u=t[e+8],d=t[e+9],_=t[e+10],p=t[e+11],f=t[e+12],g=t[e+13],m=t[e+14],y=t[e+15],T=I(i[0],E=i[1],C=i[2],S=i[3],s,7,F[0]),S=I(S,T,E,C,n,12,F[1]),C=I(C,S,T,E,r,17,F[2]),E=I(E,C,S,T,o,22,F[3]),T=I(T,E,C,S,a,7,F[4]),S=I(S,T,E,C,c,12,F[5]),C=I(C,S,T,E,h,17,F[6]),E=I(E,C,S,T,l,22,F[7]),T=I(T,E,C,S,u,7,F[8]),S=I(S,T,E,C,d,12,F[9]),C=I(C,S,T,E,_,17,F[10]),E=I(E,C,S,T,p,22,F[11]),T=I(T,E,C,S,f,7,F[12]),S=I(S,T,E,C,g,12,F[13]),C=I(C,S,T,E,m,17,F[14]),T=v(T,E=I(E,C,S,T,y,22,F[15]),C,S,n,5,F[16]),S=v(S,T,E,C,h,9,F[17]),C=v(C,S,T,E,p,14,F[18]),E=v(E,C,S,T,s,20,F[19]),T=v(T,E,C,S,c,5,F[20]),S=v(S,T,E,C,_,9,F[21]),C=v(C,S,T,E,y,14,F[22]),E=v(E,C,S,T,a,20,F[23]),T=v(T,E,C,S,d,5,F[24]),S=v(S,T,E,C,m,9,F[25]),C=v(C,S,T,E,o,14,F[26]),E=v(E,C,S,T,u,20,F[27]),T=v(T,E,C,S,g,5,F[28]),S=v(S,T,E,C,r,9,F[29]),C=v(C,S,T,E,l,14,F[30]),T=b(T,E=v(E,C,S,T,f,20,F[31]),C,S,c,4,F[32]),S=b(S,T,E,C,u,11,F[33]),C=b(C,S,T,E,p,16,F[34]),E=b(E,C,S,T,m,23,F[35]),T=b(T,E,C,S,n,4,F[36]),S=b(S,T,E,C,a,11,F[37]),C=b(C,S,T,E,l,16,F[38]),E=b(E,C,S,T,_,23,F[39]),T=b(T,E,C,S,g,4,F[40]),S=b(S,T,E,C,s,11,F[41]),C=b(C,S,T,E,o,16,F[42]),E=b(E,C,S,T,h,23,F[43]),T=b(T,E,C,S,d,4,F[44]),S=b(S,T,E,C,f,11,F[45]),C=b(C,S,T,E,y,16,F[46]),T=A(T,E=b(E,C,S,T,r,23,F[47]),C,S,s,6,F[48]),S=A(S,T,E,C,l,10,F[49]),C=A(C,S,T,E,m,15,F[50]),E=A(E,C,S,T,c,21,F[51]),T=A(T,E,C,S,f,6,F[52]),S=A(S,T,E,C,o,10,F[53]),C=A(C,S,T,E,_,15,F[54]),E=A(E,C,S,T,n,21,F[55]),T=A(T,E,C,S,u,6,F[56]),S=A(S,T,E,C,y,10,F[57]),C=A(C,S,T,E,h,15,F[58]),E=A(E,C,S,T,g,21,F[59]),T=A(T,E,C,S,a,6,F[60]),S=A(S,T,E,C,p,10,F[61]),C=A(C,S,T,E,r,15,F[62]),E=A(E,C,S,T,d,21,F[63]);i[0]=i[0]+T|0,i[1]=i[1]+E|0,i[2]=i[2]+C|0,i[3]=i[3]+S|0},_doFinalize:function(){var t=this._data,e=t.words,i=8*this._nDataBytes,n=8*t.sigBytes,s=(e[n>>>5]|=128<<24-n%32,Lt.floor(i/4294967296));for(e[15+(64+n>>>9<<4)]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),e[14+(64+n>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),t.sigBytes=4*(e.length+1),this._process(),e=(t=this._hash).words,i=0;i<4;i++)n=e[i],e[i]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8);return t},clone:function(){var t=Dt.clone.call(this);return t._hash=this._hash.clone(),t}}),f.MD5=Dt._createHelper(g),f.HmacMD5=Dt._createHmacHelper(g),z=(f=(m=p).lib).WordArray,X=f.Hasher,l=[],f=m.algo.SHA1=X.extend({_doReset:function(){this._hash=new z.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(t,e){for(var i,n=this._hash.words,s=n[0],r=n[1],o=n[2],a=n[3],c=n[4],h=0;h<80;h++)l[h]=h<16?0|t[e+h]:(i=l[h-3]^l[h-8]^l[h-14]^l[h-16])<<1|i>>>31,i=(s<<5|s>>>27)+c+l[h],i=h<20?i+(1518500249+(r&o|~r&a)):h<40?i+(1859775393+(r^o^a)):h<60?i+((r&o|r&a|o&a)-1894007588):i+((r^o^a)-899497514),c=a,a=o,o=r<<30|r>>>2,r=s,s=i;n[0]=n[0]+s|0,n[1]=n[1]+r|0,n[2]=n[2]+o|0,n[3]=n[3]+a|0,n[4]=n[4]+c|0},_doFinalize:function(){var t=this._data,e=t.words,i=8*this._nDataBytes,n=8*t.sigBytes;return e[n>>>5]|=128<<24-n%32,e[14+(64+n>>>9<<4)]=Math.floor(i/4294967296),e[15+(64+n>>>9<<4)]=i,t.sigBytes=4*e.length,this._process(),this._hash},clone:function(){var t=X.clone.call(this);return t._hash=this._hash.clone(),t}}),m.SHA1=X._createHelper(f),m.HmacSHA1=X._createHmacHelper(f);var Nt=Math,g=p,Mt=(m=g.lib).WordArray,Ot=m.Hasher,m=g.algo,Gt=[],kt=[];function Vt(t){return 4294967296*(t-(0|t))|0}for(var Ut=2,Wt=0;Wt<64;)!function(t){for(var e=Nt.sqrt(t),i=2;i<=e;i++)if(!(t%i))return;return 1}(Ut)||(Wt<8&&(Gt[Wt]=Vt(Nt.pow(Ut,.5))),kt[Wt]=Vt(Nt.pow(Ut,1/3)),Wt++),Ut++;var Jt=[],m=m.SHA256=Ot.extend({_doReset:function(){this._hash=new Mt.init(Gt.slice(0))},_doProcessBlock:function(t,e){for(var i,n,s=this._hash.words,r=s[0],o=s[1],a=s[2],c=s[3],h=s[4],l=s[5],u=s[6],d=s[7],_=0;_<64;_++)Jt[_]=_<16?0|t[e+_]:(((i=Jt[_-15])<<25|i>>>7)^(i<<14|i>>>18)^i>>>3)+Jt[_-7]+(((n=Jt[_-2])<<15|n>>>17)^(n<<13|n>>>19)^n>>>10)+Jt[_-16],i=d+((h<<26|h>>>6)^(h<<21|h>>>11)^(h<<7|h>>>25))+(h&l^~h&u)+kt[_]+Jt[_],n=((r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22))+(r&o^r&a^o&a),d=u,u=l,l=h,h=c+i|0,c=a,a=o,o=r,r=i+n|0;s[0]=s[0]+r|0,s[1]=s[1]+o|0,s[2]=s[2]+a|0,s[3]=s[3]+c|0,s[4]=s[4]+h|0,s[5]=s[5]+l|0,s[6]=s[6]+u|0,s[7]=s[7]+d|0},_doFinalize:function(){var t=this._data,e=t.words,i=8*this._nDataBytes,n=8*t.sigBytes;return e[n>>>5]|=128<<24-n%32,e[14+(64+n>>>9<<4)]=Nt.floor(i/4294967296),e[15+(64+n>>>9<<4)]=i,t.sigBytes=4*e.length,this._process(),this._hash},clone:function(){var t=Ot.clone.call(this);return t._hash=this._hash.clone(),t}});function zt(t){return t<<8&4278255360|t>>>8&16711935}function Xt(t,e){return t<<e|t>>>32-e}g.SHA256=Ot._createHelper(m),g.HmacSHA256=Ot._createHmacHelper(m),H=(f=p).lib.WordArray,(f=f.enc).Utf16=f.Utf16BE={stringify:function(t){var e=t.words;t=t.sigBytes;for(var i=[],n=0;n<t;n+=2)i.push(String.fromCharCode(e[n>>>2]>>>16-n%4*8&65535));return i.join("")},parse:function(t){for(var e=t.length,i=[],n=0;n<e;n++)i[n>>>1]|=t.charCodeAt(n)<<16-n%2*16;return H.create(i,2*e)}},f.Utf16LE={stringify:function(t){var e=t.words;t=t.sigBytes;for(var i=[],n=0;n<t;n+=2){var s=zt(e[n>>>2]>>>16-n%4*8&65535);i.push(String.fromCharCode(s))}return i.join("")},parse:function(t){for(var e=t.length,i=[],n=0;n<e;n++)i[n>>>1]|=zt(t.charCodeAt(n)<<16-n%2*16);return H.create(i,2*e)}},"function"==typeof ArrayBuffer&&(g=p.lib.WordArray,Y=g.init,(g.init=function(t){if((t=(t=t instanceof ArrayBuffer?new Uint8Array(t):t)instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array||t instanceof Float64Array?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t)instanceof Uint8Array){for(var e=t.byteLength,i=[],n=0;n<e;n++)i[n>>>2]|=t[n]<<24-n%4*8;Y.call(this,i,e)}else Y.apply(this,arguments)}).prototype=g),m=Math,t=(f=(m=p).lib).WordArray,j=f.Hasher,f=m.algo,K=t.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),Q=t.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),Z=t.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),q=t.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),$=t.create([0,1518500249,1859775393,2400959708,2840853838]),tt=t.create([1352829926,1548603684,1836072691,2053994217,0]),f=f.RIPEMD160=j.extend({_doReset:function(){this._hash=t.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(t,e){for(var i=0;i<16;i++){var n=t[l=e+i];t[l]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8)}for(var s,r,o,a,c,h,l=this._hash.words,n=$.words,u=tt.words,d=K.words,_=Q.words,p=Z.words,f=q.words,g=s=l[0],m=r=l[1],y=o=l[2],T=a=l[3],S=c=l[4],i=0;i<80;i+=1)h=s+t[e+d[i]]|0,h=i<16?h+((r^o^a)+n[0]):i<32?h+((r&o|~r&a)+n[1]):i<48?h+(((r|~o)^a)+n[2]):i<64?h+((r&a|o&~a)+n[3]):h+((r^(o|~a))+n[4]),h=(h=Xt(h|=0,p[i]))+c|0,s=c,c=a,a=Xt(o,10),o=r,r=h,h=g+t[e+_[i]]|0,h=i<16?h+((m^(y|~T))+u[0]):i<32?h+((m&T|y&~T)+u[1]):i<48?h+(((m|~y)^T)+u[2]):i<64?h+((m&y|~m&T)+u[3]):h+((m^y^T)+u[4]),h=(h=Xt(h|=0,f[i]))+S|0,g=S,S=T,T=Xt(y,10),y=m,m=h;h=l[1]+o+T|0,l[1]=l[2]+a+S|0,l[2]=l[3]+c+g|0,l[3]=l[4]+s+m|0,l[4]=l[0]+r+y|0,l[0]=h},_doFinalize:function(){var t=this._data,e=t.words,i=8*this._nDataBytes,n=8*t.sigBytes;for(e[n>>>5]|=128<<24-n%32,e[14+(64+n>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),t.sigBytes=4*(e.length+1),this._process(),e=(t=this._hash).words,i=0;i<5;i++)n=e[i],e[i]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8);return t},clone:function(){var t=j.clone.call(this);return t._hash=this._hash.clone(),t}}),m.RIPEMD160=j._createHelper(f),m.HmacRIPEMD160=j._createHmacHelper(f),et=(g=p).enc.Utf8,g.algo.HMAC=g.lib.Base.extend({init:function(t,e){t=this._hasher=new t.init,"string"==typeof e&&(e=et.parse(e));var i=t.blockSize,n=4*i;(e=e.sigBytes>n?t.finalize(e):e).clamp();for(var t=this._oKey=e.clone(),e=this._iKey=e.clone(),s=t.words,r=e.words,o=0;o<i;o++)s[o]^=1549556828,r[o]^=909522486;t.sigBytes=e.sigBytes=n,this.reset()},reset:function(){var t=this._hasher;t.reset(),t.update(this._iKey)},update:function(t){return this._hasher.update(t),this},finalize:function(t){var e=this._hasher;return t=e.finalize(t),e.reset(),e.finalize(this._oKey.clone().concat(t))}}),f=(m=p).lib,g=f.Base,it=f.WordArray,nt=(f=m.algo).HMAC,st=f.PBKDF2=g.extend({cfg:g.extend({keySize:4,hasher:f.SHA1,iterations:1}),init:function(t){this.cfg=this.cfg.extend(t)},compute:function(t,e){for(var i=this.cfg,n=nt.create(i.hasher,t),s=it.create(),r=it.create([1]),o=s.words,a=r.words,c=i.keySize,i=i.iterations;o.length<c;){var h=n.update(e).finalize(r);n.reset();for(var l=h.words,u=l.length,d=h,_=1;_<i;_++){d=n.finalize(d),n.reset();for(var p=d.words,f=0;f<u;f++)l[f]^=p[f]}s.concat(h),a[0]++}return s.sigBytes=4*c,s}}),m.PBKDF2=function(t,e,i){return st.create(i).compute(t,e)},f=(g=p).lib,m=f.Base,rt=f.WordArray,ot=(f=g.algo).EvpKDF=m.extend({cfg:m.extend({keySize:4,hasher:f.MD5,iterations:1}),init:function(t){this.cfg=this.cfg.extend(t)},compute:function(t,e){for(var i=(o=this.cfg).hasher.create(),n=rt.create(),s=n.words,r=o.keySize,o=o.iterations;s.length<r;){a&&i.update(a);var a=i.update(t).finalize(e);i.reset();for(var c=1;c<o;c++)a=i.finalize(a),i.reset();n.concat(a)}return n.sigBytes=4*r,n}}),g.EvpKDF=function(t,e,i){return ot.create(i).compute(t,e)},at=(m=p).lib.WordArray,ct=(f=m.algo).SHA256,f=f.SHA224=ct.extend({_doReset:function(){this._hash=new at.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var t=ct._doFinalize.call(this);return t.sigBytes-=4,t}}),m.SHA224=ct._createHelper(f),m.HmacSHA224=ct._createHmacHelper(f),m=(g=p).lib,ht=m.Base,lt=m.WordArray,(g=g.x64={}).Word=ht.extend({init:function(t,e){this.high=t,this.low=e}}),g.WordArray=ht.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:8*t.length},toX32:function(){for(var t=this.words,e=t.length,i=[],n=0;n<e;n++){var s=t[n];i.push(s.high),i.push(s.low)}return lt.create(i,this.sigBytes)},clone:function(){for(var t=ht.clone.call(this),e=t.words=this.words.slice(0),i=e.length,n=0;n<i;n++)e[n]=e[n].clone();return t}});for(var Ht=Math,f=p,Yt=(m=f.lib).WordArray,jt=m.Hasher,Kt=f.x64.Word,m=f.algo,Qt=[],Zt=[],qt=[],y=1,T=0,S=0;S<24;S++){Qt[y+5*T]=(S+1)*(S+2)/2%64;var $t=(2*y+3*T)%5,y=T%5,T=$t}for(y=0;y<5;y++)for(T=0;T<5;T++)Zt[y+5*T]=T+(2*y+3*T)%5*5;for(y=1,T=0;T<24;T++){for(var te,ee=$t=S=0;ee<7;ee++)1&y&&((te=(1<<ee)-1)<32?$t^=1<<te:S^=1<<te-32),y=128&y?y<<1^113:y<<1;qt[T]=Kt.create(S,$t)}for(var C=[],ie=0;ie<25;ie++)C[ie]=Kt.create();function E(){return x.create.apply(x,arguments)}m=m.SHA3=jt.extend({cfg:jt.cfg.extend({outputLength:512}),_doReset:function(){for(var t=this._state=[],e=0;e<25;e++)t[e]=new Kt.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(t,e){for(var i=this._state,n=this.blockSize/2,s=0;s<n;s++){var r=16711935&((r=t[e+2*s])<<8|r>>>24)|4278255360&(r<<24|r>>>8),o=16711935&((o=t[e+2*s+1])<<8|o>>>24)|4278255360&(o<<24|o>>>8),a=i[s];a.high^=o,a.low^=r}for(n=0;n<24;n++){for(s=0;s<5;s++){for(var c=r=0,h=0;h<5;h++)r^=(a=i[s+5*h]).high,c^=a.low;(a=C[s]).high=r,a.low=c}for(s=0;s<5;s++)for(o=(r=C[(s+1)%5]).high,h=r.low,r=(a=C[(s+4)%5]).high^(o<<1|h>>>31),c=a.low^(h<<1|o>>>31),h=0;h<5;h++)(a=i[s+5*h]).high^=r,a.low^=c;for(o=1;o<25;o++)s=(a=i[o]).high,a=a.low,c=(h=Qt[o])<32?(r=s<<h|a>>>32-h,a<<h|s>>>32-h):(r=a<<h-32|s>>>64-h,s<<h-32|a>>>64-h),(a=C[Zt[o]]).high=r,a.low=c;for(s=i[0],(a=C[0]).high=s.high,a.low=s.low,s=0;s<5;s++)for(h=0;h<5;h++)(a=i[o=s+5*h]).high=(r=C[o]).high^~(o=C[(s+1)%5+5*h]).high&(c=C[(s+2)%5+5*h]).high,a.low=r.low^~o.low&c.low;(a=i[0]).high^=(s=qt[n]).high,a.low^=s.low}},_doFinalize:function(){var t=(n=this._data).words,e=8*n.sigBytes,i=32*this.blockSize;t[e>>>5]|=1<<24-e%32,t[(Ht.ceil((1+e)/i)*i>>>5)-1]|=128,n.sigBytes=4*t.length,this._process();for(var n=this._state,e=(t=this.cfg.outputLength/8)/8,i=[],s=0;s<e;s++){var r=(o=n[s]).high,o=o.low,r=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8);i.push(16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8)),i.push(r)}return new Yt.init(i,t)},clone:function(){for(var t=jt.clone.call(this),e=t._state=this._state.slice(0),i=0;i<25;i++)e[i]=e[i].clone();return t}}),f.SHA3=jt._createHelper(m),f.HmacSHA3=jt._createHmacHelper(m);for(var g=p,ne=g.lib.Hasher,x=(f=g.x64).Word,se=f.WordArray,f=g.algo,re=[E(1116352408,3609767458),E(1899447441,602891725),E(3049323471,3964484399),E(3921009573,2173295548),E(961987163,4081628472),E(1508970993,3053834265),E(2453635748,2937671579),E(2870763221,3664609560),E(3624381080,2734883394),E(310598401,1164996542),E(607225278,1323610764),E(1426881987,3590304994),E(1925078388,4068182383),E(2162078206,991336113),E(2614888103,633803317),E(3248222580,3479774868),E(3835390401,2666613458),E(4022224774,944711139),E(264347078,2341262773),E(604807628,2007800933),E(770255983,1495990901),E(1249150122,1856431235),E(1555081692,3175218132),E(1996064986,2198950837),E(2554220882,3999719339),E(2821834349,766784016),E(2952996808,2566594879),E(3210313671,3203337956),E(3336571891,1034457026),E(3584528711,2466948901),E(113926993,3758326383),E(338241895,168717936),E(666307205,1188179964),E(773529912,1546045734),E(1294757372,1522805485),E(1396182291,2643833823),E(1695183700,2343527390),E(1986661051,1014477480),E(2177026350,1206759142),E(2456956037,344077627),E(2730485921,1290863460),E(2820302411,3158454273),E(3259730800,3505952657),E(3345764771,106217008),E(3516065817,3606008344),E(3600352804,1432725776),E(4094571909,1467031594),E(275423344,851169720),E(430227734,3100823752),E(506948616,1363258195),E(659060556,3750685593),E(883997877,3785050280),E(958139571,3318307427),E(1322822218,3812723403),E(1537002063,2003034995),E(1747873779,3602036899),E(1955562222,1575990012),E(2024104815,1125592928),E(2227730452,2716904306),E(2361852424,442776044),E(2428436474,593698344),E(2756734187,3733110249),E(3204031479,2999351573),E(3329325298,3815920427),E(3391569614,3928383900),E(3515267271,566280711),E(3940187606,3454069534),E(4118630271,4000239992),E(116418474,1914138554),E(174292421,2731055270),E(289380356,3203993006),E(460393269,320620315),E(685471733,587496836),E(852142971,1086792851),E(1017036298,365543100),E(1126000580,2618297676),E(1288033470,3409855158),E(1501505948,4234509866),E(1607167915,987167468),E(1816402316,1246189591)],oe=[],ae=0;ae<80;ae++)oe[ae]=E();function ce(t,e,i){var n=this._iv;n?this._iv=void 0:n=this._prevBlock;for(var s=0;s<i;s++)t[e+s]^=n[s]}function he(t,e,i,n){var s=this._iv;for(s?(s=s.slice(0),this._iv=void 0):s=this._prevBlock,n.encryptBlock(s,0),n=0;n<i;n++)t[e+n]^=s[n]}f=f.SHA512=ne.extend({_doReset:function(){this._hash=new se.init([new x.init(1779033703,4089235720),new x.init(3144134277,2227873595),new x.init(1013904242,4271175723),new x.init(2773480762,1595750129),new x.init(1359893119,2917565137),new x.init(2600822924,725511199),new x.init(528734635,4215389547),new x.init(1541459225,327033209)])},_doProcessBlock:function(M,O){for(var t=(a=this._hash.words)[0],e=a[1],i=a[2],n=a[3],s=a[4],r=a[5],o=a[6],a=a[7],G=t.high,c=t.low,k=e.high,h=e.low,V=i.high,l=i.low,U=n.high,u=n.low,W=s.high,d=s.low,J=r.high,_=r.low,z=o.high,p=o.low,X=a.high,f=a.low,g=G,m=c,y=k,T=h,S=V,C=l,H=U,E=u,I=W,v=d,Y=J,b=_,j=z,A=p,K=X,Q=f,F=0;F<80;F++)var x,P=oe[F],Z=(F<16?(x=P.high=0|M[O+2*F],N=P.low=0|M[O+2*F+1]):(x=((N=(x=oe[F-15]).high)>>>1|(L=x.low)<<31)^(N>>>8|L<<24)^N>>>7,L=(L>>>1|N<<31)^(L>>>8|N<<24)^(L>>>7|N<<25),B=((N=(B=oe[F-2]).high)>>>19|(D=B.low)<<13)^(N<<3|D>>>29)^N>>>6,D=(D>>>19|N<<13)^(D<<3|N>>>29)^(D>>>6|N<<26),Z=(N=oe[F-7]).high,w=(R=oe[F-16]).high,R=R.low,x=(x=(x=x+Z+((N=L+N.low)>>>0<L>>>0?1:0))+B+((N=N+D)>>>0<D>>>0?1:0))+w+((N=N+R)>>>0<R>>>0?1:0),P.high=x,P.low=N),I&Y^~I&j),R=v&b^~v&A,P=g&y^g&S^y&S,L=(g>>>28|m<<4)^(g<<30|m>>>2)^(g<<25|m>>>7),B=(m>>>28|g<<4)^(m<<30|g>>>2)^(m<<25|g>>>7),D=re[F],q=D.high,$=D.low,w=(w=(w=(w=K+((I>>>14|v<<18)^(I>>>18|v<<14)^(I<<23|v>>>9))+((D=Q+((v>>>14|I<<18)^(v>>>18|I<<14)^(v<<23|I>>>9)))>>>0<Q>>>0?1:0))+Z+((D=D+R)>>>0<R>>>0?1:0))+q+((D=D+$)>>>0<$>>>0?1:0))+x+((D=D+N)>>>0<N>>>0?1:0),N=B+(m&T^m&C^T&C),K=j,Q=A,j=Y,A=b,Y=I,b=v,I=H+w+((v=E+D|0)>>>0<E>>>0?1:0)|0,H=S,E=C,S=y,C=T,y=g,T=m,g=w+(P=L+P+(N>>>0<B>>>0?1:0))+((m=D+N|0)>>>0<D>>>0?1:0)|0;c=t.low=c+m,t.high=G+g+(c>>>0<m>>>0?1:0),h=e.low=h+T,e.high=k+y+(h>>>0<T>>>0?1:0),l=i.low=l+C,i.high=V+S+(l>>>0<C>>>0?1:0),u=n.low=u+E,n.high=U+H+(u>>>0<E>>>0?1:0),d=s.low=d+v,s.high=W+I+(d>>>0<v>>>0?1:0),_=r.low=_+b,r.high=J+Y+(_>>>0<b>>>0?1:0),p=o.low=p+A,o.high=z+j+(p>>>0<A>>>0?1:0),f=a.low=f+Q,a.high=X+K+(f>>>0<Q>>>0?1:0)},_doFinalize:function(){var t=this._data,e=t.words,i=8*this._nDataBytes,n=8*t.sigBytes;return e[n>>>5]|=128<<24-n%32,e[30+(128+n>>>10<<5)]=Math.floor(i/4294967296),e[31+(128+n>>>10<<5)]=i,t.sigBytes=4*e.length,this._process(),this._hash.toX32()},clone:function(){var t=ne.clone.call(this);return t._hash=this._hash.clone(),t},blockSize:32}),g.SHA512=ne._createHelper(f),g.HmacSHA512=ne._createHmacHelper(f),i=(g=(m=p).x64).Word,ut=g.WordArray,dt=(g=m.algo).SHA512,g=g.SHA384=dt.extend({_doReset:function(){this._hash=new ut.init([new i.init(3418070365,3238371032),new i.init(1654270250,914150663),new i.init(2438529370,812702999),new i.init(355462360,4144912697),new i.init(1731405415,4290775857),new i.init(2394180231,1750603025),new i.init(3675008525,1694076839),new i.init(1203062813,3204075428)])},_doFinalize:function(){var t=dt._doFinalize.call(this);return t.sigBytes-=16,t}}),m.SHA384=dt._createHelper(g),m.HmacSHA384=dt._createHmacHelper(g),p.lib.Cipher||(m=(f=p).lib,g=m.Base,_t=m.WordArray,pt=m.BufferedBlockAlgorithm,ft=f.enc.Base64,gt=f.algo.EvpKDF,mt=m.Cipher=pt.extend({cfg:g.extend(),createEncryptor:function(t,e){return this.create(this._ENC_XFORM_MODE,t,e)},createDecryptor:function(t,e){return this.create(this._DEC_XFORM_MODE,t,e)},init:function(t,e,i){this.cfg=this.cfg.extend(i),this._xformMode=t,this._key=e,this.reset()},reset:function(){pt.reset.call(this),this._doReset()},process:function(t){return this._append(t),this._process()},finalize:function(t){return t&&this._append(t),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(n){return{encrypt:function(t,e,i){return("string"==typeof e?Tt:s).encrypt(n,t,e,i)},decrypt:function(t,e,i){return("string"==typeof e?Tt:s).decrypt(n,t,e,i)}}}}),m.StreamCipher=mt.extend({_doFinalize:function(){return this._process(!0)},blockSize:1}),r=f.mode={},n=m.BlockCipherMode=g.extend({createEncryptor:function(t,e){return this.Encryptor.create(t,e)},createDecryptor:function(t,e){return this.Decryptor.create(t,e)},init:function(t,e){this._cipher=t,this._iv=e}}),r=r.CBC=((n=n.extend()).Encryptor=n.extend({processBlock:function(t,e){var i=this._cipher,n=i.blockSize;ce.call(this,t,e,n),i.encryptBlock(t,e),this._prevBlock=t.slice(e,e+n)}}),n.Decryptor=n.extend({processBlock:function(t,e){var i=this._cipher,n=i.blockSize,s=t.slice(e,e+n);i.decryptBlock(t,e),ce.call(this,t,e,n),this._prevBlock=s}}),n),n=(f.pad={}).Pkcs7={pad:function(t,e){for(var i=4*e,n=(i=i-t.sigBytes%i)<<24|i<<16|i<<8|i,s=[],r=0;r<i;r+=4)s.push(n);i=_t.create(s,i),t.concat(i)},unpad:function(t){t.sigBytes-=255&t.words[t.sigBytes-1>>>2]}},m.BlockCipher=mt.extend({cfg:mt.cfg.extend({mode:r,padding:n}),reset:function(){mt.reset.call(this);var t,e=(i=this.cfg).iv,i=i.mode;this._xformMode==this._ENC_XFORM_MODE?t=i.createEncryptor:(t=i.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==t?this._mode.init(this,e&&e.words):(this._mode=t.call(i,this,e&&e.words),this._mode.__creator=t)},_doProcessBlock:function(t,e){this._mode.processBlock(t,e)},_doFinalize:function(){var t,e=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(e.pad(this._data,this.blockSize),t=this._process(!0)):(t=this._process(!0),e.unpad(t)),t},blockSize:4}),yt=m.CipherParams=g.extend({init:function(t){this.mixIn(t)},toString:function(t){return(t||this.formatter).stringify(this)}}),r=(f.format={}).OpenSSL={stringify:function(t){var e=t.ciphertext;return((t=t.salt)?_t.create([1398893684,1701076831]).concat(t).concat(e):e).toString(ft)},parse:function(t){var e,i=(t=ft.parse(t)).words;return 1398893684==i[0]&&1701076831==i[1]&&(e=_t.create(i.slice(2,4)),i.splice(0,4),t.sigBytes-=16),yt.create({ciphertext:t,salt:e})}},s=m.SerializableCipher=g.extend({cfg:g.extend({format:r}),encrypt:function(t,e,i,n){n=this.cfg.extend(n);var s=t.createEncryptor(i,n);return e=s.finalize(e),s=s.cfg,yt.create({ciphertext:e,key:i,iv:s.iv,algorithm:t,mode:s.mode,padding:s.padding,blockSize:t.blockSize,formatter:n.format})},decrypt:function(t,e,i,n){return n=this.cfg.extend(n),e=this._parse(e,n.format),t.createDecryptor(i,n).finalize(e.ciphertext)},_parse:function(t,e){return"string"==typeof t?e.parse(t,this):t}}),f=(f.kdf={}).OpenSSL={execute:function(t,e,i,n){return n=n||_t.random(8),t=gt.create({keySize:e+i}).compute(t,n),i=_t.create(t.words.slice(e),4*i),t.sigBytes=4*e,yt.create({key:t,iv:i,salt:n})}},Tt=m.PasswordBasedCipher=s.extend({cfg:s.cfg.extend({kdf:f}),encrypt:function(t,e,i,n){return i=(n=this.cfg.extend(n)).kdf.execute(i,t.keySize,t.ivSize),n.iv=i.iv,(t=s.encrypt.call(this,t,e,i.key,n)).mixIn(i),t},decrypt:function(t,e,i,n){return n=this.cfg.extend(n),e=this._parse(e,n.format),i=n.kdf.execute(i,t.keySize,t.ivSize,e.salt),n.iv=i.iv,s.decrypt.call(this,t,e,i.key,n)}})),p.mode.CFB=((n=p.lib.BlockCipherMode.extend()).Encryptor=n.extend({processBlock:function(t,e){var i=this._cipher,n=i.blockSize;he.call(this,t,e,n,i),this._prevBlock=t.slice(e,e+n)}}),n.Decryptor=n.extend({processBlock:function(t,e){var i=this._cipher,n=i.blockSize,s=t.slice(e,e+n);he.call(this,t,e,n,i),this._prevBlock=s}}),n),p.mode.ECB=((g=p.lib.BlockCipherMode.extend()).Encryptor=g.extend({processBlock:function(t,e){this._cipher.encryptBlock(t,e)}}),g.Decryptor=g.extend({processBlock:function(t,e){this._cipher.decryptBlock(t,e)}}),g),p.pad.AnsiX923={pad:function(t,e){var e=4*e,i=(i=t.sigBytes)+(e=e-i%e)-1;t.clamp(),t.words[i>>>2]|=e<<24-i%4*8,t.sigBytes+=e},unpad:function(t){t.sigBytes-=255&t.words[t.sigBytes-1>>>2]}},p.pad.Iso10126={pad:function(t,e){e=(e=4*e)-t.sigBytes%e;t.concat(p.lib.WordArray.random(e-1)).concat(p.lib.WordArray.create([e<<24],1))},unpad:function(t){t.sigBytes-=255&t.words[t.sigBytes-1>>>2]}},p.pad.Iso97971={pad:function(t,e){t.concat(p.lib.WordArray.create([2147483648],1)),p.pad.ZeroPadding.pad(t,e)},unpad:function(t){p.pad.ZeroPadding.unpad(t),t.sigBytes--}},p.mode.OFB=(r=p.lib.BlockCipherMode.extend(),m=r.Encryptor=r.extend({processBlock:function(t,e){var i=this._cipher,n=i.blockSize,s=this._iv,r=this._keystream;for(s&&(r=this._keystream=s.slice(0),this._iv=void 0),i.encryptBlock(r,0),i=0;i<n;i++)t[e+i]^=r[i]}}),r.Decryptor=m,r),p.pad.NoPadding={pad:function(){},unpad:function(){}},St=(f=p).lib.CipherParams,Ct=f.enc.Hex,f.format.Hex={stringify:function(t){return t.ciphertext.toString(Ct)},parse:function(t){return t=Ct.parse(t),St.create({ciphertext:t})}};for(var g=p,m=g.lib.BlockCipher,f=g.algo,P=[],le=[],ue=[],de=[],_e=[],pe=[],fe=[],ge=[],me=[],ye=[],R=[],L=0;L<256;L++)R[L]=L<128?L<<1:L<<1^283;for(var B=0,D=0,L=0;L<256;L++){var w=D^D<<1^D<<2^D<<3^D<<4,Te=R[le[P[B]=w=w>>>8^255&w^99]=B],Se=R[Te],Ce=R[Se],N=257*R[w]^16843008*w;ue[B]=N<<24|N>>>8,de[B]=N<<16|N>>>16,_e[B]=N<<8|N>>>24,pe[B]=N,fe[w]=(N=16843009*Ce^65537*Se^257*Te^16843008*B)<<24|N>>>8,ge[w]=N<<16|N>>>16,me[w]=N<<8|N>>>24,ye[w]=N,B?(B=Te^R[R[R[Ce^Te]]],D^=R[R[D]]):B=D=1}var Ee=[0,1,2,4,8,16,32,64,128,27,54],f=f.AES=m.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var t,e=(n=this._keyPriorReset=this._key).words,i=n.sigBytes/4,n=4*((this._nRounds=i+6)+1),s=this._keySchedule=[],r=0;r<n;r++)r<i?s[r]=e[r]:(t=s[r-1],r%i?6<i&&4==r%i&&(t=P[t>>>24]<<24|P[t>>>16&255]<<16|P[t>>>8&255]<<8|P[255&t]):(t=P[(t=t<<8|t>>>24)>>>24]<<24|P[t>>>16&255]<<16|P[t>>>8&255]<<8|P[255&t],t^=Ee[r/i|0]<<24),s[r]=s[r-i]^t);for(e=this._invKeySchedule=[],i=0;i<n;i++)r=n-i,t=i%4?s[r]:s[r-4],e[i]=i<4||r<=4?t:fe[P[t>>>24]]^ge[P[t>>>16&255]]^me[P[t>>>8&255]]^ye[P[255&t]]}},encryptBlock:function(t,e){this._doCryptBlock(t,e,this._keySchedule,ue,de,_e,pe,P)},decryptBlock:function(t,e){var i=t[e+1];t[e+1]=t[e+3],t[e+3]=i,this._doCryptBlock(t,e,this._invKeySchedule,fe,ge,me,ye,le),i=t[e+1],t[e+1]=t[e+3],t[e+3]=i},_doCryptBlock:function(t,e,i,n,s,r,o,a){for(var c=this._nRounds,h=t[e]^i[0],l=t[e+1]^i[1],u=t[e+2]^i[2],d=t[e+3]^i[3],_=4,p=1;p<c;p++)var f=n[h>>>24]^s[l>>>16&255]^r[u>>>8&255]^o[255&d]^i[_++],g=n[l>>>24]^s[u>>>16&255]^r[d>>>8&255]^o[255&h]^i[_++],m=n[u>>>24]^s[d>>>16&255]^r[h>>>8&255]^o[255&l]^i[_++],d=n[d>>>24]^s[h>>>16&255]^r[l>>>8&255]^o[255&u]^i[_++],h=f,l=g,u=m;f=(a[h>>>24]<<24|a[l>>>16&255]<<16|a[u>>>8&255]<<8|a[255&d])^i[_++],g=(a[l>>>24]<<24|a[u>>>16&255]<<16|a[d>>>8&255]<<8|a[255&h])^i[_++],m=(a[u>>>24]<<24|a[d>>>16&255]<<16|a[h>>>8&255]<<8|a[255&l])^i[_++],d=(a[d>>>24]<<24|a[h>>>16&255]<<16|a[l>>>8&255]<<8|a[255&u])^i[_++],t[e]=f,t[e+1]=g,t[e+2]=m,t[e+3]=d},keySize:8});function Ie(t,e){e=(this._lBlock>>>t^this._rBlock)&e;this._rBlock^=e,this._lBlock^=e<<t}function ve(t,e){e=(this._rBlock>>>t^this._lBlock)&e;this._lBlock^=e,this._rBlock^=e<<t}function be(){for(var t=this._S,e=this._i,i=this._j,n=0,s=0;s<4;s++){var i=(i+t[e=(e+1)%256])%256,r=t[e];t[e]=t[i],t[i]=r,n|=t[(t[e]+t[i])%256]<<24-8*s}return this._i=e,this._j=i,n}function Ae(t){var e,i,n;return 255==(t>>24&255)?(i=t>>8&255,n=255&t,255===(e=t>>16&255)?(e=0,255===i?(i=0,255===n?n=0:++n):++i):++e,t=(e<<16)+(i<<8),t+=n):t+=16777216,t}function Fe(){for(var t=this._X,e=this._C,i=0;i<8;i++)c[i]=e[i];for(e[0]=e[0]+1295307597+this._b|0,e[1]=e[1]+3545052371+(e[0]>>>0<c[0]>>>0?1:0)|0,e[2]=e[2]+886263092+(e[1]>>>0<c[1]>>>0?1:0)|0,e[3]=e[3]+1295307597+(e[2]>>>0<c[2]>>>0?1:0)|0,e[4]=e[4]+3545052371+(e[3]>>>0<c[3]>>>0?1:0)|0,e[5]=e[5]+886263092+(e[4]>>>0<c[4]>>>0?1:0)|0,e[6]=e[6]+1295307597+(e[5]>>>0<c[5]>>>0?1:0)|0,e[7]=e[7]+3545052371+(e[6]>>>0<c[6]>>>0?1:0)|0,this._b=e[7]>>>0<c[7]>>>0?1:0,i=0;i<8;i++){var n=t[i]+e[i],s=65535&n,r=n>>>16;h[i]=((s*s>>>17)+s*r>>>15)+r*r^((4294901760&n)*n|0)+((65535&n)*n|0)}t[0]=h[0]+(h[7]<<16|h[7]>>>16)+(h[6]<<16|h[6]>>>16)|0,t[1]=h[1]+(h[0]<<8|h[0]>>>24)+h[7]|0,t[2]=h[2]+(h[1]<<16|h[1]>>>16)+(h[0]<<16|h[0]>>>16)|0,t[3]=h[3]+(h[2]<<8|h[2]>>>24)+h[1]|0,t[4]=h[4]+(h[3]<<16|h[3]>>>16)+(h[2]<<16|h[2]>>>16)|0,t[5]=h[5]+(h[4]<<8|h[4]>>>24)+h[3]|0,t[6]=h[6]+(h[5]<<16|h[5]>>>16)+(h[4]<<16|h[4]>>>16)|0,t[7]=h[7]+(h[6]<<8|h[6]>>>24)+h[5]|0}function xe(){for(var t=this._X,e=this._C,i=0;i<8;i++)d[i]=e[i];for(e[0]=e[0]+1295307597+this._b|0,e[1]=e[1]+3545052371+(e[0]>>>0<d[0]>>>0?1:0)|0,e[2]=e[2]+886263092+(e[1]>>>0<d[1]>>>0?1:0)|0,e[3]=e[3]+1295307597+(e[2]>>>0<d[2]>>>0?1:0)|0,e[4]=e[4]+3545052371+(e[3]>>>0<d[3]>>>0?1:0)|0,e[5]=e[5]+886263092+(e[4]>>>0<d[4]>>>0?1:0)|0,e[6]=e[6]+1295307597+(e[5]>>>0<d[5]>>>0?1:0)|0,e[7]=e[7]+3545052371+(e[6]>>>0<d[6]>>>0?1:0)|0,this._b=e[7]>>>0<d[7]>>>0?1:0,i=0;i<8;i++){var n=t[i]+e[i],s=65535&n,r=n>>>16;_[i]=((s*s>>>17)+s*r>>>15)+r*r^((4294901760&n)*n|0)+((65535&n)*n|0)}t[0]=_[0]+(_[7]<<16|_[7]>>>16)+(_[6]<<16|_[6]>>>16)|0,t[1]=_[1]+(_[0]<<8|_[0]>>>24)+_[7]|0,t[2]=_[2]+(_[1]<<16|_[1]>>>16)+(_[0]<<16|_[0]>>>16)|0,t[3]=_[3]+(_[2]<<8|_[2]>>>24)+_[1]|0,t[4]=_[4]+(_[3]<<16|_[3]>>>16)+(_[2]<<16|_[2]>>>16)|0,t[5]=_[5]+(_[4]<<8|_[4]>>>24)+_[3]|0,t[6]=_[6]+(_[5]<<16|_[5]>>>16)+(_[4]<<16|_[4]>>>16)|0,t[7]=_[7]+(_[6]<<8|_[6]>>>24)+_[5]|0}return g.AES=m._createHelper(f),Et=(m=(g=p).lib).WordArray,m=m.BlockCipher,f=g.algo,It=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],vt=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],bt=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],At=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],Ft=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],xt=f.DES=m.extend({_doReset:function(){for(var t=this._key.words,e=[],i=0;i<56;i++){var n=It[i]-1;e[i]=t[n>>>5]>>>31-n%32&1}for(t=this._subKeys=[],n=0;n<16;n++){for(var s=t[n]=[],r=bt[n],i=0;i<24;i++)s[i/6|0]|=e[(vt[i]-1+r)%28]<<31-i%6,s[4+(i/6|0)]|=e[28+(vt[i+24]-1+r)%28]<<31-i%6;for(s[0]=s[0]<<1|s[0]>>>31,i=1;i<7;i++)s[i]>>>=4*(i-1)+3;s[7]=s[7]<<5|s[7]>>>27}for(e=this._invSubKeys=[],i=0;i<16;i++)e[i]=t[15-i]},encryptBlock:function(t,e){this._doCryptBlock(t,e,this._subKeys)},decryptBlock:function(t,e){this._doCryptBlock(t,e,this._invSubKeys)},_doCryptBlock:function(t,e,i){this._lBlock=t[e],this._rBlock=t[e+1],Ie.call(this,4,252645135),Ie.call(this,16,65535),ve.call(this,2,858993459),ve.call(this,8,16711935),Ie.call(this,1,1431655765);for(var n=0;n<16;n++){for(var s=i[n],r=this._lBlock,o=this._rBlock,a=0,c=0;c<8;c++)a|=At[c][((o^s[c])&Ft[c])>>>0];this._lBlock=o,this._rBlock=r^a}i=this._lBlock,this._lBlock=this._rBlock,this._rBlock=i,Ie.call(this,1,1431655765),ve.call(this,8,16711935),ve.call(this,2,858993459),Ie.call(this,16,65535),Ie.call(this,4,252645135),t[e]=this._lBlock,t[e+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2}),g.DES=m._createHelper(xt),f=f.TripleDES=m.extend({_doReset:function(){var t=this._key.words;this._des1=xt.createEncryptor(Et.create(t.slice(0,2))),this._des2=xt.createEncryptor(Et.create(t.slice(2,4))),this._des3=xt.createEncryptor(Et.create(t.slice(4,6)))},encryptBlock:function(t,e){this._des1.encryptBlock(t,e),this._des2.decryptBlock(t,e),this._des3.encryptBlock(t,e)},decryptBlock:function(t,e){this._des3.decryptBlock(t,e),this._des2.encryptBlock(t,e),this._des1.decryptBlock(t,e)},keySize:6,ivSize:2,blockSize:2}),g.TripleDES=m._createHelper(f),m=(g=p).lib.StreamCipher,f=g.algo,Pt=f.RC4=m.extend({_doReset:function(){for(var t=(e=this._key).words,e=e.sigBytes,i=this._S=[],n=0;n<256;n++)i[n]=n;for(var s=n=0;n<256;n++){var s=(s+i[n]+(t[(r=n%e)>>>2]>>>24-r%4*8&255))%256,r=i[n];i[n]=i[s],i[s]=r}this._i=this._j=0},_doProcessBlock:function(t,e){t[e]^=be.call(this)},keySize:8,ivSize:0}),g.RC4=m._createHelper(Pt),f=f.RC4Drop=Pt.extend({cfg:Pt.cfg.extend({drop:192}),_doReset:function(){Pt._doReset.call(this);for(var t=this.cfg.drop;0<t;t--)be.call(this)}}),g.RC4Drop=m._createHelper(f),p.mode.CTRGladman=(g=p.lib.BlockCipherMode.extend(),m=g.Encryptor=g.extend({processBlock:function(t,e){var i=this._cipher,n=i.blockSize,s=this._iv,r=this._counter;for(s&&(r=this._counter=s.slice(0),this._iv=void 0),0===((s=r)[0]=Ae(s[0]))&&(s[1]=Ae(s[1])),r=r.slice(0),i.encryptBlock(r,0),i=0;i<n;i++)t[e+i]^=r[i]}}),g.Decryptor=m,g),m=(f=p).lib.StreamCipher,o=[],c=[],h=[],g=f.algo.Rabbit=m.extend({_doReset:function(){for(var t=this._key.words,e=this.cfg.iv,i=0;i<4;i++)t[i]=16711935&(t[i]<<8|t[i]>>>24)|4278255360&(t[i]<<24|t[i]>>>8);for(var n=this._X=[t[0],t[3]<<16|t[2]>>>16,t[1],t[0]<<16|t[3]>>>16,t[2],t[1]<<16|t[0]>>>16,t[3],t[2]<<16|t[1]>>>16],t=this._C=[t[2]<<16|t[2]>>>16,4294901760&t[0]|65535&t[1],t[3]<<16|t[3]>>>16,4294901760&t[1]|65535&t[2],t[0]<<16|t[0]>>>16,4294901760&t[2]|65535&t[3],t[1]<<16|t[1]>>>16,4294901760&t[3]|65535&t[0]],i=this._b=0;i<4;i++)Fe.call(this);for(i=0;i<8;i++)t[i]^=n[i+4&7];if(e){var n=(e=16711935&((e=(i=e.words)[0])<<8|e>>>24)|4278255360&(e<<24|e>>>8))>>>16|4294901760&(i=16711935&((i=i[1])<<8|i>>>24)|4278255360&(i<<24|i>>>8)),s=i<<16|65535&e;for(t[0]^=e,t[1]^=n,t[2]^=i,t[3]^=s,t[4]^=e,t[5]^=n,t[6]^=i,t[7]^=s,i=0;i<4;i++)Fe.call(this)}},_doProcessBlock:function(t,e){var i=this._X;for(Fe.call(this),o[0]=i[0]^i[5]>>>16^i[3]<<16,o[1]=i[2]^i[7]>>>16^i[5]<<16,o[2]=i[4]^i[1]>>>16^i[7]<<16,o[3]=i[6]^i[3]>>>16^i[1]<<16,i=0;i<4;i++)o[i]=16711935&(o[i]<<8|o[i]>>>24)|4278255360&(o[i]<<24|o[i]>>>8),t[e+i]^=o[i]},blockSize:4,ivSize:2}),f.Rabbit=m._createHelper(g),p.mode.CTR=(f=p.lib.BlockCipherMode.extend(),m=f.Encryptor=f.extend({processBlock:function(t,e){var i=this._cipher,n=i.blockSize,s=this._iv,r=this._counter;for(s&&(r=this._counter=s.slice(0),this._iv=void 0),s=r.slice(0),i.encryptBlock(s,0),r[n-1]=r[n-1]+1|0,i=0;i<n;i++)t[e+i]^=s[i]}}),f.Decryptor=m,f),m=(g=p).lib.StreamCipher,u=[],d=[],_=[],f=g.algo.RabbitLegacy=m.extend({_doReset:function(){for(var t=this._key.words,e=this.cfg.iv,i=this._X=[t[0],t[3]<<16|t[2]>>>16,t[1],t[0]<<16|t[3]>>>16,t[2],t[1]<<16|t[0]>>>16,t[3],t[2]<<16|t[1]>>>16],t=this._C=[t[2]<<16|t[2]>>>16,4294901760&t[0]|65535&t[1],t[3]<<16|t[3]>>>16,4294901760&t[1]|65535&t[2],t[0]<<16|t[0]>>>16,4294901760&t[2]|65535&t[3],t[1]<<16|t[1]>>>16,4294901760&t[3]|65535&t[0]],n=this._b=0;n<4;n++)xe.call(this);for(n=0;n<8;n++)t[n]^=i[n+4&7];if(e){var n=(e=16711935&((e=(i=e.words)[0])<<8|e>>>24)|4278255360&(e<<24|e>>>8))>>>16|4294901760&(i=16711935&((i=i[1])<<8|i>>>24)|4278255360&(i<<24|i>>>8)),s=i<<16|65535&e;for(t[0]^=e,t[1]^=n,t[2]^=i,t[3]^=s,t[4]^=e,t[5]^=n,t[6]^=i,t[7]^=s,n=0;n<4;n++)xe.call(this)}},_doProcessBlock:function(t,e){var i=this._X;for(xe.call(this),u[0]=i[0]^i[5]>>>16^i[3]<<16,u[1]=i[2]^i[7]>>>16^i[5]<<16,u[2]=i[4]^i[1]>>>16^i[7]<<16,u[3]=i[6]^i[3]>>>16^i[1]<<16,i=0;i<4;i++)u[i]=16711935&(u[i]<<8|u[i]>>>24)|4278255360&(u[i]<<24|u[i]>>>8),t[e+i]^=u[i]},blockSize:4,ivSize:2}),g.RabbitLegacy=m._createHelper(f),p.pad.ZeroPadding={pad:function(t,e){e*=4;t.clamp(),t.sigBytes+=e-(t.sigBytes%e||e)},unpad:function(t){for(var e=t.words,i=t.sigBytes-1;!(e[i>>>2]>>>24-i%4*8&255);)i--;t.sigBytes=i+1}},p});var ResourceManager={ResourceLoadingGame:{MenuBackground:"res/BanCa/MenuGame/SplashScreen/IMG_SPLASHSCREN.png",MenuBackground1:"res/BanCa/MenuGame/BackGround/MenuBackground1.png",MenuBackground2:"res/BanCa/MenuGame/BackGround/MenuBackground2.png",BackgroundMainmenu:"res/BanCa/MenuGame/BackGround/Background_MainMenu.png",CCSUIUpdateLoadingLayer:"res/BanCa/UIUpdateLoading.json"},JFResourcesMenuGame:{AtlasButtonMenuGame_plist:"res/BanCa/MenuGame/Buttons/AtlasButtonMenuGame.plist",AtlasButtonMenuGame:"res/BanCa/MenuGame/Buttons/AtlasButtonMenuGame.png",AtlasButtonMenuGame_loginRegis_plist:"res/BanCa/MenuGame/Buttons/AtlasButtonMenuGame_loginRegis.plist",AtlasButtonMenuGame_loginRegis_png:"res/BanCa/MenuGame/Buttons/AtlasButtonMenuGame_loginRegis.png",MyriadProBold:"res/BanCa/Fonts/MyriadPro-Bold.ttf",MyriadProRegular:"res/BanCa/Fonts/MyriadPro-Regular.ttf",UVNThanhPhoNang:"res/BanCa/Fonts/UVNThanhPhoNang.TTF",UVNBaiSau_N:"res/BanCa/Fonts/UVNBaiSau_N.TTF",FontCoin:"res/BanCa/Fonts/FontCoin.fnt",FontCoin_png:"res/BanCa/Fonts/FontCoin.png",AtlasUnknowItems_plist:"res/BanCa/MenuGame/UnknowItems/AtlasUnknowItems.plist",AtlasUnknowItems:"res/BanCa/MenuGame/UnknowItems/AtlasUnknowItems.png",Bubbles_FX_atlas:"res/BanCa/ScreenGame/FX/Bubbles_FX.atlas",Bubbles_FX_json:"res/BanCa/ScreenGame/FX/Bubbles_FX.json",Bubbles_FX_png:"res/BanCa/ScreenGame/FX/Bubbles_FX.png",CSSUITongKetPopup:"res/BanCa/UITongKetPopup.json",AtlasPopupGame:"res/BanCa/Popups/PopupGame/AtlasPopupGame.png",AtlasPopupGame_plist:"res/BanCa/Popups/PopupGame/AtlasPopupGame.plist",AtlasPopupRegitLogin_png:"res/BanCa/Popups/PopupRegitLogin/AtlasPopupRegitLogin.png",AtlasPopupRegitLogin_plist:"res/BanCa/Popups/PopupRegitLogin/AtlasPopupRegitLogin.plist",IMG_3D_png:"res/BanCa/Popups/PopupGame/IMG_3D.png",CSSUILayerLoading:"res/BanCa/UICompoLoading.json",CSSUIRoomsLayer:"res/BanCa/UIRoomsLayer.json",LogoBanCa_atlas:"res/BanCa/MenuGame/Logo/LogoBanCa.atlas",LogoBanCa_json:"res/BanCa/MenuGame/Logo/LogoBanCa.json",LogoBanCa:"res/BanCa/MenuGame/Logo/LogoBanCa.png",CSSUILoginLayer:"res/BanCa/UILoginLayer.json",CSSUILoginPopup:"res/BanCa/UILoginPopup.json",CSSUIRegitPopup:"res/BanCa/UIRegitPopup.json",CSSJFDisplayName:"res/BanCa/JFDisplayName.json",CSSUIWebviewPopup:"res/BanCa/UIWebviewPopup.json",CSSUIInappPopup:"res/BanCa/UIInappPopup.json",AtlasGuns_png:"res/BanCa/ScreenGame/Guns/AtlasGuns.png",AtlasGuns_plist:"res/BanCa/ScreenGame/Guns/AtlasGuns.plist",CSSJFPlayerGunBottom:"res/BanCa/JFPlayerGunBottom.json",CSSJFPlayerGunTop:"res/BanCa/JFPlayerGunTop.json",AtlasGold_plist:"res/BanCa/ScreenGame/FX/gold/AtlasGold.plist",AtlasGold_png:"res/BanCa/ScreenGame/FX/gold/AtlasGold.png",CSSUIPopupChangePass:"res/BanCa/UIPopupChangePass.json",Lock_plist:"res/BanCa/ScreenGame/FX/lock/lock.plist",Lock_png:"res/BanCa/ScreenGame/FX/lock/lock.png",CSSUIPopupJackpot:"res/BanCa/UIPopupJackpot.json",CSSUIItemJackpot:"res/BanCa/JFItemJackpot.json",CSSJFCompoNotify:"res/BanCa/JFCompoNotify.json",CSSJFCompoOptionGame:"res/BanCa/JFCompoOptionGame.json",CSSUIComponentsLayer:"res/BanCa/UIComponentsLayer.json",CSSUIMiniGamePopup:"res/BanCa/UIMiniGamePopup.json",CSSJFTopItem:"res/BanCa/JFTopItem.json",CSSJFUserItem:"res/BanCa/JFUserItem.json",CSSUIListAvatarPopup:"res/BanCa/UIListAvatarPopup.json",CSSUIHeSoCaPopup:"res/BanCa/UIHeSoCaPopup.json",JFPopupChatEmoticon:"res/BanCa/JFChatPopup.json",CSSPopupChatEmoticon:"res/BanCa/UIChatPopup.json",CSSUIHistoryPopup:"res/BanCa/UIHistoryPopup.json",CSSUILayerMenuBackground:"res/BanCa/UILayerMenuBackground.json",CSSUIListUsersOnlinePopup:"res/BanCa/UIListUsersOnlinePopup.json",CSSUIMessagePopup:"res/BanCa/UIMessagePopup.json",CSSUIPopupHuongDan:"res/BanCa/UIPopupHuongDan.json",CSSUISettingPopup:"res/BanCa/UISettingPopup.json",CSSUITopDamagePopup:"res/BanCa/UITopDamagePopup.json",CSSUITopPopup:"res/BanCa/UITopPopup.json",CSSUIUserInfoPopup:"res/BanCa/UIUserInfoPopup.json",CSSUIUserProfilePopup:"res/BanCa/UIUserProfilePopup.json",CSSUIChangeMoneyPopup:"res/BanCa/UIChangeMoneyPopup.json",CSSUISupportPopup:"res/BanCa/UISupportPopup.json",CSSUIVongQuayPopup:"res/BanCa/UIVongQuayLayer.json",CSSJFItemMiniGameLichSu:"res/BanCa/JFItemMiniGameLichSu.json",CSSUIMiniTaiXiuLayer:"res/BanCa/UIMiniTaiXiuLayer.json",CSSUISlotMinigame:"res/BanCa/UISlotMinigame.json",CSSSlot:"res/BanCa/JFCotSlot.json",CSSKhungSlot:"res/BanCa/JFKhungSlot.json",CSSUIPromoPopup:"res/BanCa/UIPromoPopup.json",CSSUIJFVina10D:"res/BanCa/JFVina10D.json",CCSUIJFVina10E:"res/BanCa/JFVina10E.json",CCSUIJFMobi200D:"res/BanCa/JFMobi200D.json",CCSUIJFMobi200E:"res/BanCa/JFMobi200E.json",CCSUIJFViettel500D:"res/BanCa/JFViettel500D.json",CCSUIJFViettel500E:"res/BanCa/JFViettel500E.json",CCSUIJFMomoE:"res/BanCa/JFMomoE.json",CSSUIFirstTopupPopup:"res/BanCa/UIPopupFirstTopup.json",CSSUIListFramePopup:"res/BanCa/UIListFramePopup.json",SoundBGM_Lobby1:"res/BanCa/Sounds/Lobby/BGM_Lobby1.mp3",SoundBGM_Lobby2:"res/BanCa/Sounds/Lobby/BGM_Lobby2.mp3",SoundClose:"res/BanCa/Sounds/Lobby/Close.mp3",SoundFXFire:"res/BanCa/Sounds/Game/FXFire.mp3",ClickQuay:"res/BanCa/Sounds/Lobby/ClickQuay.mp3",NhacQuay:"res/BanCa/Sounds/Lobby/NhacQuay.mp3",NhanThuong:"res/BanCa/Sounds/Lobby/NhanThuong.mp3",MenuBackground1:"res/BanCa/MenuGame/BackGround/MenuBackground1.png",MenuBackground2:"res/BanCa/MenuGame/BackGround/MenuBackground2.png",AtlasPopupAvatar_plist:"res/BanCa/Popups/PopupAvatar/AtlasPopupAvatar.plist",AtlasPopupAvatar:"res/BanCa/Popups/PopupAvatar/AtlasPopupAvatar.png",Avatar11:"res/BanCa/Popups/PopupUuDai/avata1.png",Avatar12:"res/BanCa/Popups/PopupUuDai/avatar2.png",Avatar13:"res/BanCa/Popups/PopupUuDai/avatar3.png",Border_0:"res/BanCa/Popups/PopupAvatarFrame/BackgroundAvartar.png",Border_5:"res/BanCa/Popups/PopupAvatarFrame/lv5.png",Border_10:"res/BanCa/Popups/PopupAvatarFrame/lv10.png",Border_15:"res/BanCa/Popups/PopupAvatarFrame/lv15.png",Border_20:"res/BanCa/Popups/PopupAvatarFrame/lv20.png",Border_25:"res/BanCa/Popups/PopupAvatarFrame/lv25.png",Border_30:"res/BanCa/Popups/PopupAvatarFrame/lv30.png",IMGBGMenu1:"res/BanCa/MenuGame/BackGround/Login_Screen_BG.png",IMGBGMenu2:"res/BanCa/MenuGame/BackGround/Login_Screen_BG2.png",BGMenu_Json:"res/BanCa/MenuGame/BackGround/Login_Screen_BG.json",BGMenu_Atlas:"res/BanCa/MenuGame/BackGround/Login_Screen_BG.atlas",FXDiceTaiXiu_ATLAS:"res/BanCa/MenuGame/MiniGame/Dice_Only.atlas",FXDiceTaiXiu_PNG:"res/BanCa/MenuGame/MiniGame/Dice_Only.png",FXDiceTaiXiu_JSON:"res/BanCa/MenuGame/MiniGame/Dice_Only.json",FXThangTaiXiu_ATLAS:"res/BanCa/MenuGame/MiniGame/thang.atlas",FXThangTaiXiu_PNG:"res/BanCa/MenuGame/MiniGame/thang.png",FXThangTaiXiu_JSON:"res/BanCa/MenuGame/MiniGame/thang.json",CSSJFChatNode:"res/BanCa/JFChatNode.json",CSSJFChoseBetNode:"res/BanCa/JFChoseBetNode.json",CSSJFPopupXepHangLayer:"res/BanCa/JFPopupXepHangLayer.json",CSSJFItemLichSuNode:"res/BanCa/JFItemLichSuNode.json",CSSJFPopupLichSuLayer:"res/BanCa/JFPopupLichSuLayer.json",CSSJFPopupThongKeLayer:"res/BanCa/JFPopupThongKeLayer.json",CSSJFHuongDanTaiXiuPopup:"res/BanCa/JFHuongDanTaiXiuPopup.json",CSSJFItemHistorySlot:"res/BanCa/JFItemHistorySlot.json",CSSJFPopupHistorySlot:"res/BanCa/JFPopupHistorySlot.json",CSSJFItemTopFreeTicket:"res/BanCa/JFItemTopFreeTicket.json",CSSJFPopupTopFreeTicket:"res/BanCa/JFPopupTopFreeTicket.json",CSSJFPOpupTutorialSlot:"res/BanCa/JFPopupTutorial.json",CSSJFItemTopWin:"res/BanCa/JFItemTopWin.json",CSSJFPopupTopWin:"res/BanCa/JFPopupTopWin.json",CSSJFPopupTutorial:"res/BanCa/JFPopupTutorial.json",CCSUILayerEvent_json:"res/BanCa/UILayerEvent.json",AtlasJFEventButtonPack_png:"res/BanCa/event/JFEventButtonPack.png",AtlasJFEventButtonPack_plist:"res/BanCa/event/JFEventButtonPack.plist",UIBttEvent_json:"res/BanCa/event/eventBtt/bt.json",UIBttEvent_atlas:"res/BanCa/event/eventBtt/bt.atlas",UIBttEvent_png:"res/BanCa/event/eventBtt/bt.png",UIBttEventKBDD_json:"res/BanCa/event/eventKhoBauDaiDuong/Icon_Treasure_FX.json",UIBttEventKBDD_atlas:"res/BanCa/event/eventKhoBauDaiDuong/Icon_Treasure_FX.atlas",UIBttEventKBDD_png:"res/BanCa/event/eventKhoBauDaiDuong/Icon_Treasure_FX.png",JFItemVongQuayKBDD:"res/BanCa/JFItemVongQuayKBDD.json",bgVongQuayKBDD_png:"res/BanCa/Popups/VongQuayKhoBauDaiDuong/vong-quay.png",CCSPopupVongQuayKBDD_json:"res/BanCa/UIEventKhoBauDaiDuong.json",CCSPopupVongQuaySeason_json:"res/BanCa/UIVongQuaySeason.json",AtlasVongQuayKBDD_plist:"res/BanCa/Popups/VongQuayKhoBauDaiDuong/AtlasVongQuayEventKBDD.plist",AtlasVongQuayKBDD_png:"res/BanCa/Popups/VongQuayKhoBauDaiDuong/AtlasVongQuayEventKBDD.png",UIBttEventUDNT_json:"res/BanCa/event/eventUuDaiNapThe/napthe.json",UIBttEventUDNT_atlas:"res/BanCa/event/eventUuDaiNapThe/napthe.atlas",UIBttEventUDNT_png:"res/BanCa/event/eventUuDaiNapThe/napthe.png",FXLayer_png:"res/BanCa/MenuGame/FXLayer/lobby2.png",FXLayer_atlas:"res/BanCa/MenuGame/FXLayer/lobby2.atlas",FXLayer_json:"res/BanCa/MenuGame/FXLayer/lobby2.json",UI_IMG_BACKGROUND_SEASON_png:"res/BanCa/Popups/VongQuaySeason/IMG_BACKGROUND.png",UI_IMG_BTN_CLOSE_SEASON_png:"res/BanCa/Popups/VongQuaySeason/IMG_BTN_CLOSE.png",UI_IMG_BTN_LICH_SU_HOVER_SEASON_png:"res/BanCa/Popups/VongQuaySeason/IMG_BTN_LICH_SU_HOVER.png",UI_IMG_BTN_QUAY_SEASON_png:"res/BanCa/Popups/VongQuaySeason/IMG_BTN_QUAY.png",UI_IMG_BTN_QUAY_DISABLE_SEASON_png:"res/BanCa/Popups/VongQuaySeason/IMG_BTN_QUAY_DISABLE.png",UI_IMG_BTN_QUAY_HOVER_SEASON_png:"res/BanCa/Popups/VongQuaySeason/IMG_BTN_QUAY_HOVER.png",UI_IMG_BTN_THE_LE_HOVER_SEASON_png:"res/BanCa/Popups/VongQuaySeason/IMG_BTN_THE_LE_HOVER.png",UI_IMG_BTN_USER_TRUNG_GIAI_HOVER_SEASON_png:"res/BanCa/Popups/VongQuaySeason/IMG_BTN_USER_TRUNG_GIAI_HOVER.png",UI_IMG_CHECK_MARK_SEASON_png:"res/BanCa/Popups/VongQuaySeason/IMG_CHECK_MARK.png",UI_IMG_CLOSE_BG_SEASON_png:"res/BanCa/Popups/VongQuaySeason/IMG_CLOSE_BG.png",UI_IMG_KIM_CHON_SEASON_png:"res/BanCa/Popups/VongQuaySeason/IMG_KIM_CHON.png",UI_IMG_MASK_SEASON_png:"res/BanCa/Popups/VongQuaySeason/IMG_MASK.png",UI_IMG_VONG_QUAY_SEASON_png:"res/BanCa/Popups/VongQuaySeason/IMG_VONG_QUAY.png",UI_IMG_VONG_QUAY_BG_SEASON_png:"res/BanCa/Popups/VongQuaySeason/IMG_VONG_QUAY_BG.png",UIBtnEventVongQuaySeason_png:"res/BanCa/event/eventVongQuaySeason/Icon_HoiCaMuaXuan.png",UIBtnEventSanLiXi_png:"res/BanCa/event/SanLiXi.png",IMG_PHANTHUONG:"res/BanCa/MenuGame/Buttons/IMG_PHANTHUONG.png",JFComponentsSlot:"res/BanCa/JFCompoSlot.json",BtnAsc:"res/BanCa/Popups/SlotMinigame/BtnAsc.png",BtnDec:"res/BanCa/Popups/SlotMinigame/BtnDec.png",BtnBack:"res/BanCa/Popups/SlotMinigame/BtnBack.png",BtnBgSlot:"res/BanCa/Popups/SlotMinigame/BtnBgMiniSlot.png",BtnClose:"res/BanCa/Popups/SlotMinigame/BtnClose.png",BtnDung:"res/BanCa/Popups/SlotMinigame/BtnDung.png",BtnGoToGame:"res/BanCa/Popups/SlotMinigame/BtnGoToGame.png",BtnHistory:"res/BanCa/Popups/SlotMinigame/BtnHistory.png",BtnMaxBet:"res/BanCa/Popups/SlotMinigame/BtnMaxBet.png",BtnNext:"res/BanCa/Popups/SlotMinigame/BtnNext.png",BtnQuay:"res/BanCa/Popups/SlotMinigame/BtnQuay.png",BtnQuayDisable:"res/BanCa/Popups/SlotMinigame/BtnQuayDisable.png",BtnRanking:"res/BanCa/Popups/SlotMinigame/BtnRanking.png",BtnSlot777:"res/BanCa/Popups/SlotMinigame/BtnSlot777.png",BtnTutorial:"res/BanCa/Popups/SlotMinigame/BtnTutorial.png",IconGold:"res/BanCa/Popups/SlotMinigame/IconGold.png",IconJackpot:"res/BanCa/Popups/SlotMinigame/IconJackpot.png",ImgBgBet:"res/BanCa/Popups/SlotMinigame/ImgBgBet.png",ImgBgItem:"res/BanCa/Popups/SlotMinigame/ImgBgItem.png",ImgBgItem2:"res/BanCa/Popups/SlotMinigame/ImgBgItem2.png",ImgBgPopup:"res/BanCa/Popups/SlotMinigame/ImgBgPopup.png",ImgBgReward:"res/BanCa/Popups/SlotMinigame/ImgBgReward.png",ImgBgTxt:"res/BanCa/Popups/SlotMinigame/ImgBgTxt.png",ImgBgTxt2:"res/BanCa/Popups/SlotMinigame/ImgBgTxt2.png",ImgBgTxt3:"res/BanCa/Popups/SlotMinigame/ImgBgTxt3.png",ImgRule1:"res/BanCa/Popups/SlotMinigame/ImgGameRule1.png",ImgRule2:"res/BanCa/Popups/SlotMinigame/ImgGameRule2.png",ImgRule3:"res/BanCa/Popups/SlotMinigame/ImgGameRule3.png",ImgFreeSlotTicket:"res/BanCa/Popups/PopupMiniGame/ImgTicket.png",Slot0:"res/BanCa/Popups/SlotMinigame/Slot0.png",Slot1:"res/BanCa/Popups/SlotMinigame/Slot1.png",Slot2:"res/BanCa/Popups/SlotMinigame/Slot2.png",Slot3:"res/BanCa/Popups/SlotMinigame/Slot3.png",Slot4:"res/BanCa/Popups/SlotMinigame/Slot4.png",Slot5:"res/BanCa/Popups/SlotMinigame/Slot5.png",Slot6:"res/BanCa/Popups/SlotMinigame/Slot6.png",Slot7:"res/BanCa/Popups/SlotMinigame/Slot7.png",Slot8:"res/BanCa/Popups/SlotMinigame/Slot8.png",FXWinSlot_atlas:"res/BanCa/Popups/SlotMinigame/SlotEffect/FrameIcon_FX.atlas",FXWinSlot_json:"res/BanCa/Popups/SlotMinigame/SlotEffect/FrameIcon_FX.json",FXWinSlot_png:"res/BanCa/Popups/SlotMinigame/SlotEffect/FrameIcon_FX.png",FXWinJackpot_atlas:"res/BanCa/Popups/SlotMinigame/SlotEffect/cao_thap.atlas",FXWinJackpot_json:"res/BanCa/Popups/SlotMinigame/SlotEffect/cao_thap.json",FXWinJackpot_png:"res/BanCa/Popups/SlotMinigame/SlotEffect/cao_thap.png",FXWinScartter_atlas:"res/BanCa/Popups/SlotMinigame/SlotEffect/hu_xeng.atlas",FXWinScartter_json:"res/BanCa/Popups/SlotMinigame/SlotEffect/hu_xeng.json",FXWinScartter_png:"res/BanCa/Popups/SlotMinigame/SlotEffect/hu_xeng.png",FXWinScartter2_png:"res/BanCa/Popups/SlotMinigame/SlotEffect/hu_xeng2.png",Icon_Tai_png:"res/BanCa/Popups/TaiXiu/icon-tai.png",Icon_Xiu_png:"res/BanCa/Popups/TaiXiu/icon-xiu.png",Item_ThongKe_Tai_png:"res/BanCa/Popups/TaiXiu/item-thong-ke-tai.png",Item_ThongKe_Xiu_png:"res/BanCa/Popups/TaiXiu/item-thong-ke-xiu.png"},JFResourcesGame:{FishBoss0_plist:"res/BanCa/ScreenGame/Fish/FishBoss0.plist",FishBoss0_png:"res/BanCa/ScreenGame/Fish/FishBoss0.png",FishBoss1_plist:"res/BanCa/ScreenGame/Fish/FishBoss1.plist",FishBoss1_png:"res/BanCa/ScreenGame/Fish/FishBoss1.png",atlas_boss_te_thien0_plist:"res/BanCa/ScreenGame/Fish/atlas_boss_te_thien0.plist",atlas_boss_te_thien0_png:"res/BanCa/ScreenGame/Fish/atlas_boss_te_thien0.png",atlas_boss_te_thien1_plist:"res/BanCa/ScreenGame/Fish/atlas_boss_te_thien1.plist",atlas_boss_te_thien1_png:"res/BanCa/ScreenGame/Fish/atlas_boss_te_thien1.png",atlas_boss_te_thien2_plist:"res/BanCa/ScreenGame/Fish/atlas_boss_te_thien2.plist",atlas_boss_te_thien2_png:"res/BanCa/ScreenGame/Fish/atlas_boss_te_thien2.png",atlas_boss_te_thien3_plist:"res/BanCa/ScreenGame/Fish/atlas_boss_te_thien3.plist",atlas_boss_te_thien3_png:"res/BanCa/ScreenGame/Fish/atlas_boss_te_thien3.png",IMGGameBG0:"res/BanCa/ScreenGame/Background/bg_0.png",IMGGameBG1:"res/BanCa/ScreenGame/Background/bg_1.png",IMGGameBG2:"res/BanCa/ScreenGame/Background/bg_2.png",IMGGameBG3:"res/BanCa/ScreenGame/Background/bg_3.png",IMGGameBG4:"res/BanCa/ScreenGame/Background/bg_4.png",IMGGameBG5:"res/BanCa/ScreenGame/Background/bg_5.png",IMG_TEXT_STUN:"res/BanCa/ScreenGame/FX/IMG_TEXT_STUN.png",IMG_LIGHT_BLUE:"res/BanCa/ScreenGame/FX/IMG_LIGHT_BLUE.png",water_wave_plist:"res/BanCa/ScreenGame/Background/water_wave.plist",water_wave_png:"res/BanCa/ScreenGame/Background/water_wave.png",AtlasNet:"res/BanCa/ScreenGame/FX/net/Net.plist",AtlasNet_png:"res/BanCa/ScreenGame/FX/net/Net.png",AtlasWater:"res/BanCa/ScreenGame/FX/water/water.plist",AtlasWater_png:"res/BanCa/ScreenGame/FX/water/water.png",AtlasTransition:"res/BanCa/ScreenGame/FX/transition/fish_transition.plist",AtlasTransition_png:"res/BanCa/ScreenGame/FX/transition/fish_transition.png",FXshayuPlist:"res/BanCa/ScreenGame/FX/particlesrs/shayu.plist",FXshayuPng:"res/BanCa/ScreenGame/FX/particlesrs/particle_texture.png",FXdingPlist:"res/BanCa/ScreenGame/FX/particlesrs/ding.plist",FXdingPng:"res/BanCa/ScreenGame/FX/particlesrs/ding.png",FXjinlongPlist:"res/BanCa/ScreenGame/FX/particlesrs/jinlong.plist",FXjinlongPng:"res/BanCa/ScreenGame/FX/particlesrs/jinlong.png",FXTienCaPlist:"res/BanCa/ScreenGame/FX/particlesrs/particleTienCa.plist",FXBombPlist:"res/BanCa/ScreenGame/FX/particlesrs/bomb.plist",FXBombPng:"res/BanCa/ScreenGame/FX/particlesrs/bomb.png",FXDasanyuanPlist:"res/BanCa/ScreenGame/FX/particlesrs/dasanyuan.plist",FXDasanyuanPng:"res/BanCa/ScreenGame/FX/particlesrs/dasanyuan.png",FXYanhuaPlist:"res/BanCa/ScreenGame/FX/particlesrs/yanhua.plist",FXYanhuaPng:"res/BanCa/ScreenGame/FX/particlesrs/yanhua.png",FXXuehuaPlist:"res/BanCa/ScreenGame/FX/particlesrs/xuehua.plist",FXXuehuaPng:"res/BanCa/ScreenGame/FX/particlesrs/xuehua.png",hpAtlas:"res/BanCa/Fonts/hpAtlas.fnt",hpAtlas_png:"res/BanCa/Fonts/hpAtlas.png",SoDanAtlas:"res/BanCa/Fonts/SoDan.fnt",SoDan_png:"res/BanCa/Fonts/SoDan.png",IMG_TRAMK:"res/BanCa/Fonts/IMG_TRAMK/IMG_TRAMK.fnt",IMG_TRAMK_png:"res/BanCa/Fonts/IMG_TRAMK/IMG_TRAMK.png",IMG_TR:"res/BanCa/Fonts/IMG_TR/IMG_TR.fnt",IMG_TR_png:"res/BanCa/Fonts/IMG_TR/IMG_TR.png",IMG_K:"res/BanCa/Fonts/IMG_K/IMG_K.fnt",IMG_K_png:"res/BanCa/Fonts/IMG_K/IMG_K.png",AtlasFish0_plist:"res/BanCa/ScreenGame/Fish/atlasIFish_0.plist",AtlasFish0_png:"res/BanCa/ScreenGame/Fish/atlasIFish_0.png",AtlasFish1_plist:"res/BanCa/ScreenGame/Fish/atlasIFish_1.plist",AtlasFish1_png:"res/BanCa/ScreenGame/Fish/atlasIFish_1.png",AtlasFish2_plist:"res/BanCa/ScreenGame/Fish/atlasIFish_2.plist",AtlasFish2_png:"res/BanCa/ScreenGame/Fish/atlasIFish_2.png",AtlasFish3_plist:"res/BanCa/ScreenGame/Fish/atlasIFish_3.plist",AtlasFish3_png:"res/BanCa/ScreenGame/Fish/atlasIFish_3.png",AtlasFish4_plist:"res/BanCa/ScreenGame/Fish/atlasIFish_4.plist",AtlasFish4_png:"res/BanCa/ScreenGame/Fish/atlasIFish_4.png",AtlasFish5_plist:"res/BanCa/ScreenGame/Fish/atlasIFish_5.plist",AtlasFish5_png:"res/BanCa/ScreenGame/Fish/atlasIFish_5.png",AtlasFish6_plist:"res/BanCa/ScreenGame/Fish/atlasIFish_6.plist",AtlasFish6_png:"res/BanCa/ScreenGame/Fish/atlasIFish_6.png",AtlasFish7_plist:"res/BanCa/ScreenGame/Fish/atlasIFish_7.plist",AtlasFish7_png:"res/BanCa/ScreenGame/Fish/atlasIFish_7.png",AtlasFish8_plist:"res/BanCa/ScreenGame/Fish/atlasIFish_8.plist",AtlasFish8_png:"res/BanCa/ScreenGame/Fish/atlasIFish_8.png",AtlasFish9_plist:"res/BanCa/ScreenGame/Fish/atlasIFish_9.plist",AtlasFish9_png:"res/BanCa/ScreenGame/Fish/atlasIFish_9.png",AtlasFish10_plist:"res/BanCa/ScreenGame/Fish/atlasIFish_10.plist",AtlasFish10_png:"res/BanCa/ScreenGame/Fish/atlasIFish_10.png",AtlasFish11_plist:"res/BanCa/ScreenGame/Fish/atlasIFish_11.plist",AtlasFish11_png:"res/BanCa/ScreenGame/Fish/atlasIFish_11.png",AtlasFish12_plist:"res/BanCa/ScreenGame/Fish/atlasIFish_12.plist",AtlasFish12_png:"res/BanCa/ScreenGame/Fish/atlasIFish_12.png",AtlasFish13_plist:"res/BanCa/ScreenGame/Fish/atlasIFish_13.plist",AtlasFish13_png:"res/BanCa/ScreenGame/Fish/atlasIFish_13.png",AtlasFish14_plist:"res/BanCa/ScreenGame/Fish/atlasIFish_14.plist",AtlasFish14_png:"res/BanCa/ScreenGame/Fish/atlasIFish_14.png",AtlasFish15_plist:"res/BanCa/ScreenGame/Fish/atlasIFish_15.plist",AtlasFish15_png:"res/BanCa/ScreenGame/Fish/atlasIFish_15.png",AtlasFish16_plist:"res/BanCa/ScreenGame/Fish/atlasIFish_16.plist",AtlasFish16_png:"res/BanCa/ScreenGame/Fish/atlasIFish_16.png",AtlasFish17_plist:"res/BanCa/ScreenGame/Fish/atlasIFish_17.plist",AtlasFish17_png:"res/BanCa/ScreenGame/Fish/atlasIFish_17.png",AtlasFish18_plist:"res/BanCa/ScreenGame/Fish/atlasIFish_18.plist",AtlasFish18_png:"res/BanCa/ScreenGame/Fish/atlasIFish_18.png",atlasPopupChat_plist:"res/BanCa/PopupChat/atlas_popupchat.plist",atlasPopupChat_png:"res/BanCa/PopupChat/atlas_popupchat.png",Text_Laser_Gun_atlas:"res/BanCa/ScreenGame/FX/skills/Text_Laser_Gun.atlas",Text_Laser_Gun_png:"res/BanCa/ScreenGame/FX/skills/Text_Laser_Gun.png",Text_Laser_Gun_json:"res/BanCa/ScreenGame/FX/skills/Text_Laser_Gun.json",Text_Electric_Gun_atlas:"res/BanCa/ScreenGame/FX/skills/Text_Electric_Gun.atlas",Text_Electric_Gun_png:"res/BanCa/ScreenGame/FX/skills/Text_Electric_Gun.png",Text_Electric_Gun_json:"res/BanCa/ScreenGame/FX/skills/Text_Electric_Gun.json",Text_BombGun_atlas:"res/BanCa/ScreenGame/FX/skills/Text_BombGun.atlas",Text_BombGun_png:"res/BanCa/ScreenGame/FX/skills/Text_BombGun.png",Text_BombGun_json:"res/BanCa/ScreenGame/FX/skills/Text_BombGun.json",Text_Poseidon_atlas:"res/BanCa/ScreenGame/FX/skills/TridentSkill_Noti_FX.atlas",Text_Poseidon_json:"res/BanCa/ScreenGame/FX/skills/TridentSkill_Noti_FX.json",Text_Poseidon_png:"res/BanCa/ScreenGame/FX/skills/TridentSkill_Noti_FX.png",Text_Boss_Coming_atlas:"res/BanCa/ScreenGame/FX/Text_Boss_Coming.atlas",Text_Boss_Coming_png:"res/BanCa/ScreenGame/FX/Text_Boss_Coming.png",Text_Boss_Coming_json:"res/BanCa/ScreenGame/FX/Text_Boss_Coming.json",LvUp_FX_atlas:"res/BanCa/ScreenGame/FX/skeleton.atlas",LvUp_FX_png:"res/BanCa/ScreenGame/FX/skeleton.png",LvUp_FX_json:"res/BanCa/ScreenGame/FX/skeleton.json",SpineEffectStun_json:"res/BanCa/ScreenGame/FX/Stun/choang.json",SpineEffectStun_atlas:"res/BanCa/ScreenGame/FX/Stun/choang.atlas",SpineEffectStun_png:"res/BanCa/ScreenGame/FX/Stun/choang.png",AtlasIFishSkillPNG:"res/BanCa/ScreenGame/FX/skills/AtlasIFishSkill.png",AtlasIFishSkillPLIST:"res/BanCa/ScreenGame/FX/skills/AtlasIFishSkill.plist",AtlasIFishSkillPNG1:"res/BanCa/ScreenGame/FX/skills/AtlasIFishSkill_1.png",AtlasIFishSkillPLIST1:"res/BanCa/ScreenGame/FX/skills/AtlasIFishSkill_1.plist",AtlasIFishSkillPNG2:"res/BanCa/ScreenGame/FX/skills/AtlasIFishSkill_2.png",AtlasIFishSkillPLIST2:"res/BanCa/ScreenGame/FX/skills/AtlasIFishSkill_2.plist",AtlasIFishSkillPNG3:"res/BanCa/ScreenGame/FX/skills/AtlasIFishSkill_3.png",AtlasIFishSkillPLIST3:"res/BanCa/ScreenGame/FX/skills/AtlasIFishSkill_3.plist",AtlasIFishSkillPNG4:"res/BanCa/ScreenGame/FX/skills/AtlasIFishSkill_4.png",AtlasIFishSkillPLIST4:"res/BanCa/ScreenGame/FX/skills/AtlasIFishSkill_4.plist",AtlasIFishSkillPNG5:"res/BanCa/ScreenGame/FX/skills/AtlasIFishSkill_5.png",AtlasIFishSkillPLIST5:"res/BanCa/ScreenGame/FX/skills/AtlasIFishSkill_5.plist",AtlasIFishSkillPNG6:"res/BanCa/ScreenGame/FX/skills/AtlasIFishSkill_6.png",AtlasIFishSkillPLIST6:"res/BanCa/ScreenGame/FX/skills/AtlasIFishSkill_6.plist",AtlasIFishSkillPNG7:"res/BanCa/ScreenGame/FX/skills/AtlasIFishSkill_7.png",AtlasIFishSkillPLIST7:"res/BanCa/ScreenGame/FX/skills/AtlasIFishSkill_7.plist",AtlasIFishSkillPNG8:"res/BanCa/ScreenGame/FX/skills/AtlasIFishSkill_8.png",AtlasIFishSkillPLIST8:"res/BanCa/ScreenGame/FX/skills/AtlasIFishSkill_8.plist",AtlasIFishSkillPNG9:"res/BanCa/ScreenGame/FX/skills/AtlasIFishSkill_9.png",AtlasIFishSkillPLIST9:"res/BanCa/ScreenGame/FX/skills/AtlasIFishSkill_9.plist",AtlasIFishSkillPNG10:"res/BanCa/ScreenGame/FX/skills/AtlasIFishSkill_10.png",AtlasIFishSkillPLIST10:"res/BanCa/ScreenGame/FX/skills/AtlasIFishSkill_10.plist",CSSJFItemActionBottom:"res/BanCa/JFItemActionInGameBottom.json",CSSJFItemActionTop:"res/BanCa/JFItemActionInGameTop.json",CSSJFCompoGameExit:"res/BanCa/JFCompoGameExit.json",CSSUIGunsLayer:"res/BanCa/UIGunsLayer.json",CSSJFCompoSkill1:"res/BanCa/JFCompoSkill_1.json",CSSJFCompoSkill2:"res/BanCa/JFCompoSkill_2.json",CSSJFCompoSkill3:"res/BanCa/JFCompoSkill_3.json",CSSJFCompoSkill4:"res/BanCa/JFCompoSkill_4.json",CSSJFCompoSkillSlider:"res/BanCa/JFCompoSkillBar.json",FX_TridentSkill_atlas:"res/BanCa/ScreenGame/FX/skills/TridentSkill_FX.atlas",FX_TridentSkill_json:"res/BanCa/ScreenGame/FX/skills/TridentSkill_FX.json",FX_TridentSkill_png:"res/BanCa/ScreenGame/FX/skills/TridentSkill_FX.png",FX_Trident_plist:"res/BanCa/ScreenGame/FX/particlesrs/TridentParticle.plist",FX_Trident_png:"res/BanCa/ScreenGame/FX/particlesrs/TridentParticle.png",FX_Electric_Gem_atlas:"res/BanCa/ScreenGame/FX/SkillActive/Trident_Electric_Gem_FX.atlas",FX_Electric_Gem_json:"res/BanCa/ScreenGame/FX/SkillActive/Trident_Electric_Gem_FX.json",FX_Electric_Gem_png:"res/BanCa/ScreenGame/FX/SkillActive/Trident_Electric_Gem_FX.png",FX_Fire_Gem_atlas:"res/BanCa/ScreenGame/FX/SkillActive/Trident_Fire_Gem_FX.atlas",FX_Fire_Gem_json:"res/BanCa/ScreenGame/FX/SkillActive/Trident_Fire_Gem_FX.json",FX_Fire_Gem_png:"res/BanCa/ScreenGame/FX/SkillActive/Trident_Fire_Gem_FX.png",FX_Lazer_Gem_atlas:"res/BanCa/ScreenGame/FX/SkillActive/Trident_Lazer_Gem_FX.atlas",FX_Lazer_Gem_json:"res/BanCa/ScreenGame/FX/SkillActive/Trident_Lazer_Gem_FX.json",FX_Lazer_Gem_png:"res/BanCa/ScreenGame/FX/SkillActive/Trident_Lazer_Gem_FX.png",FX_Golden_Gem_atlas:"res/BanCa/ScreenGame/FX/SkillActive/Trident_Ulti_Gem_FX.atlas",FX_Golden_Gem_json:"res/BanCa/ScreenGame/FX/SkillActive/Trident_Ulti_Gem_FX.json",FX_Golden_Gem_png:"res/BanCa/ScreenGame/FX/SkillActive/Trident_Ulti_Gem_FX.png",Bullet0:"res/BanCa/ScreenGame/Bullets/IMG_BULLET_0.png",Bullet1:"res/BanCa/ScreenGame/Bullets/IMG_BULLET_1.png",Bullet2:"res/BanCa/ScreenGame/Bullets/IMG_BULLET_2.png",Bullet3:"res/BanCa/ScreenGame/Bullets/IMG_BULLET_3.png",Bullet4:"res/BanCa/ScreenGame/Bullets/IMG_BULLET_4.png",Bullet5:"res/BanCa/ScreenGame/Bullets/IMG_BULLET_5.png",SoundBGM1:"res/BanCa/Sounds/Game/bgm1.mp3",SoundBGM2:"res/BanCa/Sounds/Game/bgm2.mp3",SoundBGM3:"res/BanCa/Sounds/Game/bgm3.mp3",SoundBGM4:"res/BanCa/Sounds/Game/bgm4.mp3",SoundBGM5:"res/BanCa/Sounds/Game/bgm5.mp3",SoundBGM6:"res/BanCa/Sounds/Game/bgm6.mp3",SoundFXFire:"res/BanCa/Sounds/Game/FXFire.mp3",SoundFXGold:"res/BanCa/Sounds/Game/FXGold.mp3",SoundFXCatch:"res/BanCa/Sounds/Game/FXCatch.mp3",SoundFXPreLazer:"res/BanCa/Sounds/Game/FXPreLaze.mp3",SoundFXLazer:"res/BanCa/Sounds/Game/FXLaze.mp3",SoundFXLightning:"res/BanCa/Sounds/Game/FXLightning.mp3",SoundFXPreBome:"res/BanCa/Sounds/Game/FXPreBome.mp3",SoundFXBome:"res/BanCa/Sounds/Game/FXBome.mp3",SoundFXPoseidon1:"res/BanCa/Sounds/Game/ReShot.mp3",SoundFXPoseidon2:"res/BanCa/Sounds/Game/Shot.mp3",SoundWave:"res/BanCa/Sounds/Game/Wave.mp3",ButtonSpeedX1:"res/BanCa/ScreenGame/Images/BtnSpeed_Active.png",ButtonSpeedX2:"res/BanCa/ScreenGame/Images/BtnSpeed_Default.png",NoHu_FX_atlas:"res/BanCa/ScreenGame/FX/nohu.atlas",NoHu_FX_png:"res/BanCa/ScreenGame/FX/nohu.png",NoHu_FX_json:"res/BanCa/ScreenGame/FX/nohu.json"}},resourcesLoadingGame=[],resourcesMenuGame=[],resourcesGame=[],urlArg="",pathUrl="",ScreenPolicy={apply:function(){if(document.addEventListener&&(document.addEventListener("webkitfullscreenchange",Utilities.fullScreen,!1),document.addEventListener("mozfullscreenchange",Utilities.fullScreen,!1),document.addEventListener("fullscreenchange",Utilities.fullScreen,!1),document.addEventListener("MSFullscreenChange",Utilities.fullScreen,!1)),cc.sys.isMobile)if(cc.sys.os===cc.sys.OS_IOS){window.addEventListener("orientationchange",function(){setTimeout(Utilities.fullScreen,500)});try{$(document).ready(function(){window.onorientationchange=function(t){switch(window.orientation){case 0:case 180:$("body").css("padding-top","0px");break;case-90:case 90:$("body").css("padding-top","200px")}setTimeout(function(){var t=$("#Cocos2dGameContainer").offset();window.scrollTo(0,t.top)},1e3)}})}catch(t){}}else{var t=screen.orientation||screen.mozOrientation||screen.msOrientation;t.addEventListener("change",function(){"landscape-primary"==t.type&&setTimeout(Utilities.fullScreen,500)}),document.addEventListener("click",function(){document.webkitIsFullScreen||document.mozFullScreen||document.msFullscreenElement||cc.screen.requestFullScreen(document.getElementsByTagName("body")[0])})}}},version="?v="+Date.now(),PreLoaderConfig={apiPath:"https://api.isoftage.com/mobile/api?",apiWeb:"https://api.isoftage.com/api/fish?",uploadLink:"https://resource.isoftage.com/",pathResource:"https://sourcegamecasino.github.io/bancathantai/",VERSION_APP:21,AppVersion:"App_170503",IsReview:!1,PathToAvatar:"https://sourcegamecasino.github.io/bancathantai",PathToGiftItem:"https://sourcegamecasino.github.io/bancathantai/Images/Item/",PathToItemDefault:"https://sourcegamecasino.github.io/bancathantai/",PathToAvatarDefault:"https://sourcegamecasino.github.io/bancathantai/Images/avatar/noimage.gif",ServerAndPortMaster:"",ServerAndPortGame:"",PathToGameClass:"",Messages:{ERROR_CONNECT_SOCKET:"Lỗi kết nối vui lòng thử lại !",ERROR_API:"Lỗi kết nối vui lòng thử lại ! ",ERROR_LOGIN:"Bạn chưa đăng nhập!",ERROR_LOST_ACTION:"Bạn đã không thao tác khá lâu. \nBạn sẽ được đẩy ra phòng chờ.",NEG:"Bạn không đủ gold để tham gia bàn chơi. \nXin vui lòng nạp Ngọc để tiếp tục chơi.",NEGIN:"Bạn không đủ tiền bắn cá. \nBạn có muốn đổi thêm không?",SERVER_MAINTENANCE:"Hệ thống đang bảo trì \nvui lòng quay lại sau."},LINKS:{FANPAGE_FACEBOOK:"https://www.facebook.com/isoftage79",FANPAGE_TELEGRAM:"https://t.me/isoftage79",ADMIN:"https://t.me/cskh_bctt79",WEB_DOWNLOAD_APP:"https://isoftage.com/",OTP_TELEGRAM:"http://t.me/OTP_isoftage_BOT",WEB_HUONGDAN_OTP:"https://isoftage.com/otp.html"},Support:{PhoneNumber:"telegram",Viber:"fanpage",Email:""},StringFormat:{LEVEL:"Level: {0}"},BTN_BAN_BE_SHOW:!0,TIME_LOST_ACTION:70,TIME_PING_MASTER:10,TIME_PING_GAME:10,VERSION:"",ICGANDROID:"App_171221",ICGIOS:"App_171221",IsAllowExchange:!0,IsAllowBuy:!0,IsMaintenance:!1,EVENTS_IMG:[],IMGG:[],T_VAR:1514739599e3,TimeTick:16,LockGunPosition:{Vip:[],Normal:[]},GunValue:{Vip:[{img:"money_6_",value:1e3},{img:"money_7_",value:2e3},{img:"money_8_",value:3e3},{img:"money_9_",value:5e3},{img:"money_10_",value:7e3},{img:"money_11_",value:9e3},{img:"money_12_",value:1e4}],Normal:[{img:"money_1_",value:100},{img:"money_3_",value:300},{img:"money_4_",value:500},{img:"money_5_",value:700},{img:"money_6_",value:1e3},{img:"money_7_",value:2e3},{img:"money_8_",value:3e3}]},gameWidth:1280,gameHeight:720,debugMode:0,WebviewMode:!0},ConstansNetworkKey=(window.JFPreloaderConfig=PreLoaderConfig,{NET_CONNECT_MASTER:20001,MDM_SYS_CHECK_SOCKET:228,MDM_GP_LOGONUSERS:119,NET_CONNECT_GAME:20001,NET_GET_GAME_INFO:20002,MAIN_UPDATEGOLDFORUSER:20004,NET_LOGIN_GAME_RESPONSE:100,NET_USER_IN_ROOM_RESPONSE:101,NET_USER_POSITION_RESPONSE:102,MDM_GP_BOSS_FISH_GETINFO:225,MDM_GP_BOSS_FISH_GETINFO_SUB_2:2,MDM_GM_KICK_MESSAGE:221,MDM_GP_CUSTOMIZE:229,MDM_SYS_NOTIFYCATION:223,QuaySo_User_GetInfo:3}),ConstantsVariable={LAYERS:{MENU_LAYER_LOGIN:0,MENU_LAYER_ROOMS:1,MENU_LAYER_GAME:2,MENU_LAYER_MINI_GAME:3},PlatformID:{Unknown:0,Android:1,Ios:2,WindowsPhone:3,Web:4},WEBVIEW:{DOI_THUONG:3,NAP_XU:2,NEWS:5,MANH_THE:6,NHIEM_VU:8,NHAN_THUONG:9,USER_ONLINE:10,BANG_XEP_HANG:11,UU_DAI_NAP_THE:12,NAP_TICH_LUY:13,KICH_HOAT_CODE:14,RUONG:15,HOP_THU:16,BAN_BE:17,TAI_APP:18,SanLiXi:19},LoginProviderID:{Normal:0,Facebook:1,Google:2,Yahoo:3},CHANNEL_ID:1,EVENTS:{MENU_LAYER_SWIPE:"MENU_LAYER_SWIPE",MENU_LAYER_UPDATE_USER:"MENU_LAYER_UPDATE_USER",LOCK_FISH:"LOCK_FISH",FISH_DIE_REMOVE_LOCK:"FISH_DIE_REMOVE_LOCK",REFRESH_POPUP_USER_INFO:"REFRESH_POPUP_USER_INFO",REFRESH_AVATAR_USER:"REFRESH_AVATAR_USER",DISPATCH_REFRESH_AVATAR_USER:"DISPATCH_REFRESH_AVATAR_USER",ANDROID_SOFTKEY_BACK:"ANDROID_SOFTKEY_BACK",GAME_BEGIN_LOCK_FISH:"GAME_BEGIN_LOCK_FISH",VIN_UPDATE_MONEY:"updateMoney",SHOW_BOSS_COMING:"SHOW_BOSS_COMING",UPDATE_SKILL_SLIDER:"UPDATE_SKILL_SLIDER",CALL_TOP_USER_SLOT:"CALL_TOP_USER_SLOT",USER_GET_TICKET:"USER_GET_TICKET",CHECK_USER_LOGIN:"CHECK_USER_LOGIN",HIDE_AVATAR_USER_NOT_LOGIN:"HIDE_AVATAR_USER_NOT_LOGIN",LOGOUT_ACCOUNT_LOBBY:"LOGOUT_ACCOUNT_LOBBY",REMOVE_AVATAR_LOGOUT:"REMOVE_AVATAR_LOGOUT",KICK_USER:"KICH_USER",REFRESH_BORDER_AVATAR:"REFRESH_BORDER_AVATAR"},DISPATCH_EVENT_OUT_FOCUS:"DISPATCH_EVENT_OUT_FOCUS",GunPosition:[],NETWORK:{LOGIN_MASTER:1001,SYSTEM_MESSAGE:1002,UPDATE_MY_GOLD:1003,SYSTEM_KICH:1004,SYSTEM_BROADCAST:1005,SYSTEM_GET_ROOM_INFO:1006,INFO_AWARD_ONLINE:1007,GET_AWARD_ONLINE:1008,INFO_AWARD_ATTENDANCE:1009,GET_ATTENDANCE:1010,SHOW_UPDATE_DISPLAY_NAME:1011,UPDATE_DISPLAY_NAME:1012,UPDATE_TOTAL_USER_ONLINE:1013,SHOW_TOP_DAMAGE:1014,STATUS_AWARD:1015,MONEY_HISTORY_REPONESE:1016,PING_PONG:1999,MESSAGE_TRANSFORM:1017,TOP_USER_SLOT:1018,LOGIN_GAME:2001,GAME_LISTUSER_BOARD:2002,GAME_USER_ENTER_BOARD:2003,GAME_MESSAGE:2004,GAME_USER_FIRE:2005,GAME_CREATE_FISH:2006,GAME_CATCH_FISH:2007,GAME_USER_EXIT:2008,GAME_CREATE_FISH_GROUP:2009,GAME_SKILLS_INFO:2010,GAME_FIRE_SKILL:2011,GAME_UPDATE_SKILL:2012,GAME_UPDATE_CLEAR_FISH:2013,GAME_CATCH_FISH_SKILL:2014,GAME_CREATE_FISH_BOSS:2015,GAME_CREATE_FISH_CROW:2016,GAME_CATCH_RED_FISH:2017,GAME_UPDATE_HP_FISH_BOSS:2018,GAME_KICK:2019,GAME_UPDATE_BOSS_DIE:2020,GAME_CREATE_FISH_GROUP_NEW:2022,GAME_DROP_ITEM:2023,GAME_PLAY_GLOBAL_FX:2024,GAME_STOP_GLOBAL_FX:2025,GAME_CHAT_EMOTICON:2027,GAME_GET_INFO_FREETICK:2029,GAME_UPDATE_FREETICK:2030,PING_PONG_GAME:2999,GAME_CREATE_BULLET:"GAME_CREATE_BULLET",GAME_CREATE_SKILL:"GAME_CREATE_SKILL",GAME_CHANGE_GUN_SKILL:"GAME_CHANGE_GUN_SKILL",GAME_USER_UPDATE_CATCHFISH:"GAME_USER_UPDATE_CATCHFISH",GAME_EXIT:"GAME_EXIT",MINI_GAME_LOGIN_SUCCESS:1,MINI_GAME_USES_INFO:3,MINI_GAME_START_ROLL:4,MINI_GAME_RESULT:5,MINI_GAME_ERROR:6,MINI_GAME_LIST_ITEM:7,MINI_GAME_LIST_LAYER_WIN:8,MINI_GAME_LIST_HISTORY:9,MINI_GAME_LOGIN:20001,JACKPOT_DATA:3001,JACKPOT_FINISH:3003,GAME_BOT_CATCH_FISH:4001},BulletMax:20,CONFIG_BULLET:{SPEED_DEFAULT:"SPEED_DEFAULT",SPEED_X2:"SPEED_X2",VALUE_BULLET_DEFAUT:.2,VALUE_BULLET_ACIVE:.05,AUTO_FIRE:"AUTO_FIRE",DE_ACTIVE_AUTO_FIRE:"DE_ACTIVE_AUTO_FIRE"},ROOMKIND:{FREE:1,VIP:3,ADVENTURE:4,TRIAL:5,MINI_GAME_VONG_QUAY:1001,MINI_GAME_TAI_XIU:1002,MINI_GAME_SLOT:1005,EVENT_VONG_QUAY_KBDD:1003,EVENT_VONG_QUAY_MCGS:1004},NETWORK_TAI_XIU:{LOGIN:30001,GAME_INFO:30002,ErrorMessage:30003,StartMatch:30004,EndMatch:30005,UserBet:30006,ResultHistory:30007,BetHistory:30008,TopRank:30009,Chat:30010,ChangeCoin:30011,UpdateValueBet:30012},NETWORK_SLOT:{LOGIN:40001,ErrorMessage:40002,BET:40003,RESULT:40004,BETVALUE:40005,UPDATEJACKPOT:40006,WINJACKPOT:40007,BETHISTORY:40008,TOPWIN:40009},ErorConnect:"ErrorConnect",PLAYERS:{MAX:4},COLLISION:{BULLET:0,FISH:1},GAMESPEED:{BULLET:1400},UIZorder:{NONE:0,MAINMENU:15,GOLD:50,FISH:100,BULLET:200,SWITCH:300,NET:400,WATER:500,SPACE:600,GAME:10,COMPONENTS:20,MINIGAME:30,POPUPS:40,TIP:1e3},FX:{NET:["net_white","net_white","net_white","net_white"],GLOBAL_SKILL:{FREEZE:1,BOME:2}},FISH_CONFIG_NORMAL:[{type:0,name:"0_",speed:5,wakingFrames:7,dyingFrames:0},{type:1,name:"1_",speed:5,wakingFrames:8,dyingFrames:0},{type:2,name:"2_",speed:5,wakingFrames:13,dyingFrames:0},{type:3,name:"3_",speed:5,wakingFrames:14,dyingFrames:0},{type:4,name:"4_",speed:5,wakingFrames:10,dyingFrames:0},{type:5,name:"5_",speed:5,wakingFrames:10,dyingFrames:0},{type:6,name:"6_",speed:5,wakingFrames:10,dyingFrames:0},{type:7,name:"7_",speed:5,wakingFrames:7,dyingFrames:0},{type:8,name:"8_",speed:5,wakingFrames:11,dyingFrames:0},{type:9,name:"9_",speed:5,wakingFrames:10,dyingFrames:0},{type:10,name:"10_",speed:4,wakingFrames:16,dyingFrames:0},{type:11,name:"11_",speed:4,wakingFrames:7,dyingFrames:0},{type:12,name:"12_",speed:4,wakingFrames:8,dyingFrames:0},{type:13,name:"13_",speed:4,wakingFrames:10,dyingFrames:0},{type:14,name:"14_",speed:4,wakingFrames:13,dyingFrames:0},{type:15,name:"15_",speed:3,wakingFrames:15,dyingFrames:0},{type:16,name:"16_",speed:3,wakingFrames:10,dyingFrames:0},{type:17,name:"17_",speed:3,wakingFrames:10,dyingFrames:0},{type:18,name:"18_",speed:3,wakingFrames:7,dyingFrames:0},{type:19,name:"19_",speed:1,wakingFrames:8,dyingFrames:0},{type:20,name:"20_",speed:2,wakingFrames:10,dyingFrames:0},{type:21,name:"21_",speed:2,wakingFrames:10,dyingFrames:0},{type:22,name:"22_",speed:3,wakingFrames:19,dyingFrames:0},{type:23,name:"23_",speed:4,wakingFrames:7,dyingFrames:0},{type:24,name:"24_",speed:2,wakingFrames:14,dyingFrames:0},{type:25,name:"25_",speed:1,wakingFrames:10,dyingFrames:0},{type:26,name:"26_",speed:1,wakingFrames:30,dyingFrames:0},{type:27,name:"27_",speed:1,wakingFrames:15,dyingFrames:0},{type:28,name:"28_",speed:1,wakingFrames:30,dyingFrames:0},{type:29,name:"29_",speed:1,wakingFrames:14,dyingFrames:0},{type:30,name:"fish_com_dish",speed:4,wakingFrames:0,dyingFrames:0},{type:31,name:"fish_com_dish",speed:4,wakingFrames:0,dyingFrames:0,childID:1},{type:32,name:"fish_32_mermaid_walking_",speed:1,wakingFrames:11,dyingFrames:0},{type:33,name:"fish_32_mermaid_walking_",speed:1,wakingFrames:11,dyingFrames:0},{type:34,name:"te_thien_walking_",speed:1,wakingFrames:24,dyingFrames:0},{type:35,name:"35_",speed:4,wakingFrames:4,dyingFrames:0},{type:36,name:"36_",speed:4,wakingFrames:11,dyingFrames:0},{type:37,name:"35_",speed:8,wakingFrames:4,dyingFrames:0}]},MEM_CACHE_PATH=(ConstantsVariable.FISH_CONFIG_VIP=function(){var t=ConstantsVariable.FISH_CONFIG_NORMAL.concat([]);return t[1]={type:1,name:"VIP_1_",speed:5,wakingFrames:18,dyingFrames:0},t[3]={type:3,name:"VIP_3_",speed:5,wakingFrames:11,dyingFrames:0},t[22]={type:22,name:"VIP_22_",speed:5,wakingFrames:15,dyingFrames:0},t[14]={type:14,name:"VIP_14_",speed:5,wakingFrames:18,dyingFrames:0},t[15]={type:15,name:"VIP_15_",speed:5,wakingFrames:20,dyingFrames:0},t[6]={type:6,name:"VIP_6_",speed:5,wakingFrames:18,dyingFrames:0},t[11]={type:11,name:"VIP_11_",speed:5,wakingFrames:19,dyingFrames:0},t[13]={type:13,name:"VIP_13_",speed:5,wakingFrames:18,dyingFrames:0},t[9]={type:9,name:"VIP_9_",speed:5,wakingFrames:14,dyingFrames:0},t}(),ConstantsVariable.NAME_MAX_SHOW_LENGTH=9,ConstantsVariable.DISPATCH_EVENT_ON_CREATE_ITEM_GIFT_FOR_ME=5003,ConstantsVariable.DISPATCH_EVENT_RESET_WAITING_ACTION=5004,ConstantsVariable.DISPATCH_EVENT_SKILL_CONFIG=6e3,ConstantsVariable.DISPATCH_EVENT_SKILL_FIRE=6001,ConstantsVariable.DISPATCH_EVENT_ON_CREATE_BULLET_SKILL=6002,ConstantsVariable.DISPATCH_EVENT_ON_CREATE_SKILL_LIGHTNING=6003,ConstantsVariable.DISPATCH_EVENT_TE_THIEN_QUANG_GAY=2026,ConstantsVariable.IFishGameId=412,ConstantsVariable.RoomGameNormal=1,ConstantsVariable.RoomGameVip=3,ConstantsVariable.RoomGameTrial=5,ConstantsVariable.MiniGameVongQuay=1001,ConstantsVariable.MiniGameTaiXiu=1002,ConstantsVariable.EventVongQuayKBDD=1003,ConstantsVariable.EventVongQuaySeason=1004,ConstantsVariable.MiniGameSlot=1005,ConstantsVariable.EVENT_CODE={KHO_BAU_DAI_DUONG:"EventVongQuayMayMan",MUA_CA_GIANG_SINH:"EventQuaGiangSinh",TICH_LUY_NAP_THE:"EventTichLuyNapThe",KICH_HOAT_CODE:"EventGiftCode",UU_DAI_NAP_THE:"TinhnangNapTheLanDau",HOI_CA_MUA_XUAN:"EventHoiCaMuaXuan",SAN_LI_XI:"EventSanLiXi"},ConstantsVariable.GIFT_QUE_BOI=49,ConstantsVariable.TITTLE_SETTING="Cài Đặt",ConstantsVariable.TITTLE_DOISAO="Đổi Sao",ConstantsVariable.Messages={NOT_ENOUGHT_GOLD:"Tài khoản cần có:",NOT_ENOUGHT_LEVEL:"Tài khoản cần đạt:",EXIT_GAME:"Bạn có muốn thoát khỏi phòng không?",CLOSE_GAME:"Bạn có muốn thoát khỏi Game ?",DA_DOI_TEN:"Tài khoản này đã đổi tên hiển thị rồi.",DA_TON_TAI:"Tên hiển thị đã tồn tại",LOGOUT:"Bạn có muốn thoát khỏi game ?",ERROR:"Đã có lỗi xảy ra?",CONFIRM_CHANGE_VERSION:"Bạn muốn chuyển sang phiên bản 3D ?",EXITSLOT:"Vòng quay đang quay chưa thể thoát.",LOGOUT_ACCOUNT:"Bạn có muốn thoát khỏi tài khoản này không?",LOGOUT_SUCCESS:"Đăng xuất thành công!",EVENT_VQMM_MINIGAME:"Thể lệ:\nBắn trúng cá mập trong phòng chơi nhận được ngẫu nhiên số lượng vòng quay.\nMỗi vòng quay, người chơi có thể nhận được phần quà hấp dẫn!"},ConstantsVariable.BOMB_GUN="bg",ConstantsVariable.ELECTRIC_GUN="eg",ConstantsVariable.LAZER_GUN="lg",ConstantsVariable.BOSS_INCOMING="bossComing",ConstantsVariable.NO_HU="nh",ConstantsVariable.BOSS_IMG_INFO={TE_THIEN:{width:578,height:470},TIEN_CA:{width:920,height:512}},ConstantsVariable.ChatID=[{link:"camon",id:0},{link:"xinloinhe",id:1},{link:"banhaydo",id:2},{link:"xuiqua",id:3},{link:"ratvuiduoclamquen",id:4},{link:"tracalaiday",id:5},{link:"choxinitxu",id:6},{link:"thangroinha",id:7}],ConstantsVariable.FISH_LOBBY_INFOMATION={POSITION_LINE:{ID:0,LIST_POSITION:[{x:-70,y:0},{x:0,y:0},{x:70,y:0}]},POSITION_RANDOM:{ID:1,LIST_POSITION:[{x:-210,y:0},{x:-180,y:60},{x:-130,y:-50},{x:-140,y:10},{x:-100,y:80},{x:-55,y:0},{x:-45,y:-70},{x:-20,y:60},{x:15,y:-45},{x:25,y:5}]},FISH_NAME:["ca_cam_fr_","ca_hong_fr_","ca_soc_fr_","ca_vang_fr_"]},ConstantsVariable.FishState={WALK:0,DYING:1,SKILL:2},ConstantsVariable.TE_THIEN_SKILL={QUANG_GAY:1},ConstantsVariable.GA_LOG={SCREEN_GAME_NORMAL:"Phòng game bình thường",SCREEN_GAME_TRIAL:"Phòng game chơi thử",SCREEN_GAME_VIP:"Phòng game vip",SCREEN_MINI_GAME:"Mini game",LOGIN_NORMAL:"Đăng nhập bình thường",LOGIN_FACEBOOK:"Đăng nhập bằng facebook",REGISTER_NORMAL:"Đăng ký thường",REGISTER_FACEBOOK:"Đăng ký bằng facebook"},ConstantsVariable.TAB_NGOC=1,ConstantsVariable.TAB_VIN=0,ConstantsVariable.TAB_H_GAME=0,ConstantsVariable.TAB_H_NHAN=1,ConstantsVariable.TAB_H_TIEU=2,ConstantsVariable.MUC_TIEN_VAO_PHONG={NORMAL:0,VIP:5e5},ConstantsVariable.ConfigInApp={xu1:{id:"banca2d.xu1",xu:"100.000 Xu",money:"20.000 VNĐ"},xu2:{id:"banca2d.xu2",xu:"200.000 Xu",money:"40.000 VNĐ"},xu3:{id:"banca2d.xu3",xu:"300.000 Xu",money:"60.000 VNĐ"},xu4:{id:"banca2d.xu4",xu:"400.000 Xu",money:"80.000 VNĐ"}},ConstantsVariable.ConfigInAppIOS={xu1:{id:"banca2d.xu1",xu:"100.000 Xu",money:"22.000 VNĐ"},xu2:{id:"banca2d.xu2",xu:"200.000 Xu",money:"45.000 VNĐ"},xu3:{id:"banca2d.xu3",xu:"300.000 Xu",money:"69.000 VNĐ"},xu4:{id:"banca2d.xu4",xu:"400.000 Xu",money:"89.000 VNĐ"}},ConstantsVariable.Titile_Jackpot={NAME:"% x JACKPOT TỔNG"},ConstantsVariable.JackpotValue={VIP:[{value:1e3,title:5},{value:2e3,title:10},{value:3e3,title:15},{value:5e3,title:25},{value:7e3,title:35},{value:9e3,title:45},{value:1e4,title:50}],Normal:[{value:100,title:1},{value:300,title:3},{value:500,title:5},{value:700,title:7},{value:1e3,title:10},{value:2e3,title:20},{value:3e3,title:30}]},"temp/"),Utilities={toUTF8Array:function(t){t=unescape(encodeURIComponent(JFGameInfo.token4Master));for(var e=[],i=0;i<t.length;i++){var n=t.charCodeAt(i);n<128?e.push(n):n<2048?e.push(192|n>>6,128|63&n):n<55296||57344<=n?e.push(224|n>>12,128|n>>6&63,128|63&n):(i++,n=65536+((1023&n)<<10|1023&t.charCodeAt(i)),e.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|63&n))}return e},Coin:function(t,e){e=null==e?".":e;for(var i="",n=-1,s=(t="number"==typeof t?t.toString():t).length,r=0;r<s;r++)3==++n?(n=0,i="NaN"!=parseInt(t.charAt(s-(r+1)),10).toString()&&"-"!=t.charAt(s-(r+1))?i+(e+t.charAt(s-(r+1))):i+t.charAt(s-(r+1))):i+=t.charAt(s-(r+1));for(n="",s=i.length,r=0;r<s;r++)n+=i.charAt(s-(r+1));return n},CoinStr:function(t){var e=parseInt(t.toString().length/3),i=t.toString().length%3;switch(e){case 1:if(0==i)break;return t/1e3+"K";case 2:return 0==i?t/1e3+"K":t/1e6+"M";case 3:return 0==i?t/1e6+"M":t/1e9+"B"}return t.toString()},getConvertChairIdToClient:function(t){var e=t;return 5===t?e=3:2===t?e=1:3===t&&(e=2),e},getConvertChairIdToServer:function(t){var e=t;return 1===t?e=2:2===t?e=3:3===t&&(e=5),e},CoinString:function(t,e){var i="";return i=1<=t/1e9?(t/1e9).toFixed(2)+" Ty":1<=t/1e6?0<(i=t/1e6)%1?i.toFixed(2)+" Tr":i+" Tr":1<=t/1e5?(t/1e3&&(t/=1e3),t+" K"):Utilities.Coin(t)},getAPI:function(t,e,i){var n=!0;switch(t){case"isShowPromotion":var s=JSON.stringify({Result:2,Message:"Thành công",Data:{ListData:[]}});i(s);break;case"Login":s=JSON.stringify({Result:1,Message:"Thành công",Data:{Code:0,ErrorList:"Thành công",Data:{Nick:"dhq1uqei",FullNick:"dhq1uqei",Coin:6e3,CoinFormat:"6.000",FullCoinFormat:"6.000",EmotionPath:"4",PubUserId:2354491,SocketKey:"svm.isoftage.com:2053",TokenGame:"wuRhBeeu6cCQ7qYMmtE4GOrK5a7og8kFpTtfNubpfcHdxepKvx/GFYbp2B/amxKVUgPab74r4i1Zla+hKDAUR2k+AcdXHycUj8ADQPlcThTPJB0ecXo1l+2MJILHQJArviQS7C7Sb6XS+zKBIetxXlHnE5muKADz5LJGTJcHBmdk1bU2qY9xTLHw0FI49edwizA7u1mQ/kGHVtNAuPQSgUEdajK7aD8ownR3VZMxHpv7YFgLepeV9ByULpwT9WeGPWX0o0/pmH66YsJqSqkyNA==",TokenAPI:"ce6376c5-41c5-4f68-81aa-d5e0440811c2",AvatarDefault:"https://resource.isoftage.com/1",PromotionPatch:'[{"id":0,"status":false,"money":10000.0,"path":11},{"id":1,"status":false,"money":200000.0,"path":12},{"id":2,"status":false,"money":500000.0,"path":13}]',BorderAvatarLevel:0}}});i(s);break;case"GetListEventRunning":s=JSON.stringify({Result:1,Message:"Success",Data:[{Code:"EventTichLuyNapThe",Title:"Tích lũy nạp thẻ",Function:"Dialog.TichLuyNapThe()"},{Code:"EventGiftCode",Title:"Event gift code",Function:"Dialog.GiftCode()"}]});i(s);break;case"CheckNewInfo":s=JSON.stringify({Result:1,Message:"Kiểm tra thông tin thành công!",Data:{Reward:!0,News:!1,MailBox:!1,NewFriend:!1}});i(s);break;case"GetLink":s=JSON.stringify({Result:1,Message:"Kiểm tra thông tin thành công!",Data:{Link:"https://isoftage.com"}});i(s);break;default:n=!1}if(!n){var r,o="";for(r in e)o+=r+"="+e[r]+"&";var o="ApiName="+t+"&"+o.substring(0,o.length-1),a=cc.loader.getXMLHttpRequest();a.open("POST",PreLoaderConfig.apiPath,!0),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.onreadystatechange=function(){var t;4==a.readyState&&200<=a.status&&a.status<=207&&(t=a.responseText,JSON.parse(t),i(t))}.bind(this),a.onerror=function(){JFGameInfo.JFMain&&JFGameInfo.JFMain.layerPopup&&(JFGameInfo.JFMain.hideLoading(),JFGameInfo.JFMain.layerPopup.showPopupMsg(PreLoaderConfig.Messages.ERROR_CONNECT_SOCKET))},a.ontimeout=function(){JFGameInfo.JFMain&&JFGameInfo.JFMain.layerPopup&&(JFGameInfo.JFMain.hideLoading(),JFGameInfo.JFMain.layerPopup.showPopupMsg(PreLoaderConfig.Messages.ERROR_CONNECT_SOCKET))},a.send(o),Utilities.showLog("data : --- "+o)}},getAPIWeb:function(t,e,i){var n,s="";for(n in e)s+=n+"="+e[n]+"&";var s="ApiName="+t+"&"+s.substring(0,s.length-1),r=cc.loader.getXMLHttpRequest();r.open("POST",PreLoaderConfig.apiWeb,!0),r.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),r.onreadystatechange=function(){4==r.readyState&&200<=r.status&&r.status<=207&&i(r.responseText)}.bind(this),r.onerror=function(){JFGameInfo.JFMain&&JFGameInfo.JFMain.layerPopup&&(JFGameInfo.JFMain.hideLoading(),JFGameInfo.JFMain.layerPopup.showPopupMsg(PreLoaderConfig.Messages.ERROR_CONNECT_SOCKET))},r.ontimeout=function(){JFGameInfo.JFMain&&JFGameInfo.JFMain.layerPopup&&(JFGameInfo.JFMain.hideLoading(),JFGameInfo.JFMain.layerPopup.showPopupMsg(PreLoaderConfig.Messages.ERROR_CONNECT_SOCKET))},r.send(s),Utilities.showLog("data : --- "+s)},getAPIWithHeaders:function(t,e,i,n){JFGameInfo.JFMain.showLoading();var s,r="";for(s in e)r+=s+"="+e[s]+"&";var o,r="ApiName="+t+"&"+r.substring(0,r.length-1),a=cc.loader.getXMLHttpRequest();for(o in a.open("POST",PreLoaderConfig.apiPath,!0),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i)a.setRequestHeader(o,i[o]);a.onreadystatechange=function(){4==a.readyState&&200<=a.status&&a.status<=207&&n(a.responseText),JFGameInfo.JFMain.hideLoading()}.bind(this),a.onerror=function(){JFGameInfo.JFMain&&JFGameInfo.JFMain.layerPopup&&(JFGameInfo.JFMain.hideLoading(),JFGameInfo.JFMain.layerPopup.showPopupMsg(PreLoaderConfig.Messages.ERROR_CONNECT_SOCKET))},a.ontimeout=function(){JFGameInfo.JFMain&&JFGameInfo.JFMain.layerPopup&&(JFGameInfo.JFMain.hideLoading(),JFGameInfo.JFMain.layerPopup.showPopupMsg(PreLoaderConfig.Messages.ERROR_CONNECT_SOCKET))},a.send(r),Utilities.showLog(""+r)},formatString:function(t){for(var e=0;e<arguments.length;e++)t=t.replace(RegExp("\\{"+e+"\\}","g"),arguments[e+1]);return t},arrayMin:function(t){return Math.min.apply(Math,t)},createDataAPI:function(t){return{input:JSON.stringify(t)}},IsMobileBrowser:function(){return!0},getPropertiesFromCCS:function(t,e){t._copyProperties(e)},showLog:function(t){},getDeviceInfo:function(){var t="";return cc.sys.isNative&&(cc.sys.os===cc.sys.OS_ANDROID?t="deviceAndroid:deviceAndroid:deviceAndroid":cc.sys.os===cc.sys.OS_IOS&&(t="deviceiOS:deviceiOS:deviceiOS")),t},getPackageName:function(){return""},getSIMInfo:function(){return""},uploadImage:function(){var t,e={},i=(e.UserID=JFGameInfo.myInfo.UserID,e.packetName=JFGameInfo.packetName,e.PlatformID=ConstantsVariable.PlatformID.Web,e.AppVersion=JFGameInfo.AppVersion,e.HardwareID=JFGameInfo.devineID,e.ChannelId=JFGameInfo.ChannelID,e.VersionDevice=JFGameInfo.VersionDevice,e.DeviceModel=JFGameInfo.DeviceModel,e.Sign="UploadAvatar%s"+e.UserID+e.PlatformID+e.AppVersion+e.HardwareID+e.ChannelId+e.VersionDevice+e.DeviceModel+e.packetName+JFGameInfo.myInfo.token4Ws,"");for(t in e)i+=t+"="+e[t]+",";i.substring(0,i.length-1)},onUploadImage:function(t){1===(t=JSON.parse(t)).Result&&(cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.DISPATCH_REFRESH_AVATAR_USER,t.Data),cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.REFRESH_POPUP_USER_INFO,t.Data)),JFGameInfo.JFMain.layerPopup.showPopupMsg(t.Message)},onAndroidBackPress:function(){cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.ANDROID_SOFTKEY_BACK,null)},runJSCFromHost:function(s,t,r){Utilities.getBinaryFile(s,t,function(t){if(null!==t)try{var e,i,n;null!==jsb.fileUtils&&(i=jsb.fileUtils.getWritablePath(),e=s.match(/[^\/]*\.(\w+)$/),n=(i=i+MEM_CACHE_PATH)+e[0],jsb.fileUtils.isDirectoryExist(i)||jsb.fileUtils.createDirectory(i),jsb.fileUtils.writeDataToFile(t,n),require(n))}catch(t){}r&&"function"==typeof r&&r(t)})},runJSFromHost:function(t,e,i){t=t+"?_v="+Date.now(),cc.loader.loadJs("",[t],i)},getBinaryFile:function(t,e,i){var n="";if(null!=e){for(var s in e)n+=s+"="+e[s]+"&";t+="?"+(n=n.substring(0,n.length-1))}var r=cc.loader.getXMLHttpRequest();r.open("GET",t,!0),r.responseType="arraybuffer",r.onreadystatechange=function(){var t;4==r.readyState&&200<=r.status&&r.status<=207&&(t=new Uint8Array(r.response),i)&&"function"==typeof i&&i(t)},r.send()},getTextFile:function(t,e,i){var n="";if(null!=e){for(var s in e)n+=s+"="+e[s]+"&";n=n.substring(0,n.length-1)}var r=cc.loader.getXMLHttpRequest();r.open("GET",t,!0),r.setRequestHeader("Accept-Charset","utf-8"),r.onreadystatechange=function(){var t;4==r.readyState&&200<=r.status&&r.status<=207&&(t=r.responseText,i)&&"function"==typeof i&&i(t)},r.send(n)},ICV:function(){return JFGameInfo.AppVersion===JFGameInfo.ICG},logGA:function(t){}},screenWidth=null,screenHeight=null,gameContainerId="#Cocos2dGameContainer",oldGameWidth=null,oldGameHeight=null,JFGameInfo=(Utilities.fullScreen=function(){var t=screen.orientation||screen.mozOrientation||screen.msOrientation;document.webkitIsFullScreen||document.mozFullScreen||document.msFullscreenElement?(null==oldGameWidth&&(oldGameWidth=$(gameContainerId).width(),oldGameHeight=$(gameContainerId).height()),screenWidth=cc.sys.browserType===cc.sys.BROWSER_TYPE_IE?document.body.offsetWidth:screen.width,screenHeight=screen.height,$(gameContainerId).css({width:screenWidth+"px",height:screenHeight+"px","background-color":"background-color: rgb(0, 0, 0);"}),$("#"+cc.game.config.id).removeClass("fullscreen").css({width:screenWidth+"px",height:screenHeight+"px"}),cc.view.setDesignResolutionSize(cc.game.config.gameWidth,cc.game.config.gameHeight,cc.view._resolutionPolicy),!cc.sys.isNative&&cc.sys.isMobile&&t.lock("landscape-primary")):(!cc.sys.isNative&&cc.sys.isMobile&&t.unlock(),$(gameContainerId).css({width:oldGameWidth+"px",height:oldGameHeight+"px","background-color":""}),$("#"+cc.game.config.id).css({width:oldGameWidth+"px",height:oldGameHeight+"px"}),cc.view.setDesignResolutionSize(cc.game.config.gameWidth,cc.game.config.gameHeight,cc.view._resolutionPolicy))},Utilities.requestFullScreen=function(){var t=document.getElementsByTagName("html")[0];document.webkitIsFullScreen||document.mozFullScreen||document.msFullscreenElement?(t.style.backgroundColor="",cc.screen.exitFullScreen()):(t.style.backgroundColor="black",cc.screen.requestFullScreen()),cc.view.setDesignResolutionSize(1280,720,cc.view._resolutionPolicy)},Utilities.exitFullScreen=function(){document.getElementsByTagName("html")[0].style.backgroundColor="",cc.screen.exitFullScreen(),cc.view.setDesignResolutionSize(1280,720,cc.view._resolutionPolicy)},Utilities.setVersionResource=function(){var t,e="?v="+(PreLoaderConfig.VERSION_APP||1),i=PreLoaderConfig.pathResource||"";for(t in cc.sys.isNative&&(e=""),ResourceManager.ResourceLoadingGame)ResourceManager.ResourceLoadingGame[t].indexOf("http")<0?resourcesLoadingGame.push(i+ResourceManager.ResourceLoadingGame[t]+e):resourcesLoadingGame.push(ResourceManager.ResourceLoadingGame[t]),ResourceManager.ResourceLoadingGame[t].indexOf("http")<0&&-1<ResourceManager.ResourceLoadingGame[t].indexOf("Sound")&&(ResourceManager.ResourceLoadingGame[t]=i+ResourceManager.ResourceLoadingGame[t]);for(t in ResourceManager.JFResourcesMenuGame)ResourceManager.JFResourcesMenuGame[t].indexOf("http")<0?resourcesMenuGame.push(i+ResourceManager.JFResourcesMenuGame[t]+e):resourcesMenuGame.push(ResourceManager.JFResourcesMenuGame[t]),ResourceManager.JFResourcesMenuGame[t].indexOf("http")<0&&-1<ResourceManager.JFResourcesMenuGame[t].indexOf("Sound")&&(ResourceManager.JFResourcesMenuGame[t]=i+ResourceManager.JFResourcesMenuGame[t]);for(t in ResourceManager.JFResourcesGame)ResourceManager.JFResourcesGame[t].indexOf("http")<0?resourcesGame.push(i+ResourceManager.JFResourcesGame[t]+e):resourcesGame.push(ResourceManager.JFResourcesGame[t]),ResourceManager.JFResourcesGame[t].indexOf("http")<0&&-1<ResourceManager.JFResourcesGame[t].indexOf("Sound")&&(ResourceManager.JFResourcesGame[t]=i+ResourceManager.JFResourcesGame[t])},Utilities.cacheTextures=function(){var t,e,i,n,s,r=PreLoaderConfig.pathResource||"",o="?v="+PreLoaderConfig.VERSION_APP;for(t in cc.loader.cache)-1<t.indexOf("http")&&(s=r+(e=t.replace(o,"").replace(r,""))+o,i=r+e,cc.loader.cache[e]||(n=cc.loader.cache[i],s=cc.loader.cache[s],cc.loader.cache[e]=s||n,-1<e.indexOf(".fnt")&&(cc.loader.cache[e].atlasName=e.replace(".fnt",".png")),-1<e.indexOf(".mp3")&&(cc.loader.cache[e].src=i,cc.loader.cache[t]=cc.loader.cache[e]),-1<e.indexOf(".png")?cc.textureCache.cacheImage(e,cc.loader.cache[e]):-1<t.indexOf(".plist")&&Utilities.addSpriteFrameCache(t,e)))},Utilities.addSpriteFrameCache=function(t,e){var i=PreLoaderConfig.pathResource||"",n="?_v="+(PreLoaderConfig.VERSION_APP||1),t=t.replace(".plist",".png").replace(n,"").replace(i,""),n=i+t+n,i=i+t;cc.loader.cache[t]||(i=cc.loader.cache[i],n=cc.loader.cache[n],cc.loader.cache[t]=n||i,cc.textureCache.cacheImage(t,cc.loader.cache[t])),cc.spriteFrameCache.addSpriteFrames(e,t)},Utilities.ConvertTime=function(t){t=(r=new Date(t)).getFullYear();var e=r.getMonth()+1,i=r.getDate(),n=r.getHours(),s=r.getMinutes(),r=r.getSeconds();return 1==e.toString().length&&(e="0"+e),1==i.toString().length&&(i="0"+i),(n=1==n.toString().length?"0"+n:n)+":"+(s=1==s.toString().length?"0"+s:s)+":"+(r=1==r.toString().length?"0"+r:r)+" "+i+"/"+e+"/"+t},Utilities.arrayToString=function(t){for(var e="",i=0;i<t.length;i++)e+=String.fromCharCode(t[i]);return e},Utilities.startWorker=function(t){this.webWorker||(this.webWorker=new Worker(URL.createObjectURL(new Blob(["var onmessage=function(g){var a,b,c,d=Date.now(),e=g.data[0],f=function(){clearTimeout(a);b=Date.now();c=b-d;d=b;postMessage(c);a=setTimeout(f,e)};a=setTimeout(f,e)};"],{type:"text/javascript"}))),this.webWorker.onmessage=function(t){cc.director.mainLoop()},this.webWorker.postMessage([t]))},Utilities.stopWorker=function(){this.webWorker&&(this.webWorker.terminate(),this.webWorker=void 0)},Utilities.newSkeletonAnimation=function(t,e,i){return null!=i&&"undefine"!=i||(i=1),cc.sys.isNative?sp.SkeletonAnimation.createWithJsonFile(t,e,i):new sp.SkeletonAnimation(t,e,i)},Utilities.getTimeString=function(t){return t.getFullYear()+"."+(t.getMonth()+1)+"."+t.getDate()+"."+t.getHours()+"."+t.getMinutes()+"."+t.getSeconds()+"."+t.getMilliseconds()},Utilities.pushEventFirebase=function(t,e){},Utilities.getOSType=function(){if(!cc.sys.isNative)return"Web";switch(cc.sys.os){case cc.sys.OS_IOS:return"iOS";case cc.sys.OS_ANDROID:return"Android";default:return"Mobile"}},cc.Class.extend({ctor:function(){}})),deviceInfo=(JFGameInfo.setConfig=function(){JFGameInfo.appRealWidth=PreLoaderConfig.gameWidth,JFGameInfo.appRealHeight=PreLoaderConfig.gameHeight,JFGameInfo.AppVersion=PreLoaderConfig.AppVersion,JFGameInfo.debugMode=PreLoaderConfig.debugMode},JFGameInfo.hash=[99,51,51,51,54,55,55,48,49,53,49,49,98,52,102,54,48,50,48,101,99,54,49,100,101,100,51,53,50,48,53,57],JFGameInfo.token4Master="",JFGameInfo.token4web="",JFGameInfo.token4Game="",JFGameInfo.totalUserOnline="0",JFGameInfo.appRealWidth=1280,JFGameInfo.appRealHeight=720,JFGameInfo.AppVersion="",Utilities.getDeviceInfo().split(":")),jf;""!=deviceInfo&&null!=deviceInfo[3]&&(JFGameInfo.AppVersion=deviceInfo[3]),JFGameInfo.devineID="IdWeb",JFGameInfo.VersionDevice=9,JFGameInfo.DeviceModel="Android",JFGameInfo.debugMode=1,JFGameInfo.ChannelID=ConstantsVariable.CHANNEL_ID;try{JFGameInfo.TelcoCode=Utilities.getSIMInfo()}catch(e$$88){}try{JFGameInfo.packetName=Utilities.getPackageName()}catch(e$$89){}JFGameInfo.roomID=1,JFGameInfo.myPlatform=4,JFGameInfo.myInfo={UserID:0,DeskStation:0,Gold:0,Level:0,Exp:0,Nickname:"",token4Ws:"",token4Master:"",token4Game:"",PubUserId:null,avatarPath:"",promotionPathAvatar:null,isPaymentFirst:!1,promotionBorder:0,borderPathImage:"",avatarImage:null,listBulletID:null,itemGiftQuantity:[],Ticket:null,NickName:"",AcessToken:"",VinGold:0,listFishCatch:null,totalGold:0,totalFish:0},JFGameInfo.ServerConfig={},JFGameInfo.CurrentLayer=0,JFGameInfo.MaxPlayer=4,JFGameInfo.currentSkillActive=0,JFGameInfo.currentSkill=0,JFGameInfo.currSound=100,JFGameInfo.currMusic=100,JFGameInfo.SNG=!1,JFGameInfo.ICG=null,JFGameInfo.listDropItem=[],JFGameInfo.IMGCACHE={},JFGameInfo.bulletPool=ConstantsVariable.BulletMax,JFGameInfo.causticVisible=!1,JFGameInfo.DevVersion=!1,JFGameInfo.FISH_CONFIG=[],JFGameInfo.MusicVolume=100,JFGameInfo.EffectVolume=100,JFGameInfo.IsLoggedIn=!1,JFGameInfo.IsLoginNormal=!1,MGmd5=cc.Class.extend({}),MGmd5.safeAdd=function(t,e){var i=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(i>>16)<<16|65535&i},MGmd5.bitRotateLeft=function(t,e){return t<<e|t>>>32-e},MGmd5.md5cmn=function(t,e,i,n,s,r){return MGmd5.safeAdd(MGmd5.bitRotateLeft(MGmd5.safeAdd(MGmd5.safeAdd(e,t),MGmd5.safeAdd(n,r)),s),i)},MGmd5.md5ff=function(t,e,i,n,s,r,o){return MGmd5.md5cmn(e&i|~e&n,t,e,s,r,o)},MGmd5.md5gg=function(t,e,i,n,s,r,o){return MGmd5.md5cmn(e&n|i&~n,t,e,s,r,o)},MGmd5.md5hh=function(t,e,i,n,s,r,o){return MGmd5.md5cmn(e^i^n,t,e,s,r,o)},MGmd5.md5ii=function(t,e,i,n,s,r,o){return MGmd5.md5cmn(i^(e|~n),t,e,s,r,o)},MGmd5.binlMD5=function(t,e){t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;for(var i,n,s,r,o=1732584193,a=-271733879,c=-1732584194,h=271733878,l=0;l<t.length;l+=16)i=o,n=a,s=c,r=h,o=MGmd5.md5ff(o,a,c,h,t[l],7,-680876936),h=MGmd5.md5ff(h,o,a,c,t[l+1],12,-389564586),c=MGmd5.md5ff(c,h,o,a,t[l+2],17,606105819),a=MGmd5.md5ff(a,c,h,o,t[l+3],22,-1044525330),o=MGmd5.md5ff(o,a,c,h,t[l+4],7,-176418897),h=MGmd5.md5ff(h,o,a,c,t[l+5],12,1200080426),c=MGmd5.md5ff(c,h,o,a,t[l+6],17,-1473231341),a=MGmd5.md5ff(a,c,h,o,t[l+7],22,-45705983),o=MGmd5.md5ff(o,a,c,h,t[l+8],7,1770035416),h=MGmd5.md5ff(h,o,a,c,t[l+9],12,-1958414417),c=MGmd5.md5ff(c,h,o,a,t[l+10],17,-42063),a=MGmd5.md5ff(a,c,h,o,t[l+11],22,-1990404162),o=MGmd5.md5ff(o,a,c,h,t[l+12],7,1804603682),h=MGmd5.md5ff(h,o,a,c,t[l+13],12,-40341101),c=MGmd5.md5ff(c,h,o,a,t[l+14],17,-1502002290),a=MGmd5.md5ff(a,c,h,o,t[l+15],22,1236535329),o=MGmd5.md5gg(o,a,c,h,t[l+1],5,-165796510),h=MGmd5.md5gg(h,o,a,c,t[l+6],9,-1069501632),c=MGmd5.md5gg(c,h,o,a,t[l+11],14,643717713),a=MGmd5.md5gg(a,c,h,o,t[l],20,-373897302),o=MGmd5.md5gg(o,a,c,h,t[l+5],5,-701558691),h=MGmd5.md5gg(h,o,a,c,t[l+10],9,38016083),c=MGmd5.md5gg(c,h,o,a,t[l+15],14,-660478335),a=MGmd5.md5gg(a,c,h,o,t[l+4],20,-405537848),o=MGmd5.md5gg(o,a,c,h,t[l+9],5,568446438),h=MGmd5.md5gg(h,o,a,c,t[l+14],9,-1019803690),c=MGmd5.md5gg(c,h,o,a,t[l+3],14,-187363961),a=MGmd5.md5gg(a,c,h,o,t[l+8],20,1163531501),o=MGmd5.md5gg(o,a,c,h,t[l+13],5,-1444681467),h=MGmd5.md5gg(h,o,a,c,t[l+2],9,-51403784),c=MGmd5.md5gg(c,h,o,a,t[l+7],14,1735328473),a=MGmd5.md5gg(a,c,h,o,t[l+12],20,-1926607734),o=MGmd5.md5hh(o,a,c,h,t[l+5],4,-378558),h=MGmd5.md5hh(h,o,a,c,t[l+8],11,-2022574463),c=MGmd5.md5hh(c,h,o,a,t[l+11],16,1839030562),a=MGmd5.md5hh(a,c,h,o,t[l+14],23,-35309556),o=MGmd5.md5hh(o,a,c,h,t[l+1],4,-1530992060),h=MGmd5.md5hh(h,o,a,c,t[l+4],11,1272893353),c=MGmd5.md5hh(c,h,o,a,t[l+7],16,-155497632),a=MGmd5.md5hh(a,c,h,o,t[l+10],23,-1094730640),o=MGmd5.md5hh(o,a,c,h,t[l+13],4,681279174),h=MGmd5.md5hh(h,o,a,c,t[l],11,-358537222),c=MGmd5.md5hh(c,h,o,a,t[l+3],16,-722521979),a=MGmd5.md5hh(a,c,h,o,t[l+6],23,76029189),o=MGmd5.md5hh(o,a,c,h,t[l+9],4,-640364487),h=MGmd5.md5hh(h,o,a,c,t[l+12],11,-421815835),c=MGmd5.md5hh(c,h,o,a,t[l+15],16,530742520),a=MGmd5.md5hh(a,c,h,o,t[l+2],23,-995338651),o=MGmd5.md5ii(o,a,c,h,t[l],6,-198630844),h=MGmd5.md5ii(h,o,a,c,t[l+7],10,1126891415),c=MGmd5.md5ii(c,h,o,a,t[l+14],15,-1416354905),a=MGmd5.md5ii(a,c,h,o,t[l+5],21,-57434055),o=MGmd5.md5ii(o,a,c,h,t[l+12],6,1700485571),h=MGmd5.md5ii(h,o,a,c,t[l+3],10,-1894986606),c=MGmd5.md5ii(c,h,o,a,t[l+10],15,-1051523),a=MGmd5.md5ii(a,c,h,o,t[l+1],21,-2054922799),o=MGmd5.md5ii(o,a,c,h,t[l+8],6,1873313359),h=MGmd5.md5ii(h,o,a,c,t[l+15],10,-30611744),c=MGmd5.md5ii(c,h,o,a,t[l+6],15,-1560198380),a=MGmd5.md5ii(a,c,h,o,t[l+13],21,1309151649),o=MGmd5.md5ii(o,a,c,h,t[l+4],6,-145523070),h=MGmd5.md5ii(h,o,a,c,t[l+11],10,-1120210379),c=MGmd5.md5ii(c,h,o,a,t[l+2],15,718787259),a=MGmd5.md5ii(a,c,h,o,t[l+9],21,-343485551),o=MGmd5.safeAdd(o,i),a=MGmd5.safeAdd(a,n),c=MGmd5.safeAdd(c,s),h=MGmd5.safeAdd(h,r);return[o,a,c,h]},MGmd5.binl2rstr=function(t){for(var e="",i=32*t.length,n=0;n<i;n+=8)e+=String.fromCharCode(t[n>>5]>>>n%32&255);return e},MGmd5.rstr2binl=function(t){var e=[];for(e[(t.length>>2)-1]=void 0,n=0;n<e.length;n+=1)e[n]=0;for(var i=8*t.length,n=0;n<i;n+=8)e[n>>5]|=(255&t.charCodeAt(n/8))<<n%32;return e},MGmd5.rstrMD5=function(t){return MGmd5.binl2rstr(MGmd5.binlMD5(MGmd5.rstr2binl(t),8*t.length))},MGmd5.rstrHMACMD5=function(t,e){var i,n=MGmd5.rstr2binl(t),s=[],r=[];for(s[15]=r[15]=void 0,16<n.length&&(n=MGmd5.binlMD5(n,8*t.length)),i=0;i<16;i+=1)s[i]=909522486^n[i],r[i]=1549556828^n[i];return i=MGmd5.binlMD5(s.concat(md5.rstr2binl(e)),512+8*e.length),MGmd5.binl2rstr(MGmd5.binlMD5(r.concat(i),640))},MGmd5.rstr2hex=function(t){for(var e,i="",n=0;n<t.length;n+=1)e=t.charCodeAt(n),i+="0123456789abcdef".charAt(e>>>4&15)+"0123456789abcdef".charAt(15&e);return i},MGmd5.str2rstrUTF8=function(t){return unescape(encodeURIComponent(t))},MGmd5.rawMD5=function(t){return MGmd5.rstrMD5(MGmd5.str2rstrUTF8(t))},MGmd5.hexMD5=function(t){return MGmd5.rstr2hex(MGmd5.rawMD5(t))},MGmd5.rawHMACMD5=function(t,e){return MGmd5.rstrHMACMD5(MGmd5.str2rstrUTF8(t),MGmd5.str2rstrUTF8(e))},MGmd5.hexHMACMD5=function(t,e){return MGmd5.rstr2hex(MGmd5.rawHMACMD5(t,e))},MGmd5.encscript=function(t,e,i){return e?i?MGmd5.rawHMACMD5(e,t):MGmd5.hexHMACMD5(e,t):i?MGmd5.rawMD5(t):MGmd5.hexMD5(t)},jf={},jf.sys=new function(){var t=this;t.getIsMobile=function(){return cc.sys.isMobile},t.isIOS=function(){return cc.sys.os===cc.sys.OS_IOS},t.isIOSNative=function(){return cc.sys.isNative&&t.isIOS()},t.isAndroid=function(){return cc.sys.os===cc.sys.OS_ANDROID},t.isAndroidNative=function(){return cc.sys.isNative&&t.isAndroid()},t.isWindows=function(){return cc.sys.os===cc.sys.OS_WINDOWS},t.isWindowsNative=function(){return cc.sys.isNative&&t.isWindows()},t.isMacOS=function(){return cc.sys.os===cc.sys.OS_OSX},t.isMacOSNative=function(){return cc.sys.isNative&&t.isMacOS()},t.getLanguage=function(){return cc.sys.language},t.getBrowserType=function(){return cc.sys.browserType},t.getCapabilities=function(){return JSON.stringify(t.capabilities)},t.getOS=function(){return cc.sys.os},t.getPlatform=function(){return cc.sys.platform},t.isObjectValid=function(t){return cc.sys.isObjectValid(t)}},jf.fn=new function(){var o=this;return o.convertNumber=function(t){return void 0===t?"":((t=t.toString().split("."))[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,"."),t.join("."))},o.isObject=function(t){return"[object Object]"===Object.prototype.toString.call(t)},o.isFunction=function(t){return"function"==typeof t},o.isBoolean=function(t){return"boolean"==typeof t},o.isNumber=function(t){return"number"==typeof t||"[object Number]"===Object.prototype.toString.call(t)},o.isInteger=function(t){return o.isNumber(t)&&Math.floor(t)===t},o.isFloat=function(t){return!o.isInteger(t)&&o.isNumber(t)},o.isString=function(t){return"string"==typeof t||"[object String]"===Object.prototype.toString.call(t)},o.isUndefined=function(t){return void 0===t},o.isObject=function(t){return"object"==typeof t&&"[object Object]"===Object.prototype.toString.call(t)},o.isArray=function(t){return Array.isArray(t)||"object"==typeof t&&"[object Array]"===Object.prototype.toString.call(t)},o.sortArray=function(t,e){cc.assert(o.isArray(t),"JFFunction.sortArray() : array invalid!");e=o.isUndefined(e)||!0===e?function(t,e){return e<t}:function(t,e){return t<e};return t.sort(e),t},o.copyArray=function(t,e){var i,n=t.length,s=Array(n);if(e)for(i=n-1;0<=i;--i)s[i]=t[i];else for(i=0;i<n;i+=1)s[i]=t[i];return s},o.toInt=function(t,e){return parseInt(t,void 0===e?10:e)},o.toFloat=function(t){return parseFloat(t)},o.toNumber=function(t){return Number(t)},o.toBoolean=function(t){return!!t},o.parseRGB=function(t){for(var e=[],i=0;i<3;i++)e.push(parseInt(t.substr(2*i,2),16));return cc.color(e[0],e[1],e[2])},o.dumpObject=function(t,e){for(var i in t)!0===e?t.hasOwnProperty(i):!1===e&&t.propertyIsEnumerable(i)},o.objToString=function(t){var e=typeof t;if("object"!==e||null===t)"string"===e&&(t='"'+t+'"'),t=String(t);else{if(t instanceof Date)return t.toLocaleString();var i,n,s=[],r=t&&t.constructor===Array;for(i in t)n=t[i],e=typeof n,"string"===e?n='"'+n+'"':"object"===e&&null!==n&&(n=o.objToString(n)),s.push((r?"":'"'+i+'":')+String(n));t=(r?"[":"{")+String(s)+(r?"]":"}")}return t},o},!function(){function s(){throw"done is already call!"}function r(){throw"fail is already call!"}jf.fn.createSequenceFunc=function(t){var e,i,n=[];return n.index=0,n.obj=t=void 0===t?{}:t,(e=function(t){var e,i,n,s,r,o,a,c,h;if(!(this.index>=this.length))if(i=(e=this[this.index++])[0],e[0]=null,t)this.fail&&this.fail(t);else{for(t=this.obj,n=0;n<e.length;++n){if("string"==typeof(s=e[n])&&"$"===s[0]){for(a=t,h=!(c=["obj"]),r=s.substring(1).split("."),o=0;o<r.length;++o){if(!a){h=!0;break}a=a[r[o]],c.push(r[o])}h||(s=a)}e[n]=s}cc.assert(i,"function is undefined!"),Function.prototype.call.apply(i,e)}}.bind(n)).obj=t,(i=function(){e()}).then=function(t){return n.push([t,e].concat(Array.prototype.slice.call(arguments,1))),i},i.done=function(t){return n.push([t,0].concat(Array.prototype.slice.call(arguments,1))),i.then=s,i.done=s,i},i.fail=function(t){return n.fail=t,i.then=r,i.fail=r,i},i}}(),jf.fn.callNextFrame=function(t){cc.director.getScheduler().schedule(function(){t()},{},0,0,0,!1)},jf.fn.delayCall=function(t,e,i){i=i||{},0===e?t():cc.director.getScheduler().schedule(t,i,0,0,e,!1)},jf.fn.callback=function(t){return cc.assert(t instanceof Function,"jf.callback() : callback Invalid!"),Function.prototype.bind.apply(t,arguments)},jf.fn.emptyFunc=function(){return null},jf.audio=new function(){var n=this,s=cc.audioEngine,r="true",o="true";n._init=function(){var t=cc.sys.localStorage.getItem("__m2_music_volume");n.setMusicVolume(t||100,!0),r=cc.sys.localStorage.getItem("__m2_music_enabled")||"true",n.setMusicEnabled(r,!0),t=cc.sys.localStorage.getItem("__m2_effect_volume"),n.setEffectsVolume(t||100,!0),o=cc.sys.localStorage.getItem("__m2_effect_enabled")||"true",n.setEffectEnabled(o,!0)},n.playMusic=function(t,e,i){if(i=i||!0,"false"!==r)return 0<e&&n.setMusicVolume(.01*e),s.playMusic(""+t,i);cc.warn("jf.audio.playMusic() : 【音乐】没有开启!")},n.stopMusic=function(t){return s.stopMusic(t)},n.pauseMusic=function(){return s.pauseMusic()},n.resumeMusic=function(t,e){return void 0!==t&&(cc.assert(jf.fn.isNumber(t)&&0<=t&&t<=100,"JFAudio.resumeMusic() : volume 必须是一个 >= 0 && <= 100的数值"),n.setMusicVolume(t,e)),s.resumeMusic()},n.rewindMusic=function(){return s.rewindMusic()},n.getMusicVolume=function(){return 100*s.getMusicVolume()},n.setMusicVolume=function(t,e){return t=Math.floor(t),void 0!==(e=e||!1)&&cc.assert(jf.fn.isBoolean(e),"jf.audio.setMusicVolume() : isSaveToNative必须是Boolean类型！"),e&&cc.sys.localStorage.setItem("__m2_music_volume",t),s.setMusicVolume(.01*t)},n.isMusicPlaying=function(){return s.isMusicPlaying()},n.willPlayMusic=function(){return s.willPlayMusic()},n.isEffectEnabled=function(){return o},n.setEffectEnabled=function(t,e){e&&cc.sys.localStorage.setItem("__m2_effect_enabled",String(t)),o=String(t)},n.isMusicEnabled=function(){return r},n.setMusicEnabled=function(t,e){e&&cc.sys.localStorage.setItem("__m2_music_enabled",String(t)),r=String(t)},n.playEffect=function(t,e,i){return"false"===o?(cc.warn("jf.audio.playEffect() : 【音效】没有开启！"),null):(0<e&&n.setEffectsVolume(.01*e),s.playEffect(t,i))},n.setEffectsVolume=function(t,e){return t=Math.floor(t),void 0!==(e=e||!1)&&cc.assert(jf.fn.isBoolean(e),"jf.audio.setEffectsVolume() : isSaveToNative必须是Boolean类型！"),e&&cc.sys.localStorage.setItem("__m2_effect_volume",t),s.setEffectsVolume(.01*t)},n.getEffectsVolume=function(){return 100*s.getEffectsVolume()},n.pauseEffect=function(t){return s.pauseEffect(t)},n.pauseAllEffects=function(){return s.pauseAllEffects()},n.resumeEffect=function(t){return s.resumeEffect(t)},n.resumeAllEffects=function(){return s.resumeAllEffects()},n.stopEffect=function(t){return s.stopEffect(t)},n.stopAllEffects=function(){return s.stopAllEffects()},n.unloadEffect=function(t){return s.unloadEffect(t)},n.end=function(){return s.end()},n._init()},jf.math=new function(){var f=this;f.randomBetween=function(t,e){return t+(e-t)*Math.random()},f.randomFloorBetween=function(t,e){return Math.floor(f.randomBetween(t,e))},f.randomCeilBetween=function(t,e){return Math.ceil(f.randomBetween(t,e))},f.randomRoundBetween=function(t,e){return Math.round(f.randomBetween(t,e))},f.random0Or1=function(){return Math.round(Math.random())},f.randomIntegerLess=function(t){return f.randomFloorBetween(0,t)},f.randomIntegerGreater=function(t){return f.randomFloorBetween(t,Number.MAX_VALUE)},f.randomExcept=function(t,e,i,n){!0===n&&m2.fn.sortArray(i);for(var s,r=f.randomRoundBetween(t,e);;){for(s=!1,n=0;n<i.length;n++)r===i[n]&&(s=!0);if(!s)break;r=f.randomRoundBetween(t,e)}return r},f.getGreatestCommonDivisor=function(t,e){for(var i;0!=t%e;)i=t%e,t=e,e=i;return e},f.getCommonMultiple=function(t,e){return t*e/f.getGreatestCommonDivisor(t,e)},f.toMathAngle=function(t){for(t=90-t;t<0;)t+=360;for(;360<t;)t-=360;return t},f.toCocosAngle=function(t){return f.toMathAngle(t)},f.getRotation=function(t,e){return f.toMathAngle(f.getAngle(e,t))},f.getAngle=function(t,e){e=cc.pToAngle(cc.pSub(e,t));return cc.radiansToDegrees(e)},f.isPointInCircle=function(t,e,i){return Math.abs(cc.pDistance(t,e))<=i},f.isCircleIntersectCircle=function(t,e,i,n){return(t.x-i.x)*(t.x-i.x)+(t.y-i.y)*(t.y-i.y)<=(e+n)*(e+n)},f.getKByAngle=function(t){return Math.tan(cc.degreesToRadians(t))},f.getK=function(t,e){return(e.y-t.y)/(e.x-t.x)},f.getYByPosAndK=function(t,e,i){return i*(e-t.x)+t.y},f.getXByPosAndK=function(t,e,i){return(e-t.y)/i+t.x},f.getRayPoint=function(t,e,i){e=f.toMathAngle(e);var n=(n=i.height-t.y)/Math.tan(cc.degreesToRadians(e)),s=cc.p(t.x+n,i.height);return e<0&&e<=90&&(n=t.y,n/=Math.tan(cc.degreesToRadians(-e)),s.x=t.x+n,s.y=i.y),s.x<0?(n=t.x*Math.tan(cc.degreesToRadians(180-e)),s.y=t.y+n,s.x=i.x):s.x>i.width&&(n=i.width-t.x,n*=Math.tan(cc.degreesToRadians(e)),s.x=i.width,s.y=t.y+n),s},f.getHitPoint=function(t,e,i){var n,s,r,o,a,c,h,l,u,d,_,p={};return 90===(i=f.toMathAngle(i))?(p.x=e.x,p.y=t.y+t.height,p.angle=f.toCocosAngle(270)):180===i?(p.x=t.x,p.y=e.y,p.angle=f.toCocosAngle(0)):270===i?(p.x=e.x,p.y=t.y,p.angle=f.toCocosAngle(90)):0===i?(p.x=t.x+t.width,p.y=e.y,p.angle=f.toCocosAngle(180)):(n=f.getKByAngle(i),s=f.getXByPosAndK(e,t.y+t.height,n),r=t.y+t.height,o=f.toCocosAngle(360-i),a=t.x,c=f.getYByPosAndK(e,t.x,n),h=f.toCocosAngle(180-i),l=f.getXByPosAndK(e,t.y,n),u=t.y,d=f.toCocosAngle(360-i),_=t.x+t.width,e=f.getYByPosAndK(e,t.x+t.width,n),n=f.toCocosAngle(180-i),0<i&&i<90?s<t.x+t.width?(p.x=s,p.y=r,p.angle=o):(p.x=_,p.y=e,p.angle=n):90<i&&i<180?s>t.x?(p.x=s,p.y=r,p.angle=o):(p.x=a,p.y=c,p.angle=h):180<i&&i<270?l>t.x?(p.x=l,p.y=u,p.angle=d):(p.x=a,p.y=c,p.angle=h):l<t.x+t.width?(p.x=l,p.y=u,p.angle=d):(p.x=_,p.y=e,p.angle=n)),p}},jf.action=new function(){var c=this;return c.hit=function(t,e,i,n,s,r){var o,a;return i=0<r?(n=jf.math.getHitPoint(e,i,n),o=n.angle,a=cc.p(n.x,n.y),i=cc.pDistance(i,a),cc.sequence(cc.moveTo(i/s,a),cc.callFunc(function(){t.rotation=o,t.runAction(c.hit(t,e,a,o,s,r-1))}))):null},c.hitRepeatForever=function(t,e,i,n,s){return c.hit(t,e,i,n,s,Number.MAX_VALUE)},c.popShow=function(t,e){t.setScale(0),t.runAction(cc.sequence(cc.scaleTo(.4,1).easing(cc.easeBackOut()),cc.callFunc(jf.fn.isFunction(e)||jf.fn.empty)))},c.popExit=function(t,e){e=cc.sequence(cc.scaleTo(.1,0).easing(cc.easeBackIn()),cc.callFunc(jf.fn.isFunction(e)||jf.fn.empty),cc.removeSelf());t.runAction(e)},c},jf.CircleBy=cc.ScaleBy.extend({_center:cc.p(0,0),_radius:0,_radian:0,_moveTimes:1,_firstCall:!0,_duration:0,_fishDegree:0,_vDegree:0,ctor:function(t,e,i,n){cc.ScaleBy.prototype.ctor.call(this),this.initWithDuration(t,e,i,n)},initWithDuration:function(t,e,i,n){return!!cc.ScaleBy.prototype.initWithDuration.call(this,t,1)&&(this._center=e,this._radius=i,this._duration=t,this._fishDegree=n,e=cc.director.getAnimationInterval(),this._radian=n/t/cc.director.getAnimationInterval()*Math.PI/180,this._vDegree=this._fishDegree=n/t*e,this._radian=this._fishDegree*Math.PI/180,!(this._moveTimes=0))},startWithTarget:function(t){cc.ScaleBy.prototype.startWithTarget.call(this,t),t=cc.pSub(cc.p(t.x,t.y),this._center),t=cc.radiansToDegrees(cc.pToAngle(t)),this._moveTimes=60*t*this._duration/360,this._moveTimes=360/this._duration*t/60},update:function(t){var e;!0===this._firstCall?(this.startWithTarget(this.getTarget()),this._firstCall=!1):this.getTarget()&&(t=cc.pSub(cc.p(this.getTarget().x,this.getTarget().y),this._center),e=(cc.radiansToDegrees(cc.pToAngle(t))-this._vDegree)*Math.PI/180,t=this._radius*Math.cos(e),e=this._radius*Math.sin(e),t=cc.p(t+this._center.x,e+this._center.y),this.getTarget().setPosition(t),this._moveTimes+=1)}}),jf.circleBy=function(t,e,i,n){return new jf.CircleBy(t,e,i,n)},jf.CircleZBy=cc.ScaleBy.extend({_center:cc.p(0,0),_radius:0,_radian:0,_moveTimes:1,_firstCall:!0,_duration:0,_fishDegree:0,_vDegree:0,ctor:function(t,e,i,n){cc.ScaleBy.prototype.ctor.call(this),this.initWithDuration(t,e,i,n)},initWithDuration:function(t,e,i,n){return!!cc.ScaleBy.prototype.initWithDuration.call(this,t,1)&&(this._center=e,this._radius=i,this._duration=t,this._fishDegree=n,e=cc.director.getAnimationInterval(),this._radian=n/t/cc.director.getAnimationInterval()*Math.PI/180,this._vDegree=this._fishDegree=n/t*e,this._radian=this._fishDegree*Math.PI/180,!(this._moveTimes=0))},startWithTarget:function(t){cc.ScaleBy.prototype.startWithTarget.call(this,t),t=cc.pSub(cc.p(t.x,t.z),this._center),t=cc.radiansToDegrees(cc.pToAngle(t)),this._moveTimes=60*t*this._duration/360,this._moveTimes=360/this._duration*t/60},update:function(t){var e;!0===this._firstCall?(this.startWithTarget(this.getTarget()),this._firstCall=!1):this.getTarget()&&(t=cc.pSub(cc.p(this.getTarget().x,this.getTarget().getPosition3D().z),this._center),e=(cc.radiansToDegrees(cc.pToAngle(t))-this._vDegree)*Math.PI/180,t=this._radius*Math.cos(e),e=this._radius*Math.sin(e),t=cc.p(t+this._center.x,e+this._center.y),this.getTarget().setPosition3D(cc.math.vec3(t.x,this.getTarget().y,t.y)),this._moveTimes+=1)}}),jf.circleZBy=function(t,e,i,n){return new jf.CircleZBy(t,e,i,n)},jf.Shake=cc.ScaleBy.extend({_duration:0,_strengthX:0,_strengthY:0,_startPos:cc.p(0,0),ctor:function(t,e,i,n){cc.ScaleBy.prototype.ctor.call(this),this.initWithDuration(t,e,i,n)},initWithDuration:function(t,e,i,n){return!!cc.ScaleBy.prototype.initWithDuration.call(this,t,1)&&(this._startPos=e,this._strengthX=i,this._strengthY=void 0===n?i:n,!0)},update:function(t){t=-this._strengthX+jf.math.randomBetween(0,this._strengthX);var e=-this._strengthY+jf.math.randomBetween(0,this._strengthY);t=cc.pAdd(cc.p(this._startPos.x,this._startPos.y),cc.p(t,e)),this.getTarget().setPosition(t)}}),jf.shake=function(t,e,i,n){return new jf.Shake(t,e,i,n)},!function(){cc.Node.prototype.setTouchEnable=function(t){var e=0;try{for(var i=this.getChildren(),e=0;e<i.length;e++)i[e].setTouchEnable(t);this.__touchListener&&this.__touchListener.setEnabled(t)}catch(t){}};var e=cc.Node.prototype.setVisible;cc.Node.prototype.setVisible=function(t){try{this.setTouchEnable(t),e.call(this,t)}catch(t){}},cc.Node.prototype.getPositionByAnchorPoint=function(t){return cc.p(this.width*t.x,this.height*t.y)},cc.Node.prototype.getPositionByAnchorInDesNode=function(t,e){e=this.convertToWorldSpace(this.getPositionByAnchorPoint(e));return t.convertToNodeSpace(e)},cc.Node.prototype.getPositionInDesNode=function(t){return this.getPositionByAnchorInDesNode(t,this.getAnchorPoint())},cc.Node.prototype.setAnchorPointAndUpdatePosition=function(t){var e=this.getContentSize(),i=this.getAnchorPoint(),n=this.getPosition(),s=this.getScale(),i=cc.p(n.x-e.width*i.x*s,n.y-e.height*i.y*s),i=cc.p(i.x+e.width*t.x*s,i.y+e.height*t.y*s);this.setPosition(i),this.setAnchorPoint(t)},cc.Node.prototype.addChildToCenter=function(t){this.addChild(t),t.setPosition(this.width/2,this.height/2)},cc.Node.prototype.addChildToAnchorPoint=function(t,e,i){cc.assert(t instanceof cc.Node,"cc.Node.addChildToAnchorPosition() : child is invalid!"),i=i||cc.p(0,0),t.setPosition(cc.pAdd(this.getPositionByAnchorPoint(e),i)),this.addChild(t)},cc.Node.prototype.isInScreen=function(){var t=!1;return t=0<=this.getPositionX()&&this.getPositionX()<=cc.winSize.width&&0<=this.getPositionY()&&this.getPositionY()<=cc.winSize.height?!0:t}}(),cc.ActionInterval.prototype.easeIn=function(t){return new cc.EaseIn(this,void 0===t?2:t)},cc.ActionInterval.prototype.easeOut=function(t){return new cc.EaseOut(this,void 0===t?2:t)},cc.ActionInterval.prototype.easeInOut=function(t){return new cc.EaseInOut(this,void 0===t?2:t)},cc.ActionInterval.prototype.easeExponentialIn=function(){return new cc.EaseExponentialIn(this)},cc.ActionInterval.prototype.easeExponentialOut=function(){return new cc.EaseExponentialOut(this)},cc.ActionInterval.prototype.easeExponentialInOut=function(){return new cc.EaseExponentialInOut(this)},cc.ActionInterval.prototype.easeSineIn=function(){return new cc.EaseSineIn(this)},cc.ActionInterval.prototype.easeSineOut=function(){return new cc.EaseSineOut(this)},cc.ActionInterval.prototype.easeSineInOut=function(){return new cc.EaseSineInOut(this)},cc.ActionInterval.prototype.easeElasticIn=function(t){return new cc.EaseElasticIn(this,void 0===t?.3:t)},cc.ActionInterval.prototype.easeElasticOut=function(t){return new cc.EaseElasticOut(this,void 0===t?.3:t)},cc.ActionInterval.prototype.easeElasticInOut=function(t){return new cc.EaseElasticInOut(this,void 0===t?.3:t)},cc.ActionInterval.prototype.easeBounceIn=function(){return new cc.EaseBounceIn(this)},cc.ActionInterval.prototype.easeBounceOut=function(){return new cc.EaseBounceOut(this)},cc.ActionInterval.prototype.easeBounceInOut=function(){return new cc.EaseBounceInOut(this)},cc.ActionInterval.prototype.easeBackIn=function(){return new cc.EaseBackIn(this)},cc.ActionInterval.prototype.easeBackOut=function(){return new cc.EaseBackOut(this)},cc.ActionInterval.prototype.easeBackInOut=function(){return new cc.EaseBackInOut(this)},cc.ActionInterval.prototype.easeBezierAction=function(){return new cc.EaseBezierAction(this)},cc.ActionInterval.prototype.easeQuadraticActionIn=function(){return new cc.EaseQuadraticActionIn(this)},cc.ActionInterval.prototype.easeQuadraticActionOut=function(){return new cc.EaseQuadraticActionOut(this)},cc.ActionInterval.prototype.easeQuadraticActionInOut=function(){return new cc.EaseQuadraticActionInOut(this)},cc.ActionInterval.prototype.easeQuarticActionIn=function(){return new cc.EaseQuarticActionIn(this)},cc.ActionInterval.prototype.easeQuarticActionOut=function(){return new cc.EaseQuarticActionOut(this)},cc.ActionInterval.prototype.easeQuarticActionInOut=function(){return new cc.EaseQuarticActionInOut(this)},cc.ActionInterval.prototype.easeQuinticActionIn=function(){return new cc.EaseQuinticActionIn(this)},cc.ActionInterval.prototype.easeQuinticActionOut=function(){return new cc.EaseQuinticActionOut(this)},cc.ActionInterval.prototype.easeQuinticActionInOut=function(){return new cc.EaseQuinticActionInOut(this)},cc.ActionInterval.prototype.easeCircleActionIn=function(){return new cc.EaseCircleActionIn(this)},cc.ActionInterval.prototype.easeCircleActionOut=function(){return new cc.EaseCircleActionOut(this)},cc.ActionInterval.prototype.easeCircleActionInOut=function(){return new cc.EaseCircleActionInOut(this)},cc.ActionInterval.prototype.easeCubicActionIn=function(){return new cc.EaseCubicActionIn(this)},cc.ActionInterval.prototype.easeCubicActionOut=function(){return new cc.EaseCubicActionOut(this)},cc.ActionInterval.prototype.easeCubicActionInOut=function(){return new cc.EaseCubicActionInOut(this)},md5=cc.Class.extend({}),md5.safeAdd=function(t,e){var i=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(i>>16)<<16|65535&i},md5.bitRotateLeft=function(t,e){return t<<e|t>>>32-e},md5.md5cmn=function(t,e,i,n,s,r){return md5.safeAdd(md5.bitRotateLeft(md5.safeAdd(md5.safeAdd(e,t),md5.safeAdd(n,r)),s),i)},md5.md5ff=function(t,e,i,n,s,r,o){return md5.md5cmn(e&i|~e&n,t,e,s,r,o)},md5.md5gg=function(t,e,i,n,s,r,o){return md5.md5cmn(e&n|i&~n,t,e,s,r,o)},md5.md5hh=function(t,e,i,n,s,r,o){return md5.md5cmn(e^i^n,t,e,s,r,o)},md5.md5ii=function(t,e,i,n,s,r,o){return md5.md5cmn(i^(e|~n),t,e,s,r,o)},md5.binlMD5=function(t,e){t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;for(var i,n,s,r,o=1732584193,a=-271733879,c=-1732584194,h=271733878,l=0;l<t.length;l+=16)i=o,n=a,s=c,r=h,o=md5.md5ff(o,a,c,h,t[l],7,-680876936),h=md5.md5ff(h,o,a,c,t[l+1],12,-389564586),c=md5.md5ff(c,h,o,a,t[l+2],17,606105819),a=md5.md5ff(a,c,h,o,t[l+3],22,-1044525330),o=md5.md5ff(o,a,c,h,t[l+4],7,-176418897),h=md5.md5ff(h,o,a,c,t[l+5],12,1200080426),c=md5.md5ff(c,h,o,a,t[l+6],17,-1473231341),a=md5.md5ff(a,c,h,o,t[l+7],22,-45705983),o=md5.md5ff(o,a,c,h,t[l+8],7,1770035416),h=md5.md5ff(h,o,a,c,t[l+9],12,-1958414417),c=md5.md5ff(c,h,o,a,t[l+10],17,-42063),a=md5.md5ff(a,c,h,o,t[l+11],22,-1990404162),o=md5.md5ff(o,a,c,h,t[l+12],7,1804603682),h=md5.md5ff(h,o,a,c,t[l+13],12,-40341101),c=md5.md5ff(c,h,o,a,t[l+14],17,-1502002290),a=md5.md5ff(a,c,h,o,t[l+15],22,1236535329),o=md5.md5gg(o,a,c,h,t[l+1],5,-165796510),h=md5.md5gg(h,o,a,c,t[l+6],9,-1069501632),c=md5.md5gg(c,h,o,a,t[l+11],14,643717713),a=md5.md5gg(a,c,h,o,t[l],20,-373897302),o=md5.md5gg(o,a,c,h,t[l+5],5,-701558691),h=md5.md5gg(h,o,a,c,t[l+10],9,38016083),c=md5.md5gg(c,h,o,a,t[l+15],14,-660478335),a=md5.md5gg(a,c,h,o,t[l+4],20,-405537848),o=md5.md5gg(o,a,c,h,t[l+9],5,568446438),h=md5.md5gg(h,o,a,c,t[l+14],9,-1019803690),c=md5.md5gg(c,h,o,a,t[l+3],14,-187363961),a=md5.md5gg(a,c,h,o,t[l+8],20,1163531501),o=md5.md5gg(o,a,c,h,t[l+13],5,-1444681467),h=md5.md5gg(h,o,a,c,t[l+2],9,-51403784),c=md5.md5gg(c,h,o,a,t[l+7],14,1735328473),a=md5.md5gg(a,c,h,o,t[l+12],20,-1926607734),o=md5.md5hh(o,a,c,h,t[l+5],4,-378558),h=md5.md5hh(h,o,a,c,t[l+8],11,-2022574463),c=md5.md5hh(c,h,o,a,t[l+11],16,1839030562),a=md5.md5hh(a,c,h,o,t[l+14],23,-35309556),o=md5.md5hh(o,a,c,h,t[l+1],4,-1530992060),h=md5.md5hh(h,o,a,c,t[l+4],11,1272893353),c=md5.md5hh(c,h,o,a,t[l+7],16,-155497632),a=md5.md5hh(a,c,h,o,t[l+10],23,-1094730640),o=md5.md5hh(o,a,c,h,t[l+13],4,681279174),h=md5.md5hh(h,o,a,c,t[l],11,-358537222),c=md5.md5hh(c,h,o,a,t[l+3],16,-722521979),a=md5.md5hh(a,c,h,o,t[l+6],23,76029189),o=md5.md5hh(o,a,c,h,t[l+9],4,-640364487),h=md5.md5hh(h,o,a,c,t[l+12],11,-421815835),c=md5.md5hh(c,h,o,a,t[l+15],16,530742520),a=md5.md5hh(a,c,h,o,t[l+2],23,-995338651),o=md5.md5ii(o,a,c,h,t[l],6,-198630844),h=md5.md5ii(h,o,a,c,t[l+7],10,1126891415),c=md5.md5ii(c,h,o,a,t[l+14],15,-1416354905),a=md5.md5ii(a,c,h,o,t[l+5],21,-57434055),o=md5.md5ii(o,a,c,h,t[l+12],6,1700485571),h=md5.md5ii(h,o,a,c,t[l+3],10,-1894986606),c=md5.md5ii(c,h,o,a,t[l+10],15,-1051523),a=md5.md5ii(a,c,h,o,t[l+1],21,-2054922799),o=md5.md5ii(o,a,c,h,t[l+8],6,1873313359),h=md5.md5ii(h,o,a,c,t[l+15],10,-30611744),c=md5.md5ii(c,h,o,a,t[l+6],15,-1560198380),a=md5.md5ii(a,c,h,o,t[l+13],21,1309151649),o=md5.md5ii(o,a,c,h,t[l+4],6,-145523070),h=md5.md5ii(h,o,a,c,t[l+11],10,-1120210379),c=md5.md5ii(c,h,o,a,t[l+2],15,718787259),a=md5.md5ii(a,c,h,o,t[l+9],21,-343485551),o=md5.safeAdd(o,i),a=md5.safeAdd(a,n),c=md5.safeAdd(c,s),h=md5.safeAdd(h,r);return[o,a,c,h]},md5.binl2rstr=function(t){for(var e="",i=32*t.length,n=0;n<i;n+=8)e+=String.fromCharCode(t[n>>5]>>>n%32&255);return e},md5.rstr2binl=function(t){var e=[];for(e[(t.length>>2)-1]=void 0,n=0;n<e.length;n+=1)e[n]=0;for(var i=8*t.length,n=0;n<i;n+=8)e[n>>5]|=(255&t.charCodeAt(n/8))<<n%32;return e},md5.rstrMD5=function(t){return md5.binl2rstr(md5.binlMD5(md5.rstr2binl(t),8*t.length))},md5.rstrHMACMD5=function(t,e){var i,n=md5.rstr2binl(t),s=[],r=[];for(s[15]=r[15]=void 0,16<n.length&&(n=md5.binlMD5(n,8*t.length)),i=0;i<16;i+=1)s[i]=909522486^n[i],r[i]=1549556828^n[i];return i=md5.binlMD5(s.concat(md5.rstr2binl(e)),512+8*e.length),md5.binl2rstr(md5.binlMD5(r.concat(i),640))},md5.rstr2hex=function(t){for(var e,i="",n=0;n<t.length;n+=1)e=t.charCodeAt(n),i+="0123456789abcdef".charAt(e>>>4&15)+"0123456789abcdef".charAt(15&e);return i},md5.str2rstrUTF8=function(t){return unescape(encodeURIComponent(t))},md5.rawMD5=function(t){return md5.rstrMD5(md5.str2rstrUTF8(t))},md5.hexMD5=function(t){return md5.rstr2hex(md5.rawMD5(t))},md5.rawHMACMD5=function(t,e){return md5.rstrHMACMD5(md5.str2rstrUTF8(t),md5.str2rstrUTF8(e))},md5.hexHMACMD5=function(t,e){return md5.rstr2hex(md5.rawHMACMD5(t,e))},md5.encscript=function(t,e,i){return e?i?md5.rawHMACMD5(e,t):md5.hexHMACMD5(e,t):i?md5.rawMD5(t):md5.hexMD5(t)};var BinaryConstants=cc.Class.extend({ctor:function(){}}),BinaryBuilder=(BinaryConstants.DataTypeID={Int8:1,UInt8:2,Int16:3,UInt16:4,Int32:5,UInt32:6,Int64:7,UInt64:8,Float:9,Double:10,StringDynamic:11,Object8:12,Array8:13},cc.Class.extend({isBigEndian:!1,offset:0,tmpBuffer:null,ctor:function(){},init:function(t,e,i){return this.isBigEndian=i=void 0===i?!1:i,tmpBuffer=this.BuildBinaryFromStruct(t,e)},writeFloat:function(t){var e=new ArrayBuffer(4),i=new DataView(e);try{i.setFloat32(0,t,this.isBigEndian)}catch(t){i.setFloat32(0,0,this.isBigEndian)}return e},writeInt8:function(t){var e=new ArrayBuffer(1),i=new DataView(e);try{i.setInt8(0,t)}catch(t){i.setInt8(0,0)}return e},writeUInt8:function(t){var e=new ArrayBuffer(1),i=new DataView(e);try{i.setUint8(0,t)}catch(t){i.setUint8(0,0)}return e},writeUInt16:function(t){var e=new ArrayBuffer(2),i=new DataView(e);try{i.setUint16(0,t,this.isBigEndian)}catch(t){i.setUint16(0,0,this.isBigEndian)}return e},writeInt16:function(t){var e=new ArrayBuffer(2),i=new DataView(e);try{i.setInt16(0,t,this.isBigEndian)}catch(t){i.setInt16(0,0,this.isBigEndian)}return e},writeUInt32:function(t){var e=new ArrayBuffer(4),i=new DataView(e);try{i.setUint32(0,t,this.isBigEndian)}catch(t){i.setUint32(0,0,this.isBigEndian)}return e},writeInt32:function(t){var e=new ArrayBuffer(4),i=new DataView(e);try{i.setInt32(0,t,this.isBigEndian)}catch(t){i.setInt32(0,0,this.isBigEndian)}return e},writeInt64:function(t){var e=new Uint8Array(8);if(this.isBigEndian)try{e.set(new Uint8Array(this.writeInt32(t/2147483647)),0),e.set(new Uint8Array(this.writeInt32(t%2147483647)),4)}catch(t){e.set(new Uint8Array(this.writeInt32(0)),0),e.set(new Uint8Array(this.writeInt32(0)),4)}else try{e.set(new Uint8Array(this.writeInt32(t/2147483647)),0),e.set(new Uint8Array(this.writeInt32(t%2147483647)),4)}catch(t){e.set(new Uint8Array(this.writeInt32(0)),0),e.set(new Uint8Array(this.writeInt32(0)),4)}return e.buffer},writeUInt64:function(t){var e=new Uint8Array(8);if(this.isBigEndian)try{e.set(new Uint8Array(this.writeUInt32(t/4294967295)),0),e.set(new Uint8Array(this.writeUInt32(t%4294967295)),4)}catch(t){e.set(new Uint8Array(this.writeUInt32(0)),0),e.set(new Uint8Array(this.writeUInt32(0)),4)}else try{e.set(new Uint8Array(this.writeUInt32(t%4294967295)),0),e.set(new Uint8Array(this.writeUInt32(t/4294967295)),4)}catch(t){e.set(new Uint8Array(this.writeUInt32(0)),0),e.set(new Uint8Array(this.writeUInt32(0)),4)}return e.buffer},writeDouble:function(t){var e=new ArrayBuffer(8),i=new DataView(e);try{i.setFloat64(0,t,this.isBigEndian)}catch(t){i.setFloat64(0,0,this.isBigEndian)}return e},writeStringDynamic:function(t,e){for(var i=new Uint8Array(2*t.length+2),n=0;n<t.length;n++)i.set(new Uint8Array(this.writeUInt16(t.charCodeAt(n))),2*n);return i.buffer},BuildBinaryFromStruct:function(t,e){var i=[];if(Array.isArray(t))for(var n=0;n<t.length;n++)i.push(this.BuildBinaryFromStruct(t[n],e));else for(n in e)if(-1==n.indexOf("_Struct")&&-1==n.indexOf("_Type"))if(e[n]==BinaryConstants.DataTypeID.Object8)i.push(this.WriteDataByTypeID(e[n],t[n].length)),i.push(this.BuildBinaryFromStruct(t[n],e[n+"_Struct"]));else if(e[n]==BinaryConstants.DataTypeID.Array8)i.push(this.WriteDataByTypeID(e[n],t[n].length)),i.push(this.BuildBinaryFromArray(t[n],e[n+"_Type"]));else try{if(void 0===t[n])throw"Data undefined";i.push(this.WriteDataByTypeID(e[n],t[n]))}catch(t){throw Error("Error K "+n+" ID "+e[n]+" ex : "+t)}return this.concatDataView(i)},BuildBinaryFromArray:function(t,e){for(var i=[],n=0;n<t.length;n++)i.push(this.WriteDataByTypeID(e,t[n]));return this.concatDataView(i)},WriteDataByTypeID:function(t,e){switch(t){case BinaryConstants.DataTypeID.Int8:return this.writeInt8(e);case BinaryConstants.DataTypeID.UInt8:return this.writeUInt8(e);case BinaryConstants.DataTypeID.Int16:return this.writeInt16(e);case BinaryConstants.DataTypeID.UInt16:return this.writeUInt16(e);case BinaryConstants.DataTypeID.Int32:return this.writeInt32(e);case BinaryConstants.DataTypeID.UInt32:return this.writeUInt32(e);case BinaryConstants.DataTypeID.Int64:return this.writeInt64(e);case BinaryConstants.DataTypeID.UInt64:return this.writeUInt64(e);case BinaryConstants.DataTypeID.Float:return this.writeFloat(e);case BinaryConstants.DataTypeID.Double:return this.writeDouble(e);case BinaryConstants.DataTypeID.StringDynamic:return this.writeStringDynamic(e);case BinaryConstants.DataTypeID.Object8:case BinaryConstants.DataTypeID.Array8:return this.writeUInt8(e)}},concatDataView:function(t){for(var e,i=0;i<t.length;i++)e=this.appendDataView(e,t[i]);return e},appendDataView:function(t,e){var i;return void 0===t?e:void 0===e?t:((i=new Uint8Array(t.byteLength+e.byteLength)).set(new Uint8Array(t),0),i.set(new Uint8Array(e),t.byteLength),i.buffer)}})),BinaryParser=cc.Class.extend({isBigEndian:!1,offset:4,ctor:function(){},init:function(t,e){return e},parseFromStruct:function(t,e){var i,n={};for(i in t)if(-1==i.indexOf("_Struct")&&-1==i.indexOf("_Type"))if(t[i]==BinaryConstants.DataTypeID.Object8){var s=this.ReadDataByTypeID(t[i],e);n[i]=[];for(var r=0;r<s;r++)n[i].push(this.parseFromStruct(t[i+"_Struct"],e))}else if(t[i]==BinaryConstants.DataTypeID.Array8)for(s=this.ReadDataByTypeID(t[i],e),n[i]=[],r=0;r<s;r++)n[i].push(this.ReadDataByTypeID(t[i+"_Type"],e));else n[i]=this.ReadDataByTypeID(t[i],e);return n},readInt8:function(t){return this.offset++,t.getInt8(this.offset-1)},readUInt8:function(t){return this.offset++,t.getUint8(this.offset-1)},readInt16:function(t){return this.offset+=2,t.getInt16(this.offset-2,this.isBigEndian)},readUInt16:function(t){return this.offset+=2,t.getUint16(this.offset-2,this.isBigEndian)},readUInt32:function(t){return this.offset+=4,t.getUint32(this.offset-4,this.isBigEndian)},readInt32:function(t){return this.offset+=4,t.getInt32(this.offset-4,this.isBigEndian)},readInt64:function(t){return this.isBigEndian?2147483647*this.readInt32(t)+this.readInt32(t):this.readInt32(t)+2147483647*this.readInt32(t)},readUInt64:function(t){return this.isBigEndian?4294967295*this.readUInt32(t)+this.readUInt32(t):this.readUInt32(t)+4294967295*this.readUInt32(t)},readFloat:function(t){return this.offset+=4,t.getFloat32(this.offset-4,this.isBigEndian)},readDouble:function(t){return this.offset+=8,t.getFloat64(this.offset-8,this.isBigEndian)},readStringDynamic:function(t){for(var e,i="",n=0;n<t.byteLength&&0!=(e=this.readUInt16(t));n++)i+=String.fromCharCode(e);return i},ReadDataByTypeID:function(t,e){switch(t){case BinaryConstants.DataTypeID.Int8:return this.readInt8(e);case BinaryConstants.DataTypeID.UInt8:return this.readUInt8(e);case BinaryConstants.DataTypeID.Int16:return this.readInt16(e);case BinaryConstants.DataTypeID.UInt16:return this.readUInt16(e);case BinaryConstants.DataTypeID.Int32:return this.readInt32(e);case BinaryConstants.DataTypeID.UInt32:return this.readUInt32(e);case BinaryConstants.DataTypeID.Int64:return this.readInt64(e);case BinaryConstants.DataTypeID.UInt64:return this.readUInt64(e);case BinaryConstants.DataTypeID.Float:return this.readFloat(e);case BinaryConstants.DataTypeID.Double:return this.readDouble(e);case BinaryConstants.DataTypeID.StringDynamic:return this.readStringDynamic(e);case BinaryConstants.DataTypeID.Object8:case BinaryConstants.DataTypeID.Array8:return this.readUInt8(e);default:console.log("Wtf ID ",t)}}}),Message=cc.Class.extend({controllerId:-1,requestId:-1,content:null,ctor:function(t,e){this.requestId=t,this.content=e}}),JFUIBaseNode=(Message.Parse=function(t){t.getUint16(0,!1);var e=t.getUint16(2,!1);return new Message(e,t)},Message.build=function(t,e,i){return{requestId:t,data:i}},JFNetCore=cc.Class.extend({_socket:null,_hostName:null,_port:null,_socketKey:null,callBackOnConnected:null,callBackOnReceiveData:null,callBackOnError:null,callBackOnClose:null,isRunError:!1,_isClose:null,ctor:function(){cc.Class.call(this)},init:function(t){this._hostName=t.split(":")[0],this._port=t.split(":")[1],this._socketKey=t,this.socket&&(this.socket.close(),this._isClose=!0,"function"==typeof this.callBackOnError)&&(this.socket.onerror=this.callBackOnError)},connectHandler:function(){var t={stateEvent:"Connected"};t.socketKey=this._socketKey,this.callBackOnConnected&&this.callBackOnConnected(t)},ioErrorHandler:function(t){Utilities.showLog("err "+JSON.stringify(t)),cc.error("FishSocket-onWsError() : ",t),this.callBackOnError&&this.callBackOnError(t)},dataHandler:function(t){this.callBackOnReceiveData&&this.callBackOnReceiveData(this.messageFilter(t))},closeHandler:function(t){this.socket&&(this.socket.close(),this._isClose=!0,this.socket=null,this.callBackOnClose)&&this.callBackOnClose()},getMainIDNetMessage:function(t){return t.getUint32(4,!0)},getSubIDNetMessage:function(t){return t.getUint32(8,!0)},messageFilter:function(t){return t},sendMsg:function(t){try{this.socket.readyState==WebSocket.OPEN||"function"!=typeof this.callBackOnError||this.isRunError?this.socket.readyState==WebSocket.OPEN&&(this.isRunError=!1,this.socket.send(t)):(this.isRunError=!0,this.callBackOnError())}catch(t){"function"==typeof this.callBackOnError&&this.callBackOnError()}},connect:function(){this.socket&&(this.socket.close(),this.socket=null,this._isClose=!0),this.socket||(this.socket=new GameServer,this.socket.Start(),this.socket.onopen=this.connectHandler.bind(this),this.socket.onerror=this.ioErrorHandler.bind(this),this.socket.onmessage=this.dataHandler.bind(this),this.socket.onclose=this.closeHandler.bind(this),this.socket.binaryType="arraybuffer",this._isClose=!1),this.socket.onopen()},close:function(){this.socket&&(this.socket.close(),this.socket=null,this._isClose=!0)},isClose:function(){return this._isClose}}),JFNetCore.JFMasterSocket=null,JFNetCore.JFGameSocket=null,cc.Node.extend({_mainLayer:null,_mainAction:null,_layerbg:null,ctor:function(){cc.Node.prototype.ctor.call(this),this._mainLayer=new cc.Node,this.addChild(this._mainLayer)},cloneFromNode:function(t){for(this.setName(t.getName()),this.setPosition(t.getPosition()),this.setVisible(t.isVisible()),this.setLocalZOrder(t.getLocalZOrder()),this.setAnchorPoint(t.getAnchorPoint());0<t.getChildrenCount();){var e=t.getChildren()[0];e.removeFromParent(),this.addChild(e)}t.removeFromParent()},_initFromCocostudio:function(t){return t=ccs.load(t),this._mainLayer.removeFromParent(!0),this._mainLayer=t.node,this._mainLayer.setVisible(!0),this._mainLayer.setName("_mainLayer"),this.addChild(this._mainLayer),this._mainAction=t.action,this._initEventBtnFromCocostudio(),this._setccuiLayout(),!0},_setccuiLayout:function(){var t=this._mainLayer.getChildByName("JFBackGround");t&&(this._layerbg=new ccui.Layout,this._mainLayer.addChild(this._layerbg),this._layerbg.setLocalZOrder(-1),this._layerbg.setContentSize(t.getContentSize()),this._layerbg.setAnchorPoint(t.getAnchorPoint()),this._layerbg.setPosition(t.getPosition()),this._layerbg.setTouchEnabled(!0),this._layerbg.setOpacity(0))},_initEventBtnFromCocostudio:function(){for(var t=0;t<this._mainLayer.getChildrenCount();t++)this._mainLayer.getChildren()[t]instanceof ccui.Button&&this._mainLayer.getChildren()[t].addClickEventListener(this.onClickBtnFromCocostudio.bind(this))},onClickBtnFromCocostudio:function(t,e){},cloneTextField:function(t){var e=new cc.Scale9Sprite("#TxtBackground.png");(e=new cc.EditBox(t.getSize(),e)).setName(t.getName()),e.setFontColor(cc.color(255,255,255,255)),e.setPlaceholderFontColor(cc.color(255,255,255,255)),e.setPlaceHolder(t.getPlaceHolder()),e.currFN=t.getFontName(),e.currFS=t.getFontSize(),e.setPlaceholderFontName(t.getFontName()),e.setPlaceholderFontSize(t.getFontSize()),e.setFontName(t.getFontName()),e.setFontSize(t.getFontSize()),e.setPosition(t.getPosition()),e.setReturnType(cc.KEYBOARD_RETURNTYPE_DONE),e.setInputMode(cc.EDITBOX_INPUT_MODE_SINGLELINE),e.setDelegate(this),t.isPasswordEnabled()&&e.setInputFlag(cc.EDITBOX_INPUT_FLAG_PASSWORD),t.removeFromParent(!0),this._mainLayer.addChild(e)},editBoxEditingDidBegin:function(t){JFGameInfo.JFMain.layerPopup.lock()},editBoxEditingDidEnd:function(t){setTimeout(JFGameInfo.JFMain.layerPopup.unLock.bind(JFGameInfo.JFMain.layerPopup),1e3)},editBoxTextChanged:function(t,e){},editBoxReturn:function(t){t.setPlaceholderFontName(t.currFN),t.setPlaceholderFontSize(t.currFS)}})),JFUIBaseButton=ccui.Button.extend({onEnter:function(){ccui.Button.prototype.onEnter.call(this)},_releaseUpEvent:function(){ccui.Button.prototype._releaseUpEvent.call(this)},cloneFromButton:function(t){for(this._copyProperties(t);0<t._children.length;)t._children[0].retain(),t._children[0].removeFromParent(),this.addChild(t._children[0]);t.removeFromParent()}}),JFUIBaseLayer=ccui.Layout.extend({_mainLayer:null,_mainAction:null,_layerbg:null,_listEvents:null,ctor:function(){ccui.Layout.prototype.ctor.call(this),this._mainLayer=new cc.Node,this.addChild(this._mainLayer)},_initEvents:function(){this._listEvents=[]},_cloneButtonToUIButton:function(t){for(var e,i=0;i<t.getChildrenCount();i++)t.getChildren()[i]instanceof ccui.Button?((e=new JFUIBaseButton).cloneFromButton(t.getChildren()[i]),t.getChildren()[i].removeFromParent(),t.addChild(e)):this._cloneButtonToUIButton(t.getChildren()[i])},_initFromCocostudio:function(t){return t=ccs.load(t),this._mainLayer&&this._mainLayer.removeFromParent(!0),this._mainLayer=t.node,this._mainLayer.setVisible(!0),this._mainLayer.setName("_mainLayer"),this.addChild(this._mainLayer),this._mainAction=t.action,this._initEventBtnFromCocostudio(),this._setccuiLayout(),!0},_setccuiLayout:function(){var t=this._mainLayer.getChildByName("JFBackground");t&&(this._layerbg=new ccui.Layout,this._mainLayer.addChild(this._layerbg),this._layerbg.setLocalZOrder(-1),this._layerbg.setContentSize(t.getContentSize()),this._layerbg.setAnchorPoint(t.getAnchorPoint()),this._layerbg.setPosition(t.getPosition()),this._layerbg.setTouchEnabled(!0),this._layerbg.setOpacity(0))},_initEventBtnFromCocostudio:function(){for(var t=0;t<this._mainLayer.getChildrenCount();t++)this._mainLayer.getChildren()[t]instanceof ccui.Button&&this._mainLayer.getChildren()[t].addClickEventListener(this.onClickBtnFromCocostudio.bind(this))},onClickBtnFromCocostudio:function(t,e){},cloneTextField:function(t){var e=new cc.Scale9Sprite("#TxtBackground.png");(e=new cc.EditBox(t.getContentSize(),e)).setName(t.getName()),e.setFontColor(cc.color(255,255,255,255)),e.setPlaceholderFontColor(cc.color(255,255,255,255)),e.setPlaceHolder(t.getPlaceHolder()),e.currFN=t.getFontName(),e.currFS=t.getFontSize(),e.setPlaceholderFontName(t.getFontName()),e.setPlaceholderFontSize(t.getFontSize()-5),e.setFontName(t.getFontName()),e.setFontSize(t.getFontSize()-5),e.setPosition(t.getPosition()),e.setContentSize(t.getContentSize().width,t.getContentSize().height-2),e.setReturnType(cc.KEYBOARD_RETURNTYPE_DONE),e.setInputMode(cc.EDITBOX_INPUT_MODE_SINGLELINE),t.isMaxLengthEnabled()&&e.setMaxLength(t.getMaxLength()),e.setDelegate(this),t.isPasswordEnabled()&&(e.setInputFlag(cc.EDITBOX_INPUT_FLAG_PASSWORD),e.setInputMode(cc.EDITBOX_INPUT_MODE_SINGLELINE),e.setFontSize(t.getFontSize()+1),e.setPlaceholderFontSize(t.getFontSize()+1)),e.setAnchorPoint(t.getAnchorPoint()),t.removeFromParent(!0),this._mainLayer.addChild(e)},editBoxEditingDidBegin:function(t){JFGameInfo.JFMain.layerPopup.lock()},editBoxEditingDidEnd:function(t){JFGameInfo.JFMain.layerPopup.unLock.bind(JFGameInfo.JFMain.layerPopup)},editBoxTextChanged:function(t,e){},editBoxReturn:function(t){t.setPlaceholderFontName(t.currFN),t.setPlaceholderFontSize(t.currFS)},playMainActionByFrame:function(t,e,i){this._mainAction&&this._mainLayer.runAction(this._mainAction),this._mainAction.gotoFrameAndPlay(t,e,i)},onExit:function(){ccui.Layout.prototype.onExit.call(this),this.setDispose()},setDispose:function(){if(this.removeAllChildren(!0),this._listEvents)for(var t=0;t<this._listEvents.length;t++)cc.eventManager.removeListener(this._listEvents[t])}}),JFUIBase=cc.Class.extend({ctor:function(){}}),MGBaseEditBox=(JFUIBase.COMMON_SCALE_FACTOR=.9,JFUIBase.POP_SCALE_FACTOR=1.1,JFUIBase.SCALE_ACTION_TAG=10001,JFUIBase.initWinSizeAbout=function(){JFUIBase.size=cc.rect(0,0,1280,720),JFUIBase.center=cc.p(640,360),JFUIBase.w=1280,JFUIBase.w2=640,JFUIBase.w3=1280/3,JFUIBase.w4=320,JFUIBase.w5=256,JFUIBase.h=720,JFUIBase.h2=360,JFUIBase.h3=240,JFUIBase.h4=180,JFUIBase.h5=144},cc.EditBox.extend({ctor:function(t,e){e=new cc.Scale9Sprite(e);e.setAnchorPoint(cc.p(.5,.5)),cc.EditBox.prototype.ctor.call(this,t.getContentSize(),e,e),this.cloneTextField(t)},cloneTextField:function(t){this.setName(t.getName()),this.setFontColor(cc.color(255,255,255,255)),this.setPlaceholderFontColor(cc.color(255,255,255,255)),this.setPlaceHolder(t.getPlaceHolder()),this.setPlaceholderFontName(t.getFontName()),this.setFontName(t.getFontName()),this.setFontSize(t.getFontSize()),this.setPosition(t.getPosition()),this.setPlaceholderFontSize(t.getFontSize()),this.setContentSize(t.getContentSize()),this.setReturnType(cc.KEYBOARD_RETURNTYPE_DONE),this.setInputMode(cc.EDITBOX_INPUT_MODE_SINGLELINE),t.isPasswordEnabled()&&(this.setInputFlag(cc.EDITBOX_INPUT_FLAG_PASSWORD),this.setInputMode(cc.EDITBOX_INPUT_MODE_SINGLELINE),this.setFontSize(t.getFontSize()),this.setPlaceholderFontSize(t.getFontSize())),this.setAnchorPoint(t.getAnchorPoint()),t.removeFromParent(!0)},setFocus:function(){this._edTxt&&this._edTxt.focus()}})),JFNetSend=cc.Class.extend({ctor:function(){},sendLoginMaster:function(t){var e={};e.Token=t,e.AppVersion=JFGameInfo.AppVersion,t=Message.build(ConstantsVariable.NETWORK.LOGIN_MASTER,{Token:BinaryConstants.DataTypeID.StringDynamic,AppVersion:BinaryConstants.DataTypeID.StringDynamic},e),JFNetCore.JFMasterSocket.sendMsg(t)},sendGetInfoGameRoom:function(t){var e={KindID:BinaryConstants.DataTypeID.UInt32},i={};i.KindID=t,t=Message.build(ConstantsVariable.NETWORK.SYSTEM_GET_ROOM_INFO,e,i),JFNetCore.JFMasterSocket.sendMsg(t)},sendGetInfoAttendance:function(t){t=Message.build(ConstantsVariable.NETWORK.INFO_AWARD_ATTENDANCE,null,null),JFNetCore.JFMasterSocket.sendMsg(t)},sendGetAttendance:function(){var t=Message.build(ConstantsVariable.NETWORK.GET_ATTENDANCE,null,null);JFNetCore.JFMasterSocket.sendMsg(t)},sendGetInfoAwardOnline:function(){var t=Message.build(ConstantsVariable.NETWORK.INFO_AWARD_ONLINE,null,null);JFNetCore.JFMasterSocket.sendMsg(t)},sendGetAwardOnline:function(){var t=Message.build(ConstantsVariable.NETWORK.GET_AWARD_ONLINE,null,null);JFNetCore.JFMasterSocket.sendMsg(t)},sendUpdateDisplayName:function(t){var e={DislayName:BinaryConstants.DataTypeID.StringDynamic},i={};i.DislayName=t,t=Message.build(ConstantsVariable.NETWORK.UPDATE_DISPLAY_NAME,e,i),JFNetCore.JFMasterSocket.sendMsg(t)},sendGetTotalUserOnline:function(){var t=Message.build(ConstantsVariable.NETWORK.UPDATE_TOTAL_USER_ONLINE,null,null);JFNetCore.JFMasterSocket.sendMsg(t),data=null},sendGetAwardStatus:function(){var t=Message.build(ConstantsVariable.NETWORK.STATUS_AWARD,null,null);JFNetCore.JFMasterSocket.sendMsg(t)},sendPingMaster:function(){var t=Message.build(ConstantsVariable.NETWORK.PING_PONG,null,null);JFNetCore.JFMasterSocket.sendMsg(t)},sendTopSlot:function(){var t=Message.build(ConstantsVariable.NETWORK.TOP_USER_SLOT,null,null);JFNetCore.JFMasterSocket.sendMsg(t)},getGameHistory:function(t){var e={page:BinaryConstants.DataTypeID.UInt8},i={};i.page=t,t=Message.build(ConstantsVariable.NETWORK.MONEY_HISTORY_REPONESE,e,i),JFNetCore.JFMasterSocket.sendMsg(t)},sendGetMessage:function(){var t=Message.build(ConstantsVariable.NETWORK.MESSAGE_TRANSFORM,null,null);JFNetCore.JFMasterSocket.sendMsg(t)}}),JFGameNetSend=JFNetSend.extend({ctor:function(){JFNetSend.prototype.ctor.call(this)},sendLoginGame:function(t){var e={};e.Token=t,t=Message.build(ConstantsVariable.NETWORK.LOGIN_GAME,{Token:BinaryConstants.DataTypeID.StringDynamic},e),JFNetCore.JFGameSocket.sendMsg(t)},sendGunFire:function(t){t=Message.build(ConstantsVariable.NETWORK.GAME_USER_FIRE,{Angle:BinaryConstants.DataTypeID.Float,BulletMultiple:BinaryConstants.DataTypeID.UInt32,BulletID:BinaryConstants.DataTypeID.UInt32,LockedFishID:BinaryConstants.DataTypeID.UInt32},t),JFNetCore.JFGameSocket.sendMsg(t)},sendFireSkill:function(t,e){var i={};i.Angle=t,i.x=e.x,i.y=e.y,i=Message.build(ConstantsVariable.NETWORK.GAME_FIRE_SKILL,{Angle:BinaryConstants.DataTypeID.Float,x:BinaryConstants.DataTypeID.Float,y:BinaryConstants.DataTypeID.Float},i),JFNetCore.JFGameSocket.sendMsg(i)},sendCatchFish:function(t,e){var i={};i.FishID=t,i.Multiple=e,i=Message.build(ConstantsVariable.NETWORK.GAME_CATCH_FISH,{FishID:BinaryConstants.DataTypeID.UInt32,Multiple:BinaryConstants.DataTypeID.UInt64},i),JFNetCore.JFGameSocket.sendMsg(i)},sendCatchFishSkill:function(t,e,i){var n={};n.BulletID=e,n.SkillID=i,n.ListFish=t,t=Message.build(ConstantsVariable.NETWORK.GAME_CATCH_FISH_SKILL,{BulletID:BinaryConstants.DataTypeID.UInt8,SkillID:BinaryConstants.DataTypeID.UInt8,ListFish:BinaryConstants.DataTypeID.Array8,ListFish_Type:BinaryConstants.DataTypeID.UInt32},n),JFNetCore.JFGameSocket.sendMsg(t)},sendExitGameServer:function(){var t=Message.build(ConstantsVariable.NETWORK.GAME_USER_EXIT,null,null);JFNetCore.JFGameSocket.sendMsg(t)},sendGetTopDamage:function(){var t=Message.build(ConstantsVariable.NETWORK.SHOW_TOP_DAMAGE,null,null);JFNetCore.JFGameSocket.sendMsg(t)},sendPingGame:function(){var t=Message.build(ConstantsVariable.NETWORK.PING_PONG_GAME,null,null);JFNetCore.JFGameSocket.sendMsg(t)},sendCatchRedFish:function(t,e,i){var n={};n.FishID=t,n.FishIDArray=e,n.BulletMultiple=i,t=Message.build(ConstantsVariable.NETWORK.GAME_CATCH_RED_FISH,{FishID:BinaryConstants.DataTypeID.UInt32,FishIDArray:BinaryConstants.DataTypeID.Array8,FishIDArray_Type:BinaryConstants.DataTypeID.UInt32,BulletMultiple:BinaryConstants.DataTypeID.UInt64},n),JFNetCore.JFGameSocket.sendMsg(t)},sendChat:function(t,e){var i={};i.StationID=t,i.ChatID=e,i=Message.build(ConstantsVariable.NETWORK.GAME_CHAT_EMOTICON,{StationID:BinaryConstants.DataTypeID.UInt8,ChatID:BinaryConstants.DataTypeID.UInt8},i),JFNetCore.JFGameSocket.sendMsg(i)},botCatchFish:function(t,e,i,n){var s={};s.FishID=t,s.Multiple=e,s.BulletID=i,s.UserID=n,dataStruct={FishID:BinaryConstants.DataTypeID.UInt32,Multiple:BinaryConstants.DataTypeID.UInt64,BulletID:BinaryConstants.DataTypeID.UInt32,UserID:BinaryConstants.DataTypeID.Int32},t=Message.build(ConstantsVariable.NETWORK.GAME_BOT_CATCH_FISH,dataStruct,s),JFNetCore.JFGameSocket.sendMsg(t)}}),JFLayerLoading=JFUIBaseLayer.extend({imgLoading:null,ctor:function(){JFUIBaseLayer.prototype.ctor.call(this)},initObj:function(){this._initFromCocostudio(ResourceManager.JFResourcesMenuGame.CSSUILayerLoading),this.imgLoading=this._mainLayer.getChildByName("JFImgLoading")},show:function(){this.isVisible()||(this.imgLoading.setRotation(0),this.imgLoading.runAction(cc.sequence(cc.rotateBy(5,1080),cc.callFunc(this.hide.bind(this)))),this.setVisible(!0))},hide:function(){this.isVisible()&&this.imgLoading&&(this.imgLoading.stopAllActions(),this.imgLoading.setRotation(0),this.setVisible(!1))},checkLoading:function(){return this.isVisible()}}),LayerLoadingWithProcess=JFUIBaseLayer.extend({imgBg:null,ctor:function(){JFUIBaseLayer.prototype.ctor.call(this)},initObj:function(){this.imgBg=new cc.Sprite(ResourceManager.ResourceLoadingGame.MenuBackground),this.addChild(this.imgBg),this.imgBg.setAnchorPoint(cc.p(0,0)),this._initFromCocostudio(ResourceManager.ResourceLoadingGame.CCSUIUpdateLoadingLayer),this._mainLayer.getChildByName("TextPercent").ignoreContentAdaptWithSize(!0),this._mainLayer.getChildByName("TextError").setVisible(!1)},show:function(){},hide:function(){}}),JFCompoNotify=cc.Node.extend({_compoNotifyBar:null,_compoNotifyTxT:null,_listMessage:null,_lastPriorit:null,_isRunMessage:null,_cliping:null,_listEvents:null,ctor:function(){cc.Node.prototype.ctor.call(this)},initObj:function(){this._listMessage=[],this._lastPriorit=0,this._isRunMessage=!1,this._initEvents(),this._setccuiLayout()},_initEvents:function(){this._listEvents=[],this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.SYSTEM_BROADCAST.toString(),this.runBroadCast.bind(this)))},changeNotifyType:function(t){(this._typeState=t)===ConstantsVariable.LAYERS.MENU_LAYER_GAME?(this._cliping.setTouchEnabled(!1),this._compoNotifyTxT.setFontSize(20),this._compoNotifyBar.setSpriteFrame("IMG_BG_NOTIFY_BAR.png")):(this._cliping.setTouchEnabled(!0),this._compoNotifyTxT.setFontSize(30),this._compoNotifyBar.setSpriteFrame("IMG_BG_NOTIFY_BAR_LOBBY.png"))},runBroadCast:function(t){t=t.getUserData();var e={Interval:BinaryConstants.DataTypeID.UInt16,Priority:BinaryConstants.DataTypeID.UInt32,Msg:BinaryConstants.DataTypeID.StringDynamic,UrlLink:BinaryConstants.DataTypeID.StringDynamic};t=(new BinaryParser).init(e,t.content),this.setMessage(t),this.setVisible(!0)},setMessage:function(t){this._lastPriorit<t.Priority?(this._lastPriorit=t.Priority,this._listMessage.unshift(t)):this._listMessage.push(t),0<this._listMessage.length&&this.runMessage()},runMessage:function(){var t;this._isRunMessage||(this._isRunMessage=!0,this._compoNotifyTxT.setString(this._listMessage[0].Msg),this._lastPriorit=this._listMessage[0].Priority,this._currentURL=this._listMessage[0].UrlLink,this._listMessage.shift(),t=this._compoNotifyTxT.getContentSize().width/30,this._compoNotifyTxT.runAction(cc.sequence(cc.moveTo(0,cc.p(this._compoNotifyBar.getContentSize().width+10,this._compoNotifyTxT.getPosition().y)),cc.moveTo(t,cc.p(-this._compoNotifyTxT.getContentSize().width,this._compoNotifyTxT.getPosition().y)),cc.moveTo(0,cc.p(this._compoNotifyBar.getContentSize().width+10,this._compoNotifyTxT.getPosition().y)),cc.moveTo(t,cc.p(-this._compoNotifyTxT.getContentSize().width,this._compoNotifyTxT.getPosition().y)),cc.callFunc(this.runMessageComplete.bind(this)))))},runMessageComplete:function(){this._isRunMessage=!1,0<this._listMessage.length?this.runMessage():(this._lastPriorit=0,this.setVisible(!1))},cloneFromNode:function(t){for(this.setName(t.getName()),this.setPosition(t.getPosition()),this.setVisible(t.isVisible()),this.setLocalZOrder(t.getLocalZOrder());0<t.getChildrenCount();){var e=t.getChildren()[0];e.removeFromParent(),this.addChild(e)}t.removeFromParent(),this._compoNotifyBar=this.getChildByName("JFBackGround"),this._cliping=this.getChildByName("JFCompoNotifyCliping"),this._cliping.addClickEventListener(this._onClickNotifyBar.bind(this)),t=this._cliping.getChildByName("JFCompoNotifyTxT"),this._compoNotifyTxT=new ccui.Text("","Arial",30),this._compoNotifyTxT.setVisible(t.isVisible()),this._compoNotifyTxT.setAnchorPoint(t.getAnchorPoint()),this._compoNotifyTxT.setPosition(t.getPosition()),this._compoNotifyTxT.setFontSize(t.getFontSize()),this._compoNotifyTxT.setFontName(t.getFontName()),this._compoNotifyTxT.setLocalZOrder(t.getLocalZOrder()),this._compoNotifyTxT.setString(t.getString()),this._compoNotifyTxT.setName(t.getName()),this._compoNotifyTxT.ignoreContentAdaptWithSize(!0),this._compoNotifyTxT.setAnchorPoint(cc.p(0,.5)),this._cliping.addChild(this._compoNotifyTxT),t.removeFromParent(!0)},_onClickNotifyBar:function(t,e){(-1<this._currentURL.indexOf("http://")||-1<this._currentURL.indexOf("https://"))&&cc.sys.openURL(this._currentURL)},_setccuiLayout:function(){this._compoNotifyBar&&(this._layerbg=new ccui.Layout,this.addChild(this._layerbg),this._layerbg.setLocalZOrder(-1),this._layerbg.setContentSize(this._compoNotifyBar.getContentSize()),this._layerbg.setAnchorPoint(this._compoNotifyBar.getAnchorPoint()),this._layerbg.setPosition(this._compoNotifyBar.getPosition()),this._layerbg.setTouchEnabled(!0),this._layerbg.setOpacity(0))},setDispose:function(){if(this.removeAllChildren(!0),this._listEvents)for(var t=0;t<this._listEvents.length;t++)cc.eventManager.removeListener(this._listEvents[t])}}),JFCompoOptionInGame=(JFSkill=JFUIBaseNode.extend({processBar:null,id:null,timeLostSkill:null,numberFishGet:null,scoreGetSkill:null,scoreLostSkill:null,SkillScore:null,TimeEffect:null,percent:null,currentCount:null,activeTexture:null,funcUpdateSkillScore:null,funcOnEffectSkill:null,ctor:function(){JFUIBaseNode.prototype.ctor.call(this),this.id=0,this.funcUpdateSkillScore=this.updateSkillScore.bind(this),this.funcOnEffectSkill=this.onEffectSkill.bind(this)},initObj:function(t){this._initFromCocostudio(t),this.processBar=this._mainLayer.getChildByName("JFCompoSkillProcessBar")},initInfo:function(t){this.id=t.ID,this.timeLostSkill=t.TimeLostSkill,this.numberFishGet=t.NumberFishGet,this.scoreGetSkill=t.ScoreGetSkill,this.scoreLostSkill=t.ScoreLostSkill,this.TimeEffect=t.TimeEffect,this.SkillScore=0},updateSkill:function(t){this.SkillScore=t.SkillScore,this.percent=(this.percent=parseInt(this.SkillScore/this.scoreGetSkill*100))||0,cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.UPDATE_SKILL_SLIDER.toString()),null==this.percent||isNaN(this.percent)||this.processBar.setPercent(100),this.currentCount=this.timeLostSkill,1==t.IsUseSkill?(JFGameInfo.currentSkill=this.id,this._ActiveSkill(this.id),cc.eventManager.dispatchCustomEvent(ConstantsVariable.NETWORK.GAME_CHANGE_GUN_SKILL.toString(),null),this.unschedule(this.funcUpdateSkillScore),this.schedule(this.funcOnEffectSkill,1)):JFGameInfo.currentSkill==this.id&&(JFGameInfo.currentSkill=0,cc.eventManager.dispatchCustomEvent(ConstantsVariable.NETWORK.GAME_CHANGE_GUN_SKILL.toString(),null))},_ActiveSkill:function(t){var e=sp.SkeletonAnimation.create(ResourceManager.JFResourcesGame.FX_Lazer_Gem_json,ResourceManager.JFResourcesGame.FX_Lazer_Gem_atlas);switch(t){case 1:(e=sp.SkeletonAnimation.create(ResourceManager.JFResourcesGame.FX_Lazer_Gem_json,ResourceManager.JFResourcesGame.FX_Lazer_Gem_atlas)).setAnimation(0,"Lazer_gem_FX",!1);break;case 2:(e=sp.SkeletonAnimation.create(ResourceManager.JFResourcesGame.FX_Electric_Gem_json,ResourceManager.JFResourcesGame.FX_Electric_Gem_atlas)).setAnimation(0,"Electric_gem_FX",!1);break;case 3:(e=sp.SkeletonAnimation.create(ResourceManager.JFResourcesGame.FX_Fire_Gem_json,ResourceManager.JFResourcesGame.FX_Fire_Gem_atlas)).setAnimation(0,"Bomb_gem_FX",!1);break;case 4:(e=sp.SkeletonAnimation.create(ResourceManager.JFResourcesGame.FX_Golden_Gem_json,ResourceManager.JFResourcesGame.FX_Golden_Gem_atlas)).setAnimation(0,"Golden_Gem_FX",!1)}e.setCompleteListener(this._onCompleteActiveSkill.bind(this,e)),this.addChild(e)},_onCompleteActiveSkill:function(t){t.clearTracks(),t.scheduleOnce(function(){t.removeFromParent(!0),t=null,delete t},.05)},resetSkill:function(){this.percent=this.SkillScore=0,JFGameInfo.currentSkill=0;try{this.processBar.setPercent(100),this.unschedule(this.funcUpdateSkillScore),this.unschedule(this.funcOnEffectSkill),this.unscheduleUpdate(),this.unscheduleAllCallbacks(),cc.director.getScheduler().unscheduleAllForTarget(this)}catch(t){}},activeSkill:function(){this.unschedule(this.funcUpdateSkillScore),this.schedule(this.funcUpdateSkillScore,1)},updateSkillScore:function(){0<this.currentCount?this.currentCount--:(this.SkillScore-=this.scoreLostSkill,0<this.SkillScore?(this.percent=(this.percent=parseInt(this.SkillScore/this.scoreGetSkill*100))||0,cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.UPDATE_SKILL_SLIDER.toString()),null==this.percent||isNaN(this.percent)||this.processBar.setPercent(100)):(this.SkillScore=0,this.resetSkill(),setTimeout(function(){cc.eventManager.dispatchCustomEvent(ConstantsVariable.NETWORK.GAME_CHANGE_GUN_SKILL.toString(),null)},500)))},onEffectSkill:function(){0<this.SkillScore?(this.SkillScore-=this.scoreGetSkill/this.TimeEffect,this.percent=(this.percent=parseInt(this.SkillScore/this.scoreGetSkill*100))||0,null==this.percent||isNaN(this.percent)||this.processBar.setPercent(this.percent)):(this.SkillScore=0,this.unschedule(this.funcOnEffectSkill),this.resetSkill())}}),cc.Node.extend({_compoOptionBar:null,_isClose:null,_posDefault:null,_btnOptionExtend:null,_isSoundOn:null,_isMusicOn:null,_gunLockPosition:null,_gunValue:null,_buttonValue:null,_gunIcon:null,JFBtnMusic:null,JFBtnSound:null,IMG_BTN_OPTION_EXTEND:null,ctor:function(){cc.Node.prototype.ctor.call(this)},initObj:function(){this._isMusicOn=this._isSoundOn=this._isClose=!0,this._buttonValue=[],this._initEvents(),this._setccuiLayout(),this._initGunValue()},_initEvents:function(){for(var t=0;t<this.getChildrenCount();t++)this.getChildren()[t]instanceof ccui.Button&&this.getChildren()[t].addClickEventListener(this.onClickBtnFromCocostudio.bind(this))},cloneFromNode:function(t){for(this.setName(t.getName()),this.setPosition(t.getPosition()),this.setVisible(t.isVisible()),this.setLocalZOrder(t.getLocalZOrder()),this._posDefault=t.getPosition();0<t.getChildrenCount();){var e=t.getChildren()[0];e.removeFromParent(),this.addChild(e)}this._compoOptionBar=this.getChildByName("JFBackGround"),this._btnOptionExtend=this.getChildByName("JFBtnOptionExtend"),this._gunIcon=this.getChildByName("JFGunIcon"),this.JFBtnMusic=this.getChildByName("JFBtnMusic"),this.JFBtnSound=this.getChildByName("JFBtnSound"),t.removeFromParent()},_initGunValue:function(){JFGameInfo.roomID===ConstantsVariable.RoomGameNormal||JFGameInfo.roomID===ConstantsVariable.RoomGameTrial?(this._gunLockPosition=PreLoaderConfig.LockGunPosition.Normal,this._gunValue=PreLoaderConfig.GunValue.Normal):(this._gunLockPosition=PreLoaderConfig.LockGunPosition.Vip,this._gunValue=PreLoaderConfig.GunValue.Vip)},enabledGunValue:function(t){for(var e=0;e<this._buttonValue.length;e++){var i=this._buttonValue[e],n=!!t||cc.pointEqualToPoint(this._gunIcon.getPosition(),i.getPosition());i.setEnabled(n),i.setBright(n),i.setTouchEnabled(t)}},setRoomInfo:function(){this._initGunValue()},onClickBtnFromCocostudio:function(t,e){switch(t.getName()){case"JFBtnOptionExtend":this._isClose?(this._isClose=!1,this.runAction(cc.sequence(cc.moveTo(.2,cc.p(this._posDefault.x-76,this._posDefault.y)),cc.callFunc(this._changeTextureBtnOptionExtend.bind(this))))):(this._isClose=!0,this.runAction(cc.sequence(cc.moveTo(.2,this._posDefault),cc.callFunc(this._changeTextureBtnOptionExtend.bind(this)))));break;case"JFBtnOptionExit":JFGameInfo.JFMain.layerPopup.showPopupTongKet();break;case"JFBtnQuestion":JFGameInfo.JFMain.layerPopup.showPopupHeSoCa();break;case"JFBtnMusic":this._checkSoundInGame();break;case"JFBtnSound":this._checkMusicInGame()}},_checkSoundInGame:function(){this._isMusicOn?(this.JFBtnMusic.loadTextureNormal("BTN_MUSIC_OFF.png",ccui.Widget.PLIST_TEXTURE),jf.audio.setEffectsVolume(0,!0),this._isMusicOn=!1):(this.JFBtnMusic.loadTextureNormal("BTN_MUSIC_DEFAULT.png",ccui.Widget.PLIST_TEXTURE),jf.audio.setEffectsVolume(JFGameInfo.currSound,!0),this._isMusicOn=!0)},_checkMusicInGame:function(){this._isSoundOn?(this.JFBtnSound.loadTextureNormal("BTN_SOUND_OFF.png",ccui.Widget.PLIST_TEXTURE),jf.audio.setMusicVolume(0,!0),this._isSoundOn=!1):(this.JFBtnSound.loadTextureNormal("BTN_SOUND_DEFAULT.png",ccui.Widget.PLIST_TEXTURE),jf.audio.setMusicVolume(JFGameInfo.currMusic,!0),this._isSoundOn=!0)},getGunValue:function(){return this._gunValue},onComfirmExit:function(){this._isClose=!0,this.runAction(cc.sequence(cc.moveTo(.2,this._posDefault),cc.callFunc(this._changeTextureBtnOptionExtend.bind(this)))),JFGameInfo.JFMain.layerScreenGame.netSend.sendExitGameServer()},_changeTextureBtnOptionExtend:function(){this._isClose?(this._btnOptionExtend.loadTextureNormal("IMG_BTN_OPTIN_INGAME_EXTEND.png",ccui.Widget.PLIST_TEXTURE),this._btnOptionExtend.setFlippedX(!1)):(this._btnOptionExtend.loadTextureNormal("IMG_BTN_OPTIN_INGAME_EXTEND.png",ccui.Widget.PLIST_TEXTURE),this._btnOptionExtend.setFlippedX(!0))},closeOption:function(){this._isClose||(this._isClose=!0,this.runAction(cc.sequence(cc.moveTo(.2,this._posDefault),cc.callFunc(this._changeTextureBtnOptionExtend.bind(this)))))},_setccuiLayout:function(){this._compoOptionBar&&(this._layerbg=new ccui.Layout,this.addChild(this._layerbg),this._layerbg.setLocalZOrder(-1),this._layerbg.setContentSize(this._compoOptionBar.getContentSize()),this._layerbg.setAnchorPoint(this._compoOptionBar.getAnchorPoint()),this._layerbg.setPosition(this._compoOptionBar.getPosition()),this._layerbg.setTouchEnabled(!0),this._layerbg.setOpacity(0))},setResetUI:function(){this.enabledGunValue(!0)}})),JFLayerCompos=JFUIBaseLayer.extend({compoNotify:null,compoOptionInGame:null,compoBtnHeSoCa:null,compoBtnFullScreen:null,_typeState:null,containSkill:null,skill1:null,skill2:null,skill3:null,skill4:null,PercentPerSkill:null,NumberOfSkill:null,NumberSkillActive:null,comboSkillSlider:null,compoTimeOutExit:null,timeCountDown:null,compoTimeOutExitVisible:null,currentSkillID:null,currentPointFT:null,MaxPointFT:null,processBarFT:null,btnTopFreeSlot:null,_btnSpeed:null,_btnAuto:null,_btnLockFish:null,_isSpeed:!1,_txtJackPotGoldFinal:null,_jackPotObj:null,coinParticle:null,_isVisible:!1,ctor:function(){JFUIBaseLayer.prototype.ctor.call(this)},initObj:function(){this._typeState=0,this._initFromCocostudio(ResourceManager.JFResourcesMenuGame.CSSUIComponentsLayer),this.compoTimeOutExit=this._mainLayer.getChildByName("JFTimeOutExit"),this.processBarFT=this._mainLayer.getChildByName("JFFreeTicketProcess").getChildByName("JFCompoSkillProcessBar"),this.processBarFT.setVisible(!1),this._mainLayer.getChildByName("JFCompoFreeTicket").setVisible(!1),this.compoTimeOutExitVisible=!1,this.currentPointFT=0,this.MaxPointFT=1,this._initItem(),this._initEvents(),this.activeSpeed(!1)},_initEvents:function(){cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.GAME_SKILLS_INFO.toString(),this._ngSkillsInfo.bind(this)),cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.GAME_UPDATE_SKILL.toString(),this._ngUpdateSkill.bind(this)),cc.eventManager.addCustomListener(ConstantsVariable.EVENTS.UPDATE_SKILL_SLIDER.toString(),this._ngUpdateTridentSlider.bind(this)),cc.sys.isNative||(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.GAME_UPDATE_FREETICK.toString(),this._ngUpdateFreeTicket.bind(this)),cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.GAME_GET_INFO_FREETICK.toString(),this._ngGetInfoFreeTicket.bind(this))),cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.JACKPOT_DATA.toString(),this._onMessageJackPot.bind(this)),cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.JACKPOT_FINISH.toString(),this._onJackPotFinish.bind(this))},_onMessageJackPot:function(t){var e;this._isVisible&&(t=t.getUserData(),e={Coin:BinaryConstants.DataTypeID.UInt64,GameKindID:BinaryConstants.DataTypeID.UInt8},t=(new BinaryParser).init(e,t.content),Utilities.showLog("_onMessageJackPot:"+JSON.stringify(t)),this._jackPotObj.getCurrentGold()!=t.Coin)&&t.GameKindID===JFGameInfo.roomID&&this._jackPotGold!=t.Coin&&(this._jackPotObj.setVisible(!0),this._jackPotObj.setGold(t.Coin))},_onJackPotFinish:function(t){Utilities.showLog("//////////////JACKPOT FINISH//////////////"),t=t.getUserData();var e={Coin:BinaryConstants.DataTypeID.UInt64,GameKindID:BinaryConstants.DataTypeID.UInt8};(t=(new BinaryParser).init(e,t.content)).GameKindID===JFGameInfo.roomID&&(Utilities.showLog("playJackpotEffect"),(e=Utilities.newSkeletonAnimation(ResourceManager.JFResourcesGame.NoHu_FX_json,ResourceManager.JFResourcesGame.NoHu_FX_atlas)).setCompleteListener(this._removeFXSpineComplete.bind(this,e)),e.attr({x:JFUIBase.w2,y:JFUIBase.h2,zIndex:ConstantsVariable.UIZorder.TIP}),e.setAnimation(0,"Animation",!0),e.setTimeScale(1.5),e.setAnchorPoint(.65,.5),this._mainLayer.getChildByName("NodeJackPotEffect").addChild(e),this.coinParticle=new cc.ParticleSystem(ResourceManager.JFResourcesGame.FXCoinJackpotPlist),this.coinParticle.setPosition(0,100),this.coinParticle.setAutoRemoveOnFinish(!0),e.addChild(this.coinParticle),this._txtJackPotGoldFinal.setVisible(!0),this._txtJackPotGoldFinal.setString(Utilities.Coin(t.Coin)))},_removeFXSpineComplete:function(t){this._txtJackPotGoldFinal.setVisible(!1),this.coinParticle&&this.coinParticle.removeFromParent(),t.scheduleUpdate(),t.schedule(function(){t.unscheduleUpdate(),t.removeFromParent(),t=null},.1)},_ngUpdateFreeTicket:function(t){t=t.getUserData();var e={StationID:BinaryConstants.DataTypeID.UInt8,CurrentPoint:BinaryConstants.DataTypeID.UInt64,IsGetTicket:BinaryConstants.DataTypeID.UInt8};1==(t=(new BinaryParser).init(e,t.content)).IsGetTicket&&((e={}).FromPos=this._mainLayer.getChildByName("JFFreeTicketProcess").getPosition(),e.StationID=t.StationID,cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.USER_GET_TICKET.toString(),e)),this.currentPointFT=t.CurrentPoint,this.processBarFT.setPercent(this.currentPointFT/this.MaxPointFT*100)},_ngGetInfoFreeTicket:function(t){t=t.getUserData();var e={CurrentPoint:BinaryConstants.DataTypeID.UInt64,PointToGetTicket:BinaryConstants.DataTypeID.UInt64};t=(new BinaryParser).init(e,t.content),this.currentPointFT=t.CurrentPoint,this.MaxPointFT=t.PointToGetTicket,this.processBarFT.setPercent(this.currentPointFT/this.MaxPointFT*100),cc.sys.isNative||(this.processBarFT.setVisible(!0),this._mainLayer.getChildByName("JFCompoFreeTicket").setVisible(!1))},_initItem:function(){var t=this._mainLayer.getChildByName("JFCompoNotifyBar");this.compoNotify=new JFCompoNotify,this.compoNotify.cloneFromNode(t),this.compoNotify.initObj(),this.compoNotify.setVisible(!1),this.addChild(this.compoNotify),t=this._mainLayer.getChildByName("JFBtnOptionInGame"),this.compoOptionInGame=new JFCompoOptionInGame,this.compoOptionInGame.cloneFromNode(t),this.compoOptionInGame.initObj(),this.compoOptionInGame.setVisible(!1),this.addChild(this.compoOptionInGame),this.containSkill=this._mainLayer.getChildByName("JFCompoSkillBar"),this.hideCompoSkill(),this.comboSkillSlider=this._mainLayer.getChildByName("JFCompoSkillBar").getChildByName("JFCompoSkillSlider"),this.compoBtnFullScreen=this._mainLayer.getChildByName("JFBtnFullScreen"),this.compoBtnFullScreen.setVisible(!1),this._btnLockFish=this._mainLayer.getChildByName("GunOption").getChildByName("BtnLockFish"),this._btnLockFish.addClickEventListener(this.onClickLockFish.bind(this)),this._btnLockFish.setVisible(!1),this._btnSpeed=this._mainLayer.getChildByName("GunOption").getChildByName("BtnSpeed"),this._btnSpeed.addClickEventListener(this.onClickSpeed.bind(this)),this._btnSpeed.setVisible(!1),this._isSpeed=!1,this._btnAuto=this._mainLayer.getChildByName("GunOption").getChildByName("BtnAuto"),this._btnAuto.addClickEventListener(this.onClickAuto.bind(this)),this._btnAuto.setVisible(!1),this._jackPotObj=new JFJackPot,this._jackPotObj.cloneFromNode(this._mainLayer.getChildByName("JackPot")),this._jackPotObj.initObj(),this.addChild(this._jackPotObj),this._jackPotObj.setVisible(!1),this._txtJackPotGoldFinal=this._mainLayer.getChildByName("TxtJackPotGold"),this._txtJackPotGoldFinal.setVisible(!1)},isAuto:function(){return!this._btnAuto.isBright()},onClickAuto:function(){Utilities.showLog("////////////ACTIVE AUTO FIRE:"+this.isAuto()),this.activeAutoFire(!this.isAuto()),cc.eventManager.dispatchCustomEvent(this.isAuto()?ConstantsVariable.CONFIG_BULLET.AUTO_FIRE:ConstantsVariable.CONFIG_BULLET.DE_ACTIVE_AUTO_FIRE)},onClickSpeed:function(){Utilities.showLog("////////////ACTIVE SPEED FIRE:"+this._isSpeed),this.activeSpeed(!this._isSpeed),cc.eventManager.dispatchCustomEvent(this._isSpeed?ConstantsVariable.CONFIG_BULLET.SPEED_X2:ConstantsVariable.CONFIG_BULLET.SPEED_DEFAULT)},onClickLockFish:function(){this._btnLockFish.isBright()?(JFGameInfo.JFMain.layerScreenGame.layerGuns.LockFish(),this.activeLockFish(!1)):(JFGameInfo.JFMain.layerScreenGame.layerGuns.CancelLockFish(),this.activeLockFish(!0))},setVisibleCompoItemGame:function(t){this._isVisible=t,this.compoOptionInGame.setVisible(t),this._btnLockFish.setVisible(t),this._btnLockFish.setBright(t),this._btnAuto.setVisible(t),this._btnAuto.setBright(t),this._btnSpeed.setVisible(t),this.activeSpeed(!1),cc.sys.isNative||this.compoBtnFullScreen.setVisible(t),this._jackPotObj.setVisible(!1)},_ngSkillsInfo:function(t){t=t.getUserData();var e={ListSkill:BinaryConstants.DataTypeID.Object8,ListSkill_Struct:{ID:BinaryConstants.DataTypeID.UInt8,NameSkill:BinaryConstants.DataTypeID.StringDynamic,TimeLostSkill:BinaryConstants.DataTypeID.UInt16,ScoreLostSkill:BinaryConstants.DataTypeID.UInt16,NumberFishGet:BinaryConstants.DataTypeID.UInt16,ScoreGetSkill:BinaryConstants.DataTypeID.UInt32,TimeEffect:BinaryConstants.DataTypeID.UInt8},CurrentSkill:BinaryConstants.DataTypeID.UInt8};t=(new BinaryParser).init(e,t.content),this.NumberOfSkill=t.ListSkill.length,this.NumberSkillActive=0,this.PercentPerSkill=100/this.NumberOfSkill;for(var e=this.containSkill.getChildByName("JFCompoSkillSliderBg").getContentSize().width/this.NumberOfSkill,i=0;i<this.NumberOfSkill;i++){var n=this.getSkillByID(t.ListSkill[i].ID);n.initInfo(t.ListSkill[i]),n.x=i*e+25+e,n.y=0,n.setVisible(!0)}this.containSkill.setScale(.7)},_ngUpdateSkill:function(t){t=t.getUserData();var e={SkillID:BinaryConstants.DataTypeID.UInt8,SkillScore:BinaryConstants.DataTypeID.Float,IsUseSkill:BinaryConstants.DataTypeID.UInt8};t=(new BinaryParser).init(e,t.content),JFGameInfo.currentSkillActive!=t.SkillID&&(JFGameInfo.currentSkill=0,cc.eventManager.dispatchCustomEvent(ConstantsVariable.NETWORK.GAME_CHANGE_GUN_SKILL.toString(),null),this.skill1&&this.skill1.resetSkill(),this.skill2&&this.skill2.resetSkill(),this.skill3&&this.skill3.resetSkill(),this.skill4&&this.skill4.resetSkill(),JFGameInfo.currentSkillActive=t.SkillID),this.currentSkillID=t.SkillID,this.getSkillByID(t.SkillID).activeSkill(),this.getSkillByID(t.SkillID).updateSkill(t)},_ngUpdateTridentSlider:function(){var t=this.getSkillByID(this.currentSkillID).percent/this.NumberOfSkill;this.comboSkillSlider.setPercent(t+this.NumberSkillActive*this.PercentPerSkill)},getSkillByID:function(t){switch(this.skill1||this.createItemSkill(),t){case 1:return this.NumberSkillActive=0,this.skill1;case 2:return this.NumberSkillActive=1,this.skill2;case 3:return this.NumberSkillActive=2,this.skill3;case 4:return this.NumberSkillActive=3,this.skill4}return this.NumberSkillActive=0,this.skill1},createItemSkill:function(){this.skill1=new JFSkill,this.skill1.initObj(ResourceManager.JFResourcesGame.CSSJFCompoSkill1),this.skill2=new JFSkill,this.skill2.initObj(ResourceManager.JFResourcesGame.CSSJFCompoSkill2),this.skill3=new JFSkill,this.skill3.initObj(ResourceManager.JFResourcesGame.CSSJFCompoSkill3),this.skill4=new JFSkill,this.skill4.initObj(ResourceManager.JFResourcesGame.CSSJFCompoSkill4),this.containSkill.addChild(this.skill1),this.containSkill.addChild(this.skill2),this.containSkill.addChild(this.skill3),this.containSkill.addChild(this.skill4),this.removeAllSkill()},removeAllSkill:function(){this.skill1&&(this.skill1.resetSkill(),this.skill1.setVisible(!1)),this.skill2&&(this.skill2.resetSkill(),this.skill2.setVisible(!1)),this.skill3&&(this.skill3.resetSkill(),this.skill3.setVisible(!1)),this.skill4&&(this.skill4.resetSkill(),this.skill4.setVisible(!1))},hideCompoSkill:function(){this.removeAllSkill(),this.containSkill.setVisible(!1),this.processBarFT.setVisible(!1),this._mainLayer.getChildByName("JFCompoFreeTicket").setVisible(!1)},showCompoSkill:function(){this.containSkill.setVisible(!0)},updateTimeCount:function(){this.timeCountDown=PreLoaderConfig.TIME_LOST_ACTION},exitGame:function(){this.hideCompoSkill(),this.timeCountDown=PreLoaderConfig.TIME_LOST_ACTION,this.compoTimeOutExit.setVisible(!1),this.compoTimeOutExitVisible=!1,this.unschedule(this.onCountDown),this.comboSkillSlider.setPercent(0),this.tridentParticle.stopSystem(),this.tridentParticle.removeFromParent(),this.NumberSkillActive=this.NumberOfSkill=this.PercentPerSkill=this.tridentParticle=null},enterGame:function(){this.showCompoSkill(),this.timeCountDown=PreLoaderConfig.TIME_LOST_ACTION,this.schedule(this.onCountDown,1),this.tridentParticle=new cc.ParticleSystem(ResourceManager.JFResourcesGame.FX_Trident_plist),this.tridentParticle.setAnchorPoint(cc.p(0,.5)),this.containSkill.addChild(this.tridentParticle),this.tridentParticle.setLocalZOrder(10),this.tridentParticle.setPosition(cc.p((JFGameInfo.appRealHeight-this.containSkill.getChildByName("JFCompoSkillSliderBg").getContentSize().width)/2+50,-1)),this.comboSkillSlider.runAction(cc.sequence(cc.fadeOut(2),cc.fadeIn(2)).repeatForever())},onCountDown:function(){this.timeCountDown--,this.timeCountDown<11?this.timeCountDown<=0?(this.unschedule(this.onCountDown),this.compoOptionInGame.onComfirmExit()):(this.compoTimeOutExit.setVisible(!0),this.compoTimeOutExitVisible=!0,this.compoTimeOutExit.getChildByName("JFTxtCountdown").setString(this.timeCountDown)):this.compoTimeOutExitVisible&&(this.compoTimeOutExit.setVisible(!1),this.compoTimeOutExitVisible=!1)},activeLockFish:function(t){this._btnLockFish.setBright(t)},activeAutoFire:function(t){this._btnAuto.setBright(!t)},activeSpeed:function(t){this._isSpeed=t,this._btnSpeed.loadTextureNormal(this._isSpeed?ResourceManager.JFResourcesGame.ButtonSpeedX1:ResourceManager.JFResourcesGame.ButtonSpeedX2,ccui.Widget.LOCAL_TEXTURE),this._btnSpeed.setBright(!t)},onClickBtnFromCocostudio:function(t,e){switch(t.getName()){case"JFBtnFullScreen":cc.sys.isNative||(document.webkitIsFullScreen||document.mozFullScreen||document.msFullscreenElement?cc.screen.exitFullScreen():cc.screen.requestFullScreen(document.getElementsByTagName("body")[0]));break;case"JFCompoFreeTicket":cc.sys.isNative||cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.CALL_TOP_USER_SLOT,null)}}}),JFLayerPopup=ccui.Layout.extend({_backgroundLayer:null,popupLogin:null,popupSetting:null,popupUsersOnline:null,popupHeSoCa:null,popupMsg:null,popupRegister:null,popupEmail:null,popupRank:null,popupAwardOnline:null,popupWebview:null,popupDisplayName:null,popupTopDamage:null,popupChest:null,popupTongKet:null,popupChangePass:null,popupUserProfile:null,popupChatEmoticon:null,popupHistorySlot:null,popupTutorialSlot:null,popupTopFreeSlot:null,popupTopWinSlot:null,popupPromo:null,popupListFrame:null,popupFirstTopup:null,numShow:null,_listEvents:null,_flagTouchEnable:null,popupAloneShowed:null,popupJackpot:null,_listPopup:null,ctor:function(){ccui.Layout.prototype.ctor.call(this),this.numShow=this.anchorY=this.anchorX=0,this.popupAloneShowed=!1},initObj:function(){this._initBackground(),this._initEvents(),this._flagTouchEnable=!0,this._listPopup=[]},_initBackground:function(){this.setName("JFLayerPopupController"),this.setContentSize(JFGameInfo.appRealWidth,JFGameInfo.appRealHeight),this.setBackGroundColorType(ccui.Layout.BG_COLOR_SOLID),this.setBackGroundColor(cc.color(0,0,0)),this.setBackGroundColorOpacity(200),this.setTouchEnabled(!0),this.addClickEventListener(this.onClickBackground.bind(this))},lock:function(){this._flagTouchEnable=!1},unLock:function(){this._flagTouchEnable=!0},onClickBackground:function(){this._flagTouchEnable&&this.hidePopupSequence()},_showPopupLogin:function(){this.popupLogin||(this.popupLogin=new JFPopupLogin,this.onShowPopup(this.popupLogin))},showPopupLoginNormal:function(){this._showPopupLogin()},showPopupRegister:function(){this._showPopupRegister()},loginFacebook:function(t){JFGameInfo.JFMain.showLoading(),Utilities.logGA(ConstantsVariable.GA_LOG.LOGIN_FACEBOOK);var e={};e.OpenProviderId=ConstantsVariable.LoginProviderID.Facebook,e.PlatformID=JFGameInfo.myPlatform,e.AppVersion=JFGameInfo.AppVersion,e.HardwareID=JFGameInfo.devineID,e.ChannelId=ConstantsVariable.CHANNEL_ID,e.VersionDevice=JFGameInfo.VersionDevice,e.DeviceModel=JFGameInfo.DeviceModel,e.packetName=JFGameInfo.packetName,e.TokenOpenId=t,e.Sign=md5.encscript("LoginOpenId"+e.OpenProviderId+e.TokenOpenId+e.PlatformID+e.AppVersion+e.HardwareID+e.ChannelId+e.VersionDevice+e.DeviceModel+e.packetName),Utilities.getAPI("LoginOpenId",e,this.onCallBackLoginFacebook.bind(this)),Utilities.pushEventFirebase("loginfb_count",{})},onCallBackLoginFacebook:function(t){1===(t=JSON.parse(t)).Result?(JFGameInfo.IsLoginNormal=!1,cc.sys.localStorage.setItem("facebook",!0),t=t.Data.Data,JFGameInfo.myInfo.token4Master=t.TokenGame,JFGameInfo.myInfo.token4Ws=t.TokenAPI,JFGameInfo.myInfo.avatarPath=t.EmotionPath,JFGameInfo.myInfo.PubUserId=t.PubUserId,cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.REFRESH_AVATAR_USER),cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.REFRESH_BORDER_AVATAR),cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.CHECK_USER_LOGIN),JFGameInfo.DevVersion||(PreLoaderConfig.ServerAndPortMaster=t.SocketKey),PreLoaderConfig.PathToAvatarDefault=t.AvatarDefault,JFGameInfo.JFMain.connectMasterServer()):(t=t.Message.replace(/\\n/g,"\n"),JFGameInfo.JFMain.layerPopup.showPopupMsg(t),JFGameInfo.JFMain.pushFirebaseLoginFailed(!1,t))},hidePopupLogin:function(){this.popupLogin&&(this.onHidePopup(this.popupLogin),this.popupLogin=null)},showPopupSetting:function(){this.popupSetting||(this.popupSetting=new JFPopupSetting,this.onShowPopup(this.popupSetting))},hidePopupSetting:function(){this.popupSetting&&(this.onHidePopup(this.popupSetting),this.popupSetting=null)},showPopupMsg:function(t,e){this.popupMsg||(this.popupMsg=new JFPopupMsg,this.onShowPopup(this.popupMsg),this.popupMsg.setLocalZOrder(20)),this.popupMsg.setMessage(t,"",e),JFGameInfo.JFMain.hideLoading()},showPopupMsg2:function(t,e,i){this.popupMsg||(this.popupMsg=new JFPopupMsg,this.onShowPopup(this.popupMsg),this.popupMsg.setLocalZOrder(20)),this.popupMsg.setMessage(t,e,i),JFGameInfo.JFMain.hideLoading()},hidePopupMsg:function(){this.popupMsg&&(this.onHidePopup(this.popupMsg),this.popupMsg=null)},_showPopupRegister:function(){this.popupRegister?this.popupRegister.onRefesh():(this.popupRegister=new JFPopupRegister,this.onShowPopup(this.popupRegister))},hidePopupRegister:function(){this.popupRegister&&(this.onHidePopup(this.popupRegister),this.popupRegister=null)},showPopupPromo:function(){this.popupPromo||(this.popupPromo=new JFPopupPromo,this.onShowPopup(this.popupPromo))},hidePopupPromo:function(){this.popupPromo&&(this.onHidePopup(this.popupPromo),this.popupPromo=null)},showPopupFirstTopup:function(t){this.popupFirstTopup||(this.popupFirstTopup=new JFPopupFirstTopup,this.onShowPopup(this.popupFirstTopup),this.popupFirstTopup.onRegistercallback(t))},hidePopupFirstTopup:function(){this.popupFirstTopup&&(this.onHidePopup(this.popupFirstTopup),this.popupFirstTopup=null)},showPopupListFrame:function(){this.popupListFrame||(this.popupListFrame=new JFPopupListFrame,this.onShowPopup(this.popupListFrame))},hidePopupListFrame:function(){this.popupListFrame&&(this.onHidePopup(this.popupListFrame),this.popupListFrame=null)},showPopupUsersOnline:function(){if(PreLoaderConfig.WebviewMode)JFGameInfo.JFMain.layerPopup.showPopupWebview(ConstantsVariable.WEBVIEW.USER_ONLINE,!0);else if(cc.sys.isNative&&cc.sys.isMobile)JFGameInfo.JFMain.layerPopup.showPopupWebview(ConstantsVariable.WEBVIEW.USER_ONLINE,!0);else if(!cc.sys.isNative)try{Dialog.UserOnline()}catch(t){}},hidePopupUsersOnline:function(){this.popupUsersOnline&&(this.onHidePopup(this.popupUsersOnline),this.popupUsersOnline=null)},showPopupHeSoCa:function(){this.popupHeSoCa||(this.popupHeSoCa=new JFPopupHeSoCa,this.onShowPopup(this.popupHeSoCa),this.popupHeSoCa.show())},hidePopupHeSoCa:function(){this.popupHeSoCa&&(this.onHidePopup(this.popupHeSoCa),this.popupHeSoCa=null)},showPopupTongKet:function(){this.popupTongKet||(this.popupTongKet=new JFPopupTongKet,this.onShowPopup(this.popupTongKet),this.popupTongKet.show())},hidePopupTongKet:function(){this.popupTongKet&&(this.onHidePopup(this.popupTongKet),this.popupTongKet=null)},showPopupEmail:function(t){if(PreLoaderConfig.WebviewMode)JFGameInfo.JFMain.layerPopup.showPopupWebview(ConstantsVariable.WEBVIEW.HOP_THU,!0);else if(cc.sys.isNative&&cc.sys.isMobile)JFGameInfo.JFMain.layerPopup.showPopupWebview(ConstantsVariable.WEBVIEW.HOP_THU,!0);else if(!cc.sys.isNative)try{Dialog.Inbox&&Dialog.Inbox(t)}catch(t){}},hidePopupEmail:function(){this.popupEmail&&(this.onHidePopup(this.popupEmail),this.popupEmail=null)},showPopupRank:function(){if(PreLoaderConfig.WebviewMode)JFGameInfo.JFMain.layerPopup.showPopupWebview(ConstantsVariable.WEBVIEW.BANG_XEP_HANG,!0);else if(cc.sys.isNative&&cc.sys.isMobile)JFGameInfo.JFMain.layerPopup.showPopupWebview(ConstantsVariable.WEBVIEW.BANG_XEP_HANG,!0);else if(!cc.sys.isNative)try{Dialog.RankingInfo&&Dialog.RankingInfo()}catch(t){}},hidePopupRank:function(){this.popupRank&&(this.onHidePopup(this.popupRank),this.popupRank=null)},showPopupSupport:function(){this.popupSupport||(this.popupSupport=new JFPopupSupport,this.onShowPopup(this.popupSupport))},hidePopupSupport:function(){this.popupSupport&&(this.onHidePopup(this.popupSupport),this.popupSupport=null)},showPopupUserInfo:function(t){this.popupUserInfo||(this.popupUserInfo=new JFPopupUserInfo(JFGameInfo.myInfo.UserID),this.onShowPopup(this.popupUserInfo))},showPopupReward:function(t){if(PreLoaderConfig.WebviewMode)JFGameInfo.JFMain.layerPopup.showPopupWebview(ConstantsVariable.WEBVIEW.NHAN_THUONG,!0);else if(cc.sys.isNative)JFGameInfo.JFMain.layerPopup.showPopupWebview(ConstantsVariable.WEBVIEW.NHAN_THUONG,!0);else if(!cc.sys.isNative)try{Dialog.Attendance&&Dialog.Attendance(t)}catch(t){}},showPopupNews:function(){if(PreLoaderConfig.WebviewMode)JFGameInfo.JFMain.layerPopup.showPopupWebview(ConstantsVariable.WEBVIEW.NEWS,!0);else if(cc.sys.isNative&&cc.sys.isMobile)JFGameInfo.JFMain.layerPopup.showPopupWebview(ConstantsVariable.WEBVIEW.NEWS,!0);else if(!cc.sys.isNative)try{Dialog.News&&Dialog.News()}catch(t){}},showPopupExchange:function(){if(PreLoaderConfig.WebviewMode)JFGameInfo.JFMain.layerPopup.showPopupWebview(ConstantsVariable.WEBVIEW.DOI_THUONG,!0);else if(cc.sys.isNative&&cc.sys.isMobile)JFGameInfo.JFMain.layerPopup.showPopupWebview(ConstantsVariable.WEBVIEW.DOI_THUONG,!0);else if(!cc.sys.isNative)try{Dialog.Exchange&&Dialog.Exchange()}catch(t){}},showPopupStore:function(){if(PreLoaderConfig.WebviewMode)JFGameInfo.JFMain.layerPopup.showPopupWebview(ConstantsVariable.WEBVIEW.NAP_XU,!0);else if(cc.sys.isNative&&cc.sys.isMobile)JFGameInfo.JFMain.layerPopup.showPopupWebview(ConstantsVariable.WEBVIEW.NAP_XU,!0);else if(!cc.sys.isNative&&PreLoaderConfig.IsAllowBuy)try{Dialog.Store&&Dialog.Store()}catch(t){}},hidePopupUserInfo:function(){this.popupUserInfo&&(this.onHidePopup(this.popupUserInfo),this.popupUserInfo=null)},showPopupUserProfile:function(t){this.popupUserProfile||(this.popupUserProfile=new JFPopupUserProfile,this.onShowPopup(this.popupUserProfile)),this.popupUserProfile.updateProfileInfo(t)},hidePopupUserProfile:function(){this.popupUserProfile&&(this.onHidePopup(this.popupUserProfile),this.popupUserProfile=null)},showPopupChest:function(){if(PreLoaderConfig.WebviewMode)JFGameInfo.JFMain.layerPopup.showPopupWebview(ConstantsVariable.WEBVIEW.RUONG,!0);else if(cc.sys.isNative&&cc.sys.isMobile)JFGameInfo.JFMain.layerPopup.showPopupWebview(ConstantsVariable.WEBVIEW.RUONG,!0);else if(!cc.sys.isNative)try{Dialog.Coffer&&Dialog.Coffer()}catch(t){}},hidePopupChest:function(){this.popupChest&&(this.onHidePopup(this.popupChest),this.popupChest=null)},showPopupBanBe:function(){if(PreLoaderConfig.WebviewMode)this.showPopupWebview(ConstantsVariable.WEBVIEW.BAN_BE,!0);else if(cc.sys.isNative&&cc.sys.isMobile)this.showPopupWebview(ConstantsVariable.WEBVIEW.BAN_BE,!0);else if(!cc.sys.isNative)try{Dialog.RankingInfoFriends()}catch(t){}},showPopupTaiApp:function(){if(PreLoaderConfig.WebviewMode)this.showPopupWebview(ConstantsVariable.WEBVIEW.TAI_APP,!0);else if(!cc.sys.isNative)try{Dialog.Download()}catch(t){}},showPopupMission:function(){if(PreLoaderConfig.WebviewMode)JFGameInfo.JFMain.layerPopup.showPopupWebview(ConstantsVariable.WEBVIEW.NHIEM_VU,!0);else if(cc.sys.isNative&&cc.sys.isMobile)JFGameInfo.JFMain.layerPopup.showPopupWebview(ConstantsVariable.WEBVIEW.NHIEM_VU,!0);else if(!cc.sys.isNative)try{Dialog.MissionShow&&Dialog.MissionShow()}catch(t){}},showPopupInApp:function(){PreLoaderConfig.IsReview||this.showPopupStore()},hidePopupInApp:function(){this.popupInapp&&(this.onHidePopup(this.popupInapp),this.popupInapp=null)},hideAllPopup:function(){this.hidePopupLogin(),this.hidePopupSetting(),this.hidePopupUsersOnline(),this.hidePopupRegister(),this.hidePopupEmail(),this.hidePopupSupport(),this.hidePopupUserInfo(),this.hidePopupChest(),this.hidePopupAwardOnline(),this.hidePopupWebview(),this.hidePopupChangePass(),this.hidePopupTopDamage(),this.hidePopupMsg(),this.hidePopupRank(),this.hidePopupDisplayName(),this.hidePopupHeSoCa(),this.hidePopupInApp(),this.hidePopupTongKet(),this.hidePopupUserProfile(),this.hidePopupPromo(),this.hidePopupFirstTopup()},_initEvents:function(){this._listEvents=[],this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.SYSTEM_MESSAGE.toString(),this._showMessageSystem.bind(this)))},_showMessageSystem:function(t){t=t.getUserData();var e={Msg:BinaryConstants.DataTypeID.StringDynamic};t=(new BinaryParser).init(e,t.content),this.showPopupMsg(t.Msg),JFGameInfo.JFMain.hideLoading()},showPopupAwardOnline:function(){this.popupAwardOnline||(this.popupAwardOnline=new JFPopupAwardOnline,this.onShowPopup(this.popupAwardOnline),this.popupAwardOnline.onOpen())},hidePopupAwardOnline:function(){this.popupAwardOnline&&(this.onHidePopup(this.popupAwardOnline),this.popupAwardOnline=null)},showPopupWebview:function(t,e){this.popupWebview||(this.popupWebview=new JFPopupWebview,this.popupWebview.isShowAlone=e,this.onShowPopup(this.popupWebview),this.popupWebview.loadAPI(t))},hidePopupWebview:function(){this.popupWebview&&(this.onHidePopup(this.popupWebview),this.popupWebview=null)},showPopupDisplayName:function(){this.popupDisplayName||(this.popupDisplayName=new JFPopupDisplayName,this.onShowPopup(this.popupDisplayName),this.popupDisplayName.x=JFGameInfo.appRealWidth/2,this.popupDisplayName.y=JFGameInfo.appRealHeight/2)},hidePopupDisplayName:function(){this.popupDisplayName&&(this.onHidePopup(this.popupDisplayName),this.popupDisplayName=null)},showPopupTopDamage:function(){this.popupTopDamage||(this.popupTopDamage=new JFPopupTopDamage,this.onShowPopup(this.popupTopDamage))},hidePopupTopDamage:function(){this.popupTopDamage&&(this.onHidePopup(this.popupTopDamage),this.popupTopDamage=null)},showPopupChangePass:function(){this.popupChangePass||(this.popupChangePass=new JFPopupChangePass,this.onShowPopup(this.popupChangePass))},hidePopupChangePass:function(){this.popupChangePass&&(this.onHidePopup(this.popupChangePass),this.popupChangePass=null)},showPopupListAvatar:function(){this.popupListAvatar||(this.popupListAvatar=new JFPopupListAvatar,this.onShowPopup(this.popupListAvatar)),this.setVisible(!0)},hidePopupListAvatar:function(){this.popupListAvatar&&(this.onHidePopup(this.popupListAvatar),this.popupListAvatar=null)},showPopupMiniGame:function(){this.popupMiniGame||(this.popupMiniGame=new JFPopupMiniGame,this.onShowPopup(this.popupMiniGame)),this.setVisible(!0)},hidePopupMiniGame:function(){this.popupMiniGame&&(this.onHidePopup(this.popupMiniGame),this.popupMiniGame=null)},showPopupJackpot:function(t){this.popupJackpot||(this.popupJackpot=new JFPopupJackpot(t),this.onShowPopup(this.popupJackpot))},hidePopupJackpot:function(){this.popupJackpot&&(this.onHidePopup(this.popupJackpot),this.popupJackpot=null)},showPopupXepHangTaiXiu:function(t,e){this.popupXepHangTaiXiu||(this.popupXepHangTaiXiu=new JFPopupXepHangTaiXiu(t,e),this.onShowPopup(this.popupXepHangTaiXiu)),this.setVisible(!0)},hidePopupXepHangTaiXiu:function(){this.popupXepHangTaiXiu&&(this.onHidePopup(this.popupXepHangTaiXiu),this.popupXepHangTaiXiu=null)},showPopupThongKeTaiXiu:function(t,e){this.popupThongKeTaiXiu||(this.popupThongKeTaiXiu=new JFPopupThongKeTaiXiu(t,e),this.onShowPopup(this.popupThongKeTaiXiu)),this.setVisible(!0)},hidePopupThongKeTaiXiu:function(){this.popupThongKeTaiXiu&&(this.onHidePopup(this.popupThongKeTaiXiu),this.popupThongKeTaiXiu=null)},showPopupLichSuTaiXiu:function(t,e){this.popupLichSuTaiXiu||(this.popupLichSuTaiXiu=new JFPopupLichSuTaiXiu(t,e),this.onShowPopup(this.popupLichSuTaiXiu)),this.setVisible(!0)},hidePopupLichSuTaiXiu:function(){this.popupLichSuTaiXiu&&(this.onHidePopup(this.popupLichSuTaiXiu),this.popupLichSuTaiXiu=null)},showPopupHuongDanTaiXiu:function(){this.popupHuongDanTaiXiu||(this.popupHuongDanTaiXiu=new JFPopupHuongDanTaiXiu,this.onShowPopup(this.popupHuongDanTaiXiu)),this.setVisible(!0)},hidePopupHuongDanTaiXiu:function(){this.popupHuongDanTaiXiu&&(this.onHidePopup(this.popupHuongDanTaiXiu),this.popupHuongDanTaiXiu=null)},showPopupHistorySlot:function(t){this.popupHistorySlot||(this.popupHistorySlot=new JFPopupHistorySlot(t),this.onShowPopup(this.popupHistorySlot))},hidePopupHistorySlot:function(){this.popupHistorySlot&&(this.onHidePopup(this.popupHistorySlot),this.popupHistorySlot=null)},showPopupTutorialSlot:function(){this.popupTutorialSlot||(this.popupTutorialSlot=new JFPopupTutorialSlot,this.onShowPopup(this.popupTutorialSlot)),this.setVisible(!0)},hidePopupTutorialSlot:function(){this.popupTutorialSlot&&(this.onHidePopup(this.popupTutorialSlot),this.popupTutorialSlot=null)},showPopupTopFreeSlot:function(t){this.popupTopFreeSlot||(this.popupTopFreeSlot=new JFPopupTopFreeSlot(t),this.onShowPopup(this.popupTopFreeSlot)),this.setVisible(!0)},hidePopupTopFreeSlot:function(){this.popupTopFreeSlot&&(this.onHidePopup(this.popupTopFreeSlot),this.popupTopFreeSlot=null)},showPopupTopWinSlot:function(t){this.popupTopWinSlot||(this.popupTopWinSlot=new JFPopupTopWinSlot(t),this.onShowPopup(this.popupTopWinSlot)),this.setVisible(!0)},hidePopupTopWinSlot:function(){this.popupTopWinSlot&&(this.onHidePopup(this.popupTopWinSlot),this.popupTopWinSlot=null)},onShowPopup:function(t){t.isShowAlone?this.popupAloneShowed||(t.initObj(),this.addChild(t),this.popupAloneShowed=!0,this.setVisible(!0),this._listPopup.push(t)):(t.initObj(),this.addChild(t),this._listPopup.push(t),this.setVisible(!0))},onHidePopup:function(t){if(t){t.isShowAlone&&this.popupAloneShowed&&(this.popupAloneShowed=!1);for(var e=0;e<this._listPopup.length;e++)this._listPopup[e]===t&&this._listPopup.splice(e,1);t.removeFromParent()}0==this.getChildren().length&&this.setVisible(!1)},hidePopupSequence:function(){0<this._listPopup.length&&this._listPopup[this._listPopup.length-1].dispose()}}),JFPopupSupport=(JFPopupLogin=JFUIBaseLayer.extend({isShowAlone:null,tab_username:null,tab_password:null,ctor:function(){JFUIBaseLayer.prototype.ctor.call(this),this.isShowAlone=!0},initObj:function(){this._initFromCocostudio(ResourceManager.JFResourcesMenuGame.CSSUILoginPopup),this.cloneTextField(this._mainLayer.getChildByName("JFtxtUserName")),this.cloneTextField(this._mainLayer.getChildByName("JFtxtPassword"));var t=cc.sys.localStorage.getItem("UserNameToShow"),e=cc.sys.localStorage.getItem("PasswordToShow");null!=t&&null!=e&&""!=t&&""!=e&&(this._mainLayer.getChildByName("JFtxtUserName").setString(t),this._mainLayer.getChildByName("JFtxtPassword").setString(e)),this.tab_username=this._mainLayer.getChildByName("JFtxtUserName"),this.tab_password=this._mainLayer.getChildByName("JFtxtPassword"),this.tab_password.setInputFlag(0)},onClickBtnFromCocostudio:function(t,e){switch(t.getName()){case"JFButton_Login":JFGameInfo.JFMain.showLoading(),this._mainLayer.getChildByName("JFButton_Login").setEnabled(!1),this.onLogin();break;case"JFButton_Close":jf.audio.playEffect(ResourceManager.JFResourcesMenuGame.SoundClose,!1),JFGameInfo.JFMain.layerPopup.hidePopupLogin();break;case"Button_FogotPass":this.dispose(),JFGameInfo.JFMain.layerPopup.showPopupSupport()}},onLogin:function(){var t;JFGameInfo.JFMain.showLoading(),this.checkValue()?((t={}).OpenProviderId=ConstantsVariable.LoginProviderID.Normal,t.Password=this._mainLayer.getChildByName("JFtxtPassword").getString(),t.Username=this._mainLayer.getChildByName("JFtxtUserName").getString(),t.PlatformID=JFGameInfo.myPlatform,t.AppVersion=JFGameInfo.AppVersion,t.HardwareID=JFGameInfo.devineID,t.ChannelId=ConstantsVariable.CHANNEL_ID,t.VersionDevice=JFGameInfo.VersionDevice,t.DeviceModel=JFGameInfo.DeviceModel,t.packetName=JFGameInfo.packetName,t.Sign=md5.encscript("Login"+t.OpenProviderId+t.Password+t.Username+t.PlatformID+t.AppVersion+t.HardwareID+t.ChannelId+t.VersionDevice+t.DeviceModel+t.packetName),Utilities.getAPI("Login",t,this.onCallBackLogin.bind(this))):(this._mainLayer.getChildByName("JFButton_Login").setEnabled(!0),JFGameInfo.JFMain.hideLoading())},onCallBackLogin:function(t){if(t=JSON.parse(t),Utilities.logGA(ConstantsVariable.GA_LOG.LOGIN_NORMAL),1===t.Result){cc.sys.localStorage.setItem("UserName",this._mainLayer.getChildByName("JFtxtUserName").getString()),cc.sys.localStorage.setItem("Password",this._mainLayer.getChildByName("JFtxtPassword").getString()),cc.sys.localStorage.setItem("UserNameToShow",this._mainLayer.getChildByName("JFtxtUserName").getString()),cc.sys.localStorage.setItem("PasswordToShow",this._mainLayer.getChildByName("JFtxtPassword").getString());var e=t.Data.Data;JFGameInfo.myInfo.token4Master=e.TokenGame,JFGameInfo.myInfo.token4Ws=e.TokenAPI,JFGameInfo.myInfo.avatarPath=e.EmotionPath,JFGameInfo.myInfo.PubUserId=e.PubUserId,JFGameInfo.myInfo.promotionPathAvatar=e.PromotionPatch,JFGameInfo.myInfo.promotionBorder=e.BorderAvatarLevel;for(var i=JSON.parse(e.PromotionPatch),n=0;n<i.length;n++){var s=i[n];s.status&&(JFGameInfo.myInfo.isPaymentFirst=s.status)}cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.REFRESH_AVATAR_USER),cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.REFRESH_BORDER_AVATAR),cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.CHECK_USER_LOGIN),JFGameInfo.DevVersion||(PreLoaderConfig.ServerAndPortMaster=e.SocketKey),Utilities.showLog("dataDetail.SocketKey "+e.SocketKey),PreLoaderConfig.PathToAvatarDefault=e.AvatarDefault,""==PreLoaderConfig.ServerAndPortMaster||null==PreLoaderConfig.ServerAndPortMaster||PreLoaderConfig.ServerAndPortMaster.length<2?(JFGameInfo.JFMain.hideLoading(),JFGameInfo.JFMain.layerPopup.showPopupMsg("API đăng nhập lỗi không tìm được địa chỉ Server")):""==JFGameInfo.myInfo.token4Master||null==JFGameInfo.myInfo.token4Master?(JFGameInfo.JFMain.layerPopup.showPopupMsg(t.Message),this._mainLayer.getChildByName("JFButton_Login").setEnabled(!0)):(JFGameInfo.IsLoginNormal=!0,JFGameInfo.JFMain.connectMasterServer())}else t=t.Message.replace(/\\n/g,"\n"),JFGameInfo.JFMain.layerPopup.showPopupMsg(t),this._mainLayer.getChildByName("JFButton_Login").setEnabled(!0),JFGameInfo.JFMain.pushFirebaseLoginFailed(!0,t)},checkValue:function(){var t=0,e=this._mainLayer.getChildByName("JFtxtPassword").getString();return""==this._mainLayer.getChildByName("JFtxtUserName").getString()?(this._mainLayer.getChildByName("JFmsgNick").setVisible(!0),t++):this._mainLayer.getChildByName("JFmsgNick").setVisible(!1),""==e?(this._mainLayer.getChildByName("JFmsgPass").setVisible(!0),t++):this._mainLayer.getChildByName("JFmsgPass").setVisible(!1),!(0<t)},dispose:function(){JFGameInfo.JFMain.layerPopup.hidePopupLogin()}}),JFUIBaseLayer.extend({isShowAlone:null,ctor:function(){JFUIBaseLayer.prototype.ctor.call(this),this.isShowAlone=!0},initObj:function(){this._initFromCocostudio(ResourceManager.JFResourcesMenuGame.CSSUISupportPopup),this._initInfo()},_initInfo:function(){this._mainLayer.getChildByName("Btn_SP_Facebook").ignoreContentAdaptWithSize(!0),this._mainLayer.getChildByName("Btn_SP_Telegram").ignoreContentAdaptWithSize(!0),this._mainLayer.getChildByName("Btn_SP_Admin").ignoreContentAdaptWithSize(!0)},onClickBtnFromCocostudio:function(t,e){switch(t.getName()){case"JFButton_Close":jf.audio.playEffect(ResourceManager.JFResourcesMenuGame.SoundClose,!1),JFGameInfo.JFMain.layerPopup.hidePopupSupport();break;case"Btn_SP_Telegram":cc.sys.openURL(PreLoaderConfig.LINKS.FANPAGE_TELEGRAM);break;case"Btn_SP_Facebook":cc.sys.openURL(PreLoaderConfig.LINKS.FANPAGE_FACEBOOK);break;case"Btn_SP_Admin":cc.sys.openURL(PreLoaderConfig.LINKS.ADMIN)}},dispose:function(){JFGameInfo.JFMain.layerPopup.hidePopupSupport()}})),JFPopupRegister=JFUIBaseLayer.extend({txtUserName:null,txtPassword:null,txtComfimPass:null,txtCapcha:null,txtMsgNick:null,txtMsgPass:null,txtMsgComfim:null,txtMsgCapcha:null,imgCapcha:null,countBug:0,reg:null,isShowAlone:null,userName:null,password:null,ctor:function(){JFUIBaseLayer.prototype.ctor.call(this),this.isShowAlone=!0},initObj:function(){this._initFromCocostudio(ResourceManager.JFResourcesMenuGame.CSSUIRegitPopup),this.cloneTextField(this._mainLayer.getChildByName("JFtxtUserName")),this.cloneTextField(this._mainLayer.getChildByName("JFtxtPassword")),this.cloneTextField(this._mainLayer.getChildByName("JFtxtComfimPass")),this.cloneTextField(this._mainLayer.getChildByName("JFtxtCapcha")),this.txtUserName=this._mainLayer.getChildByName("JFtxtUserName"),this.txtPassword=this._mainLayer.getChildByName("JFtxtPassword"),this.txtComfimPass=this._mainLayer.getChildByName("JFtxtComfimPass"),this.txtCapcha=this._mainLayer.getChildByName("JFtxtCapcha"),this.txtMsgNick=this._mainLayer.getChildByName("JFmsgNick"),this.txtMsgPass=this._mainLayer.getChildByName("JFmsgPass"),this.txtMsgComfim=this._mainLayer.getChildByName("JFmsgComfim"),this.txtMsgCapcha=this._mainLayer.getChildByName("JFmsgCapcha"),this.imgCapcha=this._mainLayer.getChildByName("JFImgCapcha"),this.reg=/^[0-9a-zA-Z]+$/,this.onRefesh(),this.txtPassword.setInputFlag(0),this.txtComfimPass.setInputFlag(0)},onClickBtnFromCocostudio:function(t,e){switch(t.getName()){case"JFButton_Close":jf.audio.playEffect(ResourceManager.JFResourcesMenuGame.SoundClose,!1),JFGameInfo.JFMain.layerPopup.hidePopupRegister();break;case"JFButton_Refesh":JFGameInfo.JFMain.showLoading(),this.onRefesh();break;case"JFButton_Regit":JFGameInfo.JFMain.showLoading(),this.onRegit()}},onRefesh:function(){var t={};t.PlatformID=JFGameInfo.myPlatform,t.AppVersion=JFGameInfo.AppVersion,t.HardwareID=JFGameInfo.devineID,t.VersionDevice=JFGameInfo.VersionDevice,t.DeviceModel=JFGameInfo.DeviceModel,t.packetName=JFGameInfo.packetName,t.ChannelId=JFGameInfo.ChannelID,t.Sign=md5.encscript("CaptCha"+t.PlatformID+t.AppVersion+t.HardwareID+t.ChannelId+t.VersionDevice+t.DeviceModel+t.packetName),Utilities.getAPI("CaptCha",t,this.onCallBackGetCapcha.bind(this))},onCallBackGetCapcha:function(t){JFGameInfo.JFMain.hideLoading(),1==(t=JSON.parse(t)).Result&&cc.loader.loadImg(t.Data.CaptchaLink,{isCrossOrigin:!0},this.onLoadBase64Image.bind(this))},onLoadBase64Image:function(t,e){t||(this.imgCapcha.removeAllChildren(!0),(t=new cc.Sprite(e)).setPosition(-5,-5),this.imgCapcha.addChild(t))},onRegit:function(){var t;this.checkValue()?(JFGameInfo.JFMain.showLoading(),this.userName=this.txtUserName.getString(),this.password=this.txtPassword.getString(),(t={}).Nickname=this.userName,t.Password=this.password,t.VersionDevice=JFGameInfo.VersionDevice,t.Captcha=this.txtCapcha.getString(),t.DeviceModel=JFGameInfo.DeviceModel,t.packetName=JFGameInfo.packetName,t.PlatformID=JFGameInfo.myPlatform,t.AppVersion=JFGameInfo.AppVersion,t.HardwareID=JFGameInfo.devineID,t.DisplayName="",t.ChannelId=JFGameInfo.ChannelID,t.Sign=md5.encscript("Register"+t.DisplayName+t.Nickname+t.Password+t.Captcha+t.PlatformID+t.AppVersion+t.HardwareID+t.ChannelId+t.VersionDevice+t.DeviceModel+t.packetName),Utilities.getAPI("Register",t,this.onCallBackRegit.bind(this))):JFGameInfo.JFMain.hideLoading()},onCallBackRegit:function(t){var e=JSON.parse(t);Utilities.logGA(ConstantsVariable.GA_LOG.REGISTER_NORMAL),1==e.Result?((t={}).platform=Utilities.getOSType(),Utilities.pushEventFirebase("register_successed",t),JFGameInfo.JFMain.layerPopup.hidePopupRegister(),cc.sys.localStorage.setItem("UserName",this.userName),cc.sys.localStorage.setItem("Password",this.password),cc.sys.localStorage.setItem("UserNameToShow",this.userName),cc.sys.localStorage.setItem("PasswordToShow",this.password),t=e.Data.Data,JFGameInfo.myInfo.token4Master=t.TokenGame,JFGameInfo.myInfo.token4Ws=t.TokenAPI,JFGameInfo.myInfo.avatarPath=t.EmotionPath,JFGameInfo.myInfo.PubUserId=t.PubUserId,cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.REFRESH_AVATAR_USER),cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.REFRESH_BORDER_AVATAR),cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.CHECK_USER_LOGIN),JFGameInfo.DevVersion||(PreLoaderConfig.ServerAndPortMaster=t.SocketKey),PreLoaderConfig.PathToAvatarDefault=t.AvatarDefault,""==PreLoaderConfig.ServerAndPortMaster||null==PreLoaderConfig.ServerAndPortMaster||PreLoaderConfig.ServerAndPortMaster.length<2?(JFGameInfo.JFMain.hideLoading(),JFGameInfo.JFMain.layerPopup.showPopupMsg("API đăng nhập lỗi không tìm được địa chỉ Server"),JFGameInfo.JFMain.pushFirebaseLoginFailed(!0,"API đăng nhập lỗi không tìm được địa chỉ Server")):""==JFGameInfo.myInfo.token4Master||null==JFGameInfo.myInfo.token4Master?(JFGameInfo.JFMain.hideLoading(),JFGameInfo.JFMain.layerPopup.showPopupMsg(PreLoaderConfig.Messages.ERROR_LOGIN),JFGameInfo.JFMain.pushFirebaseLoginFailed(!0,PreLoaderConfig.Messages.ERROR_LOGIN)):(JFGameInfo.IsLoginNormal=!0,JFGameInfo.JFMain.connectMasterServer())):(e=e.Message.replace(/\\n/g,"\n"),JFGameInfo.JFMain.layerPopup.showPopupMsg(e),this.onRefesh(),(t={}).platform=Utilities.getOSType(),t.errorcode=e,Utilities.pushEventFirebase("register_failed",t))},checkValue:function(){return this.countBug=0,""==this.txtUserName.getString()?(this.txtMsgNick.setString("Nhập tên đăng nhập"),this.txtMsgNick.visible=!0,this.countBug++):this.reg.test(this.txtUserName.getString())?this.txtUserName.getString().length<6||15<this.txtUserName.getString().length?(this.txtMsgNick.setString("Tên đăng nhập tối thiểu 6 ký tự và tối đa 15 ký tự"),this.txtMsgNick.visible=!0,this.countBug++):this.txtMsgNick.visible=!1:(this.txtMsgNick.setString('Tên đăng nhập chỉ chứa "a-z" và "0-9"'),this.txtMsgNick.visible=!0,this.countBug++),""==this.txtPassword.getString()?(this.txtMsgPass.setString("Nhập mật khẩu"),this.txtMsgPass.visible=!0,this.countBug++):this.txtPassword.getString().length<6||15<this.txtPassword.getString().length?(this.txtMsgPass.setString("Mật khẩu tối thiểu 6 ký tự và tối đa 15 ký tự"),this.txtMsgPass.visible=!0,this.countBug++):this.txtMsgPass.visible=!1,""==this.txtComfimPass.getString()?(this.txtMsgComfim.setString("Nhập xác nhận mật khẩu"),this.txtMsgComfim.visible=!0,this.countBug++):this.txtMsgComfim.visible=!1,this.txtComfimPass.getString()!=this.txtPassword.getString()?(this.txtMsgComfim.setString("Mật khẩu không khớp"),this.txtMsgComfim.visible=!0,this.countBug++):this.txtMsgComfim.visible=!1,""==this.txtCapcha.getString()?(this.txtMsgCapcha.visible=!0,this.countBug++):this.txtMsgCapcha.visible=!1,!(0<this.countBug)},dispose:function(){JFGameInfo.JFMain.layerPopup.hidePopupRegister()}}),JFPopupDisplayName=JFUIBaseNode.extend({txtDisplayName:null,callBackFunc:null,name:null,reg:null,_listEvents:null,isShowAlone:null,ctor:function(){this.isShowAlone=!1,JFUIBaseNode.prototype.ctor.call(this)},initObj:function(){this._initFromCocostudio(ResourceManager.JFResourcesMenuGame.CSSJFDisplayName),this.cloneTextField(this._mainLayer.getChildByName("TxTEditDisplayName")),this.txtDisplayName=this._mainLayer.getChildByName("TxTEditDisplayName"),this.txtMsg=this._mainLayer.getChildByName("JFMsg"),this._initEvents(),this.reg=/^[0-9a-zA-Z]+$/,this._mainLayer.getChildByName("PanelBG").addClickEventListener(this.onClickBtnFromCocostudio.bind(this)),Utilities.showLog("this.txtDisplayName get String "+this.txtDisplayName.getString()),Utilities.showLog("this.txtDisplayName get name "+this.name)},_initEvents:function(){this._listEvents=[],this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.UPDATE_DISPLAY_NAME.toString(),this._ngUpdateDislayName.bind(this)))},_setccuiLayout:function(){var t=this._mainLayer.getChildByName("JFBackGround").getChildByName("JFBackground");t&&(this._layerbg=new ccui.Layout,this.addChild(this._layerbg),this._layerbg.setLocalZOrder(-1),this._layerbg.setContentSize(t.getContentSize()),this._layerbg.setAnchorPoint(t.getAnchorPoint()),this._layerbg.setPosition(t.getPosition()),this._layerbg.setTouchEnabled(!0),this._layerbg.setOpacity(0))},onClickBtnFromCocostudio:function(t,e){switch(t.getName()){case"JFButton_Close":case"PanelBG":this.dispose();break;case"JFButton_Confirm":this._nsOnUpdate()}},_nsOnUpdate:function(){var t;this.checkValue()&&(t=this.txtDisplayName.getString(),this.name=t,JFGameInfo.JFMain.netSend.sendUpdateDisplayName(t))},checkValue:function(){var t=this.txtDisplayName.getString();return this.txtMsg.setVisible(!1),""==t?(this.txtMsg.setString("Nhập tên hiển thị"),this.txtMsg.setVisible(!0),!1):this.reg.test(t)?!(t.length<6||15<t.length)||(this.txtMsg.setString("Tên dài từ 6 - 15 ký tự"),this.txtMsg.setVisible(!0),!1):(this.txtMsg.setString('Tên hiển thị chỉ chứa "a-z" và "0-9"'),this.txtMsg.setVisible(!0),!1)},_ngUpdateDislayName:function(t){t=t.getUserData();var e={Result:BinaryConstants.DataTypeID.Int8};1==(new BinaryParser).init(e,t.content).Result&&(Utilities.showLog(" _ngUpdateDislayName "+this.name),Utilities.showLog(" _ngUpdateDislayName "+JFGameInfo.myInfo.Nickname),""!=this.name&&(JFGameInfo.myInfo.Nickname=this.name),JFGameInfo.JFMain.layerPopup.popupUserInfo&&JFGameInfo.JFMain.layerPopup.popupUserInfo.updateDisplayName(),this.dispose())},dispose:function(){for(var t=0;t<this._listEvents.length;t++)cc.eventManager.removeListener(this._listEvents[t]);this.txtDisplayName.setString(""),this._listEvents.length=0,this.name="",JFGameInfo.JFMain.layerPopup.hidePopupDisplayName()}}),JFPopupMsg=(JFPopupWebview=JFUIBaseLayer.extend({title:null,contain:null,pageType:null,isShowAlone:null,ctor:function(){JFUIBaseLayer.prototype.ctor.call(this),this.isShowAlone=!0},initObj:function(){this._initFromCocostudio(ResourceManager.JFResourcesMenuGame.CSSUIWebviewPopup),this.title=this._mainLayer.getChildByName("JFTitle"),this.contain=this._mainLayer.getChildByName("JFContain")},loadAPI:function(t){JFGameInfo.JFMain.showLoading(),this.pageType=t,this.initHeader();var e={};e.PageType=t,e.UserID=JFGameInfo.myInfo.UserID,e.PlatformID=JFGameInfo.myPlatform,e.AppVersion=JFGameInfo.AppVersion,e.HardwareID=JFGameInfo.devineID,e.ChannelId=JFGameInfo.ChannelID,e.VersionDevice=JFGameInfo.VersionDevice,e.DeviceModel=JFGameInfo.DeviceModel,e.packetName=JFGameInfo.packetName,e.Sign=md5.encscript("GetLink"+e.PageType+e.UserID+e.PlatformID+e.AppVersion+e.HardwareID+e.ChannelId+e.VersionDevice+e.DeviceModel+e.packetName+JFGameInfo.myInfo.token4Ws),Utilities.getAPI("GetLink",e,this.onLoadPage.bind(this))},initHeader:function(){switch(this.pageType){case ConstantsVariable.WEBVIEW.NEWS:var t=new cc.Sprite("#TitleNews.png");this.title.addChild(t);break;case ConstantsVariable.WEBVIEW.DOI_THUONG:t=new cc.Sprite("#TitleGif.png"),this.title.addChild(t);break;case ConstantsVariable.WEBVIEW.NAP_XU:t=new cc.Sprite("#TitleShop.png"),this.title.addChild(t);break;case ConstantsVariable.WEBVIEW.MANH_THE:t=new cc.Sprite("#TittleNotice.png"),this.title.addChild(t);break;case ConstantsVariable.WEBVIEW.NHIEM_VU:t=new cc.Sprite("#TitleMission.png"),this.title.addChild(t);break;case ConstantsVariable.WEBVIEW.NHAN_THUONG:case ConstantsVariable.WEBVIEW.SanLiXi:t=new cc.Sprite("#TitlePhanThuong.png"),this.title.addChild(t);break;case ConstantsVariable.WEBVIEW.USER_ONLINE:t=new cc.Sprite("#TitleListUsersOnline.png"),this.title.addChild(t);break;case ConstantsVariable.WEBVIEW.BANG_XEP_HANG:t=new cc.Sprite("#TittleRank.png"),this.title.addChild(t);break;case ConstantsVariable.WEBVIEW.UU_DAI_NAP_THE:t=new cc.Sprite("#headerUuDaiNapThe.png"),this.title.addChild(t);break;case ConstantsVariable.WEBVIEW.NAP_TICH_LUY:t=new cc.Sprite("#headerTichLuyNapThe.png"),this.title.addChild(t);break;case ConstantsVariable.WEBVIEW.KICH_HOAT_CODE:t=new cc.Sprite("#headerKichHoatCode.png"),this.title.addChild(t);break;case ConstantsVariable.WEBVIEW.HOP_THU:t=new cc.Sprite("#TittleEmail.png"),this.title.addChild(t);break;case ConstantsVariable.WEBVIEW.RUONG:t=new cc.Sprite("#TitleChest.png"),this.title.addChild(t);break;case ConstantsVariable.WEBVIEW.BAN_BE:t=new cc.Sprite("#BanBe.png"),this.title.addChild(t)}},onLoadPage:function(t){JFGameInfo.JFMain.hideLoading(),Utilities.showLog("WEBVIEW_DATA:"+t),1==(t=JSON.parse(t)).Result?JFGameInfo.JFMain.getWebview().loadURL(t.Data.Link):(JFGameInfo.JFMain.layerPopup.hidePopupWebview(),""!=t.Message&&JFGameInfo.JFMain.layerPopup.showPopupMsg(t.Message))},onClickBtnFromCocostudio:function(t,e){"JFButtonClose"===t.getName()&&(this.pageType===ConstantsVariable.WEBVIEW.NHAN_THUONG&&JFGameInfo.JFMain.netSend.sendGetAwardStatus(),JFGameInfo.JFMain.removeWebview(),JFGameInfo.JFMain.layerPopup.hidePopupWebview())},dispose:function(){JFGameInfo.JFMain.removeWebview(),JFGameInfo.JFMain.layerPopup.hidePopupWebview()}}),JFUIBaseLayer.extend({confirmCallBack:null,btnComfirm:null,isShowAlone:null,ctor:function(){JFUIBaseLayer.prototype.ctor.call(this),this.isShowAlone=!1},initObj:function(){this._initFromCocostudio(ResourceManager.JFResourcesMenuGame.CSSUIMessagePopup),this.btnComfirm=this._mainLayer.getChildByName("JFButtonComfirm")},onClickBtnFromCocostudio:function(t,e){switch(t.setTouchEnabled(!1),t.getName()){case"JFButton_Close":cc.audioEngine.playEffect(ResourceManager.JFResourcesMenuGame.SoundClose,!1),JFGameInfo.JFMain.layerPopup.hidePopupMsg();break;case"JFButtonComfirm":this.confirmCallBack&&this.confirmCallBack(),JFGameInfo.JFMain.layerPopup.hidePopupMsg(),cc.audioEngine.playEffect(ResourceManager.JFResourcesMenuGame.SoundClose,!1)}},setMessage:function(t,e,i){i?(this.confirmCallBack=i,this.btnComfirm.setVisible(!0)):(this.btnComfirm.setVisible(!1),this.confirmCallBack=null),null!=e&&""!=e&&this.btnComfirm.setTitleText(e),this._mainLayer.getChildByName("JFMsgPopupTxT").setString(t)},dispose:function(){this.btnComfirm=this.confirmCallBack=null,JFGameInfo.JFMain.layerPopup.hidePopupMsg()}})),JFPopupSetting=JFUIBaseLayer.extend({sliderSound:null,sliderMusic:null,isShowAlone:null,btn3D:null,valueMusic:null,valueSound:null,ctor:function(){JFUIBaseLayer.prototype.ctor.call(this),this.isShowAlone=!0},initObj:function(){this._initFromCocostudio(ResourceManager.JFResourcesMenuGame.CSSUISettingPopup),this.sliderSound=this._mainLayer.getChildByName("JFSlider_Sound"),this.sliderMusic=this._mainLayer.getChildByName("JFSlider_Music"),this.btn3D=this._mainLayer.getChildByName("BtnTo3D"),cc.sys.isNative?(this._mainLayer.getChildByName("JFLblChangeVersion").setVisible(!1),this.btn3D.setVisible(!1),this.btn3D.setEnabled(!1)):this.btn3D.addTouchEventListener(this.onClickBtnFromCocostudio.bind(this)),this._mainLayer.getChildByName("JFLblSound").ignoreContentAdaptWithSize(!0),this._mainLayer.getChildByName("JFLblMusic").ignoreContentAdaptWithSize(!0),this.sliderSound.setPercent(jf.audio.getEffectsVolume()),this.sliderMusic.setPercent(jf.audio.getMusicVolume()),this.initEvent()},initEvent:function(){this.sliderSound.addTouchEventListener(this.onSliderSoundTouch.bind(this)),this.sliderMusic.addTouchEventListener(this.onSliderMusicTouch.bind(this))},onClickBtnFromCocostudio:function(t,e){switch(t.getName()){case"JFButton_Close":jf.audio.playEffect(ResourceManager.JFResourcesMenuGame.SoundClose,!1),JFGameInfo.JFMain.layerPopup.hidePopupSetting();break;case"BtnTo3D":JFGameInfo.JFMain.layerPopup.showPopupMsg(ConstantsVariable.Messages.CONFIRM_CHANGE_VERSION,this.changeVersion.bind(this))}},onSliderSoundTouch:function(t,e){e==ccui.Widget.TOUCH_ENDED&&(JFGameInfo.currSound=this.sliderSound.getPercent(),jf.audio.setEffectsVolume(JFGameInfo.currSound,!0))},onSliderMusicTouch:function(t,e){e==ccui.Widget.TOUCH_ENDED&&(JFGameInfo.currMusic=this.sliderMusic.getPercent(),jf.audio.setMusicVolume(JFGameInfo.currMusic,!0))},changeVersion:function(){try{Dialog.BackToVersion()}catch(t){}},dispose:function(){JFGameInfo.JFMain.layerPopup.hidePopupSetting()}}),JFUserItem=cc.Node.extend({_avatar:null,_data:null,ctor:function(t){cc.Node.prototype.ctor.call(this),this._data=t},initObj:function(){this._initEvents()},_initAvatar:function(){this.updateAvatar()},_initEvents:function(t){},cloneFromNode:function(t){for(this.setName(t.getName()),this.setPosition(t.getPosition()),t.getChildByName("JFBackground")&&this.setContentSize(t.getChildByName("JFBackground").getContentSize()),this.setVisible(t.isVisible()),this.setLocalZOrder(t.getLocalZOrder());0<t.getChildrenCount();){var e=t.getChildren()[0];e.removeFromParent(),this.addChild(e)}t.removeFromParent(),this.getChildByName("JFTxtUserName").setString(this._data.DisplayName),this.getChildByName("JFTxtLevel").setString(this._data.Level),this.getChildByName("JFTxtCoin").setString(this._data.CoinCurrent),this._initAvatar()},updateAvatar:function(){this._avatar&&this._avatar.getParent()&&this._avatar.removeFromParent(),this._avatar=null,void 0!==this._avatar&&this._avatar||(""!=this._data.Avatar?cc.loader.loadImg(this._data.Avatar,{isCrossOrigin:!0},this._onLoadAvatarComplete.bind(this)):this._loadAvatarDefault())},_loadAvatarDefault:function(){cc.loader.loadImg(PreLoaderConfig.PathToAvatarDefault,{isCrossOrigin:!0},this._onLoadAvatarDefault.bind(this))},_onLoadAvatarComplete:function(t,e){t?this._loadAvatarDefault():(this._avatar&&(this._avatar.removeFromParent(),this._avatar=null),JFGameInfo.myInfo.avatarImage=e,this._avatar&&void 0!==this._avatar||(this._avatar=new cc.Sprite(JFGameInfo.myInfo.avatarImage),this.getChildByName("JFAvatar").addChild(this._avatar)),this._avatar.scaleX=86/e.width,this._avatar.scaleY=86/e.height,this._avatar.setLocalZOrder(-10),this._avatar.y=-4)},_onLoadAvatarDefault:function(t,e){e&&(JFGameInfo.myInfo.avatarImage=e,this._avatar&&void 0!==this._avatar||(this._avatar=new cc.Sprite(e),this.getChildByName("JFAvatar").addChild(this._avatar)),this._avatar.scaleX=86/e.width,this._avatar.scaleY=86/e.height,this._avatar.setLocalZOrder(-10),this._avatar.y=-4)}}),JFPopupUsersOnline=JFUIBaseLayer.extend({_item:null,_scrollViewUsers:null,_scrollPage:null,_listDataUser:null,isShowAlone:null,ctor:function(){JFUIBaseLayer.prototype.ctor.call(this),this.isShowAlone=!0},initObj:function(){this._initFromCocostudio(ResourceManager.JFResourcesMenuGame.CSSUIListUsersOnlinePopup),this._getDataUserOnline(),this._initScrollViewUsers()},_getDataUserOnline:function(){JFGameInfo.JFMain.showLoading();var t={};t.UserID=JFGameInfo.myInfo.UserID,t.PlatformID=JFGameInfo.myPlatform,t.AppVersion=JFGameInfo.AppVersion,t.HardwareID=JFGameInfo.devineID,t.packetName=JFGameInfo.packetName,t.VersionDevice=JFGameInfo.VersionDevice,t.DeviceModel=JFGameInfo.DeviceModel,t.ChannelId=JFGameInfo.ChannelID,t.PageNumber=1,t.PageSize=50,t.Sign=MGmd5.encscript("GetUsersOnline"+t.PageNumber+t.PageSize+t.UserID+t.PlatformID+t.AppVersion+t.HardwareID+t.ChannelId+t.VersionDevice+t.DeviceModel+t.packetName+JFGameInfo.myInfo.token4Ws),Utilities.getAPI("GetUsersOnline",t,this._onCallBackGetDataUserOnline.bind(this))},_onCallBackGetDataUserOnline:function(t){JFGameInfo.JFMain.hideLoading(),1===(t=JSON.parse(t)).Result?(this._listDataUser=t.Data.ListData,0<this._listDataUser.length&&this._initScrollViewItem()):JFGameInfo.JFMain.layerPopup.showPopupMsg(t.Message)},_initScrollViewUsers:function(){this._scrollViewUsers=this._mainLayer.getChildByName("ScrollViewUsers"),this._scrollPage=new cc.Node,this._scrollPage.setAnchorPoint(cc.p(0,0))},_initScrollViewItem:function(){for(var t=0,e=1,i=Math.round(this._listDataUser.length/3),n=0;n<this._listDataUser.length;n++){var s=new JFUserItem(this._listDataUser[n]);s.initObj(),s.setAnchorPoint(cc.p(0,0)),s.cloneFromNode(ccs.load(ResourceManager.JFResourcesMenuGame.CSSJFUserItem).node),s.setAnchorPoint(cc.p(-.5,-.5)),this._scrollViewUsers.addChild(s),0!=n&&0==n%3&&(e++,t=0),s.setPositionX((s.getContentSize().width+35)*t),s.setPositionY(215*(i+1)-(s.getContentSize().height+50)*e),t++}this._scrollViewUsers.setInnerContainerSize(cc.size(1126,215*(i+1)))},onClickBtnFromCocostudio:function(t,e){"JFButton_Close"===t.getName()&&(cc.audioEngine.playEffect(ResourceManager.JFResourcesMenuGame.SoundClose,!1),JFGameInfo.JFMain.layerPopup.hidePopupUsersOnline())},_setccuiLayout:function(){var t=this._mainLayer.getChildByName("JFBackground").getChildByName("JFBackground");t&&(this._layerbg=new ccui.Layout,this.addChild(this._layerbg),this._layerbg.setLocalZOrder(-1),this._layerbg.setContentSize(t.getContentSize()),this._layerbg.setAnchorPoint(t.getAnchorPoint()),this._layerbg.setPosition(t.getPosition()),this._layerbg.setTouchEnabled(!0),this._layerbg.setOpacity(0))},dispose:function(){JFGameInfo.JFMain.layerPopup.hidePopupUsersOnline()}}),JFPopupUserInfo=JFUIBaseLayer.extend({_uid:null,_avatar:null,_avatarImage:null,_label:null,btnEdit:null,valueCMNN:null,valueSDT:null,btnAvatar:null,reg:null,_listEvents:null,isShowAlone:null,Avatar:null,ctor:function(t){JFUIBaseLayer.prototype.ctor.call(this),this._uid=t,this.isShowAlone=!0},initObj:function(){this._initFromCocostudio(ResourceManager.JFResourcesMenuGame.CSSUIUserInfoPopup),this.btnEdit=this._mainLayer.getChildByName("ButtonEdit"),this.btnAvatar=this._mainLayer.getChildByName("JFCircleAvatar"),this.Avatar=this._mainLayer.getChildByName("JFClipAvatar").getChildByName("JFNodeImage"),this.btnAvatar&&this.btnAvatar.addClickEventListener(this.onClickBtnFromCocostudio.bind(this)),this.reg=/^[0-9]+$/,this._getData(),this._initEvents(),"true"===cc.sys.localStorage.getItem("facebook")&&this._mainLayer.getChildByName("JFButtonChangePass").setVisible(!1)},_initEvents:function(){this._listEvents=[],this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.EVENTS.REFRESH_POPUP_USER_INFO,this.updateAvatarDispatch.bind(this)))},_getData:function(){JFGameInfo.JFMain.showLoading();var t={};t.UserID=this._uid,t.VersionDevice=JFGameInfo.VersionDevice,t.DeviceModel=JFGameInfo.DeviceModel,t.packetName=JFGameInfo.packetName,t.PlatformID=JFGameInfo.myPlatform,t.AppVersion=JFGameInfo.AppVersion,t.HardwareID=JFGameInfo.devineID,t.ChannelId=JFGameInfo.ChannelID,t.Sign=md5.encscript("GetUserInfo"+t.UserID+t.PlatformID+t.AppVersion+t.HardwareID+t.ChannelId+t.VersionDevice+t.DeviceModel+t.packetName+JFGameInfo.myInfo.token4Ws),Utilities.getAPI("GetUserInfo",t,this._initInfo.bind(this))},_setccuiLayout:function(){var t=this._mainLayer.getChildByName("JFBackground").getChildByName("JFBackground");t&&(this._layerbg=new ccui.Layout,this.addChild(this._layerbg),this._layerbg.setLocalZOrder(-1),this._layerbg.setContentSize(t.getContentSize()),this._layerbg.setAnchorPoint(t.getAnchorPoint()),this._layerbg.setPosition(this._mainLayer.getChildByName("JFBackground").getPosition()),this._layerbg.setTouchEnabled(!0),this._layerbg.setOpacity(1))},_initInfo:function(t){JFGameInfo.JFMain.hideLoading(),null!=t&&((t=JSON.parse(t)).Data.CMND?(this._mainLayer.getChildByName("JFButtonUpdate").setVisible(!1),this._mainLayer.getChildByName("JFBtn_HuongDan").setVisible(!1),this._mainLayer.getChildByName("JFTxT_Line").setVisible(!1),0<t.Data.CMND.length&&(t.Data.CMND="************".slice(0,t.Data.CMND.length-3)+t.Data.CMND.slice(t.Data.CMND.length-3,t.Data.CMND.length),this._mainLayer.getChildByName("JFCMNDInfo").setTouchEnabled(!1),this._mainLayer.getChildByName("JFBGInfoCMND").setVisible(!0),this._mainLayer.getChildByName("JFTextCMND").setVisible(!0),this._mainLayer.getChildByName("JFCMNDInfo").setVisible(!0))):t.Data.CMND="",t.Data.Phone?0<t.Data.Phone.length&&(t.Data.Phone="************".slice(0,t.Data.Phone.length-3)+t.Data.Phone.slice(t.Data.Phone.length-3,t.Data.Phone.length),this._mainLayer.getChildByName("JFPhoneNumberInfo").setTouchEnabled(!1),this._mainLayer.getChildByName("JFBGInfoPhoneNumber").setVisible(!0),this._mainLayer.getChildByName("JFTextPhoneNumber").setVisible(!0),this._mainLayer.getChildByName("JFPhoneNumberInfo").setVisible(!0)):t.Data.Phone="",1==t.Result?(this._mainLayer.getChildByName("JFTextName").setString(JFGameInfo.myInfo.Nickname),this._mainLayer.getChildByName("JFTextLevel").setString(Utilities.formatString(PreLoaderConfig.StringFormat.LEVEL,t.Data.LevelUser)),this._mainLayer.getChildByName("JFTextUID").setString(String(t.Data.PubUserId)),this._mainLayer.getChildByName("JFCoin").setString(Utilities.Coin(String(t.Data.Gold))),this._mainLayer.getChildByName("JFCMNDInfo").setString(String(t.Data.CMND)),this._mainLayer.getChildByName("JFPhoneNumberInfo").setString(t.Data.Phone),0<=JFGameInfo.myInfo.Nickname.indexOf("User")&&this.btnEdit.setVisible(!0),JFGameInfo.myInfo.avatarPath=t.Data.AvatarPath&&""!=t.Data.AvatarPath?t.Data.AvatarPath:1,this.updateAvatar(JFGameInfo.myInfo.avatarPath),this._borderAvatar()):(JFGameInfo.JFMain.layerPopup.hidePopupUserInfo(),JFGameInfo.JFMain.layerPopup.showPopupMsg(t.Message)))},updateAvatarDispatch:function(t){this.updateAvatar(JFGameInfo.myInfo.avatarPath)},updateAvatar:function(t){if(JFGameInfo.myInfo.avatarPath=t,this._avatar&&void 0!==this._avatar||(this._avatar=new cc.Sprite,this._avatar.retain(),(t=this.Avatar)&&t.addChild(this._avatar)),JFGameInfo.myInfo.avatarPath&&""!=JFGameInfo.myInfo.avatarPath||(JFGameInfo.myInfo.avatarPath=1),11<=(t=parseInt(JFGameInfo.myInfo.avatarPath))){switch(t){case 11:JFGameInfo.myInfo.avatarImage=ResourceManager.JFResourcesMenuGame.Avatar11;break;case 12:JFGameInfo.myInfo.avatarImage=ResourceManager.JFResourcesMenuGame.Avatar12;break;case 13:JFGameInfo.myInfo.avatarImage=ResourceManager.JFResourcesMenuGame.Avatar13}this._avatar.setTexture(JFGameInfo.myInfo.avatarImage)}else JFGameInfo.myInfo.avatarImage="Avatar_"+JFGameInfo.myInfo.avatarPath+".png",cc.spriteFrameCache.getSpriteFrame(JFGameInfo.myInfo.avatarImage)||(JFGameInfo.myInfo.avatarPath=1,JFGameInfo.myInfo.avatarImage="Avatar_1.png"),this._avatar.setSpriteFrame(JFGameInfo.myInfo.avatarImage),this._avatar.scaleX=1,this._avatar.scaleY=1,this._avatar.setPosition(cc.p(0,0));this._avatar.setLocalZOrder(-10),this._borderAvatar()},_borderAvatar:function(){var t=JFGameInfo.myInfo.promotionBorder,e=JFGameInfo.myInfo.Level,t=parseInt(t);switch((e=parseInt(e))<t&&0!==e&&(JFGameInfo.myInfo.promotionBorder=t=0),t=30<=t?30:t){case 0:case 1:case 2:case 3:case 4:JFGameInfo.myInfo.borderPathImage=ResourceManager.JFResourcesMenuGame.Border_0;break;case 5:case 6:case 7:case 8:case 9:JFGameInfo.myInfo.borderPathImage=ResourceManager.JFResourcesMenuGame.Border_5;break;case 10:case 11:case 12:case 13:case 14:JFGameInfo.myInfo.borderPathImage=ResourceManager.JFResourcesMenuGame.Border_10;break;case 15:case 16:case 17:case 18:case 19:JFGameInfo.myInfo.borderPathImage=ResourceManager.JFResourcesMenuGame.Border_15;break;case 20:case 21:case 22:case 23:case 24:JFGameInfo.myInfo.borderPathImage=ResourceManager.JFResourcesMenuGame.Border_20;break;case 25:case 26:case 27:case 28:case 29:JFGameInfo.myInfo.borderPathImage=ResourceManager.JFResourcesMenuGame.Border_25;break;case 30:JFGameInfo.myInfo.borderPathImage=ResourceManager.JFResourcesMenuGame.Border_30}this.btnAvatar.loadTextures(JFGameInfo.myInfo.borderPathImage),this.btnAvatar.setPosition(cc.p(527,505)),5<=t&&(this.btnAvatar.scaleY=.8,this.btnAvatar.scaleX=.9),20<=t&&t<25?this._avatar.setPosition(cc.p(7,-2)):t<9?this._avatar.setPosition(cc.p(5,0)):10<=t&&t<20?this._avatar.setPosition(cc.p(-4,0)):this._avatar.setPosition(cc.p(0,0))},_loadAvatarDefault:function(){cc.loader.loadImg(PreLoaderConfig.PathToAvatarDefault,this._onLoadAvatarDefault.bind(this))},_onLoadAvatarDefault:function(t,e){var i;e&&(this._avatarImage=e,this._avatar&&void 0!==this._avatar?this._avatar.setTexture(e):(this._avatar=new cc.Sprite(e),(i=this._mainLayer.getChildByName("JFClipAvatar").getChildByName("JFNodeImage"))&&i.addChild(this._avatar)),this._avatar.scaleX=110/e.width,this._avatar.scaleY=110/e.height,this._avatar.setLocalZOrder(-10),this._avatar.y=-4)},_onLoadAvatarComplete:function(t,e){t?this._loadAvatarDefault():(this._avatar&&this._avatar.getParent()&&(this._avatar.removeFromParent(),this._avatar=null),this._avatarImage=e,this._avatar&&void 0!==this._avatar?this._avatar.setTexture(e):(this._avatar=new cc.Sprite(e),(t=this._mainLayer.getChildByName("JFClipAvatar").getChildByName("JFNodeImage"))&&t.addChild(this._avatar)),this._avatar.scaleX=110/e.width,this._avatar.scaleY=110/e.height,this._avatar.setLocalZOrder(-10),this._avatar.y=-4)},onClickBtnFromCocostudio:function(t,e){switch(t.getName()){case"JFButton_Close":jf.audio.playEffect(ResourceManager.JFResourcesMenuGame.SoundClose,!1),JFGameInfo.JFMain.layerPopup.hidePopupUserInfo();break;case"JFBtn_HuongDan":cc.sys.openURL(PreLoaderConfig.LINKS.WEB_HUONGDAN_OTP);break;case"JFButtonUpdate":cc.sys.openURL(PreLoaderConfig.LINKS.OTP_TELEGRAM),JFGameInfo.JFMain.layerPopup.hidePopupUserInfo();break;case"JFCircleAvatar":JFGameInfo.JFMain.layerPopup.showPopupListAvatar();break;case"ButtonEdit":JFGameInfo.JFMain.layerPopup.showPopupDisplayName();break;case"JFButtonChangePass":JFGameInfo.JFMain.layerPopup.showPopupChangePass()}},updateDisplayName:function(){this._mainLayer.getChildByName("JFTextName").setString(JFGameInfo.myInfo.Nickname),this.btnEdit.setVisible(!1)},_updateInfo:function(){var t;this.checkValue()&&(JFGameInfo.JFMain.showLoading(),(t={}).UserID=JFGameInfo.myInfo.UserID,t.CMND=this._mainLayer.getChildByName("JFCMNDInfo").getString(),t.Phone=this._mainLayer.getChildByName("JFPhoneNumberInfo").getString(),t.VersionDevice=JFGameInfo.VersionDevice,t.DeviceModel=JFGameInfo.DeviceModel,t.packetName=JFGameInfo.packetName,t.PlatformID=JFGameInfo.myPlatform,t.AppVersion=JFGameInfo.AppVersion,t.HardwareID=JFGameInfo.devineID,t.ChannelId=JFGameInfo.ChannelID,t.Sign=md5.encscript("ChangeCMND"+t.CMND+t.Phone+t.UserID+t.PlatformID+t.AppVersion+t.HardwareID+t.ChannelId+t.VersionDevice+t.DeviceModel+t.packetName+JFGameInfo.myInfo.token4Ws),this.valueCMNN=t.CMND,this.valueSDT=t.Phone,Utilities.getAPI("ChangeCMND",t,this.onUpdateInfo.bind(this)))},onUpdateInfo:function(t){JFGameInfo.JFMain.hideLoading(),t=JSON.parse(t),JFGameInfo.JFMain.layerPopup.showPopupMsg(t.Message)},dispose:function(){for(var t=0;t<this._listEvents.length;t++)cc.eventManager.removeListener(this._listEvents[t]);this._listEvents.length=0,JFGameInfo.JFMain.layerPopup.hidePopupUserInfo()}}),JFRankItem=cc.Node.extend({_avatar:null,_data:null,stt:null,ctor:function(t){cc.Node.prototype.ctor.call(this),this._data=t,this._data.PathEmotion=parseInt(this._data.PathEmotion)},initObj:function(){switch(this._initEvents(),this.getChildByName("Medial"),this.getChildByName("TxtName").ignoreContentAdaptWithSize(!0),this.getChildByName("TxtName").setString(this._data.DisplayName),this.getChildByName("TxtLevel").ignoreContentAdaptWithSize(!0),this.getChildByName("TxtLevel").setString("Level : "+this._data.Level),this.getChildByName("JFTxtCoin").ignoreContentAdaptWithSize(!0),this.getChildByName("JFTxtCoin").setString(this._data.Coin),this.getChildByName("BackgroundAvatarTop"),this.getChildByName("TxtRank").setString(this.stt),this._avatar=this.getChildByName("BackgroundAvatarTopInner"),3<this.stt&&this.getChildByName("Medial").setVisible(!1),this.stt){case 2:this.getChildByName("Medial").setSpriteFrame("MedialBac.png");break;case 3:this.getChildByName("Medial").setSpriteFrame("MedialDong.png")}this._initAvatar()},_initEvents:function(t){},_initAvatar:function(){this.updateAvatar()},updateAvatar:function(){cc.spriteFrameCache.getSpriteFrame(PreLoaderConfig.PathToAvatar+JFGameInfo.myInfo.avatarPath+".png")||this._data.PathEmotion&&0<this._data.PathEmotion?(this._avatar.loadTexture(PreLoaderConfig.PathToAvatar+this._data.PathEmotion+".png",ccui.Widget.PLIST_TEXTURE),this._avatar.setBright(!1)):this._loadAvatarDefault()},_loadAvatarDefault:function(){this._avatar.loadTexture(PreLoaderConfig.PathToAvatarDefault,ccui.Widget.PLIST_TEXTURE),this._avatar.setBright(!1)},cloneFromNode:function(t){for(this.setName(t.getName()),this.setPosition(t.getPosition()),t.getChildByName("JFBackground")&&this.setContentSize(t.getChildByName("JFBackground").getContentSize()),this.setVisible(t.isVisible()),this.setLocalZOrder(t.getLocalZOrder());0<t.getChildrenCount();){var e=t.getChildren()[0];e.removeFromParent(),this.addChild(e)}t.removeFromParent()}}),JFPopupRank=JFUIBaseLayer.extend({_item:null,_scrollViewUsers:null,_scrollPage:null,_listDataTop:null,isShowAlone:null,ctor:function(){JFUIBaseLayer.prototype.ctor.call(this),this.isShowAlone=!0},initObj:function(){this._initFromCocostudio(ResourceManager.JFResourcesMenuGame.CSSUITopPopup),this._initScrollViewUsers(),this._getDataUserTopRich(),this._mainLayer.getChildByName("TittleScrollView").ignoreContentAdaptWithSize(!0),this._listDataTop=[]},_initMask:function(){this.scrollView=this._mainLayer.getChildByName("ScrollViewUsers"),this.clippingNode=new cc.ClippingNode,this.sriteMask=this._mainLayer.getChildByName("ScrollMask"),this.clippingNode.setStencil(this.sriteMask),this.clippingNode.setInverted(!1),this.clippingNode.setAlphaThreshold(0),this.clippingNode.addChild(this.scrollView),this._mainLayer.addChild(this.clippingNode)},_getDataUserTopLevel:function(){JFGameInfo.JFMain.showLoading();var t={};t.UserID=JFGameInfo.myInfo.UserID,t.PlatformID=JFGameInfo.myPlatform,t.AppVersion=JFGameInfo.AppVersion,t.HardwareID=JFGameInfo.devineID,t.ChannelId=JFGameInfo.ChannelID,t.VersionDevice=JFGameInfo.VersionDevice,t.DeviceModel=JFGameInfo.DeviceModel,t.packetName=JFGameInfo.packetName,t.Sign=MGmd5.encscript("GetTopLevel"+t.UserID+t.PlatformID+t.AppVersion+t.HardwareID+t.ChannelId+t.VersionDevice+t.DeviceModel+t.packetName+JFGameInfo.myInfo.token4Ws),Utilities.getAPI("GetTopLevel",t,this._onCallBackGetDataTopRich.bind(this))},_getDataUserTopRich:function(){JFGameInfo.JFMain.showLoading();var t={};t.UserID=JFGameInfo.myInfo.UserID,t.VersionDevice=JFGameInfo.VersionDevice,t.DeviceModel=JFGameInfo.DeviceModel,t.ChannelId=JFGameInfo.ChannelID,t.PlatformID=JFGameInfo.myPlatform,t.AppVersion=JFGameInfo.AppVersion,t.HardwareID=JFGameInfo.devineID,t.packetName=JFGameInfo.packetName,t.Sign=MGmd5.encscript("GetTopRich"+t.UserID+t.PlatformID+t.AppVersion+t.HardwareID+t.ChannelId+t.VersionDevice+t.DeviceModel+t.packetName+JFGameInfo.myInfo.token4Ws),Utilities.getAPI("GetTopRich",t,this._onCallBackGetDataTopRich.bind(this))},_onCallBackGetDataTopRich:function(t){JFGameInfo.JFMain.hideLoading(),1===(t=JSON.parse(t)).Result?(this._listDataTop=t.Data,0<this._listDataTop.length&&this._initScrollViewItem()):JFGameInfo.JFMain.layerPopup.showPopupMsg(t.Message)},_initScrollViewUsers:function(){this._scrollViewUsers=this._mainLayer.getChildByName("ScrollViewUsers"),this._scrollPage=new cc.Node,this._scrollPage.setAnchorPoint(cc.p(0,0)),this.scrollView=this._mainLayer.getChildByName("ScrollMask"),this.scrollView.setVisible(!1)},_initScrollViewItem:function(){this._scrollViewUsers.removeAllChildren(!0);for(var t=1,e=10<=Math.round(this._listDataTop.length)?10:this._listDataTop.length,i=123*e+5*e,n=1,s=0;s<e;s++){var r=new JFRankItem(this._listDataTop[s]);r.stt=n,r.cloneFromNode(ccs.load(ResourceManager.JFResourcesMenuGame.CSSJFTopItem).node),r.initObj(),r.setAnchorPoint(cc.p(0,0)),r.setAnchorPoint(cc.p(-.5,-.5)),this._scrollViewUsers.addChild(r),r.setPositionY(i-(r.getContentSize().height+5)*t),t++,n++}this._scrollViewUsers.setInnerContainerSize(cc.size(840,i))},onClickBtnFromCocostudio:function(t,e){switch(t.getName()){case"JFButton_Close":JFGameInfo.JFMain.layerPopup.hidePopupRank();break;case"JFBtnDaiGia":this._mainLayer.getChildByName("TittleScrollView").setString("Danh sách 10 người giàu nhất"),this._mainLayer.getChildByName("JFBtnDaiGia").setColor(cc.color("#FFFFFF")),this._mainLayer.getChildByName("JFBtnCaoThu").setColor(cc.color("#7F7F7F")),this._getDataUserTopRich();break;case"JFBtnCaoThu":this._mainLayer.getChildByName("TittleScrollView").setString("Danh sách 10 người cao thủ nhất"),this._mainLayer.getChildByName("JFBtnDaiGia").setColor(cc.color("#7F7F7F")),this._mainLayer.getChildByName("JFBtnCaoThu").setColor(cc.color("#FFFFFF")),this._getDataUserTopLevel()}},_setccuiLayout:function(){var t=this._mainLayer.getChildByName("JFBackground").getChildByName("JFBackground");t&&(this._layerbg=new ccui.Layout,this.addChild(this._layerbg),this._layerbg.setLocalZOrder(-1),this._layerbg.setContentSize(t.getContentSize()),this._layerbg.setAnchorPoint(t.getAnchorPoint()),this._layerbg.setPosition(t.getPosition()),this._layerbg.setTouchEnabled(!0),this._layerbg.setOpacity(0))},dispose:function(){JFGameInfo.JFMain.layerPopup.hidePopupRank()}}),JFPopupHeSoCa=JFUIBaseLayer.extend({isShowAlone:null,ctor:function(){JFUIBaseLayer.prototype.ctor.call(this),this.isShowAlone=!0},initObj:function(){this._initFromCocostudio(ResourceManager.JFResourcesMenuGame.CSSUIHeSoCaPopup)},onClickBtnFromCocostudio:function(t,e){"JFButton_Close"===t.getName()&&(cc.audioEngine.playEffect(ResourceManager.JFResourcesMenuGame.SoundClose,!1),JFGameInfo.JFMain.layerPopup.hidePopupHeSoCa())},_setccuiLayout:function(){var t=this._mainLayer.getChildByName("JFBackground").getChildByName("JFBackground");t&&(this._layerbg=new ccui.Layout,this.addChild(this._layerbg),this._layerbg.setLocalZOrder(-1),this._layerbg.setContentSize(t.getContentSize()),this._layerbg.setAnchorPoint(t.getAnchorPoint()),this._layerbg.setPosition(t.getPosition()),this._layerbg.setTouchEnabled(!0),this._layerbg.setOpacity(0))},show:function(){JFGameInfo.roomID===ConstantsVariable.RoomGameVip?(this._mainLayer.getChildByName("JFHSC_V").setVisible(!0),this._mainLayer.getChildByName("JFHSC_N").setVisible(!1)):(this._mainLayer.getChildByName("JFHSC_V").setVisible(!1),this._mainLayer.getChildByName("JFHSC_N").setVisible(!0))},dispose:function(){JFGameInfo.JFMain.layerPopup.hidePopupHeSoCa()}}),JFPopupTongKet=JFUIBaseLayer.extend({isShowAlone:null,listSumup:null,ctor:function(){JFUIBaseLayer.prototype.ctor.call(this),this.isShowAlone=!0},initObj:function(){this._initFromCocostudio(ResourceManager.JFResourcesMenuGame.CSSUITongKetPopup),this.listSumup=this._mainLayer.getChildByName("JFSumupContain").getChildren()},onClickBtnFromCocostudio:function(t,e){switch(t.getName()){case"JFButtonCancel":cc.audioEngine.playEffect(ResourceManager.JFResourcesMenuGame.SoundClose,!1),JFGameInfo.JFMain.layerPopup.hidePopupTongKet();break;case"JFButtonComfirm":this.resetUI(),JFGameInfo.JFMain.layerScreenGame.netSend.sendExitGameServer(),JFGameInfo.JFMain.layerComponents.compoOptionInGame.closeOption()}},_setccuiLayout:function(){var t=this._mainLayer.getChildByName("JFBackground").getChildByName("JFBackground");t&&(this._layerbg=new ccui.Layout,this.addChild(this._layerbg),this._layerbg.setLocalZOrder(-1),this._layerbg.setContentSize(t.getContentSize()),this._layerbg.setAnchorPoint(t.getAnchorPoint()),this._layerbg.setPosition(t.getPosition()),this._layerbg.setTouchEnabled(!0),this._layerbg.setOpacity(0))},show:function(){JFGameInfo.roomID===ConstantsVariable.RoomGameVip?(this._mainLayer.getChildByName("JFSumupV").setVisible(!0),this._mainLayer.getChildByName("JFSumupN").setVisible(!1)):(this._mainLayer.getChildByName("JFSumupV").setVisible(!1),this._mainLayer.getChildByName("JFSumupN").setVisible(!0));for(var t=0,e=this.listSumup.length;t<e;t++)JFGameInfo.myInfo.listFishCatch[t]?this.listSumup[t].setString(JFGameInfo.myInfo.listFishCatch[t]):this.listSumup[t].setString("0");this._mainLayer.getChildByName("JFTotalFish").setString(JFGameInfo.myInfo.totalFish),this._mainLayer.getChildByName("JFTotalGold").setString(Utilities.Coin(JFGameInfo.myInfo.totalGold))},resetUI:function(){JFGameInfo.myInfo.listFishCatch=[],JFGameInfo.myInfo.totalFish=0,JFGameInfo.myInfo.totalGold=0},dispose:function(){JFGameInfo.JFMain.layerPopup.hidePopupHeSoCa()}}),JFPopupTopDamage=JFUIBaseLayer.extend({myName:null,myDamage:null,iconMyRank:null,isShowAlone:null,ctor:function(){JFUIBaseLayer.prototype.ctor.call(this),this.isShowAlone=!1},initObj:function(){this._initFromCocostudio(ResourceManager.JFResourcesMenuGame.CSSUITopDamagePopup),this.myName=this._mainLayer.getChildByName("JFMyName"),this.myDamage=this._mainLayer.getChildByName("JFMyDamage"),this.iconMyRank=this._mainLayer.getChildByName("JFIconMyRank")},onClickBtnFromCocostudio:function(t,e){"JFButtonClose"===t.getName()&&(cc.audioEngine.playEffect(ResourceManager.JFResourcesMenuGame.SoundClose,!1),JFGameInfo.JFMain.layerPopup.hidePopupTopDamage())},_setccuiLayout:function(){var t=this._mainLayer.getChildByName("JFBackground").getChildByName("JFBackground");t&&(this._layerbg=new ccui.Layout,this.addChild(this._layerbg),this._layerbg.setLocalZOrder(-1),this._layerbg.setContentSize(t.getContentSize()),this._layerbg.setAnchorPoint(t.getAnchorPoint()),this._layerbg.setPosition(t.getPosition()),this._layerbg.setTouchEnabled(!0),this._layerbg.setOpacity(0))},updateValue:function(t){this.resetValue();for(var e,i=0,n=t.ListUser.length;i<n;i++)(e=this._mainLayer.getChildByName("JFName"+t.ListUser[i].Rank)).setString(t.ListUser[i].UserName),e.setVisible(!0),(e=this._mainLayer.getChildByName("JFDamage"+t.ListUser[i].Rank)).setString(Utilities.Coin(t.ListUser[i].Damage.toString())),e.setVisible(!0),(e=this._mainLayer.getChildByName("JFGold"+t.ListUser[i].Rank)).setString(Utilities.Coin(t.ListUser[i].Coin.toString())),e.setVisible(!0),this._mainLayer.getChildByName("JFIconGold"+t.ListUser[i].Rank).setVisible(!0),this._mainLayer.getChildByName("JFItemRank"+t.ListUser[i].Rank).setVisible(!0);0<t.Rank&&(t.Rank=5<t.Rank?5:t.Rank,(e=this._mainLayer.getChildByName("JFName"+t.Rank)).setVisible(!1),this.myName.setPosition(e.getPosition()),this.myName.setString(t.UserName),this.myName.setVisible(!0),(e=this._mainLayer.getChildByName("JFDamage"+t.Rank)).setVisible(!1),this.myDamage.setPosition(e.getPosition()),this.myDamage.setString(Utilities.Coin(t.Damage.toString())),this.myDamage.setVisible(!0),(e=this._mainLayer.getChildByName("JFGold"+t.Rank)).setString(Utilities.Coin(t.Coin.toString())),e.setVisible(!0),4==t.Rank&&(this.iconMyRank.getChildByName("JFTxtRank").setString("4"),this.iconMyRank.setVisible(!0),this._mainLayer.getChildByName("JFItemRank4").setVisible(!1),this.iconMyRank.setPosition(this._mainLayer.getChildByName("JFItemRank4").getPosition())),5==t.Rank)&&(this.iconMyRank.getChildByName("JFTxtRank").setString("4+"),this.iconMyRank.setVisible(!0),this._mainLayer.getChildByName("JFItemRank5").setVisible(!1),this.iconMyRank.setPosition(this._mainLayer.getChildByName("JFItemRank5").getPosition()),this._mainLayer.getChildByName("JFIconGold5").setVisible(!0)),1==t.IsDead?this._mainLayer.getChildByName("JFBossStatus").setString("Chết"):this._mainLayer.getChildByName("JFBossStatus").setString("Sống")},resetValue:function(){for(var t=5;0<t;)this._mainLayer.getChildByName("JFName"+t).setVisible(!1),this._mainLayer.getChildByName("JFDamage"+t).setVisible(!1),this._mainLayer.getChildByName("JFGold"+t).setVisible(!1),this._mainLayer.getChildByName("JFIconGold"+t).setVisible(!1),this._mainLayer.getChildByName("JFItemRank"+t).setVisible(!1),t--},dispose:function(){JFGameInfo.JFMain.layerPopup.hidePopupTopDamage()}}),JFPopupUserProfile=(JFPopupMiniGame=JFUIBaseLayer.extend({btnMinigameVongQuay:null,btnMinigameTaiXiu:null,btnMinigameSlot:null,ctor:function(){JFUIBaseLayer.prototype.ctor.call(this)},initObj:function(){this._initFromCocostudio(ResourceManager.JFResourcesMenuGame.CSSUIMiniGamePopup),this.btnMinigameTaiXiu=this._mainLayer.getChildByName("JFButtonTaiXiu"),this.btnMinigameVongQuay=this._mainLayer.getChildByName("JFButtonVongQuay"),this.btnMinigameSlot=this._mainLayer.getChildByName("JFButtonSlot"),JFGameInfo.JFMain.hideLoading()},onClickBtnFromCocostudio:function(t,e){switch(t.getName()){case"JFButtonClose":JFGameInfo.JFMain.layerPopup.hidePopupMiniGame();break;case"JFButtonVongQuay":JFGameInfo.JFMain.showLoading(),JFGameInfo.roomID=ConstantsVariable.MiniGameVongQuay,JFGameInfo.JFMain.netSend.sendGetInfoGameRoom(ConstantsVariable.ROOMKIND.MINI_GAME_VONG_QUAY);break;case"JFButtonTaiXiu":JFGameInfo.JFMain.showLoading(),JFGameInfo.roomID=ConstantsVariable.MiniGameTaiXiu,JFGameInfo.JFMain.netSend.sendGetInfoGameRoom(ConstantsVariable.ROOMKIND.MINI_GAME_TAI_XIU);break;case"JFButtonSlot":JFGameInfo.JFMain.showLoading(),JFGameInfo.roomID=ConstantsVariable.MiniGameSlot,JFGameInfo.JFMain.netSend.sendGetInfoGameRoom(ConstantsVariable.ROOMKIND.MINI_GAME_SLOT)}},dispose:function(){JFGameInfo.JFMain.layerPopup.hidePopupMiniGame()}}),JFUIBaseLayer.extend({_uid:null,_gold:null,reg:null,isShowAlone:null,_btnExit:null,_nickname:null,_level:null,_kinhNgiem:null,_nextLevel:null,ctor:function(){JFUIBaseLayer.prototype.ctor.call(this)},initObj:function(){this._initFromCocostudio(ResourceManager.JFResourcesMenuGame.CSSUIUserProfilePopup),this.reg=/^[0-9]+$/},onClickBtnFromCocostudio:function(t,e){"JFButton_Close"===t.getName()&&(jf.audio.playEffect(ResourceManager.JFResourcesMenuGame.SoundClose,!1),JFGameInfo.JFMain.layerPopup.hidePopupUserProfile())},updateProfileInfo:function(t){this._nickname=t.Nickname,this._level=t.Level,this._uid=t.UserID,this._gold=t.Gold,this._kinhNgiem=t.Exp,this.isShowAlone=!0,this._nextLevel=3*(2*Math.pow(this._level,4)+6*Math.pow(this._level,3)+4*Math.pow(this._level,2)+25*this._level),this._mainLayer.getChildByName("JFTextName").setString(this._nickname),this._mainLayer.getChildByName("JFTextLevel").setString("Level: "+t.Level),this._mainLayer.getChildByName("JFTextUID").setString(this._uid),this._mainLayer.getChildByName("JFTextCoin").setString(Utilities.Coin(this._gold.toString())),this._mainLayer.getChildByName("JFTextUExp").setString(this._kinhNgiem+"/"+this._nextLevel),(t=new cc.Sprite).setSpriteFrame(JFGameInfo.myInfo.avatarImage);var e=this._mainLayer.getChildByName("JFClipAvatar").getChildByName("JFNodeImage");e&&e.addChild(t)},dispose:function(){JFGameInfo.JFMain.layerPopup.hidePopupUserProfile()}})),JFChatEmo=JFUIBaseLayer.extend({isShowAlone:null,reg:null,_idChat:null,_deskStation:null,ctor:function(){JFUIBaseLayer.prototype.ctor.call(this),this.isShowAlone=!1},initObj:function(t){this._initFromCocostudio(ResourceManager.JFResourcesMenuGame.JFPopupChatEmoticon),this.setVisible(!1),this.reg=/^[0-9]+$/,this._deskStation=t},onClickBtnFromCocostudio:function(t,e){switch(t.getName()){case"JFButton_Close":jf.audio.playEffect(ResourceManager.JFResourcesMenuGame.SoundClose,!1),this.hidePopupChat();break;case"JFBtn0":this._idChat=0,JFGameInfo.JFMain.layerScreenGame.netSend.sendChat(this._deskStation,this._idChat),this.hidePopupChat();break;case"JFBtn1":this._idChat=1,JFGameInfo.JFMain.layerScreenGame.netSend.sendChat(this._deskStation,this._idChat),this.hidePopupChat();break;case"JFBtn2":this._idChat=2,JFGameInfo.JFMain.layerScreenGame.netSend.sendChat(this._deskStation,this._idChat),this.hidePopupChat();break;case"JFBtn3":this._idChat=3,JFGameInfo.JFMain.layerScreenGame.netSend.sendChat(this._deskStation,this._idChat),this.hidePopupChat();break;case"JFBtn4":this._idChat=4,JFGameInfo.JFMain.layerScreenGame.netSend.sendChat(this._deskStation,this._idChat),this.hidePopupChat();break;case"JFBtn5":this._idChat=5,JFGameInfo.JFMain.layerScreenGame.netSend.sendChat(this._deskStation,this._idChat),this.hidePopupChat();break;case"JFBtn6":this._idChat=6,JFGameInfo.JFMain.layerScreenGame.netSend.sendChat(this._deskStation,this._idChat),this.hidePopupChat();break;case"JFBtn7":this._idChat=7,JFGameInfo.JFMain.layerScreenGame.netSend.sendChat(this._deskStation,this._idChat),this.hidePopupChat()}},showPopupChat:function(){this.setVisible(!0)},hidePopupChat:function(){this.setVisible(!1)},dispose:function(){}}),JFPopupJackpot=JFUIBaseLayer.extend({_item:null,_scrollViewUsers:null,_scrollPage:null,_listDataTop:null,isShowAlone:null,listData:null,listView:null,ctor:function(t){JFUIBaseLayer.prototype.ctor.call(this),this.isShowAlone=!0,this.listData=t},initObj:function(){this._initFromCocostudio(ResourceManager.JFResourcesMenuGame.CSSUIPopupJackpot),this.listView=this._mainLayer.getChildByName("ListView_Event"),this.setListview()},setListview:function(){var t,e=0,i=this.listData.length;for(this.listView.removeAllChildren(!0);e<i;e++)(t=new JFJackpotItem(this.listData[e])).initObj(e+1),this.listView.pushBackCustomItem(t.getContentPanel())},onClickBtnFromCocostudio:function(t,e){"Btn_Close"===t.getName()&&JFGameInfo.JFMain.layerPopup.hidePopupJackpot()},dispose:function(){}}),JFJackpotItem=JFUIBaseLayer.extend({_contentPanel:null,_data:null,ctor:function(t){JFUIBaseLayer.prototype.ctor.call(this),this._data=t},initObj:function(t){this._initFromCocostudio(ResourceManager.JFResourcesMenuGame.CSSUIItemJackpot),this._contentPanel=this._mainLayer.getChildByName("ContentPanel"),this.update(t)},update:function(t){this._contentPanel.getChildByName("JFTxtNumberBullet").setString(this._data.value),this._contentPanel.getChildByName("JFTxtDescription").setString(this._data.title+ConstantsVariable.Titile_Jackpot.NAME)},getContentPanel:function(){return this._contentPanel.removeFromParent(!0),this._contentPanel}}),JFHistoryItem=JFUIBaseNode.extend({txtDetail:null,txtRoom:null,txtModify:null,txtTime:null,ctor:function(){JFUIBaseNode.prototype.ctor.call(this)},initObj:function(){this.txtDetail=this.getChildByName("TextDetail"),this.txtDetail.ignoreContentAdaptWithSize(!0),this.txtRoom=this.getChildByName("TextRoom"),this.txtRoom.ignoreContentAdaptWithSize(!0),this.txtModify=this.getChildByName("TextModify"),this.txtModify.ignoreContentAdaptWithSize(!0),this.txtTime=this.getChildByName("TextTime"),this.txtTime.ignoreContentAdaptWithSize(!0)},setItemData:function(t){this.txtTime.setString(this.timeConvert(t.Time)),this.txtModify.setString(t.MoneyChange),this.txtRoom.setString(t.RoomID),this.txtDetail.setString(t.Description),this.setVisible(!0)},setItemHistory:function(t,e,i,n){this.txtTime.setString(t),this.txtModify.setString(e),this.txtRoom.setString(i),this.txtDetail.setString(n),this.setVisible(!0)},timeConvert:function(t){t=(r=new Date(t)).getFullYear();var e=r.getMonth()+1,i=r.getDate(),n=r.getHours(),s=r.getMinutes(),r=r.getSeconds();return 1==e.toString().length&&(e="0"+e),1==i.toString().length&&(i="0"+i),(n=1==n.toString().length?"0"+n:n)+":"+(s=1==s.toString().length?"0"+s:s)+":"+(r=1==r.toString().length?"0"+r:r)+" "+i+"/"+e+"/"+t}}),JFPopupHistory=JFUIBaseLayer.extend({_panelHistory:null,_listEvents:null,listBtnpage:null,listItems:null,currentTab:ConstantsVariable.TAB_H_GAME,currentPage:1,maxPage:null,btnTabGame:null,btnTabNhan:null,btnTabTieu:null,ctor:function(){JFUIBaseLayer.prototype.ctor.call(this)},initObj:function(){this._initFromCocostudio(ResourceManager.JFResourcesMenuGame.CSSUIHistoryPopup),this._initUI(),this._initItems(),this.initEvent()},_initUI:function(){this._mainLayer.getChildByName("BtnBack").setVisible(!1),this._mainLayer.getChildByName("BtnNext").setVisible(!1),this.btnTabGame=this._mainLayer.getChildByName("BGHeader").getChildByName("JFBtnTap_0"),this.btnTabGame.setEnabled(!1),this.btnTabGame.addClickEventListener(this.onClickBtnFromCocostudio.bind(this)),this.btnTabNhan=this._mainLayer.getChildByName("BGHeader").getChildByName("JFBtnTap_1"),this.btnTabNhan.setEnabled(!0),this.btnTabNhan.addClickEventListener(this.onClickBtnFromCocostudio.bind(this)),this.btnTabTieu=this._mainLayer.getChildByName("BGHeader").getChildByName("JFBtnTap_2"),this.btnTabTieu.setEnabled(!0),this.btnTabTieu.addClickEventListener(this.onClickBtnFromCocostudio.bind(this)),this.initListButtonPage(),this.listBtnpage[0].setEnabled(!1),this.getApiHistoryPlayGame()},initEvent:function(){this._listEvents=[],this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.MONEY_HISTORY_REPONESE.toString(),this.ngGameHistory.bind(this)))},_initItems:function(){this.listItems=[],this._panelHistory=this._mainLayer.getChildByName("JFPanel");for(var t=1;t<=this._panelHistory.getChildrenCount();t++){this._panelHistory.getChildByName("JFPanelItem_"+t).setVisible(!0);var e=new JFHistoryItem;e.cloneFromNode(this._panelHistory.getChildByName("JFPanelItem_"+t)),e.initObj(),this._panelHistory.addChild(e),e.setVisible(!1),this.listItems.push(e)}},onClickBtnFromCocostudio:function(t,e){switch(t.getName()){case"JFButton_Close":cc.audioEngine.playEffect(ResourceManager.JFResourcesMenuGame.SoundClose,!1),this.dispose();break;case"BtnNext":if(this.currentPage<this.maxPage)switch(this.currentPage++,this.enableAllButtonsPage(),this.listBtnpage[this.currentPage-1].setEnabled(!1),this.listBtnpage[this.currentPage-1].setBright(!1),this.currentTab){case ConstantsVariable.TAB_H_GAME:this.getApiHistoryPlayGame();break;case ConstantsVariable.TAB_H_NHAN:case ConstantsVariable.TAB_H_TIEU:this.getApiHistory()}break;case"BtnBack":if(1<this.currentPage)switch(this.currentPage--,this.enableAllButtonsPage(),this.listBtnpage[this.currentPage-1].setEnabled(!1),this.listBtnpage[this.currentPage-1].setBright(!1),this.currentTab){case ConstantsVariable.TAB_H_GAME:this.getApiHistoryPlayGame();break;case ConstantsVariable.TAB_H_NHAN:case ConstantsVariable.TAB_H_TIEU:this.getApiHistory()}break;case"JFBtnTap_0":this.hideAllItem(),this._mainLayer.getChildByName("JFNodeTabContainer_0").setVisible(!0),this._mainLayer.getChildByName("JFNodeTabContainer_1").setVisible(!1),this.enableAllButtonsPage(),this.currentPage=1,this.enableAllButtonsPage(),this.showButtonsPage(0),this._mainLayer.getChildByName("BtnBack").setVisible(!1),this._mainLayer.getChildByName("BtnNext").setVisible(!1),this.currentTab=ConstantsVariable.TAB_H_GAME,this.getApiHistoryPlayGame(),this.listBtnpage[0].setEnabled(!1),this.listBtnpage[0].setBright(!1),this.btnTabGame.setEnabled(!1),this.btnTabGame.setBright(!1),this.btnTabNhan.setEnabled(!0),this.btnTabNhan.setBright(!0),this.btnTabTieu.setEnabled(!0),this.btnTabTieu.setBright(!0);break;case"JFBtnTap_1":this._mainLayer.getChildByName("JFNodeTabContainer_0").setVisible(!1),this._mainLayer.getChildByName("JFNodeTabContainer_1").setVisible(!0),this.currentTab=ConstantsVariable.TAB_H_NHAN,this.currentPage=1,this.enableAllButtonsPage(),this.getApiHistory(),this.btnTabGame.setEnabled(!0),this.btnTabGame.setBright(!0),this.btnTabNhan.setEnabled(!1),this.btnTabNhan.setBright(!1),this.btnTabTieu.setEnabled(!0),this.btnTabTieu.setBright(!0),this.listBtnpage[0].setEnabled(!1),this.listBtnpage[0].setBright(!1);break;case"JFBtnTap_2":this._mainLayer.getChildByName("JFNodeTabContainer_0").setVisible(!1),this._mainLayer.getChildByName("JFNodeTabContainer_1").setVisible(!0),this.currentTab=ConstantsVariable.TAB_H_TIEU,this.currentPage=1,this.enableAllButtonsPage(),this.getApiHistory(),this.btnTabGame.setEnabled(!0),this.btnTabGame.setBright(!0),this.btnTabNhan.setEnabled(!0),this.btnTabNhan.setBright(!0),this.btnTabTieu.setEnabled(!1),this.btnTabTieu.setBright(!1),this.listBtnpage[0].setEnabled(!1),this.listBtnpage[0].setBright(!1)}},onClickBtnPage:function(t,e){switch(this.enableAllButtonsPage(),t.setEnabled(!1),t.setBright(!1),this.currentPage=t.ID,this.currentTab){case ConstantsVariable.TAB_H_GAME:this.getApiHistoryPlayGame();break;case ConstantsVariable.TAB_H_NHAN:case ConstantsVariable.TAB_H_TIEU:this.getApiHistory()}},ngGameHistory:function(t){t=t.getUserData();var e={MaxPage:BinaryConstants.DataTypeID.UInt8,ListDetail:BinaryConstants.DataTypeID.Object8,ListDetail_Struct:{Time:BinaryConstants.DataTypeID.UInt64,MoneyChange:BinaryConstants.DataTypeID.Int64,RoomID:BinaryConstants.DataTypeID.UInt32,Description:BinaryConstants.DataTypeID.StringDynamic}};t=(new BinaryParser).init(e,t.content),this.maxPage=t.MaxPage,this.upDateBtnControl(),this.parseDataGame(t.ListDetail)},parseDataGame:function(t){this.hideAllItem();for(var e=t.length,i=0;i<e;i++)this.listItems[i].setItemData(t[i])},hideAllItem:function(){for(var t=this.listItems.length,e=0;e<t;e++)this.listItems[e].setVisible(!1)},initListButtonPage:function(){var t,e=this._mainLayer.getChildByName("JFListBtnpage"),i=1;for(this.listBtnpage=[];i<11;i++)(t=e.getChildByName("JFBtn_"+i)).setEnabled(!0),t.setVisible(!1),t.ID=i,t.addClickEventListener(this.onClickBtnPage.bind(this)),this.listBtnpage.push(t)},enableAllButtonsPage:function(){for(var t=this.listBtnpage.length,e=0;e<t;e++)this.listBtnpage[e].setEnabled(!0),this.listBtnpage[e].setBright(!0)},showButtonsPage:function(t){for(var e=this.listBtnpage.length,i=0;i<e;i++)i<t?this.listBtnpage[i].setVisible(!0):this.listBtnpage[i].setVisible(!1);this._mainLayer.getChildByName("JFListBtnpage").setPositionX((JFGameInfo.appRealWidth-60*t)/2)},getApiHistoryPlayGame:function(){JFGameInfo.JFMain.showLoading();var t={};t.UserID=JFGameInfo.myInfo.UserID,t.PlatformID=JFGameInfo.myPlatform,t.AppVersion=JFGameInfo.AppVersion,t.HardwareID=JFGameInfo.devineID,t.packetName=JFGameInfo.packetName,t.VersionDevice=JFGameInfo.VersionDevice,t.DeviceModel=JFGameInfo.DeviceModel,t.ChannelId=JFGameInfo.ChannelID,t.PageNumber=this.currentPage,t.PageSize=10,t.Sign=MGmd5.encscript("HistoryNgocUser"+t.PageNumber+t.PageSize+t.UserID+t.PlatformID+t.AppVersion+t.HardwareID+t.ChannelId+t.VersionDevice+t.DeviceModel+t.packetName+JFGameInfo.myInfo.token4Ws),Utilities.getAPI("HistoryNgocUser",t,this.onGettedApiHistory.bind(this))},getApiHistory:function(){JFGameInfo.JFMain.showLoading();var t={};t.UserID=JFGameInfo.myInfo.UserID,t.PlatformID=JFGameInfo.myPlatform,t.AppVersion=JFGameInfo.AppVersion,t.HardwareID=JFGameInfo.devineID,t.packetName=JFGameInfo.packetName,t.VersionDevice=JFGameInfo.VersionDevice,t.DeviceModel=JFGameInfo.DeviceModel,t.ChannelId=JFGameInfo.ChannelID,t.TransType=this.currentTab===ConstantsVariable.TAB_H_NHAN?ConstantsVariable.TAB_NGOC:ConstantsVariable.TAB_VIN,t.PageNumber=this.currentPage,t.PageSize=10,t.Sign=MGmd5.encscript("HistoryExchangeNgocWin"+t.TransType+t.PageNumber+t.PageSize+t.UserID+t.PlatformID+t.AppVersion+t.HardwareID+t.ChannelId+t.VersionDevice+t.DeviceModel+t.packetName+JFGameInfo.myInfo.token4Ws),Utilities.getAPI("HistoryExchangeNgocWin",t,this.onGettedApiHistory.bind(this))},onGettedApiHistory:function(t){if(JFGameInfo.JFMain.hideLoading(),t=JSON.parse(t),this.hideAllItem(),1===t.Result&&(this.maxPage=t.Data.TotalPages,this.upDateBtnControl(),t=t.Data.ListData)){var e=t.length;if(this.currentTab===ConstantsVariable.TAB_H_NHAN)for(var i=0;i<e;i++)this.listItems[i].setItemHistory(t[i].DateCreated,Utilities.Coin(t[i].AmountTransfer.toString())+" Vin",Utilities.Coin(t[i].ValueExchange.toString())+" Ngọc",t[i].Description);else if(this.currentTab===ConstantsVariable.TAB_H_TIEU)for(i=0;i<e;i++)this.listItems[i].setItemHistory(t[i].DateCreated,Utilities.Coin(t[i].ValueExchange.toString())+" Ngọc",Utilities.Coin(t[i].AmountTransfer.toString())+" Vin",t[i].Description);else for(i=0;i<e;i++)this.listItems[i].setItemHistory(t[i].CreatedDate,Utilities.Coin(t[i].ValueCoin.toString()),Utilities.Coin(t[i].CurrentCoin.toString()),t[i].Description)}},upDateBtnControl:function(){this.showButtonsPage(this.maxPage),this.maxPage>this.currentPage?this._mainLayer.getChildByName("BtnNext").setVisible(!0):this._mainLayer.getChildByName("BtnNext").setVisible(!1),1<this.currentPage?this._mainLayer.getChildByName("BtnBack").setVisible(!0):this._mainLayer.getChildByName("BtnBack").setVisible(!1)},_setccuiLayout:function(){var t=this._mainLayer.getChildByName("JFBackground").getChildByName("JFBackground");t&&(this._layerbg=new ccui.Layout,this.addChild(this._layerbg),this._layerbg.setLocalZOrder(-1),this._layerbg.setContentSize(t.getContentSize()),this._layerbg.setAnchorPoint(cc.p(.5,.5)),this._layerbg.setPosition(this._mainLayer.getChildByName("JFBackground").getPosition()),this._layerbg.setTouchEnabled(!0),this._layerbg.setBackGroundColorOpacity(0))},dispose:function(){if(JFGameInfo.JFMain.layerPopup.hidePopupHistory(),this._listEvents)for(var t=0;t<this._listEvents.length;t++)cc.eventManager.removeListener(this._listEvents[t])}}),JFPopupHuongDan=JFUIBaseLayer.extend({_panelHuongDan:null,ctor:function(){JFUIBaseLayer.prototype.ctor.call(this)},initObj:function(){this._initFromCocostudio(ResourceManager.JFResourcesMenuGame.CSSUIPopupHuongDan),this._initUI(),this._initItems()},_initUI:function(){this._panelHuongDan=this._mainLayer.getChildByName("ListPageView"),this._panelHuongDan.setCurrentPageIndex(0),this._panelHuongDan.getCurrentPageIndex()<=0&&this._mainLayer.getChildByName("BtnBack").setVisible(!1)},_initItems:function(){},onClickBtnFromCocostudio:function(t,e){switch(t.getName()){case"JFButton_Close":cc.audioEngine.playEffect(ResourceManager.JFResourcesMenuGame.SoundClose,!1),this.dispose();break;case"BtnNext":cc.audioEngine.playEffect(ResourceManager.JFResourcesMenuGame.SoundClose,!1),this._panelHuongDan.getCurrentPageIndex()<this._panelHuongDan.getPages().length&&this._panelHuongDan.scrollToPage(this._panelHuongDan.getCurrentPageIndex()+1),0<=this._panelHuongDan.getCurrentPageIndex()&&this._mainLayer.getChildByName("BtnBack").setVisible(!0),this._panelHuongDan.getCurrentPageIndex()>=this._panelHuongDan.getPages().length-2&&this._mainLayer.getChildByName("BtnNext").setVisible(!1);break;case"BtnBack":0<this._panelHuongDan.getCurrentPageIndex()&&this._panelHuongDan.scrollToPage(this._panelHuongDan.getCurrentPageIndex()-1),cc.audioEngine.playEffect(ResourceManager.JFResourcesMenuGame.SoundClose,!1),this._panelHuongDan.getCurrentPageIndex()<=this._panelHuongDan.getPages().length-1&&this._mainLayer.getChildByName("BtnNext").setVisible(!0),this._panelHuongDan.getCurrentPageIndex()<=1&&this._mainLayer.getChildByName("BtnBack").setVisible(!1)}},dispose:function(){JFGameInfo.JFMain.layerPopup.hidePopupHuongDan()}}),JFPopupInApp=(JFPopupListAvatar=JFUIBaseLayer.extend({isShowAlone:null,selectedAvatar:null,selectedIcon:null,listAvatarPro:[],ctor:function(){JFUIBaseLayer.prototype.ctor.call(this),this.isShowAlone=!1},initObj:function(){this._initFromCocostudio(ResourceManager.JFResourcesMenuGame.CSSUIListAvatarPopup),this._mainLayer.getChildByName("PanelBG").addClickEventListener(this.onClickBtnFromCocostudio.bind(this)),this.selectedIcon=this._mainLayer.getChildByName("Selected"),this.getAvatarPro(),this.onLoadFrame()},getAvatarPro:function(){var t=11;this.listAvatarPro=[];for(var e=0;e<3;e++){var i={};i.id=e,i.path=t,i.avatar=this._mainLayer.getChildByName("Avatar_"+t),this.listAvatarPro.push(i),t++}},onLoadFrame:function(){JFGameInfo.JFMain.showLoading();var t={};t.UserID=JFGameInfo.myInfo.UserID,t.PlatformID=JFGameInfo.myPlatform,t.AppVersion=JFGameInfo.AppVersion,t.HardwareID=JFGameInfo.devineID,t.packetName=JFGameInfo.packetName,t.VersionDevice=JFGameInfo.VersionDevice,t.DeviceModel=JFGameInfo.DeviceModel,t.ChannelId=JFGameInfo.ChannelID,t.Sign=md5.encscript("GetStatusAvatar"+t.UserID+t.PlatformID+t.AppVersion+t.HardwareID+t.ChannelId+t.VersionDevice+t.DeviceModel+t.packetName+JFGameInfo.myInfo.token4Ws),Utilities.getAPI("GetStatusAvatar",t,this._onLoadStatusAvatar.bind(this))},_onLoadStatusAvatar:function(t){if(JFGameInfo.JFMain.hideLoading(),1===(t=JSON.parse(t)).Result){t=t.Data,t=JSON.parse(t);for(var e=0;e<t.length;e++){var i=t[e],n=this.listAvatarPro[e];n.money=i.money,n.avatar.setBright(i.status),n.avatar.setEnabled(i.status)}}else this.dispose(),JFGameInfo.JFMain.layerPopup.showPopupMsg("Không thành công. Vui lòng thử lại!")},updateAvatar:function(t,e){JFGameInfo.JFMain.showLoading();var i={};i.UserID=JFGameInfo.myInfo.UserID,i.PlatformID=JFGameInfo.myPlatform,i.AppVersion=JFGameInfo.AppVersion,i.HardwareID=JFGameInfo.devineID,i.packetName=JFGameInfo.packetName,i.VersionDevice=JFGameInfo.VersionDevice,i.DeviceModel=JFGameInfo.DeviceModel,i.ChannelId=JFGameInfo.ChannelID,i.Path=t,i.AvatarMoney=e,i.Sign=md5.encscript("UpdateAvatarV2"+i.Path+i.AvatarMoney+i.UserID+i.PlatformID+i.AppVersion+i.HardwareID+i.ChannelId+i.VersionDevice+i.DeviceModel+i.packetName+JFGameInfo.myInfo.token4Ws),Utilities.getAPI("UpdateAvatarV2",i,this._onUpdated.bind(this))},_onUpdated:function(t){JFGameInfo.JFMain.hideLoading(),1===(t=JSON.parse(t)).Result&&t.Data?(JFGameInfo.JFMain.layerPopup.showPopupMsg("Cập nhật avatar thành công"),cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.DISPATCH_REFRESH_AVATAR_USER),cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.REFRESH_POPUP_USER_INFO)):JFGameInfo.JFMain.layerPopup.showPopupMsg("Cập nhật avatar không thành công")},onClickBtnFromCocostudio:function(t,e){if(-1<t.getName().indexOf("Avatar"))null!=this.selectedAvatar&&this.selectedAvatar!==t&&this.selectedAvatar.setEnabled(!0),this.selectedIcon.setVisible(!0),this.selectedIcon.setPosition(t.getPosition()),this.selectedAvatar=t,this.selectedAvatar.setEnabled(!1);else switch(t.getName()){case"JFButtonClose":JFGameInfo.JFMain.layerPopup.hidePopupListAvatar();break;case"JFButtonFrameSelector":JFGameInfo.JFMain.layerPopup.showPopupListFrame();break;case"JFButtonComfirm":if(null!=this.selectedAvatar){var i=this.selectedAvatar.getName().split("_")[1],n=0;if(11<=(i=parseInt(i)))for(var s=0;s<this.listAvatarPro.length;s++){var r=this.listAvatarPro[s];r.path==i&&(n=r.money)}JFGameInfo.myInfo.avatarPath=i,this.updateAvatar(i,n)}}},dispose:function(){JFGameInfo.JFMain.layerPopup.hidePopupListAvatar()}}),JFPopupChangePass=JFUIBaseLayer.extend({txtOldPass:null,txtNewPass:null,txtComfirmPass:null,msgOldPass:null,msgNewPass:null,msgComfirm:null,isShowAlone:null,msgError:null,ctor:function(){JFUIBaseLayer.prototype.ctor.call(this),this.isShowAlone=!1},initObj:function(){this._initFromCocostudio(ResourceManager.JFResourcesMenuGame.CSSUIPopupChangePass),Utilities.showLog("JFPopupChangePass initObj 1"),this.cloneTextField(this._mainLayer.getChildByName("JFTxtOldPass")),Utilities.showLog("JFPopupChangePass initObj 2"),this.cloneTextField(this._mainLayer.getChildByName("JFTxtNewPass")),Utilities.showLog("JFPopupChangePass initObj 3"),this.cloneTextField(this._mainLayer.getChildByName("JFTxtComfrimPass")),Utilities.showLog("JFPopupChangePass initObj 4"),this.txtOldPass=this._mainLayer.getChildByName("JFTxtOldPass"),this.txtNewPass=this._mainLayer.getChildByName("JFTxtNewPass"),this.txtComfirmPass=this._mainLayer.getChildByName("JFTxtComfrimPass"),this.msgOldPass=this._mainLayer.getChildByName("JFMsgOldPass"),this.msgNewPass=this._mainLayer.getChildByName("JFMsgNewPass"),this.msgComfirm=this._mainLayer.getChildByName("JFMsgComfrimPass"),this.msgError=this._mainLayer.getChildByName("JFMsgError"),this._mainLayer.getChildByName("PanelBG").addClickEventListener(this.onClickBtnFromCocostudio.bind(this))},onClickBtnFromCocostudio:function(t,e){switch(t.getName()){case"JFButtonComfrim":this.onchangePass();break;case"JFButtonClose":case"PanelBG":JFGameInfo.JFMain.layerPopup.hidePopupChangePass()}},onchangePass:function(){var t,e;this.checkValue()&&(JFGameInfo.JFMain.showLoading(),(t={}).PasswordOld=this.txtOldPass.getString(),t.PasswordNew=this.txtNewPass.getString(),t.PasswordConfirm=this.txtComfirmPass.getString(),t.UserID=JFGameInfo.myInfo.UserID,t.PlatformID=JFGameInfo.myPlatform,t.AppVersion=JFGameInfo.AppVersion,t.HardwareID=JFGameInfo.devineID,t.packetName=JFGameInfo.packetName,t.VersionDevice=JFGameInfo.VersionDevice,t.DeviceModel=JFGameInfo.DeviceModel,t.ChannelId=ConstantsVariable.CHANNEL_ID,Utilities.showLog("token "+JFGameInfo.myInfo.token4Ws),e="ChangePassword"+t.PasswordOld+t.PasswordNew+t.PasswordConfirm+t.UserID+t.PlatformID+t.AppVersion+t.HardwareID+t.ChannelId+t.VersionDevice+t.DeviceModel+t.packetName+JFGameInfo.myInfo.token4Ws,Utilities.showLog("str "+e),t.Sign=md5.encscript(e),Utilities.getAPI("ChangePassword",t,this.onCallBackChangePass.bind(this)))},checkValue:function(){var t=0,e=this.txtOldPass.getString(),i=this.txtNewPass.getString(),n=this.txtComfirmPass.getString();return this.msgError.setVisible(!1),""==e?(this.msgOldPass.setVisible(!0),t++):this.msgOldPass.setVisible(!1),""==i?(this.msgNewPass.setVisible(!0),t++):this.txtNewPass.getString().length<6||15<this.txtNewPass.getString().length?(this.msgNewPass.setString("Mật khẩu có độ dài 6-15 ký tự"),this.msgNewPass.setVisible(!0),t++):this.msgNewPass.setVisible(!1),""==n?(this.msgComfirm.setString("Nhập xác nhận mật khẩu"),this.msgComfirm.setVisible(!0),t++):this.msgComfirm.setVisible(!1),i!=n?(this.msgComfirm.setString("Mật khẩu không khớp"),this.msgComfirm.setVisible(!0),t++):this.msgComfirm.setVisible(!1),!(0<t)},onCallBackChangePass:function(t){t=JSON.parse(t),Utilities.showLog("onCallBackChangePass  "+JSON.stringify(t)),1==t.Result&&(1===t.Data?(JFGameInfo.JFMain.layerPopup.hidePopupChangePass(),JFGameInfo.JFMain.layerPopup.showPopupMsg(t.Message)):(this.msgError.setVisible(!0),this.msgError.setString(t.Message)))},dispose:function(){JFGameInfo.JFMain.layerPopup.hidePopupChangePass()}}),JFUIBaseLayer.extend({isShowAlone:null,productPurchase:null,idIAP:"",inAppInfo:null,ctor:function(){JFUIBaseLayer.prototype.ctor.call(this),this.isShowAlone=!0},initObj:function(){this._initFromCocostudio(ResourceManager.JFResourcesMenuGame.CSSUIInappPopup),this.idIAP="",this.inAppInfo=cc.sys.os===cc.sys.OS_IOS?ConstantsVariable.ConfigInAppIOS:ConstantsVariable.ConfigInApp;try{sdkbox.IAP.removeListener(),sdkbox.IAP.refresh(),sdkbox.IAP.setListener({onSuccess:this.onGetInApp.bind(this),onFailure:function(t,e){JFGameInfo.JFMain.layerPopup.showPopupMsg("Mua gói nạp "+this.inAppInfo[t.name].xu+" thất bại.")}.bind(this),onCanceled:function(t){},onRestored:function(t){},onProductRequestSuccess:this.onRequestProductSuccess.bind(this),onProductRequestFailure:function(t){JFGameInfo.JFMain.layerPopup.showPopupMsg("Không thể mua gói nạp xu.")}})}catch(t){}},onRequestProductSuccess:function(t){for(var e,i,n,s=0;s<t.length;s++)n=t[s],null!==(e=this._mainLayer.getChildByName(n.name))&&(e.setVisible(!0),(i=e.getChildByName("txtXu"))&&i.setString(this.inAppInfo[n.name].xu),(e=e.getChildByName("txtMoney"))&&e.setString(this.inAppInfo[n.name].money),n=this._mainLayer.getChildByName("BG_"+n.name))&&n.addClickEventListener(this.onClickBtnFromCocostudio.bind(this))},onGetInApp:function(t){this.productPurchase=t;try{var e=cc.sys.os===cc.sys.OS_IOS?{purchaseToken:t.receiptCipheredPayload}:JSON.parse(t.receipt),i={},n=(i.UserID=JFGameInfo.myInfo.UserID,i.VersionDevice=JFGameInfo.VersionDevice,i.DeviceModel=JFGameInfo.DeviceModel,i.PacketName=JFGameInfo.packetName,i.PackageName=JFGameInfo.packetName,i.PlatformID=JFGameInfo.myPlatform,i.AppVersion=JFGameInfo.AppVersion,i.HardwareID=JFGameInfo.devineID,i.ProductId=t.id,i.ChannelId=JFGameInfo.ChannelID,{TokenIAP:e.purchaseToken});i.Sign=md5.encscript("CreditGoogle"+i.PackageName+i.ProductId+e.purchaseToken+i.UserID+i.PlatformID+i.AppVersion+i.HardwareID+i.ChannelId+i.VersionDevice+i.DeviceModel+i.PacketName+JFGameInfo.myInfo.token4Ws),Utilities.getAPIWithHeaders("CreditGoogle",i,n,this._callBackInApp.bind(this))}catch(t){JFGameInfo.JFMain.layerPopup.showPopupMsg("Xuất hiện lỗi trong quá trình xử lý!")}},_callBackInApp:function(t){1===(t=JSON.parse(t)).Result?this.productPurchase&&JFGameInfo.JFMain.layerPopup.showPopupMsg("Mua gói nạp xu bắn cá "+ConstantsVariable.ConfigInApp[this.productPurchase.name].xu+" thành công. Bạn nhận được "+Utilities.Coin(parseInt(t.Data.gold))+" xu"):JFGameInfo.JFMain.layerPopup.showPopupMsg(t.Message)},checkIAP:function(){JFGameInfo.JFMain.showLoading();var t={};t.UserID=JFGameInfo.myInfo.UserID,t.VersionDevice=JFGameInfo.VersionDevice,t.DeviceModel=JFGameInfo.DeviceModel,t.PacketName=JFGameInfo.packetName,t.PlatformID=JFGameInfo.myPlatform,t.AppVersion=JFGameInfo.AppVersion,t.HardwareID=JFGameInfo.devineID,t.ChannelId=JFGameInfo.ChannelID,t.Sign=md5.encscript("CheckAvaibleIap"+t.UserID+t.PlatformID+t.AppVersion+t.HardwareID+t.ChannelId+t.VersionDevice+t.DeviceModel+t.PacketName+JFGameInfo.myInfo.token4Ws),Utilities.getAPI("CheckAvaibleIap",t,this.callBackCheckIAP.bind(this))},callBackCheckIAP:function(t){if(JFGameInfo.JFMain.hideLoading(),1===(t=JSON.parse(t)).Result)try{sdkbox.IAP.enableUserSideVerification(!0),sdkbox.IAP.purchase(this.idIAP)}catch(t){JFGameInfo.JFMain.layerPopup.showPopupMsg("Không tìm thấy id gói xu bạn cần mua")}else JFGameInfo.JFMain.layerPopup.showPopupMsg(t.Message)},onClickBtnFromCocostudio:function(t,e){t=t.getName();-1<t.indexOf("xu")?(t=t.split("_")[1])&&(this.idIAP=t,this.checkIAP()):"JFButtonClose"===t&&(cc.audioEngine.playEffect(ResourceManager.JFResourcesMenuGame.SoundClose,!1),JFGameInfo.JFMain.layerPopup.hidePopupInApp())},dispose:function(){JFGameInfo.JFMain.layerPopup.hidePopupInApp()}})),JFPopupFirstTopup=JFUIBaseLayer.extend({confirmCallBack:null,isShowAlone:null,ctor:function(){JFUIBaseLayer.prototype.ctor.call(this),this.isShowAlone=!0},initObj:function(){this._initFromCocostudio(ResourceManager.JFResourcesMenuGame.CSSUIFirstTopupPopup)},onClickBtnFromCocostudio:function(t,e){"JFChargeBtn"===t.getName()&&(this.confirmCallBack&&this.confirmCallBack(),jf.audio.playEffect(ResourceManager.JFResourcesMenuGame.SoundClose,!1),JFGameInfo.JFMain.layerPopup.hidePopupFirstTopup())},onRegistercallback:function(t){this.confirmCallBack=t},dispose:function(){JFGameInfo.JFMain.layerPopup.hidePopupFirstTopup()}}),JFPopupListFrame=JFUIBaseLayer.extend({isShowAlone:null,arrayBorder:[],ctor:function(){JFUIBaseLayer.prototype.ctor.call(this),this.isShowAlone=!1},initObj:function(){this._initFromCocostudio(ResourceManager.JFResourcesMenuGame.CSSUIListFramePopup),this._mainLayer.getChildByName("Bg").addClickEventListener(this.onClickBtnFromCocostudio.bind(this)),this.arrayBorder=[],this.setupBorder(),this.onLoadBorder()},setupBorder:function(){for(var t=0;t<=30;t++)switch(t){case 5:this.registerItem("FrameLv_5","JFBtnFrameLv_5",t);break;case 10:this.registerItem("FrameLv_10","JFBtnFrameLv_10",t);break;case 15:this.registerItem("FrameLv_15","JFBtnFrameLv_15",t);break;case 20:this.registerItem("FrameLv_20","JFBtnFrameLv_20",t);break;case 25:this.registerItem("FrameLv_25","JFBtnFrameLv_25",t);break;case 30:this.registerItem("FrameLv_30","JFBtnFrameLv_30",t)}},registerItem:function(t,e,i){var n={};n.main=this._mainLayer.getChildByName(t),n.id=i,n.main.getChildByName(e).addClickEventListener(this.onClickBtnFromCocostudio.bind(this)),this.arrayBorder.push(n)},onLoadBorder:function(){for(var t=JFGameInfo.myInfo.Level,t=parseInt(t),e=0;e<this.arrayBorder.length;e++){var i=this.arrayBorder[e];parseInt(i.id)<=t?((i=(i=i.main.getChildren())[1]).setBright(!0),i.setEnabled(!0)):((i=(i=i.main.getChildren())[1]).setBright(!1),i.setEnabled(!1))}},onClickBtnFromCocostudio:function(t,e){switch(t.getName()){case"JFBtnClose":jf.audio.playEffect(ResourceManager.JFResourcesMenuGame.SoundClose,!1),JFGameInfo.JFMain.layerPopup.hidePopupListFrame();break;case"JFBtnFrameLv_5":case"JFBtnFrameLv_10":case"JFBtnFrameLv_15":case"JFBtnFrameLv_20":case"JFBtnFrameLv_25":case"JFBtnFrameLv_30":var i=t.getName().split("_")[1];this.updateBoderAvatar(i,"POST")}},updateBoderAvatar:function(t,e){JFGameInfo.JFMain.showLoading();var i={};i.UserID=JFGameInfo.myInfo.UserID,i.PlatformID=JFGameInfo.myPlatform,i.AppVersion=JFGameInfo.AppVersion,i.HardwareID=JFGameInfo.devineID,i.packetName=JFGameInfo.packetName,i.VersionDevice=JFGameInfo.VersionDevice,i.DeviceModel=JFGameInfo.DeviceModel,i.ChannelId=JFGameInfo.ChannelID,i.BorderId=t,i.Func=e,i.Sign=md5.encscript("GetLinkBorderAvatar"+i.BorderId+i.Func+i.UserID+i.PlatformID+i.AppVersion+i.HardwareID+i.ChannelId+i.VersionDevice+i.DeviceModel+i.packetName+JFGameInfo.myInfo.token4Ws),Utilities.getAPI("GetLinkBorderAvatar",i,this.onUpdateBorderAvatar.bind(this))},onUpdateBorderAvatar:function(t){JFGameInfo.JFMain.hideLoading(),1===(t=JSON.parse(t)).Result?(JFGameInfo.myInfo.promotionBorder=t.Data,cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.REFRESH_BORDER_AVATAR),JFGameInfo.JFMain.layerPopup.showPopupMsg("Thành công!")):JFGameInfo.JFMain.layerPopup.showPopupMsg("Thất bại!")},dispose:function(){JFGameInfo.JFMain.layerPopup.hidePopupListFrame()}}),JFPopupPromo=JFUIBaseLayer.extend({isShowAlone:null,ctor:function(){JFUIBaseLayer.prototype.ctor.call(this),this.isShowAlone=!0},initObj:function(){this._initFromCocostudio(ResourceManager.JFResourcesMenuGame.CSSUIPromoPopup),this._mainLayer.getChildByName("JFPromoBg").addClickEventListener(this.onClickBtnFromCocostudio.bind(this)),this.vina=this._mainLayer.getChildByName("JFVina"),this.mobi=this._mainLayer.getChildByName("JFMobi"),this.viettel=this._mainLayer.getChildByName("JFViettel"),this.item=null,this.onLoadPromotion()},onLoadPromotion:function(){JFGameInfo.JFMain.showLoading();var t={};t.UserID=JFGameInfo.myInfo.UserID,t.PlatformID=JFGameInfo.myPlatform,t.AppVersion=JFGameInfo.AppVersion,t.HardwareID=JFGameInfo.devineID,t.packetName=JFGameInfo.packetName,t.VersionDevice=JFGameInfo.VersionDevice,t.DeviceModel=JFGameInfo.DeviceModel,t.ChannelId=JFGameInfo.ChannelID,t.Sign=md5.encscript("GetStatusAvatar"+t.UserID+t.PlatformID+t.AppVersion+t.HardwareID+t.ChannelId+t.VersionDevice+t.DeviceModel+t.packetName+JFGameInfo.myInfo.token4Ws),Utilities.getAPI("GetStatusAvatar",t,this._onLoadData.bind(this))},_onLoadData:function(t){if(JFGameInfo.JFMain.hideLoading(),1==(t=JSON.parse(t)).Result){t=t.Data,t=JSON.parse(t);for(var e=0;e<t.length;e++){var i=t[e];switch(e){case 0:i.status?this.createItem(this.vina,ResourceManager.JFResourcesMenuGame.CSSUIJFVina10D,i.status):this.createItem(this.vina,ResourceManager.JFResourcesMenuGame.CCSUIJFVina10E,i.status);break;case 1:i.status?this.createItem(this.mobi,ResourceManager.JFResourcesMenuGame.CCSUIJFMobi200D,i.status):this.createItem(this.mobi,ResourceManager.JFResourcesMenuGame.CCSUIJFMobi200E,i.status);break;case 2:i.status?this.createItem(this.viettel,ResourceManager.JFResourcesMenuGame.CCSUIJFViettel500D,i.status):this.createItem(this.viettel,ResourceManager.JFResourcesMenuGame.CCSUIJFViettel500E,i.status)}}}else this.dispose(),JFGameInfo.JFMain.layerPopup.showPopupMsg("Không thành công. Vui lòng thử lại!")},createItem:function(t,e,i){this.item=null,this.item=new JFItemPromotion,this.item.initObj(e),this.item.onAction(i,this.onClickItem.bind(this)),t.addChild(this.item)},onClickItem:function(t){t?JFGameInfo.JFMain.layerPopup.showPopupMsg("Bạn đã nhận thưởng rồi!"):(this.dispose(),JFGameInfo.JFMain.layerPopup.showPopupInApp())},onClickBtnFromCocostudio:function(t,e){"JFCloseBtn"===t.getName()&&(jf.audio.playEffect(ResourceManager.JFResourcesMenuGame.SoundClose,!1),JFGameInfo.JFMain.layerPopup.hidePopupPromo())},dispose:function(){JFGameInfo.JFMain.layerPopup.hidePopupPromo()}}),JFItemPromotion=JFUIBaseLayer.extend({ctor:function(){JFUIBaseLayer.prototype.ctor.call(this)},initObj:function(t){this._initFromCocostudio(t),this._mainLayer.getChildByName("JFCardBg").addClickEventListener(this.onClickBtnFromCocostudio.bind(this)),this._mainLayer.getChildByName("JFNhanBtn").addClickEventListener(this.onClickBtnFromCocostudio.bind(this)),this.payment=!1,this.callback=null},onAction:function(t,e){this.payment=t,this.callback=e},onClickBtnFromCocostudio:function(t,e){switch(t.getName()){case"JFCardBg":case"JFNhanBtn":this.callback&&this.callback(this.payment)}}}),JFUserContainer=cc.Node.extend({UserInfoTxTGold:"UserInfoTxTGold",UserInfoTxTLv:"UserInfoTxTLv",borderAvatar:"borderAvatar",UserAvatar:"UserAvatar",_avatar:null,_listEvents:null,sriteMask:null,clippingNode:null,ctor:function(){cc.Node.prototype.ctor.call(this)},initObj:function(){this.UserInfoTxTGold="UserInfoTxTGold",this.UserInfoTxTLv="UserInfoTxTLv",this._initEvents(),this.borderAvatar="UserInfoBtn",this.UserAvatar="UserAvatar"},cloneFromNode:function(t){for(this.setName(t.getName()),this.setPosition(t.getPosition()),this.setVisible(t.isVisible()),this.setLocalZOrder(t.getLocalZOrder());0<t.getChildrenCount();){var e=t.getChildren()[0];e.removeFromParent(),this.addChild(e)}t.removeFromParent(),this.refeshUserInfo()},_initEvents:function(){this._listEvents=[],this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.UPDATE_MY_GOLD.toString(),this._getUpdateGoldFromSystem.bind(this))),this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.EVENTS.MENU_LAYER_UPDATE_USER.toString(),this.refeshUserInfo.bind(this))),this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.EVENTS.REFRESH_AVATAR_USER,this.updateAvatar.bind(this))),this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.EVENTS.REFRESH_BORDER_AVATAR,this._borderAvatar.bind(this))),this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.EVENTS.DISPATCH_REFRESH_AVATAR_USER,this.updateAvatar.bind(this))),this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.EVENTS.CHECK_USER_LOGIN,this._setDefaultAvatar.bind(this))),this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.EVENTS.REMOVE_AVATAR_LOGOUT,this._removeChild.bind(this)))},_removeChild:function(){this.removeChild(this._avatar),this._avatar=null},_setDefaultAvatar:function(){this._initMask(),cc.sys.isNative?this.updateAvatar():this.getAvatarByUserID(JFGameInfo.myInfo.UserID)},_getUpdateGoldFromSystem:function(t){t=t.getUserData();var e={Gold:BinaryConstants.DataTypeID.UInt64};t=(new BinaryParser).init(e,t.content),JFGameInfo.myInfo.Gold=t.Gold,this.refeshUserInfo()},refeshUserInfo:function(t){this.getChildByName(this.UserInfoTxTGold).setString(Utilities.Coin(JFGameInfo.myInfo.Gold)),this.getChildByName(this.UserInfoTxTLv).setString(Utilities.Coin(JFGameInfo.myInfo.Level)),this.getChildByName(this.UserInfoTxTLv).setVisible(!1),this.updateAvatar()},updateAvatar:function(){Utilities.showLog("////////////////////UPDATE AVATAR//////////////////////"),null!=this._avatar&&this._avatar.getParent()&&(this._avatar.removeFromParent(),this._avatar=null),this._avatar=new cc.Sprite,this._avatar.setPosition(cc.p(70,70)),this.getChildByName(this.UserAvatar).addChild(this._avatar),JFGameInfo.myInfo.avatarPath&&""!=JFGameInfo.myInfo.avatarPath||(JFGameInfo.myInfo.avatarPath=1);var t;if(11<=(t=parseInt(JFGameInfo.myInfo.avatarPath))){switch(t){case 11:JFGameInfo.myInfo.avatarImage=ResourceManager.JFResourcesMenuGame.Avatar11;break;case 12:JFGameInfo.myInfo.avatarImage=ResourceManager.JFResourcesMenuGame.Avatar12;break;case 13:JFGameInfo.myInfo.avatarImage=ResourceManager.JFResourcesMenuGame.Avatar13}this._avatar.setTexture(JFGameInfo.myInfo.avatarImage),this._avatar.setPosition(cc.p(60,60))}else JFGameInfo.myInfo.avatarImage="Avatar_"+JFGameInfo.myInfo.avatarPath+".png",cc.spriteFrameCache.getSpriteFrame(JFGameInfo.myInfo.avatarImage)||(JFGameInfo.myInfo.avatarPath=1,JFGameInfo.myInfo.avatarImage="Avatar_1.png"),this._avatar.setSpriteFrame(JFGameInfo.myInfo.avatarImage),this._avatar.scaleX=1,this._avatar.scaleY=1,this._avatar.setPosition(cc.p(70,70));this._borderAvatar()},_borderAvatar:function(){var t=JFGameInfo.myInfo.promotionBorder,e=JFGameInfo.myInfo.Level,t=parseInt(t);switch((e=parseInt(e))<t&&0!==e&&(JFGameInfo.myInfo.promotionBorder=t=0),t=30<=t?30:t){case 0:case 1:case 2:case 3:case 4:JFGameInfo.myInfo.borderPathImage=ResourceManager.JFResourcesMenuGame.Border_0;break;case 5:case 6:case 7:case 8:case 9:JFGameInfo.myInfo.borderPathImage=ResourceManager.JFResourcesMenuGame.Border_5;break;case 10:case 11:case 12:case 13:case 14:JFGameInfo.myInfo.borderPathImage=ResourceManager.JFResourcesMenuGame.Border_10;break;case 15:case 16:case 17:case 18:case 19:JFGameInfo.myInfo.borderPathImage=ResourceManager.JFResourcesMenuGame.Border_15;break;case 20:case 21:case 22:case 23:case 24:JFGameInfo.myInfo.borderPathImage=ResourceManager.JFResourcesMenuGame.Border_20;break;case 25:case 26:case 27:case 28:case 29:JFGameInfo.myInfo.borderPathImage=ResourceManager.JFResourcesMenuGame.Border_25;break;case 30:JFGameInfo.myInfo.borderPathImage=ResourceManager.JFResourcesMenuGame.Border_30}parseInt(JFGameInfo.myInfo.avatarPath)<11?this.getChildByName(this.borderAvatar).setPosition(cc.p(9,9)):this.getChildByName(this.borderAvatar).setPosition(cc.p(0,0)),this.getChildByName(this.UserInfoTxTLv).setVisible(!1),this.getChildByName(this.borderAvatar).loadTextures(JFGameInfo.myInfo.borderPathImage),20<=t&&t<25?(this._avatar.scaleX=.85,this._avatar.scaleY=.85,11<=JFGameInfo.myInfo.avatarPath?this._avatar.setPosition(cc.p(63,60)):this._avatar.setPosition(cc.p(73,70))):(this._avatar.scaleX=1,this._avatar.scaleY=1),this.getChildByName(this.borderAvatar).scaleY=5<=t?.88:1},getAvatarByUserID:function(t){this.updateAvatar();try{var e={};e.uId=t,e.gId=412,e["flashvar-old"]=this.flashVar,this.getAPI("hinh-anh/avatar",e,this.callBackGetAvatar.bind(this))}catch(t){}},callBackGetAvatar:function(t){""!=(t=JSON.parse(t)).Path&&(JFGameInfo.myInfo.avatarImage="Avatar_"+t.Path+".png",JFGameInfo.myInfo.avatarPath=t.Path,this.updateAvatar())},getAPI:function(t,e,i){$.ajax({type:"POST",url:PreLoaderConfig.uploadLink+t,data:e,success:i,error:function(t){}})},distpatchUpdateAvatar:function(t){t=t.getUserData(),Utilities.showLog("distpatchUpdateAvatar "+JSON.stringify(t)),this._avatar&&this._avatar.getParent()&&this._avatar.removeFromParent(),(this._avatar=null)!=t&&""!=t.ImagePath?(JFGameInfo.myInfo.avatarPath=t.ImagePath,cc.loader.loadImg(JFGameInfo.myInfo.avatarPath,{isCrossOrigin:!0},this._onLoadAvatarComplete.bind(this))):this._loadAvatarDefault()},_loadAvatarDefault:function(){cc.loader.loadImg(PreLoaderConfig.PathToAvatarDefault,this._onLoadAvatarDefault.bind(this))},_onLoadAvatarComplete:function(t,e){t?this._loadAvatarDefault():(this._avatar&&(this._avatar.removeFromParent(),this._avatar=null),Utilities.showLog("load avatar complete"),JFGameInfo.myInfo.avatarImage=e,this._avatar&&void 0!==this._avatar?this._avatar.setTexture(JFGameInfo.myInfo.avatarImage):(this._avatar=new cc.Sprite(e),this._avatar.setPosition(cc.p(46,0)),this.addChild(this._avatar)),this._avatar.scaleX=100/e.width,this._avatar.scaleY=100/e.height)},_onLoadAvatarDefault:function(t,e){e&&(JFGameInfo.myInfo.avatarImage=e,this._avatar&&void 0!==this._avatar?this._avatar.setTexture(JFGameInfo.myInfo.avatarImage):(this._avatar=new cc.Sprite(e),this._avatar.setPosition(cc.p(53,-3)),this.clippingNode.addChild(this._avatar)),this._avatar.scaleX=100/e.width,this._avatar.scaleY=100/e.height)},dispose:function(){for(var t=0;t<this._listEvents.length;t++)cc.eventManager.removeListener(this._listEvents[t])},_initMask:function(){this.getChildByName("UserInfoTxTLv").setLocalZOrder(5)}}),JFLayerEffects=(JFLayerRooms=JFUIBaseLayer.extend({userContainer:null,_listEvents:null,_schedule:null,ImgFooterActive:null,listButton:null,currentButton:"",overlayColor:null,_layerEvent:null,_avatar:null,_avatarImage:null,btnVip:null,btnNormal:null,btnMiniGame:null,fxLayer:null,btnChange3DVersion:null,_layerLogin:null,_layerLobby:null,_btnLogin:null,_InfoUser:null,_formUser:null,_jackPotNormal:null,_jackPotVip:null,effectPromotion:null,strockPromotion:null,ctor:function(){JFUIBaseLayer.prototype.ctor.call(this)},initObj:function(){this._initFromCocostudio(ResourceManager.JFResourcesMenuGame.CSSUIRoomsLayer),this._initUserContainer(),this._mainLayer.getChildByName("JFBtnUsersOnline").getChildByName("TxtTotalUsersOnline").ignoreContentAdaptWithSize(!0),this._initEvents(),this.stopEffectAward(),this.btnPromotionPayment=this._mainLayer.getChildByName("JFBtnPromo"),this._effectBtnUuDai(),this.listButton=[],this.currentButton="JFBtnRoomNormal",this.overlayColor=cc.color(86,74,74),this.btnVip=this._mainLayer.getChildByName("JFBtnRoomVip"),this.listButton.push(this.btnVip),this.btnNormal=this._mainLayer.getChildByName("JFBtnRoomNormal"),this.listButton.push(this.btnNormal),this.btnMiniGame=this._mainLayer.getChildByName("JFBtnRoomMiniGame"),this.listButton.push(this.btnMiniGame),this.runAnimationBtnRoom(),this._layerEvent||0===JFGameInfo.myInfo.UserID||this._checkCurrentEvent(),this._mainLayer.getChildByName("JFBtnHelpBtnDoiThuong").setVisible(!PreLoaderConfig.IsReview),this._mainLayer.getChildByName("JFBtnBtnNapGold").setVisible(!PreLoaderConfig.IsReview),this._mainLayer.getChildByName("JFBtnNews").setVisible(!PreLoaderConfig.IsReview),this.initBtnTaiApp(),this.initBtnBanBe(),this.initBtn3DVersion(),this.initLogin(JFGameInfo.IsLoggedIn),cc.sys.isNative&&cc.sys.isMobile&&sdkbox.PluginFacebook.setListener({onLogin:this._onLoginFacebook.bind(this)}),this._jackPotNormal=new JFJackPot,this._jackPotNormal.cloneFromNode(this.btnNormal.getChildByName("JackPotNormal")),this._jackPotNormal.initObj(),this.btnNormal.addChild(this._jackPotNormal),this._jackPotNormal.setVisible(!1),this._jackPotNormal.setRomKindId(ConstantsVariable.RoomGameNormal),this._jackPotVip=new JFJackPot,this._jackPotVip.cloneFromNode(this.btnVip.getChildByName("JackPotVip")),this._jackPotVip.initObj(),this.btnVip.addChild(this._jackPotVip),this._jackPotVip.setVisible(!1),this._jackPotVip.setRomKindId(ConstantsVariable.RoomGameVip),Utilities.getAPI("isShowPromotion","",this._isShowEffectPromotion.bind(this))},_isShowEffectPromotion:function(t){JFGameInfo.JFMain.hideLoading(),t=JSON.parse(t),this.effectPromotion=this._mainLayer.getChildByName("JF_Pay_Effect"),this.strockPromotion=this._mainLayer.getChildByName("IMG_BTN_CUAHANG2_1"),"1"===t.Data?(this.effectPromotion.setVisible(!0),this.effectPromotion.runAction(cc.sequence(cc.fadeIn(.5),cc.fadeOut(.5))).repeatForever(),this.strockPromotion.setVisible(!0),this.strockPromotion.runAction(cc.sequence(cc.fadeIn(.5),cc.fadeOut(.5))).repeatForever()):(this.effectPromotion.setVisible(!1),this.strockPromotion.setVisible(!1))},_effectBtnUuDai:function(){this.btnPromotionPayment.getChildren()[0].runAction(cc.sequence(cc.scaleTo(.5,.8,1),cc.delayTime(.15),cc.scaleTo(.5,1.1,.9))).repeatForever()},initBtnTaiApp:function(){PreLoaderConfig.IsReview||cc.sys.isMobile&&cc.sys.isNative?(this._mainLayer.getChildByName("JFBtnTaiApp").setVisible(!1),this._mainLayer.getChildByName("JFBtnTaiApp").setEnabled(!1)):(this._mainLayer.getChildByName("JFBtnTaiApp").setVisible(!0),this._mainLayer.getChildByName("JFBtnTaiApp").setEnabled(!0))},initBtnBanBe:function(){this._mainLayer.getChildByName("JFBtnBanBe").setVisible(!1),this._mainLayer.getChildByName("JFBtnBanBe").setEnabled(!1)},initBtn3DVersion:function(){this._mainLayer.getChildByName("JFBtnChangeVersion").setVisible(!1),this._mainLayer.getChildByName("JFBtnChangeVersion").setEnabled(!1)},_createButton:function(t,e,i){(i=new sp.SkeletonAnimation(ResourceManager.JFResourcesMenuGame[i+"JSON"],ResourceManager.JFResourcesMenuGame[i+"ATLAS"])).setAnimation(0,"animation",!0),i.setAnchorPoint(cc.p(.5,.5)),i.setName("spine"),i.setPosition(cc.p(160,153));var n=new ccui.Layout;return n.setAnchorPoint(cc.p(.5,.5)),n.addChild(i),n.setPosition(e),n.setTouchEnabled(!0),n.setContentSize(cc.size(320,306)),n.addClickEventListener(this.onClickBtnFromCocostudio.bind(this)),n.setName(t),n},_checkCurrentEvent:function(){this._getDataOnline("GetListEventRunning",this._onGetListEventRunning.bind(this))},onCallBackGetListEventByWeb:function(t){this._layerEvent&&(this._layerEvent.removeAllChildren(!0),this._layerEvent.removeFromParent(!0),this._layerEvent=null),0<t.length?(this._initLayerEvent(),this._layerEvent._checkCurrentEvent(t)):this._resetLayerEvent(),JFGameInfo.JFMain.hideLoading()},_resetLayerEvent:function(){null!=this._layerEvent&&(this._layerEvent.removeAllChildren(!0),this._layerEvent.removeFromParent(!0),this._layerEvent=null)},initFXLayer:function(){this.fxLayer||(this.fxLayer=new sp.SkeletonAnimation(ResourceManager.JFResourcesMenuGame.FXLayer_json,ResourceManager.JFResourcesMenuGame.FXLayer_atlas),this.fxLayer.setAnimation(0,"animation",!0),this.addChild(this.fxLayer),cc.sys.isNative?this.fxLayer.setAnchorPoint(cc.p(.5,.5)):this.fxLayer.setAnchorPoint(cc.p(0,0)),this.fxLayer.setPosition(cc.p(JFGameInfo.appRealWidth/2,JFGameInfo.appRealHeight/2)))},runAnimationBtnRoom:function(){this.listButton[0].stopAllActions(),this.listButton[0].runAction(cc.sequence(new cc.MoveBy(1,cc.p(0,-25),0),new cc.MoveBy(1,cc.p(0,25),0)).repeatForever()),this.listButton[1].stopAllActions(),this.listButton[1].runAction(cc.sequence(new cc.MoveBy(1,cc.p(0,25),0),new cc.MoveBy(1,cc.p(0,-25),0)).repeatForever()),this.listButton[2].stopAllActions(),this.listButton[2].runAction(cc.sequence(new cc.MoveBy(1,cc.p(0,-25),0),new cc.MoveBy(1,cc.p(0,25),0)).repeatForever())},_initEvents:function(){this._listEvents=[],this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.UPDATE_TOTAL_USER_ONLINE.toString(),this._updateTotalUserOnline.bind(this))),this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.STATUS_AWARD.toString(),this._ngOnStatusAward.bind(this))),this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.EVENTS.CHECK_USER_LOGIN.toString(),this._eventLogin.bind(this))),this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.EVENTS.KICK_USER.toString(),this._kickUser.bind(this))),this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.JACKPOT_DATA.toString(),this._onMessageJackPot.bind(this)))},_onMessageJackPot:function(t){t=t.getUserData();var e={Coin:BinaryConstants.DataTypeID.UInt64,GameKindID:BinaryConstants.DataTypeID.UInt8};switch(t=(new BinaryParser).init(e,t.content),Utilities.showLog("_onMessageJackPot:"+JSON.stringify(t)),t.GameKindID){case ConstantsVariable.RoomGameNormal:this._jackPotNormal.getCurrentGold()!==t.Coin&&(this._jackPotNormal.setVisible(!0),this._jackPotNormal.setGold(t.Coin));break;case ConstantsVariable.RoomGameVip:this._jackPotVip.getCurrentGold()!==t.Coin&&(this._jackPotVip.setVisible(!0),this._jackPotVip.setGold(t.Coin))}},_callbackContainer:function(){},_eventLogin:function(){this._setLogIn(!0),this.initLogin(!0)},initLogin:function(t){this._mainLayer.getChildByName("JFBtnLogin").setVisible(!t),this._mainLayer.getChildByName("JFBtnRegister").setVisible(!t),this._mainLayer.getChildByName("JFBtnFacebook").setVisible(!t),this._mainLayer.getChildByName("JFBtnPromo").setVisible(t),null!=this.userContainer&&this.userContainer.setVisible(t),this._isLoggedIn()?(cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.REFRESH_AVATAR_USER),cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.REFRESH_BORDER_AVATAR)):(null!=this._jackPotVip&&this._jackPotVip.setVisible(!1),null!=this._jackPotNormal&&this._jackPotNormal.setVisible(!1),this._resetLayerEvent())},runScheduleGetUserOnline:function(){this.getTotalUserOnline(),this.getNewInfo(),this._schedule=this.getTotalUserOnline.bind(this),this.schedule(this._schedule,5)},getNewInfo:function(){JFGameInfo.JFMain.showLoading();var t={};t.UserID=JFGameInfo.myInfo.UserID,t.PlatformID=JFGameInfo.myPlatform,t.AppVersion=JFGameInfo.AppVersion,t.HardwareID=JFGameInfo.devineID,t.ChannelId=ConstantsVariable.CHANNEL_ID,t.VersionDevice=JFGameInfo.VersionDevice,t.DeviceModel=JFGameInfo.DeviceModel,t.packetName=JFGameInfo.packetName,t.Sign=md5.encscript("CheckNewInfo"+t.UserID+t.PlatformID+t.AppVersion+t.HardwareID+t.ChannelId+t.VersionDevice+t.DeviceModel+t.packetName+JFGameInfo.myInfo.token4Ws),Utilities.getAPI("CheckNewInfo",t,this.onCallBackGetNewInfo.bind(this))},onCallBackCheckNewInfo:function(t){this._mainLayer.getChildByName("JFBtnNews").getChildByName("IconNotifyNew")&&this._mainLayer.getChildByName("JFBtnNews").getChildByName("IconNotifyNew").setVisible(t.News),this._mainLayer.getChildByName("JFBtnMail").getChildByName("IconNotifyMail")&&this._mainLayer.getChildByName("JFBtnMail").getChildByName("IconNotifyMail").setVisible(t.MailBox),this._mainLayer.getChildByName("JFBtnBanBe").getChildByName("IconNotifyBanBe")&&this._mainLayer.getChildByName("JFBtnBanBe").getChildByName("IconNotifyBanBe").setVisible(t.NewFriend),this.playEffectNotifyReward(t.Reward),JFGameInfo.JFMain.hideLoading()},onCallBackGetNewInfo:function(t){JFGameInfo.JFMain.hideLoading(),t=JSON.parse(t),Utilities.showLog("onCallBackGetNewInfo "+JSON.stringify(t)),1===t.Result&&(t.Data.News?this._mainLayer.getChildByName("JFBtnNews").getChildByName("IconNotifyNew").setVisible(!0):this._mainLayer.getChildByName("JFBtnNews").getChildByName("IconNotifyNew").setVisible(!1),t.Data.MailBox?this._mainLayer.getChildByName("JFBtnMail").getChildByName("IconNotifyMail").setVisible(!0):this._mainLayer.getChildByName("JFBtnMail").getChildByName("IconNotifyMail").setVisible(!1))},stopScheduleGetUserOnline:function(){this.unschedule(this._schedule)},getTotalUserOnline:function(){JFGameInfo.JFMain.netSend.sendGetTotalUserOnline()},_updateTotalUserOnline:function(t){t=t.getUserData();var e={NumberOfUsers:BinaryConstants.DataTypeID.UInt32};t=(new BinaryParser).init(e,t.content),this._mainLayer.getChildByName("JFBtnUsersOnline").getChildByName("TxtTotalUsersOnline").setString(t.NumberOfUsers+" Người")},_initUserContainer:function(){Utilities.showLog("//////////////INIT USER INFO////////////////"),this.userContainer=new JFUserContainer,this.userContainer.initObj(),this.userContainer.cloneFromNode(this._mainLayer.getChildByName("JFUserInfo")),this.addChild(this.userContainer);var t=this.userContainer.getChildByName("UserInfoBtn");null!=t&&t.addClickEventListener(this.onClickBtnFromCocostudio.bind(this)),null!=(t=this.userContainer.getChildByName("UserInfoBtnNapGold"))&&(t.setVisible(!PreLoaderConfig.IsReview),t.addClickEventListener(this.onClickBtnFromCocostudio.bind(this))),this._mainLayer.getChildByName("JFBtnChest").setVisible(!1),this._mainLayer.getChildByName("JFBtnHelpBtnDoiThuong").setVisible(!0),this._mainLayer.getChildByName("JFBtnBtnNapGold").setVisible(!0),this._mainLayer.getChildByName("JFBtnFanpage").setVisible(!1)},_showMessageLogin:function(){JFGameInfo.JFMain.layerPopup.showPopupMsg("Vui lòng đăng nhập trước khi chơi")},_isLoggedIn:function(){return JFGameInfo.IsLoggedIn},_setLogIn:function(t){JFGameInfo.IsLoggedIn=t},_onLoginFacebook:function(t,e){this.timeoutFacebook&&clearTimeout(this.timeoutFacebook),t&&JFGameInfo.JFMain.layerPopup.loginFacebook(sdkbox.PluginFacebook.getAccessToken())},checkConfigIG:function(){cc.sys.isNative||this.userContainer.getAvatarByUserID(JFGameInfo.myInfo.UserID);var t,e,i=this.userContainer.getChildByName("UserInfoBtnNapGold");Utilities.ICV()?(i.setVisible(!1),this._mainLayer.getChildByName("JFBtnBtnNapGold").setVisible(!1),this._mainLayer.getChildByName("JFBtnHelpBtnDoiThuong").setVisible(!1),this._mainLayer.getChildByName("JFBtnFanpage").setVisible(!1),this._mainLayer.getChildByName("JFBtnNews").setVisible(!1)):cc.sys.isNative&&(Utilities.showLog("load nap gold dong "),!Utilities.ICV())&&PreLoaderConfig.EVENTS_IMG&&0<PreLoaderConfig.EVENTS_IMG.length&&(Utilities.showLog("load nap gold dong "),this._mainLayer.getChildByName("JFBtnBtnNapGold").loadTextureNormal(PreLoaderConfig.IMGG[1],ccui.Widget.PLIST_TEXTURE),t=cc.textureCache.getTextureForKey(PreLoaderConfig.IMGG[1]),this._mainLayer.getChildByName("JFBtnBtnNapGold").setContentSize(t.width,t.height),(e=this._mainLayer.getChildByName("JFBtnHelpBtnDoiThuong")).loadTextureNormal(PreLoaderConfig.IMGG[2],ccui.Widget.PLIST_TEXTURE),t=cc.textureCache.getTextureForKey(PreLoaderConfig.IMGG[2]),e.setContentSize(t.width,t.height),e.setVisible(!PreLoaderConfig.IsReview),this._mainLayer.getChildByName("JFBtnFanpage").loadTextureNormal(PreLoaderConfig.IMGG[3],ccui.Widget.PLIST_TEXTURE),t=cc.textureCache.getTextureForKey(PreLoaderConfig.IMGG[3]),this._mainLayer.getChildByName("JFBtnFanpage").setContentSize(t.width,t.height),i.loadTextureNormal(PreLoaderConfig.IMGG[0],ccui.Widget.PLIST_TEXTURE),t=cc.textureCache.getTextureForKey(PreLoaderConfig.IMGG[0]),i.setContentSize(t.width,t.height))},onClickBtnFromCocostudio:function(t,e){switch(t.getName()){case"JFBtnLogin":JFGameInfo.JFMain.layerPopup.showPopupLoginNormal();break;case"JFBtnRegister":JFGameInfo.JFMain.layerPopup.showPopupRegister();break;case"JFBtnFacebook":this.showLoginFB();break;case"JFBtnExit":this._onClickBtnExit();break;case"JFBtnSetting":JFGameInfo.JFMain.layerPopup.showPopupSetting();break;case"JFBtnPromo":JFGameInfo.JFMain.layerPopup.showPopupPromo();break;case"JFBtnHelp":JFGameInfo.JFMain.layerPopup.showPopupSupport();break;case"JFBtnFanpage":cc.sys.openURL(PreLoaderConfig.LINKS.FANPAGE);break;case"JFBtnTaiApp":cc.sys.openURL(PreLoaderConfig.LINKS.WEB_DOWNLOAD_APP);break;case"JFBtnChangeVersion":JFGameInfo.JFMain.layerPopup.showPopupMsg(ConstantsVariable.Messages.CONFIRM_CHANGE_VERSION,this.changeVersion.bind(this));break;case"JFBtnRoomNormal":this._isLoggedIn()?(JFGameInfo.JFMain.showLoading(),this._onClickBtnRoomNormal()):this._showMessageLogin();break;case"JFBtnRoomVip":this._isLoggedIn()?(JFGameInfo.JFMain.showLoading(),this._onClickBtnRoomVip()):this._showMessageLogin();break;case"JFBtnRoomMiniGame":this._isLoggedIn()?(JFGameInfo.JFMain.showLoading(),this._onClickBtnRoomMiniGame()):this._showMessageLogin();break;case"JFBtnUsersOnline":this._isLoggedIn()?JFGameInfo.JFMain.layerPopup.showPopupUsersOnline():this._showMessageLogin();break;case"JFBtnMail":this._isLoggedIn()?(JFGameInfo.JFMain.layerPopup.showPopupEmail(this.callBackOnShowHopThu.bind(this)),this._mainLayer.getChildByName("JFBtnMail").getChildByName("IconNotifyMail").setVisible(!1)):this._showMessageLogin();break;case"JFBtnRank":this._isLoggedIn()?JFGameInfo.JFMain.layerPopup.showPopupRank():this._showMessageLogin();break;case"UserInfoBtn":this._isLoggedIn()?JFGameInfo.JFMain.layerPopup.showPopupUserInfo(this.onUpdateAvatarUserCalLBack.bind(this)):this._showMessageLogin();break;case"JFBtnReward":this._isLoggedIn()?JFGameInfo.JFMain.layerPopup.showPopupReward(this.callBackOnOpenPhanThuong.bind(this)):this._showMessageLogin();break;case"JFBtnNews":this._isLoggedIn()?PreLoaderConfig.IsReview?JFGameInfo.JFMain.layerPopup.showPopupMsg("Tính năng đang xây dựng .."):(JFGameInfo.JFMain.layerPopup.showPopupNews(),this._mainLayer.getChildByName("JFBtnNews").getChildByName("IconNotifyNew").setVisible(!1)):this._showMessageLogin();break;case"JFBtnHelpBtnDoiThuong":this._isLoggedIn()?JFGameInfo.JFMain.layerPopup.showPopupExchange():this._showMessageLogin();break;case"JFBtnBtnNapGold":case"UserInfoBtnNapGold":this._isLoggedIn()?JFGameInfo.JFMain.layerPopup.showPopupInApp():this._showMessageLogin();break;case"JFBtnChest":this._isLoggedIn()?JFGameInfo.JFMain.layerPopup.showPopupChest():this._showMessageLogin();break;case"JFBtnMission":this._isLoggedIn()?JFGameInfo.JFMain.layerPopup.showPopupMission():this._showMessageLogin();break;case"JFBtnBanBe":this._isLoggedIn()?(JFGameInfo.JFMain.layerPopup.showPopupBanBe(),this._mainLayer.getChildByName("JFBtnBanBe").getChildByName("IconNotifyBanBe").setVisible(!1)):this._showMessageLogin()}},showLoginFB:function(){return;cc.sys.isNative&&cc.sys.isMobile?sdkbox.PluginFacebook.isLoggedIn()?JFGameInfo.JFMain.layerPopup.loginFacebook(sdkbox.PluginFacebook.getAccessToken()):sdkbox.PluginFacebook.login():cc.sys.isNative||FB.login(function(t){t.authResponse?(Utilities.showLog("LOGIN FACEBOOK SUCCESS"),JFGameInfo.JFMain.layerPopup.loginFacebook(t.authResponse.accessToken)):console.log("User cancelled login or did not fully authorize.")})},_onClickBtnExit:function(){this._isLoggedIn()?JFGameInfo.JFMain.layerPopup.showPopupMsg2(ConstantsVariable.Messages.LOGOUT_ACCOUNT,"Thoát",this.onLogout.bind(this)):(JFNetCore.JFMasterSocket.close(),JFGameInfo.JFMain._confimCloseGame())},_kickUser:function(){this._setLogIn(!1),this.initLogin(!1),JFGameInfo.JFMain.showLoading(),cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.REMOVE_AVATAR_LOGOUT)},onLogout:function(){JFGameInfo.JFMain.logout(),this._setLogIn(!1),this.initLogin(!1),cc.sys.localStorage.setItem("UserName",""),cc.sys.localStorage.setItem("Password",""),cc.sys.localStorage.setItem("facebook",!1)},changeVersion:function(){try{Dialog.BackToVersion()}catch(t){}},onUpdateAvatarUserCalLBack:function(t){!t&&""===t||(JFGameInfo.myInfo.avatarPath=t,cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.DISPATCH_REFRESH_AVATAR_USER),cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.REFRESH_POPUP_USER_INFO),this.onLoadAvatarComplete(JFGameInfo.myInfo.avatarPath))},onLoadAvatarComplete:function(t){if(t){var e="Avatar_"+t+".png";if(11<=JFGameInfo.myInfo.avatarPath)switch(JFGameInfo.myInfo.avatarPath){case 11:e=ResourceManager.JFResourcesMenuGame.Avatar11;break;case 12:e=ResourceManager.JFResourcesMenuGame.Avatar12;break;case 13:e=ResourceManager.JFResourcesMenuGame.Avatar13}this._avatar&&void 0!==this._avatar?this._avatar.setSpriteFrame(e):this._avatar=new cc.Sprite(t),e&&this._avatar.setLocalZOrder(-1)}else this.onLoadAvatarComplete("1")},callBackOnShowHopThu:function(t){this._mainLayer.getChildByName("JFBtnMail").getChildByName("IconNotifyMail").setVisible(t)},callBackOnOpenPhanThuong:function(t){this.playEffectNotifyReward(t)},playEffectNotifyReward:function(t){},_onClickBtnRoomNormal:function(){JFGameInfo.roomID=ConstantsVariable.RoomGameNormal,JFGameInfo.JFMain.netSend.sendGetInfoGameRoom(ConstantsVariable.ROOMKIND.FREE),JFGameInfo.FISH_CONFIG=ConstantsVariable.FISH_CONFIG_NORMAL,JFGameInfo.JFMain.layerComponents.compoOptionInGame.setRoomInfo(),Utilities.logGA(ConstantsVariable.GA_LOG.SCREEN_GAME_NORMAL)},_onClickBtnRoomVip:function(){JFGameInfo.roomID=ConstantsVariable.RoomGameVip,JFGameInfo.JFMain.netSend.sendGetInfoGameRoom(ConstantsVariable.ROOMKIND.VIP),JFGameInfo.FISH_CONFIG=ConstantsVariable.FISH_CONFIG_VIP,JFGameInfo.JFMain.layerComponents.compoOptionInGame.setRoomInfo(),Utilities.logGA(ConstantsVariable.GA_LOG.SCREEN_GAME_VIP)},_onClickBtnRoomMiniGame:function(){PreLoaderConfig.IsReview?JFGameInfo.JFMain.layerPopup.showPopupMsg("Tính năng đang xây dựng .."):(JFGameInfo.JFMain.layerPopup.showPopupMiniGame(),Utilities.logGA(ConstantsVariable.GA_LOG.SCREEN_MINI_GAME))},_ngOnStatusAward:function(t){t=t.getUserData();var e={CanGet:BinaryConstants.DataTypeID.UInt8};1==(new BinaryParser).init(e,t.content).CanGet?this.playEffectAward():this.stopEffectAward()},playEffectAward:function(){this.schedule(this.updateEffectAward,.8)},updateEffectAward:function(){},stopEffectAward:function(){this.unschedule(this.updateEffectAward)},callBackNEG:function(){PreLoaderConfig.IsReview||JFGameInfo.JFMain.layerPopup.showPopupWebview(ConstantsVariable.WEBVIEW.NAP_XU,!0)},onExit:function(){JFUIBaseLayer.prototype.onExit.call(this)},onEnter:function(){JFUIBaseLayer.prototype.onEnter.call(this)},_initLayerEvent:function(){this._layerEvent=new JFLayerEvent,this._layerEvent.initObj(),this._layerEvent.setName("_layerEvent"),this._layerEvent.setAnchorPoint(0,0),this.addChild(this._layerEvent)},dispose:function(){this.unschedule(this._schedule);for(var t=0;t<this._listEvents.length;t++)cc.eventManager.removeListener(this._listEvents[t]);this.userContainer.dispose(),this.removeAllChildren(!0)},_getDataOnline:function(t,e){var i={};i.UserID=JFGameInfo.myInfo.UserID,i.PlatformID=JFGameInfo.myPlatform,i.AppVersion=JFGameInfo.AppVersion,i.HardwareID=JFGameInfo.devineID,i.packetName=JFGameInfo.packetName,i.VersionDevice=JFGameInfo.VersionDevice,i.DeviceModel=JFGameInfo.DeviceModel,i.ChannelId=JFGameInfo.ChannelID,i.Sign=md5.encscript(t+i.UserID+i.PlatformID+i.AppVersion+i.HardwareID+i.ChannelId+i.VersionDevice+i.DeviceModel+i.packetName+JFGameInfo.myInfo.token4Ws),Utilities.getAPI(t,i,e.bind(this))},_onGetListEventRunning:function(t){1===(t=JSON.parse(t)).Result&&(0<t.Data.length?(this._layerEvent&&(this._layerEvent.removeAllChildren(!0),this._layerEvent.removeFromParent(!0),this._layerEvent=null),this._initLayerEvent(),this._layerEvent._checkCurrentEvent(t.Data)):this._layerEvent&&(this._layerEvent.removeAllChildren(!0),this._layerEvent.removeFromParent(!0),this._layerEvent=null))}}),JFLayerMainMenu=cc.Layer.extend({_layerLobby:null,_layerLogin:null,ctor:function(){cc.Layer.prototype.ctor.call(this)},initObj:function(){this._initlayerRooms(),this._initEvents()},_initEvents:function(){var t;!cc.sys.isNative&&cc.sys.isMobile&&(t=cc.EventListener.create({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!1,target:this,onTouchBegan:function(t,e){Utilities.requestFullScreen()}}),cc.eventManager.addListener(t,this))},_initlayerRooms:function(){this._layerLobby=new JFLayerRooms,this._layerLobby.initObj(),this._layerLobby.setName("_layerLobby"),this._layerLobby.setAnchorPoint(0,0),this.addChild(this._layerLobby)},dispose:function(){this._layerLobby.dispose()}}),JFUIBaseLayer.extend({layerScreenGame:null,listEvent:null,bossFishIcon:null,ctor:function(){JFUIBaseLayer.prototype.ctor.call(this)},initObj:function(){this.listEvent=[],this._initEvents()},_initEvents:function(){},playNetEffect:function(t){var e=new cc.Sprite;e.setSpriteFrame("net_0.png"),e.attr(t);var i,n=[];for(t=0;t<5;t++)i=cc.spriteFrameCache.getSpriteFrame("net_"+t+".png"),n.push(i);t=new cc.Animation(n,.12),t=cc.animate(t),t=cc.sequence(t,cc.removeSelf()),e.runAction(t),this.addChild(e)},playStunEffect:function(t){var e=new cc.Sprite;e.setTexture(ResourceManager.JFResourcesGame.IMG_TEXT_STUN),e.attr({x:t.x,y:t.y,zIndex:ConstantsVariable.UIZorder.TIP}),this.addChild(e),e.setScale(.3),e.runAction(cc.sequence(cc.scaleTo(.5,1).easeSineInOut(),cc.delayTime(.3),cc.removeSelf()))},playGoldEffect:function(t,e,i){var n,s,r=[],o=t.DeskStation,a=ConstantsVariable.GunPosition[o],c=cc.pDistance(e,a)/500,h=t.gold;if(0!==h){for(JFGameInfo.myInfo.DeskStation===o&&(JFGameInfo.myInfo.totalGold+=h),c=jf.math.randomFloorBetween(0,30),c=jf.math.random0Or1()?c:-c,Math.cos(cc.degreesToRadians(c)),Math.sin(cc.degreesToRadians(c)),t=i?jf.math.randomCeilBetween(4,8):Math.round((t.fishKind+1)/2),i=0;i<17;i++)c=cc.spriteFrameCache.getSpriteFrame(c="gold_"+i+".png"),r.push(c);for(i=new cc.Animation(r,.042),r=cc.animate(i),i=0;i<t;i++)c=-100+jf.math.randomFloorBetween(0,200),s=-100+jf.math.randomFloorBetween(0,200),(n=new cc.Sprite).setSpriteFrame("gold_0.png"),n.attr({x:c+e.x,y:s+e.y,zIndex:ConstantsVariable.UIZorder.GOLD}),this.addChild(n),c=cc.pDistance(cc.p(c+e.x,s+e.y),a)/500,n.runAction(cc.sequence(cc.delayTime(1+.15*i),cc.moveTo(c,a),cc.removeSelf(!0))),n.runAction(r.clone().repeatForever());a=Utilities.Coin(h.toString()),(h=1e6<=h?new cc.LabelBMFont(a,ResourceManager.JFResourcesGame.IMG_TR):1e5<=h?new cc.LabelBMFont(a,ResourceManager.JFResourcesGame.IMG_TRAMK):new cc.LabelBMFont(a,ResourceManager.JFResourcesGame.IMG_K)).attr({anchorX:.5,anchorY:.5,x:e.x,y:e.y,zIndex:ConstantsVariable.UIZorder.GOLD}),this.addChild(h),h.runAction(cc.sequence(cc.delayTime(1),cc.removeSelf())),!jf.sys.isIOS()&&JFGameInfo.myInfo.DeskStation!==o||(cc.audioEngine.playEffect(ResourceManager.JFResourcesGame.SoundFXCatch),cc.audioEngine.playEffect(ResourceManager.JFResourcesGame.SoundFXGold))}},playEffectCatchRedFish:function(t,e,i){if(null!=e&&null!=e.FishIDArray)for(var n=0;n<e.FishIDArray.length;n++){var s,r,o,a,c=i.getFishByID(e.FishIDArray[n]);null!=c&&!c.isDie()&&c.isInScreen()&&((s=new cc.Sprite).setTexture(ResourceManager.JFResourcesGame.IMG_LIGHT_BLUE),this.addChild(s),s.anchorX=0,s.x=t.x,s.y=t.y,r=c.getPosition(),o=new cc.p(s.x,s.y),a=100*cc.pDistance(r,o)/s.width/100,s.scaleX=a,r=cc.pSub(o,r),r=cc.radiansToDegrees(cc.pToAngle(r)),s.setRotation(180-r),s.scaleX=.1,s.runAction(cc.sequence(cc.scaleTo(.2,a,1),cc.delayTime(.3),cc.removeSelf())),i.catchFish(c.fishId,e.DeskStation,e.GoldReward))}},addBossIcon:function(t){this.bossFishIcon=new ccui.Button,this.bossFishIcon.loadTextureNormal("BOSS_HEAD_32.png",ccui.Widget.PLIST_TEXTURE),this.bossFishIcon.setPosition(cc.p(30,210)),this.bossFishIcon.addClickEventListener(function(){}),this.bossFishIcon.setName("bossFishIcon")}})),JFLayerEvent=JFUIBaseLayer.extend({_btnEvent:null,_icon:null,_console:null,_listenerMoveEventBtn:null,_isMovingBtn:!1,_isPopup:!1,_consoleRadius:null,IconNapTL:null,IconKHCode:null,nodeEvent:null,_listEvent:null,defaultPos:null,ctor:function(){JFUIBaseLayer.prototype.ctor.call(this),this.nodeEvent=[],this._listEvent=[]},returnToDefaultPos:function(){this._btnEvent.setPosition(this.defaultPos)},initObj:function(){this._initFromCocostudio(ResourceManager.JFResourcesMenuGame.CCSUILayerEvent_json),this.IconNapTL=this._mainLayer.getChildByName("UIEventConsole").getChildByName("event_3").getChildByName("JFEventNapTL"),this.IconNapTL.removeFromParent(),this.IconKHCode=this._mainLayer.getChildByName("UIEventConsole").getChildByName("event_4").getChildByName("JFEventKHCode"),this.IconKHCode.removeFromParent(),this.nodeEvent[1]=this._mainLayer.getChildByName("UIEventConsole").getChildByName("event_1"),this.nodeEvent[2]=this._mainLayer.getChildByName("UIEventConsole").getChildByName("event_2"),this.nodeEvent[3]=this._mainLayer.getChildByName("UIEventConsole").getChildByName("event_3"),this.nodeEvent[4]=this._mainLayer.getChildByName("UIEventConsole").getChildByName("event_4"),this.hideAllEvents(),this._icon=this._mainLayer.getChildByName("UIEventConsole").getChildByName("UIEventIcon"),this._icon.setVisible(!1),this._icon.addClickEventListener(this.onClickBtnFromCocostudio.bind(this)),this._console=this._mainLayer.getChildByName("UIEventConsole"),this._consoleRadius=cc.pDistance(cc.p(this._console.getPosition()),cc.p(this._console.getPositionX(),this._console.getPositionY()+this._console.getContentSize().height/2)),this._console.setVisible(!1),this.setTouchEnabled(!0),this.addClickLayerEvent(),this._initBtnEvent()},_checkCurrentEvent:function(t){this._listEvent=t,t=1;for(var e=0;e<this._listEvent.length;e++)switch(this._listEvent[e].Code){case ConstantsVariable.EVENT_CODE.KHO_BAU_DAI_DUONG:5<t||(this._initBtnEventKhoBauDaiDuong(t,this._listEvent[e].Function),t++);break;case ConstantsVariable.EVENT_CODE.MUA_CA_GIANG_SINH:5<t||(this._initBtnEventMuaCaGiangSinh(t,this._listEvent[e].Function),t++);break;case ConstantsVariable.EVENT_CODE.HOI_CA_MUA_XUAN:5<t||(this._initBtnEventHoiCaMuaXuan(t,this._listEvent[e].Function),t++);break;case ConstantsVariable.EVENT_CODE.UU_DAI_NAP_THE:5<t||(this._initBtnEventUuDaiNapThe(t,this._listEvent[e].Function),t++);break;case ConstantsVariable.EVENT_CODE.TICH_LUY_NAP_THE:5<t||(this._initBtnEventNapTichLuy(t,this._listEvent[e].Function),t++);break;case ConstantsVariable.EVENT_CODE.KICH_HOAT_CODE:5<t||(this._initBtnKichHoatCode(t,this._listEvent[e].Function),t++);break;case ConstantsVariable.EVENT_CODE.SAN_LI_XI:5<t||(this._initBtnSanLiXi(t,this._listEvent[e].Function),t++)}},_initBtnSanLiXi:function(t,e){var i=new ccui.Button;i.loadTextureNormal(ResourceManager.JFResourcesMenuGame.UIBtnEventSanLiXi_png),i.setName("EventSanLiXi"),i.addTouchEventListener(this.onClickBtnFromCocostudio.bind(this)),i.func=e,this.nodeEvent[t].addChild(i),this.nodeEvent[t].Visible=!0},_initBtnEventMuaCaGiangSinh:function(t,e){var i=this.initSpineBtn(ResourceManager.JFResourcesMenuGame.UIBtnEventMCGS_json,ResourceManager.JFResourcesMenuGame.UIBtnEventMCGS_atlas,0,"animation",!0,100,100,0,0,"_btnEventMCGS",1);i.addTouchEventListener(this.onClickBtnFromCocostudio.bind(this)),i.func=e,this.nodeEvent[t].addChild(i),this.nodeEvent[t].Visible=!0},_initBtnEventHoiCaMuaXuan:function(t,e){var i=new ccui.Button;i.loadTextureNormal(ResourceManager.JFResourcesMenuGame.UIBtnEventVongQuaySeason_png),i.setTouchEnabled(!0),i.setName("EventVongQuayHoiCaMuaXuan"),i.addTouchEventListener(this.onClickBtnFromCocostudio.bind(this)),i.func=e,this.nodeEvent[t].addChild(i),this.nodeEvent[t].Visible=!0},_initBtnEventNapTichLuy:function(t,e){this.IconNapTL.setName("EventNapTichLuy"),this.IconNapTL.setTouchEnabled(!0),this.IconNapTL.addTouchEventListener(this.onClickBtnFromCocostudio.bind(this)),this.IconNapTL.func=e,this.nodeEvent[t].addChild(this.IconNapTL),this.nodeEvent[t].Visible=!0},_initBtnKichHoatCode:function(t,e){this.IconKHCode.setName("EventKichHoatCode"),this.IconKHCode.setTouchEnabled(!0),this.IconKHCode.addTouchEventListener(this.onClickBtnFromCocostudio.bind(this)),this.IconKHCode.func=e,this.nodeEvent[t].addChild(this.IconKHCode),this.nodeEvent[t].Visible=!0},_initBtnEventKhoBauDaiDuong:function(t,e){var i=this.initSpineBtn(ResourceManager.JFResourcesMenuGame.UIBttEventKBDD_json,ResourceManager.JFResourcesMenuGame.UIBttEventKBDD_atlas,0,"animation",!0,100,100,0,0,"_btnEventKBDD",1);i.addTouchEventListener(this.onClickBtnFromCocostudio.bind(this)),i.func=e,this.nodeEvent[t].addChild(i),this.nodeEvent[t].Visible=!0},_initBtnEventUuDaiNapThe:function(t,e){var i=this.initSpineBtn(ResourceManager.JFResourcesMenuGame.UIBttEventUDNT_json,ResourceManager.JFResourcesMenuGame.UIBttEventUDNT_atlas,0,"napthe",!0,100,100,0,0,"_btnEventUDNT",1.3);i.addTouchEventListener(this.onClickBtnFromCocostudio.bind(this)),i.func=e,this.nodeEvent[t].addChild(i),this.nodeEvent[t].Visible=!0},initSpineBtn:function(t,e,i,n,s,r,o,a,c,h,l){return(t=new sp.SkeletonAnimation(t,e)).setPosition(cc.p(r/2,o/2)),t.setAnimation(i,n,s),(i=new ccui.Layout).addChild(t),i.setAnchorPoint(.5,.5),i.setTouchEnabled(!0),i.setContentSize(cc.size(r,o)),i.setPosition(cc.p(a,c)),i.setName(h),i.setScale(l),i},_initBtnEvent:function(t){this._btnEvent=this.initSpineBtn(ResourceManager.JFResourcesMenuGame.UIBttEvent_json,ResourceManager.JFResourcesMenuGame.UIBttEvent_atlas,0,"animation",!0,80,80,1222,570,"_btnEvent",1),this.defaultPos=cc.p(1222,570),this._btnEvent.addTouchEventListener(this.onClickBtnFromCocostudio.bind(this)),this.addChild(this._btnEvent)},hide:function(){this._isPopup=!1,this.hideAllEvents(),this._btnEvent.setVisible(!0),this._console.setVisible(!1),this._icon.setVisible(!1)},hideAllEvents:function(){this.nodeEvent[1].setVisible(!1),this.nodeEvent[2].setVisible(!1),this.nodeEvent[3].setVisible(!1),this.nodeEvent[4].setVisible(!1)},show:function(){this._isPopup=!0,this.showCurrentEvents(),this._btnEvent.setVisible(!1),this._console.setVisible(!0),this._icon.setVisible(!0),this._console.setScale(.1),this._icon.setScale(.1),this._console.runAction(cc.sequence(cc.spawn(cc.scaleTo(.3,1),cc.rotateBy(.3,360)),cc.callFunc(function(){this._console.setRotation(0)}.bind(this)))),this._icon.runAction(cc.sequence(cc.spawn(cc.scaleTo(.3,1.3),cc.rotateBy(.3,360)),cc.callFunc(function(){this._icon.setRotation(0)}.bind(this))))},showCurrentEvents:function(){for(var t=1;t<5;t++)this.nodeEvent[t].setVisible(this.nodeEvent[t].Visible)},addClickLayerEvent:function(){var t=cc.EventListener.create({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:this.onClickLayer.bind(this)});cc.eventManager.addListener(t,this)},onClickBtnFromCocostudio:function(t,e){switch(JFUIBaseLayer.prototype.onClickBtnFromCocostudio.call(this,t,e),t.getName()){case"EventSanLiXi":this._isPopup&&e===ccui.Widget.TOUCH_ENDED&&JFGameInfo.JFMain.layerPopup.showPopupWebview(ConstantsVariable.WEBVIEW.SanLiXi,!0);break;case"_btnEventUDNT":this._isPopup&&e===ccui.Widget.TOUCH_ENDED&&JFGameInfo.JFMain.layerPopup.showPopupWebview(ConstantsVariable.WEBVIEW.UU_DAI_NAP_THE,!0);break;case"_btnEventKBDD":this._isPopup&&e===ccui.Widget.TOUCH_ENDED&&(JFGameInfo.roomID=ConstantsVariable.EventVongQuayKBDD,JFGameInfo.JFMain.layerMiniGame.createKhoBauDaiDuongGame(),JFGameInfo.JFMain.layerMiniGame.show());break;case"_btnEventMCGS":this._isPopup&&e===ccui.Widget.TOUCH_ENDED&&(JFGameInfo.roomID=ConstantsVariable.EventVongQuayMCGS,JFGameInfo.JFMain.layerMiniGame.createVongQuaySeason(ConstantsVariable.EVENT_CODE.MUA_CA_GIANG_SINH),JFGameInfo.JFMain.layerMiniGame.show());break;case"EventVongQuayHoiCaMuaXuan":this._isPopup&&e===ccui.Widget.TOUCH_ENDED&&(JFGameInfo.roomID=ConstantsVariable.EventVongQuaySeason,JFGameInfo.JFMain.layerMiniGame.createVongQuaySeason(ConstantsVariable.EVENT_CODE.HOI_CA_MUA_XUAN),JFGameInfo.JFMain.layerMiniGame.show());break;case"EventNapTichLuy":this._isPopup&&e===ccui.Widget.TOUCH_ENDED&&JFGameInfo.JFMain.layerPopup.showPopupWebview(ConstantsVariable.WEBVIEW.NAP_TICH_LUY,!0);break;case"EventKichHoatCode":this._isPopup&&e===ccui.Widget.TOUCH_ENDED&&JFGameInfo.JFMain.layerPopup.showPopupWebview(ConstantsVariable.WEBVIEW.KICH_HOAT_CODE,!0);break;case"UIEventIcon":this.hide();break;case"_btnEvent":var i;e===ccui.Widget.TOUCH_BEGAN?this.tempPos=t.getTouchBeganPosition():e===ccui.Widget.TOUCH_ENDED?(this.tempPos2=t.getTouchEndPosition(),cc.pDistance(this.tempPos,this.tempPos2)<=5&&this.show()):e===ccui.Widget.TOUCH_MOVED&&(i=this._btnEvent.getPosition(),t.getTouchMovePosition().x<=cc.winSize.width-40&&40<=t.getTouchMovePosition().x&&t.getTouchMovePosition().y<=cc.winSize.height-40&&40<=t.getTouchMovePosition().y?this._btnEvent.setPosition(cc.p(t.getTouchMovePosition())):this._btnEvent.setPosition(cc.p(i.x,i.y)))}},onClickLayer:function(t,e){if(!0===this._isPopup)return cc.pDistance(cc.p(t.getLocation()),cc.p(this._console.getPosition()))>this._consoleRadius&&this.hide(),!0}}),JFBullet=cc.Sprite.extend({_bulletNameDefault:"IMG_BULLET_",_bulletName:"",id:null,kind:null,multiple:null,_space:null,physicsSprite:null,angle:null,_physicsBody:null,_isDie:null,_isMe:null,lockFishID:null,targetFishLock:null,layerPhysic:null,SkillID:null,_data:null,countHit:null,scheduleLockFish:null,_gunValue:null,_event:null,_isReset:null,hixBoxCount:0,_vectorX:0,_vectorY:0,ctor:function(t,e){cc.Sprite.prototype.ctor.call(this),this._space=t,this.reInit(e)},initObj:function(){},reInit:function(t){if(this.hixBoxCount=0,this.lastPos=null,this._data=t,this.angle=-(t.Angle-90),this._vectorX=Math.cos(cc.degreesToRadians(this.angle)),this._vectorY=Math.sin(cc.degreesToRadians(this.angle)),this._isMe=t.isMe||!1,this.id=t.BulletID,this.SkillID=t.SkillID||0,this.countHit=0,this.setPosition(t.bulletPosition),this.setRotation(t.Angle),this.lockFishID=t.LockedFishID||0,this._isReset=!1,0!==this.lockFishID){t=JFGameInfo.JFMain.layerScreenGame.layerPhysic.getListFish();for(var e=0;e<t.length;e++)if(t[e].fishId===this.lockFishID){this.targetFishLock=t[e];break}}},initByID:function(t){null===this._gunValue&&(this._gunValue=JFGameInfo.JFMain.layerComponents.compoOptionInGame.getGunValue()),this.multiple=t,0<this.SkillID&&(this.multiple=this._gunValue[5].value);for(var e=t=0;e<this._gunValue.length;e++)this.multiple===this._gunValue[e].value&&(t=e);if(JFGameInfo.roomID===ConstantsVariable.RoomGameVip)this.kind=5;else switch(t){case 0:case 1:this.kind=0;break;case 2:this.kind=1;break;case 3:this.kind=2;break;case 4:this.kind=3;break;case 5:this.kind=4;break;case 6:this.kind=5}this._bulletName=this._bulletNameDefault+this.kind+".png",this.setTexture(ResourceManager.JFResourcesGame["Bullet"+this.kind]),this._initPhysicBody(),this.scheduleUpdate(),this._isDie=!1},_initPhysicBody:function(){this._physicsBody=new cp.Body(10,1),this._physicsBody.setPos(cp.v(this.getPosition().x,this.getPosition().y)),this._shape=new cp.BoxShape(this._physicsBody,this.width,this.height),this._shape.setCollisionType(ConstantsVariable.COLLISION.BULLET),(this._shape.target=this)._space.addShape(this._shape),cc.sys.isNative?this._shape.setFilter(cp.shapeFilterNew(ConstantsVariable.COLLISION.BULLET,1,1)):this._shape.group=ConstantsVariable.COLLISION.BULLET},_run:function(){this.scheduleUpdate()},update:function(t){var e,i,n;t*=ConstantsVariable.GAMESPEED.BULLET,!this.isDie()&&0<this.lockFishID&&this.targetFishLock&&!this.targetFishLock.isDie()&&this.targetFishLock.isInScreen()?(i=this.targetFishLock.getRealPosition().y-this.y,n=this.targetFishLock.getRealPosition().x-this.x,cc.pDistance(this.getPosition(),this.targetFishLock.getRealPosition()),e=Math.atan2(i,n),i=cc.pToAngle(e),n=Math.cos(e)*t,t*=Math.sin(e),n=this.x+n,t=this.y+t,this.setPositionX(n),this.setPositionY(t),this.lastPos=this.getPosition(),i&&(this.setRotation(i),this.angle=i)):(this._isReset||(this._isReset=!0,this.resetLockFish()),n=this.x+this._vectorX*t,t=this.y+this._vectorY*t,this.x=n,this.y=t,this.lastPos&&(i=jf.math.getRotation(this.getPosition(),this.lastPos))&&this.setRotation(i),this.lastPos=this.getPosition()),this.x>=JFGameInfo.appRealWidth||this.x<=0?(this._vectorX*=-1,this.x>JFGameInfo.appRealWidth?this.x=JFGameInfo.appRealWidth:this.x<0&&(this.x=0)):(this.y>=JFGameInfo.appRealHeight||this.y<=0)&&(this._vectorY*=-1,this.y>JFGameInfo.appRealHeight?this.y=JFGameInfo.appRealHeight:this.y<0&&(this.y=0)),this._physicsBody.setPos(cp.v(this.x,this.y)),this._physicsBody.setAngle(cc.degreesToRadians(this.rotation))},isDie:function(){return this._isDie},setDie:function(){this._isDie=!0,this._isMe&&JFGameInfo.bulletPool++,this.stopAllActions(),this.unschedule(this.scheduleLockFish),this.unscheduleUpdate(),this.unscheduleAllCallbacks()},resetLockFish:function(){this.lockFishID=0,this.stopAllActions()},followLockFish:function(){this.unschedule(this.scheduleLockFish),this.lockFishID=0;var t=jf.action.hitRepeatForever(this,cc.rect(0,0,JFUIBase.w,JFUIBase.h),cc.p(this.getPosition()),this.angle,ConstantsVariable.GAMESPEED.BULLET);this.runAction(t),this.scheduleUpdate()},removeAll:function(t){this._shape&&this._space.removeShape(this._shape),delete this._physicsBody,delete this._shape},isMe:function(){return this._isMe}}),JFFish=cc.Sprite.extend({space:null,data:null,uiTool:null,fishKind:null,config:null,name:null,initCount:null,fishId:null,traceType:null,fileName:null,finalFileName:null,_isDie:!1,lastPos:null,updateTime:null,speed:null,moveTime:null,childs:null,physicsBody:null,shape:null,mass:10,isBoss:!1,bodyOffsetX:0,bodyOffsetY:0,_isInScreen:!1,isOutScreen:!1,tipScore:null,hpBar:null,currHp:null,fullHp:null,percentHP:null,isRedFish:!1,ItemID:null,bgHP:null,hideHPBind:null,isCheckedForTeThien:!1,choangEffect:null,isPausing:!1,ctor:function(t,e,i,n){cc.Sprite.prototype.ctor.call(this);try{this.space=n,this.data=e,this.fishKind=e.FishKind,this.isBoss=32<=this.fishKind&&this.fishKind<=34,this.config=JFGameInfo.FISH_CONFIG[this.fishKind],this.name=this.config.name,this.initCount=e.InitCount,this.fishId=e.FishID,this.isRedFish=e.IsRedFish,this.ItemID=e.ItemID,this.fileName=this.config.name+"",this.finalFileName="#"+this.fileName+"0.png",this.childs=[],this.tipScoreArr=[],this.lastPos=cc.p(0,0),this.percentHP=100,this.hideHPBind=this.hideHP.bind(this),this.speed=30*this.config.speed,this.setSpriteFrame(this.fileName+"0.png"),t.addChild(this),this.width<=0?this.removeFromParent():(this.onChangeState(ConstantsVariable.FishState.WALK),this.loadBody(),this.initSelf(),this.attr(i),this.scheduleUpdate(),this.schedule(this.updateScoreTip,.3))}catch(t){Utilities.showLog("Fish kind: "+this.fishKind+" error: "+t.stack)}},onChangeState:function(t){switch(this.isDie()||this.stopAllActions(),t){case ConstantsVariable.FishState.WALK:this.playWalk();break;case ConstantsVariable.FishState.DYING:this.playDying();break;case ConstantsVariable.FishState.SKILL:this.playSkill()}},playSkill:function(){for(var t,e=[],i=24;i<35;i++)t=this.fileName+""+i+".png",t=cc.spriteFrameCache.getSpriteFrame(t),e.push(t);i=new cc.Animation(e,.15),(i=cc.animate(i)).setTag(ConstantsVariable.FishState.SKILL),this.runAction(i)},playWalk:function(){if(!(this.config.wakingFrames<=0)){for(var t,e=[],i=0;i<this.config.wakingFrames;i++)t=this.fileName+""+i+".png",t=cc.spriteFrameCache.getSpriteFrame(t),e.push(t);i=new cc.Animation(e,.15),(i=cc.animate(i).repeatForever()).setTag(ConstantsVariable.FishState.WALK),this.isDie()||this.runAction(i)}},playDying:function(){var t;this.isDie()||((t=new cc.EventCustom(ConstantsVariable.EVENTS.FISH_DIE_REMOVE_LOCK)).setUserData({fishID:this.getID()}),cc.eventManager.dispatchEvent(t),this.delEffect(),this.stopAllActions(),this.runAction(cc.sequence(cc.spawn(cc.rotateBy(1,2160),cc.scaleTo(1,.1),cc.fadeOut(1)),cc.callFunc(this.removeAll.bind(this)))),this._isDie=!0)},removeAll:function(){this._isDie=!0,null!==this.physicsBody&&void 0!==this.physicsBody&&(this.physicsBody.eachShape(function(t){this.space.removeShape(t)}.bind(this)),this.unscheduleUpdate(),this.removeAllChildrenWithCleanup(!0),this.removeFromParent(),(this.physicsBody=null)!=this.bgHP)&&(this.bgHP.removeFromParent(),this.unschedule(this.hideHPBind))},initSelf:function(){var t;!0!==this.data.isFishGroup&&(t=cc.p(this.data.Position[0].PosX,this.data.Position[0].PosY),this.setPosition(cc.p(t.x,t.y)),this.moveToEnd(),this.updateFlip(cc.p(this.data.Position[1].PosX,this.data.Position[1].PosY)))},moveToEnd:function(){var t,e;this.isDie()||(e=cc.callFunc(function(){this.onChangeState(ConstantsVariable.FishState.DYING)}.bind(this)),2===this.data.InitCount?(t=cc.p(this.data.Position[1].PosX,this.data.Position[1].PosY),this.moveTime=cc.pDistance(this.getPosition(),t)/this.speed,t=cc.moveTo(this.moveTime,t)):3===this.data.InitCount&&(this.moveTime=cc.pDistance(this.getPosition(),cc.p(this.data.Position[2].PosX,this.data.Position[2].PosY))/this.speed,t=[cc.p(this.data.Position[0].PosX,this.data.Position[0].PosY),cc.p(this.data.Position[1].PosX,this.data.Position[1].PosY),cc.p(this.data.Position[2].PosX,this.data.Position[2].PosY)],t=cc.bezierTo(this.moveTime,t)),t?(e=cc.sequence(t,e),this.runAction(e)):jf.fn.callNextFrame(this.removeAll))},loadCollisionArea:function(){var t=.8,e=.3;34===this.fishKind&&(t=.3,e=.6,this.bodyOffsetY=-50),this.physicsBody=new cp.Body(this.mass,cp.momentForBox(this.mass,this.width*t,this.height*e)),this.shape=new cp.BoxShape(this.physicsBody,this.width*t,this.height*e),cc.sys.isNative?this.shape.setFilter(cp.shapeFilterNew(ConstantsVariable.COLLISION.FISH,1,1)):this.shape.group=ConstantsVariable.COLLISION.FISH},loadBody:function(){this.loadCollisionArea(),this.setPosition(cp.v(this.x+this.bodyOffsetX,this.y+this.bodyOffsetY)),this.space.addShape(this.shape),this.shape.setCollisionType(ConstantsVariable.COLLISION.FISH),this.shape.target=this},loadHp:function(){var t;32<=this.fishKind&&this.fishKind<=36&&(this.currHp=this.data.CurrentHP,this.fullHp=this.data.MaxHP,this.bgHP=new cc.Sprite,this.bgHP.setSpriteFrame("BG_IMG_HP.png"),this.bgHP.attr({zIndex:200}),this.bgHP.setPosition(cc.p(this.x,this.y+this.height/2)),this.bgHP.scheduleUpdate(),this.bgHP.update=function(){this.bgHP.setPosition(this.x,this.y+this.height/2)}.bind(this),this.getParent().addChild(this.bgHP),(t=new cc.Sprite).setSpriteFrame("BOSS_HEAD_"+this.fishKind+".png"),t.setPosition(43,this.bgHP.height/2),this.bgHP.addChild(t),(t=new cc.Sprite).setSpriteFrame("IMG_HP_BAR.png"),t.setPosition(this.bgHP.width/2+40,this.bgHP.height/2),this.bgHP.addChild(t),t=new ccui.LoadingBar,this.bgHP.addChild(t),t.setName("LoadingBar"),t.loadTexture("IMG_HP_CURRENT_1.png",ccui.Widget.PLIST_TEXTURE),t.setPercent(100),t.attr({x:this.bgHP.width/2+40,y:this.bgHP.height/2}),this.hpBar=t,this.bgHP.setVisible(!1),this.schedule(this.updateScoreTip,.3))},updateScoreTip:function(){var t;0<this.tipScoreArr.length&&((t=this.tipScoreArr[0]).setVisible(!0),t.runAction(cc.moveBy(1,cc.p(0,35)).easeSineOut()),t.runAction(cc.sequence(cc.delayTime(.5),cc.fadeOut(.5),cc.removeSelf())),this.tipScoreArr.splice(0,1))},update:function(){this.physicsBody.setPos(cp.v(this.x+this.bodyOffsetX,this.y+this.bodyOffsetY)),this.physicsBody.setAngle(cc.degreesToRadians(-this.rotation)),this.updateOutScreen(),this.updateDirection()},updateOutScreen:function(){var t;this._isInScreen?this.isInScreen()||this.isOutScreen||((t=new cc.EventCustom(ConstantsVariable.EVENTS.FISH_DIE_REMOVE_LOCK)).setUserData(this),cc.eventManager.dispatchEvent(t),this.isOutScreen=!0):this.isInScreen()&&(this._isInScreen=!0)},updateDirection:function(){var t;this._isDie||!this.data.isNeedUpdateDir&&this.data.isFishGroup||(t=cc.p(this.x,this.y),this.updateTime++,1==this.updateTime%2?this.lastPos=t:JFGameInfo.roomID===ConstantsVariable.RoomGameVip?28!==this.fishKind&&1!==this.fishKind&&(t=-jf.math.getAngle(this.lastPos,t),this.setRotation(t)):28!==this.fishKind&&(t=-jf.math.getAngle(this.lastPos,t),this.setRotation(t)))},onHited:function(t){32<=this.fishKind&&this.fishKind<36&&((t=new cc.LabelBMFont("-"+Number(t).toString(),ResourceManager.JFResourcesGame.hpAtlas)).attr({anchorX:.5,x:this.width/2+20,y:this.height/2+100,visible:!1,zIndex:9999}),this.addChild(t),this.tipScoreArr.push(t)),32<=this.fishKind&&this.fishKind<=34&&(this.setColor(cc.color(255,0,0,255)),this.scheduleOnce(function(){this.setColor(cc.color(255,255,255,255))},.1))},pause:function(){this.isPausing||(this.isPausing=!0,this.scheduler.pauseTarget(this),this.actionManager&&this.actionManager.pauseTarget(this))},resume:function(){JFGameInfo.CurrentLayer===ConstantsVariable.LAYERS.MENU_LAYER_GAME&&this.isPausing&&!this.isDie()&&(this.isPausing=!1,this.choangEffect&&(this.delEffect(),this.isCheckedForTeThien=!1),this.scheduler.resumeTarget(this),this.actionManager)&&this.actionManager.resumeTarget(this)},initEffect:function(t,e,i,n,s){return(t=new sp.SkeletonAnimation(t,e)).setAnchorPoint(0,0),t.setPosition(cc.p(this.getContentSize().width/3*2,this.getContentSize().height/2)),t.setVisible(!0),t.setAnimation(i,n,s),t},pauseStun:function(){this.choangEffect||(28!==this.fishKind&&26!==this.fishKind?(this.choangEffect=this.initEffect(ResourceManager.JFResourcesGame.SpineEffectStun_json,ResourceManager.JFResourcesGame.SpineEffectStun_atlas,0,"choang",!0),this.choangEffect.retain()):28!==this.fishKind&&26!==this.fishKind||(this.choangEffect=this.initEffect(ResourceManager.JFResourcesGame.SpineEffectStun_json,ResourceManager.JFResourcesGame.SpineEffectStun_atlas,0,"choang",!0),this.choangEffect.retain(),this.choangEffect.setPosition(cc.p(this.getContentSize().width/2,this.getContentSize().height-50)))),this.addChild(this.choangEffect),this.isCheckedForTeThien=!0,this.pause()},resumeStun:function(){JFGameInfo.CurrentLayer!==ConstantsVariable.LAYERS.MENU_LAYER_GAME||this.isOutScreen||this.isDie()||this.resume()},delEffect:function(){JFGameInfo.CurrentLayer===ConstantsVariable.LAYERS.MENU_LAYER_GAME&&!this.isOutScreen&&this.choangEffect&&(this.choangEffect.clearTracks(),this.choangEffect.removeFromParent(),this.choangEffect=null)},updateHP:function(t,e){var i;0<this.currHp?(this.currHp=t,this.percentHP=this.currHp/e*100,i=1,this.percentHP<65?i=2:this.percentHP<35&&(i=3),this.hpBar.loadTexture("IMG_HP_CURRENT_"+i+".png",ccui.Widget.PLIST_TEXTURE),this.hpBar.setPercent(this.percentHP),this.currHp=t,this.fullHp=e):void 0!==this.currHp&&this.currHp<=0?(this.bgHP.removeFromParent(),this.unschedule(this.hideHPBind)):(this.currHp=t,this.fullHp=e),this.bgHP.setVisible(!0),this.unschedule(this.hideHPBind),this.schedule(this.hideHPBind,2)},updateFlip:function(t){(1===this.fishKind&&this.x>t.x&&JFGameInfo.roomID===ConstantsVariable.RoomGameVip||28===this.fishKind&&this.x>t.x)&&this.setFlippedX(!0)},hideHP:function(){this.unschedule(this.hideHPBind),this.bgHP.setVisible(!1)},isDie:function(){return this._isDie},getName:function(){return this.name},getInitCount:function(){return this.initCount},getKind:function(){return this.fishKind},setKind:function(t){this.fishKind=t},getID:function(){return this.fishId},getTraceType:function(){return this.traceType},getLastPos:function(){return this.lastPos},createHitFX:function(){for(var t=[],e=0;e<9;e++)t.push(cc.spriteFrameCache.getSpriteFrame("IMG_SKILL_HIT_2_"+e+".png"));e=cc.animate(new cc.Animation(t,.05)),(t=new cc.Sprite).setSpriteFrame("IMG_SKILL_HIT_2_0.png"),t.scaleX=this.width/t.width,t.scaleY=this.height/t.height,t.setPosition(cc.p(this.width/2,this.height/2)),this.addChild(t),t.runAction(cc.sequence(e,cc.removeSelf(),cc.callFunc(this.creatAOE_FX.bind(this))))},creatAOE_FX:function(){for(var t=[],e=0;e<6;e++)t.push(cc.spriteFrameCache.getSpriteFrame("IMG_SKILL_AOE_2_"+e+".png"));e=cc.animate(new cc.Animation(t,.05)),(t=new cc.Sprite).setSpriteFrame("IMG_SKILL_AOE_2_0.png"),t.setRotation(jf.math.randomBetween(0,360)),t.scaleX=this.width/t.width,t.scaleY=this.height/t.height,t.setPosition(cc.p(this.width/2,this.height/2)),this.addChild(t),t.runAction(cc.sequence(e,cc.removeSelf()))},getRealPosition:function(){return this.physicsBody.getPos()}}),JFLayerPhysic=JFUIBaseLayer.extend({listBullet:null,listFish:null,currBgIndex:null,space:null,layerScreenGame:null,_listEvents:null,bossFish:null,fishRecordIndex:0,spriteBatonTeThien:null,_batonSpeed:null,_currentDistance:null,timeForStun:null,teThienPos:null,teThienOrder:null,bossTeThien:null,dir:null,isReversed:null,disForBaton:null,listIdleBullet:null,countTime:null,ctor:function(){JFUIBaseLayer.prototype.ctor.call(this)},initObj:function(){this.listBullet=[],this.listIdleBullet=[],this.listFish=[],this.currBgIndex=0,this._initEvents(),this._initPhysicsSpace(),this.scheduleUpdate(),this.loadBg(),this.countTime=0,this._initDebugPhysicsSpace()},_initEvents:function(){this._listEvents=[],this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.GAME_CREATE_BULLET.toString(),this._createBulletPhysicUI.bind(this))),this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.EVENTS.FISH_DIE_REMOVE_LOCK.toString(),this._updateBulletWhenFishDie.bind(this))),this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.GAME_CREATE_FISH.toString(),this._createFishPhysicUI.bind(this))),this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.GAME_UPDATE_HP_FISH_BOSS.toString(),this._updateBossHP.bind(this))),this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.GAME_CREATE_FISH_BOSS.toString(),this._createFishBoss.bind(this))),this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.GAME_CATCH_FISH.toString(),this._onCatchFish.bind(this))),this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.GAME_PLAY_GLOBAL_FX.toString(),this._onPlaySkillGlobal.bind(this))),this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.GAME_STOP_GLOBAL_FX.toString(),this._onStopSkillGlobal.bind(this))),this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.GAME_CATCH_RED_FISH.toString(),this._onCatchRedFish.bind(this))),this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.GAME_CREATE_SKILL.toString(),this._checkSkill.bind(this))),this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.GAME_CREATE_FISH_GROUP_NEW.toString(),this._createFishArray.bind(this))),this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.GAME_UPDATE_BOSS_DIE.toString(),this._updateBossDie.bind(this))),this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.GAME_DROP_ITEM.toString(),this._onDropItem.bind(this))),this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.DISPATCH_EVENT_TE_THIEN_QUANG_GAY.toString(),this.playSkillTeThienQuangGay.bind(this))),this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.EVENTS.USER_GET_TICKET.toString(),this.userGetTicket.bind(this)))},userGetTicket:function(t){t=t.getUserData();try{var e=new cc.Sprite;e.setTexture(ResourceManager.JFResourcesMenuGame.ImgFreeSlotTicket),this.addChild(e),e.setPosition(t.FromPos),e.runAction(cc.sequence(cc.moveTo(.25,cc.p(JFGameInfo.appRealWidth/2,JFGameInfo.appRealHeight/2)),cc.delayTime(.5),cc.spawn(cc.moveTo(1,this.layerScreenGame.layerGuns.listPlayer[t.StationID].getPosition()),cc.scaleTo(1,.3)),cc.removeSelf()))}catch(t){}},playSkillTeThienQuangGay:function(t){t=t.getUserData();var e={BossID:BinaryConstants.DataTypeID.UInt32,SkillID:BinaryConstants.DataTypeID.UInt8,Direction:BinaryConstants.DataTypeID.UInt8,TimeEffect:BinaryConstants.DataTypeID.UInt8,Distance:BinaryConstants.DataTypeID.UInt32},e=(new BinaryParser).init(e,t.content);for(t=0;t<this.listFish.length;t++)if(this.listFish[t].getID()===e.BossID&&!this.listFish[t].isOutScreen&&e.SkillID===ConstantsVariable.TE_THIEN_SKILL.QUANG_GAY){this.bossTeThien=this.listFish[t],this.spriteBatonTeThien||(this.spriteBatonTeThien=new cc.Sprite("#baton.png"),this.addChild(this.spriteBatonTeThien),this.spriteBatonTeThien.setVisible(!1),this._batonSpeed=e.Distance/1.5),this.listFish[t].onChangeState(ConstantsVariable.FishState.SKILL),this.disForBaton=this._currentDistance=e.Distance,this.timeForStun=e.TimeEffect;var i=22.5*parseInt(e.Direction),e=Math.cos(cc.degreesToRadians(i)),i=Math.sin(cc.degreesToRadians(i));this.teThienPos=this.listFish[t].getPosition(),this.dir=cc.p(e,i),this.scheduleOnce(this.onBatonAppear.bind(this),.6);break}},onBatonAppear:function(){this.spriteBatonTeThien.setVisible(!0),this.spriteBatonTeThien.setLocalZOrder(ConstantsVariable.UIZorder.FISH),this.spriteBatonTeThien.setPosition(this.bossTeThien.getPosition());var t=cc.rotateBy(.25,720).repeatForever();this.spriteBatonTeThien.runAction(t)},_updateBulletWhenFishDie:function(t){t=t.getUserData();for(var e=0;e<this.listBullet.length;e++)this.listBullet[e].lockFishID===t.fishID&&this.listBullet[e].resetLockFish()},loadBg:function(){var t=JFGameInfo.roomID===ConstantsVariable.RoomGameVip?ResourceManager.JFResourcesGame.IMGGameBG3:ResourceManager.JFResourcesGame["IMGGameBG"+this.currBgIndex];this.background=new cc.Sprite,this.background.setTexture(t),this.background.setPosition(JFUIBase.w2,JFUIBase.h2),this.addChild(this.background),this.background.scaleX=2,this.background.scaleY=2},update:function(t){this.countTime+=t,.03<this.countTime&&(this.space.step(this.countTime),this.countTime=0);for(var e=0;e<this.listBullet.length;e++){var i=this.listBullet[e];if(i&&i.isDie()){for(var n=0;n<JFGameInfo.myInfo.listBulletID.length;n++)if(JFGameInfo.myInfo.listBulletID[n]===i){JFGameInfo.myInfo.listBulletID.splice(n,1);break}this.listBullet.splice(e,1),i.removeAll(),i.retain(),this.removeChild(i),this.listIdleBullet.push(i),e--}}for(e=0;e<this.listFish.length;e++)(i=this.listFish[e])&&i.isDie()&&(this.listFish.splice(e,1),i.removeAll(),e--);if(this.spriteBatonTeThien&&this.spriteBatonTeThien.isVisible()){for(e=this.spriteBatonTeThien.getPosition().x+this.dir.x*t*this._batonSpeed,t=this.spriteBatonTeThien.getPosition().y+this.dir.y*t*this._batonSpeed,this._currentDistance-=cc.pDistance(cc.p(e,t),this.spriteBatonTeThien.getPosition()),this._currentDistance<=0&&(this._batonSpeed*=-1,this.isReversed=!0,this._currentDistance=this.disForBaton),!0===this.isReversed&&cc.pDistance(this.teThienPos,this.spriteBatonTeThien.getPosition())<50&&(this.spriteBatonTeThien.setVisible(!1),this._batonSpeed*=-1,this.bossTeThien.onChangeState(ConstantsVariable.FishState.WALK),this.bossTeThien.moveToEnd(),this.isReversed=!1),i=0;i<this.listFish.length;i++)(n=this.listFish[i]).isDie()||n.isOutScreen||n.isBoss||n.isPausing||!cc.rectIntersectsRect(n.getBoundingBox(),this.spriteBatonTeThien.getBoundingBox())||n.isCheckedForTeThien||(n.runAction(cc.callFunc(n.pauseStun.bind(n))),setTimeout(n.resumeStun.bind(n),1e3*this.timeForStun),n.isCheckedForTeThien=!0);this.spriteBatonTeThien.setPosition(cc.p(e,t))}},_initDebugPhysicsSpace:function(){},_initPhysicsSpace:function(t){this.space=new cp.Space,this.space.gravity=cp.v(0,0),this.space.sleepTimeThreshold=1,this.space.addCollisionHandler(ConstantsVariable.COLLISION.BULLET,ConstantsVariable.COLLISION.FISH,this._collisionBegin.bind(this),this._collisionPre.bind(this),this._collisionPost.bind(this),this._collisionSeparate.bind(this))},_collisionBegin:function(t,e){var i,n,t=t.getShapes();return t=(t[0].target instanceof JFBullet?(i=t[0].target,t[1]):(i=t[1].target,t[0])).target,i.isDie()||t.isDie()||!(i.lockFishID<=0||i.lockFishID===t.getID())||(n=this.layerScreenGame.layerGuns.listPlayer[i._data.DeskStation],i.isMe()&&JFGameInfo.myInfo.Gold>=i.multiple?t.isRedFish?(n=this.getFishIdByKind(t.getKind()),this.layerScreenGame.netSend.sendCatchRedFish(t.fishId,n,i.multiple)):this.layerScreenGame.netSend.sendCatchFish(t.fishId,i.multiple):null!=n&&n.UserID<0&&this.layerScreenGame.netSend.botCatchFish(t.fishId,i.multiple,i._data.BulletID,n.UserID),t.onHited(i.multiple),this.layerScreenGame.layerEffects.playNetEffect({x:i.x,y:i.y,zIndex:ConstantsVariable.UIZorder.NET}),i.setDie()),!0},_collisionPre:function(){return!0},_collisionPost:function(){return!0},_collisionSeparate:function(){return!0},_createBulletPhysicUI:function(t){var e;JFGameInfo.CurrentLayer===ConstantsVariable.LAYERS.MENU_LAYER_GAME&&(t=t.getUserData(),e=null,0<this.listIdleBullet.length?(e=this.listIdleBullet.shift()).reInit(t):(e=new JFBullet(this.space,t)).layerPhysic=this,e.initByID(t.BulletMultiple),this.addChild(e),this.listBullet.push(e),e.isMe())&&JFGameInfo.myInfo.listBulletID.push(e.id)},_updateBossDie:function(t){t=t.getUserData();var e,i={BossID:BinaryConstants.DataTypeID.UInt32,UserID:BinaryConstants.DataTypeID.UInt32,Gold:BinaryConstants.DataTypeID.UInt64,CardReward:BinaryConstants.DataTypeID.UInt32,NumberOfCard:BinaryConstants.DataTypeID.UInt16},i=(t=(new BinaryParser).init(i,t.content),this.layerScreenGame.layerGuns.listPlayer),n=this.getFishByID(t.BossID);if(i&&n)for(var s=0;s<i.length;s++)i[s].UserID===t.UserID&&((e={}).EffectID=t.CardReward,e.FishPos=n.getRealPosition(),e.DeskStation=i[s].DeskStation,0<t.NumberOfCard&&this.playEffectDropGif(e),t.TotalGold=t.Gold+i[s].Gold,t.Level=0,this.layerScreenGame.layerEffects.playGoldEffect({fishKind:n.fishKind,DeskStation:i[s].DeskStation,gold:t.Gold},n.getPosition()),this.playParticleEffects(n),this.runAction(cc.sequence(jf.shake(1,cc.p(0,0),10,20),cc.moveTo(0,cc.p(0,0)))),this.removeFishByID(t.BossID),t.DeskStation=i[s].DeskStation,cc.eventManager.dispatchCustomEvent(ConstantsVariable.NETWORK.GAME_USER_UPDATE_CATCHFISH.toString(),t))},_onDropItem:function(t){t=t.getUserData();var e={DeskStation:BinaryConstants.DataTypeID.UInt8,FishID:BinaryConstants.DataTypeID.UInt32,EffectID:BinaryConstants.DataTypeID.UInt8,Gold:BinaryConstants.DataTypeID.UInt64,TotalGold:BinaryConstants.DataTypeID.UInt64};t=(new BinaryParser).init(e,t.content),(e=this.getFishByID(t.FishID))&&e.isBoss&&(0<t.Gold&&this.layerScreenGame.layerEffects.playGoldEffect({fishKind:e.fishKind,DeskStation:t.DeskStation,gold:t.Gold},e.getRealPosition(),!0),t.Level=0,cc.eventManager.dispatchCustomEvent(ConstantsVariable.NETWORK.GAME_USER_UPDATE_CATCHFISH.toString(),t)),0!==t.EffectID&&this.layerScreenGame.layerGuns.myPlayer.DeskStation===t.DeskStation&&(e&&!e.isDie()?(t={FishPos:e.getRealPosition(),DeskStation:t.DeskStation,EffectID:t.EffectID},this.playEffectDropGif(t)):JFGameInfo.myInfo.itemGiftQuantity.push(t))},_createFishBoss:function(t){t=t.getUserData();var e={FishID:BinaryConstants.DataTypeID.UInt32,BossID:BinaryConstants.DataTypeID.UInt32,FishKind:BinaryConstants.DataTypeID.UInt8,MaxHP:BinaryConstants.DataTypeID.UInt32,CurrentHP:BinaryConstants.DataTypeID.UInt32,PathSeed:BinaryConstants.DataTypeID.UInt16,BirthTime:BinaryConstants.DataTypeID.UInt32};switch((t=(new BinaryParser).init(e,t.content)).InitCount=2,t.FishKind){case 32:case 33:i=ConstantsVariable.BOSS_IMG_INFO.TIEN_CA.width;break;case 34:i=ConstantsVariable.BOSS_IMG_INFO.TE_THIEN.width}t.Position=[{PosX:-i/2,PosY:JFGameInfo.appRealHeight/2},{PosX:JFGameInfo.appRealWidth+i/2,PosY:JFGameInfo.appRealHeight/2}],i=t.Position.length,34===t.FishKind&&(t.Position[0].PosY+=70,t.Position[i-1].PosY+=70),i=t.Position[i-1];var i=cc.p(i.PosX,i.PosY),e=cc.p(t.Position[0].PosX,t.Position[0].PosY),n=cc.pDistance(e,i)/(30*JFGameInfo.FISH_CONFIG[t.FishKind].speed);t.Position[0].PosX+=t.BirthTime/n*(i.x-e.x),i=32<=t.FishKind&&t.FishKind<=34,e=new JFFish(this,t,{zIndex:ConstantsVariable.UIZorder.FISH},this.space),35===t.FishKind&&(e.isBoss=!0,e.setLocalZOrder(ConstantsVariable.UIZorder.WATER+2)),i&&(e.isBoss=!0,(this.bossFish=e).setLocalZOrder(ConstantsVariable.UIZorder.WATER+1)),this.listFish.push(e),i&&32<=t.FishKind&&t.FishKind<=34&&0===t.BirthTime&&cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.SHOW_BOSS_COMING.toString(),{})},_createFishPhysicUI:function(t){if(JFGameInfo.CurrentLayer===ConstantsVariable.LAYERS.MENU_LAYER_GAME){t=t.getUserData();var e={ListFish:BinaryConstants.DataTypeID.Object8,ListFish_Struct:{FishID:BinaryConstants.DataTypeID.UInt32,FishKind:BinaryConstants.DataTypeID.UInt8,IsRedFish:BinaryConstants.DataTypeID.UInt8,InitCount:BinaryConstants.DataTypeID.UInt8,Position:BinaryConstants.DataTypeID.Object8,Position_Struct:{PosX:BinaryConstants.DataTypeID.Float,PosY:BinaryConstants.DataTypeID.Float},ItemID:BinaryConstants.DataTypeID.UInt32}};t=(new BinaryParser).init(e,t.content);for(var i=0;i<t.ListFish.length&&31!==t.ListFish[i].FishKind;i++)e=new JFFish(this,t.ListFish[i],{zIndex:ConstantsVariable.UIZorder.FISH},this.space),t.ListFish[i].IsRedFish&&e.setColor(cc.color.RED),this.listFish.push(e)}},_createFishArray:function(t){if(console.log("  _createFishArray ---\x3e>>  ",t),JFGameInfo.CurrentLayer===ConstantsVariable.LAYERS.MENU_LAYER_GAME){t=t.getUserData();var e,i,n={GroupKind:BinaryConstants.DataTypeID.UInt8,SceneKind:BinaryConstants.DataTypeID.UInt8,ListFish:BinaryConstants.DataTypeID.Object8,ListFish_Struct:{FishID:BinaryConstants.DataTypeID.UInt32,FishKind:BinaryConstants.DataTypeID.UInt8,IsRedFish:BinaryConstants.DataTypeID.UInt8}},s=(new BinaryParser).init(n,t.content);for(t=[],this.layerScreenGame.layerGuns.lockGun(!0),this.layerScreenGame.layerGuns.CancelLockFish(),this.currBgIndex=s.SceneKind,this.currBgIndex=5<this.currBgIndex?0:this.currBgIndex,n=JFGameInfo.roomID===ConstantsVariable.RoomGameVip?ResourceManager.JFResourcesGame.IMGGameBG3:ResourceManager.JFResourcesGame["IMGGameBG"+this.currBgIndex],(i=new cc.Sprite).setTexture(n),i.attr({x:JFUIBase.w+i.width,y:JFUIBase.h2,zIndex:ConstantsVariable.UIZorder.SWITCH}),this.addChild(i),i.scaleX=i.scaleY=2,n=0;n<2;n++)e=cc.spriteFrameCache.getSpriteFrame(e="transition_"+n+".png"),t.push(e);(t=new cc.Animation(t,.13)).setRestoreOriginalFrame(!0),n=cc.animate(t).repeatForever(),e=(i.x-JFUIBase.w2)/255,i.runAction(cc.sequence(cc.moveTo(e,cc.p(JFUIBase.w2,JFUIBase.h2)),cc.callFunc(function(){this.removeAllFish()}.bind(this)),cc.delayTime(0),cc.callFunc(function(){this.background.removeFromParent(),this.background=i,this.background.visible=!0,this.background.setLocalZOrder(ConstantsVariable.UIZorder.NONE),this.layerScreenGame.layerGuns.lockGun(!1),this.layerScreenGame.layerGuns.lockAnimation(!1),setTimeout(this.createFishGroup.bind(this,s),100);for(var t=0;t<this.listBullet.length;t++)this.listBullet[t].setLocalZOrder(ConstantsVariable.UIZorder.BULLET);jf.fn.callNextFrame(function(){jf.audio.stopMusic(),jf.audio.playMusic(ResourceManager.JFResourcesGame["SoundBGM"+(this.currBgIndex+1)])}.bind(this))}.bind(this)))),t=new cc.Sprite,this.addChild(t),t.setSpriteFrame("transition_0.png"),t.attr({anchorX:0,x:JFUIBase.w-50,y:JFUIBase.h2,zIndex:ConstantsVariable.UIZorder.SPACE+1}),t.runAction(n),e=(t.x+t.width)/255,t.runAction(cc.sequence(cc.moveTo(e,cc.p(-t.width,JFUIBase.h2)),cc.removeSelf())),cc.audioEngine.playEffect(ResourceManager.JFResourcesGame.SoundWave)}},createFishGroup:function(t){switch(this.fishRecordIndex=0,t.GroupKind=t.ParadeKind,t.GroupKind){case 0:this.createFishGroup1(t);break;case 1:this.createFishGroup2(t);break;case 2:this.createFishGroup3(t);break;case 3:this.createFishGroup4(t);break;case 4:this.createFishGroup5(t)}},createFishGroup1:function(t){var e={x:1.5*JFUIBase.w,y:JFUIBase.h2};for(this.createCircleFishGroup({moveScale:1.8,moveTime:55,count:100,startPos:e,radius:250,content:t},0),this.createCircleFishGroup({moveScale:1.8,moveTime:55,count:17,startPos:{x:e.x-100,y:e.y+100},radius:70,content:t},1),this.createCircleFishGroup({moveScale:1.8,moveTime:55,count:17,startPos:{x:e.x+100,y:e.y+100},radius:70,content:t},2),this.createCircleFishGroup({moveScale:1.8,moveTime:55,count:30,startPos:{x:e.x-100,y:e.y-100},radius:70,content:t},3),this.createCircleFishGroup({moveScale:1.8,moveTime:55,count:30,startPos:{x:e.x+100,y:e.y-100},radius:70,content:t},4),this.createCircleFishGroup({moveScale:1.8,moveTime:55,count:15,startPos:e,radius:120,content:t},5),this.createCircleFishGroup({moveScale:1.8,moveTime:55,count:1,startPos:e,radius:0,content:t},6),t=0;t<this.listFish.length;t++)34!==this.listFish[t].getKind()&&33!==this.listFish[t].getKind()&&32!==this.listFish[t].getKind()&&this.listFish[t].setFlippedY(!0)},createFishGroup3:function(t){for(this.createCircleFishGroup({moveScale:2,moveTime:50,count:50,startPos:cc.p(JFUIBase.w- -280,JFUIBase.h2),content:t,radius:250},0),this.createCircleFishGroup({moveScale:2,moveTime:50,count:40,startPos:cc.p(JFUIBase.w- -280,JFUIBase.h2),content:t,radius:190},1),this.createCircleFishGroup({moveScale:2,moveTime:50,count:30,startPos:cc.p(JFUIBase.w- -280,JFUIBase.h2),content:t,radius:140},2),this.createCircleFishGroup({moveScale:2,moveTime:50,count:1,startPos:cc.p(JFUIBase.w- -280,JFUIBase.h2),content:t,radius:0},0),this.createCircleFishGroup({moveScale:2,moveTime:50,count:50,startPos:cc.p(-280,JFUIBase.h2),content:t,radius:250,isMoveRight:!0},3),this.createCircleFishGroup({moveScale:2,moveTime:50,count:40,startPos:cc.p(-280,JFUIBase.h2),content:t,radius:190,isMoveRight:!0},4),this.createCircleFishGroup({moveScale:2,moveTime:50,count:30,startPos:cc.p(-280,JFUIBase.h2),content:t,radius:140,isMoveRight:!0},5),this.createCircleFishGroup({moveScale:2,moveTime:50,count:1,startPos:cc.p(-280,JFUIBase.h2),content:t,radius:0,isMoveRight:!0},0),t=86;t<this.listFish.length;t++)34!==this.listFish[t].getKind()&&33!==this.listFish[t].getKind()&&32!==this.listFish[t].getKind()&&this.listFish[t].setFlippedY(!0)},createFishGroup5:function(t){this.fishRecordIndex=0,this.circleCallback(40,cc.p(JFUIBase.w2-280,JFUIBase.h2),260,t,16,720),this.circleCallback(40,cc.p(JFUIBase.w2+280,JFUIBase.h2),260,t,18,810),this.circleCallback(40,cc.p(JFUIBase.w2-280,JFUIBase.h2),225.5,t,20,900),this.circleCallback(40,cc.p(JFUIBase.w2+280,JFUIBase.h2),224,t,21,945),this.circleCallback(24,cc.p(JFUIBase.w2-280,JFUIBase.h2),168,t,22,990),this.circleCallback(24,cc.p(JFUIBase.w2+280,JFUIBase.h2),167,t,22.66,1020),this.circleCallback(13,cc.p(JFUIBase.w2-280,JFUIBase.h2),102.5,t,23.33,1050),this.circleCallback(13,cc.p(JFUIBase.w2+280,JFUIBase.h2),100,t,24,1080),this.circleCallback(1,cc.p(JFUIBase.w2-280,JFUIBase.h2),0,t,24.66,1110),this.circleCallback(1,cc.p(JFUIBase.w2+280,JFUIBase.h2),0,t,25.33,1140)},circleCallback:function(t,e,i,n,s,r){var o,a,c,h=n.ListFish,l=360/t;for(n=0;n<t;n++)o=e.x+Math.cos(n*l*Math.PI/180)*i,a=e.y+Math.sin(n*l*Math.PI/180)*i,c={FishKind:h[this.fishRecordIndex].FishKind,FishID:h[this.fishRecordIndex].FishID,IsRedFish:h[this.fishRecordIndex].IsRedFish,isFishGroup:!0,isNeedUpdateDir:!0},o=new JFFish(this,c,{zIndex:ConstantsVariable.UIZorder.FISH,x:o,y:a},this.space),c.IsRedFish&&o.setColor(cc.color.RED),this.listFish.push(o),o.runAction(cc.sequence(cc.fadeIn(0),jf.circleBy(s,e,i,r),cc.callFunc(this.circleByDownCall.bind(this,o)))),this.fishRecordIndex++},circleByDownCall:function(t){var e=t.getLastPos().x,i=t.getLastPos().y,n=t.getPositionX(),s=t.getPositionY(),e=jf.math.getRotation(cc.p(n,s),cc.p(e,i)),e=jf.math.getHitPoint(cc.rect(-200,-200,JFUIBase.w+400,JFUIBase.h+400),cc.p(n,s),e),e=cc.p(e.x,e.y),n=cc.pDistance(cc.p(n,s),e)/60;JFGameInfo.roomID===ConstantsVariable.RoomGameVip&&t.updateFlip(e),t.runAction(cc.sequence(cc.moveTo(n,e),cc.callFunc(function(){this.onChangeState(ConstantsVariable.FishState.DYING)}.bind(t))))},createFishGroup4:function(t){t=t.ListFish,r=[cc.p(-200,0),cc.p(JFUIBase.w+200,JFUIBase.h+200)],e=[cc.p(0,-100),cc.p(JFUIBase.w+300,JFUIBase.h)],i=[cc.p(JFUIBase.w+200,-250,0),cc.p(-300,JFUIBase.h+100)],n=[cc.p(JFUIBase.w+300,0),cc.p(0,JFUIBase.h+200)];for(var e,i,n,s=[[r[0],r[1]],[e[0],e[1]],[i[0],i[1]],[n[0],n[1]],[e[1],e[0]],[r[1],r[0]],[n[1],n[0]],[i[1],i[0]]],r=0;r<8;r++)for(e=0;e<8;e++)i={FishKind:t[this.fishRecordIndex].FishKind,FishID:t[this.fishRecordIndex].FishID,IsRedFish:t[this.fishRecordIndex].IsRedFish,isFishGroup:!0,isNeedUpdateDir:!0},n=new JFFish(this,i,{zIndex:ConstantsVariable.UIZorder.FISH,x:s[r][0].x,y:s[r][0].y},this.space),i.IsRedFish&&n.setColor(cc.color.RED),this.listFish.push(n),n.runAction(cc.sequence(cc.delayTime(4*e),cc.moveTo(20,s[r][1]),cc.callFunc(function(){this.onChangeState(ConstantsVariable.FishState.DYING)}.bind(n)))),this.fishRecordIndex++},createFishGroup2:function(t){var e,i,n=JFUIBase.w/100,s=t.ListFish;for(t=0;t<100;t++)e={FishKind:s[this.fishRecordIndex].FishKind,FishID:s[this.fishRecordIndex].FishID,IsRedFish:s[this.fishRecordIndex].IsRedFish,isFishGroup:!0},i=new JFFish(this,e,{zIndex:ConstantsVariable.UIZorder.FISH,x:t*n,y:-jf.math.randomBetween(0,100),rotation:-90},this.space),e.IsRedFish&&i.setColor(cc.color.RED),i.runAction(cc.sequence(cc.moveTo(2,cc.p(t*n,150)),cc.delayTime(40),cc.moveTo(4,cc.p(t*n,JFUIBase.h+150)),cc.callFunc(function(){this.onChangeState(ConstantsVariable.FishState.DYING)}.bind(i)))),this.listFish.push(i),this.fishRecordIndex++;for(t=0;t<100;t++)e={FishKind:s[this.fishRecordIndex].FishKind,FishID:s[this.fishRecordIndex].FishID,IsRedFish:s[this.fishRecordIndex].IsRedFish,isFishGroup:!0},i=new JFFish(this,e,{zIndex:ConstantsVariable.UIZorder.FISH,x:t*n,y:jf.math.randomBetween(JFUIBase.h,JFUIBase.h+100),rotation:90},this.space),e.IsRedFish&&i.setColor(cc.color.RED),i.runAction(cc.sequence(cc.moveTo(2,cc.p(t*n,JFUIBase.h-150)),cc.delayTime(40),cc.moveTo(4,cc.p(t*n,-150)),cc.callFunc(function(){this.onChangeState(ConstantsVariable.FishState.DYING)}.bind(i)))),this.listFish.push(i),this.fishRecordIndex++;for(t=0;t<7;t++)e={FishKind:s[this.fishRecordIndex].FishKind,FishID:s[this.fishRecordIndex].FishID,IsRedFish:s[this.fishRecordIndex].IsRedFish,isFishGroup:!0},i=new JFFish(this,e,{zIndex:ConstantsVariable.UIZorder.FISH,x:-310,y:JFUIBase.h-230},this.space),e.IsRedFish&&i.setColor(cc.color.RED),i.runAction(cc.sequence(cc.delayTime(5*t),cc.moveTo(17,cc.p(JFUIBase.w+250,JFUIBase.h-230)),cc.callFunc(function(){this.onChangeState(ConstantsVariable.FishState.DYING)}.bind(i)))),this.listFish.push(i),this.fishRecordIndex++;for(t=0;t<7;t++)e={FishKind:s[this.fishRecordIndex].FishKind,FishID:s[this.fishRecordIndex].FishID,IsRedFish:s[this.fishRecordIndex].IsRedFish,isFishGroup:!0},i=new JFFish(this,e,{zIndex:ConstantsVariable.UIZorder.FISH,x:JFUIBase.w+310,y:250,rotation:180},this.space),e.IsRedFish&&i.setColor(cc.color.RED),i.runAction(cc.sequence(cc.delayTime(5*t),cc.moveTo(17,cc.p(-250,250)),cc.callFunc(function(){this.onChangeState(ConstantsVariable.FishState.DYING)}.bind(i)))),this.listFish.push(i),this.fishRecordIndex++},createCircleFishGroup:function(t,e){for(var i,n,s=t.content.ListFish,r=t.count,o=t.startPos,a=t.radius,c=t.isMoveRight,h=t.moveTime||43,l=360/r,u=!0===c?JFUIBase.w:-JFUIBase.w,d=!0===c?0:180,u=t.moveScale?u*t.moveScale:u,c=0;c<r;c++)i={FishKind:s[this.fishRecordIndex].FishKind,FishID:s[this.fishRecordIndex].FishID,IsRedFish:s[this.fishRecordIndex].IsRedFish,isFishGroup:!0},n=new JFFish(this,i,{zIndex:ConstantsVariable.UIZorder.FISH,x:o.x+Math.cos(c*l*Math.PI/180)*a+(3===i.FishKind?15:0),y:o.y+Math.sin(c*l*Math.PI/180)*a,rotation:d},this.space),i.IsRedFish&&n.setColor(cc.color.RED),0==d&&n.setScaleY(-1),this.listFish.push(n),n.runAction(cc.sequence(cc.moveBy(h,cc.p(u,0)),cc.callFunc(function(){n.onChangeState(ConstantsVariable.FishState.DYING)}.bind(n)))),this.fishRecordIndex++},_updateBossHP:function(t){t.getUserData()},_onCatchRedFish:function(t){var e;JFGameInfo.CurrentLayer===ConstantsVariable.LAYERS.MENU_LAYER_GAME&&(t=t.getUserData(),e={DeskStation:BinaryConstants.DataTypeID.UInt8,FishID:BinaryConstants.DataTypeID.UInt32,GoldReward:BinaryConstants.DataTypeID.UInt64,TotalGold:BinaryConstants.DataTypeID.UInt64,Level:BinaryConstants.DataTypeID.UInt32,Exp:BinaryConstants.DataTypeID.UInt64,FishIDArray:BinaryConstants.DataTypeID.Array8,FishIDArray_Type:BinaryConstants.DataTypeID.UInt32},t=(new BinaryParser).init(e,t.content),null!=(e=this.getFishByID(t.FishID))&&!e.isDie()&&e.isInScreen()&&(this.catchFish(e.fishId,t.DeskStation,0),this.layerScreenGame.layerEffects.playEffectCatchRedFish(e,t,this)),cc.eventManager.dispatchCustomEvent(ConstantsVariable.NETWORK.GAME_USER_UPDATE_CATCHFISH.toString(),t))},_onCatchFish:function(t){var e;JFGameInfo.CurrentLayer===ConstantsVariable.LAYERS.MENU_LAYER_GAME&&(t=t.getUserData(),e={DeskStation:BinaryConstants.DataTypeID.UInt8,FishID:BinaryConstants.DataTypeID.UInt32,GoldReward:BinaryConstants.DataTypeID.UInt64,TotalGold:BinaryConstants.DataTypeID.UInt64,Level:BinaryConstants.DataTypeID.UInt32,Exp:BinaryConstants.DataTypeID.UInt64},t=(new BinaryParser).init(e,t.content),cc.eventManager.dispatchCustomEvent(ConstantsVariable.NETWORK.GAME_USER_UPDATE_CATCHFISH.toString(),t),this.catchFish(t.FishID,t.DeskStation,t.GoldReward))},catchFish:function(t,e,i){var n,s,r=this.getFishByID(t);r&&(n=r.getKind(),e===JFGameInfo.myInfo.DeskStation&&(s=n,r.isRedFish&&(s=30),JFGameInfo.myInfo.listFishCatch[s]||(JFGameInfo.myInfo.listFishCatch[s]=0),JFGameInfo.myInfo.listFishCatch[s]+=1,JFGameInfo.myInfo.totalFish++),(16<=n&&n<=31||r.isRedFish)&&this.runAction(cc.sequence(jf.shake(1,cc.p(0,0),10,20),cc.moveTo(0,cc.p(0,0)))),r.isRedFish||this.layerScreenGame.layerEffects.playGoldEffect({fishKind:n,DeskStation:e,gold:i},r.getPosition()),0<r.ItemID&&(console.log("catch fish ItemId: "+r.ItemID),i={FishPos:r.getRealPosition(),DeskStation:e,EffectID:r.ItemID},this.playEffectDropGif(i)),JFGameInfo.myInfo.DeskStation===e&&0<JFGameInfo.myInfo.itemGiftQuantity.length&&(JFGameInfo.myInfo.itemGiftQuantity[0].EffectID!==ConstantsVariable.GIFT_QUE_BOI||JFGameInfo.myInfo.itemGiftQuantity[0].EffectID===ConstantsVariable.GIFT_QUE_BOI&&36!==n)&&((i=JFGameInfo.myInfo.itemGiftQuantity.shift()).FishPos=r.getRealPosition(),this.playEffectDropGif(i)),r)&&!r.isDie()&&(this.removeFishByID(t),cc.audioEngine.playEffect(ResourceManager.JFResourcesGame.SoundFXCatch))},getItemGiftByID:function(t){for(var e=0;e<JFPreloaderConfig.EVENTS_IMG.length;e++)if(-1<JFPreloaderConfig.EVENTS_IMG[e].indexOf(t+".png"))return JFPreloaderConfig.EVENTS_IMG[e];return""},playEffectDropGif:function(t){if(3!==ConstantsVariable.CHANNEL_ID&&0<t.EffectID)try{var e,i,n=this.getItemGiftByID(t.EffectID);cc.textureCache.getTextureForKey(n)&&((e=new cc.Sprite).setSpriteFrame(n),e.scaleX=e.scaleY=.7,e.setLocalZOrder(ConstantsVariable.UIZorder.FISH),e.setVisible(!0),this.addChild(e),e.setPosition(t.FishPos),i=cc.pDistance(this.layerScreenGame.layerGuns.listPlayer[t.DeskStation].getPosition(),t.FishPos)/1e3,e.runAction(cc.sequence(cc.moveBy(.1,cc.p(0,70)),cc.delayTime(1),cc.spawn(cc.moveTo(i,this.layerScreenGame.layerGuns.listPlayer[t.DeskStation].getPosition()),cc.scaleTo(i,.3)),cc.removeSelf())))}catch(t){}},_onPlaySkillGlobal:function(t){t=t.getUserData();var e={EffectID:BinaryConstants.DataTypeID.UInt16};(new BinaryParser).init(e,t.content).EffectID===ConstantsVariable.FX.GLOBAL_SKILL.FREEZE&&this.pauseAllFishMove()},_onStopSkillGlobal:function(t){t=t.getUserData();var e={EffectID:BinaryConstants.DataTypeID.UInt16};(new BinaryParser).init(e,t.content).EffectID===ConstantsVariable.FX.GLOBAL_SKILL.FREEZE&&this.resumeAllFish()},removeFishByID:function(t){for(var e,i=0;i<this.listFish.length;i++)(e=this.listFish[i])&&e.getID()===t&&(e.playDying(),this.playParticleEffects(e),this.listFish.splice(i,1),e.isBoss)&&3===e.getKind()&&(this.bossFish=null)},removeAllFish:function(){for(var t,e=[],i=0;i<this.listFish.length;i++)(t=this.listFish[i])&&(t.isBoss?e.push(t):t.removeAll());this.listFish=e,this.resetBullet(!0)},resetBullet:function(t){var e,i;if(!0===t)for(e=0;e<this.listBullet.length;e++)this.listBullet[e].resetLockFish();else for(e=0;e<this.listBullet.length;e++)(i=this.listBullet[e]).lockFishID===t&&i.resetLockFish()},getFishByID:function(t){for(var e=null,i=0;i<this.listFish.length;i++)if((e=this.listFish[i])&&e.getID()===t)return e;return null},getFishIdByKind:function(t,e){for(var i,n=[],s=0;s<this.listFish.length;s++)(i=this.listFish[s])&&i.getKind()===t&&i.isInScreen()&&(i.isRedFish&&!e||n.push(i.getID()));return n},pauseAllFishMove:function(){for(var t,e=0;e<this.listFish.length;e++)!(t=this.listFish[e])||t.isDie()||32<=t.getKind()&&t.getKind()<=40||t.pause()},resumeAllFish:function(){for(var t,e=0;e<this.listFish.length;e++)!(t=this.listFish[e])||t.isDie()||32<=t.getKind()&&t.getKind()<=40||t.resume()},getListFish:function(){return this.listFish},getListBullet:function(){return this.listBullet},playParticleEffects:function(t){var e=null;switch(t.getKind()){case 16:case 17:case 19:e=new cc.ParticleSystem(ResourceManager.JFResourcesGame.FXshayuPlist);break;case 18:e=new cc.ParticleSystem(ResourceManager.JFResourcesGame.FXdingPlist),this.layerScreenGame.layerEffects.playStunEffect(t);break;case 20:case 21:case 22:e=new cc.ParticleSystem(ResourceManager.JFResourcesGame.FXjinlongPlist);break;case 23:case 24:case 25:e=new cc.ParticleSystem(ResourceManager.JFResourcesGame.FXBombPlist);break;case 26:case 27:case 28:case 29:case 31:e=new cc.ParticleSystem(ResourceManager.JFResourcesGame.FXDasanyuanPlist);break;case 30:e=new cc.ParticleSystem(ResourceManager.JFResourcesGame.FXYanhuaPlist);break;case 32:case 33:e=new cc.ParticleSystem(ResourceManager.JFResourcesGame.FXTienCaPlist);break;case 34:e=new cc.ParticleSystem(ResourceManager.JFResourcesGame.FXjinlongPlist);break;case 35:case 36:e=new cc.ParticleSystem(ResourceManager.JFResourcesGame.FXXuehuaPlist)}e&&(e.setEmissionRate(300),this.addChild(e),e.x=t.x,e.y=t.y,e.setAutoRemoveOnFinish(!0))},_checkSkill:function(t){if(JFGameInfo.CurrentLayer===ConstantsVariable.LAYERS.MENU_LAYER_GAME)switch(t=t.getUserData(),t.SkillID){case 1:this.runAction(cc.sequence(cc.delayTime(.3),cc.callFunc(this._createFxLazer.bind(this,t)),cc.delayTime(1),cc.callFunc(this._checkSkillLazer.bind(this,t))));break;case 2:this._checkSkillElectric(t);break;case 3:this._checkSkillBome(t);break;case 4:this._checkSkillPoseidon(t)}},_checkSkillPoseidon:function(t){this._initFXPoseidon(),t.isMe&&this.runAction(cc.sequence(cc.delayTime(1),cc.callFunc(this._sendSkillPoseidonToServer.bind(this,t))))},_initFXPoseidon:function(){var t=sp.SkeletonAnimation.create(ResourceManager.JFResourcesGame.FX_TridentSkill_json,ResourceManager.JFResourcesGame.FX_TridentSkill_atlas);this.addChild(t),t.setPosition(cc.p(JFGameInfo.appRealWidth/2,JFGameInfo.appRealHeight/2)),this._initFXSkill(t,"UltiSkill_FX",1.3,cc.p(0,0))},_initFXSkill:function(t,e,i,n){t.setTimeScale(i||1),t.setAnimation(0,e,!1),t.setCompleteListener(this._removeFXSkill.bind(this,t)),n?t.setAnchorPoint(n):t.setAnchorPoint(cc.p(0,.5))},_removeFXSkill:function(t){t.clearTracks(),t.scheduleOnce(function(t){t.removeFromParent(),delete t}.bind(this,t),.1)},_sendSkillPoseidonToServer:function(t){for(var e=[],i=0;i<this.listFish.length&&!(40<=e.length);i++){var n=this.listFish[i];n&&n.isInScreen()&&!n.isDie()&&e.push(n.getID())}t.isMe&&this.layerScreenGame.netSend.sendCatchFishSkill(e,t.BulletID,t.SkillID)},_createFxLazer:function(t){for(var e,i=[],n=new cc.Sprite,s=0;s<30;s++)e=cc.spriteFrameCache.getSpriteFrame("IMG_SKILL_1_"+s+".png"),i.push(e);(e=new cc.Animation(i,.05)).setRestoreOriginalFrame(!0),n.runAction(cc.sequence(cc.animate(e),cc.removeSelf())),n.setAnchorPoint(cc.p(.5,0)),n.setRotation(t.Angle),n.setPosition(cc.p(t.bulletPosition.x,t.bulletPosition.y)),n.setScale(2),this.addChild(n,ConstantsVariable.UIZorder.BULLET)},_checkSkillLazer:function(t){for(var e=[],i=0;i<this.listFish.length;i++){var n=this.listFish[i];if(n&&!n.isDie()&&n.isInScreen()&&this._skillCheckPerfectColider(n.physicsBody,t.bulletPosition,t.targetPosition,t.Angle,1)&&(e.push(n.getID()),20<=e.length))break}0<e.length&&t.isMe&&this.layerScreenGame.netSend.sendCatchFishSkill(e,t.BulletID,t.SkillID)},_skillCheckPerfectColider:function(t,e,i,n,s){var r,o,a,c;return!(!t||(r=t.getPos().x-50,o=t.getPos().x+50,a=t.getPos().y-50,t=t.getPos().y+50,c=n*Math.PI/180,n=1280*Math.sin(c),c=1280*Math.cos(c),i=s?new cc.p(e.x+n,e.y+c):i,!cc.pSegmentIntersect(e,i,new cc.p(r,t),new cc.p(o,a))&&!cc.pSegmentIntersect(e,i,new cc.p(r,a),new cc.p(o,t))))},_checkSkillElectric:function(t){for(var e,i=[],n=[],s=[],r=[],o=0;o<this.listFish.length;o++){var a=this.listFish[o];a&&!a.isDie()&&a.isInScreen()&&this._checkSkillBomeCollision(a.physicsBody,t.targetPosition,150)&&(n.push(a),s.push(cc.pDistance(t.targetPosition,a.physicsBody.getPos())))}if(0<s.length){for(a=Utilities.arrayMin(s),o=0;o<s.length;o++)s[o]===a&&i.push((e=n[o]).getID());for(o=0;o<this.listFish.length;o++)if((a=this.listFish[o])&&!a.isDie()&&a.isInScreen()&&e.fishKind===a.fishKind){if(20<i.length)break;r.push(a),i.push(a.getID())}this._initFXElectric(t,e.physicsBody.getPos(),r)}else this._initFXElectric(t,t.targetPosition,r);0<i.length&&t.isMe&&this.layerScreenGame.netSend.sendCatchFishSkill(i,t.BulletID,t.SkillID)},_initFXElectric:function(t,e,i){for(var n,s=[],r=new cc.Sprite,o=0;o<10;o++)n=cc.spriteFrameCache.getSpriteFrame("IMG_SKILL_2_"+o+".png"),s.push(n);if((n=new cc.Animation(s,.05)).setRestoreOriginalFrame(!0),r.runAction(cc.sequence(cc.animate(n),cc.removeSelf())),r.setAnchorPoint(cc.p(.5,0)),r.setRotation(t.Angle),r.setPosition(cc.p(t.bulletPosition.x,t.bulletPosition.y)),this.addChild(r,ConstantsVariable.UIZorder.BULLET),e&&(a=cc.pDistance(e,t.bulletPosition),r.setScaleY(a/267),r.setScaleX(2)),0<i.length)for(t=i.length,o=0;o<t;o++){(r=new cc.Sprite).runAction(cc.sequence(cc.animate(n),cc.removeSelf()));var a=(s=i[o]).physicsBody.getPos(),c=jf.math.getRotation(a,e),a=cc.pDistance(e,a);r.setAnchorPoint(cc.p(.5,0)),r.setRotation(c),r.setPosition(e),r.setScaleY(a/267),this.addChild(r),s.createHitFX()}},_checkSkillBomeCollision:function(t,e,i){var n,s,r,o;return!!t&&(n=t.getPos().x-50,t.getPos(),t.getPos(),s=t.getPos().y+50,r=new cc.p(n,s),o=new cc.p(n,s),t=new cc.p(n,s),n=new cc.p(n,s),r=cc.pDistance(r,e),o=cc.pDistance(o,e),t=cc.pDistance(t,e),e=cc.pDistance(n,e),r<=i||o<=i||t<=i||e<=i)},_checkSkillBome:function(t){this._initFXBomeExplore(t.targetPosition),t.isMe&&this.runAction(cc.sequence(cc.delayTime(1),cc.callFunc(this._sendSkillBomeToServer.bind(this,t))))},_initFXBomeExplore:function(t){for(var e,i=[],n=new cc.Sprite,s=0;s<31;s++)e=cc.spriteFrameCache.getSpriteFrame("IMG_SKILL_3_"+s+".png"),i.push(e);(e=new cc.Animation(i,.05)).setRestoreOriginalFrame(!0),n.runAction(cc.sequence(cc.animate(e),cc.removeSelf())),n.setAnchorPoint(cc.p(.5,.5)),n.setPosition(cc.p(t.x,t.y)),n.setScale(2),this.addChild(n,ConstantsVariable.UIZorder.BULLET)},_sendSkillBomeToServer:function(t){for(var e=[],i=[],n=[],s=0;s<this.listFish.length;s++){var r=this.listFish[s];r&&!r.isDie()&&r.isInScreen()&&this._checkSkillBomeCollision(r.physicsBody,t.targetPosition,150)&&(e.push(r),i.push(cc.pDistance(t.targetPosition,r.physicsBody.getPos())))}if(0<i.length)for(r=Utilities.arrayMin(i),s=0;s<i.length;s++)if(i[s]===r){var o=e[s];if(n.push(o.getID()),i.splice(s,1),e.splice(s,1),s=0,r=Utilities.arrayMin(i),o.onHited(3),20<=n.length)break}0<n.length&&t.isMe&&this.layerScreenGame.netSend.sendCatchFishSkill(n,t.BulletID,t.SkillID)},dispose:function(){this.unscheduleUpdate();for(var t=0;t<this._listEvents.length;t++)cc.eventManager.removeListener(this._listEvents[t]);for(t=0;t<this.listBullet.length;t++){var e=this.listBullet[t];e&&(this.listBullet.splice(t,1),this.removeChild(e),e.removeAll())}for(t=0;t<this.listFish.length;t++)this.listFish[t].isPausing=!1;this.listBullet=[],this.space=null,this.removeAllChildren(!0)}}),JFGunItem=cc.Node.extend({_gun:null,_gunStroke:null,_gunPosDefault:null,_fireEffect:null,goldGun:null,_bulletType:0,_fxSkill:null,isActive:null,_nameTexture:null,_textGoldGun:null,gunPosition:null,isMe:!1,isFirstChange:!0,DeskStation:0,gunSkill:0,ctor:function(){cc.Node.prototype.ctor.call(this)},initObj:function(){this.isActive=!1,this._gun=this.getChildByName("JFPlayerGunItem"),this._gunPosDefault=this._gun.getPosition(),this._fireEffect=this._gun.getChildByName("JFGunFireEffect"),this._gunValue=JFGameInfo.JFMain.layerComponents.compoOptionInGame.getGunValue(),this.goldGun=this._gunValue[this._bulletType].value,null==this.gunPosition?this.gunPosition=this.getPosition():this.setPosition(this.gunPosition),this.isFirstChange=!0},changeGunAnimation:function(t){this.stopAllActions(),this.setPosition(this.gunPosition),!this.isMe||this.isFirstChange?(this.isFirstChange=!1,t()):(this.setActive(!0),this.runAction(cc.sequence(cc.moveTo(.2,cc.pAdd(cc.p(0,this.DeskStation<=1?-150:150),this.gunPosition)),cc.callFunc(this._checkGunSkill.bind(this)),cc.moveTo(.2,this.gunPosition),cc.delayTime(.05),cc.callFunc(this.setActive.bind(this,!1)))))},_checkGunSkill:function(){0<this.gunSkill?this.changeGunItemSkillOnLySkin(this.gunSkill):this.changeGunSkin()},changeGunItemSkill:function(t){if(0<t)this.changeGunAnimation(this.changeGunItemSkillOnLySkin.bind(this,t));else{if(this.gunSkill===t)return;this._fxSkill?setTimeout(function(){this.changeGunAnimation(this.changeGunSkin.bind(this))}.bind(this),200):this.changeGunAnimation(this.changeGunSkin.bind(this))}this.gunSkill=t},changeGunItemSkillOnLySkin:function(t){switch(this.setPosition(this.gunPosition),t){case 1:this._gun.setSpriteFrame("IMG_GUN_LAZER.png"),this._nameTexture="IMG_GUN_LAZER.png";break;case 2:this._gun.setSpriteFrame("IMG_GUN_ELECTRIC.png"),this._nameTexture="IMG_GUN_ELECTRIC.png";break;case 3:this._gun.setSpriteFrame("IMG_GUN_BOME.png"),this._nameTexture="IMG_GUN_BOME.png"}},setGunValue:function(t,e){var i=this._bulletType;this.goldGun=e,this._bulletType=t,this._gunValue=JFGameInfo.JFMain.layerComponents.compoOptionInGame.getGunValue(),i!=t?this.changeGunAnimation(this.changeGunSkin.bind(this)):(this.isFirstChange=!1,this.changeGunSkin())},changeGunSkin:function(){this.setPosition(this.gunPosition),this._nameTexture||(this._nameTexture="");for(var t=0;t<this._gunValue.length;t++)this._gunValue[t].value===this.goldGun&&(this._bulletType=t);3<this._bulletType?this._nameTexture!=="IMG_GUN_"+(this._bulletType-3)+".png"&&(this._gun.setSpriteFrame("IMG_GUN_"+(this._bulletType-3)+".png"),this._nameTexture="IMG_GUN_"+(this._bulletType-3)+".png"):"IMG_GUN_0.png"!==this._nameTexture&&(this._gun.setSpriteFrame("IMG_GUN_0.png"),this._nameTexture="IMG_GUN_0.png")},fireBy:function(t,e){if(this._gun.stopAllActions(),this._gun.setPosition(this._gunPosDefault),0===t)cc.audioEngine.playEffect(ResourceManager.JFResourcesGame.SoundFXFire),this._gun.runAction(cc.sequence(cc.callFunc(this.setActive.bind(this,!0)),cc.moveBy(.05,cc.p(0,-10)),cc.moveBy(.05,cc.p(0,-10)).reverse(),cc.callFunc(this.setActive.bind(this,!1)))),this.runFireEffect(t,null);else switch(this._fxSkill=!0,this.runFireEffect(t,e),t){case 1:case 3:this._gun.runAction(cc.sequence(cc.delayTime(.3),cc.callFunc(this.setActive.bind(this,!0)),cc.moveBy(.2,cc.p(0,-20)),cc.moveBy(1,cc.p(0,-20)).reverse(),cc.callFunc(this.setActive.bind(this,!1))));break;case 2:this._gun.runAction(cc.sequence(cc.delayTime(.3),cc.callFunc(this.setActive.bind(this,!0)),cc.moveBy(.2,cc.p(0,0)),cc.moveBy(1,cc.p(0,0)).reverse(),cc.callFunc(this.setActive.bind(this,!1))))}},setActive:function(t){this.isActive=t},runFireEffect:function(t,e){this._gun.setPosition(this._gunPosDefault),this._fireEffect.stopAllActions(),this._fireEffect.setOpacity(0),this._fireEffect.runAction(cc.sequence(cc.fadeTo(.05,200),cc.fadeTo(.05,0)));var i,n=[],s=20,r=new cc.Sprite;switch(t){case 1:for(var o=0;o<30;o++)i=cc.spriteFrameCache.getSpriteFrame("IMG_SKILL_PRE_1_"+o+".png"),n.push(i);s=45,this.runAction(cc.sequence(cc.callFunc(function(){cc.audioEngine.playEffect(ResourceManager.JFResourcesGame.SoundFXPreLazer)}.bind(this)),cc.callFunc(function(){cc.audioEngine.playEffect(ResourceManager.JFResourcesGame.SoundFXLazer)}.bind(this))));break;case 2:for(o=0;o<14;o++)i=cc.spriteFrameCache.getSpriteFrame("IMG_SKILL_PRE_2_"+o+".png"),n.push(i);cc.audioEngine.playEffect(ResourceManager.JFResourcesGame.SoundFXLightning);break;case 3:for(o=0;o<25;o++)i=cc.spriteFrameCache.getSpriteFrame("IMG_SKILL_PRE_3_"+o+".png"),n.push(i);s=45,this.runAction(cc.sequence(cc.callFunc(function(){cc.audioEngine.playEffect(ResourceManager.JFResourcesGame.SoundFXPreBome)}.bind(this)),cc.callFunc(function(){cc.audioEngine.playEffect(ResourceManager.JFResourcesGame.SoundFXBome)}.bind(this))));break;case 4:this.runAction(cc.sequence(cc.callFunc(function(){cc.audioEngine.playEffect(ResourceManager.JFResourcesGame.SoundFXPoseidon1)}.bind(this)),cc.delayTime(1),cc.callFunc(function(){cc.audioEngine.playEffect(ResourceManager.JFResourcesGame.SoundFXPoseidon2)}.bind(this))))}(i=new cc.Animation(n,.05)).setRestoreOriginalFrame(!0),r.runAction(cc.sequence(cc.animate(i),cc.removeSelf(),cc.callFunc(this._endAnimationBullet.bind(this)))),r.setPosition(cc.p(this._fireEffect.getPosition().x,this._fireEffect.getPosition().y+s)),this._gun.addChild(r)},_endAnimationBullet:function(){this._fxSkill=!1},_playSoundFX:function(t){cc.audioEngine.playEffect(t)},_initFXSkill:function(t,e){t.setVisible(!0),t.setTimeScale(1.75),t.setAnimation(0,e,!1),t.setCompleteListener(this._removeFXSkill.bind(this,t)),t.setAnchorPoint(cc.p(0,.5))},_removeFXSkill:function(t){t.scheduleUpdate(),t.schedule(function(t){t.unscheduleUpdate(),t.removeFromParent()}.bind(this,t),.1)},cloneFromNode:function(t){for(this.setName(t.getName()),this.setPosition(t.getPosition()),this.setVisible(t.isVisible());0<t.getChildrenCount();){var e=t.getChildren()[0];e.removeFromParent(),this.addChild(e)}t.removeFromParent(),this.setLocalZOrder(t.getLocalZOrder())},getPositionEffectFire:function(){return this.setPosition(this.gunPosition),this._gun.convertToWorldSpace(this._fireEffect.getPosition())},resetUI:function(){this._bulletType=0,this.goldGun=this._gunValue[0].value,this.changeGunSkin()}}),JFPlayer=cc.Node.extend({isMe:null,UserID:0,DeskStation:0,Gold:0,Level:0,Exp:0,Nickname:"",AvatarID:null,PubUserId:null,avatarPath:"",avatarImage:null,_txtLevel:null,_txtUserName:null,_txtGold:null,_gunItem:null,_gunGold:null,lockFishID:null,lockFish:null,bulletID:0,netSend:null,_mousePos:null,isAutoFire:null,arrowHere:null,lockFishPapaw:null,_fxGoldWinPos:null,_lockCosair:null,_scheduleAutoFire:null,_gunValue:null,_isLockGun:!1,_isLockAnimation:!1,_isOpenListItemAction:!1,_listItemAction:null,_btnItemActionChat:null,_btnItemActionAddFriend:null,_btnItemActionUserInfo:null,_btnPlayerItemInfo:null,_btnChat:null,_popUpChat:null,_imgEmoticon:null,listener:null,getValuecoin:null,currentGunIndex:0,btnCongTienBan:null,btnTruTienBan:null,_txtGold_0:null,_IMGMoney_0:null,_IMGMoney:null,isChangeStatusLock:null,speedCreateBullet:!1,_isSpeedOnAuto:!1,bgDisplayNameLeft:null,bgDisplayNameRight:null,_DisplayNameUserLeft:null,_DisplayNameUserRight:null,_btnChat_Left:null,_btnChat_Right:null,_positionPlayer:null,ctor:function(){cc.Node.prototype.ctor.call(this)},initObj:function(){this.setVisible(!1),this.currentGunIndex=this.bulletID=this.lockFishID=0,this._isSpeedOnAuto=this.isAutoFire=!1,this._scheduleAutoFire=this.fireAuto.bind(this),this._gunValue=JFGameInfo.JFMain.layerComponents.compoOptionInGame.getGunValue(),this._listItemAction=this.getChildByName("JFItemAction"),this._listItemAction.retain(),this._btnItemActionAddFriend=this.getChildByName("JFItemAction").getChildByName("JFBtnAddFriend"),this._btnItemActionUserInfo=this.getChildByName("JFItemAction").getChildByName("JFBtnUserInfo"),this._btnItemActionChat=this.getChildByName("JFItemAction").getChildByName("JFBtnChat"),this._btnPlayerItemAction=this.getChildByName("ImgSeat"),this.btnCongTienBan=this.getChildByName("JFPlayerInfo").getChildByName("BTN_cong_tien_ban"),this.btnTruTienBan=this.getChildByName("JFPlayerInfo").getChildByName("BTN_tru_tien_ban"),this.bgDisplayNameRight=this.getChildByName("BG_DisplayName_Right"),this.bgDisplayNameLeft=this.getChildByName("BG_DisplayName_Left"),this._DisplayNameUserRight=this.getChildByName("DisplayName_Right"),this._DisplayNameUserLeft=this.getChildByName("DisplayName_Left"),this._btnChat_Left=this.getChildByName("JFBtnChat_PlayerLeft"),this._btnChat_Right=this.getChildByName("JFBtnChat_PlayerRight"),this._btnChat_Left.setVisible(!1),this._btnChat_Right.setVisible(!1),this._imgEmoticon=this.getChildByName("JFChatEmoticon"),this.addClickEvent(),JFPreloaderConfig.BTN_BAN_BE_SHOW||this.setImgBackground(this._btnItemActionAddFriend,!1),this.speedCreateBullet=!1},cloneFromNode:function(t){for(this.setName(t.getName()),this.setPosition(t.getPosition()),this.setVisible(t.isVisible()),this.setLocalZOrder(t.getLocalZOrder());0<t.getChildrenCount();){var e=t.getChildren()[0];e.removeFromParent(),this.addChild(e)}t.removeFromParent(),this._txtGold=this.getChildByName("JFPlayerTextGold"),this._IMGMoney=this.getChildByName("IMGMoneyBox"),this._txtGold_0=this.getChildByName("JFPlayerTextGold_0"),this._IMGMoney_0=this.getChildByName("IMGMoneyBox_0"),this._gunGold=this.getChildByName("JFPlayerGunTextGold"),this._txtGold_0&&this._txtGold_0.ignoreContentAdaptWithSize(!0),this._txtGold.ignoreContentAdaptWithSize(!0),this._gunGold.ignoreContentAdaptWithSize(!0),this.arrowHere=this.getChildByName("ArrowHere"),this.arrowHere.setVisible(!1),this._gunItem=new JFGunItem,this._gunItem.cloneFromNode(this.getChildByName("JFPlayerGunInfo")),this._gunItem.initObj(),this.addChild(this._gunItem),this.getChildByName("ImgSeat").setLocalZOrder(ConstantsVariable.UIZorder.COMPONENTS),this._gunGold.setLocalZOrder(ConstantsVariable.UIZorder.COMPONENTS),this._fxGoldWinPos=this.getChildByName("FXGoldWinPos")},addClickEvent:function(){this._btnItemActionUserInfo.addClickEventListener(this.onClickBtnFromCocostudio.bind(this)),this._btnItemActionAddFriend.addClickEventListener(this.onClickBtnFromCocostudio.bind(this)),this._btnItemActionChat.addClickEventListener(this.onClickBtnFromCocostudio.bind(this)),this._btnChat_Right.addClickEventListener(this.onClickBtnFromCocostudio.bind(this)),this._btnChat_Left.addClickEventListener(this.onClickBtnFromCocostudio.bind(this))},onClickBtnFromCocostudio:function(t,e){switch(this.arrowHere.isVisible()&&this.hideArrowHere(),t.getName()){case"JFBtnChat_PlayerRight":case"JFBtnChat_PlayerLeft":this._showPopupChat();break;case"BTN_cong_tien_ban":this.currentGunIndex++,7<=this.currentGunIndex&&(this.currentGunIndex=0),this._setGunValue(this.currentGunIndex);break;case"BTN_tru_tien_ban":0==this.currentGunIndex&&(this.currentGunIndex=7),this.currentGunIndex--,this._setGunValue(this.currentGunIndex)}},_showPopupChat:function(){this._popUpChat||(this._popUpChat=new JFChatEmo,this._popUpChat.initObj(this.DeskStation),this._popUpChat.setPosition(this.convertToNodeSpace(cc.p(JFGameInfo.appRealWidth/2,JFGameInfo.appRealHeight/2))),this.addChild(this._popUpChat)),this._popUpChat.showPopupChat()},_checkInLayerRoomGame:function(t){0==(this._positionPlayer=t)||3==t?(this._txtGold_0&&this._txtGold_0.setVisible(!1),this._IMGMoney_0&&this._IMGMoney_0.setVisible(!1),this.bgDisplayNameRight&&this.bgDisplayNameRight.setVisible(!1),this._DisplayNameUserRight&&this._DisplayNameUserRight.setVisible(!1)):(this._txtGold&&this._txtGold.setVisible(!1),this._IMGMoney&&this._IMGMoney.setVisible(!1),this.bgDisplayNameLeft&&this.bgDisplayNameLeft.setVisible(!1),this._DisplayNameUserLeft&&this._DisplayNameUserLeft.setVisible(!1))},_setGunValue:function(t){return JFGameInfo.JFMain.layerScreenGame.layerGuns.setGunValue(t)},showEmoticon:function(t){this._imgEmoticon.setSpriteFrame("icon_"+ConstantsVariable.ChatID[t].link+".png"),this._imgEmoticon.setVisible(!0),this._imgEmoticon.setLocalZOrder(ConstantsVariable.UIZorder.WATER),this.scheduleOnce(this.hideEmoticon.bind(this),2)},hideEmoticon:function(){this._imgEmoticon.setVisible(!1)},showListItemAction:function(){JFLayerGuns.listItemActionIsOpenning&&JFLayerGuns.listItemActionIsOpenning.hideListItemAction(),(JFLayerGuns.listItemActionIsOpenning=this)._listItemAction&&this._btnItemActionAddFriend&&this._btnItemActionAddFriend.isEnabled()&&this.isMe&&this.setImgBackground(this._btnItemActionAddFriend,!1),this._listItemAction&&this._btnItemActionChat&&this._btnItemActionChat.isEnabled()&&!this.isMe&&this.setImgBackground(this._btnItemActionChat,!1),this._listItemAction.setVisible(!0),this._listItemAction.setScale(.1),this._listItemAction.runAction(new cc.ScaleTo(.2,1)),this._listItemAction.zIndex=100,this._isOpenListItemAction=!0},hideListItemAction:function(){this._listItemAction&&JFLayerGuns.listItemActionIsOpenning&&(JFLayerGuns.listItemActionIsOpenning=null,this._listItemAction.runAction(cc.sequence(new cc.ScaleTo(.2,.1),cc.callFunc(function(){this._listItemAction.setVisible(!1),this._isOpenListItemAction=!1}.bind(this)))))},onTouchBeganExt:function(t,e){t=(e=e.getCurrentTarget()).convertToNodeSpace(t.getLocation()),e=e.getContentSize(),e=cc.rect(0,0,e.width,e.height);return!!cc.rectContainsPoint(e,t)&&(this._isOpenListItemAction?this._isOpenListItemAction&&this.hideListItemAction():this.showListItemAction(),!0)},setGunValue:function(t){t=t<=this._gunValue.length-1?t:this._gunValue.length-1,this._gunItem.setGunValue(t=0<=t?t:0,this._gunValue[t].value),this._gunGold.setString(Utilities.Coin(this._gunValue[t].value))},changeGunSkill:function(t){Utilities.showLog("//////////////CHANGE GUN SKILL:Auto Fire:"+this.isAutoFire),this.isMe&&(this.isAutoFire?(this._gunItem.isActive=!1,0===t?(this.speedCreateBullet?this.schedule(this._scheduleAutoFire,ConstantsVariable.CONFIG_BULLET.VALUE_BULLET_ACIVE):this.schedule(this._scheduleAutoFire,ConstantsVariable.CONFIG_BULLET.VALUE_BULLET_DEFAUT),this._mousePos?this.setAutoFire(this._mousePos):this.setAutoFire(cc.p(500,500))):this.schedule(this._scheduleAutoFire,2)):(console.log("Auto fire cancel!"),this._gunItem.isActive=!1)),this._gunItem.changeGunItemSkill(t)},setImgBackground:function(t,e){t.getChildByName("ImgBackgroundNormal").setVisible(e),t.getChildByName("ImgBackgroundDisable").setVisible(!e),t.setEnabled(e)},updateUI:function(t){t&&(this._txtGold&&this._txtGold_0||(this._txtGold=this.getChildByName("JFPlayerTextGold")),this._txtGold_0=this.getChildByName("JFPlayerTextGold_0"),this._txtGold.stopAllActions(),this._txtGold_0.stopAllActions(),this._txtGold.runAction(cc.sequence(cc.scaleTo(.2,1.2),cc.scaleTo(.2,1))),this._txtGold_0.runAction(cc.sequence(cc.scaleTo(.2,1.2),cc.scaleTo(.2,1)))),this._txtGold&&this._txtGold_0||(this._txtGold=this.getChildByName("JFPlayerTextGold"),this._txtGold_0=this.getChildByName("JFPlayerTextGold_0")),this._txtGold.setString(Utilities.Coin(this.Gold)),this._txtGold_0.setString(Utilities.Coin(this.Gold)),t=this.Nickname.length<=12?this.Nickname:this.Nickname.substr(0,9)+"...",this._DisplayNameUserRight.setString(t),this._DisplayNameUserLeft.setString(t),this.isMe&&(JFGameInfo.myInfo.Gold=this.Gold,JFGameInfo.myInfo.Level=this.Level,0==this._positionPlayer||3==this._positionPlayer?(this._btnChat_Right.setVisible(this.isMe),this._btnChat_Left.setVisible(!this.isMe)):(this._btnChat_Right.setVisible(!this.isMe),this._btnChat_Left.setVisible(this.isMe)))},sendFriendInvitationWeb:function(){var t={ApiName:"MakeFriend"};t.UserFriendId=this.UserID,this.getAPI("api/fish",t,this.onAddFriendSucces.bind(this))},sendFriendInvitationApp:function(){JFGameInfo.JFMain.showLoading();var t={};t.FriendId=this.UserID,t.UserID=JFGameInfo.myInfo.UserID,t.PlatformID=JFGameInfo.myPlatform,t.AppVersion=JFGameInfo.AppVersion,t.HardwareID=JFGameInfo.devineID,t.packetName=JFGameInfo.packetName,t.VersionDevice=JFGameInfo.VersionDevice,t.DeviceModel=JFGameInfo.DeviceModel,t.ChannelId=JFGameInfo.ChannelID,t.Sign=md5.encscript("MakeFriendV2"+t.FriendId+t.UserID+t.PlatformID+t.AppVersion+t.HardwareID+t.ChannelId+t.VersionDevice+t.DeviceModel+t.packetName+JFGameInfo.myInfo.token4Ws),Utilities.getAPI("MakeFriendV2",t,this.onAddFriendSucces.bind(this))},onAddFriendSucces:function(t){JFGameInfo.JFMain.hideLoading(),cc.sys.isNative&&(t=JSON.parse(t)),JFGameInfo.JFMain.layerPopup.showPopupMsg(t.Message),this.hideListItemAction()},getAvatarByUserID:function(t){this.callBackGetAvatar(JSON.stringify({Path:2}));try{var e={};e.uId=t,e.gId=412,e["flashvar-old"]=JFGameInfo.token4Master,this.getAPI("hinh-anh/avatar",e,this.callBackGetAvatar.bind(this))}catch(t){}},callBackGetAvatar:function(t){},getAPI:function(t,e,i){$.ajax({type:"POST",url:PreLoaderConfig.uploadLink+t,data:e,success:i,error:function(t){console.log("getAPI error")}})},getDataOnline:function(t){},_onCallBackGetLinkAvatar_V2:function(t){JFGameInfo.JFMain.hideLoading(),1===(t=JSON.parse(t)).Result?this.AvatarID="Avatar_"+t.Data.ImagePath+".png":(JFGameInfo.JFMain.layerPopup.showPopupMsg(t.Message),this.AvatarID="Avatar_1.png")},updateController:function(){if(this._gunValue=JFGameInfo.JFMain.layerComponents.compoOptionInGame.getGunValue(),this._gunItem.isMe=this.isMe,this._gunItem.DeskStation=this.DeskStation,this.setGunValue(0),this.btnCongTienBan.setVisible(this.isMe),this.btnTruTienBan.setVisible(this.isMe),this.isMe){for(var t=this.getChildByName("JFPlayerInfo"),e=0;e<t.getChildrenCount();e++)t.getChildren()[e]instanceof ccui.Button&&t.getChildren()[e].addClickEventListener(this.onClickBtnFromCocostudio.bind(this));for(this.listEventCustom=[],this.listEventCustom.push(cc.eventManager.addCustomListener(ConstantsVariable.CONFIG_BULLET.SPEED_DEFAULT,this._speedDefault.bind(this))),this.listEventCustom.push(cc.eventManager.addCustomListener(ConstantsVariable.CONFIG_BULLET.SPEED_X2,this._speedX2.bind(this))),this.arrowHere.setLocalZOrder(ConstantsVariable.UIZorder.WATER),this.arrowHere.runAction(cc.sequence(cc.moveBy(.5,cc.p(0,-10)),cc.moveBy(.5,cc.p(0,-10)).reverse()).repeatForever()),this.arrowHere.setVisible(!0),this._lockCosair=new cc.Sprite,this._lockCosair.setSpriteFrame("lock_fish_"+this.DeskStation+".png"),this.getParent().addChild(this._lockCosair),this._lockCosair.setVisible(!1),this.lockFishPapaw=new cc.Node,this.lockFishPapaw.childArray=[],this.addChild(this.lockFishPapaw,-1),e=0;e<25;e++)(t=new cc.Sprite).setSpriteFrame("lock_fish.png"),this.lockFishPapaw.addChild(t),this.lockFishPapaw.childArray.push(t),t.setPosition(cc.p(0,50*e));this.lockFishPapaw.setVisible(!1)}else{for(t=this.getChildByName("JFPlayerInfo"),e=0;e<t.getChildrenCount();e++)t.getChildren()[e]instanceof ccui.Button&&t.getChildren()[e].setTouchEnabled(!1);this.arrowHere.stopAllActions(),this.arrowHere.setVisible(!1)}},resetUI:function(){this.isMe=!1,this.Exp=this.Level=this.Gold=this.DeskStation=this.UserID=0,this.Nickname="",this.PubUserId=0,this.avatarPath="",this.avatarImage=null,this.bulletID=this.lockFishID=0,this._mousePos=this.netSend=null,this._txtGold=this.getChildByName("JFPlayerTextGold"),this._txtGold_0=this.getChildByName("JFPlayerTextGold_0"),this._txtGold.setString("0"),this._txtGold_0.setString("0"),this.updateUI(),this._gunItem.resetUI(),this._gunGold.setString(this._gunItem.goldGun),this.arrowHere.stopAllActions(),this.arrowHere.setVisible(!1),this._gunItem.isActive=!1;for(var t=this.getChildByName("JFPlayerInfo"),e=0;e<t.getChildrenCount();e++)t.getChildren()[e]instanceof ccui.Button&&t.getChildren()[e].setTouchEnabled(!0)},_speedX2:function(){Utilities.showLog("/////////ACTIVE FIRE SPEED::Auto:"+this._isSpeedOnAuto),this.speedCreateBullet=!0,this._isSpeedOnAuto&&(this.cancelAutoFile(),this._mousePos?this.setAutoFire(this._mousePos):this.setAutoFire(cc.p(500,500)))},_speedDefault:function(){Utilities.showLog("/////////DEACTIVE FIRE SPEED::Auto:"+this._isSpeedOnAuto),this.speedCreateBullet=!1,this._isSpeedOnAuto&&(this.cancelAutoFile(),this._mousePos?this.setAutoFire(this._mousePos):this.setAutoFire(cc.p(500,500)))},setAutoFire:function(t){Utilities.showLog("===========SET AUTO FIRE:"+this.speedCreateBullet+"/"+this.isAutoFire+"/"+JFGameInfo.currentSkill),this.speedCreateBullet?this.isAutoFire||(this._mousePos=t,this.isAutoFire=!0,this.fireAuto(),0===JFGameInfo.currentSkill?this.schedule(this._scheduleAutoFire,ConstantsVariable.CONFIG_BULLET.VALUE_BULLET_ACIVE):this.schedule(this._scheduleAutoFire,.1)):this.isAutoFire||(this._mousePos=t,this.isAutoFire=!0,this.fireAuto(),0===JFGameInfo.currentSkill?this.schedule(this._scheduleAutoFire,ConstantsVariable.CONFIG_BULLET.VALUE_BULLET_DEFAUT):this.schedule(this._scheduleAutoFire,.1)),this._isSpeedOnAuto=!0},fireAuto:function(){var t;this.hideArrowHere(),JFGameInfo.JFMain.layerComponents.updateTimeCount(),JFGameInfo.myInfo.Gold>=this._gunValue[0].value&&JFGameInfo.myInfo.Gold<this._gunItem.goldGun?(this._gunItem.resetUI(),this.cancelAutoFile(),this._gunGold.setString(this._gunValue[0].value),JFGameInfo.JFMain.layerComponents.compoOptionInGame.setRoomInfo()):(JFGameInfo.myInfo.Gold<this._gunValue[0].value&&this.isMe&&(JFGameInfo.myInfo.isPaymentFirst?JFGameInfo.JFMain.layerPopup.showPopupMsg(PreLoaderConfig.Messages.NEGIN,this.getParent().callBackNEG.bind(this.getParent())):JFGameInfo.JFMain.layerPopup.showPopupFirstTopup(this.getParent().callBackNEG.bind(this.getParent())),this.cancelAutoFile()),this.isMe&&(this.isAutoFire?this._gunItem.isActive||(this._gunItem.isActive=!0,0===JFGameInfo.currentSkill?0<JFGameInfo.bulletPool&&null!=(t=this.fireById(this._mousePos,JFGameInfo.currentSkill))?(this.netSend.sendGunFire(t),t.bulletPosition=this.getPositionGunBarrel(),t.isMe=!0,JFGameInfo.bulletPool--,cc.eventManager.dispatchCustomEvent(ConstantsVariable.NETWORK.GAME_CREATE_BULLET.toString(),t)):this._gunItem.isActive=!1:((t={}).Angle=jf.math.getRotation(this._mousePos,this.getPosition()),this.netSend.sendFireSkill(t.Angle,this._mousePos),setTimeout(function(){this._gunItem.isActive=!1}.bind(this),500))):this.cancelAutoFile()))},cancelAutoFile:function(){Utilities.showLog("//////////CANCEL AUTO FIRE"),this.hideArrowHere(),this._isSpeedOnAuto=this.isAutoFire=!1,this.unschedule(this._scheduleAutoFire)},updateTargetPosition:function(t){this._mousePos=t},callBackOnConfirmNapGold:function(){JFGameInfo.JFMain.layerScreenGame.netSend.sendExitGameServer()},hideArrowHere:function(){this.arrowHere.isVisible()&&(this.arrowHere.stopAllActions(),this.arrowHere.setVisible(!1))},_initFXSkill:function(t,e,i){i=i||1,t.setVisible(!0),t.setTimeScale(i),t.setAnimation(0,e,!1),t.setCompleteListener(this._removeFXSkill.bind(this,t))},_removeFXSkill:function(t){t.scheduleUpdate(),t.schedule(function(t){t.unscheduleUpdate(),t.removeFromParent()}.bind(this,t),.1)},fireById:function(t,e){var i;if(!this._isLockGun)return e=e||0,(i={}).Angle=this.lockFishID<=0?jf.math.getRotation(t,this.getPosition()):jf.math.getRotation(this.getPositionGunBarrel(),this.getPosition()),i.BulletMultiple=this._gunItem.goldGun,i.BulletID=this.bulletID,i.LockedFishID=this.lockFishID,this.bulletID++,2e3<this.bulletID&&(this.bulletID=0),this.DeskStation<2?90<i.Angle&&i.Angle<=180?i.Angle=90:180<i.Angle&&i.Angle<=270&&(i.Angle=270):0<i.Angle&&i.Angle<=90?i.Angle=90:270<i.Angle&&i.Angle<=360&&(i.Angle=270),this.fireAnimation(i.Angle,e),i},fireAnimation:function(t,e,i,n){if(!this.isMe)if(0===e)if(this._gunItem.goldGun!==i){this._gunItem.goldGun=i;for(var s=0;s<=this._gunValue.length;s++)this._gunValue[s]===i&&(this._gunItem._bulletType=s,this._gunItem.changeGunSkin(),this._gunGold.setVisible(!0),this._gunGold.setString(i))}else this._gunItem.changeGunSkin(),this._gunGold.setVisible(!0),this._gunGold.setString(i);else this._gunItem.changeGunItemSkillOnLySkin(e),this._gunGold.setVisible(!1);this._gunItem.setRotation(t),this._gunItem.fireBy(e,n)},getAnglePos:function(t){return jf.math.getRotation(t,this.getPosition())},getPositionGunBarrel:function(){return this._gunItem.getPositionEffectFire()},setLockFish:function(t){this.isMe&&(t&&t.isInScreen()&&!t.isDie()?(this.lockFishID=t.getID(),this._lockCosair.setVisible(!0),this._lockCosair.setPosition(t.getPosition()),this.lockFishPapaw.setVisible(!0),this.lockTargetFish=t,this.update(),this.scheduleUpdate()):(this.resetLockFish(),this.unscheduleUpdate()))},resetLockFish:function(){this.unscheduleUpdate(),this.lockFishPapaw&&this.lockFishPapaw.setVisible(!1),this._lockCosair.setVisible(!1),this.lockTargetFish=null,this.lockFishID=0,cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.LOCK_FISH,{nodeFishLock:null,isLock:!1})},lockGun:function(t){this._isLockGun=t},lockAnimation:function(t){this._isLockAnimation=t},update:function(){if(this.lockTargetFish)if(!this.lockTargetFish||!this.lockTargetFish.isDie()&&this.lockTargetFish.isInScreen()){this._lockCosair.setPosition(this.lockTargetFish.getPosition());var t=this.lockFishPapaw.childArray.length,e=jf.math.getRotation(this.lockTargetFish.getPosition(),this.getPosition());for(this.lockFishPapaw.setRotation(e),this._gunItem.setRotation(e),e=cc.pDistance(this.getPosition(),this.lockTargetFish.getPosition()),e=parseInt(e/50,10),i=0;i<t;i++)this.lockFishPapaw.childArray[i]&&this.lockFishPapaw.childArray[i].setVisible(!1);for(i=0;i<e;i++)this.lockFishPapaw.childArray[i]&&this.lockFishPapaw.childArray[i].setVisible(!0)}else this.resetLockFish();else this.resetLockFish()},removeEvents:function(){if(cc.eventManager.removeListener(this.listener),this.listEventCustom)for(var t=0;t<this.listEventCustom.length;t++)cc.eventManager.removeListener(this.listEventCustom[t])}}),JFLayerGuns=JFUIBaseLayer.extend({listPlayer:null,myPlayer:null,_layerbg:null,netSend:null,layerScreenGame:null,_listEvents:null,isAutoFire:null,timeLastFireNormal:null,_textLockFish:null,_lockFishID:null,isLockFish:!1,listItemActionIsOpenning:null,ctor:function(){JFUIBaseLayer.prototype.ctor.call(this)},initObj:function(){this._isFishTouch=!1,this._lockFishID=this.timeLastFireNormal=0,this._initFromCocostudio(ResourceManager.JFResourcesGame.CSSUIGunsLayer),this._initListGun(),this._setccuiLayout(),this._initEvents(),this._initTextLockFish()},_initTextLockFish:function(){this._textLockFish=new cc.Sprite,this._textLockFish.setSpriteFrame("IMG_TEXT_LOCK_FISH.png"),this.addChild(this._textLockFish),this._textLockFish.setPosition(cc.p(cc.winSize.width/2,cc.winSize.height/2)),this._textLockFish.setVisible(!1)},setGunValue:function(t){this.myPlayer&&this.myPlayer.setGunValue(t)},LockFish:function(){this.isLockFish=!0,this._lockFishID=0,this._textLockFish.setVisible(!0),this.myPlayer&&this.myPlayer.cancelAutoFile()},CancelLockFish:function(){this._lockFishID=0,this.isLockFish=!1,this._textLockFish.setVisible(!1),this.myPlayer&&this.myPlayer.resetLockFish()},_initListGun:function(){this.listPlayer=[];for(var t=0;t<JFGameInfo.MaxPlayer;t++){var e=new JFPlayer;e.cloneFromNode(this._mainLayer.getChildByName("JFPlayerNo"+t)),e.initObj(),e._checkInLayerRoomGame(t),this.addChild(e),this.listPlayer.push(e)}},_initEvents:function(){this._listEvents=[],this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.GAME_LISTUSER_BOARD.toString(),this._updateListUserInBoard.bind(this))),this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.GAME_USER_ENTER_BOARD.toString(),this._userEnterBoard.bind(this))),this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.GAME_USER_FIRE.toString(),this._userFire.bind(this))),this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.GAME_USER_UPDATE_CATCHFISH.toString(),this._updateUserCatchFish.bind(this))),this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.GAME_USER_EXIT.toString(),this._userExitBoard.bind(this))),this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.GAME_FIRE_SKILL.toString(),this._userFireSkill.bind(this))),this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.GAME_CHANGE_GUN_SKILL.toString(),this._changeGunSkill.bind(this))),this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.EVENTS.LOCK_FISH.toString(),this._updateLockFish.bind(this))),this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.EVENTS.SHOW_BOSS_COMING.toString(),this._showBossComming.bind(this))),this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.GAME_CHAT_EMOTICON.toString(),this._onUserChat.bind(this))),this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.DISPATCH_EVENT_OUT_FOCUS.toString(),this.onOutFocus.bind(this))),this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.CONFIG_BULLET.AUTO_FIRE.toString(),this._activeAutoFire.bind(this))),this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.CONFIG_BULLET.DE_ACTIVE_AUTO_FIRE.toString(),this._deActiveAutoFire.bind(this)))},_activeAutoFire:function(){this.isAutoFire=!0,this.myPlayer.setAutoFire(cc.p(500,500))},_deActiveAutoFire:function(){this.isAutoFire=!1,this.myPlayer.cancelAutoFile()},onOutFocus:function(){},_updateLockFish:function(t){if(t=t.getUserData(),this._textLockFish.setVisible(!1),t.isLock&&this.myPlayer)for(var e=this.layerScreenGame.layerPhysic.getListFish(),i=0;i<e.length;i++)if(e[i].fishID===t.fishID)return this.myPlayer.setLockFish(e[i]),this._layerbg.setTouchEnabled(!0),this.isLockFish=!0,void(this._lockFishID=1);t.isLock||(this.isLockFish=!1,this._layerbg.setTouchEnabled(!0),(this._lockFishID=0)<JFGameInfo.currentSkill?JFGameInfo.JFMain.layerComponents.activeLockFish(!1):JFGameInfo.JFMain.layerComponents.activeLockFish(!0))},_layerGunsOnClick:function(t,e){if(!this.isLockFish||e!==ccui.Widget.TOUCH_BEGAN||0!==this._lockFishID||0!==JFGameInfo.currentSkill){switch(e){case ccui.Widget.TOUCH_BEGAN:JFLayerGuns.listItemActionIsOpenning&&JFLayerGuns.listItemActionIsOpenning.hideListItemAction(),JFGameInfo.JFMain.layerComponents.compoOptionInGame.closeOption(),this.myPlayer&&(this.isAutoFire||this.myPlayer.cancelAutoFile(),this.myPlayer.updateTargetPosition(this.convertToNodeSpace(t.getTouchBeganPosition()),ccui.Widget.TOUCH_BEGAN),this.myPlayer.setAutoFire(this.convertToNodeSpace(t.getTouchBeganPosition()),ccui.Widget.TOUCH_BEGAN));break;case ccui.Widget.TOUCH_MOVED:this.myPlayer&&this.myPlayer.updateTargetPosition(this.convertToNodeSpace(t.getTouchMovePosition()),ccui.Widget.TOUCH_BEGAN);break;case ccui.Widget.TOUCH_ENDED:this.myPlayer&&(this.myPlayer.updateTargetPosition(this.convertToNodeSpace(t.getTouchEndPosition()),ccui.Widget.TOUCH_ENDED),this.isAutoFire||this.myPlayer.cancelAutoFile());break;case ccui.Widget.TOUCH_CANCELED:!this.myPlayer||this.isAutoFire||this.myPlayer.cancelAutoFile()}return!1}this._findLockFish(this.convertToNodeSpace(t.getTouchBeganPosition())),this.isAutoFire&&this.myPlayer.setAutoFire(this.convertToNodeSpace(t.getTouchBeganPosition()))},_findLockFish:function(t){for(var e,i=this.layerScreenGame.layerPhysic.getListFish(),n=0;n<i.length;n++)if(!(e=i[n]).isDie()&&32!==e.getKind()&&33!==e.getKind()&&34!==e.getKind()&&cc.pDistance(e.getPosition(),t)<=60){this._textLockFish.setVisible(!1),this.myPlayer.setLockFish(e),this.isLockFish=!0,this._lockFishID=1;break}},_userEnterBoard:function(e){e=e.getUserData();var i={UserID:BinaryConstants.DataTypeID.Int32,Gold:BinaryConstants.DataTypeID.UInt64,Nickname:BinaryConstants.DataTypeID.StringDynamic,Level:BinaryConstants.DataTypeID.UInt32,Exp:BinaryConstants.DataTypeID.UInt64,DeskStation:BinaryConstants.DataTypeID.UInt8,PosX:BinaryConstants.DataTypeID.Float,PoxY:BinaryConstants.DataTypeID.Float},i=(new BinaryParser).init(i,e.content);try{this._updateUserOnBoard(i)}catch(t){console.log(i),console.log(e)}},_userExitBoard:function(e){e=e.getUserData();var i={DeskStation:BinaryConstants.DataTypeID.UInt8},i=(new BinaryParser).init(i,e.content);try{this._updateUserExitBoard(this.listPlayer[i.DeskStation])}catch(t){console.log(i),console.log(e)}},_updateUserExitBoard:function(t){var e;t.isMe?((e={}).layerID=ConstantsVariable.LAYERS.MENU_LAYER_ROOMS,JFGameInfo.myInfo.itemGiftQuantity=[],JFGameInfo.currentSkill=0,JFGameInfo.currentSkillActive=0,t.resetUI(),cc.eventManager.dispatchCustomEvent(ConstantsVariable.NETWORK.GAME_EXIT.toString(),e)):(t.resetUI(),t.setVisible(!1),t.removeEvents())},_updateUserOnBoard:function(t){var e;this.listPlayer[t.DeskStation]&&((e=this.listPlayer[t.DeskStation]).resetUI(),e.UserID=t.UserID,e.Gold=t.Gold,e.Level=t.Level,e.Exp=t.Exp,e.DeskStation=t.DeskStation,e.PosX=t.PosX,e.PosY=t.PosY,e.isMe=t.UserID===JFGameInfo.myInfo.UserID,e.Nickname=t.Nickname,e.AvatarId=t.AvatarID,e.updateController(),e.updateUI(),e.setVisible(!0),e.isMe&&(JFGameInfo.bulletPool=ConstantsVariable.BulletMax,this._layerbg.setTouchEnabled(!0),JFGameInfo.JFMain.layerComponents.activeLockFish(!0),this.CancelLockFish(),this.myPlayer=e,this.myPlayer.netSend=this.netSend,JFGameInfo.myInfo.listBulletID=[]),2<=t.DeskStation&&e._gunItem.setRotation(180),cc.sys.isNative?e.getDataOnline("GetLinkAvatar_V2"):e.getAvatarByUserID(e.UserID))},_updateListUserInBoard:function(t){t=t.getUserData();var e={ListUserInDesk:BinaryConstants.DataTypeID.Object8,ListUserInDesk_Struct:{UserID:BinaryConstants.DataTypeID.Int32,Gold:BinaryConstants.DataTypeID.UInt64,Nickname:BinaryConstants.DataTypeID.StringDynamic,Exp:BinaryConstants.DataTypeID.UInt64,Level:BinaryConstants.DataTypeID.UInt32,DeskStation:BinaryConstants.DataTypeID.UInt8,PosX:BinaryConstants.DataTypeID.Float,PosY:BinaryConstants.DataTypeID.Float}};for(t=(new BinaryParser).init(e,t.content),e=0;e<t.ListUserInDesk.length;e++)this._updateUserOnBoard(t.ListUserInDesk[e])},_userFire:function(t){t=t.getUserData();var e={DeskStation:BinaryConstants.DataTypeID.UInt8,Angle:BinaryConstants.DataTypeID.Float,BulletMultiple:BinaryConstants.DataTypeID.UInt32,LockedFishID:BinaryConstants.DataTypeID.UInt32,Gold:BinaryConstants.DataTypeID.UInt64,BulletID:BinaryConstants.DataTypeID.UInt32};(t=(new BinaryParser).init(e,t.content)).DeskStation=t.StationID,this.listPlayer[t.DeskStation].Gold=t.Gold,this.listPlayer[t.DeskStation].updateUI(),this.myPlayer.DeskStation!==t.DeskStation&&(this.listPlayer[t.DeskStation].fireAnimation(t.Angle,0,t.BulletMultiple),t.bulletPosition=this.listPlayer[t.DeskStation].getPositionGunBarrel(),t.isMe=!1,cc.eventManager.dispatchCustomEvent(ConstantsVariable.NETWORK.GAME_CREATE_BULLET.toString(),t))},_changeGunSkill:function(t){if(this.myPlayer)switch(0<JFGameInfo.currentSkill?(this._layerbg.setTouchEnabled(!0),JFGameInfo.JFMain.layerComponents.activeLockFish(!1),this.CancelLockFish()):(this._layerbg.setTouchEnabled(!0),JFGameInfo.JFMain.layerComponents.activeLockFish(!0)),this.myPlayer.changeGunSkill(JFGameInfo.currentSkill),JFGameInfo.currentSkill){case 1:(t=new sp.SkeletonAnimation(ResourceManager.JFResourcesGame.Text_Laser_Gun_json,ResourceManager.JFResourcesGame.Text_Laser_Gun_atlas)).setAnimation(0,"LaserTextAnim",!1),t.setCompleteListener(this._removeFXSpineComplete.bind(this,t)),this.addChild(t),t.setPosition(cc.p(640,360));break;case 2:(t=new sp.SkeletonAnimation(ResourceManager.JFResourcesGame.Text_Electric_Gun_json,ResourceManager.JFResourcesGame.Text_Electric_Gun_atlas)).setAnimation(0,"ElecTextAnim",!1),t.setCompleteListener(this._removeFXSpineComplete.bind(this,t)),this.addChild(t),t.setPosition(cc.p(640,360));break;case 3:(t=new sp.SkeletonAnimation(ResourceManager.JFResourcesGame.Text_BombGun_json,ResourceManager.JFResourcesGame.Text_BombGun_atlas)).setAnimation(0,"BombTextAnim",!1),t.setCompleteListener(this._removeFXSpineComplete.bind(this,t)),this.addChild(t),t.setPosition(cc.p(640,360));break;case 4:(t=sp.SkeletonAnimation.create(ResourceManager.JFResourcesGame.Text_Poseidon_json,ResourceManager.JFResourcesGame.Text_Poseidon_atlas)).setAnimation(0,"UltiSkill_FX",!1),t.setCompleteListener(this._removeFXSpineComplete.bind(this,t)),this.addChild(t),t.setPosition(cc.p(640,360))}},_showBossComming:function(){var t=new sp.SkeletonAnimation(ResourceManager.JFResourcesGame.Text_Boss_Coming_json,ResourceManager.JFResourcesGame.Text_Boss_Coming_atlas);t.setAnimation(0,"BossTextAnim",!1),t.setCompleteListener(this._removeFXSpineComplete.bind(this,t)),this.addChild(t),t.setPosition(cc.p(640,360))},_removeFXSpineComplete:function(t){t.scheduleUpdate(),t.schedule(function(){t.unscheduleUpdate(),t.clearTracks(),t.removeFromParent(),t=null},.1)},_onUserChat:function(t){t=t.getUserData();var e={StationID:BinaryConstants.DataTypeID.UInt8,ChatID:BinaryConstants.DataTypeID.UInt8};t=(new BinaryParser).init(e,t.content),this.listPlayer[t.StationID].DeskStation===t.StationID&&this.listPlayer[t.StationID].showEmoticon(t.ChatID)},_userFireSkill:function(t){t=t.getUserData();var e={DeskStation:BinaryConstants.DataTypeID.UInt8,Angle:BinaryConstants.DataTypeID.Float,x:BinaryConstants.DataTypeID.Float,y:BinaryConstants.DataTypeID.Float,BulletID:BinaryConstants.DataTypeID.UInt8,SkillID:BinaryConstants.DataTypeID.UInt8};0<(t=(new BinaryParser).init(e,t.content)).SkillID?(this.listPlayer[t.DeskStation].fireAnimation(t.Angle,t.SkillID),t.bulletPosition=this.listPlayer[t.DeskStation].getPositionGunBarrel(),t.isMe=this.myPlayer.DeskStation==t.DeskStation,t.targetPosition=cc.p(t.x,t.y),cc.eventManager.dispatchCustomEvent(ConstantsVariable.NETWORK.GAME_CREATE_SKILL.toString(),t)):JFGameInfo.currentSkill=0},_updateUserCatchFish:function(t){var e;(t=t.getUserData()).DeskStation=t.StationID,this.listPlayer[t.DeskStation].isMe&&this.listPlayer[t.DeskStation].Level<t.Level&&((e=new sp.SkeletonAnimation(ResourceManager.JFResourcesGame.LvUp_FX_json,ResourceManager.JFResourcesGame.LvUp_FX_atlas)).setAnimation(0,"animation",!1),this.addChild(e),e.setPosition(cc.p(JFGameInfo.appRealWidth/2,JFGameInfo.appRealHeight/2)),e.setCompleteListener(this._removeFXSkill.bind(this,e))),this.listPlayer[t.DeskStation].Gold=t.TotalGold,t.Level&&t.Level>this.listPlayer[t.DeskStation].Level&&(this.listPlayer[t.DeskStation].Level=t.Level),t.Exp&&(this.listPlayer[t.DeskStation].Exp=t.Exp),this.listPlayer[t.DeskStation].updateUI(!0)},_removeFXSkill:function(t){t.scheduleUpdate(),t.schedule(function(t){t.unscheduleUpdate(),t.clearTracks(),t.removeFromParent()}.bind(this,t),.1)},getPlayerPositionByID:function(t){for(var e=0;e<this.listPlayer.length;e++)if(this.listPlayer[e].UserID===t)return this.listPlayer[e].getPosition();return null},getPlayerByID:function(t){for(var e=0;e<this.listPlayer.length;e++)if(this.listPlayer[e].UserID===t)return this.listPlayer[e];return null},lockGun:function(t){for(var e=0;e<this.listPlayer.length;e++)this.listPlayer[e].lockGun(t)},lockAnimation:function(t){for(var e=0;e<this.listPlayer.length;e++)this.listPlayer[e].lockAnimation(t)},callBackNEG:function(){JFGameInfo.JFMain.layerScreenGame.netSend.sendExitGameServer(),JFGameInfo.SNG=!0},_setccuiLayout:function(){this._layerbg||(this._layerbg=new ccui.Layout,this.addChild(this._layerbg),this._layerbg.setLocalZOrder(-1),this._layerbg.setContentSize(cc.size(1280,720)),this._layerbg.setAnchorPoint(cc.p(0,0)),this._layerbg.setPosition(cc.p(0,0)),this._layerbg.setTouchEnabled(!0),this._layerbg.setOpacity(100),this._layerbg.addTouchEventListener(this._layerGunsOnClick.bind(this)))},dispose:function(){for(var t=0;t<this._listEvents.length;t++)cc.eventManager.removeListener(this._listEvents[t]);this.removeAllChildren(!0)}}),JFMiniVongQuayNetSend=(JFMiniGame=ccui.Layout.extend({vongQuay:null,netSend:null,taiXiu:null,slot:null,_listEvents:null,eventVongQuayKhoBauDaiDuong:null,eventVongQuaySeason:null,ctor:function(){ccui.Layout.prototype.ctor.call(this)},initObj:function(){},show:function(){this.setVisible(!0),JFGameInfo.CurrentLayer=ConstantsVariable.LAYERS.MENU_LAYER_MINI_GAME},hide:function(){if(this.setVisible(!1),JFGameInfo.roomID!==ConstantsVariable.EventVongQuayKBDD&&JFGameInfo.roomID!==ConstantsVariable.EventVongQuaySeason&&JFNetCore.JFGameSocket.close(),this._listEvents)for(var t=0;t<this._listEvents.length;t++)cc.eventManager.removeListener(this._listEvents[t]);JFGameInfo.JFMain._playBackgroundMusic(!1)},createVongQuayGame:function(){this.vongQuay=new JFVongQuay,this.vongQuay.initObj(),this.addChild(this.vongQuay)},deleteVongQuayGame:function(){this.vongQuay&&(this.removeChild(this.vongQuay),this.vongQuay=null)},createSlotMinigame:function(){this.slot=new JFMiniSlot,this.slot.initObj(),this.addChild(this.slot)},deleteSlotMinigame:function(){this.slot&&(this.removeChild(this.slot),this.slot=null)},createTaiXiuGame:function(){this.taiXiu=new JFMiniTaiXiu,this.taiXiu.initObj(),this.addChild(this.taiXiu)},deleteTaiXiuGame:function(){this.taiXiu&&(this.removeChild(this.taiXiu),this.taiXiu=null)},createKhoBauDaiDuongGame:function(){this.eventVongQuayKhoBauDaiDuong=new JFEventVongQuayKBDD,this.eventVongQuayKhoBauDaiDuong.initObj(),this.addChild(this.eventVongQuayKhoBauDaiDuong)},deleteKhoBauDaiDuongGame:function(){this.eventVongQuayKhoBauDaiDuong&&(this.removeChild(this.eventVongQuayKhoBauDaiDuong),this.eventVongQuayKhoBauDaiDuong=null)},createVongQuaySeason:function(t){this.eventVongQuaySeason=new JFEventVongQuaySeason,this.eventVongQuaySeason.initObj(t),this.addChild(this.eventVongQuaySeason)},deleteVongQuaySeason:function(){this.eventVongQuaySeason&&(this.removeChild(this.eventVongQuaySeason),this.eventVongQuaySeason=null)},initNetWork:function(){this._initEvents(),JFGameInfo.roomID===ConstantsVariable.MiniGameVongQuay?(this.netSend=new JFMiniVongQuayNetSend,this.createVongQuayGame()):JFGameInfo.roomID===ConstantsVariable.MiniGameTaiXiu?(this.netSend=new JFMiniTaiXiuNetSend,this.createTaiXiuGame()):JFGameInfo.roomID===ConstantsVariable.MiniGameSlot&&(this.netSend=new JFMiniSlotNetSend,this.createSlotMinigame()),JFNetCore.JFGameSocket=new JFNetCore,JFNetCore.JFGameSocket.callBackOnConnected=this._onConnectedGameServer.bind(this),JFNetCore.JFGameSocket.callBackOnError=this._onErrorGameServer.bind(this),JFNetCore.JFGameSocket.callBackOnReceiveData=this._onReceiveGameServer.bind(this),JFNetCore.JFGameSocket.callBackOnClose=this._onCloseGameServer.bind(this),this.connectGameServer()},_initEvents:function(){this._listEvents=[]},connectGameServer:function(){JFNetCore.JFGameSocket.close(),JFNetCore.JFGameSocket.init(PreLoaderConfig.ServerAndPortGame),JFNetCore.JFGameSocket.connect()},_onConnectedGameServer:function(){this.netSend.sendLoginGame(JFGameInfo.myInfo.token4Game)},_onCloseGameServer:function(){switch(JFGameInfo.roomID){case ConstantsVariable.MiniGameVongQuay:JFGameInfo.JFMain.pushFirebaseConnectError("Wheel","server close socket");break;case ConstantsVariable.MiniGameTaiXiu:JFGameInfo.JFMain.pushFirebaseConnectError("TaiXiu","server close socket");break;case ConstantsVariable.MiniGameSlot:JFGameInfo.JFMain.pushFirebaseConnectError("Slot","server close socket")}this.unschedule(this.onPingGame),JFGameInfo.CurrentLayer===ConstantsVariable.LAYERS.MENU_LAYER_GAME&&JFNetCore.JFGameSocket&&(JFGameInfo.JFMain._exitServerGame(),JFGameInfo.JFMain.resetUserInfo(),this.layerPopup.showPopupMsg(PreLoaderConfig.Messages.ERROR_CONNECT_SOCKET))},_onErrorGameServer:function(){switch(JFGameInfo.roomID){case ConstantsVariable.MiniGameVongQuay:JFGameInfo.JFMain.pushFirebaseConnectError("Wheel","server error socket");break;case ConstantsVariable.MiniGameTaiXiu:JFGameInfo.JFMain.pushFirebaseConnectError("TaiXiu","server error socket");break;case ConstantsVariable.MiniGameSlot:JFGameInfo.JFMain.pushFirebaseConnectError("Slot","server error socket")}this.unschedule(this.onPingGame),JFGameInfo.CurrentLayer===ConstantsVariable.LAYERS.MENU_LAYER_GAME&&JFNetCore.JFGameSocket&&(JFGameInfo.JFMain._exitServerGame(),JFGameInfo.JFMain.resetUserInfo(),this.layerPopup.showPopupMsg(PreLoaderConfig.Messages.ERROR_CONNECT_SOCKET))},_onReceiveGameServer:function(t){cc.eventManager.dispatchCustomEvent(t.requestId.toString(),t)}}),JFNetSend.extend({ctor:function(){JFNetSend.prototype.ctor.call(this)},sendLoginGame:function(t){var e={};e.Token=t,t=Message.build(ConstantsVariable.NETWORK.MINI_GAME_LOGIN,{Token:BinaryConstants.DataTypeID.StringDynamic},e),JFNetCore.JFGameSocket.sendMsg(t)},sendVongQuayRoll:function(){var t=Message.build(ConstantsVariable.NETWORK.MINI_GAME_START_ROLL,null,null);JFNetCore.JFGameSocket.sendMsg(t)},sendVongQuayTopWin:function(){var t=Message.build(ConstantsVariable.NETWORK.MINI_GAME_LIST_LAYER_WIN,null,null);JFNetCore.JFGameSocket.sendMsg(t)},sendVongQuayHistory:function(){var t=Message.build(ConstantsVariable.NETWORK.MINI_GAME_LIST_HISTORY,null,null);JFNetCore.JFGameSocket.sendMsg(t)}})),JFMiniTaiXiu=(JFVongQuay=JFUIBaseLayer.extend({vongQuay:null,_lastIDResult:null,ListItems:null,luotQuay:null,nodeMask:null,btnQuay:null,btnTheLe:null,btnUserWin:null,btnLichSu:null,leftContent:null,txtTheLe:null,ScrollView:null,line:null,ctor:function(){JFUIBaseLayer.prototype.ctor.call(this)},initObj:function(){this._initFromCocostudio(ResourceManager.JFResourcesMenuGame.CSSUIVongQuayPopup),this.luotQuay=this._mainLayer.getChildByName("JFTxtLuotQuay"),this.luotQuay.setString("000"),this.vongQuay=this._mainLayer.getChildByName("JFVongQuay"),this.nodeMask=this._mainLayer.getChildByName("JFMask"),this.btnQuay=this._mainLayer.getChildByName("JFButtonQuay"),this.btnTheLe=this._mainLayer.getChildByName("JFButtonTheLe"),this.btnUserWin=this._mainLayer.getChildByName("JFButtonTrungGiai"),this.btnLichSu=this._mainLayer.getChildByName("JFButtonLichSu"),this.leftContent=this._mainLayer.getChildByName("JFLeftContent"),this.txtTheLe=this.leftContent.getChildByName("JFTxtTheLe"),this.scrollView=this.leftContent.getChildByName("JFScrollView"),this.line=this.leftContent.getChildByName("JFBGListView"),this._lastIDResult=1,this.txtTheLe.setString(ConstantsVariable.Messages.EVENT_VQMM_MINIGAME),this._initEvents()},onClickBtnFromCocostudio:function(t,e){switch(t.getName()){case"JFButtonClose":cc.audioEngine.playEffect(ResourceManager.JFResourcesMenuGame.SoundClose,!1),this.onclose();break;case"JFButtonQuay":cc.audioEngine.playEffect(ResourceManager.JFResourcesMenuGame.ClickQuay,!1),0<JFGameInfo.myInfo.Ticket?(this.btnQuay.setEnabled(!1),this.btnQuay.setBright(!1),JFGameInfo.JFMain.layerMiniGame.netSend.sendVongQuayRoll()):JFGameInfo.JFMain.layerPopup.showPopupMsg("Không đủ vé!");break;case"JFButtonTheLe":cc.audioEngine.playEffect(ResourceManager.JFResourcesMenuGame.SoundClose,!1),this.btnTheLe.setEnabled(!1),this.btnTheLe.setBright(!1),this.btnUserWin.setEnabled(!0),this.btnUserWin.setBright(!0),this.btnLichSu.setEnabled(!0),this.btnLichSu.setBright(!0),this.scrollView.setVisible(!1),this.txtTheLe.setVisible(!0),this.line.setVisible(!1);break;case"JFButtonTrungGiai":cc.audioEngine.playEffect(ResourceManager.JFResourcesMenuGame.SoundClose,!1),this.btnTheLe.setEnabled(!0),this.btnTheLe.setBright(!0),this.btnUserWin.setEnabled(!1),this.btnUserWin.setBright(!1),this.btnLichSu.setEnabled(!0),this.btnLichSu.setBright(!0),this.scrollView.setVisible(!0),this.txtTheLe.setVisible(!1),this.line.setVisible(!0),JFGameInfo.JFMain.layerMiniGame.netSend.sendVongQuayTopWin();break;case"JFButtonLichSu":cc.audioEngine.playEffect(ResourceManager.JFResourcesMenuGame.SoundClose,!1),this.btnTheLe.setEnabled(!0),this.btnTheLe.setBright(!0),this.btnUserWin.setEnabled(!0),this.btnUserWin.setBright(!0),this.btnLichSu.setEnabled(!1),this.btnLichSu.setBright(!1),this.scrollView.setVisible(!0),this.txtTheLe.setVisible(!1),this.line.setVisible(!0),JFGameInfo.JFMain.layerMiniGame.netSend.sendVongQuayHistory()}},_initEvents:function(){this._listEvents=[],this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.MINI_GAME_LOGIN_SUCCESS.toString(),this.ngLoginSuccess.bind(this))),this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.MINI_GAME_USES_INFO.toString(),this.ngUserInfo.bind(this))),this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.MINI_GAME_RESULT.toString(),this.ngGameResult.bind(this))),this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.MINI_GAME_ERROR.toString(),this.ngGameError.bind(this))),this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.MINI_GAME_LIST_ITEM.toString(),this.ngListItem.bind(this))),this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.MINI_GAME_LIST_LAYER_WIN.toString(),this.ngListPlayerWin.bind(this))),this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.MINI_GAME_LIST_HISTORY.toString(),this.ngListHistory.bind(this)))},ngLoginSuccess:function(t){t=t.getUserData();var e={ErrorCode:BinaryConstants.DataTypeID.UInt32};(new BinaryParser).init(e,t.content),JFGameInfo.JFMain.layerMiniGame.show(),JFGameInfo.JFMain.hideLoading()},ngUserInfo:function(t){t=t.getUserData();var e={Ticket:BinaryConstants.DataTypeID.UInt32,Money:BinaryConstants.DataTypeID.UInt64};t=(new BinaryParser).init(e,t.content),JFGameInfo.myInfo.Gold=t.Money,JFGameInfo.myInfo.Ticket=t.Ticket,this.luotQuay.setString((t.Ticket<10?"00":t.Ticket<100?"0":"")+t.Ticket),JFGameInfo.JFMain.layerMainMenu._layerLobby.userContainer.refeshUserInfo(),JFGameInfo.JFMain.pushFirebaseJoinRoomSuccess("Wheel")},ngListItem:function(t){t=t.getUserData();var e={ListItems:BinaryConstants.DataTypeID.Object8,ListItems_Struct:{ID:BinaryConstants.DataTypeID.UInt32,ItemImage:BinaryConstants.DataTypeID.StringDynamic,ItemName:BinaryConstants.DataTypeID.StringDynamic}};for(t.content.ListItems=t.content.ListItem,this.ListItems=(new BinaryParser).init(e,t.content).ListItems,t=0;t<8;t++)cc.loader.loadImg(PreLoaderConfig.PathToAvatar+this.ListItems[t].ItemImage,this.onLoadImgComplete.bind(this,this.vongQuay.getChildByName("JFItem"+this.ListItems[t].ID))),this.vongQuay.getChildByName("JFTxtItem"+this.ListItems[t].ID).setString(this.ListItems[t].ItemName)},onLoadImgComplete:function(t,e,i){t.removeAllChildren(),i&&(e=new cc.Sprite(i),t.addChild(e))},ngGameResult:function(t){t=t.getUserData();var e={ID:BinaryConstants.DataTypeID.UInt32},e=45*((t=(new BinaryParser).init(e,t.content)).ID-this._lastIDResult);this.nodeMask.setVisible(!1),this.vongQuay.runAction(cc.sequence(cc.rotateBy(.3,-15).easing(cc.easeIn(1)),cc.rotateBy(7,2895-e).easing(cc.easeInOut(2.5)),cc.delayTime(.5),cc.callFunc(this.onRollComplete.bind(this)))),jf.audio.pauseMusic(),cc.audioEngine.playEffect(ResourceManager.JFResourcesMenuGame.NhacQuay,!1),this._lastIDResult=t.ID,Utilities.showLog("ngGameResult "+JSON.stringify(t))},onRollComplete:function(){this.btnQuay.setEnabled(!0),this.btnQuay.setBright(!0),this.nodeMask.setVisible(!0),this.vongQuay.rotation=-45*(this._lastIDResult-1),cc.audioEngine.playEffect(ResourceManager.JFResourcesMenuGame.NhanThuong,!1);var t=this.ListItems[this._lastIDResult-1].ItemName;this._mainLayer.getChildByName("JFTxtKetQua").setString(t),this._mainLayer.getChildByName("JFCheckBoxTuQuay").isSelected()?0<JFGameInfo.myInfo.Ticket?(this.btnQuay.setEnabled(!1),this.btnQuay.setBright(!1),JFGameInfo.JFMain.layerMiniGame.netSend.sendVongQuayRoll()):(JFGameInfo.JFMain.layerPopup.showPopupMsg("Không đủ vé!"),this._mainLayer.getChildByName("JFCheckBoxTuQuay").setSelected(!1)):JFGameInfo.JFMain.layerPopup.showPopupMsg("Chúc mừng bạn nhận được "+t+".\nThông tin thưởng được gửi về hộp mail cá nhân.\nVui lòng kiểm tra.")},ngListPlayerWin:function(t){t=t.getUserData();var e={ListLayerWin:BinaryConstants.DataTypeID.Object8,ListLayerWin_Struct:{Nickname:BinaryConstants.DataTypeID.StringDynamic,Msg:BinaryConstants.DataTypeID.StringDynamic,TimeRecord:BinaryConstants.DataTypeID.UInt64}};t=(new BinaryParser).init(e,t.content),this.bindData(t.ListLayerWin,!1)},ngListHistory:function(t){t=t.getUserData();var e={ListHistory:BinaryConstants.DataTypeID.Object8,ListHistory_Struct:{Msg:BinaryConstants.DataTypeID.StringDynamic,TimeRecord:BinaryConstants.DataTypeID.UInt64}};t=(new BinaryParser).init(e,t.content),this.bindData(t.ListHistory,!0)},bindData:function(t,e){for(var i=this.scrollView.getChildByName("item");i;)this.scrollView.removeChild(i,!0),i=this.scrollView.getChildByName("item");for(var n=t.length,s=1,r=(i=18*(n+1))<174?174:i,o=0;o<n;o++)(i=new JFItemMiniGameHistory).setName("item"),e?i.initObj(JFGameInfo.myInfo.Nickname,t[o].Msg,t[o].TimeRecord,o):i.initObj(t[o].Nickname,t[o].Msg,t[o].TimeRecord,o),i.setAnchorPoint(cc.p(-.5,-.5)),this.scrollView.addChild(i),i.setPositionY(r-18*s),i.setPositionX(150),s++;this.scrollView.setInnerContainerSize(cc.size(305,r))},ngGameError:function(t){t=t.getUserData();var e={Msg:BinaryConstants.DataTypeID.StringDynamic};t=(new BinaryParser).init(e,t.content),JFGameInfo.JFMain.layerPopup.showPopupMsg(t.Msg)},onclose:function(){if(JFGameInfo.CurrentLayer=ConstantsVariable.LAYERS.MENU_LAYER_ROOMS,JFGameInfo.JFMain.layerMiniGame.deleteVongQuayGame(),JFGameInfo.JFMain.layerMiniGame.hide(),this._listEvents)for(var t=0;t<this._listEvents.length;t++)cc.eventManager.removeListener(this._listEvents[t])}}),JFItemMiniGameHistory=JFUIBaseNode.extend({ctor:function(){JFUIBaseNode.prototype.ctor.call(this)},initObj:function(t,e,i,n){this._initFromCocostudio(ResourceManager.JFResourcesMenuGame.CSSJFItemMiniGameLichSu),this._mainLayer.getChildByName("JFTxtItemName").setString(e),this._mainLayer.getChildByName("JFTxtUserName").setString(t),this._mainLayer.getChildByName("JFTxtTime").setString(this.timeConvert(i)),0==n%2?this._mainLayer.getChildByName("JFBackground").setVisible(!1):(this._mainLayer.getChildByName("JFTxtItemName").setColor(cc.color("#5d2d01")),this._mainLayer.getChildByName("JFTxtUserName").setColor(cc.color("#5d2d01")),this._mainLayer.getChildByName("JFTxtTime").setColor(cc.color("#5d2d01")))},timeConvert:function(t){t=(r=new Date(t)).getFullYear();var e=r.getMonth()+1,i=r.getDate(),n=r.getHours(),s=r.getMinutes(),r=r.getSeconds();return 1==e.toString().length&&(e="0"+e),1==i.toString().length&&(i="0"+i),(n=1==n.toString().length?"0"+n:n)+":"+(s=1==s.toString().length?"0"+s:s)+":"+(r=1==r.toString().length?"0"+r:r)+" "+i+"/"+e+"/"+t}}),JFEventVongQuayKBDD=JFUIBaseLayer.extend({vongQuay:null,_lastIDResult:null,ListItems:[],txtListItems:[],luotQuay:null,nodeMask:null,btnQuay:null,checkBoxAuto:null,btnTheLe:null,btnUserWin:null,btnLichSu:null,leftContent:null,txtTheLe:null,ScrollView:null,scrollViewLichSu:null,scrollViewTrungGiai:null,line:null,txtJackpot:null,txtYesterdayResult:null,txtResult:null,Code:null,dataHistoryWorld:null,dataHistorySelf:null,popUpMsg:null,eventCode:null,ctor:function(){JFUIBaseLayer.prototype.ctor.call(this)},initObj:function(){this._initFromCocostudio(ResourceManager.JFResourcesMenuGame.CCSPopupVongQuayKBDD_json),this.eventCode=ConstantsVariable.EVENT_CODE.KHO_BAU_DAI_DUONG,this.luotQuay=this._mainLayer.getChildByName("JFTxtLuotQuay"),this.vongQuay=this._mainLayer.getChildByName("JFVongQuay"),this.nodeMask=this._mainLayer.getChildByName("JFMask"),this.nodeMask.setVisible(!1),this.checkBoxAuto=this._mainLayer.getChildByName("JFCheckboxTuQuay"),this.btnQuay=this._mainLayer.getChildByName("JFButtonQuay"),this.btnTheLe=this._mainLayer.getChildByName("JFButtonTheLe"),this.btnUserWin=this._mainLayer.getChildByName("JFButtonTrungGiai"),this.btnLichSu=this._mainLayer.getChildByName("JFButtonLichSu"),this.leftContent=this._mainLayer.getChildByName("JFLeftContent"),this.txtTheLe=this.leftContent.getChildByName("JFTxtTheLe"),this.scrollViewLichSu=this.leftContent.getChildByName("JFScrollViewLichSu"),this.scrollViewLichSu.setVisible(!1),this.scrollViewTrungGiai=this.leftContent.getChildByName("JFScrollViewTrungGiai"),this.scrollViewTrungGiai.setVisible(!1),this.txtResult=this._mainLayer.getChildByName("JFTxtKetQua"),this.txtResult.setString(""),this.line=this.leftContent.getChildByName("JFBGListView"),this.txtYesterdayResult=this._mainLayer.getChildByName("JFTxtXuThangThuaHomQua"),this.txtJackpot=this._mainLayer.getChildByName("JFTxtJackpot"),this._lastIDResult=0,this._getDataOnline("LoadEvent",this._onCallBackLoadMiniGameKBDD.bind(this))},onclose:function(){JFGameInfo.CurrentLayer=ConstantsVariable.LAYERS.MENU_LAYER_ROOMS,JFGameInfo.JFMain.layerMiniGame.deleteKhoBauDaiDuongGame(),JFGameInfo.JFMain.layerMiniGame.hide()},_initItemsTxt:function(){for(var t=0;t<12;t++)this.txtListItems[t]=this._mainLayer.getChildByName("JFVongQuay").getChildByName("JFTxtItem"+(t+1)),this.txtListItems[t].setString(this._dataListItem[t].Description)},_initItemsIcon:function(){for(var t=0;t<12;t++)this.ListItems[t]=this._mainLayer.getChildByName("JFVongQuay").getChildByName("JFItem"+(t+1)),cc.loader.loadImg(this._dataListItem[t].Image,{isCrossOrigin:!0},this._onLoadIconComplete.bind(this,this.ListItems[t]))},_onLoadIconComplete:function(t,e,i){e?console.log("load icon image error"):(t.removeAllChildren(),i&&(e=new cc.Sprite(i),t.addChild(e)))},onClickBtnFromCocostudio:function(t,e){switch(t.getName()){case"JFButtonClose":cc.audioEngine.playEffect(ResourceManager.JFResourcesMenuGame.SoundClose,!1),this.onclose();break;case"JFButtonQuay":cc.audioEngine.playEffect(ResourceManager.JFResourcesMenuGame.ClickQuay,!1),0<this.Code?(this.nodeMask.setVisible(!1),this.btnQuay.setEnabled(!1),this.btnQuay.setBright(!1),this._getDataOnline("UserSpin",this._onCallBackGetDataUserSpinOnline.bind(this))):JFGameInfo.JFMain.layerPopup.showPopupMsg("Không đủ vé!");break;case"JFButtonTheLe":cc.audioEngine.playEffect(ResourceManager.JFResourcesMenuGame.SoundClose,!1),this.btnTheLe.setEnabled(!1),this.btnTheLe.setBright(!1),this.btnUserWin.setEnabled(!0),this.btnUserWin.setBright(!0),this.btnLichSu.setEnabled(!0),this.btnLichSu.setBright(!0),this.scrollViewLichSu.setVisible(!1),this.scrollViewTrungGiai.setVisible(!1),this.txtTheLe.setVisible(!0),this.line.setVisible(!1);break;case"JFButtonTrungGiai":cc.audioEngine.playEffect(ResourceManager.JFResourcesMenuGame.SoundClose,!1),this.btnTheLe.setEnabled(!0),this.btnTheLe.setBright(!0),this.btnUserWin.setEnabled(!1),this.btnUserWin.setBright(!1),this.btnLichSu.setEnabled(!0),this.btnLichSu.setBright(!0),this.scrollViewTrungGiai.setVisible(!0),this.scrollViewLichSu.setVisible(!1),this.txtTheLe.setVisible(!1),this.line.setVisible(!0);break;case"JFButtonLichSu":cc.audioEngine.playEffect(ResourceManager.JFResourcesMenuGame.SoundClose,!1),this.btnTheLe.setEnabled(!0),this.btnTheLe.setBright(!0),this.btnUserWin.setEnabled(!0),this.btnUserWin.setBright(!0),this.btnLichSu.setEnabled(!1),this.btnLichSu.setBright(!1),this.scrollViewLichSu.setVisible(!0),this.scrollViewTrungGiai.setVisible(!1),this.txtTheLe.setVisible(!1),this.line.setVisible(!0)}},_getDataOnline:function(t,e){JFGameInfo.JFMain.showLoading();var i={},n=(i.EventCode=this.eventCode,i.UserID=JFGameInfo.myInfo.UserID,i.PlatformID=JFGameInfo.myPlatform,i.AppVersion=JFGameInfo.AppVersion,i.HardwareID=JFGameInfo.devineID,i.packetName=JFGameInfo.packetName,i.VersionDevice=JFGameInfo.VersionDevice,i.DeviceModel=JFGameInfo.DeviceModel,i.ChannelId=JFGameInfo.ChannelID,t+i.EventCode+i.UserID+i.PlatformID+i.AppVersion+i.HardwareID+i.ChannelId+i.VersionDevice+i.DeviceModel+i.packetName+JFGameInfo.myInfo.token4Ws);i.Sign=md5.encscript(n),console.log("str"+n+i.Sign),Utilities.getAPI(t,i,e.bind(this))},_onCallBackLoadMiniGameKBDD:function(t){JFGameInfo.JFMain.hideLoading(),1===(t=JSON.parse(t)).Result?(this._dataListItem=t.Data.ListItem,this._initItemsTxt(),this._initItemsIcon(),this.Code=t.Data.InfoUser.Code,this.luotQuay.setString(t.Data.InfoUser.Code),this.txtYesterdayResult.setString(t.Data.InfoUser.CurrentWin),this.txtJackpot.setString(t.Data.CurrentHu+" GOLD"),this.dataHistoryWorld=t.Data.TopWin,this.loadHistory(this.dataHistoryWorld,!1,this.scrollViewTrungGiai),this.dataHistorySelf=t.Data.TopWinUser,this.loadHistory(this.dataHistorySelf,!0,this.scrollViewLichSu),this.txtTheLe.setString(t.Data.ArticleEvent),JFGameInfo.JFMain.hideLoading()):JFGameInfo.JFMain.layerPopup.showPopupMsg(t.Message)},_onCallBackGetDataInfoUserOnline:function(t){JFGameInfo.JFMain.hideLoading(),1===(t=JSON.parse(t)).Result?(this.Code=t.Data.Code,this.luotQuay.setString(t.Data.Code),this.txtYesterdayResult.setString(t.Data.CurrentWin)):JFGameInfo.JFMain.layerPopup.showPopupMsg(t.Message)},_onCallBackGetDataJackpotOnline:function(t){JFGameInfo.JFMain.hideLoading(),1===(t=JSON.parse(t)).Result?this.txtJackpot.setString(t.Data.toString()+" GOLD"):JFGameInfo.JFMain.layerPopup.showPopupMsg(t.Message)},_onCallBackGetDataTopUserOnline:function(t){JFGameInfo.JFMain.hideLoading(),1===(t=JSON.parse(t)).Result?(this.dataHistoryWorld=t.Data,this.loadHistory(this.dataHistoryWorld,!1,this.scrollViewTrungGiai)):JFGameInfo.JFMain.layerPopup.showPopupMsg(t.Message)},_onCallBackGetDataHistorySelfOnline:function(t){JFGameInfo.JFMain.hideLoading(),1===(t=JSON.parse(t)).Result?(this.dataHistorySelf=t.Data,this.loadHistory(this.dataHistorySelf,!0,this.scrollViewLichSu)):JFGameInfo.JFMain.layerPopup.showPopupMsg(t.Message)},loadHistory:function(t,e,i){for(var n=i.getChildByName("item");n;)i.removeChild(n,!0),n=i.getChildByName("item");for(var s=t.length,r=1,o=(n=18*(s+1))<174?174:n,a=0;a<s;a++)(n=new JFItemMiniGameHistory).setName("item"),e?n.initObj(JFGameInfo.myInfo.Nickname,t[a].Description,t[a].CreateDate,a):n.initObj(t[a].DisplayName,t[a].Description,t[a].CreateDate,a),n.setAnchorPoint(cc.p(-.5,-.5)),i.addChild(n),n.setPositionY(o-18*r),n.setPositionX(136),r++;i.setInnerContainerSize(cc.size(305,o))},_onCallBackGetDataUserSpinOnline:function(t){JFGameInfo.JFMain.hideLoading(),1===(t=JSON.parse(t)).Result?(this.luotQuay.setString(this.Code.toString()),this._initAnimRotation(t.Data.Data.IdRotate,t.Data.Data.Description),this.popUpMsg=t.Data.Data.DescriptionFull,this._getDataOnline("InfoUserEvent",this._onCallBackGetDataInfoUserOnline.bind(this))):JFGameInfo.JFMain.layerPopup.showPopupMsg(t.Message)},_initAnimRotation:function(t,e){var i=30*(t-1-this._lastIDResult);0<=i?i=360-i:i*=-1,i=cc.rotateBy(6,3600+i+10).easing(cc.easeInOut(2)),this.vongQuay.runAction(cc.sequence(cc.rotateBy(.5,-10),i,cc.callFunc(this._onAnimationEnded.bind(this,e)))),this._lastIDResult=t-1,jf.audio.pauseMusic(),cc.audioEngine.playEffect(ResourceManager.JFResourcesMenuGame.NhacQuay,!1)},_onAnimationEnded:function(t){cc.audioEngine.playEffect(ResourceManager.JFResourcesMenuGame.NhanThuong,!1),this.nodeMask.setVisible(!0),this.txtResult.setString(t),this._getDataOnline("CurrentHu",this._onCallBackGetDataJackpotOnline.bind(this)),this._checkAutoRoll(),this._getDataOnline("TopUserWin",this._onCallBackGetDataTopUserOnline.bind(this)),this._getDataOnline("TopUserWinByUser",this._onCallBackGetDataHistorySelfOnline.bind(this))},_checkAutoRoll:function(){!0===this.checkBoxAuto.isSelected()&&0<this.Code?this.scheduleOnce(function(){this.nodeMask.setVisible(!1),this.btnQuay.setEnabled(!1),this.btnQuay.setBright(!1),this._getDataOnline("UserSpin",this._onCallBackGetDataUserSpinOnline.bind(this))},.3):!1===this.checkBoxAuto.isSelected()&&(JFGameInfo.JFMain.layerPopup.showPopupMsg(this.popUpMsg),this.btnQuay.setEnabled(!0),this.btnQuay.setBright(!0))}}),JFEventVongQuaySeason=JFUIBaseLayer.extend({vongQuay:null,_lastIDResult:null,ListItems:[],txtListItems:[],luotQuay:null,nodeMask:null,btnQuay:null,checkBoxAuto:null,btnTheLe:null,btnUserWin:null,btnLichSu:null,leftContent:null,txtTheLe:null,scrollViewLichSu:null,scrollViewTrungGiai:null,line:null,txtResult:null,Code:null,dataHistoryWorld:null,dataHistorySelf:null,popUpMsg:null,eventCode:null,ctor:function(){JFUIBaseLayer.prototype.ctor.call(this)},initObj:function(t){this._initFromCocostudio(ResourceManager.JFResourcesMenuGame.CCSPopupVongQuaySeason_json),this.eventCode=t,this.luotQuay=this._mainLayer.getChildByName("JFTxtLuotQuay"),this.vongQuay=this._mainLayer.getChildByName("JFVongQuay"),this.nodeMask=this._mainLayer.getChildByName("JFMask"),this.nodeMask.setVisible(!1),this.checkBoxAuto=this._mainLayer.getChildByName("JFCheckboxTuQuay"),this.btnQuay=this._mainLayer.getChildByName("JFButtonQuay"),this.btnTheLe=this._mainLayer.getChildByName("JFButtonTheLe"),this.btnUserWin=this._mainLayer.getChildByName("JFButtonTrungGiai"),this.btnLichSu=this._mainLayer.getChildByName("JFButtonLichSu"),this.leftContent=this._mainLayer.getChildByName("JFLeftContent"),this.txtTheLe=this.leftContent.getChildByName("JFTxtTheLe"),this.scrollViewLichSu=this.leftContent.getChildByName("JFScrollViewLichSu"),this.scrollViewLichSu.setVisible(!1),this.scrollViewTrungGiai=this.leftContent.getChildByName("JFScrollViewTrungGiai"),this.scrollViewTrungGiai.setVisible(!1),this.txtResult=this._mainLayer.getChildByName("JFTxtKetQua"),this.txtResult.setString(""),this.line=this.leftContent.getChildByName("JFBGListView"),this._getDataOnline("LoadEvent",this._onCallBackLoadMiniGameVongQuaySeason.bind(this))},onclose:function(){JFGameInfo.CurrentLayer=ConstantsVariable.LAYERS.MENU_LAYER_ROOMS,JFGameInfo.JFMain.layerMiniGame.deleteVongQuaySeason(),JFGameInfo.JFMain.layerMiniGame.hide()},_initItemsTxt:function(){for(var t=0;t<8;t++)this.txtListItems[t]=this._mainLayer.getChildByName("JFVongQuay").getChildByName("JFTxtItem"+(t+1)),this.txtListItems[t].setString(this._dataListItem[t].Description),"100 Triệu Xu"===this._dataListItem[t].Description&&(this._dataListItem[t].Color="#45ff2a"),this._dataListItem[t].Color&&(this.txtListItems[t].color=cc.hexToColor(this._dataListItem[t].Color))},_initItemsIcon:function(){for(var t=0;t<8;t++)this.ListItems[t]=this._mainLayer.getChildByName("JFVongQuay").getChildByName("JFItem"+(t+1)),cc.loader.loadImg(this._dataListItem[t].Image,{isCrossOrigin:!0},this._onLoadIconComplete.bind(this,this.ListItems[t]))},_onLoadIconComplete:function(t,e,i){e?Utilities.showLog("loadImage error"):(t.removeAllChildren(),i&&(e=new cc.Sprite(i),t.addChild(e)))},onClickBtnFromCocostudio:function(t,e){switch(t.getName()){case"JFButtonClose":cc.audioEngine.playEffect(ResourceManager.JFResourcesMenuGame.SoundClose,!1),this.onclose();break;case"JFButtonQuay":cc.audioEngine.playEffect(ResourceManager.JFResourcesMenuGame.ClickQuay,!1),0<this.Code?(this.nodeMask.setVisible(!1),this.btnQuay.setEnabled(!1),this.btnQuay.setBright(!1),this._getDataOnline("UserSpin",this._onCallBackGetDataUserSpinOnline.bind(this))):JFGameInfo.JFMain.layerPopup.showPopupMsg("Không đủ vé!");break;case"JFButtonTheLe":cc.audioEngine.playEffect(ResourceManager.JFResourcesMenuGame.SoundClose,!1),this.btnTheLe.setEnabled(!1),this.btnTheLe.setBright(!1),this.btnUserWin.setEnabled(!0),this.btnUserWin.setBright(!0),this.btnLichSu.setEnabled(!0),this.btnLichSu.setBright(!0),this.scrollViewLichSu.setVisible(!1),this.scrollViewTrungGiai.setVisible(!1),this.txtTheLe.setVisible(!0),this.line.setVisible(!1);break;case"JFButtonTrungGiai":cc.audioEngine.playEffect(ResourceManager.JFResourcesMenuGame.SoundClose,!1),this.btnTheLe.setEnabled(!0),this.btnTheLe.setBright(!0),this.btnUserWin.setEnabled(!1),this.btnUserWin.setBright(!1),this.btnLichSu.setEnabled(!0),this.btnLichSu.setBright(!0),this.scrollViewTrungGiai.setVisible(!0),this.scrollViewLichSu.setVisible(!1),this.txtTheLe.setVisible(!1),this.line.setVisible(!0);break;case"JFButtonLichSu":cc.audioEngine.playEffect(ResourceManager.JFResourcesMenuGame.SoundClose,!1),this.btnTheLe.setEnabled(!0),this.btnTheLe.setBright(!0),this.btnUserWin.setEnabled(!0),this.btnUserWin.setBright(!0),this.btnLichSu.setEnabled(!1),this.btnLichSu.setBright(!1),this.scrollViewLichSu.setVisible(!0),this.scrollViewTrungGiai.setVisible(!1),this.txtTheLe.setVisible(!1),this.line.setVisible(!0)}},_getDataOnline:function(t,e){JFGameInfo.JFMain.showLoading();var i={};i.EventCode=this.eventCode,i.UserID=JFGameInfo.myInfo.UserID,i.PlatformID=JFGameInfo.myPlatform,i.AppVersion=JFGameInfo.AppVersion,i.HardwareID=JFGameInfo.devineID,i.packetName=JFGameInfo.packetName,i.VersionDevice=JFGameInfo.VersionDevice,i.DeviceModel=JFGameInfo.DeviceModel,i.ChannelId=JFGameInfo.ChannelID,i.Sign=md5.encscript(t+i.EventCode+i.UserID+i.PlatformID+i.AppVersion+i.HardwareID+i.ChannelId+i.VersionDevice+i.DeviceModel+i.packetName+JFGameInfo.myInfo.token4Ws),cc.sys.isNative?Utilities.getAPI(t,i,e.bind(this)):Utilities.getAPIWeb(t,i,e.bind(this))},_onCallBackLoadMiniGameVongQuaySeason:function(t){JFGameInfo.JFMain.hideLoading(),1===(t=JSON.parse(t)).Result?(this._dataListItem=t.Data.ListItem,this._initItemsTxt(),this._initItemsIcon(),this.Code=t.Data.InfoUser.Code,this.luotQuay.setString(t.Data.InfoUser.Code),this.dataHistoryWorld=t.Data.TopWin,this.loadHistory(this.dataHistoryWorld,!1,this.scrollViewTrungGiai),this.dataHistorySelf=t.Data.TopWinUser,this.loadHistory(this.dataHistorySelf,!0,this.scrollViewLichSu),this.txtTheLe.setString(t.Data.ArticleEvent),JFGameInfo.JFMain.hideLoading()):JFGameInfo.JFMain.layerPopup.showPopupMsg(t.Message)},_onCallBackGetDataInfoUserOnline:function(t){JFGameInfo.JFMain.hideLoading(),1===(t=JSON.parse(t)).Result?(this.Code=t.Data.Code,this.luotQuay.setString(t.Data.Code)):JFGameInfo.JFMain.layerPopup.showPopupMsg(t.Message)},_onCallBackGetDataTopUserOnline:function(t){JFGameInfo.JFMain.hideLoading(),1===(t=JSON.parse(t)).Result?(this.dataHistoryWorld=t.Data,this.loadHistory(this.dataHistoryWorld,!1,this.scrollViewTrungGiai)):JFGameInfo.JFMain.layerPopup.showPopupMsg(t.Message)},_onCallBackGetDataHistorySelfOnline:function(t){JFGameInfo.JFMain.hideLoading(),1===(t=JSON.parse(t)).Result?(this.dataHistorySelf=t.Data,this.loadHistory(this.dataHistorySelf,!0,this.scrollViewLichSu)):JFGameInfo.JFMain.layerPopup.showPopupMsg(t.Message)},loadHistory:function(t,e,i){for(var n=i.getChildByName("item");n;)i.removeChild(n,!0),n=i.getChildByName("item");for(var s=t.length,r=1,o=(n=18*(s+1))<174?174:n,a=0;a<s;a++){(n=new JFItemMiniGameHistory).setName("item");var c="";(c=e?JFGameInfo.myInfo.Nickname:t[a].DisplayName).length>ConstantsVariable.NAME_MAX_SHOW_LENGTH&&(c=c.substr(0,ConstantsVariable.NAME_MAX_SHOW_LENGTH)+"..."),n.initObj(c,t[a].Description,t[a].CreateDate,a),n.setAnchorPoint(cc.p(-.5,-.5)),i.addChild(n),n.setPositionY(o-18*r),n.setPositionX(136),r++}i.setInnerContainerSize(cc.size(305,o))},_onCallBackGetDataUserSpinOnline:function(t){JFGameInfo.JFMain.hideLoading(),1===(t=JSON.parse(t)).Result?(this.luotQuay.setString(this.Code.toString()),this._initAnimRotation(t.Data.Data.IdRotate,t.Data.Data.Description),this.popUpMsg=t.Data.Data.DescriptionFull,this._getDataOnline("InfoUserEvent",this._onCallBackGetDataInfoUserOnline.bind(this))):JFGameInfo.JFMain.layerPopup.showPopupMsg(t.Message)},_initAnimRotation:function(t,e){var i=0,n=(null===this._lastIDResult&&(this._lastIDResult=0,i=22.5),45*(t-1-this._lastIDResult));0<=n?n=360-n:n*=-1,i=cc.rotateBy(6,3600+n+10-i).easing(cc.easeInOut(2)),this.vongQuay.runAction(cc.sequence(cc.rotateBy(.5,-10),i,cc.callFunc(this._onAnimationEnded.bind(this,e)))),this._lastIDResult=t-1,jf.audio.pauseMusic(),cc.audioEngine.playEffect(ResourceManager.JFResourcesMenuGame.NhacQuay,!1)},_onAnimationEnded:function(t){cc.audioEngine.playEffect(ResourceManager.JFResourcesMenuGame.NhanThuong,!1),this.nodeMask.setVisible(!0),this.txtResult.setString(t),this._checkAutoRoll(),this._getDataOnline("TopUserWin",this._onCallBackGetDataTopUserOnline.bind(this)),this._getDataOnline("TopUserWinByUser",this._onCallBackGetDataHistorySelfOnline.bind(this))},_checkAutoRoll:function(){this.checkBoxAuto.isSelected()&&0<this.Code?this.scheduleOnce(function(){this.nodeMask.setVisible(!1),this.btnQuay.setEnabled(!1),this.btnQuay.setBright(!1),this._getDataOnline("UserSpin",this._onCallBackGetDataUserSpinOnline.bind(this))},.3):this.checkBoxAuto.isSelected()||(JFGameInfo.JFMain.layerPopup.showPopupMsg(this.popUpMsg),this.btnQuay.setEnabled(!0),this.btnQuay.setBright(!0))}}),JFUIBaseLayer.extend({netSend:null,compoChat:null,compoChoseBet:null,popupLichSu:null,popupThongKe:null,popupXepHang:null,gameInfo:null,txtTotalBetTai:null,txtTotalBetXiu:null,txtMyBetTai:null,txtMyBetXiu:null,txtMatchID:null,txtCoin:null,txtNumUserTai:null,txtNumUserXiu:null,compoPlate:null,btnBetTai:null,btnBetXiu:null,isDisposed:!1,ctor:function(){JFUIBaseLayer.prototype.ctor.call(this)},initObj:function(){this._initFromCocostudio(ResourceManager.JFResourcesMenuGame.CSSUIMiniTaiXiuLayer),this.gameInfo=new JFTaiXiuInfo,this.gameInfo.MyID=JFGameInfo.myInfo.UserID,JFGameInfo.JFMain.layerMiniGame.show(),JFGameInfo.JFMain.hideLoading(),this.netSend=JFGameInfo.JFMain.layerMiniGame.netSend,this.isDisposed=!1,this.initTextValue(),this.initCompoPlate(),this.initEvent(),this.initCompoChat(),this.initCompoChoseBet(),this.setLocalZOrder(50)},initTextValue:function(){this.txtTotalBetTai=this._mainLayer.getChildByName("JFTotalBetTai"),this.txtTotalBetXiu=this._mainLayer.getChildByName("JFTotalBetXiu"),this.txtMyBetTai=this._mainLayer.getChildByName("JFTxtMyBetTai"),this.txtMyBetXiu=this._mainLayer.getChildByName("JFTxtMyBetXiu"),this.txtMatchID=this._mainLayer.getChildByName("JFTxtMatchID"),this.txtCoin=this._mainLayer.getChildByName("JFTxtCoin"),this.txtNumUserTai=this._mainLayer.getChildByName("JFTxtUserTai"),this.txtNumUserXiu=this._mainLayer.getChildByName("JFTxtUserXiu"),this.btnBetTai=this._mainLayer.getChildByName("JFButtonBetTai"),this.btnBetXiu=this._mainLayer.getChildByName("JFButtonBetXiu")},initCompoPlate:function(){this.compoPlate=new JFCompoPlate(this),this.compoPlate.initObj()},initEvent:function(){this.listEvents=[],this.listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_TAI_XIU.GAME_INFO.toString(),this.ngGameInfo.bind(this))),this.listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_TAI_XIU.ErrorMessage.toString(),this.ngGameError.bind(this))),this.listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_TAI_XIU.StartMatch.toString(),this.ngGameStart.bind(this))),this.listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_TAI_XIU.EndMatch.toString(),this.ngGameEndMatch.bind(this))),this.listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_TAI_XIU.UserBet.toString(),this.ngGameUserBet.bind(this))),this.listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_TAI_XIU.ChangeCoin.toString(),this.ngChangeCoin.bind(this))),this.listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_TAI_XIU.UpdateValueBet.toString(),this.ngUpdateValueBet.bind(this))),this.listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.ErorConnect,this.errorConnect.bind(this)))},initCompoChat:function(){this.compoChat=new JFCompoChat(this.netSend),this._mainLayer.getChildByName("JFLeftNode").addChild(this.compoChat),this.compoChat.initObj()},initCompoChoseBet:function(){this.compoChoseBet=new JFCompoChoseBet(this.netSend,this.gameInfo),this._mainLayer.getChildByName("JFLeftNode").addChild(this.compoChoseBet),this.compoChoseBet.initObj()},ngGameInfo:function(t){if(!this.isDisposed){t=t.getUserData();var e={Gold:BinaryConstants.DataTypeID.UInt64,MatchID:BinaryConstants.DataTypeID.UInt32,State:BinaryConstants.DataTypeID.UInt8,TimeCountdown:BinaryConstants.DataTypeID.UInt32,Result:BinaryConstants.DataTypeID.Array8,Result_Type:BinaryConstants.DataTypeID.UInt8,MyBetTai:BinaryConstants.DataTypeID.UInt64,MyBetXiu:BinaryConstants.DataTypeID.UInt64,TotalTai:BinaryConstants.DataTypeID.UInt64,NumberUserBetTai:BinaryConstants.DataTypeID.UInt32,TotalXiu:BinaryConstants.DataTypeID.UInt64,NumberUserBetXiu:BinaryConstants.DataTypeID.UInt32,BetValueList:BinaryConstants.DataTypeID.Array8,BetValueList_Type:BinaryConstants.DataTypeID.UInt64,MinBet:BinaryConstants.DataTypeID.UInt64,MaxBet:BinaryConstants.DataTypeID.UInt64};switch(t=(new BinaryParser).init(e,t.content),this.gameInfo.myCoin=t.Gold,this.gameInfo.matchID=t.MatchID,this.gameInfo.myBetTai=t.MyBetTai,this.gameInfo.myBetXiu=t.MyBetXiu,this.gameInfo.totalBetTai=t.TotalTai,this.gameInfo.totalBetXiu=t.TotalXiu,this.gameInfo.numUserTai=t.NumberUserBetTai,this.gameInfo.numUserXiu=t.NumberUserBetXiu,this.gameInfo.maxBet=t.MaxBet,this.gameInfo.minBet=t.MinBet,this.compoChoseBet.updateListBet(t.BetValueList),this.gameInfo.currentState=t.State,t.State){case JFTaiXiuInfo.STATE.PREPARE:this.compoPlate.playTimeOpen(t.TimeCountdown),this.setButtonBetEnable(!1);break;case JFTaiXiuInfo.STATE.BET:this.compoPlate.playTimeOpen(t.TimeCountdown),this.setButtonBetEnable(!0);break;case JFTaiXiuInfo.STATE.END_MATCH:this.compoPlate.playTimeNewMatch(t.TimeCountdown),this.compoPlate.showDice(t.Result),this.setButtonBetEnable(!1)}this.updateGameInfo(),JFGameInfo.JFMain.pushFirebaseJoinRoomSuccess("TaiXiu")}},ngGameError:function(t){t=t.getUserData();var e={Msg:BinaryConstants.DataTypeID.StringDynamic};t=(new BinaryParser).init(e,t.content),JFGameInfo.JFMain.layerPopup.showPopupMsg(t.Msg)},ngGameStart:function(t){var e;this.isDisposed||(t=t.getUserData(),e={MatchID:BinaryConstants.DataTypeID.UInt32,State:BinaryConstants.DataTypeID.UInt8,TimeCountdown:BinaryConstants.DataTypeID.UInt32},t=(new BinaryParser).init(e,t.content),this.gameInfo.resetForNewMatch(),this.gameInfo.matchID=t.MatchID,this.gameInfo.currentState=t.State,this.compoPlate.playTimeOpen(t.TimeCountdown),this.compoPlate.hideAllDice(),this.gameInfo.lockBet=!1,this.updateGameInfo(),this.setButtonBetEnable(!0))},ngGameEndMatch:function(t){var e;this.isDisposed||(t=t.getUserData(),e={State:BinaryConstants.DataTypeID.UInt8,TimeCountDown:BinaryConstants.DataTypeID.UInt32,Result:BinaryConstants.DataTypeID.Array8,Result_Type:BinaryConstants.DataTypeID.UInt8,GoldUserWin:BinaryConstants.DataTypeID.UInt64,TotalUserGold:BinaryConstants.DataTypeID.UInt64},t=(new BinaryParser).init(e,t.content),this.gameInfo.currentState=t.State,this.gameInfo.myCoin=t.TotalUserGold,this.gameInfo.sumDice=t.Result[0]+t.Result[1]+t.Result[2],this.compoPlate.resultEndMatch(t),this.compoChoseBet.disableButton(),this.setButtonBetEnable(!1),Utilities.showLog("ngGameEndMatch "+JSON.stringify(t)))},ngGameUserBet:function(t){var e;this.isDisposed||(t=t.getUserData(),e={UserID:BinaryConstants.DataTypeID.UInt32,BetID:BinaryConstants.DataTypeID.UInt8,GoldBet:BinaryConstants.DataTypeID.UInt64,TotalBet:BinaryConstants.DataTypeID.UInt64,NumberUserBet:BinaryConstants.DataTypeID.UInt32},t=(new BinaryParser).init(e,t.content),Utilities.showLog("ngGameUserBet "+JSON.stringify(t)),t.BetID==JFTaiXiuInfo.BET_ID.TAI?(t.UserID==this.gameInfo.MyID&&(this.gameInfo.myBetTai+=t.GoldBet,this.compoChoseBet.disableButton(),this.gameInfo.myCoin-=t.GoldBet),this.gameInfo.totalBetTai=t.TotalBet,this.gameInfo.numUserTai=t.NumberUserBet):(t.UserID==this.gameInfo.MyID&&(this.gameInfo.myBetXiu+=t.GoldBet,this.compoChoseBet.disableButton(),this.gameInfo.myCoin-=t.GoldBet),this.gameInfo.totalBetXiu=t.TotalBet,this.gameInfo.numUserXiu=t.NumberUserBet),this.updateGameInfo(),this.updateMyCoin())},onClickBtnFromCocostudio:function(t,e){switch(t.getName()){case"JFButtonClose":this.compoPlate.hideAllDice(),this.compoPlate.clearTime(),this.disposeMG(),cc.audioEngine.playEffect(ResourceManager.JFResourcesMenuGame.SoundClose,!1),this.onclose();break;case"JFButtonChat":this.compoChat.show(),this.compoChoseBet.hide();break;case"JFButtonBetTai":this.compoChoseBet.show(JFTaiXiuInfo.BET_ID.TAI),this.compoChat.hide();break;case"JFButtonBetXiu":this.compoChoseBet.show(JFTaiXiuInfo.BET_ID.XIU),this.compoChat.hide();break;case"JFButtonXepHang":JFGameInfo.JFMain.layerPopup.showPopupXepHangTaiXiu(this.gameInfo,this.netSend),this.compoChat.hide();break;case"JFButtonThongTin":JFGameInfo.JFMain.layerPopup.showPopupLichSuTaiXiu(this.gameInfo,this.netSend),this.compoChat.hide();break;case"JFButtonThongKe":JFGameInfo.JFMain.layerPopup.showPopupThongKeTaiXiu(this.gameInfo,this.netSend),this.compoChat.hide();break;case"JFButtonHuongDan":JFGameInfo.JFMain.layerPopup.showPopupHuongDanTaiXiu(),this.compoChat.hide()}},updateGameInfo:function(){this.txtMatchID.setString("#"+this.gameInfo.matchID),this.txtNumUserTai.setString("("+this.gameInfo.numUserTai+")"),this.txtNumUserXiu.setString("("+this.gameInfo.numUserXiu+")"),this.txtTotalBetTai.setString(Utilities.Coin(this.gameInfo.totalBetTai)),this.txtTotalBetXiu.setString(Utilities.Coin(this.gameInfo.totalBetXiu)),this.txtMyBetTai.setString(Utilities.Coin(this.gameInfo.myBetTai)),this.txtMyBetXiu.setString(Utilities.Coin(this.gameInfo.myBetXiu)),this.updateMyCoin()},setButtonBetEnable:function(t){this.btnBetTai.setEnabled(t),this.btnBetXiu.setEnabled(t),this.btnBetXiu.setBright(t),this.btnBetTai.setBright(t)},ngChangeCoin:function(t){t=t.getUserData();var e={Gold:BinaryConstants.DataTypeID.UInt64};t=(new BinaryParser).init(e,t.content),this.gameInfo.myCoin=t.Gold,this.updateMyCoin()},updateMyCoin:function(){this.txtCoin.setString(Utilities.Coin(this.gameInfo.myCoin)),JFGameInfo.myInfo.Gold=this.gameInfo.myCoin,cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.MENU_LAYER_UPDATE_USER.toString())},ngUpdateValueBet:function(t){var e;this.isDisposed||(t=t.getUserData(),e={MinBet:BinaryConstants.DataTypeID.UInt64,MaxBet:BinaryConstants.DataTypeID.UInt64,BetValueList:BinaryConstants.DataTypeID.Array8,BetValueList_Type:BinaryConstants.DataTypeID.UInt64},t=(new BinaryParser).init(e,t.content),this.gameInfo.maxBet=t.MaxBet,this.gameInfo.minBet=t.MinBet,this.compoChoseBet.updateListBet(t.BetValueList),Utilities.showLog("ngUpdateValueBet "+JSON.stringify(t)))},errorConnect:function(t){this.onclose(),JFGameInfo.JFMain.hideLoading(),JFGameInfo.JFMain.layerPopup.showPopupMsg("Không kết nối được máy chủ.")},onclose:function(){if(JFGameInfo.CurrentLayer=ConstantsVariable.LAYERS.MENU_LAYER_ROOMS,JFGameInfo.JFMain.layerMiniGame.deleteTaiXiuGame(),JFGameInfo.JFMain.layerMiniGame.hide(),this._listEvents)for(var t=0;t<this._listEvents.length;t++)cc.eventManager.removeListener(this._listEvents[t])},disposeMG:function(){this.compoChat&&(this.compoChat.removeFromParent(!0),this.compoChat=null),this.compoPlate=null,this.compoChoseBet.removeFromParent(!0),this.btnBetXiu=this.btnBetTai=this.txtNumUserXiu=this.txtNumUserTai=this.txtCoin=this.txtMatchID=this.txtMyBetXiu=this.txtMyBetTai=this.txtTotalBetXiu=this.txtTotalBetTai=this.gameInfo=this.compoChoseBet=null,this.isDisposed=!0,this.removeAllChildren(!0)}})),JFTaiXiuInfo=cc.Class.extend({MyID:0,maxBet:0,minBet:0,myBetTai:0,myBetXiu:0,totalBetTai:0,totalBetXiu:0,lastBetTai:0,lastBetXiu:0,matchID:0,myCoin:0,numUserTai:0,numUserXiu:0,currentState:1,currentTime:0,sumDice:0,listResultBotton:null,thongKeTongDiem:null,thongKeTongVanTai:0,thongKeTongVanXiu:0,thongKeTaiXiu:null,thongKeTongTai:0,thongKeTongXiu:0,lockBet:!1,ctor:function(){this.listResultBotton=[],this.thongKeTongDiem=[],this.thongKeTaiXiu=[]},resetForNewMatch:function(){this.lastBetTai=this.myBetTai,this.lastBetXiu=this.myBetXiu,this.numUserXiu=this.numUserTai=this.totalBetXiu=this.totalBetTai=this.myBetXiu=this.myBetTai=0},addThongKeTaiXiu:function(t,e){var i={};i.Dices=t,i.Sum=this.sumDice,i.IsTai=e,this.thongKeTaiXiu.length<120||(this.thongKeTaiXiu.shift().IsTai?this.thongKeTongTai--:this.thongKeTongXiu--),this.thongKeTaiXiu.push(i),e?this.thongKeTongTai++:this.thongKeTongXiu++},addThongKeTongDiem:function(t){var e=this.thongKeTongDiem.length;0==e?this.thongKeTongDiem.push([t]):10<t?10<this.thongKeTongDiem[e-1][0]?(this.thongKeTongDiem[e-1].length<6||this.thongKeTongDiem[e-1].shift(),this.thongKeTongDiem[e-1].push(t)):(this.thongKeTongDiem.length<20||this.thongKeTongDiem.shift(),this.thongKeTongDiem.push([t])):this.thongKeTongDiem[e-1][0]<11?(this.thongKeTongDiem[e-1].length<6||this.thongKeTongDiem[e-1].shift(),this.thongKeTongDiem[e-1].push(t)):(this.thongKeTongDiem.length<20||this.thongKeTongDiem.shift(),this.thongKeTongDiem.push([t]))},getBetName:function(t){return t==JFTaiXiuInfo.BET_ID.TAI?"Tài":"Xỉu"}}),JFMiniTaiXiuNetSend=(JFTaiXiuInfo.BET_ID={XIU:0,TAI:1},JFTaiXiuInfo.STATE={PREPARE:1,BET:2,END_MATCH:3},JFNetSend.extend({ctor:function(){JFNetSend.prototype.ctor.call(this)},sendLoginGame:function(t){var e={};e.Token=t,t=Message.build(ConstantsVariable.NETWORK_TAI_XIU.LOGIN,{Token:BinaryConstants.DataTypeID.StringDynamic},e),JFNetCore.JFGameSocket.sendMsg(t)},sendChat:function(t){var e={};e.Message=t,t=Message.build(ConstantsVariable.NETWORK_TAI_XIU.Chat,{Message:BinaryConstants.DataTypeID.StringDynamic},e),JFNetCore.JFGameSocket.sendMsg(t)},sendBetTaiXiu:function(t,e){var i={};i.BetID=t,i.GoldBet=e,i=Message.build(ConstantsVariable.NETWORK_TAI_XIU.UserBet,{BetID:BinaryConstants.DataTypeID.UInt8,GoldBet:BinaryConstants.DataTypeID.UInt64},i),JFNetCore.JFGameSocket.sendMsg(i)},getHistoryXepHangTaiXiuInfo:function(){var t=Message.build(ConstantsVariable.NETWORK_TAI_XIU.TopRank,null,null);JFNetCore.JFGameSocket.sendMsg(t)},getHistoryThongKeTaiXiuInfo:function(){var t=Message.build(ConstantsVariable.NETWORK_TAI_XIU.ResultHistory,null,null);JFNetCore.JFGameSocket.sendMsg(t)},getHistoryBetTaiXiuInfo:function(){var t=Message.build(ConstantsVariable.NETWORK_TAI_XIU.BetHistory,null,null);JFNetCore.JFGameSocket.sendMsg(t)}})),JFCompoChat=JFUIBaseNode.extend({listView:null,netSend:null,txtInput:null,lockChat:!1,listEvents:null,ctor:function(t){JFUIBaseNode.prototype.ctor.call(this),this.netSend=t},initObj:function(){this._initFromCocostudio(ResourceManager.JFResourcesMenuGame.CSSJFChatNode),this.listView=this._mainLayer.getChildByName("JFListView"),this.txtInput=new MGBaseEditBox(this._mainLayer.getChildByName("JFTxtInput"),"TXBgTxt.png"),this._mainLayer.addChild(this.txtInput),this.txtInput.setDelegate(this),this.initEvent(),this.hide()},initEvent:function(){this.listEvents=[],this.listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_TAI_XIU.Chat.toString(),this.ngOnChat.bind(this)))},onClickBtnFromCocostudio:function(t,e){switch(t.getName()){case"JFButtonHideLeft":this.setVisible(!1);break;case"JFButtonSend":this.onSendChat()}},onSendChat:function(){var t=this.txtInput.getString();""!=t&&this.netSend.sendChat(t)},ngOnChat:function(t){t=t.getUserData();var e={UserID:BinaryConstants.DataTypeID.UInt32,Nickname:BinaryConstants.DataTypeID.StringDynamic,Message:BinaryConstants.DataTypeID.StringDynamic};t=(new BinaryParser).init(e,t.content),this.addChat(t.Nickname+":",t.Message),JFGameInfo.myInfo.UserID===t.UserID&&this.txtInput.setString(""),this.txtInput.setFocus()},addChat:function(t,e){var i,n,s;cc.sys.isNative?(i=new ccui.RichText,n=new ccui.RichElementText(1,cc.color(210,126,253,255),255,t,"Arial",13),s=new ccui.RichElementText(2,cc.color.WHITE,255,e,"Arial",13),i.ignoreContentAdaptWithSize(!0),i.pushBackElement(n),i.pushBackElement(s),i.formatText(),n=i.width,i.ignoreContentAdaptWithSize(!1),n=15*Math.ceil(n/210)+2,i.setContentSize(210,n),i.setWrapMode(1)):(i=new ccui.RichText,n=new ccui.RichElementText(1,cc.color(210,126,253,255),255,t,"Arial",13),s=new ccui.RichElementText(2,cc.color.WHITE,255,e,"Arial",13),i.pushBackElement(n),i.pushBackElement(s),n=15*Math.ceil(i.width/210)+2,i.width=210,i.height=n,i.ignoreContentAdaptWithSize(!1)),this.listView.pushBackCustomItem(i)},editBoxReturn:function(t){this.lockChat?this.addChat("","Bạn chat quá nhanh!"):(this.onSendChat(),this.lockChat=!0,setTimeout(this.timerEnableChat.bind(this),2500))},timerEnableChat:function(){this.lockChat=!1,this.txtInput.setFocus()},show:function(){this.setVisible(!0),this.txtInput.setVisible(!0)},hide:function(){this.setVisible(!1),this.txtInput.setVisible(!1)}}),JFCompoChoseBet=JFUIBaseNode.extend({netSend:null,betID:null,gameInfo:null,txtRebet:null,txtDoubleBet:null,btnRebet:null,btnDoubleBet:null,ctor:function(t,e){JFUIBaseNode.prototype.ctor.call(this),this.netSend=t,this.gameInfo=e},initObj:function(){this._initFromCocostudio(ResourceManager.JFResourcesMenuGame.CSSJFChoseBetNode),this.setVisible(!1),this.txtRebet=this._mainLayer.getChildByName("JFTxtReBet"),this.txtDoubleBet=this._mainLayer.getChildByName("JFTxtDoubleBet"),this.btnRebet=this._mainLayer.getChildByName("JFButtonRebet"),this.btnDoubleBet=this._mainLayer.getChildByName("JFButtonDouble"),this.disableButton()},onClickBtnFromCocostudio:function(t,e){t.value&&0<t.value?this.userBet(t.value):"JFButtonHideLeft"===t.getName()&&this.setVisible(!1)},updateListBet:function(t){for(var e=0;e<8;e++)this._mainLayer.getChildByName("JFTxtBet"+e).setString(Utilities.CoinStr(t[e])),this._mainLayer.getChildByName("JFButtonBet"+e).value=t[e]},getCoinName:function(t){return Utilities.Coin(t)},show:function(t){this.gameInfo.currentState!==JFTaiXiuInfo.STATE.BET||this.gameInfo.lockBet||(this.betID=t,this.setVisible(!0),this.setPosition(cc.p(500,-280)),this.betID===JFTaiXiuInfo.BET_ID.TAI?0==this.gameInfo.myBetTai?this.enableButton(this.gameInfo.lastBetTai):this.disableButton():0===this.gameInfo.myBetXiu?this.enableButton(this.gameInfo.lastBetXiu):this.disableButton())},hide:function(){this.setVisible(!1)},userBet:function(t){this.gameInfo.myCoin>=t?this.netSend.sendBetTaiXiu(this.betID,t):this.gameInfo.myCoin>=this.gameInfo.minBet?this.netSend.sendBetTaiXiu(this.betID,this.gameInfo.myCoin):JFGameInfo.JFMain.layerPopup.showPopupMsg("Không đủ tiền đặt cược!")},disableButton:function(){this.txtRebet.setString("0"),this.txtDoubleBet.setString("0"),this.btnRebet.setEnabled(!1),this.btnDoubleBet.setEnabled(!1),this.btnRebet.setBright(!1),this.btnDoubleBet.setBright(!1)},enableButton:function(t){var e;0<t?(e=Math.min(t,this.gameInfo.myCoin),t=Math.min(2*t,this.gameInfo.myCoin,this.gameInfo.maxBet),this.txtRebet.setString(Utilities.CoinStr(e)),this.txtDoubleBet.setString(Utilities.CoinStr(t)),this.btnRebet.setEnabled(!0),this.btnDoubleBet.setEnabled(!0),this.btnRebet.setBright(!0),this.btnDoubleBet.setBright(!0),this.btnRebet.value=e,this.btnDoubleBet.value=t):this.disableButton()}}),JFCompoPlate=cc.Class.extend({_mainLayer:null,mainGame:null,gameInfo:null,txtTimeOpen:null,txtTimeNewMatch:null,bgTimeNewMatch:null,intervalEvent:null,currentTextTime:null,dice1:null,dice2:null,dice3:null,timeOutShowResult:null,fxThang:null,fxDice:null,lblTai:null,lblXiu:null,listIconHistory:null,timeShake:1100,timeShowEffect:3e3,timeOutShowEffect:null,txtSumDice:null,curTime:null,lastTime:null,detalTime:null,txtEffectCoin:null,ctor:function(t){this.mainGame=t,this._mainLayer=t._mainLayer,this.gameInfo=this.mainGame.gameInfo},initObj:function(){this.bgTimeNewMatch=this._mainLayer.getChildByName("JFBackgroundTime"),this.txtTimeOpen=this._mainLayer.getChildByName("JFTxtTimeOpen"),this.txtTimeOpen.retain(),this.txtTimeNewMatch=this._mainLayer.getChildByName("JFTxtTimeNewMatch"),this.txtTimeNewMatch.retain(),this.txtSumDice=this._mainLayer.getChildByName("JFTxtSumDice"),this.lblTai=this._mainLayer.getChildByName("JFLblTai"),this.lblXiu=this._mainLayer.getChildByName("JFLblXiu"),this.dice1=this._mainLayer.getChildByName("JFDice1"),this.dice2=this._mainLayer.getChildByName("JFDice2"),this.dice3=this._mainLayer.getChildByName("JFDice3"),this.txtEffectCoin=this._mainLayer.getChildByName("JFTxtEffectCoin"),this.dice1.setScale(1.5),this.dice2.setScale(1.5),this.dice3.setScale(1.5),this.listIconHistory=this._mainLayer.getChildByName("JFPanelHistory").getChildren(),this.initEffect(),this.hideAllDice(),this.txtEffectCoin.setVisible(!1)},initEffect:function(){this.fxThang=new sp.SkeletonAnimation(ResourceManager.JFResourcesMenuGame.FXThangTaiXiu_JSON,ResourceManager.JFResourcesMenuGame.FXThangTaiXiu_ATLAS),this._mainLayer.addChild(this.fxThang),this.fxThang.setScale(2),this.fxThang.setPosition(this.txtTimeOpen.getPosition()),this.fxThang.setVisible(!1),this.fxDice=new sp.SkeletonAnimation(ResourceManager.JFResourcesMenuGame.FXDiceTaiXiu_JSON,ResourceManager.JFResourcesMenuGame.FXDiceTaiXiu_ATLAS),this._mainLayer.addChild(this.fxDice),this.fxDice.setPosition(this.txtTimeOpen.getPosition()),this.fxDice.setVisible(!1)},playTimeOpen:function(t){this.lastTime=this.curTime=(new Date).getTime(),this.detalTime=0,this.txtTimeOpen.setVisible(!0),this.txtTimeNewMatch.setVisible(!1),this.bgTimeNewMatch.setVisible(!0),this.gameInfo.currentTime=t/1e3,this.currentTextTime=this.txtTimeOpen,this.txtTimeOpen.setString(this.formatTime(this.gameInfo.currentTime)),this.txtTimeOpen.setColor(cc.color(255,255,255,255)),this.intervalEvent&&clearInterval(this.intervalEvent),this.intervalEvent=setInterval(this.onTimeTick.bind(this),1e3)},playTimeNewMatch:function(t){this.lastTime=this.curTime=(new Date).getTime(),this.detalTime=0,this.txtTimeOpen.setVisible(!1),this.gameInfo.currentTime=t/1e3,this.currentTextTime=this.txtTimeNewMatch,this.txtTimeNewMatch.setString(this.formatTime(this.gameInfo.currentTime)),this.intervalEvent&&clearInterval(this.intervalEvent),this.intervalEvent=setInterval(this.onTimeTick.bind(this),1e3)},onTimeTick:function(){this.curTime=(new Date).getTime(),this.detalTime+=this.curTime-this.lastTime-1e3,this.lastTime=this.curTime,1e3<this.detalTime?(this.gameInfo.currentTime--,this.gameInfo.currentTime-=parseInt(this.detalTime/1e3),this.detalTime%=1e3):this.gameInfo.currentTime--,this.gameInfo.currentTime<=0?(this.gameInfo.currentTime=0,clearInterval(this.intervalEvent),this.currentTextTime.setString(this.formatTime(0))):(this.currentTextTime.setString(this.formatTime(this.gameInfo.currentTime)),this.gameInfo.currentState===JFTaiXiuInfo.STATE.BET&&this.gameInfo.currentTime<6&&(this.currentTextTime.setColor(cc.color(255,0,0,255)),this.gameInfo.lockBet=!0,this.mainGame.compoChoseBet.hide(),this.mainGame.setButtonBetEnable(!1)))},formatTime:function(t){t=parseInt(t);var e=parseInt(t/60);return(9<e?e:"0"+e)+":"+(9<(t%=60)?t:"0"+t)},clearTime:function(){clearInterval(this.intervalEvent)},hideAllDice:function(){this.dice1.setVisible(!1),this.dice2.setVisible(!1),this.dice3.setVisible(!1),this.fxThang.setVisible(!1),this.lblTai.stopAllActions(),this.lblXiu.stopAllActions(),this.lblTai.setOpacity(255),this.lblXiu.setOpacity(255),this.txtEffectCoin.setVisible(!1)},showDice:function(t){3==t.length&&(this.dice1.loadTexture("Dice"+t[0]+".png",ccui.Widget.PLIST_TEXTURE),this.dice2.loadTexture("Dice"+t[1]+".png",ccui.Widget.PLIST_TEXTURE),this.dice3.loadTexture("Dice"+t[2]+".png",ccui.Widget.PLIST_TEXTURE),this.dice1.setVisible(!0),this.dice2.setVisible(!0),this.dice3.setVisible(!0))},resultEndMatch:function(t){this.fxDice.setAnimation(0,"Shaking",!1),this.fxDice.setVisible(!0),this.timeOutShowResult&&clearTimeout(this.timeOutShowResult),this.timeOutShowResult=setTimeout(this.showResult.bind(this,t),1100),this.playTimeNewMatch(t.TimeCountDown)},showResult:function(t){clearTimeout(this.timeOutShowResult),this.fxDice.setVisible(!1),this.txtSumDice.setString(this.gameInfo.sumDice),this.txtSumDice.setVisible(!0),this.bgTimeNewMatch.setVisible(!0),this.showDice(t.Result),this.timeOutShowEffect&&clearTimeout(this.timeOutShowEffect),this.timeOutShowEffect=setTimeout(this.showEffect.bind(this,t),this.timeShowEffect),this.gameInfo.addThongKeTongDiem(this.gameInfo.sumDice),10<this.gameInfo.sumDice?(this.gameInfo.addThongKeTaiXiu(t.Result,!0),this.lblTai.runAction(cc.sequence(cc.fadeIn(.2),cc.fadeOut(.2)).repeatForever()),this.addBottonHistory(JFTaiXiuInfo.BET_ID.TAI)):(this.gameInfo.addThongKeTaiXiu(t.Result,!1),this.lblXiu.runAction(cc.sequence(cc.fadeIn(.2),cc.fadeOut(.2)).repeatForever()),this.addBottonHistory(JFTaiXiuInfo.BET_ID.XIU)),this.mainGame.popupThongKe&&this.mainGame.popupThongKe.updateInfo()},showEffect:function(t){clearTimeout(this.timeOutShowEffect),0<t.GoldUserWin&&(this.fxThang.setAnimation(0,"thang",!1),this.fxThang.setVisible(!0),this.txtEffectCoin.setString("+"+Utilities.Coin(t.GoldUserWin.toString())),this.txtEffectCoin.setVisible(!0),this.txtEffectCoin.setPositionY(516),this.txtEffectCoin.setOpacity(255),this.txtEffectCoin.runAction(cc.spawn(cc.fadeOut(.7),cc.moveBy(.7,cc.p(0,60))))),this.txtTimeNewMatch.setVisible(!0),this.txtSumDice.setVisible(!1),this.mainGame.updateGameInfo()},addBottonHistory:function(t){var e;if(this.gameInfo.listResultBotton.length<15)this.gameInfo.listResultBotton.push(t),e=this.gameInfo.listResultBotton.length-1,t===JFTaiXiuInfo.BET_ID.TAI?this.listIconHistory[e].loadTexture(ResourceManager.JFResourcesMenuGame.Icon_Tai_png,ccui.Widget.LOCAL_TEXTURE):this.listIconHistory[e].loadTexture(ResourceManager.JFResourcesMenuGame.Icon_Xiu_png,ccui.Widget.LOCAL_TEXTURE),0<e&&(this.listIconHistory[e-1].stopAllActions(),this.listIconHistory[e-1].setPositionY(210)),this.listIconHistory[e].setVisible(!0);else{for(this.gameInfo.listResultBotton.shift(),this.gameInfo.listResultBotton.push(t),t=0,e=this.gameInfo.listResultBotton.length;t<e;t++)this.gameInfo.listResultBotton[t]===JFTaiXiuInfo.BET_ID.TAI?this.listIconHistory[t].loadTexture(ResourceManager.JFResourcesMenuGame.Icon_Tai_png,ccui.Widget.LOCAL_TEXTURE):this.listIconHistory[t].loadTexture(ResourceManager.JFResourcesMenuGame.Icon_Xiu_png,ccui.Widget.LOCAL_TEXTURE);this.listIconHistory[e-1].stopAllActions(),this.listIconHistory[e-2].stopAllActions(),this.listIconHistory[e-2].setPositionY(210)}this.listIconHistory[this.gameInfo.listResultBotton.length-1].setPositionY(210),this.listIconHistory[this.gameInfo.listResultBotton.length-1].runAction(cc.sequence(cc.moveBy(.2,cc.p(0,5)),cc.moveBy(.2,cc.p(0,-5)))).repeatForever()}}),JFItemHistoryBetTaiXiu=JFUIBaseLayer.extend({contentPanel:null,gameInfo:null,ctor:function(t){JFUIBaseLayer.prototype.ctor.call(this),this.gameInfo=t},initObj:function(){this._initFromCocostudio(ResourceManager.JFResourcesMenuGame.CSSJFItemLichSuNode),this.contentPanel=this._mainLayer.getChildByName("ContentPanel")},updateDate:function(t,e){this.contentPanel.getChildByName("JFTxtMatchID").setString(t.MatchID),1==e%2?this.contentPanel.getChildByName("JFBackground").setVisible(!1):this.contentPanel.getChildByName("JFBackground").setVisible(!0),this.contentPanel.getChildByName("JFTxtTime").setString(Utilities.ConvertTime(t.Time)),this.contentPanel.getChildByName("JFTxtBetName").setString(this.gameInfo.getBetName(t.BetID));e=t.Dices[0]+"-"+t.Dices[1]+"-"+t.Dices[2]+" "+(t.Dices[0]+t.Dices[1]+t.Dices[2]);this.contentPanel.getChildByName("JFTxtResult").setString(e),this.contentPanel.getChildByName("JFTxtBetCoin").setString(Utilities.Coin(t.GoldBet.toString())),this.contentPanel.getChildByName("JFTxtReward").setString(Utilities.Coin(t.Reward.toString()))},getContentPanel:function(){return this.contentPanel.removeFromParent(!0),this.contentPanel}}),JFPopupHuongDanTaiXiu=JFUIBaseLayer.extend({ctor:function(){JFUIBaseLayer.prototype.ctor.call(this),this.matchID=0,this.listUset=[]},initObj:function(){this._initFromCocostudio(ResourceManager.JFResourcesMenuGame.CSSJFHuongDanTaiXiuPopup)},onClickBtnFromCocostudio:function(t,e){"JFButtonClose"===t.getName()&&(cc.audioEngine.playEffect(ResourceManager.JFResourcesMenuGame.SoundClose,!1),JFGameInfo.JFMain.layerPopup.hidePopupHuongDanTaiXiu())},dispose:function(){JFGameInfo.JFMain.layerPopup.hidePopupHuongDanTaiXiu()}}),JFPopupLichSuTaiXiu=JFUIBaseLayer.extend({gameInfo:null,netSend:null,listHistory:null,listView:null,ctor:function(t,e){JFUIBaseLayer.prototype.ctor.call(this),this.gameInfo=t,this.netSend=e},initObj:function(){this._initFromCocostudio(ResourceManager.JFResourcesMenuGame.CSSJFPopupLichSuLayer),this.listView=this._mainLayer.getChildByName("JFListView"),this.initEvent(),JFGameInfo.JFMain.showLoading(),this.netSend.getHistoryBetTaiXiuInfo()},initEvent:function(){this.listEvents=[],this.listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_TAI_XIU.BetHistory.toString(),this.ngHistory.bind(this)))},onClickBtnFromCocostudio:function(t,e){"JFButtonClose"===t.getName()&&(cc.audioEngine.playEffect(ResourceManager.JFResourcesMenuGame.SoundClose,!1),JFGameInfo.JFMain.layerPopup.hidePopupLichSuTaiXiu())},ngHistory:function(t){JFGameInfo.JFMain.hideLoading(),t=t.getUserData();var e={BetHistory:BinaryConstants.DataTypeID.Object8,BetHistory_Struct:{MatchID:BinaryConstants.DataTypeID.UInt32,BetID:BinaryConstants.DataTypeID.UInt8,GoldBet:BinaryConstants.DataTypeID.UInt64,Reward:BinaryConstants.DataTypeID.UInt64,Time:BinaryConstants.DataTypeID.UInt64,Dices:BinaryConstants.DataTypeID.Array8,Dices_Type:BinaryConstants.DataTypeID.UInt8}};this.listHistory=(new BinaryParser).init(e,t.content).BetHistory,this.updateInfo()},updateInfo:function(){var t,e=0,i=this.listHistory.length;for(this.listView.removeAllChildren(!0);e<i;e++)(t=new JFItemHistoryBetTaiXiu(this.gameInfo)).initObj(),t.updateDate(this.listHistory[e],e),this.listView.pushBackCustomItem(t.getContentPanel())},dispose:function(){JFGameInfo.JFMain.layerPopup.hidePopupLichSuTaiXiu()}}),JFPopupThongKeTaiXiu=JFUIBaseLayer.extend({gameInfo:null,netSend:null,txtCountTai:null,txtCountXiu:null,listIconTaiXiuBottom:null,listPositionIconTaiXiuBottom:null,listPositionY_Top:null,txtTotalTai:null,txtTotalXiu:null,totalTai:0,totalXiu:0,listColTop:null,ctor:function(t,e){JFUIBaseLayer.prototype.ctor.call(this),this.gameInfo=t,this.netSend=e,this.initEvent(),this.listPositionY_Top=[440.52,425.66,410.81,395.95,381.09,366.23]},initEvent:function(){this.listEvents=[],this.listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_TAI_XIU.ResultHistory.toString(),this.ngHistory.bind(this)))},initObj:function(){JFGameInfo.JFMain.showLoading(),this._initFromCocostudio(ResourceManager.JFResourcesMenuGame.CSSJFPopupThongKeLayer),this.txtCountTai=this._mainLayer.getChildByName("JFCountTai"),this.txtCountXiu=this._mainLayer.getChildByName("JFCountXiu"),this.listIconTaiXiuBottom=this._mainLayer.getChildByName("JFHistoryContain").getChildren();var t=this.listIconTaiXiuBottom.length;this.listPositionIconTaiXiuBottom=[];for(var e=0;e<t;e++)this.listPositionIconTaiXiuBottom.push(this.listIconTaiXiuBottom[e].getPosition());this.txtTotalTai=this._mainLayer.getChildByName("JFTotalTai"),this.txtTotalXiu=this._mainLayer.getChildByName("JFTotalXiu"),this.listColTop=this._mainLayer.getChildByName("JFTopHistory").getChildren(),this.updateInfo(),this.netSend.getHistoryThongKeTaiXiuInfo(),this._mainLayer.setScale(1.5),this._mainLayer.setPosition(-300,-200)},onClickBtnFromCocostudio:function(t,e){"JFButtonClose"===t.getName()&&(cc.audioEngine.playEffect(ResourceManager.JFResourcesMenuGame.SoundClose,!1),JFGameInfo.JFMain.layerPopup.hidePopupThongKeTaiXiu())},updateInfo:function(){this.txtCountTai.setString("TÀI: "+this.gameInfo.thongKeTongTai),this.txtCountXiu.setString("XỈU "+this.gameInfo.thongKeTongXiu);for(var t=0,e=this.gameInfo.thongKeTaiXiu.length;t<120;t++)t<e?(this.gameInfo.thongKeTaiXiu[t].IsTai?this.listIconTaiXiuBottom[t].loadTexture(ResourceManager.JFResourcesMenuGame.Icon_Tai_png,ccui.Widget.LOCAL_TEXTURE):this.listIconTaiXiuBottom[t].loadTexture(ResourceManager.JFResourcesMenuGame.Icon_Xiu_png,ccui.Widget.LOCAL_TEXTURE),this.listIconTaiXiuBottom[t].setVisible(!0)):this.listIconTaiXiuBottom[t].setVisible(!1);this.updateInfoHistory(),0<e&&(this.listIconTaiXiuBottom[e-1].runAction(cc.sequence(cc.moveBy(.2,cc.p(0,2)),cc.moveBy(.2,cc.p(0,-2)))).repeatForever(),0<=e-2)&&(this.listIconTaiXiuBottom[e-2].stopAllActions(),this.listIconTaiXiuBottom[e-2].setPosition(this.listPositionIconTaiXiuBottom[e-2]))},ngHistory:function(t){JFGameInfo.JFMain.hideLoading(),t=t.getUserData();for(var e={ResultArray:BinaryConstants.DataTypeID.Array8,ResultArray_Type:BinaryConstants.DataTypeID.UInt8},e=(t=(new BinaryParser).init(e,t.content).ResultArray).length,i=0;i<e;i++)this.gameInfo.addThongKeTongDiem(t[i]);this.updateInfoHistory()},updateInfoHistory:function(){this.totalXiu=this.totalTai=0;for(var t,e=this.gameInfo.thongKeTongDiem.length,i=0;i<20;i++)if(i<e)for(var n=this.listColTop[i].getChildren(),s=this.gameInfo.thongKeTongDiem[i].length,r=0;r<6;r++)r<s?(t=n[r].getChildByName("JFValue"),10<this.gameInfo.thongKeTongDiem[i][r]?(this.totalTai++,t.setColor(cc.color(24,255,251,255)),n[r].getChildByName("JFImg").loadTexture(ResourceManager.JFResourcesMenuGame.Item_ThongKe_Tai_png,ccui.Widget.LOCAL_TEXTURE)):(this.totalXiu++,t.setColor(cc.color(255,255,255,255)),n[r].getChildByName("JFImg").loadTexture(ResourceManager.JFResourcesMenuGame.Item_ThongKe_Xiu_png,ccui.Widget.LOCAL_TEXTURE)),t.setString(this.gameInfo.thongKeTongDiem[i][r]),n[r].setVisible(!0)):n[r].setVisible(!1),n[r].setPositionY(this.listPositionY_Top[r]),n[r].stopAllActions();this.txtTotalTai.setString("TÀI: "+this.totalTai),this.txtTotalXiu.setString("XỈU: "+this.totalXiu),0<e&&(i=this.gameInfo.thongKeTongDiem[e-1],(n=this.listColTop[e-1].getChildren())[i.length-1].runAction(cc.sequence(cc.moveBy(.2,cc.p(0,2)),cc.moveBy(.2,cc.p(0,-2)))).repeatForever())},dispose:function(){JFGameInfo.JFMain.layerPopup.hidePopupThongKeTaiXiu()}}),JFPopupXepHangTaiXiu=JFUIBaseLayer.extend({gameInfo:null,netSend:null,matchID:null,listItem:null,listUset:null,ctor:function(t,e){JFUIBaseLayer.prototype.ctor.call(this),this.gameInfo=t,this.netSend=e,this.matchID=0,this.listUset=[]},initObj:function(){this._initFromCocostudio(ResourceManager.JFResourcesMenuGame.CSSJFPopupXepHangLayer),this.initEvent(),this.listItem=this._mainLayer.getChildByName("JFListItem").getChildren(),this.listItem[1].getChildByName("JFBackground").setVisible(!1),this.listItem[3].getChildByName("JFBackground").setVisible(!1),this.listItem[5].getChildByName("JFBackground").setVisible(!1),this.listItem[7].getChildByName("JFBackground").setVisible(!1),this.listItem[0].getChildByName("JFTxtHang").setString("1"),this.listItem[1].getChildByName("JFTxtHang").setString("2"),this.listItem[2].getChildByName("JFTxtHang").setString("3"),this.listItem[3].getChildByName("JFTxtHang").setString("4"),this.listItem[4].getChildByName("JFTxtHang").setString("5"),this.listItem[5].getChildByName("JFTxtHang").setString("6"),this.listItem[6].getChildByName("JFTxtHang").setString("7"),this.listItem[7].getChildByName("JFTxtHang").setString("8"),this.listItem[8].getChildByName("JFTxtHang").setString("9"),JFGameInfo.JFMain.showLoading(),this.netSend.getHistoryXepHangTaiXiuInfo()},initEvent:function(){this.listEvents=[],this.listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_TAI_XIU.TopRank.toString(),this.ngTopRank.bind(this)))},onClickBtnFromCocostudio:function(t,e){"JFButtonClose"===t.getName()&&(cc.audioEngine.playEffect(ResourceManager.JFResourcesMenuGame.SoundClose,!1),JFGameInfo.JFMain.layerPopup.hidePopupXepHangTaiXiu())},ngTopRank:function(t){JFGameInfo.JFMain.hideLoading(),t=t.getUserData();var e={TopWin:BinaryConstants.DataTypeID.Object8,TopWin_Struct:{Nickname:BinaryConstants.DataTypeID.StringDynamic,GoldWin:BinaryConstants.DataTypeID.UInt64}};t=(new BinaryParser).init(e,t.content),this.matchID=this.gameInfo.matchID,this.listUset=t.TopWin,this.updateInfo()},updateInfo:function(){for(var t=0,e=this.listUset.length;t<9;t++)t<e?(this.listItem[t].setVisible(!0),this.listItem[t].getChildByName("JFTxtTen").setString(this.listUset[t].Nickname),this.listItem[t].getChildByName("JFTxtTien").setString(Utilities.Coin(this.listUset[t].GoldWin))):this.listItem[t].setVisible(!1)},dispose:function(){JFGameInfo.JFMain.layerPopup.hidePopupXepHangTaiXiu()}}),JFPopupHistorySlot=JFUIBaseLayer.extend({netSend:null,listHistory:null,listView:null,index:null,lengthList:null,ctor:function(t){JFUIBaseLayer.prototype.ctor.call(this),this.listHistory=t},initObj:function(){this._initFromCocostudio(ResourceManager.JFResourcesMenuGame.CSSJFPopupHistorySlot),this.listView=this._mainLayer.getChildByName("JFListView"),this.listView.removeAllChildren(!0),this.setListview()},setListview:function(){var t;for(this.lengthList=this.listHistory.length,this.index=0,this.index;this.index<this.lengthList;this.index++)(t=new JFItemHistorySlot(this.listHistory[this.index])).initObj(this.index),this.listView.pushBackCustomItem(t.getContentPanel())},onClickBtnFromCocostudio:function(t,e){"JFButtonClose"===t.getName()&&(cc.audioEngine.playEffect(ResourceManager.JFResourcesMenuGame.SoundClose,!1),JFGameInfo.JFMain.layerPopup.hidePopupHistorySlot())},dispose:function(){JFGameInfo.JFMain.layerPopup.hidePopupHistorySlot()}}),JFItemHistorySlot=JFUIBaseLayer.extend({contentPanel:null,historyInfo:null,index:null,ctor:function(t){JFUIBaseLayer.prototype.ctor.call(this),this.historyInfo=t},initObj:function(t){this._initFromCocostudio(ResourceManager.JFResourcesMenuGame.CSSJFItemHistorySlot),this.contentPanel=this._mainLayer.getChildByName("ContentPanel"),this.updateData(t)},updateData:function(t){if(this.index=this.historyInfo.MatchID,this.contentPanel.getChildByName("JFTxtMatchID").setString("#"+this.index),this.contentPanel.getChildByName("JFTxtDatetime").setString(this.historyInfo.UpdatedTime),this.contentPanel.getChildByName("JFTxtBetCoin").setString(Utilities.Coin(this.historyInfo.GoldBet)),99==this.historyInfo.FreeSpin)this.contentPanel.getChildByName("JFTxtResult").setString("JACKPOT");else{for(var e=t=0;e<this.historyInfo.LineResult.length;e++)0!==this.historyInfo.LineResult[e]&&t++;this.contentPanel.getChildByName("JFTxtResult").setString(t)}this.contentPanel.getChildByName("JFTxtReward").setString(Utilities.Coin(this.historyInfo.GoldReward))},getContentPanel:function(){return this.contentPanel.removeFromParent(!0),this.contentPanel}}),JFPopupTopFreeSlot=JFUIBaseLayer.extend({listData:null,listView:null,ctor:function(t){JFUIBaseLayer.prototype.ctor.call(this),this.listData=t},initObj:function(){this._initFromCocostudio(ResourceManager.JFResourcesMenuGame.CSSJFPopupTopFreeTicket),this.listView=this._mainLayer.getChildByName("JFListView"),this.setListview()},setListview:function(){var t,e=0,i=this.listData.length;for(this.listView.removeAllChildren(!0);e<i;e++)(t=new JFItemTopFreeSlot(this.listData[e])).initObj(e+1),this.listView.pushBackCustomItem(t.getContentPanel())},onClickBtnFromCocostudio:function(t,e){"JFButtonClose"===t.getName()&&(cc.audioEngine.playEffect(ResourceManager.JFResourcesMenuGame.SoundClose,!1),JFGameInfo.JFMain.layerPopup.hidePopupTopFreeSlot())},dispose:function(){JFGameInfo.JFMain.layerPopup.hidePopupTopFreeSlot()}}),JFItemTopFreeSlot=JFUIBaseLayer.extend({contentPanel:null,Info:null,ctor:function(t){JFUIBaseLayer.prototype.ctor.call(this),this.Info=t},initObj:function(t){this._initFromCocostudio(ResourceManager.JFResourcesMenuGame.CSSJFItemTopFreeTicket),this.contentPanel=this._mainLayer.getChildByName("ContentPanel"),this.updateData(t)},updateData:function(t){this.contentPanel.getChildByName("JFTxtID").setString(t),this.contentPanel.getChildByName("JFTxtUsername").setString(this.Info.Nickname),this.contentPanel.getChildByName("JFTxtTicketNumber").setString(this.Info.Ticket)},getContentPanel:function(){return this.contentPanel.removeFromParent(!0),this.contentPanel}}),JFPopupTopWinSlot=JFUIBaseLayer.extend({listData:null,listView:null,ctor:function(t){JFUIBaseLayer.prototype.ctor.call(this),this.listData=t},initObj:function(){this._initFromCocostudio(ResourceManager.JFResourcesMenuGame.CSSJFPopupTopWin),this.listView=this._mainLayer.getChildByName("JFListView"),this.setListview()},setListview:function(){var t,e=0,i=this.listData.TopWin.length;for(this.listView.removeAllChildren(!0);e<i;e++)(t=new JFItemTopWinSlot(this.listData.TopWin[e])).initObj(e+1),this.listView.pushBackCustomItem(t.getContentPanel())},onClickBtnFromCocostudio:function(t,e){"JFButtonClose"===t.getName()&&(cc.audioEngine.playEffect(ResourceManager.JFResourcesMenuGame.SoundClose,!1),JFGameInfo.JFMain.layerPopup.hidePopupTopWinSlot())},dispose:function(){JFGameInfo.JFMain.layerPopup.hidePopupTopWinSlot()}}),JFItemTopWinSlot=JFUIBaseLayer.extend({contentPanel:null,Info:null,ctor:function(t){JFUIBaseLayer.prototype.ctor.call(this),this.Info=t},initObj:function(t){this._initFromCocostudio(ResourceManager.JFResourcesMenuGame.CSSJFItemTopWin),this.contentPanel=this._mainLayer.getChildByName("ContentPanel"),this.updateData(t)},updateData:function(t){switch(this.contentPanel.getChildByName("JFTxtID").setString(t),this.contentPanel.getChildByName("JFTxtUsername").setString(this.Info.Nickname),this.Info.WinType){case 1:this.contentPanel.getChildByName("JFTxtResult").setString("Nổ hũ ");break;case 2:this.contentPanel.getChildByName("JFTxtResult").setString("3 WILD ");break;default:this.contentPanel.getChildByName("JFTxtResult").setString("Thắng thường ")}this.contentPanel.getChildByName("JFTxtGoldReward").setString(Utilities.Coin(this.Info.GoldReward))},getContentPanel:function(){return this.contentPanel.removeFromParent(!0),this.contentPanel}}),JFPopupTutorialSlot=JFUIBaseLayer.extend({currPage:null,page0:null,page1:null,page2:null,ctor:function(){JFUIBaseLayer.prototype.ctor.call(this),this.currPage=0,this.listUset=[]},initObj:function(){this._initFromCocostudio(ResourceManager.JFResourcesMenuGame.CSSJFPOpupTutorialSlot),this.showPage(this.currPage)},onClickBtnFromCocostudio:function(t,e){switch(t.getName()){case"JFButtonClose":case"BtnVegame":cc.audioEngine.playEffect(ResourceManager.JFResourcesMenuGame.SoundClose,!1),JFGameInfo.JFMain.layerPopup.hidePopupTutorialSlot();break;case"BtnTruoc":0<this.currPage&&this.currPage--,this.showPage(this.currPage);break;case"BtnSau":this.currPage<2&&this.currPage++,this.showPage(this.currPage)}},showPage:function(t){this.hideAllPage(),this._mainLayer.getChildByName("ImgGameRule"+t).setVisible(!0),2==t&&(this._mainLayer.getChildByName("TxtMsg").setVisible(!0),this._mainLayer.getChildByName("TxtMsg").setString("Vị trí xuất hiện của các biểu tượng có thể thay đổi, trừ trường hợp 2"))},hideAllPage:function(){this._mainLayer.getChildByName("ImgGameRule0").setVisible(!1),this._mainLayer.getChildByName("ImgGameRule1").setVisible(!1),this._mainLayer.getChildByName("ImgGameRule2").setVisible(!1),this._mainLayer.getChildByName("TxtMsg").setVisible(!1)},dispose:function(){JFGameInfo.JFMain.layerPopup.hidePopupTutorialSlot()}}),JFMiniSlot=JFUIBaseLayer.extend({listSlot:null,listCot:null,listBet:null,listBetID:null,listJackpot:null,listHistory:null,listImage:null,listLine:null,listResult:null,listNodeEffect:null,listEffect:null,khungSlot:null,lastPos:null,topPos:null,runDistance:null,numberColumn:null,numberSlot:null,isRunning:null,isAuto:null,isStopping:null,isUsingFreeTicket:null,isWinJackpot:null,isWinScatter:null,AutoRun:null,runTime:null,maxBet:null,myCoin:null,myCoinJackpot:null,myOldCoin:null,myFreeTicket:null,myScatterTicket:null,myGoldWin:null,delayTime:null,btnQuay:null,btnDecBet:null,btnASCBet:null,btnMaxBet:null,btnStop:null,txtJackpot:null,txtID:null,txtFreeTicket:null,txtCoin:null,txtBet:null,txtThang:null,txtGoldReward:null,currentBet:null,cbUpdateJackpot:null,cbRunEffectResult:null,cbAutoRun:null,myLineResult:null,countEffectResult:null,currTime:null,EndTime:null,FXWinSlot:null,FXWinScatter:null,FXWinJackpot:null,MaxHistory:null,isDisposed:!1,ctor:function(){JFUIBaseLayer.prototype.ctor.call(this)},initObj:function(){this._initFromCocostudio(ResourceManager.JFResourcesMenuGame.CSSUISlotMinigame),this.khungSlot=this._mainLayer.getChildByName("JFKhungSlot"),this.btnQuay=this._mainLayer.getChildByName("JFButtonQuay"),this.btnQuay.setTouchEnable(!0),this.btnQuay.addTouchEventListener(this.onClickBtnFromCocostudio.bind(this)),this.btnQuay.setBright(!1),this.btnQuay.setEnabled(!1),JFGameInfo.JFMain.layerMiniGame.show(),JFGameInfo.JFMain.hideLoading(),this.btnStop=this._mainLayer.getChildByName("JFButtonStop"),this.btnDecBet=this._mainLayer.getChildByName("BtnDECBet"),this.btnASCBet=this._mainLayer.getChildByName("BtnASCBet"),this.btnMaxBet=this._mainLayer.getChildByName("BtnMaxBet"),this.btnDecBet.setEnabled(!1),this.btnASCBet.setEnabled(!1),this.btnMaxBet.setEnabled(!1),this.listSlot=[],this.listBet=[],this.listBetID=[],this.listJackpot=[],this.listHistory=[],this.listImage=[],this.listLine=[],this.listResult=[],this.listNodeEffect=[],this.listEffect=[],this.currentBet=null,this.runTime=1.6,this.delayTime=1.51,this.EndTime=this.currTime=0,this.MaxHistory=100,this.myGoldWin=this.myCoinJackpot=0,this.isWinScatter=this.isWinJackpot=this.isUsingFreeTicket=!1,this.myCoin=JFGameInfo.myInfo.Gold,this.isAuto=this.isRunning=!1,this.isStopping=!0,this.netSend=JFGameInfo.JFMain.layerMiniGame.netSend,this.isDisposed=!1,this.cbUpdateJackpot=this.sendUpdateJackpotValue.bind(this),this.cbRunEffectResult=this.runEffectResult.bind(this),this.cbAutoRun=this.autoRun.bind(this),this.initTextValue(),this.initSlot(),this.initRandomSlot(),this._initEvents(),this.scheduleUpdate()},initRandomSlot:function(){for(var t=0;t<this.numberColumn;t++)for(var e=0;e<this.numberSlot;e++){var i=jf.math.randomFloorBetween(0,8).toString();this.listSlot[t][e].setTexture(ResourceManager.JFResourcesMenuGame["Slot"+i])}},initSlot:function(){this.numberColumn=3,this.numberSlot=5;for(var t=0;t<this.numberColumn;t++){this.listSlot[t]=[];for(var e=0;e<this.numberSlot;e++)this.listSlot[t][e]=this.khungSlot.getChildByName("Khung").getChildByName("Cot"+t).getChildByName("Sprite_"+e)}for(var i=0,t=0;t<this.numberColumn;t++)for(e=1;e<=3;e++)this.listResult[i]=this.khungSlot.getChildByName("Khung").getChildByName("Cot"+t).getChildByName("Sprite_"+e),this.listNodeEffect[i]=this.khungSlot.getChildByName("Khung").getChildByName("Cot"+t).getChildByName("Effect_"+(e-1)),this.listEffect[i]=null,i++;this.listLine[0]=[0,3,6],this.listLine[1]=[1,4,7],this.listLine[2]=[2,5,8],this.listLine[3]=[0,4,8],this.listLine[4]=[2,4,6],t=Math.abs(this.listSlot[0][0].y-this.listSlot[0][1].y),this.lastPos=this.listSlot[0][this.numberSlot-1].y-t,this.topPos=this.listSlot[0][0].y,this.runDistance=Math.abs(this.topPos-this.lastPos)},initTextValue:function(){this.txtCoin=this._mainLayer.getChildByName("JFTxtCoin"),this.txtJackpot=this._mainLayer.getChildByName("TxtGoldJackpot"),this.txtID=this._mainLayer.getChildByName("TxtID"),this.txtFreeTicket=this._mainLayer.getChildByName("ImgBgTxtQuayFree").getChildByName("TxtFreeTicket"),this.txtBet=this._mainLayer.getChildByName("TxtBet"),this.txtThang=this._mainLayer.getChildByName("TxtThang"),this.txtGoldReward=this._mainLayer.getChildByName("TxtGoldReward")},_initEvents:function(){this.listEvents=[],this.listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_SLOT.LOGIN.toString(),this.ngGameInfo.bind(this))),this.listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_SLOT.RESULT.toString(),this.ngResult.bind(this))),this.listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_SLOT.BETVALUE.toString(),this.ngUpdateValueBet.bind(this))),this.listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_SLOT.UPDATEJACKPOT.toString(),this.ngUpdateJackpotValue.bind(this))),this.listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_SLOT.WINJACKPOT.toString(),this.ngWinJackpot.bind(this))),this.listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_SLOT.BETHISTORY.toString(),this.ngGetBetHistory.bind(this))),this.listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_SLOT.TOPWIN.toString(),this.ngGetTopWin.bind(this))),this.listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK_SLOT.ErrorMessage.toString(),this.ngGameError.bind(this)))},sendUpdateJackpotValue:function(){this.netSend.sendUpdateJackpot()},ngGetTopWin:function(t){t=t.getUserData();var e={TopWin:BinaryConstants.DataTypeID.Object8,TopWin_Struct:{Nickname:BinaryConstants.DataTypeID.StringDynamic,WinType:BinaryConstants.DataTypeID.UInt8,GoldReward:BinaryConstants.DataTypeID.UInt64}};t=(new BinaryParser).init(e,t.content),JFGameInfo.JFMain.layerPopup.showPopupTopWinSlot(t)},onClickBtnFromCocostudio:function(t,e){switch(t.getName()){case"JFButtonClose":this.isRunning?JFGameInfo.JFMain.layerPopup.showPopupMsg(ConstantsVariable.Messages.EXITSLOT):(cc.audioEngine.playEffect(ResourceManager.JFResourcesMenuGame.SoundClose,!1),this.onclose());break;case"JFButtonQuay":e===ccui.Widget.TOUCH_BEGAN&&0==this.isRunning&&(this.isAuto=!0,this.AutoRun=setTimeout(this.CheckAutoRun.bind(this),1e3)),e!==ccui.Widget.TOUCH_CANCELED&&e!==ccui.Widget.TOUCH_ENDED||(this.isAuto=!1,0==this.isRunning&&(this.startBet(),this.isStopping=!0));break;case"JFButtonStop":this.isStopping=!0,this.btnStop.setVisible(!1),this.btnQuay.setVisible(!0);break;case"BtnASCBet":this.currentBet<this.maxBet&&!1===this.isUsingFreeTicket&&!1===this.isRunning&&!0===this.isStopping&&(this.currentBet++,this.updateBetValue(),this.updateJackpot());break;case"BtnDECBet":1<this.currentBet&&!1===this.isUsingFreeTicket&&!1===this.isRunning&&!0===this.isStopping&&(this.currentBet--,this.updateBetValue(),this.updateJackpot());break;case"BtnMaxBet":!1===this.isUsingFreeTicket&&!1===this.isRunning&&!0===this.isStopping&&(this.currentBet=this.maxBet,this.updateBetValue(),this.updateJackpot());break;case"JFBtnHistory":JFGameInfo.JFMain.layerPopup.showPopupHistorySlot(this.listHistory);break;case"JFBtnTopUser":this.netSend.sendTopWinSlot();break;case"BtnTutorial":JFGameInfo.JFMain.layerPopup.showPopupTutorialSlot()}},CheckAutoRun:function(){!0===this.isAuto&&!1===this.isUsingFreeTicket&&(this.isStopping=!1,this.btnQuay.setEnabled(!1),this.btnQuay.setBright(!1),this.btnDecBet.setEnabled(!1),this.btnASCBet.setEnabled(!1),this.btnMaxBet.setEnabled(!1),this.btnStop.setVisible(!0),this.btnQuay.setVisible(!1),this.cbAutoRun())},autoRun:function(){this.isStopping?(this.isAuto=this.isRunning=!1,this.btnStop.setVisible(!1),this.btnQuay.setVisible(!0),this.btnQuay.setEnabled(!0),this.btnQuay.setBright(!0),this.btnDecBet.setEnabled(!0),this.btnASCBet.setEnabled(!0),this.btnMaxBet.setEnabled(!0),clearTimeout(this.AutoRun)):this.startBet()},sendBetHistory:function(){this.netSend.sendHistorySlotInfo()},ngGetBetHistory:function(t){t=t.getUserData();var e={History:BinaryConstants.DataTypeID.Object8,History_Struct:{MatchID:BinaryConstants.DataTypeID.UInt32,GoldBet:BinaryConstants.DataTypeID.UInt64,GoldReward:BinaryConstants.DataTypeID.UInt64,ScatterTicket:BinaryConstants.DataTypeID.UInt32,LineResult:BinaryConstants.DataTypeID.Array8,LineResult_Type:BinaryConstants.DataTypeID.UInt8,FreeSpin:BinaryConstants.DataTypeID.UInt8,UpdatedTime:BinaryConstants.DataTypeID.UInt64}};for(t=(new BinaryParser).init(e,t.content),e=0;e<t.History.length;e++)this.listHistory[e]=t.History[e],this.listHistory[e].UpdatedTime=Utilities.ConvertTime(t.History[e].UpdatedTime)},startBet:function(){var t;if(0===this.myFreeTicket&&0===this.myScatterTicket){if(t=this.currentBet,this.listBet[this.currentBet]>this.myCoin)return JFGameInfo.JFMain.layerPopup.showPopupMsg("Không đủ tiền đặt cược"),this.isStopping=!0,void this.endRunning()}else t=0;this.netSend.sendBetSlot(1,t)},updateMyCoin:function(){this.txtCoin.setString(Utilities.Coin(this.myCoin)),JFGameInfo.myInfo.Gold=this.myCoin,cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.MENU_LAYER_UPDATE_USER.toString())},runSlotAnimation:function(){this.stopAllActions(),this.isRunning=!0,this.btnQuay.setEnabled(!1),this.btnQuay.setBright(!1),this.btnDecBet.setEnabled(!1),this.btnASCBet.setEnabled(!1),this.btnMaxBet.setEnabled(!1);for(var t=0;t<this.numberColumn;t++)for(var e=0;e<this.numberSlot;e++)this.listSlot[t][e].runAction(cc.sequence(cc.moveBy(this.runTime/4,cc.p(0,2*-this.runDistance)).easing(cc.easeBackIn()),cc.moveBy(this.runTime/2,cc.p(0,4*-this.runDistance)),cc.moveBy(this.runTime/8,cc.p(0,-this.runDistance)),cc.moveBy(this.runTime/8+.2*t,cc.p(0,-this.runDistance)).easing(cc.easeBackOut())))},endRunning:function(){this.updateBetValue(),0===this.myScatterTicket&&0===this.myFreeTicket&&this.cbAutoRun()},update:function(){if(this.isRunning)for(var t=0;t<this.numberColumn;t++)for(var e=0;e<this.numberSlot;e++)this.listSlot[t][e].y<this.lastPos&&(this.listSlot[t][e].y+=+this.topPos-this.lastPos)},ngGameInfo:function(t){var e;this.isDisposed||(t=t.getUserData(),e={Gold:BinaryConstants.DataTypeID.UInt64,FreeTicket:BinaryConstants.DataTypeID.UInt32,ScatterTicket:BinaryConstants.DataTypeID.UInt32},t=(new BinaryParser).init(e,t.content),this.myFreeTicket=t.FreeTicket,this.myScatterTicket=t.ScatterTicket,this.setFreeTicket(),this.myCoin=t.Gold,this.updateMyCoin(),this.sendUpdateJackpotValue(),this.sendBetHistory(),this.btnStop.setVisible(!1),this.btnQuay.setVisible(!0),this.btnQuay.setEnabled(!0),this.btnQuay.setBright(!0),this.btnDecBet.setEnabled(!0),this.btnASCBet.setEnabled(!0),this.btnMaxBet.setEnabled(!0),this.schedule(this.cbUpdateJackpot,10),JFGameInfo.JFMain.pushFirebaseJoinRoomSuccess("Slot"))},ngWinJackpot:function(t){var e;this.isDisposed||(t=t.getUserData(),e={MatchID:BinaryConstants.DataTypeID.UInt32,BetValue:BinaryConstants.DataTypeID.UInt64,GoldReward:BinaryConstants.DataTypeID.UInt64,TotalGold:BinaryConstants.DataTypeID.UInt64},t=(new BinaryParser).init(e,t.content),this.myCoinJackpot=t.GoldReward,this.myCoin=t.TotalGold,this.myGoldWin=t.GoldReward,this.isWinJackpot=!0,(e={}).MatchID=t.MatchID,e.GoldReward=t.GoldReward,e.ScatterTicket=0,e.FreeSpin=99,e.LineResult=null,e.GoldBet=t.BetValue,e.UpdatedTime=Utilities.ConvertTime((new Date).getTime()),this.listHistory.unshift(e),this.listHistory.length>this.MaxHistory&&this.listHistory.pop())},runEffectGetJackpot:function(){this.isDisposed||(this.FXWinJackpot=new sp.SkeletonAnimation(ResourceManager.JFResourcesMenuGame.FXWinJackpot_json,ResourceManager.JFResourcesMenuGame.FXWinJackpot_atlas),this.FXWinJackpot.setAnimation(0,"jackpot",!1),this.FXWinJackpot.setCompleteListener(this._removeFXSpineComplete.bind(this,this.FXWinJackpot)),this.FXWinJackpot.setPosition(cc.p(640,360)),this.addChild(this.FXWinJackpot),setTimeout(this.AddJackpotCoin.bind(this.FXWinJackpot,this.myCoinJackpot),1100))},AddJackpotCoin:function(t){var e=cc.LabelTTF.create("LabelTxt",ResourceManager.JFResourcesMenuGame.UVNBaiSau_N,35,cc.TEXT_ALIGNMENT_CENTER);e.setString(Utilities.Coin(t)),e.setPosition(cc.p(0,-110)),e.opacity=0,e.runAction(cc.fadeIn(.5)),this.addChild(e)},_removeFXSpineComplete:function(t){t.scheduleUpdate(),t.schedule(function(){t.unscheduleUpdate(),t.clearTracks(),t.removeFromParent(),t=null},.1)},ngResult:function(t){this.ClearEffect(),t=t.getUserData();var e={WheelWidth:BinaryConstants.DataTypeID.UInt8,ResultArray:BinaryConstants.DataTypeID.Array8,ResultArray_Type:BinaryConstants.DataTypeID.UInt16,LineResult:BinaryConstants.DataTypeID.Array8,LineResult_Type:BinaryConstants.DataTypeID.UInt8,GoldReward:BinaryConstants.DataTypeID.UInt64,ScatterTicket:BinaryConstants.DataTypeID.UInt32,FreeTicket:BinaryConstants.DataTypeID.UInt32,MatchID:BinaryConstants.DataTypeID.UInt32,TotalGold:BinaryConstants.DataTypeID.UInt64,BetValue:BinaryConstants.DataTypeID.UInt64},e=(t=(new BinaryParser).init(e,t.content),this.txtID.setString("#"+t.MatchID.toString()),t.ScatterTicket),i=t.FreeTicket;0<e&&e>=this.myScatterTicket&&(this.isWinScatter=!0),this.updateBetValue(t.BetValue),this.unschedule(this.cbRunEffectResult),this.setBetValue(t.BetValue),this.myScatterTicket=e,this.myFreeTicket=i,this.myGoldWin=t.GoldReward,this.myCoin=t.TotalGold,this.runSlotAnimation(),this.runAction(cc.sequence(cc.callFunc(this._TxtStartBet.bind(this)),cc.delayTime(.2*this.numberColumn),cc.callFunc(this.changeResult.bind(this,t.WheelWidth,t.ResultArray)),cc.delayTime(this.runTime),cc.callFunc(this.showEffectResult.bind(this,t)),cc.delayTime(this.delayTime-.01),cc.callFunc(this.endRunning.bind(this)))),(e={}).MatchID=t.MatchID,e.GoldReward=t.GoldReward,e.ScatterTicket=t.ScatterTicket,e.LineResult=t.LineResult,e.FreeSpin=0!=t.ScatterTicket?2:0!=t.FreeTicket?1:0,e.GoldBet=t.BetValue,e.UpdatedTime=Utilities.ConvertTime((new Date).getTime()),this.listHistory.unshift(e),this.listHistory.length>this.MaxHistory&&this.listHistory.pop()},setFreeTicket:function(){var t=this.myFreeTicket+this.myScatterTicket;this.txtFreeTicket.setString(t),0===t?(this._mainLayer.getChildByName("ImgBgTxtQuayFree").setVisible(!1),this.isUsingFreeTicket=!1):(this.isUsingFreeTicket=!0,this._mainLayer.getChildByName("ImgBgTxtQuayFree").setVisible(!0))},setBetValue:function(t){this.isUsingFreeTicket?this.txtBet.setString(Utilities.Coin(t)):(this.myOldCoin=this.myCoin-t,this.txtCoin.setString(Utilities.Coin(this.myOldCoin)))},showEffectResult:function(t){this._TxtWinBet(),this.updateMyCoin(),this.setFreeTicket(),this.isWinJackpot&&(this.runEffectGetJackpot(),this.isWinJackpot=!1),this.isWinScatter&&(this.runEffectGetScatter(),this.isWinScatter=!1),this.isStopping&&!this.isUsingFreeTicket&&(this.myLineResult=t.LineResult,this.countEffectResult=0,this.runAllEffectResult(),this.schedule(this.cbRunEffectResult,1.5))},ClearEffect:function(){for(var t=0;t<9;t++)null!==this.listEffect[t]&&(this._removeFXSpineComplete(this.listEffect[t]),this.listEffect[t]=null,this.listResult[t].stopAllActions(),this.listResult[t].setScale(1))},runAllEffectResult:function(){this.ClearEffect();for(var t=cc.scaleTo(.25,1.2),e=cc.scaleTo(.25,1),i=0;i<5;i++)if(1===this.myLineResult[i])for(var n=0;n<3;n++){var s=this.listLine[i][n];null==this.listEffect[s]&&(this.listEffect[s]=new sp.SkeletonAnimation(ResourceManager.JFResourcesMenuGame.FXWinSlot_json,ResourceManager.JFResourcesMenuGame.FXWinSlot_atlas),this.listEffect[s].setAnimation(0,"Yellow",!0),this.listNodeEffect[s].addChild(this.listEffect[s]),this.listResult[s].runAction(cc.sequence(t.clone(),e.clone())).repeatForever())}for(this.countEffectResult=0,this.countEffectResult;this.countEffectResult<=5&&1!==this.myLineResult[this.countEffectResult];this.countEffectResult++);},runEffectResult:function(){if(this.ClearEffect(),5<=this.countEffectResult)this.runAllEffectResult();else{for(var t=cc.scaleTo(.25,1.2),e=cc.scaleTo(.25,1),i=0;i<3;i++){var n=this.listLine[this.countEffectResult][i];this.listEffect[n]=new sp.SkeletonAnimation(ResourceManager.JFResourcesMenuGame.FXWinSlot_json,ResourceManager.JFResourcesMenuGame.FXWinSlot_atlas),this.listEffect[n].setAnimation(0,"Yellow",!0),this.listNodeEffect[n].addChild(this.listEffect[n]),this.listResult[n].runAction(cc.sequence(t.clone(),e.clone())).repeatForever()}for(this.countEffectResult++,this.countEffectResult;this.countEffectResult<=5&&1!==this.myLineResult[this.countEffectResult];this.countEffectResult++);}},runEffectGetScatter:function(){var t=new sp.SkeletonAnimation(ResourceManager.JFResourcesMenuGame.FXWinScartter_json,ResourceManager.JFResourcesMenuGame.FXWinScartter_atlas);t.setAnimation(0,"scatter",!1),t.setCompleteListener(this._removeFXSpineComplete.bind(this,t)),this.addChild(t),t.setPosition(cc.p(640,360))},changeResult:function(t,e){for(var i=0,n=0;n<this.numberColumn;n++)for(var s=0;s<=this.numberSlot;s+=t+1){var r=jf.math.randomFloorBetween(0,8).toString();this.listSlot[n][s].setTexture(ResourceManager.JFResourcesMenuGame["Slot"+r])}for(n=0;n<9;n++)this.listResult[n].setTexture(ResourceManager.JFResourcesMenuGame["Slot"+e[i]]),i++},ngUpdateJackpotValue:function(t){t=t.getUserData();var e={JackpotValueList:BinaryConstants.DataTypeID.Object8,JackpotValueList_Struct:{JackpotID:BinaryConstants.DataTypeID.UInt8,JackpotValue:BinaryConstants.DataTypeID.UInt64}};for(t=(new BinaryParser).init(e,t.content),e=0;e<t.JackpotValueList.length;e++)this.listJackpot[t.JackpotValueList[e].JackpotID]=t.JackpotValueList[e].JackpotValue;this.updateJackpot()},updateJackpot:function(){this.isUsingFreeTicket?this.txtJackpot.setString(Utilities.Coin(this.listJackpot[1])):this.txtJackpot.setString(Utilities.Coin(this.listJackpot[this.currentBet]))},updateBetValue:function(t){this.isUsingFreeTicket?0===this.myScatterTicket?this.txtBet.setString(Utilities.Coin(this.listBet[0])):t&&this.txtBet.setString(Utilities.Coin(t)):this.txtBet.setString(Utilities.Coin(this.listBet[this.currentBet]))},_TxtWinBet:function(){this.txtGoldReward.setString(Utilities.Coin(this.myGoldWin)),this.txtThang.setString("TIỀN THẮNG ")},_TxtStartBet:function(){this.txtGoldReward.setString("5 DÒNG "),this.txtThang.setString("DÒNG CƯỢC ")},ngUpdateValueBet:function(t){if(!this.isDisposed){t=t.getUserData();var e={BetValueList:BinaryConstants.DataTypeID.Object8,BetValueList_Struct:{BetValueID:BinaryConstants.DataTypeID.UInt8,BetValue:BinaryConstants.DataTypeID.UInt64}};for(t=(new BinaryParser).init(e,t.content),e=0;e<t.BetValueList.length;e++)this.listBet[t.BetValueList[e].BetValueID]=t.BetValueList[e].BetValue,this.listBetID[e]=t.BetValueList[e].BetValueID;this.maxBet=this.listBet.length-1,this.currentBet?this.currentBet>this.maxBet&&(this.currentBet=this.maxBet):(this.currentBet=1,this.updateBetValue())}},errorConnect:function(t){JFGameInfo.JFMain.hideLoading(),JFGameInfo.JFMain.layerPopup.showPopupMsg("Không kết nối được máy chủ.")},ngGameError:function(t){t=t.getUserData();var e={Msg:BinaryConstants.DataTypeID.StringDynamic};t=(new BinaryParser).init(e,t.content),JFGameInfo.JFMain.hideLoading(),JFGameInfo.JFMain.layerPopup.showPopupMsg(t.Msg),this.isStopping=!0,this.cbAutoRun()},onclose:function(){this.isRunning=!1,this.myCoin&&this.updateMyCoin(),clearTimeout(this.AutoRun),this.stopAllActions(),this.unscheduleUpdate(),this.FXWinJackpot=this.FXWinScatter=null,this.setDispose(),JFGameInfo.CurrentLayer=ConstantsVariable.LAYERS.MENU_LAYER_ROOMS,JFGameInfo.JFMain.layerMiniGame.deleteSlotMinigame(),JFGameInfo.JFMain.layerMiniGame.hide()},setDispose:function(){if(this.gameInfo=null,this.isDisposed=!0,this.removeAllChildren(!0),this._listEvents)for(var t=0;t<this._listEvents.length;t++)cc.eventManager.removeListener(this._listEvents[t])}}),JFMiniSlotNetSend=JFNetSend.extend({ctor:function(){JFNetSend.prototype.ctor.call(this)},sendLoginGame:function(t){var e={};e.Token=t,t=Message.build(ConstantsVariable.NETWORK_SLOT.LOGIN,{Token:BinaryConstants.DataTypeID.StringDynamic},e),JFNetCore.JFGameSocket.sendMsg(t)},sendBetSlot:function(t,e){var i={};i.BetID=t,i.BetValueID=e,i=Message.build(ConstantsVariable.NETWORK_SLOT.BET,{BetID:BinaryConstants.DataTypeID.UInt8,BetValueID:BinaryConstants.DataTypeID.UInt8},i),JFNetCore.JFGameSocket.sendMsg(i)},sendUpdateJackpot:function(){var t=Message.build(ConstantsVariable.NETWORK_SLOT.UPDATEJACKPOT,null,null);JFNetCore.JFGameSocket.sendMsg(t)},sendHistorySlotInfo:function(){var t=Message.build(ConstantsVariable.NETWORK_SLOT.BETHISTORY,null,null);JFNetCore.JFGameSocket.sendMsg(t)},sendTopWinSlot:function(){var t=Message.build(ConstantsVariable.NETWORK_SLOT.TOPWIN,null,null);JFNetCore.JFGameSocket.sendMsg(t)}}),JFLayerMenuBackground=JFUIBaseLayer.extend({ctor:function(){JFUIBaseLayer.prototype.ctor.call(this)},initObj:function(){this._initBackGround()},_initFXBubble:function(){for(var t=0;t<2;t++){var e=new sp.SkeletonAnimation(ResourceManager.JFResourcesMenuGame.Bubbles_FX_json,ResourceManager.JFResourcesMenuGame.Bubbles_FX_atlas);e.setAnimation(0,"Normal",!0),e.setAnchorPoint(cc.p(.5,0)),e.setPosition(0,50),e.setTimeScale(2),this._mainLayer.getChildByName("FxBubble"+t).addChild(e)}},dispose:function(){this.unschedule(this._schedule);for(var t=0;t<this._listEvents.length;t++)cc.eventManager.removeListener(this._listEvents[t]);this.removeAllChildren(!0)},_initBackGround:function(){this.img=new cc.Sprite(ResourceManager.ResourceLoadingGame.BackgroundMainmenu),this.addChild(this.img),this.img.setAnchorPoint(cc.p(0,0))}}),JFLayerScreenGame=JFUIBaseLayer.extend({layerGuns:null,layerPhysic:null,layerEffects:null,netSend:null,layerPopup:null,_listEvents:null,ctor:function(){JFUIBaseLayer.prototype.ctor.call(this)},initObj:function(){this._initLayerPopup()},_initPhysicLayer:function(){this.layerPhysic=new JFLayerPhysic,this.layerPhysic.initObj(),(this.layerPhysic.layerScreenGame=this).addChild(this.layerPhysic)},_initEffectsLayer:function(){this.layerEffects=new JFLayerEffects,this.layerEffects.initObj(),(this.layerEffects.layerScreenGame=this).addChild(this.layerEffects)},_initGunLayer:function(){this.layerGuns=new JFLayerGuns,this.layerGuns.initObj(),(this.layerGuns.layerScreenGame=this).addChild(this.layerGuns)},_initWaterEffect:function(){if(this.waterEffect&&void 0!==this.waterEffect||(this.waterEffect=new cc.Sprite,this.waterEffect.name="waterEffect"),this.waterEffect.setContentSize(1100,700),!this.getChildByName(this.waterEffect.name))try{this.removeChild(this.waterEffect),this.addChild(this.waterEffect),this.waterEffect.retain()}catch(t){}for(var t,e=[],i=1;i<17;i++)t=cc.spriteFrameCache.getSpriteFrame("water"+i+".png"),e.push(t);e=new cc.Animation(e,.1),e=cc.animate(e),this.waterEffect.runAction(e.repeatForever()),this.waterEffect.scaleX=4*cc.winSize.width/this.waterEffect.width,this.waterEffect.scaleY=4*cc.winSize.height/this.waterEffect.height,this.waterEffect.x=JFUIBase.w2,this.waterEffect.y=JFUIBase.h2},_initLayerPopup:function(){this.layerPopup=JFGameInfo.JFMain.layerPopup},_initEvents:function(){this._listEvents=[],this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.LOGIN_GAME,this._loginGameSuccess.bind(this))),this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.GAME_MESSAGE,this._gameServerMessage.bind(this))),this._listEvents.push(cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.GAME_KICK,this._ngKickUser.bind(this)))},_initUIGame:function(){this._initPhysicLayer(),this._initWaterEffect(),this._initEffectsLayer(),this._initGunLayer()},initNetWork:function(){JFGameInfo.JFMain.showLoading(),this.layerPhysic||(this._initEvents(),this._initUIGame()),this.netSend=new JFGameNetSend,JFNetCore.JFGameSocket=new JFNetCore,JFNetCore.JFGameSocket.callBackOnConnected=this._onConnectedGameServer.bind(this),JFNetCore.JFGameSocket.callBackOnError=this._onErrorGameServer.bind(this),JFNetCore.JFGameSocket.callBackOnReceiveData=this._onReceiveGameServer.bind(this),JFNetCore.JFGameSocket.callBackOnClose=this._onCloseGameServer.bind(this),this.connectGameServer(),this.layerGuns.netSend=this.netSend},connectGameServer:function(){JFNetCore.JFGameSocket.close(),JFNetCore.JFGameSocket.init(PreLoaderConfig.ServerAndPortGame),JFNetCore.JFGameSocket.connect()},_onConnectedGameServer:function(){this.netSend.sendLoginGame(JFGameInfo.myInfo.token4Game)},_onCloseGameServer:function(){switch(JFGameInfo.roomID){case ConstantsVariable.RoomGameNormal:JFGameInfo.JFMain.pushFirebaseConnectError("Normal","server close socket");break;case ConstantsVariable.RoomGameVip:JFGameInfo.JFMain.pushFirebaseConnectError("Vip","server close socket")}this.unschedule(this.onPingGame),JFGameInfo.CurrentLayer===ConstantsVariable.LAYERS.MENU_LAYER_GAME&&JFNetCore.JFGameSocket&&(JFGameInfo.JFMain._exitServerGame(),JFGameInfo.JFMain.resetUserInfo(),this.layerPopup.showPopupMsg(PreLoaderConfig.Messages.ERROR_CONNECT_SOCKET))},_onErrorGameServer:function(){switch(JFGameInfo.roomID){case ConstantsVariable.RoomGameNormal:JFGameInfo.JFMain.pushFirebaseConnectError("Normal","server error socket");break;case ConstantsVariable.RoomGameVip:JFGameInfo.JFMain.pushFirebaseConnectError("Vip","server error socket")}this.unschedule(this.onPingGame),JFGameInfo.CurrentLayer===ConstantsVariable.LAYERS.MENU_LAYER_GAME&&JFNetCore.JFGameSocket&&(JFGameInfo.JFMain._exitServerGame(),JFGameInfo.JFMain.resetUserInfo(),this.layerPopup.showPopupMsg(PreLoaderConfig.Messages.ERROR_CONNECT_SOCKET))},_onReceiveGameServer:function(t){cc.eventManager.dispatchCustomEvent(t.requestId.toString(),t)},_loginGameSuccess:function(t){JFGameInfo.JFMain.showLoading(),t=t.getUserData();var e={UserID:BinaryConstants.DataTypeID.UInt32,Gold:BinaryConstants.DataTypeID.UInt64,Nickname:BinaryConstants.DataTypeID.StringDynamic,Level:BinaryConstants.DataTypeID.UInt32,Exp:BinaryConstants.DataTypeID.UInt64,DeskStation:BinaryConstants.DataTypeID.UInt8};switch(t=(new BinaryParser).init(e,t.content),this.schedule(this.onPingGame,PreLoaderConfig.TIME_PING_GAME),JFGameInfo.myInfo.UserID=t.UserID,JFGameInfo.myInfo.Gold=t.Gold,JFGameInfo.myInfo.Nickname=t.Nickname,JFGameInfo.myInfo.Level=t.Level,JFGameInfo.myInfo.Exp=t.Exp,JFGameInfo.myInfo.DeskStation=t.DeskStation,JFGameInfo.JFMain.swipLayer(ConstantsVariable.LAYERS.MENU_LAYER_GAME),JFGameInfo.JFMain.hideLoading(),JFGameInfo.roomID){case ConstantsVariable.RoomGameNormal:JFGameInfo.JFMain.pushFirebaseJoinRoomSuccess("Normal");break;case ConstantsVariable.RoomGameVip:JFGameInfo.JFMain.pushFirebaseJoinRoomSuccess("Vip")}},_gameServerMessage:function(t){t=t.getUserData();var e={Message:BinaryConstants.DataTypeID.StringDynamic};t=(new BinaryParser).init(e,t.content),this.layerPopup.showPopupMsg(t.Message)},_ngKickUser:function(t){t=t.getUserData();var e={State:BinaryConstants.DataTypeID.UInt8,Msg:BinaryConstants.DataTypeID.StringDynamic};t=(new BinaryParser).init(e,t.content),JFGameInfo.JFMain._exitServerGame(),JFGameInfo.JFMain.swipLayer(t.State),t.State==ConstantsVariable.LAYERS.MENU_LAYER_LOGIN&&(JFNetCore.JFMasterSocket.close(),JFGameInfo.JFMain.resetUserInfo()),JFGameInfo.JFMain.layerPopup.showPopupMsg(t.Msg)},onPingGame:function(){JFGameInfo.JFMain.layerScreenGame.netSend.sendPingGame()},dispose:function(){if(this._listEvents)for(var t=0;t<this._listEvents.length;t++)cc.eventManager.removeListener(this._listEvents[t]);this.layerGuns.dispose(),this.removeChild(this.layerGuns),this.layerGuns=null,this.layerPhysic.dispose(),this.removeChild(this.layerPhysic),this.layerPhysic=null,this.removeChild(this.layerEffects),this.layerEffects=null,this.removeChild(this.waterEffect),this.waterEffect=null,this.removeAllChildren(!0)}}),JFMainScreen=cc.Scene.extend({layerMainMenu:null,layerScreenGame:null,_background:null,layerComponents:null,layerPopup:null,layerMiniGame:null,netSend:null,layerLoading:null,webView:null,_isLogout:null,_isKicked:!1,_worker:null,ctor:function(){var t;cc.Scene.prototype.ctor.call(this),JFGameInfo.JFMain=this,cc.sys.isNative&&(t=Utilities.getDeviceInfo().split(":"))&&(JFGameInfo.devineID=t[0],JFGameInfo.DeviceModel=t[1],JFGameInfo.VersionDevice=t[2])},initObj:function(){this._initLayerLoading(),JFGameInfo.CurrentLayer=ConstantsVariable.LAYERS.MENU_LAYER_LOGIN,this._initBackground(),this._initLayerMainMenuGame(),this._initLayerComponents(),this._initLayerPopupController(),this._initLayerMiniGame(),this._initEvents(),this._initNetwork(),JFGameInfo.JFMain.showLoading(),this.autoLogin(),this._playBackgroundMusic(!1),_isKicked=!1},_initLayerLoading:function(){this.layerLoading=new JFLayerLoading,this.layerLoading.retain(),this.layerLoading.initObj(),this.addChild(this.layerLoading,100),this.layerLoading.hide()},showLoading:function(){this.layerLoading.show()},hideLoading:function(){this.layerLoading.hide(),this.webView&&!this.layerPopup.popupWebview&&this.removeWebview()},_initBackground:function(){this._background=new JFLayerMenuBackground,this._background.initObj(),this.addChild(this._background)},_initLayerMainMenuGame:function(){this.layerMainMenu=new JFLayerMainMenu,this.layerMainMenu.setName("layerMainMenu"),this.layerMainMenu.initObj(),this.layerMainMenu.setAnchorPoint(0,0),this.addChild(this.layerMainMenu,ConstantsVariable.UIZorder.MAINMENU)},swipLayer:function(t){switch(t){case ConstantsVariable.LAYERS.MENU_LAYER_LOGIN:if(cc.sys.isNative){if(JFGameInfo.CurrentLayer==ConstantsVariable.LAYERS.MENU_LAYER_LOGIN)break;this.layerMainMenu.runAction(cc.moveTo(.5,cc.p(0,0)).easing(cc.easeInOut(3))),this.layerComponents.setVisible(!1),this.removeWebview(),this.layerPopup.hideAllPopup(),JFGameInfo.JFMain.layerPopup.hidePopupMiniGame(),this.layerMiniGame.vongQuay?this.layerMiniGame.vongQuay.setVisible(!1):this.layerMiniGame.taiXiu?this.layerMiniGame.taiXiu.setVisible(!1):this.layerMiniGame.slot&&this.layerMiniGame.slot.setVisible(!1),JFGameInfo.CurrentLayer=ConstantsVariable.LAYERS.MENU_LAYER_LOGIN,setTimeout(JFGameInfo.JFMain.hideLoading.bind(JFGameInfo.JFMain),500)}else this.layerMainMenu.runAction(cc.sequence(cc.moveTo(0,cc.p(0,0)).easing(cc.easeInOut(3)),cc.callFunc(this.hideLoading.bind(this))));this.layerMainMenu._layerLobby.initLogin(!1),JFGameInfo.IsLoggedIn=!1,this._isLogout=!0,this._isKicked=!1;break;case ConstantsVariable.LAYERS.MENU_LAYER_ROOMS:this._playBackgroundMusic(!1),JFGameInfo.CurrentLayer!=ConstantsVariable.LAYERS.MENU_LAYER_ROOMS&&(JFGameInfo.CurrentLayer=ConstantsVariable.LAYERS.MENU_LAYER_ROOMS,cc.sys.isNative?(console.log("cc.sys.isNative MENU_LAYER_ROOMS::::"),this.layerMainMenu.runAction(cc.sequence(cc.moveTo(.5,cc.p(0,0)).easing(cc.easeInOut(3)),cc.callFunc(this.hideLoading.bind(this))))):(this.layerMainMenu.setPosition(cc.p(0,0)),JFGameInfo.JFMain.hideLoading()),this.layerComponents.setVisible(!0),this.layerComponents.setVisibleCompoItemGame(!1),this.layerPopup.hideAllPopup(),this.layerComponents.compoNotify.changeNotifyType(t));break;case ConstantsVariable.LAYERS.MENU_LAYER_GAME:JFGameInfo.CurrentLayer!=ConstantsVariable.LAYERS.MENU_LAYER_GAME&&(JFGameInfo.CurrentLayer=ConstantsVariable.LAYERS.MENU_LAYER_GAME,this.disposeMenuGame(),this.layerScreenGame.setVisible(!0),this.layerComponents.setVisibleCompoItemGame(!0),this.layerPopup.hideAllPopup(),this.layerComponents.compoNotify.changeNotifyType(t),this._playBackgroundMusic(!0),this.layerComponents.enterGame())}},_playBackgroundMusic:function(t){if(t)switch(t=ResourceManager.JFResourcesGame.SoundBGM1,jf.math.randomRoundBetween(1,6)){case 1:t=ResourceManager.JFResourcesGame.SoundBGM1;break;case 2:t=ResourceManager.JFResourcesGame.SoundBGM2;break;case 3:t=ResourceManager.JFResourcesGame.SoundBGM3;break;case 4:t=ResourceManager.JFResourcesGame.SoundBGM4;break;case 5:t=ResourceManager.JFResourcesGame.SoundBGM5;break;case 6:t=ResourceManager.JFResourcesGame.SoundBGM6}else t=0==jf.math.random0Or1()?ResourceManager.JFResourcesMenuGame.SoundBGM_Lobby1:ResourceManager.JFResourcesMenuGame.SoundBGM_Lobby2;jf.audio.playMusic(t)},getWebview:function(){return this.webView=new ccui.WebView,this.webView.setContentSize(cc.size(1090,500)),this.webView.setPosition(cc.p(640,340)),this.addChild(this.webView),this.webView},removeWebview:function(){try{this.webView&&(this.webView.stopLoading(),this.removeChild(this.webView),this.webView=null)}catch(t){}},_initLayerMainGame:function(){this.layerScreenGame=new JFLayerScreenGame,this.layerScreenGame.initObj(),this.addChild(this.layerScreenGame),this.layerScreenGame.setVisible(!1),this.layerScreenGame.setLocalZOrder(ConstantsVariable.UIZorder.GAME)},_initLayerComponents:function(){this.layerComponents=new JFLayerCompos,this.layerComponents.initObj(),this.addChild(this.layerComponents,ConstantsVariable.UIZorder.COMPONENTS),this.layerComponents.setVisible(!1)},_initLayerPopupController:function(){this.layerPopup=new JFLayerPopup,this.layerPopup.initObj(),this.addChild(this.layerPopup,ConstantsVariable.UIZorder.POPUPS),this.layerPopup.setVisible(!1)},_initEvents:function(){var t;cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.LOGIN_MASTER.toString(),this._loginSuccess.bind(this)),cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.SYSTEM_KICH.toString(),this._systemKick.bind(this)),cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.SYSTEM_GET_ROOM_INFO.toString(),this._getRoomInfo.bind(this)),cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.GAME_EXIT.toString(),this._exitServerGame.bind(this)),cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.SHOW_UPDATE_DISPLAY_NAME.toString(),this._ngShowUpdateDislayName.bind(this)),cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.SHOW_TOP_DAMAGE.toString(),this._ngShowTopDamage.bind(this)),cc.eventManager.addCustomListener(ConstantsVariable.EVENTS.ANDROID_SOFTKEY_BACK,this._oneKeyPressInvokeFromNative.bind(this)),cc.eventManager.addCustomListener(ConstantsVariable.EVENTS.CALL_TOP_USER_SLOT,this._callTopUserStot.bind(this)),cc.eventManager.addCustomListener(ConstantsVariable.EVENTS.LOGOUT_ACCOUNT_LOBBY,this._isCheckLogout.bind(this)),cc.eventManager.addCustomListener(ConstantsVariable.NETWORK.TOP_USER_SLOT,this._showTopSlot.bind(this)),cc.eventManager.addCustomListener(cc.game.EVENT_HIDE,this._onGameHide.bind(this)),cc.eventManager.addCustomListener(cc.game.EVENT_SHOW,this._onGameShow.bind(this)),cc.sys.isNative&&(t=cc.EventListener.create({event:cc.EventListener.KEYBOARD,onKeyPressed:this._onKeyPress.bind(this)}),cc.eventManager.addListener(t,this))},_callTopUserStot:function(t){this.netSend.sendTopSlot()},_showTopSlot:function(t){t=t.getUserData();var e={TopFreeTicket:BinaryConstants.DataTypeID.Object8,TopFreeTicket_Struct:{Nickname:BinaryConstants.DataTypeID.StringDynamic,Ticket:BinaryConstants.DataTypeID.UInt32}};t=(new BinaryParser).init(e,t.content),JFGameInfo.JFMain.layerPopup.showPopupTopFreeSlot(t.TopFreeTicket)},_oneKeyPressInvokeFromNative:function(){try{if(this.layerPopup)return this.removeWebview(),this.layerPopup.hidePopupSequence(),!0}catch(t){}},_onKeyPress:function(t,e){if(!0!==this.layerLoading.checkLoading()){if(t==cc.KEY.back||t==cc.KEY.tab){if(this.layerPopup.isVisible())return this.removeWebview(),this.layerPopup.hidePopupSequence(),!0;if(JFGameInfo.CurrentLayer===ConstantsVariable.LAYERS.MENU_LAYER_ROOMS)return this.layerMainMenu._layerLobby._onClickBtnExit(),!0;if(JFGameInfo.CurrentLayer===ConstantsVariable.LAYERS.MENU_LAYER_GAME)return JFGameInfo.JFMain.layerPopup.showPopupMsg(ConstantsVariable.Messages.EXIT_GAME,this.layerComponents.compoOptionInGame.onComfirmExit.bind(this.layerComponents.compoOptionInGame)),!0;if(JFGameInfo.CurrentLayer===ConstantsVariable.LAYERS.MENU_LAYER_MINI_GAME)return JFGameInfo.roomID===ConstantsVariable.MiniGameVongQuay?this.layerMiniGame.vongQuay.onclose():JFGameInfo.roomID===ConstantsVariable.MiniGameTaiXiu?this.layerMiniGame.taiXiu.onclose():JFGameInfo.roomID===ConstantsVariable.MiniGameSlot&&this.layerMiniGame.slot.onclose(),!0;JFGameInfo.JFMain.layerPopup.showPopupMsg(ConstantsVariable.Messages.CLOSE_GAME,this._confimCloseGame.bind(this))}return!0}},_confimCloseGame:function(){cc.game.end()},logout:function(){this._isKicked=!0,JFNetCore.JFMasterSocket.close(),Utilities.pushEventFirebase("user_logout",{})},_onGameHide:function(t){Utilities.showLog("////////////GAME HIDE//////////////"),cc.sys.isNative?cc.game.pause():cc.game.resume(),this.isNative||null!==this._worker||this.startWorker()},_onGameShow:function(t){Utilities.showLog("////////////GAME SHOW//////////////"),cc.game.resume(),null!=this._worker&&(this._worker.terminate(),delete this._worker)},_initNetwork:function(){this.netSend=new JFNetSend,JFNetCore.JFMasterSocket=new JFNetCore,JFNetCore.JFMasterSocket.callBackOnConnected=this._onConnectedMasterServer.bind(this),JFNetCore.JFMasterSocket.callBackOnError=this._onErrorMasterServer.bind(this),JFNetCore.JFMasterSocket.callBackOnReceiveData=this._onReceiveMasterServer.bind(this),JFNetCore.JFMasterSocket.callBackOnClose=this._onCloseMasterServer.bind(this)},connectMasterServer:function(){this.showLoading(),JFNetCore.JFMasterSocket.close(),JFNetCore.JFMasterSocket.init(PreLoaderConfig.ServerAndPortMaster),JFNetCore.JFMasterSocket.connect();var t={};t.provider_name=JFGameInfo.IsLoginNormal?"Normal":"Facebook",t.platform=Utilities.getOSType(),Utilities.pushEventFirebase("login_successed",t)},_onCloseMasterServer:function(t){console.log("///////////////////HANDLE CLOSE MASTER SERVER///////////////////"),JFNetCore.JFMasterSocket&&(this.layerMainMenu&&this.layerMainMenu._layerLobby.stopScheduleGetUserOnline(),this.hideLoading(),this._isKicked?this.pushFirebaseConnectError("Lobby","Tài khoản được đăng nhập ở một nơi khác"):this._isLogout?(this.layerPopup.showPopupMsg2(PreLoaderConfig.Messages.ERROR_CONNECT_SOCKET,"Kết Nối",this._reconnect.bind(this)),this.pushFirebaseConnectError("Lobby",PreLoaderConfig.Messages.ERROR_CONNECT_SOCKET)):(this.layerPopup.showPopupMsg2(ConstantsVariable.Messages.LOGOUT_SUCCESS,"Đăng Nhập Lại",this.resetDefaultLogin.bind(this)),this.pushFirebaseConnectError("Lobby",ConstantsVariable.Messages.LOGOUT_SUCCESS)),this.unschedule(this.onPingMaster)),JFGameInfo.JFMain.resetUserInfo(),JFGameInfo.JFMain.swipLayer(ConstantsVariable.LAYERS.MENU_LAYER_LOGIN)},_isCheckLogout:function(){this._isLogout=!1},resetDefaultLogin:function(){this._isLogout=!0,this._reconnect()},_onErrorMasterServer:function(t){console.log("///////////////////HANDLE ERROR MASTER SERVER///////////////////"),this._onCloseMasterServer()},_reconnect:function(){this.autoLogin()},_onConnectedMasterServer:function(){JFGameInfo.DevVersion&&(JFGameInfo.packetName="banca3d.online",""===JFGameInfo.myInfo.token4Master)&&(JFGameInfo.myInfo.token4Master="IkYKAlrmisWoJ/yUZlf9PJeHimD/4eg3/L6ML2LyJxqnjfJwe1l77sO4aznflsOlE42hIPJOg+KsHNZsWHcOCG1rNohnlXM5FMPvk/rd1k1HEcCil1h1M1FfMuiYB8bIgDKeS2m9v8nr09FjVBdIqJAYNn4aHhYq+5IEy55bBjHmDG4AOzZUhjnMHHxzuwtQKQ/hKEh055Xnt3uvLa/mikkIoCDWzsRBGTkVnwdDhkK25ObQxVkUtZGe09cprCvm4Nb4pBhu5OLk9qgIhgjmiw=="),Utilities.showLog("JFGameInfo.myInfo.token4Master:: "+JFGameInfo.myInfo.token4Master),this.netSend.sendLoginMaster(JFGameInfo.myInfo.token4Master)},_onReceiveMasterServer:function(t){cc.eventManager.dispatchCustomEvent(t.requestId.toString(),t)},_loginSuccess:function(t){t=t.getUserData();var e={UserID:BinaryConstants.DataTypeID.UInt32,Gold:BinaryConstants.DataTypeID.UInt64,Level:BinaryConstants.DataTypeID.UInt32,Nickname:BinaryConstants.DataTypeID.StringDynamic};for(t=(new BinaryParser).init(e,t.content),JFGameInfo.myInfo.UserID=t.UserID,JFGameInfo.myInfo.Gold=t.Gold,JFGameInfo.myInfo.Level=t.Level,JFGameInfo.myInfo.Nickname=t.Nickname,JFGameInfo.myInfo.listFishCatch=[],JFGameInfo.myInfo.totalGold=0,e=JFGameInfo.myInfo.totalFish=0;e<31;e++)JFGameInfo.myInfo.listFishCatch.push(0);ConstantsVariable.GunPosition[0]=cc.p(230,0),ConstantsVariable.GunPosition[1]=cc.p(JFUIBase.w-230,0),ConstantsVariable.GunPosition[2]=cc.p(JFUIBase.w-230,+JFUIBase.h),ConstantsVariable.GunPosition[3]=cc.p(230,+JFUIBase.h),Utilities.showLog("_loginSuccess content "+JSON.stringify(t)),this.showLoading(),this.swipLayer(ConstantsVariable.LAYERS.MENU_LAYER_ROOMS),this.layerPopup.hidePopupLogin(),cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.MENU_LAYER_UPDATE_USER,{}),this.layerMainMenu._layerLobby.runScheduleGetUserOnline(),this.layerMainMenu._layerLobby.checkConfigIG(),this.netSend.sendGetAwardStatus(),this.schedule(this.onPingMaster,PreLoaderConfig.TIME_PING_MASTER),this.layerMainMenu._layerLobby._checkCurrentEvent(),this.pushFirebaseJoinRoomSuccess("Lobby")},_systemKick:function(t){Utilities.showLog("/////////////KICK USER//////////////"),t=t.getUserData();var e={State:BinaryConstants.DataTypeID.UInt8,Msg:BinaryConstants.DataTypeID.StringDynamic};if(t=(new BinaryParser).init(e,t.content),JFGameInfo.CurrentLayer==ConstantsVariable.LAYERS.MENU_LAYER_GAME){switch(JFGameInfo.roomID){case ConstantsVariable.RoomGameNormal:JFGameInfo.JFMain.pushFirebaseConnectError("Normal","user kicked");break;case ConstantsVariable.RoomGameVip:JFGameInfo.JFMain.pushFirebaseConnectError("Vip","user kicked")}this._exitServerGame()}t.State==ConstantsVariable.LAYERS.MENU_LAYER_LOGIN?(console.log("MENU_LAYER_LOGIN"),this.layerMainMenu._layerLobby.stopScheduleGetUserOnline(),this.layerPopup.hideAllPopup(),this._isKicked=this._isLogout=!0,cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.KICK_USER),this.layerPopup.showPopupMsg2("Tài khoản được đăng nhập ở một nơi khác!","Đăng Nhập Lại",this._reconnect.bind(this))):this.layerPopup.showPopupMsg(t.Msg)},_getRoomInfo:function(t){t=t.getUserData();var e={IsError:BinaryConstants.DataTypeID.UInt8,KindID:BinaryConstants.DataTypeID.UInt32,LevelLimit:BinaryConstants.DataTypeID.UInt32,GoldLimit:BinaryConstants.DataTypeID.UInt64,Server:BinaryConstants.DataTypeID.StringDynamic,Token:BinaryConstants.DataTypeID.StringDynamic};0===(t=(new BinaryParser).init(e,t.content)).IsError&&(PreLoaderConfig.ServerAndPortGame=t.Server,JFGameInfo.myInfo.token4Game=t.Token,JFGameInfo.roomID===ConstantsVariable.MiniGameVongQuay||JFGameInfo.roomID===ConstantsVariable.MiniGameTaiXiu||JFGameInfo.roomID===ConstantsVariable.MiniGameSlot?(this.layerMiniGame.initNetWork(),JFGameInfo.JFMain.layerPopup.hidePopupMiniGame()):(this.layerScreenGame&&(this.layerScreenGame.removeAllChildren(!0),this.layerScreenGame.removeFromParent(),this.layerScreenGame=null),this._initLayerMainGame(),this.layerScreenGame.initNetWork()))},_exitServerGame:function(t){console.log("/////////////////////HANDLE EXIT GAME SERVER////////////////////"),this._initBackground(),this._initLayerMainMenuGame(),this.layerMainMenu._layerLobby._checkCurrentEvent(),this.layerScreenGame&&(JFNetCore.JFGameSocket&&(JFNetCore.JFGameSocket.close(),JFNetCore.JFGameSocket=null),this.layerScreenGame.dispose(),this.removeChild(this.layerScreenGame),this.layerScreenGame=null),JFGameInfo.listDropItem.length=0,JFGameInfo.CurrentLayer=ConstantsVariable.LAYERS.MENU_LAYER_ROOMS,this.layerMainMenu._layerLobby.checkConfigIG(),this.layerMainMenu.setPosition(cc.p(0,0)),this.layerComponents.setVisible(!0),this.layerComponents.exitGame(),this.layerComponents.setVisibleCompoItemGame(!1),this.layerPopup.hideAllPopup(),this.layerComponents.compoNotify.changeNotifyType(ConstantsVariable.LAYERS.MENU_LAYER_ROOMS),this._initLayerMainGame(),this._playBackgroundMusic(!1),this.layerMainMenu._layerLobby.runScheduleGetUserOnline(),this.netSend.sendGetAwardStatus(),JFGameInfo.SNG&&!PreLoaderConfig.IsReview&&JFGameInfo.JFMain.layerPopup.showPopupWebview(ConstantsVariable.WEBVIEW.NAP_XU,!0),JFGameInfo.SNG=!1},_ngShowUpdateDislayName:function(t){JFGameInfo.JFMain.layerPopup.showPopupDisplayName()},resetUserInfo:function(){Utilities.showLog("///////////RESET USER INFO///////////////"),JFGameInfo.myInfo.UserID=0,JFGameInfo.myInfo.DeskStation=0,JFGameInfo.myInfo.Gold=0,JFGameInfo.myInfo.Level=0,JFGameInfo.myInfo.Exp=0,JFGameInfo.myInfo.Nickname="",JFGameInfo.myInfo.token4Ws="",JFGameInfo.myInfo.token4Master="",JFGameInfo.myInfo.token4Game="",JFGameInfo.myInfo.PubUserId=null,JFGameInfo.myInfo.avatarPath="",JFGameInfo.myInfo.avatarImage=null},autoLogin:function(){JFGameInfo.JFMain.showLoading(),Utilities.showLog("autoLogin autoLogin ");var t=cc.sys.localStorage.getItem("UserName"),e=cc.sys.localStorage.getItem("Password"),i=cc.sys.localStorage.getItem("facebook");t&&""!=t&&e&&""!=e?((i={}).OpenProviderId=ConstantsVariable.LoginProviderID.Normal,i.Password=e,i.Username=t,i.PlatformID=JFGameInfo.myPlatform,i.AppVersion=JFGameInfo.AppVersion,i.HardwareID=JFGameInfo.devineID,i.ChannelId=ConstantsVariable.CHANNEL_ID,i.VersionDevice=JFGameInfo.VersionDevice,i.DeviceModel=JFGameInfo.DeviceModel,i.packetName=JFGameInfo.packetName,i.Sign=md5.encscript("Login"+i.OpenProviderId+i.Password+i.Username+i.PlatformID+i.AppVersion+i.HardwareID+i.ChannelId+i.VersionDevice+i.DeviceModel+i.packetName),Utilities.showLog("autoLogin autoLogin "),Utilities.getAPI("Login",i,this.onCallBackAutoLogin.bind(this))):"true"==i?this.layerMainMenu._layerLobby.showLoginFB():JFGameInfo.JFMain.hideLoading()},onCallBackAutoLogin:function(t){if(JFGameInfo.JFMain.hideLoading(),1===(t=JSON.parse(t)).Result){var e=t.Data.Data;Utilities.showLog("Master Info :"+JSON.stringify(e)),cc.sys.localStorage.setItem("facebook",!1),JFGameInfo.myInfo.token4Master=e.TokenGame,JFGameInfo.myInfo.token4Ws=e.TokenAPI,JFGameInfo.myInfo.avatarPath=e.EmotionPath,JFGameInfo.myInfo.PubUserId=e.PubUserId,JFGameInfo.myInfo.promotionPathAvatar=e.PromotionPatch,JFGameInfo.myInfo.promotionBorder=e.BorderAvatarLevel;for(var i=JSON.parse(e.PromotionPatch),n=0;n<i.length;n++){var s=i[n];s.status&&(JFGameInfo.myInfo.isPaymentFirst=s.status)}cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.REFRESH_AVATAR_USER),cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.REFRESH_BORDER_AVATAR),cc.eventManager.dispatchCustomEvent(ConstantsVariable.EVENTS.CHECK_USER_LOGIN),JFGameInfo.DevVersion||(PreLoaderConfig.ServerAndPortMaster=e.SocketKey),PreLoaderConfig.PathToAvatarDefault=e.AvatarDefault,""==PreLoaderConfig.ServerAndPortMaster||null==PreLoaderConfig.ServerAndPortMaster||PreLoaderConfig.ServerAndPortMaster.length<2?(JFGameInfo.JFMain.hideLoading(),JFGameInfo.JFMain.layerPopup.showPopupMsg("API đăng nhập lỗi không tìm được địa chỉ Server")):""==JFGameInfo.myInfo.token4Master||null==JFGameInfo.myInfo.token4Master?JFGameInfo.JFMain.layerPopup.showPopupMsg(t.Message):(this.showLoading(),JFGameInfo.IsLoginNormal=!0,JFGameInfo.JFMain.connectMasterServer())}else JFGameInfo.JFMain.hideLoading(),t=t.Message.replace(/\\n/g,"\n"),JFGameInfo.JFMain.layerPopup.showPopupMsg(t)},_ngShowTopDamage:function(t){t=t.getUserData();var e={ListUser:BinaryConstants.DataTypeID.Object8,ListUser_Struct:{Rank:BinaryConstants.DataTypeID.UInt8,UserName:BinaryConstants.DataTypeID.StringDynamic,Damage:BinaryConstants.DataTypeID.UInt32,Coin:BinaryConstants.DataTypeID.UInt32},Rank:BinaryConstants.DataTypeID.UInt8,UserName:BinaryConstants.DataTypeID.StringDynamic,Damage:BinaryConstants.DataTypeID.UInt32,Coin:BinaryConstants.DataTypeID.UInt32,IsDead:BinaryConstants.DataTypeID.UInt8};t=(new BinaryParser).init(e,t.content),JFGameInfo.JFMain.layerPopup.showPopupTopDamage(),JFGameInfo.JFMain.layerPopup.popupTopDamage.updateValue(t)},onPingMaster:function(){Utilities.showLog("onPingMaster "),this.netSend.sendPingMaster()},_initLayerMiniGame:function(){this.layerMiniGame=new JFMiniGame,this.layerMiniGame.initObj(),this.addChild(this.layerMiniGame,ConstantsVariable.UIZorder.MINIGAME),this.layerMiniGame.setVisible(!1)},disposeMenuGame:function(){this.layerMainMenu&&(this.layerMainMenu.dispose(),this.layerMainMenu.removeAllChildren(!0),this.removeChild(this.layerMainMenu),this.layerMainMenu=null),this._background.removeFromParent(!0),this._background=null},startWorker:function(){"undefined"!=typeof Worker?(null===this._worker&&(this._worker=new Worker(URL.createObjectURL(new Blob(["onmessage = function (g) {var a, b, c, d = Date.now(),e = g.data[0], f = function () { clearTimeout(a); b = Date.now(); c = b - d; d = b; postMessage(c); a = setTimeout(f, e) }; a = setTimeout(f, e)};"],{type:"text/javascript"})))),this._worker.onmessage=function(t){cc.director.mainLoop()},this._worker.onerror=function(){Utilities.showLog("Co loi xay ra voi worker")},this._worker.postMessage([Math.floor(cc.game._frameTime)])):Utilities.showLog("Trinh duyet khong ho tro worker")},pushFirebaseLoginFailed:function(t,e){var i={};i.provider_name=t?"Normal":"Facebook",i.platform=Utilities.getOSType(),i.errorcode=e,Utilities.pushEventFirebase("login_failed",i)},pushFirebaseConnectError:function(t,e){var i={};i.server_name=t,i.platform=Utilities.getOSType(),i.errorcode=e,Utilities.pushEventFirebase("connection_error",i)},pushFirebaseJoinRoomSuccess:function(t){var e={};e.room_name=t,e.platform=Utilities.getOSType(),Utilities.pushEventFirebase("join_room_successed",e)}}),JFJackPot=(JFGameController=cc.Class.extend({_mainScreen:null,_layerloading:null,_sceneLoading:null,_onLoadResourceCompleteCallback:null,jfReceiveController:null,jfRequestController:null,jfPopupController:null,_countImgLoaded:0,ctor:function(t){JFUIBase.initWinSizeAbout(),JFGameInfo.setConfig(),JFGameInfo.myInfo.loginState=-1,JFGameInfo.myPlatform=cc.sys.os!==cc.sys.OS_ANDROID&&cc.sys.os===cc.sys.OS_IOS?ConstantsVariable.PlatformID.Ios:ConstantsVariable.PlatformID.Android,this._onLoadResourceCompleteCallback=t,this._initSdkbox(),JFGameInfo.isLoadResourceSucess?(null!=this._onLoadResourceCompleteCallback&&this._onLoadResourceCompleteCallback(),this._goToLobby()):(Utilities.setVersionResource(),this._loadResourceLoading())},_loadResourceLoading:function(){cc.loader.load(resourcesLoadingGame,function(t,e,i){}.bind(this),function(){cc.sys.isNative||Utilities.cacheTextures(),this._layerloading=new LayerLoadingWithProcess,this._layerloading.initObj(),this._sceneLoading=new cc.Scene,this._sceneLoading.addChild(this._layerloading),cc.director.runScene(this._sceneLoading),null!=this._onLoadResourceCompleteCallback&&this._onLoadResourceCompleteCallback(),this._loadResourceMenuGame()}.bind(this))},_loadResourceMenuGame:function(){cc.loader.load(resourcesMenuGame,function(t,e,i){(t=Math.floor(.2*Math.min(i/e*100|0,100)))<=20&&(this._layerloading._mainLayer.getChildByName("TextPercent").setString(t+"%"),this._layerloading._mainLayer.getChildByName("ProcessLoading").setPercent(t))}.bind(this),function(){if(cc.sys.isNative)for(var t in resourcesMenuGame)-1!=resourcesMenuGame[t].indexOf(".plist")&&cc.spriteFrameCache.addSpriteFrames(resourcesMenuGame[t],resourcesMenuGame[t].replace(".plist",".png"));else cc.sys.isNative||Utilities.cacheTextures();this._loadResourceGame()}.bind(this))},_loadResourceGame:function(){cc.loader.load(resourcesGame,function(t,e,i){20<=(t=Math.floor(20+.8*Math.min(i/e*100|0,100)))&&null!=this._layerloading&&this._layerloading&&(this._layerloading._mainLayer.getChildByName("TextPercent").setString(t+"%"),this._layerloading._mainLayer.getChildByName("ProcessLoading").setPercent(t))}.bind(this),function(){if(cc.sys.isNative)for(var t in resourcesGame)-1!=resourcesGame[t].indexOf(".plist")&&cc.spriteFrameCache.addSpriteFrames(resourcesGame[t],resourcesGame[t].replace(".plist",".png"));else cc.sys.isNative||Utilities.cacheTextures();this._loadEventImage()}.bind(this))},_loadEventImage:function(){if(PreLoaderConfig.EVENTS_IMG&&0<PreLoaderConfig.EVENTS_IMG.length)for(var t=0;t<PreLoaderConfig.EVENTS_IMG.length;t++)if(console.log("PreLoaderConfig.EVENTS_IMG:: "+PreLoaderConfig.EVENTS_IMG[t]),cc.sys.isNative){var e=cc.textureCache.getTextureForKey(PreLoaderConfig.EVENTS_IMG[t]);if(!e)return void cc.loader.loadImg(PreLoaderConfig.EVENTS_IMG[t],{isCrossOrigin:!0},this._loadEventImage.bind(this));var i=cc.SpriteFrame.create();i.setTexture(e),i.setRect(cc.rect(0,0,e.width,e.height)),i.setRectInPixels(cc.rect(0,0,e.width,e.height)),cc.spriteFrameCache.addSpriteFrame(i,PreLoaderConfig.EVENTS_IMG[t])}else if(!cc.sys.isNative){if(!(i=cc.loader.getRes(PreLoaderConfig.EVENTS_IMG[t])))return void cc.loader.loadImg(PreLoaderConfig.EVENTS_IMG[t],{isCrossOrigin:!0},this._onLoadedTextureEvent.bind(this));(e=new cc.Texture2D).initWithElement(i),e.handleLoadedTexture(),cc.textureCache.cacheImage(PreLoaderConfig.EVENTS_IMG[t],e),(i=new cc.SpriteFrame).setTexture(e),i.setRect(cc.rect(0,0,e.width,e.height)),i.setRectInPixels(cc.rect(0,0,e.width,e.height)),cc.spriteFrameCache.addSpriteFrame(i,PreLoaderConfig.EVENTS_IMG[t])}this._goToLobby()},_onLoadedTextureEvent:function(t,e){t||(cc.loader.cache[PreLoaderConfig.EVENTS_IMG[this._countImgLoaded]]=e,this._countImgLoaded++,this._countImgLoaded==PreLoaderConfig.EVENTS_IMG.length?this._loadEventImage():cc.loader.loadImg(PreLoaderConfig.EVENTS_IMG[this._countImgLoaded],{isCrossOrigin:!0},this._onLoadedTextureEvent.bind(this)))},_goToLobby:function(){this._mainScreen=new JFMainScreen,this._mainScreen.retain(),this._mainScreen.initObj(),this._mainScreen&&(cc.director.runScene(this._mainScreen),cc.sys.isNative||0!==JFGameInfo.debugMode||this._mainScreen.swipLayer(ConstantsVariable.LAYERS.MENU_LAYER_ROOMS))},_getGameConfig:function(){JFGameInfo.JFMain.showLoading();var t={};t.VersionDevice=JFGameInfo.VersionDevice,t.DeviceModel=JFGameInfo.DeviceModel,t.packetName=JFGameInfo.packetName,t.PlatformId=JFGameInfo.myPlatform,t.GameVersion=JFGameInfo.AppVersion,t.HardwareID=JFGameInfo.devineID,t.ChannelId=JFGameInfo.ChannelID,t.TelcoCode=JFGameInfo.TelcoCode,t.Sign=md5.encscript("GetConfigServer"+t.PlatformID+t.AppVersion+t.HardwareID+t.ChannelId+t.VersionDevice+t.DeviceModel+t.packetName+t.TelcoCode),Utilities.getAPI("GetConfigServer",t,this._callBackGetGameConfig.bind(this))},_callBackGetGameConfig:function(t){JFGameInfo.JFMain.hideLoading(),Utilities.showLog("_callBackGetGameConfig: "+t);try{var e=JSON.parse(t);e.Result&&(JFGameInfo.ServerConfig=e.Data)}catch(t){}},_initSdkbox:function(){if(cc.sys.isNative)try{"undefined"==typeof sdkbox?console.log("====================sdkbox undefined============="):(sdkbox.PluginFacebook.init(),sdkbox.firebase.Analytics.init(),sdkbox.PluginOneSignal.init())}catch(t){Utilities.showLog("_initSdkbox: "+t.stack)}else try{Utilities.showLog("//////////////INIT FIREBASE////////////////////")}catch(t){Utilities.showLog("_initSdkbox: "+t.stack)}}}),cc.Node.extend({_txtGold:null,_lastGold:0,_currentGold:0,_finalGold:0,_startTime:0,_processTime:2e3,_speed:1,_isRun:!1,_btnShowJackpot:null,_roomKindId:-1,ctor:function(){cc.Node.prototype.ctor.call(this)},cloneFromNode:function(t){for(this.setName(t.getName()),this.setPosition(t.getPosition()),this.setVisible(t.isVisible()),this.setLocalZOrder(t.getLocalZOrder());0<t.getChildrenCount();){var e=t.getChildren()[0];e.removeFromParent(),this.addChild(e)}t.removeFromParent(),this._txtGold=this.getChildByName("TxtJackPot"),this._btnShowJackpot=this.getChildByName("Btn_Jackpot"),this._btnShowJackpot.addClickEventListener(this.onClickBtnFromCocostudio.bind(this))},initObj:function(){this._finalGold=this._currentGold=this._lastGold=0,this._isRun=!1,this.scheduleUpdate()},setGold:function(t){this._finalGold!==t&&(this._finalGold=t,this._lastGold=this._currentGold,this._speed=(this._finalGold-this._currentGold)/this._processTime,this._startTime=(new Date).getTime(),this._isRun=!0,this._doEffectGoldJackPot())},setRomKindId:function(t){this._roomKindId=t},getCurrentGold:function(){return this._currentGold},onClickBtnFromCocostudio:function(t,e){"Btn_Jackpot"===t.getName()&&(0<this._roomKindId?this.showPopupJackpot(this._roomKindId):this.showPopupJackpot(JFGameInfo.roomID))},showPopupJackpot:function(t){t==ConstantsVariable.RoomGameNormal?JFGameInfo.JFMain.layerPopup.showPopupJackpot(ConstantsVariable.JackpotValue.Normal):t==ConstantsVariable.RoomGameVip&&JFGameInfo.JFMain.layerPopup.showPopupJackpot(ConstantsVariable.JackpotValue.VIP)},_doEffectGoldJackPot:function(t){this.stopAllActions(),this.runAction(cc.sequence(cc.scaleTo(.2,1.2),cc.scaleTo(.2,1)))},update:function(t){this._isRun&&(t=(new Date).getTime(),this._currentGold=this._lastGold+(t-this._startTime)*this._speed,this._currentGold>=this._finalGold&&(this._currentGold=this._finalGold,this._isRun=!1),this._txtGold.setString(Utilities.Coin(Math.round(this._currentGold))))}}));cc.game.onStart=function(){if(!cc.sys.isNative&&document.getElementById("cocosLoading")&&document.body.removeChild(document.getElementById("cocosLoading")),cc.view.enableRetina(cc.sys.os===cc.sys.OS_IOS),cc.view.adjustViewPort(!0),!cc.sys.isNative){cc.eventManager.removeCustomListeners(cc.game.EVENT_HIDE),cc.eventManager.removeCustomListeners(cc.game.EVENT_SHOW),cc.eventManager.addCustomListener(cc.game.EVENT_HIDE,function(){cc.sys.isMobile&&(cc.game.config.volumes={music:jf.audio.getMusicVolume(),effect:jf.audio.getEffectsVolume()},jf.audio.setEffectsVolume(0,!1),jf.audio.pauseMusic()),cc.eventManager.dispatchCustomEvent(ConstantsVariable.DISPATCH_EVENT_OUT_FOCUS)}),cc.eventManager.addCustomListener(cc.game.EVENT_SHOW,function(){cc.sys.isMobile&&(jf.audio.setEffectsVolume(cc.game.config.volumes.effect,!1),jf.audio.resumeMusic())});try{$("html").focusout(function(){cc.eventManager.dispatchCustomEvent(ConstantsVariable.DISPATCH_EVENT_OUT_FOCUS)})}catch(t){}}!cc.sys.isNative&&cc.sys.isMobile&&(cc.view.setOrientation(cc.ORIENTATION_LANDSCAPE_LEFT),ScreenPolicy.apply()),cc.view.setDesignResolutionSize(cc.game.config.gameWidth,cc.game.config.gameHeight,cc.ResolutionPolicy.SHOW_ALL),cc.view.resizeWithBrowserSize(!0),cc.view._orientationChanging=!1,new JFGameController(function(){}.bind(this))},cc.game.run();